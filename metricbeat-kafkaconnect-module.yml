- module: jolokia
  metricsets:
    - jmx
  period: 5m
  fields_under_root: true
  fields:
    cluster_uuid: dataconnector-clustername
  hosts:
    - "https://dataconnector-01.example.com:1099"
    - "https://dataconnector-02.example.com:1099"
    - "https://dataconnector-03.example.com:1099"
    - "https://dataconnector-04.example.com:1099"
  ssl.verification_mode: full
  ssl.certificate_authorities:
    - /usr/share/metricbeat/cacerts/rootca.crt
  username: "jolokia"
  password: "secretpassword"
  namespace: "jolokia_kafka_connect_metrics"
  path: "/jolokia/"
  http_method: 'GET'
  jmx.mappings:
    - mbean: 'kafka.connect:type=connect-worker-metrics'
      attributes:
        # The number of connectors running on this worker
        - attr: connector-count
          field: worker.connector-count
        # The total number of connector startups that this worker has attempted
        - attr: connector-startup-attempts-total
          field: worker.connector-startup-attempts-total
        # The total number of connector starts that failed
        - attr: connector-startup-failure-total
          field: worker.connector-startup-failure-total
        # The total number of connector starts that succeeded
        - attr: connector-startup-success-total
          field: worker.connector-startup-success-total
        # The average percentage of this worker's connectors starts that failed
        - attr: connector-startup-failure-percentage
          field: worker.connector-startup-failure-percentage
        # The number of tasks run(ning?) in this worker
        - attr: task-count
          field: worker.task-count
        # The total number of task startups that this worker has attempted
        - attr: task-startup-attempts-total
          field: worker.task-startup-attempts-total
        # The total number of task starts that failed
        - attr: task-startup-failure-total
          field: worker.task-startup-failure-total
        # The total number of task starts that succeeded
        - attr: task-startup-success-total
          field: worker.task-startup-success-total
        # The average percentage of this worker's tasks starts that succeeded
        - attr: task-startup-success-percentage
          field: worker.task-startup-success-percentage
    - mbean: 'kafka.connect:connector=*,type=connector-metrics'
      attributes:
        - attr: status
          field: connector.status
    - mbean: 'kafka.connect:connector=*,task=*,type=connector-task-metrics'
      attributes:
        # The average size of the batches processed by the connector
        - attr: batch-size-avg
          field: task.batch-size-avg
        # The maximum size of the batches processed by the connector
        - attr: batch-size-max
          field: task.batch-size-max
        # The average time in milliseconds taken by this task to commit offsets
        - attr: offset-commit-avg-time-ms
          field: task.offset-commit-avg-time-ms
        # The average percentage of this task's offset commit attempts that failed
        - attr: offset-commit-failure-percentage
          field: task.offset-commit-failure-percentage
        # The maximum time in milliseconds taken by this task to commit offsets
        - attr: offset-commit-max-time-ms
          field: task.offset-commit-max-time-ms
        # The average percentage of this task's offset commit attempts that succeeded
        - attr: offset-commit-success-percentage
          field: task.offset-commit-success-percentage
        # The fraction of time this task has spent in the pause state
        - attr: pause-ratio
          field: task.pause-ratio
        # The fraction of time this task has spent in the running state
        - attr: running-ratio
          field: task.running-ratio
        # The status of the connector task. One of 'unassigned', 'running', 'paused', 'failed', or 'restarting'
        - attr: status
          field: task.status
    - mbean: 'kafka.connect:connector=*,task=*,type=sink-task-metrics'
      attributes:
        # Before transformations are applied, this is the total number of records produced or polled by the task belonging to the named sink connector in the worker (since the task was last restarted)
        - attr: sink-record-read-total
          field: sink-task.sink-record-read-total
        # Total number of records output from the transformations and sent to the task belonging to the named sink connector in the worker (since the task was last restarted)
        - attr: sink-record-send-total
          field: sink-task.sink-record-send-total
    - mbean: 'kafka.connect:connector=*,task=*,type=source-task-metrics'
      attributes:
        # Number of records output from the transformations and written to Kafka for the task belonging to the named source connector in the worker (since the task was last restarted)
        - attr: source-record-write-total
          field: source-task.source-record-write-total
        # Before transformations are applied, this is the number of records produced or polled by the task belonging to the named source connector in the worker (since the task was last restarted)
        - attr: source-record-poll-total
          field: source-task.source-record-poll-total
    - mbean: 'kafka.connect:connector=*,task=*,type=task-error-metrics'
      attributes:
        # The number of failed writes to the dead letter queue
        - attr: deadletterqueue-produce-failures
          field: task-error.deadletterqueue-produce-failures
        # The number of attempted writes to the dead letter queue
        - attr: deadletterqueue-produce-requests
          field: task-error.deadletterqueue-produce-requests
        # The epoch timestamp when this task last encountered an error
        - attr: last-error-timestamp
          field: task-error.last-error-timestamp
        # The number of errors that were logged
        - attr: total-errors-logged
          field: task-error.total-errors-logged
        # The number of record processing errors in this task
        - attr: total-record-errors
          field: task-error.total-record-errors
        # The number of record processing failures in this task
        - attr: total-record-failures
          field: task-error.total-record-failures
        # The number of records skipped due to errors
        - attr: total-records-skipped
          field: task-error.total-records-skipped
        # The number of operations retried
        - attr: total-retries
          field: task-error.total-retries
    - mbean: 'kafka.connect:type=connect-worker-rebalance-metrics'
      attributes:
        # The total number of rebalances by this worker
        - attr: completed-rebalances-total
          field: worker-rebalance.completed-rebalances-total
    - mbean: 'kafka.connect:type=connect-metrics,client-id=*'
      attributes:
        # Connections closed per second in the window
        - attr: connection-close-rate
          field: client.connection-close-rate
        # Current number of active connections
        - attr: connection-count
          field: client.connection-count
        # New connections established per second in the window
        - attr: connection-creation-rate
          field: client.connection-creation-rate
        # Connections that failed authentication
        - attr: failed-authentication-rate
          field: client.failed-authentication-rate
        # Bytes per second read off all sockets
        - attr: incoming-byte-rate
          field: client.incoming-byte-rate
        # Fraction of time the I/O thread spent doing I/O
        - attr: io-ratio
          field: client.io-ratio
        # Average length of time for I/O per select call in nanoseconds
        - attr: io-time-ns-avg
          field: client.io-time-ns-avg
        # Fraction of time the I/O thread spent waiting
        - attr: io-wait-ratio
          field: client.io-wait-ratio
        # Average length of time the I/O thread spent waiting for a socket ready for reads or writes in nanoseconds
        - attr: io-wait-time-ns-avg
          field: client.io-wait-time-ns-avg
        # Average number of network operations (reads or writes) on all connections per second
        - attr: network-io-rate
          field: client.network-io-rate
        # Average number of outgoing bytes sent per second to all servers
        - attr: outgoing-byte-rate
          field: client.outgoing-byte-rate
        # Average number of requests sent per second
        - attr: request-rate
          field: client.request-rate
        # Average size of all requests in the window
        - attr: request-size-avg
          field: client.request-size-avg
        # Maximum size of any request sent in the window
        - attr: request-size-max
          field: client.request-size-max
        # Responses received and sent per second
        - attr: response-rate
          field: client.response-rate
        # Number of times the I/O layer checked for new I/O to perform per second
        - attr: select-rate
          field: client.select-rate
        # Connections that were successfully authenticated using SASL or SSL
        - attr: successful-authentication-rate
          field: client.successful-authentication-rate
        # The total number of requests sent
        - attr: request-total
          field: client.request-total
        # Total responses received
        - attr: response-total
          field: client.response-total
        # Total bytes read off all sockets
        - attr: incoming-byte-total
          field: client.incoming-byte-total
        # The total number of outgoing bytes sent to all servers
        - attr: outgoing-byte-total
          field: client.outgoing-byte-total
