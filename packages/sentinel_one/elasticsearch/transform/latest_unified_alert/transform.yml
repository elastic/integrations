# Use of "*" to use all namespaces defined.
source:
  index:
    - "logs-sentinel_one.unified_alert-*"
  query:
    bool:
      must_not:
        - exists:
            field: error.message
dest:
  index: "logs-sentinel_one_latest.dest_unified_alert-1"
  aliases:
    - alias: "logs-sentinel_one_latest.unified_alert"
      move_on_creation: true
latest:
  unique_key:
    - event.dataset
    - event.id
    - sentinel_one.unified_alert.detected_at
    - sentinel_one.unified_alert.external_id
  sort: "@timestamp"
description: >-
  Latest unified alert from SentinelOne. As unified alerts get updated, this transform stores only the latest state of each unified alert inside the destination index. Thus the transform's destination index contains only the latest state of the unified alert.
frequency: 30s
settings:
  # This is required to prevent the transform from clobbering the Fleet-managed mappings.
  deduce_mappings: false
  unattended: true
sync:
  time:
    field: "event.ingested"
    # Updated to 120s because of refresh delay in Serverless. With default 60s,
    # sometimes transform wouldn't process all documents.
    delay: 120s
retention_policy:
  time:
    field: "event.ingested"
    max_age: 90d
_meta:
  managed: false
  # Bump this version to delete, reinstall, and restart the transform during
  # package installation.
  fleet_transform_version: 0.1.0
  run_as_kibana_system: false
