{{ $accountId := generate "accountId" }}
{{ $accountName := generate "accountName" }}
{{ $activeProtection := generate "activeProtection" }}
{{ $activeThreats := generate "activeThreats" }}
{{ $agentVersion := generate "agentVersion" }}
{{ $allowRemoteShell := generate "allowRemoteShell" }}
{{ $appsVulnerabilityStatus := generate "appsVulnerabilityStatus" }}
{{ $cloudAccount := generate "cloud.account" }}
{{ $cloudImage := generate "cloud.image" }}
{{ $cloudInstanceSize := generate "cloud.instanceSize" }}
{{ $cloudLocation := generate "cloud.location" }}
{{ $cloudNetwork := generate "cloud.network" }}
{{ $cloudTags := generate "cloud.tags" }}
{{ $cloudProviders := generate "cloudProviders" }}
{{ $computerName := generate "computerName" }}
{{ $containerizedWorkloadContainersCount := generate "containerizedWorkloadCounts.containersCount" }}
{{ $containerizedWorkloadPodsCount := generate "containerizedWorkloadCounts.podsCount" }}
{{ $containerizedWorkloadTasksCount := generate "containerizedWorkloadCounts.tasksCount" }}
{{ $coreCount := generate "coreCount" }}
{{ $cpuCount := generate "cpuCount" }}
{{ $cpuId := generate "cpuId" }}
{{ $createdAt := generate "createdAt" | date "2006-01-02T15:04:05.000000Z" }}
{{ $detectionState := generate "detectionState" }}
{{ $domain := generate "domain" }}
{{ $encryptedApplications := generate "encryptedApplications" }}
{{ $firewallEnabled := generate "firewallEnabled" }}
{{ $groupId := generate "groupId" }}
{{ $groupIp := generate "groupIp" }}
{{ $groupName := generate "groupName" }}
{{ $hasContainerizedWorkload := generate "hasContainerizedWorkload" }}
{{ $id := generate "id" }}
{{ $inRemoteShellSession := generate "inRemoteShellSession" }}
{{ $infected := generate "infected" }}
{{ $installerType := generate "installerType" }}
{{ $ipAddress := generate "ipAddress" }}
{{ $ipV6Address := generate "ipV6Address" }}
{{ $isActive := generate "isActive" }}
{{ $isAdConnector := generate "isAdConnector" }}
{{ $isDecommissioned := generate "isDecommissioned" }}
{{ $isHyperAutomate := generate "isHyperAutomate" }}
{{ $isPendingUninstall := generate "isPendingUninstall" }}
{{ $isUninstalled := generate "isUninstalled" }}
{{ $isUpToDate := generate "isUpToDate" }}
{{ $lastLoggedInUserName := generate "lastLoggedInUserName" }}
{{ $locationEnabled := generate "locationEnabled" }}
{{ $locationType := generate "locationType" }}
{{ $locationsName := generate "locations.name" }}
{{ $locationsScope := generate "locations.scope" }}
{{ $longNumber := generate "longNumber" }}
{{ $macAddress := generate "macAddress" }}
{{ $machineType := generate "machineType" }}
{{ $missingPermissions := generate "missingPermissions" }}
{{ $mitigationMode := generate "mitigationMode" }}
{{ $modelName := generate "modelName" }}
{{ $networkInterfacesName := generate "networkInterfaces.name" }}
{{ $networkQuarantineEnabled := generate "networkQuarantineEnabled" }}
{{ $networkStatus := generate "networkStatus" }}
{{ $operationalState := generate "operationalState" }}
{{ $osArch := generate "osArch" }}
{{ $osName := generate "osName" }}
{{ $osRevision := generate "osRevision" }}
{{ $osStartTime := generate "osStartTime" | date "2006-01-02T15:04:05.000000Z" }}
{{ $osType := generate "osType" }}
{{ $osUsername := generate "osUsername" }}
{{ $proxyStatesConsole := generate "proxyStates.console" }}
{{ $proxyStatesDeepVisibility := generate "proxyStates.deepVisibility" }}
{{ $rangerStatus := generate "rangerStatus" }}
{{ $remoteProfilingState := generate "remoteProfilingState" }}
{{ $scanStatus := generate "scanStatus" }}
{{ $serialNumber := generate "serialNumber" }}
{{ $showAlertIcon := generate "showAlertIcon" }}
{{ $siteId := generate "siteId" }}
{{ $siteName := generate "siteName" }}
{{ $tagsAssignedBy := generate "tags.assignedBy" }}
{{ $tagsKey := generate "tags.key" }}
{{ $tagsValue := generate "tags.value" }}
{{ $threatRebootRequired := generate "threatRebootRequired" }}
{{ $timestamp := generate "timestamp" }}
{{ $totalMemory := generate "totalMemory" }}
{{ $userActionsNeeded := generate "userActionsNeeded" }}
{{ $uuid := generate "uuid" }}
{{/*
{
	"accountId": "{{ $accountId }}",
	"accountName": "{{ $accountName }}",
	"activeDirectory": {
		"computerDistinguishedName": null,
		"computerMemberOf": [],
		"lastUserDistinguishedName": null,
		"lastUserMemberOf": [],
		"userPrincipalName": null
	},
	"activeProtection": ["{{ $activeProtection }}"],
	"activeThreats": {{ $activeThreats }},
	"agentVersion": "{{ $agentVersion }}",
	"allowRemoteShell": {{ $allowRemoteShell }},
	"appsVulnerabilityStatus": "{{ $appsVulnerabilityStatus }}",
	"cloudProviders": {
		"{{ $cloudProviders }}": {
			"cloudAccount": "{{ $cloudAccount }}",
			"cloudImage": "{{ $cloudImage }}",
			"cloudInstanceId": "{{ $longNumber }}",
			"cloudInstanceSize": "{{ $cloudInstanceSize }}",
			"cloudLocation": "{{ $cloudLocation }}",
			"cloudNetwork": "{{ $cloudNetwork }}",
			"cloudTags": ["{{ $cloudTags }}"]
		}
	},
	"computerName": "{{ $computerName }}",
	"consoleMigrationStatus": "N/A",
	"containerizedWorkloadCounts": {
		"podsCount": {{ $containerizedWorkloadPodsCount}},
		"containersCount": {{ $containerizedWorkloadContainersCount }},
		"tasksCount": {{ $containerizedWorkloadTasksCount }}
	},
	"coreCount": {{ $coreCount }},
	"cpuCount": {{ $cpuCount }},
	"cpuId": "{{ $cpuId }}",
	"createdAt": "{{ $createdAt }}",
	"detectionState": "{{ $detectionState }}",
	"domain": "{{ $domain }}",
	"encryptedApplications": {{ $encryptedApplications }},
	"externalId": "",
	"externalIp": "{{ $ipAddress }}",
	"firewallEnabled": {{ $firewallEnabled }},
	"firstFullModeTime": "{{ $createdAt }}",
	"fullDiskScanLastUpdatedAt": "{{ $createdAt }}",
	"groupId": "{{ $groupId }}",
	"groupIp": "{{ $groupIp }}",
	"groupName": "{{ $groupName }}",
	"hasContainerizedWorkload": {{ $hasContainerizedWorkload }},
	"id": "{{ $id }}",
	"inRemoteShellSession": {{ $inRemoteShellSession }},
	"infected": {{ $infected }},
	"installerType": "{{ $installerType }}",
	"isActive": {{ $isActive }},
	"isAdConnector": {{ $isAdConnector }},
	"isDecommissioned": {{ $isDecommissioned }},
	"isHyperAutomate": {{ $isHyperAutomate }},
	"isPendingUninstall": {{ $isPendingUninstall }},
	"isUninstalled": {{ $isUninstalled }},
	"isUpToDate": {{ $isUpToDate }},
	"lastActiveDate": "{{ $createdAt }}",
	"lastIpToMgmt": "{{ $ipAddress }}",
	"lastLoggedInUserName": "{{ $lastLoggedInUserName }}",
	"lastSuccessfulScanDate": "{{ $createdAt }}",
	"licenseKey": "",
	"locationEnabled": {{ $locationEnabled }},
	"locationType": "{{ $locationType }}",
	"locations": [
		{
			"id": "{{ $longNumber }}",
			"name": "{{ $locationsName }}",
			"scope": "{{ $locationsScope }}"
		}
	],
	"machineSid": null,
	"machineType": "{{ $machineType }}",
	"missingPermissions": ["{{ $missingPermissions }}"],
	"mitigationMode": "{{ $mitigationMode }}",
	"mitigationModeSuspicious": "{{ $mitigationMode }}",
	"modelName": "{{ $modelName }}",
	"networkInterfaces": [
		{
			"gatewayIp": "{{ $ipAddress }}",
			"gatewayMacAddress": "{{ $macAddress }}",
			"id": "{{ $longNumber }}",
			"inet": [
				"{{ $ipAddress }}"
			],
			"inet6": [
				"{{ $ipV6Address }}"
			],
			"name": "{{ $networkInterfacesName }}",
			"physical": "{{ $macAddress }}"
		}
	],
	"networkQuarantineEnabled": {{ $networkQuarantineEnabled }},
	"networkStatus": "{{ $networkStatus }}",
	"operationalState": "{{ $operationalState }}",
	"operationalStateExpiration": null,
	"osArch": "{{ $osArch }}",
	"osName": "{{ $osName }}",
	"osRevision": "{{ $osRevision }}",
	"osStartTime": "{{ $osStartTime }}",
	"osType": "{{ $osType }}",
	"osUsername": "{{ $osUsername }}",
	"proxyStates": {
		"console": {{ $proxyStatesConsole }},
		"deepVisibility": {{ $proxyStatesDeepVisibility }}
	},
	"rangerStatus": "{{ $rangerStatus }}",
	"rangerVersion": "{{ $agentVersion }}",
	"registeredAt": "{{ $createdAt }}",
	"remoteProfilingState": "{{ $remoteProfilingState }}",
	"remoteProfilingStateExpiration": null,
	"scanAbortedAt": "{{ $createdAt }}",
	"scanFinishedAt": "{{ $createdAt }}",
	"scanStartedAt": "{{ $createdAt }}",
	"scanStatus": "{{ $scanStatus }}",
	"serialNumber": "{{ $serialNumber }}",
	"showAlertIcon": {{ $showAlertIcon }},
	"siteId": "{{ $siteId }}",
	"siteName": "{{ $siteName }}",
	"storageName": null,
	"storageType": null,
	"tags": {
		"sentinelone": [
			{
				"assignedBy": "{{ $tagsAssignedBy }}",
				"assignedAt": "{{ $createdAt }}",
				"key": "{{ $tagsKey }}",
				"assignedById": "{{ $longNumber }}",
				"id": "{{ $longNumber }}",
				"value": "{{ $tagsValue }}"
			}
		]
	},
	"threatRebootRequired": {{ $threatRebootRequired }},
	"totalMemory": {{ $totalMemory }},
	"updatedAt": "{{ $createdAt }}",
	"userActionsNeeded": ["{{ $userActionsNeeded }}"],
	"uuid": "{{ $uuid }}"
}
*/}}

{
    "@timestamp": "{{ $timestamp.Format "2006-01-02T15:04:05.999999Z07:00" }}",
    "agent": {
        "ephemeral_id": "cdaaaabb-be7e-432f-816b-bda019fd7c15",
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.18.0"
    },
    "data_stream": {
        "dataset": "sentinel_one.agent",
        "namespace": "93724",
        "type": "logs"
    },
    "elastic_agent": {
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "snapshot": false,
        "version": "8.18.0"
    },
    "message": "{\"accountId\":\"{{ $accountId }}\",\"accountName\":\"{{ $accountName }}\",\"activeDirectory\":{\"computerDistinguishedName\":null,\"computerMemberOf\":[],\"lastUserDistinguishedName\":null,\"lastUserMemberOf\":[],\"userPrincipalName\":null},\"activeProtection\":[\"{{ $activeProtection }}\"],\"activeThreats\":{{ $activeThreats }},\"agentVersion\":\"{{ $agentVersion }}\",\"allowRemoteShell\":{{ $allowRemoteShell }},\"appsVulnerabilityStatus\":\"{{ $appsVulnerabilityStatus }}\",\"cloudProviders\":{\"{{ $cloudProviders }}\":{\"cloudAccount\":\"{{ $cloudAccount }}\",\"cloudImage\":\"{{ $cloudImage }}\",\"cloudInstanceId\":\"{{ $longNumber }}\",\"cloudInstanceSize\":\"{{ $cloudInstanceSize }}\",\"cloudLocation\":\"{{ $cloudLocation }}\",\"cloudNetwork\":\"{{ $cloudNetwork }}\",\"cloudTags\":[\"{{ $cloudTags }}\"]}},\"computerName\":\"{{ $computerName }}\",\"consoleMigrationStatus\":\"N/A\",\"containerizedWorkloadCounts\":{\"podsCount\":{{ $containerizedWorkloadPodsCount}},\"containersCount\":{{ $containerizedWorkloadContainersCount}},\"tasksCount\":{{ $containerizedWorkloadTasksCount}}},\"coreCount\":{{ $coreCount }},\"cpuCount\":{{ $cpuCount }},\"cpuId\":\"{{ $cpuId }}\",\"createdAt\":\"{{ $createdAt }}\",\"detectionState\":\"{{ $detectionState }}\",,\"domain\":\"{{ $domain }}\",\"encryptedApplications\":{{ $encryptedApplications }},\"externalId\":\"\",\"externalIp\":\"{{ $ipAddress }}\",\"firewallEnabled\":{{ $firewallEnabled }},\"firstFullModeTime\":\"{{ $createdAt }}\",\"fullDiskScanLastUpdatedAt\":\"{{ $createdAt }}\",\"groupId\":\"{{ $groupId }}\",\"groupIp\":\"{{ $groupIp }}\",\"groupName\":\"{{ $groupName }}\",\"hasContainerizedWorkload\":{{ $hasContainerizedWorkload }},\"id\":\"{{ $id }}\",\"inRemoteShellSession\":{{ $inRemoteShellSession }},\"infected\":{{ $infected }},\"installerType\":\"{{ $installerType }}\",\"isActive\":{{ $isActive }},\"isAdConnector\":{{ $isAdConnector }},\"isDecommissioned\":{{ $isDecommissioned }},\"isHyperAutomate\":{{ $isHyperAutomate }},\"isPendingUninstall\":{{ $isPendingUninstall }},\"isUninstalled\":{{ $isUninstalled }},\"isUpToDate\":{{ $isUpToDate }},\"lastActiveDate\":\"{{ $createdAt }}\",\"lastIpToMgmt\":\"{{ $ipAddress }}\",\"lastLoggedInUserName\":\"{{ $lastLoggedInUserName }}\",\"lastSuccessfulScanDate\":\"{{ $createdAt }}\",\"licenseKey\":\"\",\"locationEnabled\":{{ $locationEnabled }},\"locationType\":\"{{ $locationType }}\",\"locations\":[{\"id\":\"{{ $longNumber }}\",\"name\":\"{{ $locationsName }}\",\"scope\":\"{{ $locationsScope }}\"}],\"machineSid\":null,\"machineType\":\"{{ $machineType }}\",\"missingPermissions\":[\"{{ $missingPermissions }}\"],\"mitigationMode\":\"{{ $mitigationMode }}\",\"mitigationModeSuspicious\":\"{{ $mitigationMode }}\",\"modelName\":\"{{ $modelName }}\",\"networkInterfaces\":[{\"gatewayIp\":\"{{ $ipAddress }}\",\"gatewayMacAddress\":\"{{ $macAddress }}\",\"id\":\"{{ $longNumber }}\",\"inet\":[\"{{ $ipAddress }}\"],\"inet6\":[\"{{ $ipV6Address }}\"],\"name\":\"{{ $networkInterfacesName }}\",\"physical\":\"{{ $macAddress }}\"}],\"networkQuarantineEnabled\":{{ $networkQuarantineEnabled }},\"networkStatus\":\"{{ $networkStatus }}\",\"operationalState\":\"{{ $operationalState }}\",\"operationalStateExpiration\":null,\"osArch\":\"{{ $osArch }}\",\"osName\":\"{{ $osName }}\",\"osRevision\":\"{{ $osRevision }}\",\"osStartTime\":\"{{ $osStartTime }}\",\"osType\":\"{{ $osType }}\",\"osUsername\":\"{{ $osUsername }}\",\"proxyStates\":{\"console\":{{ $proxyStatesConsole }},\"deepVisibility\":{{ $proxyStatesDeepVisibility }}},\"rangerStatus\":\"{{ $rangerStatus }}\",\"rangerVersion\":\"{{ $agentVersion }}\",\"registeredAt\":\"{{ $createdAt }}\",\"remoteProfilingState\":\"{{ $remoteProfilingState }}\",\"remoteProfilingStateExpiration\":null,\"scanAbortedAt\":\"{{ $createdAt }}\",\"scanFinishedAt\":\"{{ $createdAt }}\",\"scanStartedAt\":\"{{ $createdAt }}\",\"scanStatus\":\"{{ $scanStatus }}\",\"serialNumber\":\"{{ $serialNumber }}\",\"showAlertIcon\":{{ $showAlertIcon }},\"siteId\":\"{{ $siteId }}\",\"siteName\":\"{{ $siteName }}\",\"storageName\":null,\"storageType\":null,\"tags\":{\"sentinelone\":[{\"assignedBy\":\"{{ $tagsAssignedBy }}\",\"assignedAt\":\"{{ $createdAt }}\",\"key\":\"{{ $tagsKey }}\",\"assignedById\":\"{{ $longNumber }}\",\"id\":\"{{ $longNumber }}\",\"value\":\"{{ $tagsValue }}\"}]},\"threatRebootRequired\":{{ $threatRebootRequired }},\"totalMemory\":{{ $totalMemory }},\"updatedAt\":\"{{ $createdAt }}\",\"userActionsNeeded\":[\"{{ $userActionsNeeded }}\"],\"uuid\":\"{{ $uuid }}\"}",
    "event": {
        "dataset": "sentinel_one.agent"
    },
    "input": {
        "type": "httpjson"
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "sentinel_one-agent"
    ]
}
