{{- $application := generate "application" }}
{{- $applicationName := generate "applicationName" }}
{{- $applicationVendor := generate "applicationVendor" }}
{{- $applicationVersion := generate "applicationVersion" }}
{{- $baseScore := generate "baseScore" }}
{{- $cveId := generate "cveId" }}
{{- $cvssVersion := generate "cvssVersion" }}
{{- $daysDetected := generate "daysDetected" }}
{{- $detectionDate := generate "detectionDate" }}
{{- $endpointId := generate "endpointId" }}
{{- $endpointName := generate "endpointName" }}
{{- $endpointType := generate "endpointType" }}
{{- $exploitCodeMaturity := generate "exploitCodeMaturity" }}
{{- $id := generate "id" }}
{{- $lastScanDate := generate "lastScanDate" }}
{{- $lastScanResult := generate "lastScanResult" }}
{{- $markType := generate "markType" }}
{{- $markedBy := generate "markedBy" }}
{{- $markedDate := generate "markedDate" }}
{{- $mitigationStatus := generate "mitigationStatus" }}
{{- $mitigationStatusChangeTime := generate "mitigationStatusChangeTime" }}
{{- $mitigationStatusChangedBy := generate "mitigationStatusChangedBy" }}
{{- $mitigationStatusReason := generate "mitigationStatusReason" }}
{{- $nvdBaseScore := generate "nvdBaseScore" }}
{{- $nvdCvssVersion := generate "nvdCvssVersion" }}
{{- $osType := generate "osType" }}
{{- $publishedDate := generate "publishedDate" }}
{{- $reason := generate "reason" }}
{{- $remediationLevel := generate "remediationLevel" }}
{{- $reportConfidence := generate "reportConfidence" }}
{{- $riskScore := generate "riskScore" }}
{{- $severity := generate "severity" }}
{{- $status := generate "status" }}
{{- /*
{
    "application": "{{ $application }}",
    "applicationName": "{{ $applicationName }}",
    "applicationVendor": "{{ $applicationVendor }}",
    "applicationVersion": "{{ $applicationVersion }}",
    "baseScore": "{{ $baseScore }}",
    "cveId": "{{ $cveId }}",
    "cvssVersion": "{{ $cvssVersion }}",
    "daysDetected": "{{ $daysDetected }}",
    "detectionDate": "{{ $detectionDate }}",
    "endpointId": "{{ $endpointId }}",
    "endpointName": "{{ $endpointName }}",
    "endpointType": "{{ $endpointType }}",
    "exploitCodeMaturity": "{{ $exploitCodeMaturity }}",
    "id": "{{ $id }}",
    "lastScanDate": "{{ $lastScanDate }}",
    "lastScanResult": "{{ $lastScanResult }}",
    "markType": "{{ $markType }}",
    "markedBy": "{{ $markedBy }}",
    "markedDate": "{{ $markedDate }}",
    "mitigationStatus": "{{ $mitigationStatus }}",
    "mitigationStatusChangeTime": "{{ $mitigationStatusChangeTime }}",
    "mitigationStatusChangedBy": "{{ $mitigationStatusChangedBy }}",
    "mitigationStatusReason": "{{ $mitigationStatusReason }}",
    "nvdBaseScore": "{{ $nvdBaseScore }}",
    "nvdCvssVersion": "{{ $nvdCvssVersion }}",
    "osType": "{{ $osType }}",
    "publishedDate": "{{ $publishedDate }}",
    "reason": "{{ $reason }}",
    "remediationLevel": "{{ $remediationLevel }}",
    "reportConfidence": "{{ $reportConfidence }}",
    "riskScore": "{{ $riskScore }}",
    "severity": "{{ $severity }}",
    "status": "{{ $status }}"
}
*/ -}}
{
    "@timestamp": "{{ $lastScanDate.Format "2006-01-02T15:04:05.999999Z07:00" }}",
    "agent": {
        "ephemeral_id": "cdaaaabb-be7e-432f-816b-bda019fd7c15",
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.18.0"
    },
    "data_stream": {
        "dataset": "sentinel_one.application_risk",
        "namespace": "93724",
        "type": "logs"
    },
    "elastic_agent": {
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "snapshot": false,
        "version": "8.18.0"
    },
    "message": "{\"application\": \"{{ $application }}\", \"applicationName\": \"{{ $applicationName }}\", \"applicationVendor\": \"{{ $applicationVendor }}\", \"applicationVersion\": \"{{ $applicationVersion }}\", \"baseScore\": \"{{ $baseScore }}\", \"cveId\": \"{{ $cveId }}\", \"cvssVersion\": \"{{ $cvssVersion }}\", \"daysDetected\": \"{{ $daysDetected }}\", \"detectionDate\": \"{{ $detectionDate }}\", \"endpointId\": \"{{ $endpointId }}\", \"endpointName\": \"{{ $endpointName }}\", \"endpointType\": \"{{ $endpointType }}\", \"exploitCodeMaturity\": \"{{ $exploitCodeMaturity }}\", \"id\": \"{{ $id }}\", \"lastScanDate\": \"{{ $lastScanDate }}\", \"lastScanResult\": \"{{ $lastScanResult }}\", \"markType\": \"{{ $markType }}\", \"markedBy\": \"{{ $markedBy }}\", \"markedDate\": \"{{ $markedDate }}\", \"mitigationStatus\": \"{{ $mitigationStatus }}\", \"mitigationStatusChangeTime\": \"{{ $mitigationStatusChangeTime }}\", \"mitigationStatusChangedBy\": \"{{ $mitigationStatusChangedBy }}\", \"mitigationStatusReason\": \"{{ $mitigationStatusReason }}\", \"nvdBaseScore\": \"{{ $nvdBaseScore }}\", \"nvdCvssVersion\": \"{{ $nvdCvssVersion }}\", \"osType\": \"{{ $osType }}\", \"publishedDate\": \"{{ $publishedDate }}\", \"reason\": \"{{ $reason }}\", \"remediationLevel\": \"{{ $remediationLevel }}\", \"reportConfidence\": \"{{ $reportConfidence }}\", \"riskScore\": \"{{ $riskScore }}\", \"severity\": \"{{ $severity }}\", \"status\": \"{{ $status }}\"}",
    "event": {
        "dataset": "sentinel_one.application_risk"
    },
    "input": {
        "type": "cel"
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "sentinel_one-application_risk"
    ]
}
