{{- $timestamp := generate "timestamp" }}
{{- $cursor := generate "cursor" }}
{{- $id := generate "id" }}
{{- $analystVerdict := generate "analystVerdict" }}
{{- $classification := generate "classification" }}
{{- $confidenceLevel := generate "confidenceLevel" }}
{{- $createdAt := generate "createdAt" | date "2006-01-02T15:04:05.000Z" }}
{{- $detectedAt := generate "detectedAt" | date "2006-01-02T15:04:05.000Z" }}
{{- $firstSeenAt := generate "firstSeenAt" | date "2006-01-02T15:04:05.000Z" }}
{{- $lastSeenAt := generate "lastSeenAt" | date "2006-01-02T15:04:05.000Z" }}
{{- $updatedAt := generate "updatedAt" | date "2006-01-02T15:04:05.000Z" }}
{{- $name := generate "name" }}
{{- $result := generate "result" }}
{{- $severity := generate "severity" }}
{{- $status := generate "status" }}
{{- $externalId := generate "externalId" }}
{{- $description := generate "description" }}
{{- $attackSurfaces := generate "attackSurfaces" }}
{{- $analyticsCategory := generate "analytics.category" }}
{{- $analyticsName := generate "analytics.name" }}
{{- $analyticsTypeValue := generate "analytics.typeValue" }}
{{- $detectionSourceProduct := generate "detectionSource.product" }}
{{- $detectionSourceVendor := generate "detectionSource.vendor" }}
{{- $agentUuid := generate "assets.agentUuid" }}
{{- $agentVersion := generate "assets.agentVersion" }}
{{- $assetsOsType := generate "assets.osType" }}
{{- $assetsStatus := generate "assets.status" }}
{{- $processCmdLine := generate "process.cmdLine" }}
{{- $processFileName := generate "process.file.name" }}
{{- $processFilePath := generate "process.file.path" }}
{{- $processFileSha256 := generate "process.file.sha256" }}
{{- $processFileSha1 := generate "process.file.sha1" }}
{{- $processFileMd5 := generate "process.file.md5" }}
{{- $processParentName := generate "process.parentName" }}
{{- $scopeAccountId := generate "detectionTime.scope.accountId" }}
{{- $scopeAccountName := generate "detectionTime.scope.accountName" }}
{{- $scopeSiteName := generate "detectionTime.scope.siteName" }}
{{- $scopeGroupName := generate "detectionTime.scope.groupName" }}
{{- $attackerHost := generate "detectionTime.attacker.host" }}
{{- $targetUserEmail := generate "detectionTime.targetUser.emailAddress" }}
{{- $targetUserName := generate "detectionTime.targetUser.name" }}
{{- $k8sClusterName := generate "detectionTime.assets.kubernetes.clusterName" }}
{{- $k8sNamespaceName := generate "detectionTime.assets.kubernetes.namespaceName" }}
{{- $k8sPodName := generate "detectionTime.assets.kubernetes.podName" }}
{{- $k8sContainerName := generate "detectionTime.assets.kubernetes.containerName" }}
{{- $realtimeAccountId := generate "realTime.scope.account.id" }}
{{- $realtimeSiteName := generate "realTime.scope.site.name" }}
{{- $realtimeGroupName := generate "realTime.scope.group.name" }}
{{- /*
{
    "id": "{{ $id }}",
    "aiInvestigation": null,
    "analystVerdict": "{{ $analystVerdict }}",
    "analytics": {
        "category": "{{ $analyticsCategory }}",
        "name": "{{ $analyticsName }}",
        "typeValue": "{{ $analyticsTypeValue }}",
        "uid": "analytic-uid-001"
    },
    "assets": [
        {
            "accessible": true,
            "agentUuid": "{{ $agentUuid }}",
            "agentVersion": "{{ $agentVersion }}",
            "assetTypeClassifier": "Linux Server",
            "category": "Server",
            "connectivityToConsole": "ONLINE",
            "decommissioned": false,
            "id": "masked00asset000000000001",
            "lastLoggedInUser": null,
            "name": "host-masked",
            "origin": "RESOURCES",
            "osType": "{{ $assetsOsType }}",
            "osVersion": "Linux Ubuntu 24.04.1 LTS 6.8.0-51-generic",
            "pendingReboot": false,
            "policy": "Default",
            "role": "TARGET",
            "status": "{{ $assetsStatus }}",
            "subcategory": "Other Server"
        }
    ],
    "assignee": null,
    "attackSurfaces": [
        "{{ $attackSurfaces }}"
    ],
    "availableActionIds": null,
    "classification": "{{ $classification }}",
    "confidenceLevel": "{{ $confidenceLevel }}",
    "createdAt": "{{ $createdAt }}",
    "dataSources": [],
    "description": "{{ $description }}",
    "detectedAt": "{{ $detectedAt }}",
    "detectionSource": {
        "product": "{{ $detectionSourceProduct }}",
        "vendor": "{{ $detectionSourceVendor }}"
    },
    "detectionTime": {
        "assets": [
            {
                "accessible": true,
                "asset": null,
                "cloud": null,
                "kubernetes": {
                    "clusterName": "{{ $k8sClusterName }}",
                    "containerId": "a1b2c3d4e5f6",
                    "containerImageName": "ubuntu:22.04",
                    "containerLabels": [
                        "app=agent",
                        "tier=security"
                    ],
                    "containerName": "{{ $k8sContainerName }}",
                    "controllerLabels": [
                        "app=sentinel"
                    ],
                    "controllerName": "sentinel-daemonset",
                    "controllerType": "daemonset",
                    "namespaceLabels": [
                        "env=prod"
                    ],
                    "namespaceName": "{{ $k8sNamespaceName }}",
                    "nodeLabels": [
                        "node-role=worker"
                    ],
                    "nodeName": "worker-node-01",
                    "podLabels": [
                        "app=sentinel",
                        "pod-template-hash=xyz99"
                    ],
                    "podName": "{{ $k8sPodName }}"
                },
                "origin": "RESOURCES",
                "scope": {
                    "accountId": "{{ $scopeAccountId }}",
                    "accountName": "{{ $scopeAccountName }}",
                    "groupName": "{{ $scopeGroupName }}",
                    "siteName": "{{ $scopeSiteName }}"
                }
            }
        ],
        "attacker": {
            "host": "{{ $attackerHost }}"
        },
        "scope": {
            "accountId": "{{ $scopeAccountId }}",
            "accountName": "{{ $scopeAccountName }}",
            "groupName": "{{ $scopeGroupName }}",
            "siteName": "{{ $scopeSiteName }}"
        },
        "targetUser": {
            "domain": "example.com",
            "emailAddress": "{{ $targetUserEmail }}",
            "name": "{{ $targetUserName }}"
        }
    },
    "exclusionHash": null,
    "externalId": "{{ $externalId }}",
    "firstSeenAt": "{{ $firstSeenAt }}",
    "lastSeenAt": "{{ $lastSeenAt }}",
    "name": "{{ $name }}",
    "noteExists": false,
    "process": {
        "cmdLine": "{{ $processCmdLine }}",
        "file": {
            "certSubject": "Example Corp",
            "md5": "{{ $processFileMd5 }}",
            "name": "{{ $processFileName }}",
            "path": "{{ $processFilePath }}",
            "sha1": "{{ $processFileSha1 }}",
            "sha256": "{{ $processFileSha256 }}"
        },
        "parentName": "{{ $processParentName }}"
    },
    "realTime": {
        "scope": {
            "account": {
                "id": "{{ $realtimeAccountId }}",
                "name": "{{ $scopeAccountName }}"
            },
            "group": {
                "id": "3334445556667778889",
                "name": "{{ $realtimeGroupName }}"
            },
            "site": {
                "id": "2223334445556667778",
                "name": "{{ $realtimeSiteName }}"
            }
        }
    },
    "result": "{{ $result }}",
    "severity": "{{ $severity }}",
    "sloDetails": {
        "timeToResolveData": {
            "actionComplete": false,
            "actionDue": 30,
            "completion": 3600,
            "completionTime": null,
            "status": "IN_PROGRESS",
            "target": 60,
            "targetTime": "2025-02-05T16:00:00.000Z"
        },
        "timeToResponseData": {
            "actionComplete": true,
            "actionDue": -5,
            "completion": 300,
            "completionTime": "2025-02-04T16:00:00.000Z",
            "status": "MET",
            "target": 15,
            "targetTime": "2025-02-04T15:55:00.000Z"
        }
    },
    "status": "{{ $status }}",
    "storylineId": null,
    "ticketId": null,
    "updatedAt": "{{ $updatedAt }}"
}
*/ -}}
{
    "@timestamp": "{{ $timestamp.Format "2006-01-02T15:04:05.999999Z07:00" }}",
    "agent": {
        "ephemeral_id": "cdaaaabb-be7e-432f-816b-bda019fd7c15",
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.19.7"
    },
    "data_stream": {
        "dataset": "sentinel_one.unified_alert",
        "namespace": "93724",
        "type": "logs"
    },
    "elastic_agent": {
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "snapshot": false,
        "version": "8.19.7"
    },
    "message": "{\"id\":\"{{ $id }}\",\"aiInvestigation\":null,\"analystVerdict\":\"{{ $analystVerdict }}\",\"analytics\":{ \"category\":\"{{ $analyticsCategory }}\", \"name\":\"{{ $analyticsName }}\", \"typeValue\":\"{{ $analyticsTypeValue }}\", \"uid\":\"analytic-uid-001\"},\"assets\":[ {   \"accessible\":true,   \"agentUuid\":\"{{ $agentUuid }}\",   \"agentVersion\":\"{{ $agentVersion }}\",   \"assetTypeClassifier\":\"Linux Server\",   \"category\":\"Server\",   \"connectivityToConsole\":\"ONLINE\",   \"decommissioned\":false,   \"id\":\"masked00asset000000000001\",   \"lastLoggedInUser\":null,   \"name\":\"host-masked\",   \"origin\":\"RESOURCES\",   \"osType\":\"{{ $assetsOsType }}\",   \"osVersion\":\"Linux Ubuntu 24.04.1 LTS 6.8.0-51-generic\",   \"pendingReboot\":false,   \"policy\":\"Default\",   \"role\":\"TARGET\",   \"status\":\"{{ $assetsStatus }}\",   \"subcategory\":\"Other Server\" }],\"assignee\":null,\"attackSurfaces\":[\"{{ $attackSurfaces }}\"],\"availableActionIds\":null,\"classification\":\"{{ $classification }}\",\"confidenceLevel\":\"{{ $confidenceLevel }}\",\"createdAt\":\"{{ $createdAt }}\",\"dataSources\":[],\"description\":\"{{ $description }}\",\"detectedAt\":\"{{ $detectedAt }}\",\"detectionSource\":{ \"product\":\"{{ $detectionSourceProduct }}\", \"vendor\":\"{{ $detectionSourceVendor }}\"},\"detectionTime\":{ \"assets\":[   {     \"accessible\":true,     \"asset\":null,     \"cloud\":null,     \"kubernetes\":{       \"clusterName\":\"{{ $k8sClusterName }}\",       \"containerId\":\"a1b2c3d4e5f6\",       \"containerImageName\":\"ubuntu:22.04\",       \"containerLabels\":[\"app=agent\", \"tier=security\"],       \"containerName\":\"{{ $k8sContainerName }}\",       \"controllerLabels\":[\"app=sentinel\"],       \"controllerName\":\"sentinel-daemonset\",       \"controllerType\":\"daemonset\",       \"namespaceLabels\":[\"env=prod\"],       \"namespaceName\":\"{{ $k8sNamespaceName }}\",       \"nodeLabels\":[\"node-role=worker\"],       \"nodeName\":\"worker-node-01\",       \"podLabels\":[\"app=sentinel\", \"pod-template-hash=xyz99\"],       \"podName\":\"{{ $k8sPodName }}\"     },     \"origin\":\"RESOURCES\",     \"scope\":{       \"accountId\":\"{{ $scopeAccountId }}\",       \"accountName\":\"{{ $scopeAccountName }}\",       \"groupName\":\"{{ $scopeGroupName }}\",       \"siteName\":\"{{ $scopeSiteName }}\"     }   } ], \"attacker\":{ \"host\":\"{{ $attackerHost }}\" }, \"scope\":{   \"accountId\":\"{{ $scopeAccountId }}\",   \"accountName\":\"{{ $scopeAccountName }}\",   \"groupName\":\"{{ $scopeGroupName }}\",   \"siteName\":\"{{ $scopeSiteName }}\" }, \"targetUser\":{   \"domain\":\"example.com\",   \"emailAddress\":\"{{ $targetUserEmail }}\",   \"name\":\"{{ $targetUserName }}\" }},\"exclusionHash\":null,\"externalId\":\"{{ $externalId }}\",\"firstSeenAt\":\"{{ $firstSeenAt }}\",\"lastSeenAt\":\"{{ $lastSeenAt }}\",\"name\":\"{{ $name }}\",\"noteExists\":false,\"process\":{ \"cmdLine\":\"{{ $processCmdLine }}\", \"file\":{   \"certSubject\":\"Example Corp\",   \"md5\":\"{{ $processFileMd5 }}\",   \"name\":\"{{ $processFileName }}\",   \"path\":\"{{ $processFilePath }}\",   \"sha1\":\"{{ $processFileSha1 }}\",   \"sha256\":\"{{ $processFileSha256 }}\" }, \"parentName\":\"{{ $processParentName }}\"},\"realTime\":{ \"scope\":{   \"account\":{     \"id\":\"{{ $realtimeAccountId }}\",     \"name\":\"{{ $scopeAccountName }}\"   },   \"group\":{     \"id\":\"3334445556667778889\",     \"name\":\"{{ $realtimeGroupName }}\"   },   \"site\":{     \"id\":\"2223334445556667778\",     \"name\":\"{{ $realtimeSiteName }}\"   } }},\"result\":\"{{ $result }}\",\"severity\":\"{{ $severity }}\",\"sloDetails\":{ \"timeToResolveData\":{   \"actionComplete\":false,   \"actionDue\":30,   \"completion\":3600,   \"completionTime\":null,   \"status\":\"IN_PROGRESS\",   \"target\":60,   \"targetTime\":\"2025-02-05T16:00:00.000Z\" }, \"timeToResponseData\":{   \"actionComplete\":true,   \"actionDue\":-5,   \"completion\":300,   \"completionTime\":\"2025-02-04T16:00:00.000Z\",   \"status\":\"MET\",   \"target\":15,   \"targetTime\":\"2025-02-04T15:55:00.000Z\" }},\"status\":\"{{ $status }}\",\"storylineId\":null,\"ticketId\":null,\"updatedAt\":\"{{ $updatedAt }}\"}",
    "event": {
        "dataset": "sentinel_one.unified_alert",
    },
    "input": {
        "type": "cel"
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "sentinel_one-unified_alert"
    ]
}
