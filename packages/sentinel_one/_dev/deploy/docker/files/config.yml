rules:
  - path: /web/api/v2.1/activities
    methods: ["GET"]
    query_params:
      sortOrder: asc
      cursor: efgh
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [],
            "pagination": {
              "nextCursor": null,
              "totalItems": 4
            }
          }
          `}}
  - path: /web/api/v2.1/activities
    methods: ["GET"]
    query_params:
      sortOrder: asc
      cursor: abcd
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "accountId": "2234567890123456789",
                "accountName": "Default5",
                "activityType": 1234,
                "agentId": null,
                "agentUpdatedVersion": null,
                "comments": "True",
                "createdAt": "2022-04-21T05:14:08.925421Z",
                "data": {
                  "accountName": "Default",
                  "byUser": "API",
                  "fullScopeDetails": "Account Default",
                  "fullScopeDetailsPath": "test/default",
                  "groupName": null,
                  "newValue": true,
                  "role": "Level",
                  "scopeLevel": "Account",
                  "scopeName": "Default",
                  "siteName": null,
                  "userScope": "account",
                  "username": "API"
                },
                "description": "API",
                "groupId": null,
                "groupName": null,
                "hash": null,
                "id": "1234567890123456789",
                "osFamily": null,
                "primaryDescription": "The management user API enabled Two factor authentication on the user API.",
                "secondaryDescription": null,
                "siteId": null,
                "siteName": null,
                "threatId": null,
                "updatedAt": "2022-04-18T05:14:08.922553Z",
                "userId": "1234567890123456789"
              },
              {
                "accountId": "444567890123456789",
                "accountName": "Default6",
                "activityType": 1234,
                "agentId": null,
                "agentUpdatedVersion": null,
                "comments": null,
                "createdAt": "2022-04-22T05:14:09.240427Z",
                "data": {
                  "accountName": "Default",
                  "fullScopeDetails": "Account Default",
                  "fullScopeDetailsPath": "test/default",
                  "groupName": null,
                  "ipAddress": "81.2.69.144",
                  "reason": null,
                  "role": "Level",
                  "scopeLevel": "Account",
                  "scopeName": "Default",
                  "siteName": null,
                  "source": "src",
                  "userScope": "account",
                  "username": "API"
                },
                "description": null,
                "groupId": null,
                "groupName": null,
                "hash": null,
                "id": "1234567890123456789",
                "osFamily": null,
                "primaryDescription": "The management user API logged in to the management console with IP Address 81.2.69.144",
                "secondaryDescription": null,
                "siteId": null,
                "siteName": null,
                "threatId": null,
                "updatedAt": "2022-04-18T05:14:09.238430Z",
                "userId": "1234567890123456789"
              }
            ],
            "pagination": {
              "nextCursor": "efgh",
              "totalItems": 4
            }
          }
          `}}
  - path: /web/api/v2.1/activities
    methods: ["GET"]
    query_params:
      sortOrder: asc
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "accountId": "3214567890123456789",
                "accountName": "Default12",
                "activityType": 1234,
                "agentId": null,
                "agentUpdatedVersion": null,
                "comments": "True",
                "createdAt": "2022-04-19T05:14:08.925421Z",
                "data": {
                  "accountName": "Default",
                  "byUser": "API",
                  "fullScopeDetails": "Account Default",
                  "fullScopeDetailsPath": "test/default",
                  "groupName": null,
                  "newValue": true,
                  "role": "Level",
                  "scopeLevel": "Account",
                  "scopeName": "Default",
                  "siteName": null,
                  "userScope": "account",
                  "username": "API"
                },
                "description": "API",
                "groupId": null,
                "groupName": null,
                "hash": null,
                "id": "1234567890123456789",
                "osFamily": null,
                "primaryDescription": "The management user API enabled Two factor authentication on the user API.",
                "secondaryDescription": null,
                "siteId": null,
                "siteName": null,
                "threatId": null,
                "updatedAt": "2022-04-18T05:14:08.922553Z",
                "userId": "1234567890123456789"
              },
              {
                "accountId": "1114567890123456789",
                "accountName": "Default4",
                "activityType": 1234,
                "agentId": null,
                "agentUpdatedVersion": null,
                "comments": null,
                "createdAt": "2022-04-20T05:14:09.240427Z",
                "data": {
                  "accountName": "Default",
                  "fullScopeDetails": "Account Default",
                  "fullScopeDetailsPath": "test/default",
                  "groupName": null,
                  "ipAddress": "81.2.69.144",
                  "reason": null,
                  "role": "Level",
                  "scopeLevel": "Account",
                  "scopeName": "Default",
                  "siteName": null,
                  "source": "src",
                  "userScope": "account",
                  "username": "API"
                },
                "description": null,
                "groupId": null,
                "groupName": null,
                "hash": null,
                "id": "1234567890123456789",
                "osFamily": null,
                "primaryDescription": "The management user API logged in to the management console with IP Address 81.2.69.144",
                "secondaryDescription": null,
                "siteId": null,
                "siteName": null,
                "threatId": null,
                "updatedAt": "2022-04-18T05:14:09.238430Z",
                "userId": "1234567890123456789"
              }
            ],
            "pagination": {
              "nextCursor": "abcd",
              "totalItems": 4
            }
          }
          `}}
  - path: /web/api/v2.1/agents
    methods: ["GET"]
    query_params:
      sortOrder: asc
      cursor: efgh
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [],
            "pagination": {
              "nextCursor": null,
              "totalItems": 2
            }
          }
          `}}
  - path: /web/api/v2.1/agents
    methods: ["GET"]
    query_params:
      sortOrder: asc
      cursor: abcd
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "accountId": "9898123451234512345",
                "accountName": "DEF",
                "activeDirectory": {
                  "computerDistinguishedName": null,
                  "computerMemberOf": [],
                  "lastUserDistinguishedName": null,
                  "lastUserMemberOf": []
                },
                "activeThreats": 7,
                "agentVersion": "12.x.x.x",
                "allowRemoteShell": true,
                "appsVulnerabilityStatus": "not_applicable",
                "cloudProviders": {},
                "computerName": "user-test",
                "consoleMigrationStatus": "N/A",
                "coreCount": 2,
                "missingPermissions": [
                  "user-action-needed-bluetooth-per",
                  "user_action_needed_fda"
                ],
                "cpuCount": 2,
                "cpuId": "CPU Name",
                "createdAt": "2022-03-19T09:12:00.519500Z",
                "detectionState": null,
                "domain": "WORKGROUP",
                "encryptedApplications": false,
                "externalId": "",
                "externalIp": "81.2.69.143",
                "firewallEnabled": true,
                "firstFullModeTime": null,
                "groupId": "1234567890123456789",
                "groupIp": "81.2.69.144",
                "groupName": "Default Group",
                "id": "13491234512345",
                "inRemoteShellSession": false,
                "infected": true,
                "installerType": ".msi",
                "isActive": true,
                "isDecommissioned": false,
                "isPendingUninstall": false,
                "isUninstalled": false,
                "isUpToDate": true,
                "lastActiveDate": "2022-03-17T09:51:28.506000Z",
                "lastIpToMgmt": "81.2.69.145",
                "lastLoggedInUserName": "",
                "licenseKey": "",
                "locationEnabled": true,
                "locationType": "not_applicable",
                "locations": null,
                "machineType": "server",
                "mitigationMode": "detect",
                "mitigationModeSuspicious": "detect",
                "modelName": "Compute Engine",
                "networkInterfaces": [
                  {
                    "gatewayIp": "81.2.69.145",
                    "gatewayMacAddress": "00-00-5E-00-53-00",
                    "id": "1234567890123456789",
                    "inet": [
                      "81.2.69.144"
                    ],
                    "inet6": [
                      "2a02:cf40:add:4002:91f2:a9b2:e09a:6fc6"
                    ],
                    "name": "Ethernet",
                    "physical": "00-00-5E-00-53-00"
                  }
                ],
                "networkQuarantineEnabled": false,
                "networkStatus": "connected",
                "operationalState": "na",
                "operationalStateExpiration": null,
                "osArch": "64 bit",
                "osName": "Linux Server",
                "osRevision": "1234",
                "osStartTime": "2022-04-06T08:27:14Z",
                "osType": "linux",
                "osUsername": null,
                "rangerStatus": "Enabled",
                "rangerVersion": "21.x.x.x",
                "registeredAt": "2022-04-06T08:26:45.515278Z",
                "remoteProfilingState": "disabled",
                "remoteProfilingStateExpiration": null,
                "scanAbortedAt": null,
                "scanFinishedAt": "2022-04-06T09:18:21.090855Z",
                "scanStartedAt": "2022-04-06T08:26:52.838047Z",
                "scanStatus": "finished",
                "siteId": "1234567890123456789",
                "siteName": "Default site",
                "storageName": null,
                "storageType": null,
                "tags": {
                  "sentinelone": [
                    {
                      "assignedBy": "test-user",
                      "assignedAt": "2018-02-27T04:49:26.257525Z",
                      "key": "key123",
                      "assignedById": "123456789012345678",
                      "id": "123456789012345678",
                      "value": "value123"
                    }
                  ]
                },
                "threatRebootRequired": false,
                "totalMemory": 1234,
                "updatedAt": "2022-04-07T08:31:47.481227Z",
                "userActionsNeeded": [
                  "reboot_needed"
                ],
                "uuid": "XXX35XXX8Xfb4aX0X1X8X12X343X8X30"
              }
            ],
            "pagination": {
              "nextCursor": "efgh",
              "totalItems": 2
            }
          }
          `}}
  - path: /web/api/v2.1/agents
    methods: ["GET"]
    query_params:
      sortOrder: asc
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "accountId": "892341123451234512345",
                "accountName": "ABC",
                "activeDirectory": {
                  "computerDistinguishedName": null,
                  "computerMemberOf": [],
                  "lastUserDistinguishedName": null,
                  "lastUserMemberOf": []
                },
                "activeThreats": 7,
                "agentVersion": "12.x.x.x",
                "allowRemoteShell": true,
                "appsVulnerabilityStatus": "not_applicable",
                "cloudProviders": {},
                "computerName": "user-test",
                "consoleMigrationStatus": "N/A",
                "coreCount": 2,
                "missingPermissions": [
                  "user-action-needed-bluetooth-per",
                  "user_action_needed_fda"
                ],
                "cpuCount": 2,
                "cpuId": "CPU Name",
                "createdAt": "2022-03-18T09:12:00.519500Z",
                "detectionState": null,
                "domain": "WORKGROUP",
                "encryptedApplications": false,
                "externalId": "",
                "externalIp": "81.2.69.143",
                "firewallEnabled": true,
                "firstFullModeTime": null,
                "groupId": "1234567890123456789",
                "groupIp": "81.2.69.144",
                "groupName": "Default Group",
                "id": "13491234512345",
                "inRemoteShellSession": false,
                "infected": true,
                "installerType": ".msi",
                "isActive": true,
                "isDecommissioned": false,
                "isPendingUninstall": false,
                "isUninstalled": false,
                "isUpToDate": true,
                "lastActiveDate": "2022-03-17T09:51:28.506000Z",
                "lastIpToMgmt": "81.2.69.145",
                "lastLoggedInUserName": "",
                "licenseKey": "",
                "locationEnabled": true,
                "locationType": "not_applicable",
                "locations": null,
                "machineType": "server",
                "mitigationMode": "detect",
                "mitigationModeSuspicious": "detect",
                "modelName": "Compute Engine",
                "networkInterfaces": [
                  {
                    "gatewayIp": "81.2.69.145",
                    "gatewayMacAddress": "00-00-5E-00-53-00",
                    "id": "1234567890123456789",
                    "inet": [
                      "81.2.69.144"
                    ],
                    "inet6": [
                      "2a02:cf40:add:4002:91f2:a9b2:e09a:6fc6"
                    ],
                    "name": "Ethernet",
                    "physical": "00-00-5E-00-53-00"
                  }
                ],
                "networkQuarantineEnabled": false,
                "networkStatus": "connected",
                "operationalState": "na",
                "operationalStateExpiration": null,
                "osArch": "64 bit",
                "osName": "Linux Server",
                "osRevision": "1234",
                "osStartTime": "2022-04-06T08:27:14Z",
                "osType": "linux",
                "osUsername": null,
                "rangerStatus": "Enabled",
                "rangerVersion": "21.x.x.x",
                "registeredAt": "2022-04-06T08:26:45.515278Z",
                "remoteProfilingState": "disabled",
                "remoteProfilingStateExpiration": null,
                "scanAbortedAt": null,
                "scanFinishedAt": "2022-04-06T09:18:21.090855Z",
                "scanStartedAt": "2022-04-06T08:26:52.838047Z",
                "scanStatus": "finished",
                "siteId": "1234567890123456789",
                "siteName": "Default site",
                "storageName": null,
                "storageType": null,
                "tags": {
                  "sentinelone": [
                    {
                      "assignedBy": "test-user",
                      "assignedAt": "2018-02-27T04:49:26.257525Z",
                      "key": "key123",
                      "assignedById": "123456789012345678",
                      "id": "123456789012345678",
                      "value": "value123"
                    }
                  ]
                },
                "threatRebootRequired": false,
                "totalMemory": 1234,
                "updatedAt": "2022-04-07T08:31:47.481227Z",
                "userActionsNeeded": [
                  "reboot_needed"
                ],
                "uuid": "XXX35XXX8Xfb4aX0X1X8X12X343X8X30"
              }
            ],
            "pagination": {
              "nextCursor": "abcd",
              "totalItems": 2
            }
          }
          `}}
  - path: /web/api/v2.1/cloud-detection/alerts
    methods: ["GET"]
    query_params:
      sortOrder: asc
      cursor: efgh
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [],
            "pagination": {
              "totalItems": 2,
              "nextCursor": null
            },
            "errors": [
              {}
            ]
          }
          `}}
  - path: /web/api/v2.1/cloud-detection/alerts
    methods: ["GET"]
    query_params:
      sortOrder: asc
      cursor: abcd
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "targetProcessInfo": {
                  "tgtFileCreatedAt": "2018-02-28T05:49:26.257525Z",
                  "tgtFileIsSigned": "string",
                  "tgtFileOldPath": "string",
                  "tgtProcImagePath": "string",
                  "tgtProcSignedStatus": "string",
                  "tgtFileHashSha256": "2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824",
                  "tgtProcStorylineId": "string",
                  "tgtProcPid": "12345",
                  "tgtProcCmdLine": "string",
                  "tgtProcName": "string",
                  "tgtFileModifiedAt": "2018-02-27T04:49:26.257525Z",
                  "tgtFileId": "string",
                  "tgtProcIntegrityLevel": "unknown",
                  "tgtFileHashSha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                  "tgtProcUid": "string",
                  "tgtProcessStartTime": "2018-02-27T04:49:26.257525Z",
                  "tgtFilePath": "string"
                },
                "alertInfo": {
                  "createdAt": "2018-02-28T06:49:26.257525Z",
                  "srcIp": "81.2.69.142",
                  "incidentStatus": "string",
                  "registryOldValue": "string",
                  "alertId": "123456789123456789",
                  "dstPort": "1234",
                  "indicatorName": "string",
                  "registryPath": "string",
                  "loginType": "string",
                  "dstIp": "81.2.69.144",
                  "updatedAt": "2018-02-27T04:49:26.257525Z",
                  "indicatorDescription": "string",
                  "loginsUserName": "string",
                  "loginIsSuccessful": "string",
                  "indicatorCategory": "string",
                  "modulePath": "string",
                  "loginAccountSid": "string",
                  "dnsResponse": "string",
                  "netEventDirection": "string",
                  "registryValue": "string",
                  "srcMachineIp": "81.2.69.142",
                  "registryOldValueType": "string",
                  "eventType": "info",
                  "analystVerdict": "string",
                  "dvEventId": "string",
                  "dnsRequest": "string",
                  "loginIsAdministratorEquivalent": "string",
                  "loginAccountDomain": "string",
                  "tiIndicatorType": "string",
                  "moduleSha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                  "source": "string",
                  "srcPort": "1234",
                  "tiIndicatorValue": "string",
                  "tiIndicatorSource": "string",
                  "reportedAt": "2018-02-27T04:49:26.257525Z",
                  "registryKeyPath": "string",
                  "tiIndicatorComparisonMethod": "string",
                  "hitType": "Events"
                },
                "sourceProcessInfo": {
                  "integrityLevel": "unknown",
                  "pid": "12345",
                  "fileHashMd5": "5d41402abc4b2a76b9719d911017c592",
                  "filePath": "string",
                  "fileSignerIdentity": "string",
                  "pidStarttime": "2018-02-27T04:49:26.257525Z",
                  "storyline": "string",
                  "fileHashSha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                  "uniqueId": "string",
                  "user": "string",
                  "commandline": "string",
                  "name": "string",
                  "fileHashSha256": "2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824",
                  "subsystem": "unknown"
                },
                "ruleInfo": {
                  "severity": "Low",
                  "treatAsThreat": "UNDEFINED",
                  "id": "string",
                  "scopeLevel": "string",
                  "name": "string",
                  "description": "string"
                },
                "sourceParentProcessInfo": {
                  "integrityLevel": "unknown",
                  "pid": "12345",
                  "fileHashMd5": "5d41402abc4b2a76b9719d911017c592",
                  "filePath": "string",
                  "fileSignerIdentity": "string",
                  "pidStarttime": "2018-02-27T04:49:26.257525Z",
                  "storyline": "string",
                  "fileHashSha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                  "uniqueId": "string",
                  "user": "string",
                  "commandline": "string",
                  "name": "string",
                  "fileHashSha256": "2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824",
                  "subsystem": "unknown"
                },
                "agentDetectionInfo": {
                  "osFamily": "string",
                  "uuid": "string",
                  "osName": "string",
                  "version": "3.x.x.x",
                  "siteId": "123456789123456789",
                  "name": "string",
                  "machineType": "string",
                  "osRevision": "string"
                },
                "kubernetesInfo": {
                  "controllerName": "string",
                  "node": "string",
                  "namespace": "string",
                  "namespaceLabels": "string",
                  "pod": "string",
                  "controllerLabels": "string",
                  "controllerKind": "string",
                  "cluster": "string",
                  "podLabels": "string"
                },
                "containerInfo": {
                  "id": "string",
                  "name": "string",
                  "image": "string",
                  "labels": "string"
                }
              }
            ],
            "pagination": {
              "totalItems": 2,
              "nextCursor": "efgh"
            },
            "errors": [
              {}
            ]
          }
          `}}
  - path: /web/api/v2.1/cloud-detection/alerts
    methods: ["GET"]
    query_params:
      sortOrder: asc
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "data": [
              {
                "targetProcessInfo": {
                  "tgtFileCreatedAt": "2018-02-27T04:49:26.257525Z",
                  "tgtFileIsSigned": "string",
                  "tgtFileOldPath": "string",
                  "tgtProcImagePath": "string",
                  "tgtProcSignedStatus": "string",
                  "tgtFileHashSha256": "2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824",
                  "tgtProcStorylineId": "string",
                  "tgtProcPid": "12345",
                  "tgtProcCmdLine": "string",
                  "tgtProcName": "string",
                  "tgtFileModifiedAt": "2018-02-27T04:49:26.257525Z",
                  "tgtFileId": "string",
                  "tgtProcIntegrityLevel": "unknown",
                  "tgtFileHashSha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                  "tgtProcUid": "string",
                  "tgtProcessStartTime": "2018-02-27T04:49:26.257525Z",
                  "tgtFilePath": "string"
                },
                "alertInfo": {
                  "createdAt": "2018-02-27T04:49:26.257525Z",
                  "srcIp": "81.2.69.142",
                  "incidentStatus": "open",
                  "registryOldValue": "string",
                  "alertId": "888456789123456789",
                  "dstPort": "1234",
                  "indicatorName": "string",
                  "registryPath": "string",
                  "loginType": "login",
                  "dstIp": "81.2.69.144",
                  "updatedAt": "2018-02-27T04:49:26.257525Z",
                  "indicatorDescription": "string",
                  "loginsUserName": "string",
                  "loginIsSuccessful": "string",
                  "indicatorCategory": "string",
                  "modulePath": "string",
                  "loginAccountSid": "string",
                  "dnsResponse": "string",
                  "netEventDirection": "string",
                  "registryValue": "string",
                  "srcMachineIp": "81.2.69.142",
                  "registryOldValueType": "string",
                  "eventType": "info",
                  "analystVerdict": "string",
                  "dvEventId": "string",
                  "dnsRequest": "string",
                  "loginIsAdministratorEquivalent": "string",
                  "loginAccountDomain": "string",
                  "tiIndicatorType": "string",
                  "moduleSha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                  "source": "string",
                  "srcPort": "1234",
                  "tiIndicatorValue": "string",
                  "tiIndicatorSource": "string",
                  "reportedAt": "2018-02-27T04:49:26.257525Z",
                  "registryKeyPath": "string",
                  "tiIndicatorComparisonMethod": "string",
                  "hitType": "Events"
                },
                "sourceProcessInfo": {
                  "integrityLevel": "unknown",
                  "pid": "12345",
                  "fileHashMd5": "5d41402abc4b2a76b9719d911017c592",
                  "filePath": "string",
                  "fileSignerIdentity": "string",
                  "pidStarttime": "2018-02-27T04:49:26.257525Z",
                  "storyline": "string",
                  "fileHashSha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                  "uniqueId": "string",
                  "user": "string",
                  "commandline": "string",
                  "name": "string",
                  "fileHashSha256": "2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824",
                  "subsystem": "unknown"
                },
                "ruleInfo": {
                  "severity": "Low",
                  "treatAsThreat": "UNDEFINED",
                  "id": "string",
                  "scopeLevel": "string",
                  "name": "string",
                  "description": "string"
                },
                "sourceParentProcessInfo": {
                  "integrityLevel": "unknown",
                  "pid": "12345",
                  "fileHashMd5": "5d41402abc4b2a76b9719d911017c592",
                  "filePath": "string",
                  "fileSignerIdentity": "string",
                  "pidStarttime": "2018-02-27T04:49:26.257525Z",
                  "storyline": "string",
                  "fileHashSha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                  "uniqueId": "string",
                  "user": "string",
                  "commandline": "string",
                  "name": "string",
                  "fileHashSha256": "2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824",
                  "subsystem": "unknown"
                },
                "agentDetectionInfo": {
                  "osFamily": "string",
                  "uuid": "string",
                  "osName": "string",
                  "version": "3.x.x.x",
                  "siteId": "123456789123456789",
                  "name": "string",
                  "machineType": "string",
                  "osRevision": "string"
                },
                "kubernetesInfo": {
                  "controllerName": "string",
                  "node": "string",
                  "namespace": "string",
                  "namespaceLabels": "string",
                  "pod": "string",
                  "controllerLabels": "string",
                  "controllerKind": "string",
                  "cluster": "string",
                  "podLabels": "string"
                },
                "containerInfo": {
                  "id": "string",
                  "name": "string",
                  "image": "string",
                  "labels": "string"
                }
              }
            ],
            "pagination": {
              "totalItems": 2,
              "nextCursor": "abcd"
            },
            "errors": [
              {}
            ]
          }
          `}}
  - path: /web/api/v2.1/groups
    methods: ["GET"]
    query_params:
      sortOrder: asc
      cursor: efgh
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [],
            "pagination": {
              "nextCursor": null,
              "totalItems": 4
            }
          }
          `}}
  - path: /web/api/v2.1/groups
    methods: ["GET"]
    query_params:
      sortOrder: asc
      cursor: abcd
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "createdAt": "2022-04-07T16:01:56.928383Z",
                "creator": "Test User3",
                "creatorId": "09099890123456789",
                "filterId": null,
                "filterName": null,
                "id": "18989567890123456789",
                "inherits": true,
                "isDefault": true,
                "name": "Default Group",
                "rank": null,
                "registrationToken": "eyxxxxxxxxxxxxxxxxxxxxkixZxx1xxxxx8xxx2xODA0ZxxxxTIwNjhxxxxxxxxxxxxxxiMWYxx1Ixxnxxxx0=",
                "siteId": "1234567890123456789",
                "totalAgents": 1,
                "type": "static",
                "updatedAt": "2022-04-08T16:01:57.564266Z"
              },
              {
                "createdAt": "2022-04-08T16:01:56.928383Z",
                "creator": "Test Use4r",
                "creatorId": "08884567890123456789",
                "filterId": null,
                "filterName": null,
                "id": "11134567890123456789",
                "inherits": true,
                "isDefault": true,
                "name": "Default Group",
                "rank": null,
                "registrationToken": "eyxxxxxxxxxxxxxxxxxxxxkixZxx1xxxxx8xxx2xODA0ZxxxxTIwNjhxxxxxxxxxxxxxxiMWYxx1Ixxnxxxx0=",
                "siteId": "1234567890123456789",
                "totalAgents": 1,
                "type": "static",
                "updatedAt": "2022-04-09T16:01:57.564266Z"
              }
            ],
            "pagination": {
              "nextCursor": "efgh",
              "totalItems": 4
            }
          }
          `}}
  - path: /web/api/v2.1/groups
    methods: ["GET"]
    query_params:
      sortOrder: asc
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "createdAt": "2022-04-05T16:01:56.928383Z",
                "creator": "Test User",
                "creatorId": "1234567890123456789",
                "filterId": null,
                "filterName": null,
                "id": "1234567890123456789",
                "inherits": true,
                "isDefault": true,
                "name": "Default Group",
                "rank": null,
                "registrationToken": "eyxxxxxxxxxxxxxxxxxxxxkixZxx1xxxxx8xxx2xODA0ZxxxxTIwNjhxxxxxxxxxxxxxxiMWYxx1Ixxnxxxx0=",
                "siteId": "1234567890123456789",
                "totalAgents": 1,
                "type": "static",
                "updatedAt": "2022-04-05T16:01:57.564266Z"
              },
              {
                "createdAt": "2022-04-06T16:01:56.928383Z",
                "creator": "Test User1",
                "creatorId": "3334567890123456789",
                "filterId": null,
                "filterName": null,
                "id": "1333367890123456789",
                "inherits": true,
                "isDefault": true,
                "name": "Default Group",
                "rank": null,
                "registrationToken": "eyxxxxxxxxxxxxxxxxxxxxkixZxx1xxxxx8xxx2xODA0ZxxxxTIwNjhxxxxxxxxxxxxxxiMWYxx1Ixxnxxxx0=",
                "siteId": "1234567890123456789",
                "totalAgents": 1,
                "type": "static",
                "updatedAt": "2022-04-05T16:01:57.564266Z"
              }
            ],
            "pagination": {
              "nextCursor": "abcd",
              "totalItems": 4
            }
          }
          `}}
  - path: /web/api/v2.1/threats
    methods: ["GET"]
    query_params:
      sortOrder: asc
      cursor: efgh
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [],
            "pagination": {
              "nextCursor": null,
              "totalItems": 2
            }
          }
          `}}
  - path: /web/api/v2.1/threats
    methods: ["GET"]
    query_params:
      sortOrder: asc
      cursor: abcd
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "agentDetectionInfo": {
                  "accountId": "111245567890123456789",
                  "accountName": "Default2",
                  "agentDetectionState": null,
                  "agentDomain": "WORKGROUP",
                  "agentIpV4": "127.0.0.1",
                  "agentIpV6": "2a02:cf40::",
                  "agentLastLoggedInUpn": null,
                  "agentLastLoggedInUserMail": null,
                  "agentLastLoggedInUserName": "",
                  "agentMitigationMode": "protect",
                  "agentOsName": "linux",
                  "agentOsRevision": "1234",
                  "agentRegisteredAt": "2022-04-08T08:26:45.515278Z",
                  "agentUuid": "fwfbxxxxxxxxxxqcfjfnxxxxxxxxx",
                  "agentVersion": "21.x.x",
                  "cloudProviders": {},
                  "externalIp": "81.2.69.143",
                  "groupId": "1444567890123456789",
                  "groupName": "Default Group",
                  "siteId": "1234567890123456789",
                  "siteName": "Default site"
                },
                "agentRealtimeInfo": {
                  "accountId": "1456567890123456789",
                  "accountName": "Default2",
                  "activeThreats": 8,
                  "agentComputerName": "test-LINUX",
                  "agentDecommissionedAt": null,
                  "agentDomain": "WORKGROUP",
                  "agentId": "1234567890123456789",
                  "agentInfected": true,
                  "agentIsActive": true,
                  "agentIsDecommissioned": false,
                  "agentMachineType": "server",
                  "agentMitigationMode": "detect",
                  "agentNetworkStatus": "connected",
                  "agentOsName": "linux",
                  "agentOsRevision": "1234",
                  "agentOsType": "linux",
                  "agentUuid": "fwfbxxxxxxxxxxqcfjfnxxxxxxxxx",
                  "agentVersion": "21.x.x.1234",
                  "groupId": "1234567890123456789",
                  "groupName": "Default Group",
                  "networkInterfaces": [
                    {
                      "id": "1234567890123456789",
                      "inet": [
                        "10.0.0.1"
                      ],
                      "inet6": [
                        "2a02:cf40:add:4002:91f2:a9b2:e09a:6fc6"
                      ],
                      "name": "Ethernet",
                      "physical": "DE:AD:00:00:BE:EF"
                    }
                  ],
                  "operationalState": "na",
                  "rebootRequired": false,
                  "scanAbortedAt": null,
                  "scanFinishedAt": "2022-04-09T09:18:21.090855Z",
                  "scanStartedAt": "2022-04-09T08:26:52.838047Z",
                  "scanStatus": "finished",
                  "siteId": "1234567890123456789",
                  "siteName": "Default site",
                  "storageName": null,
                  "storageType": null,
                  "userActionsNeeded": []
                },
                "containerInfo": {
                  "id": null,
                  "image": null,
                  "labels": null,
                  "name": null
                },
                "id": "1234567890123456789",
                "indicators": [],
                "kubernetesInfo": {
                  "cluster": null,
                  "controllerKind": null,
                  "controllerLabels": null,
                  "controllerName": null,
                  "namespace": null,
                  "namespaceLabels": null,
                  "node": null,
                  "pod": null,
                  "podLabels": null
                },
                "mitigationStatus": [
                  {
                    "action": "unquarantine",
                    "actionsCounters": {
                      "failed": 0,
                      "notFound": 0,
                      "pendingReboot": 0,
                      "success": 1,
                      "total": 1
                    },
                    "agentSupportsReport": true,
                    "groupNotFound": false,
                    "lastUpdate": "2022-04-06T08:54:17.198002Z",
                    "latestReport": "/threats/mitigation-report",
                    "mitigationEndedAt": "2022-04-06T08:54:17.101000Z",
                    "mitigationStartedAt": "2022-04-06T08:54:17.101000Z",
                    "status": "success"
                  },
                  {
                    "action": "kill",
                    "actionsCounters": null,
                    "agentSupportsReport": true,
                    "groupNotFound": false,
                    "lastUpdate": "2022-04-06T08:45:55.303355Z",
                    "latestReport": null,
                    "mitigationEndedAt": "2022-04-06T08:45:55.297364Z",
                    "mitigationStartedAt": "2022-04-06T08:45:55.297363Z",
                    "status": "success"
                  }
                ],
                "threatInfo": {
                  "analystVerdict": "undefined",
                  "analystVerdictDescription": "Undefined",
                  "automaticallyResolved": false,
                  "browserType": null,
                  "certificateId": "",
                  "classification": "Trojan",
                  "classificationSource": "Cloud",
                  "cloudFilesHashVerdict": "black",
                  "collectionId": "1234567890123456789",
                  "confidenceLevel": "malicious",
                  "createdAt": "2022-04-06T08:45:54.519988Z",
                  "detectionEngines": [
                    {
                      "key": "sentinelone_cloud",
                      "title": "SentinelOne Cloud"
                    }
                  ],
                  "detectionType": "static",
                  "engines": [
                    "SentinelOne Cloud"
                  ],
                  "externalTicketExists": false,
                  "externalTicketId": null,
                  "failedActions": false,
                  "fileExtension": "EXE",
                  "fileExtensionType": "Executable",
                  "filePath": "default.exe",
                  "fileSize": 1234,
                  "fileVerificationType": "NotSigned",
                  "identifiedAt": "2022-04-06T08:45:53.968000Z",
                  "incidentStatus": "unresolved",
                  "incidentStatusDescription": "Unresolved",
                  "initiatedBy": "agent_policy",
                  "initiatedByDescription": "Agent Policy",
                  "initiatingUserId": null,
                  "initiatingUsername": null,
                  "isFileless": false,
                  "isValidCertificate": false,
                  "maliciousProcessArguments": null,
                  "md5": null,
                  "mitigatedPreemptively": false,
                  "mitigationStatus": "not_mitigated",
                  "mitigationStatusDescription": "Not mitigated",
                  "originatorProcess": "default.exe",
                  "pendingActions": false,
                  "processUser": "test user",
                  "publisherName": "",
                  "reachedEventsLimit": false,
                  "rebootRequired": false,
                  "sha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                  "sha256": null,
                  "storyline": "D0XXXXXXXXXXAF4D",
                  "threatId": "1234567890123456789",
                  "threatName": "default.exe",
                  "updatedAt": "2022-04-06T08:54:17.194122Z"
                },
                "whiteningOptions": [
                  "hash"
                ]
              }
            ],
            "pagination": {
              "nextCursor": "efgh",
              "totalItems": 2
            }
          }
          `}}
  - path: /web/api/v2.1/threats
    methods: ["GET"]
    query_params:
      sortOrder: asc
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "agentDetectionInfo": {
                  "accountId": "1234567890123456789",
                  "accountName": "Default",
                  "agentDetectionState": null,
                  "agentDomain": "WORKGROUP",
                  "agentIpV4": "10.0.0.1",
                  "agentIpV6": "2a02:cf40::",
                  "agentLastLoggedInUpn": null,
                  "agentLastLoggedInUserMail": null,
                  "agentLastLoggedInUserName": "",
                  "agentMitigationMode": "protect",
                  "agentOsName": "linux",
                  "agentOsRevision": "1234",
                  "agentRegisteredAt": "2022-04-06T08:26:45.515278Z",
                  "agentUuid": "fwfbxxxxxxxxxxqcfjfnxxxxxxxxx",
                  "agentVersion": "21.x.x",
                  "cloudProviders": {},
                  "externalIp": "81.2.69.143",
                  "groupId": "1234567890123456789",
                  "groupName": "Default Group",
                  "siteId": "1234567890123456789",
                  "siteName": "Default site"
                },
                "agentRealtimeInfo": {
                  "accountId": "1234567890123456789",
                  "accountName": "Default",
                  "activeThreats": 7,
                  "agentComputerName": "test-LINUX",
                  "agentDecommissionedAt": null,
                  "agentDomain": "WORKGROUP",
                  "agentId": "1234567890123456789",
                  "agentInfected": true,
                  "agentIsActive": true,
                  "agentIsDecommissioned": false,
                  "agentMachineType": "server",
                  "agentMitigationMode": "detect",
                  "agentNetworkStatus": "connected",
                  "agentOsName": "linux",
                  "agentOsRevision": "1234",
                  "agentOsType": "linux",
                  "agentUuid": "fwfbxxxxxxxxxxqcfjfnxxxxxxxxx",
                  "agentVersion": "21.x.x.1234",
                  "groupId": "1234567890123456789",
                  "groupName": "Default Group",
                  "networkInterfaces": [
                    {
                      "id": "1234567890123456789",
                      "inet": [
                        "10.0.0.1"
                      ],
                      "inet6": [
                        "2a02:cf40:add:4002:91f2:a9b2:e09a:6fc6"
                      ],
                      "name": "Ethernet",
                      "physical": "DE:AD:00:00:BE:EF"
                    }
                  ],
                  "operationalState": "na",
                  "rebootRequired": false,
                  "scanAbortedAt": null,
                  "scanFinishedAt": "2022-04-06T09:18:21.090855Z",
                  "scanStartedAt": "2022-04-06T08:26:52.838047Z",
                  "scanStatus": "finished",
                  "siteId": "1234567890123456789",
                  "siteName": "Default site",
                  "storageName": null,
                  "storageType": null,
                  "userActionsNeeded": []
                },
                "containerInfo": {
                  "id": null,
                  "image": null,
                  "labels": null,
                  "name": null
                },
                "id": "1234567890123456789",
                "indicators": [],
                "kubernetesInfo": {
                  "cluster": null,
                  "controllerKind": null,
                  "controllerLabels": null,
                  "controllerName": null,
                  "namespace": null,
                  "namespaceLabels": null,
                  "node": null,
                  "pod": null,
                  "podLabels": null
                },
                "mitigationStatus": [
                  {
                    "action": "unquarantine",
                    "actionsCounters": {
                      "failed": 0,
                      "notFound": 0,
                      "pendingReboot": 0,
                      "success": 1,
                      "total": 1
                    },
                    "agentSupportsReport": true,
                    "groupNotFound": false,
                    "lastUpdate": "2022-04-06T08:54:17.198002Z",
                    "latestReport": "/threats/mitigation-report",
                    "mitigationEndedAt": "2022-04-06T08:54:17.101000Z",
                    "mitigationStartedAt": "2022-04-06T08:54:17.101000Z",
                    "status": "success"
                  },
                  {
                    "action": "kill",
                    "actionsCounters": null,
                    "agentSupportsReport": true,
                    "groupNotFound": false,
                    "lastUpdate": "2022-04-06T08:45:55.303355Z",
                    "latestReport": null,
                    "mitigationEndedAt": "2022-04-06T08:45:55.297364Z",
                    "mitigationStartedAt": "2022-04-06T08:45:55.297363Z",
                    "status": "success"
                  }
                ],
                "threatInfo": {
                  "analystVerdict": "undefined",
                  "analystVerdictDescription": "Undefined",
                  "automaticallyResolved": false,
                  "browserType": null,
                  "certificateId": "",
                  "classification": "Trojan",
                  "classificationSource": "Cloud",
                  "cloudFilesHashVerdict": "black",
                  "collectionId": "1234567890123456789",
                  "confidenceLevel": "malicious",
                  "createdAt": "2022-04-06T08:45:54.519988Z",
                  "detectionEngines": [
                    {
                      "key": "sentinelone_cloud",
                      "title": "SentinelOne Cloud"
                    }
                  ],
                  "detectionType": "static",
                  "engines": [
                    "SentinelOne Cloud"
                  ],
                  "externalTicketExists": false,
                  "externalTicketId": null,
                  "failedActions": false,
                  "fileExtension": "EXE",
                  "fileExtensionType": "Executable",
                  "filePath": "default.exe",
                  "fileSize": 1234,
                  "fileVerificationType": "NotSigned",
                  "identifiedAt": "2022-04-06T08:45:53.968000Z",
                  "incidentStatus": "unresolved",
                  "incidentStatusDescription": "Unresolved",
                  "initiatedBy": "agent_policy",
                  "initiatedByDescription": "Agent Policy",
                  "initiatingUserId": null,
                  "initiatingUsername": null,
                  "isFileless": false,
                  "isValidCertificate": false,
                  "maliciousProcessArguments": null,
                  "md5": null,
                  "mitigatedPreemptively": false,
                  "mitigationStatus": "not_mitigated",
                  "mitigationStatusDescription": "Not mitigated",
                  "originatorProcess": "default.exe",
                  "pendingActions": false,
                  "processUser": "test user",
                  "publisherName": "",
                  "reachedEventsLimit": false,
                  "rebootRequired": false,
                  "sha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                  "sha256": null,
                  "storyline": "D0XXXXXXXXXXAF4D",
                  "threatId": "1234567890123456789",
                  "threatName": "default.exe",
                  "updatedAt": "2022-04-06T08:55:17.194122Z"
                },
                "whiteningOptions": [
                  "hash"
                ]
              }
            ],
            "pagination": {
              "nextCursor": "abcd",
              "totalItems": 2
            }
          }
          `}}
  - path: /web/api/v2.1/application-management/inventory
    methods: ['GET']
    query_params:
      skipCount: "true"
      limit: 2
      cursor: abcd
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "applicationName": "Elastic Agent",
                "applicationVendor": "Elastic",
                "applicationVersionsCount": 1,
                "endpointsCount": 1,
                "estimate": false
              },
              {
                "applicationName": "Git",
                "applicationVendor": "The Git Development Community",
                "applicationVersionsCount": 1,
                "endpointsCount": 1,
                "estimate": false
              }
            ],
            "pagination": {
              "nextCursor": "efgh",
              "totalItems": 0
            }
          }
          `}}
  - path: /web/api/v2.1/application-management/inventory
    methods: ['GET']
    query_params:
      skipCount: "true"
      limit: 2
      cursor: efgh
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "data": [],
            "pagination": {
              "nextCursor": null,
              "totalItems": 0
            }
          }
          `}}
  - path: /web/api/v2.1/application-management/inventory
    methods: ['GET']
    query_params:
      skipCount: "true"
      limit: 2
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "applicationName": "7-Zip",
                "applicationVendor": "Igor Pavlov",
                "applicationVersionsCount": 1,
                "endpointsCount": 1,
                "estimate": false
              },
              {
                "applicationName": "Brave",
                "applicationVendor": "Brave Software Inc",
                "applicationVersionsCount": 1,
                "endpointsCount": 1,
                "estimate": false
              }
            ],
            "pagination": {
              "nextCursor": "abcd",
              "totalItems": 0
            }
          }
          `}}
  - path: /web/api/v2.1/application-management/inventory/endpoints
    methods: ['GET']
    query_params:
      applicationName: Git
      applicationVendor: The Git Development Community
      skipCount: "true"
      limit: 2
      cursor: xxxxx
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "data": [],
            "pagination": {
              "nextCursor": null,
              "totalItems": 0
            }
          }
          `}}
  - path: /web/api/v2.1/application-management/inventory/endpoints
    methods: ['GET']
    query_params:
      applicationName: 7-Zip
      applicationVendor: Igor Pavlov
      skipCount: "true"
      limit: 2
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "accountName": "7-Zip",
                "applicationInstallationDate": "2025-04-13T10:45:01Z",
                "applicationInstallationPath": null,
                "applicationName": "Igor Pavlov",
                "coreCount": 2,
                "cpe": "cpe:2.3:a:abc:igor:8.17.3:*:*:*:*:*:*:*",
                "cpuCount": 1,
                "detectionDate": "2025-06-19T18:00:51.166610Z",
                "endpointId": "216970508828266268",
                "endpointName": "srv-win-defend-03",
                "endpointType": "server",
                "endpointUuid": "eb655be8be894dae97711ebb9a9091ae",
                "fileSize": 517364,
                "groupName": "Default Group",
                "id": "2218357748550497214",
                "osArch": "64 bit",
                "osName": "Windows Server 2022 Datacenter",
                "osType": "windows",
                "osVersion": "Windows Server 2022 Datacenter 20348",
                "siteName": "Default site",
                "version": "8.17.3"
              }
            ],
            "pagination": {
              "nextCursor": null,
              "totalItems": 1
            }
          }
          `}}
  - path: /web/api/v2.1/application-management/inventory/endpoints
    methods: ['GET']
    query_params:
      applicationName: Brave
      applicationVendor: Brave Software Inc
      skipCount: "true"
      limit: 2
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "accountName": "Brave",
                "applicationInstallationDate": "2025-03-13T10:45:01Z",
                "applicationInstallationPath": null,
                "applicationName": "Brave Software Inc",
                "coreCount": 2,
                "cpe": "cpe:2.3:a:elastic:elastic_agent:8.17.3:*:*:*:*:*:*:*",
                "cpuCount": 1,
                "detectionDate": "2025-05-19T18:00:51.166610Z",
                "endpointId": "2169705024028266268",
                "endpointName": "srv-win-defend-03",
                "endpointType": "server",
                "endpointUuid": "eb655be8be894dae97711ebb9a9091ae",
                "fileSize": 517364,
                "groupName": "Default Group",
                "id": "2218357748550497214",
                "osArch": "64 bit",
                "osName": "Windows Server 2022 Datacenter",
                "osType": "windows",
                "osVersion": "Windows Server 2022 Datacenter 20348",
                "siteName": "Default site",
                "version": "8.17.3"
              }
            ],
            "pagination": {
              "nextCursor": null,
              "totalItems": 1
            }
          }
          `}}
  - path: /web/api/v2.1/application-management/inventory/endpoints
    methods: ['GET']
    query_params:
      applicationName: Elastic Agent
      applicationVendor: Elastic
      skipCount: "true"
      limit: 2
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "accountName": "Elastic",
                "applicationInstallationDate": "2025-03-13T10:45:01Z",
                "applicationInstallationPath": null,
                "applicationName": "Elastic Agent",
                "coreCount": 2,
                "cpe": "cpe:2.3:a:elastic:elastic_agent:8.17.3:*:*:*:*:*:*:*",
                "cpuCount": 1,
                "detectionDate": "2025-05-19T18:00:51.166610Z",
                "endpointId": "2169705024028266268",
                "endpointName": "srv-win-defend-03",
                "endpointType": "server",
                "endpointUuid": "eb655be8be894dae97711ebb9a9091ae",
                "fileSize": 517364,
                "groupName": "Default Group",
                "id": "2218357748550497214",
                "osArch": "64 bit",
                "osName": "Windows Server 2022 Datacenter",
                "osType": "windows",
                "osVersion": "Windows Server 2022 Datacenter 20348",
                "siteName": "Default site",
                "version": "8.17.3"
              }
            ],
            "pagination": {
              "nextCursor": null,
              "totalItems": 1
            }
          }
          `}}
  - path: /web/api/v2.1/application-management/inventory/endpoints
    methods: ['GET']
    query_params:
      applicationName: Git
      applicationVendor: The Git Development Community
      skipCount: "true"
      limit: 2
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "data": [
              {
                "accountName": "Git",
                "applicationInstallationDate": "2025-08-13T10:45:01Z",
                "applicationInstallationPath": null,
                "applicationName": "The Git Development Community",
                "coreCount": 2,
                "cpe": "cpe:2.3:a:elastic:git:8.17.3:*:*:*:*:*:*:*",
                "cpuCount": 1,
                "detectionDate": "2025-05-29T18:00:51.166610Z",
                "endpointId": "2169705024028266268",
                "endpointName": "srv-win-defend-05",
                "endpointType": "server",
                "endpointUuid": "eb65e894dae97711ebb9a9091ae",
                "fileSize": 517364,
                "groupName": "Default Group",
                "id": "22183577485514",
                "osArch": "64 bit",
                "osName": "Windows Server 2022 Datacenter",
                "osType": "windows",
                "osVersion": "Windows Server 2022 Datacenter 20348",
                "siteName": "Default site",
                "version": "8.17.3"
              }
            ],
            "pagination": {
              "nextCursor": "xxxxx",
              "totalItems": 1
            }
          }
          `}}
  - path: /web/api/v2.1/application-management/risks
    methods: ['GET']
    query_params:
      limit: 2
      cursor: null
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "data": [
                {
                    "application": "7-Zip 22.01",
                    "applicationName": "7-Zip",
                    "applicationVendor": "Igor Pavlov",
                    "applicationVersion": "22.01",
                    "baseScore": "7.00",
                    "cveId": "CVE-2025-0411",
                    "cvssVersion": "3.1",
                    "daysDetected": 59,
                    "detectionDate": "2025-06-02T04:46:51.710569Z",
                    "endpointId": "2162143406517023959",
                    "endpointName": "test_endpoint",
                    "endpointType": "desktop",
                    "id": "2228104980801805822",
                    "lastScanDate": "2025-07-29T19:25:47Z",
                    "lastScanResult": "Succeeded",
                    "markType": "",
                    "markedBy": null,
                    "markedDate": null,
                    "osType": "windows",
                    "publishedDate": "2025-01-20T07:04:04Z",
                    "reason": null,
                    "severity": "HIGH",
                    "status": "Detected"
                },
                {
                    "application": "7-Zip 22.01",
                    "applicationName": "7-Zip",
                    "applicationVendor": "Igor Pavlov",
                    "applicationVersion": "22.01",
                    "baseScore": "7.80",
                    "cveId": "CVE-2024-11477",
                    "cvssVersion": "3.1",
                    "daysDetected": 59,
                    "detectionDate": "2025-06-02T04:46:51.710578Z",
                    "endpointId": "2162143406517023959",
                    "endpointName": "example_endpoint",
                    "endpointType": "desktop",
                    "id": "2228104981028298282",
                    "lastScanDate": "2025-07-29T19:25:47Z",
                    "lastScanResult": "Succeeded",
                    "markType": "",
                    "markedBy": null,
                    "markedDate": null,
                    "osType": "windows",
                    "publishedDate": "2024-11-21T06:42:16Z",
                    "reason": null,
                    "severity": "HIGH",
                    "status": "Detected"
                }
            ],
            "pagination": {
                "nextCursor": "page2",
                "totalItems": 5
            }
          }
          `}}
  - path: /web/api/v2.1/application-management/risks
    methods: ['GET']
    query_params:
      limit: 2
      cursor: page2
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "data": [
                {
                    "application": "Microsoft Edge 112.0.1722.68",
                    "applicationName": "Microsoft Edge",
                    "applicationVendor": "Microsoft Corporation",
                    "applicationVersion": "112.0.1722.68",
                    "baseScore": "4.30",
                    "cveId": "CVE-2024-29057",
                    "cvssVersion": "3.1",
                    "daysDetected": 59,
                    "detectionDate": "2025-06-02T04:46:51.710587Z",
                    "endpointId": "2162143406517023959",
                    "endpointName": "DESKTOP-example",
                    "endpointType": "desktop",
                    "id": "2228104981036686896",
                    "lastScanDate": "2025-07-29T19:25:47Z",
                    "lastScanResult": "Succeeded",
                    "markType": "",
                    "markedBy": null,
                    "markedDate": null,
                    "osType": "windows",
                    "publishedDate": "2024-03-22T22:15:00Z",
                    "reason": null,
                    "severity": "MEDIUM",
                    "status": "Detected"
                },
                {
                    "application": "Microsoft Edge 112.0.1722.68",
                    "applicationName": "Microsoft Edge",
                    "applicationVendor": "Microsoft Corporation",
                    "applicationVersion": "112.0.1722.68",
                    "baseScore": "6.10",
                    "cveId": "CVE-2024-38156",
                    "cvssVersion": "3.1",
                    "daysDetected": 59,
                    "detectionDate": "2025-06-02T04:46:51.710591Z",
                    "endpointId": "2162143406517023959",
                    "endpointName": "DESKTOP-test",
                    "endpointType": "desktop",
                    "id": "2228104981070241336",
                    "lastScanDate": "2025-07-29T19:25:47Z",
                    "lastScanResult": "Succeeded",
                    "markType": "",
                    "markedBy": null,
                    "markedDate": null,
                    "osType": "windows",
                    "publishedDate": "2024-07-18T05:39:23Z",
                    "reason": null,
                    "severity": "MEDIUM",
                    "status": "Detected"
                }
            ],
            "pagination": {
                "nextCursor": "page3",
                "totalItems": 5
            }
          }
          `}}
  - path: /web/api/v2.1/application-management/risks
    methods: ['GET']
    query_params:
      limit: 2
      cursor: page3
    request_headers:
      Authorization:
        - "ApiToken xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "data": [
                    {
                        "application": "Microsoft Edge 112.0.1722.68",
                        "applicationName": "Microsoft Edge",
                        "applicationVendor": "Microsoft Corporation",
                        "applicationVersion": "112.0.1722.68",
                        "baseScore": "6.50",
                        "cveId": "CVE-2024-38222",
                        "cvssVersion": "3.1",
                        "daysDetected": 59,
                        "detectionDate": "2025-06-02T04:46:51.710593Z",
                        "endpointId": "2162143406517023959",
                        "endpointName": "DESKTOP-R1E2DQ2",
                        "endpointType": "desktop",
                        "id": "2228104981095407166",
                        "lastScanDate": "2025-07-29T19:25:47Z",
                        "lastScanResult": "Succeeded",
                        "markType": "",
                        "markedBy": null,
                        "markedDate": null,
                        "osType": "windows",
                        "publishedDate": "2024-08-13T18:27:28Z",
                        "reason": null,
                        "severity": "MEDIUM",
                        "status": "Detected"
                    }
               ],
               "pagination": {
                   "nextCursor": null,
                   "totalItems": 5
               }
          }
          `}}
