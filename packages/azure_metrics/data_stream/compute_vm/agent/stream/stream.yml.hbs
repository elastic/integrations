metricsets: ["monitor"]
default_resource_type: "Microsoft.Compute/virtualMachines"
add_cloud_metadata: true
period: {{period}}
{{#if client_id}}
client_id: {{client_id}}
{{/if}}
{{#if client_secret}}
client_secret: {{client_secret}}
{{/if}}
{{#if tenant_id}}
tenant_id: {{tenant_id}}
{{/if}}
{{#if subscription_id}}
subscription_id: {{subscription_id}}
{{/if}}
{{#if refresh_list_interval}}
refresh_list_interval: {{refresh_list_interval}}
{{/if}}
{{#if resource_manager_endpoint}}
resource_manager_endpoint: {{resource_manager_endpoint}}
{{/if}}
{{#if active_directory_endpoint}}
active_directory_endpoint: {{active_directory_endpoint}}
{{/if}}

resources:
{{#if resource_groups}}
{{#each resource_groups}}
    - resource_group: "{{this}}"
      resource_type: "Microsoft.Compute/virtualMachines"
      metrics:
        - name: ["Available Memory Bytes","CPU Credits Consumed","CPU Credits Remaining", "Inbound Flows Maximum Creation Rate", "Outbound Flows Maximum Creation Rate", "Disk Read Bytes","Network In Total", "Disk Write Operations/Sec", "Network Out Total", "Disk Read Operations/Sec",
    "Inbound Flows", "Outbound Flows" , "Percentage CPU", "Disk Write Bytes", "OS Disk Queue Depth"]
          namespace: "Microsoft.Compute/virtualMachines"
          timegrain: "PT5M"
          ignore_unsupported: true
        - name: ["Network Interface\\Bytes Received/sec", "Network Interface\\Packets/sec", "Network Interface\\Packets Received/sec", "Network Interface\\Packets Sent/sec","Network Interface\\Packets Outbound Errors", "Network Interface\\Bytes Total/sec", "Network Interface\\Packets Received Errors",
    "Network Interface\\Bytes Sent/sec", "Processor Information\\% Processor Time", "Processor Information\\Processor Frequency", "Processor Information\\% User Time","Processor Information\\% Privileged Time", "Process\\Working Set - Private", "Process\\Working Set", "Process\\Thread Count",
    "Process\\Handle Count","System\\Processes","System\\Processor Queue Length","System\\Context Switches/sec","System\\System Up Time","Memory\\Available Bytes","Memory\\Pool Paged Bytes","Memory\\Pool Nonpaged Bytes","Memory\\Page Faults/sec","Memory\\Pages/sec","Memory\\% Committed Bytes In Use",
    "Memory\\Committed Bytes","Memory\\Cache Bytes", "ASP.NET\\Applications Running","ASP.NET Applications\\Cache Total Entries","ASP.NET Applications\\Transactions/Sec", "ASP.NET Applications\\Requests Succeeded", "ASP.NET Applications\\Errors Unhandled During Execution", "ASP.NET Applications\\Requests In Application Queue",
    "ASP.NET Applications\\Output Cache Entries", "ASP.NET Applications\\Compilations Total", "ASP.NET Applications\\Sessions Timed Out", "ASP.NET Applications\\Debugging Requests", "ASP.NET Applications\\Anonymous Requests/Sec", "ASP.NET Applications\\Transactions Pending", "ASP.NET Applications\\Requests Timed Out",
    "ASP.NET Applications\\Request Bytes In Total", "ASP.NET Applications\\Cache API Hits", "ASP.NET Applications\\Cache API Turnover Rate", "ASP.NET\\Application Restarts", "ASP.NET Applications\\Requests/Sec","ASP.NET Applications\\Errors During Compilation","ASP.NET Applications\\Cache Total Hit Ratio",
    "ASP.NET Applications\\Transactions Committed", "ASP.NET Applications\\Errors Total", "ASP.NET Applications\\Output Cache Turnover Rate", "ASP.NET Applications\\Cache API Entries", "ASP.NET Applications\\Sessions Active", "ASP.NET Applications\\Requests Not Authorized", "ASP.NET Applications\\Requests Not Found",
    "ASP.NET Applications\\Request Bytes Out Total", "ASP.NET Applications\\Errors Total/Sec", "ASP.NET Applications\\Requests Failed", "ASP.NET Applications\\Output Cache Hit Ratio", "ASP.NET Applications\\Pipeline Instance Count", "ASP.NET Applications\\Cache API Hit Ratio","ASP.NET Applications\\Errors Unhandled During Execution",
    "ASP.NET Applications\\Errors Unhandled During Execution/Sec","ASP.NET Applications\\Cache Total Hits","ASP.NET Applications\\Sessions Abandoned", "ASP.NET Applications\\Output Cache Hits", "ASP.NET Applications\\Output Cache Misses", "ASP.NET Applications\\Cache Total Turnover Rate","ASP.NET Applications\\Transactions Total",
    "ASP.NET Applications\\Errors During Preprocessing", "ASP.NET Applications\\Requests Total","ASP.NET Applications\\Cache API Misses", "ASP.NET Applications\\Transactions Aborted","ASP.NET\\Request Wait Time","ASP.NET\\Request Execution Time", "ASP.NET\\Requests Disconnected", "ASP.NET\\Requests Current",
    "ASP.NET\\Requests Rejected", "ASP.NET Applications\\Sessions Total", "ASP.NET\\Worker Process Restarts", "ASP.NET\\Requests Queued", "ASP.NET\\Worker Processes Running","Web Service\\Bytes Total/sec","Web Service\\ISAPI Extension Requests/sec", "Web Service\\Current Connections","Web Service\\Total Method Requests/sec",
    "SQLServer:SQL Statistics\\Batch Requests/sec","SQLServer:Buffer Manager\\Page writes/sec","SQLServer:SQL Statistics\\SQL Compilations/sec","SQLServer:General Statistics\\User Connections","SQLServer:Buffer Manager\\Database pages", "SQLServer:Buffer Manager\\Buffer cache hit ratio","SQLServer:Memory Manager\\Total Server Memory (KB)",
    "SQLServer:SQL Statistics\\SQL Re-Compilations/sec","SQLServer:Buffer Manager\\Page reads/sec", "SQLServer:Buffer Manager\\Lazy writes/sec", "SQLServer:Buffer Manager\\Checkpoint pages/sec","SQLServer:Memory Manager\\Memory Grants Pending"]
          namespace: "Azure.VM.Windows.GuestMetrics"
          timegrain: "PT5M"
          ignore_unsupported: true
        - name: ["disk/inodes_used_percent","disk/free","disk/used_percent","disk/inodes_free_percent","disk/free_percent","disk/used"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "device"
              value: "*"
          ignore_unsupported: true
        - name: ["diskio/io_time","diskio/write_bytes","diskio/total_bytes","diskio/write_time","diskio/read_bytes","diskio/read_time", "diskio/writes","diskio/reads", "diskio/total_transfers","diskio/iops_in_progress"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "Name"
              value: "*"
          ignore_unsupported: true
        - name: ["net/err_out","net/packets_sent","net/err_in","net/bytes_total","net/drop_total","net/packets_recv", "net/bytes_sent","net/bytes_recv"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "interface"
              value: "*"
          ignore_unsupported: true
        - name: ["cpu/usage_iowait","cpu/usage_user","cpu/usage_nice","cpu/usage_irq","cpu/usage_active","cpu/usage_system", "cpu/usage_idle"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "CPU"
              value: "*"
          ignore_unsupported: true
        - name: ["mem/available","mem/used_percent","mem/used","mem/available_percent","swap/used_percent","swap/free_percent", "swap/used","swap/free","kernel_vmstat/total_pages","kernel_vmstat/pgpgout","kernel_vmstat/pgpgin"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "Host"
              value: "*"
          ignore_unsupported: true
{{/each}}
{{/if}}
{{#if resource_ids}}
{{#each resource_ids}}
    - resource_id: "{{this}}"
      metrics:
        - name: ["Available Memory Bytes","CPU Credits Consumed","CPU Credits Remaining", "Inbound Flows Maximum Creation Rate", "Outbound Flows Maximum Creation Rate", "Disk Read Bytes","Network In Total", "Disk Write Operations/Sec", "Network Out Total", "Disk Read Operations/Sec",
            "Inbound Flows", "Outbound Flows" , "Percentage CPU", "Disk Write Bytes", "OS Disk Queue Depth"]
          namespace: "Microsoft.Compute/virtualMachines"
          timegrain: "PT5M"
          ignore_unsupported: true
        - name: ["Network Interface\\Bytes Received/sec", "Network Interface\\Packets/sec", "Network Interface\\Packets Received/sec", "Network Interface\\Packets Sent/sec","Network Interface\\Packets Outbound Errors", "Network Interface\\Bytes Total/sec", "Network Interface\\Packets Received Errors",
    "Network Interface\\Bytes Sent/sec", "Processor Information\\% Processor Time", "Processor Information\\Processor Frequency", "Processor Information\\% User Time","Processor Information\\% Privileged Time", "Process\\Working Set - Private", "Process\\Working Set", "Process\\Thread Count",
    "Process\\Handle Count","System\\Processes","System\\Processor Queue Length","System\\Context Switches/sec","System\\System Up Time","Memory\\Available Bytes","Memory\\Pool Paged Bytes","Memory\\Pool Nonpaged Bytes","Memory\\Page Faults/sec","Memory\\Pages/sec","Memory\\% Committed Bytes In Use",
    "Memory\\Committed Bytes","Memory\\Cache Bytes", "ASP.NET\\Applications Running","ASP.NET Applications\\Cache Total Entries","ASP.NET Applications\\Transactions/Sec", "ASP.NET Applications\\Requests Succeeded", "ASP.NET Applications\\Errors Unhandled During Execution", "ASP.NET Applications\\Requests In Application Queue",
    "ASP.NET Applications\\Output Cache Entries", "ASP.NET Applications\\Compilations Total", "ASP.NET Applications\\Sessions Timed Out", "ASP.NET Applications\\Debugging Requests", "ASP.NET Applications\\Anonymous Requests/Sec", "ASP.NET Applications\\Transactions Pending", "ASP.NET Applications\\Requests Timed Out",
    "ASP.NET Applications\\Request Bytes In Total", "ASP.NET Applications\\Cache API Hits", "ASP.NET Applications\\Cache API Turnover Rate", "ASP.NET\\Application Restarts", "ASP.NET Applications\\Requests/Sec","ASP.NET Applications\\Errors During Compilation","ASP.NET Applications\\Cache Total Hit Ratio",
    "ASP.NET Applications\\Transactions Committed", "ASP.NET Applications\\Errors Total", "ASP.NET Applications\\Output Cache Turnover Rate", "ASP.NET Applications\\Cache API Entries", "ASP.NET Applications\\Sessions Active", "ASP.NET Applications\\Requests Not Authorized", "ASP.NET Applications\\Requests Not Found",
    "ASP.NET Applications\\Request Bytes Out Total", "ASP.NET Applications\\Errors Total/Sec", "ASP.NET Applications\\Requests Failed", "ASP.NET Applications\\Output Cache Hit Ratio", "ASP.NET Applications\\Pipeline Instance Count", "ASP.NET Applications\\Cache API Hit Ratio","ASP.NET Applications\\Errors Unhandled During Execution",
    "ASP.NET Applications\\Errors Unhandled During Execution/Sec","ASP.NET Applications\\Cache Total Hits","ASP.NET Applications\\Sessions Abandoned", "ASP.NET Applications\\Output Cache Hits", "ASP.NET Applications\\Output Cache Misses", "ASP.NET Applications\\Cache Total Turnover Rate","ASP.NET Applications\\Transactions Total",
    "ASP.NET Applications\\Errors During Preprocessing", "ASP.NET Applications\\Requests Total","ASP.NET Applications\\Cache API Misses", "ASP.NET Applications\\Transactions Aborted","ASP.NET\\Request Wait Time","ASP.NET\\Request Execution Time", "ASP.NET\\Requests Disconnected", "ASP.NET\\Requests Current",
    "ASP.NET\\Requests Rejected", "ASP.NET Applications\\Sessions Total", "ASP.NET\\Worker Process Restarts", "ASP.NET\\Requests Queued", "ASP.NET\\Worker Processes Running","Web Service\\Bytes Total/sec","Web Service\\ISAPI Extension Requests/sec", "Web Service\\Current Connections","Web Service\\Total Method Requests/sec",
    "SQLServer:SQL Statistics\\Batch Requests/sec","SQLServer:Buffer Manager\\Page writes/sec","SQLServer:SQL Statistics\\SQL Compilations/sec","SQLServer:General Statistics\\User Connections","SQLServer:Buffer Manager\\Database pages", "SQLServer:Buffer Manager\\Buffer cache hit ratio","SQLServer:Memory Manager\\Total Server Memory (KB)",
    "SQLServer:SQL Statistics\\SQL Re-Compilations/sec","SQLServer:Buffer Manager\\Page reads/sec", "SQLServer:Buffer Manager\\Lazy writes/sec", "SQLServer:Buffer Manager\\Checkpoint pages/sec","SQLServer:Memory Manager\\Memory Grants Pending"]
          namespace: "Azure.VM.Windows.GuestMetrics"
          timegrain: "PT5M"
          ignore_unsupported: true
        - name: ["disk/inodes_used_percent","disk/free","disk/used_percent","disk/inodes_free_percent","disk/free_percent","disk/used"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "device"
              value: "*"
          ignore_unsupported: true
        - name: ["diskio/io_time","diskio/write_bytes","diskio/total_bytes","diskio/write_time","diskio/read_bytes","diskio/read_time", "diskio/writes","diskio/reads", "diskio/total_transfers","diskio/iops_in_progress"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "Name"
              value: "*"
          ignore_unsupported: true
        - name: ["net/err_out","net/packets_sent","net/err_in","net/bytes_total","net/drop_total","net/packets_recv", "net/bytes_sent","net/bytes_recv"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "interface"
              value: "*"
          ignore_unsupported: true
        - name: ["cpu/usage_iowait","cpu/usage_user","cpu/usage_nice","cpu/usage_irq","cpu/usage_active","cpu/usage_system", "cpu/usage_idle"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "CPU"
              value: "*"
          ignore_unsupported: true
        - name: ["mem/available","mem/used_percent","mem/used","mem/available_percent","swap/used_percent","swap/free_percent", "swap/used","swap/free","kernel_vmstat/total_pages","kernel_vmstat/pgpgout","kernel_vmstat/pgpgin"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "Host"
              value: "*"
          ignore_unsupported: true
{{/each}}
{{/if}}
{{#unless resource_ids }}
    {{#unless resource_groups }}
    - resource_query: "resourceType eq 'Microsoft.Compute/virtualMachines'"
      metrics:
        - name: ["Available Memory Bytes","CPU Credits Consumed","CPU Credits Remaining", "Inbound Flows Maximum Creation Rate", "Outbound Flows Maximum Creation Rate", "Disk Read Bytes","Network In Total", "Disk Write Operations/Sec", "Network Out Total", "Disk Read Operations/Sec",
            "Inbound Flows", "Outbound Flows" , "Percentage CPU", "Disk Write Bytes", "OS Disk Queue Depth"]
          namespace: "Microsoft.Compute/virtualMachines"
          timegrain: "PT5M"
          ignore_unsupported: true
        - name: ["Network Interface\\Bytes Received/sec", "Network Interface\\Packets/sec", "Network Interface\\Packets Received/sec", "Network Interface\\Packets Sent/sec","Network Interface\\Packets Outbound Errors", "Network Interface\\Bytes Total/sec", "Network Interface\\Packets Received Errors",
    "Network Interface\\Bytes Sent/sec", "Processor Information\\% Processor Time", "Processor Information\\Processor Frequency", "Processor Information\\% User Time","Processor Information\\% Privileged Time", "Process\\Working Set - Private", "Process\\Working Set", "Process\\Thread Count",
    "Process\\Handle Count","System\\Processes","System\\Processor Queue Length","System\\Context Switches/sec","System\\System Up Time","Memory\\Available Bytes","Memory\\Pool Paged Bytes","Memory\\Pool Nonpaged Bytes","Memory\\Page Faults/sec","Memory\\Pages/sec","Memory\\% Committed Bytes In Use",
    "Memory\\Committed Bytes","Memory\\Cache Bytes", "ASP.NET\\Applications Running","ASP.NET Applications\\Cache Total Entries","ASP.NET Applications\\Transactions/Sec", "ASP.NET Applications\\Requests Succeeded", "ASP.NET Applications\\Errors Unhandled During Execution", "ASP.NET Applications\\Requests In Application Queue",
    "ASP.NET Applications\\Output Cache Entries", "ASP.NET Applications\\Compilations Total", "ASP.NET Applications\\Sessions Timed Out", "ASP.NET Applications\\Debugging Requests", "ASP.NET Applications\\Anonymous Requests/Sec", "ASP.NET Applications\\Transactions Pending", "ASP.NET Applications\\Requests Timed Out",
    "ASP.NET Applications\\Request Bytes In Total", "ASP.NET Applications\\Cache API Hits", "ASP.NET Applications\\Cache API Turnover Rate", "ASP.NET\\Application Restarts", "ASP.NET Applications\\Requests/Sec","ASP.NET Applications\\Errors During Compilation","ASP.NET Applications\\Cache Total Hit Ratio",
    "ASP.NET Applications\\Transactions Committed", "ASP.NET Applications\\Errors Total", "ASP.NET Applications\\Output Cache Turnover Rate", "ASP.NET Applications\\Cache API Entries", "ASP.NET Applications\\Sessions Active", "ASP.NET Applications\\Requests Not Authorized", "ASP.NET Applications\\Requests Not Found",
    "ASP.NET Applications\\Request Bytes Out Total", "ASP.NET Applications\\Errors Total/Sec", "ASP.NET Applications\\Requests Failed", "ASP.NET Applications\\Output Cache Hit Ratio", "ASP.NET Applications\\Pipeline Instance Count", "ASP.NET Applications\\Cache API Hit Ratio","ASP.NET Applications\\Errors Unhandled During Execution",
    "ASP.NET Applications\\Errors Unhandled During Execution/Sec","ASP.NET Applications\\Cache Total Hits","ASP.NET Applications\\Sessions Abandoned", "ASP.NET Applications\\Output Cache Hits", "ASP.NET Applications\\Output Cache Misses", "ASP.NET Applications\\Cache Total Turnover Rate","ASP.NET Applications\\Transactions Total",
    "ASP.NET Applications\\Errors During Preprocessing", "ASP.NET Applications\\Requests Total","ASP.NET Applications\\Cache API Misses", "ASP.NET Applications\\Transactions Aborted","ASP.NET\\Request Wait Time","ASP.NET\\Request Execution Time", "ASP.NET\\Requests Disconnected", "ASP.NET\\Requests Current",
    "ASP.NET\\Requests Rejected", "ASP.NET Applications\\Sessions Total", "ASP.NET\\Worker Process Restarts", "ASP.NET\\Requests Queued", "ASP.NET\\Worker Processes Running","Web Service\\Bytes Total/sec","Web Service\\ISAPI Extension Requests/sec", "Web Service\\Current Connections","Web Service\\Total Method Requests/sec",
    "SQLServer:SQL Statistics\\Batch Requests/sec","SQLServer:Buffer Manager\\Page writes/sec","SQLServer:SQL Statistics\\SQL Compilations/sec","SQLServer:General Statistics\\User Connections","SQLServer:Buffer Manager\\Database pages", "SQLServer:Buffer Manager\\Buffer cache hit ratio","SQLServer:Memory Manager\\Total Server Memory (KB)",
    "SQLServer:SQL Statistics\\SQL Re-Compilations/sec","SQLServer:Buffer Manager\\Page reads/sec", "SQLServer:Buffer Manager\\Lazy writes/sec", "SQLServer:Buffer Manager\\Checkpoint pages/sec","SQLServer:Memory Manager\\Memory Grants Pending"]
          namespace: "Azure.VM.Windows.GuestMetrics"
          timegrain: "PT5M"
          ignore_unsupported: true
        - name: ["disk/inodes_used_percent","disk/free","disk/used_percent","disk/inodes_free_percent","disk/free_percent","disk/used"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "device"
              value: "*"
          ignore_unsupported: true
        - name: ["diskio/io_time","diskio/write_bytes","diskio/total_bytes","diskio/write_time","diskio/read_bytes","diskio/read_time", "diskio/writes","diskio/reads", "diskio/total_transfers","diskio/iops_in_progress"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "Name"
              value: "*"
          ignore_unsupported: true
        - name: ["net/err_out","net/packets_sent","net/err_in","net/bytes_total","net/drop_total","net/packets_recv", "net/bytes_sent","net/bytes_recv"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "interface"
              value: "*"
          ignore_unsupported: true
        - name: ["cpu/usage_iowait","cpu/usage_user","cpu/usage_nice","cpu/usage_irq","cpu/usage_active","cpu/usage_system", "cpu/usage_idle"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "CPU"
              value: "*"
          ignore_unsupported: true
        - name: ["mem/available","mem/used_percent","mem/used","mem/available_percent","swap/used_percent","swap/free_percent", "swap/used","swap/free","kernel_vmstat/total_pages","kernel_vmstat/pgpgout","kernel_vmstat/pgpgin"]
          namespace: "Azure.VM.Linux.GuestMetrics"
          timegrain: "PT5M"
          dimensions:
            - name: "Host"
              value: "*"
          ignore_unsupported: true
    {{/unless}}
{{/unless}}