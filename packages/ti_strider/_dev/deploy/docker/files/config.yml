rules:
  # OAuth token endpoint: POST /auth with client credentials
  - path: /auth
    methods: ["POST"]
    request_headers:
      Content-Type: "application/json"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"access_token": "test_token", "expires_in": 86400, "token_type": "Bearer"}

  # Shield API: GET /api/shield with Bearer token returns IOCs in emailAddresses, emailDomains, terms
  - path: /api/shield
    methods: ["GET"]
    request_headers:
      Authorization: "Bearer test_token"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "emailAddresses": [
              {
                "isNew": 0,
                "md5": "2",
                "itemType": "emailAddress",
                "itemNamePrimary": "test@example.com",
                "riskSignal": "GT",
                "dates_added": "2022-09-20T05:00:00.000Z",
                "itemNameSecondary": "[]",
                "changes": "{}"
              }
            ],
            "emailDomains": [
              {
                "isNew": 1,
                "md5": "1",
                "itemType": "emailDomain",
                "itemNamePrimary": "example.com",
                "riskSignal": "GT",
                "dates_added": "2022-09-20T05:00:00.000Z",
                "itemNameSecondary": "[]",
                "changes": "{}"
              }
            ],
            "terms": []
          }
