# Service Info

## Common use cases

The Cisco Aironet integration for the Elastic Stack enables centralized monitoring and analysis of wireless network activities across Cisco Wireless LAN Controllers (WLC). By ingesting system messages, administrators can gain deep visibility into the health and security of their wireless infrastructure.
- **Wireless Security Auditing:** Monitor client authentication attempts, association/disassociation events, and rogue access point detections to identify potential security threats or unauthorized access attempts.
- **Operational Troubleshooting:** Track system-level events, hardware status changes, and radio frequency (RF) interference alerts to quickly diagnose and resolve connectivity issues for mobile users.
- **Compliance and Reporting:** Maintain a long-term audit trail of administrative configuration changes and system access logs to meet regulatory requirements and internal governance policies.
- **Performance Monitoring:** Analyze logs related to access point (AP) join/leave events and controller load to optimize wireless coverage and capacity planning across a campus or enterprise environment.

## Data types collected

This integration collects several categories of logs via the following data streams:

*   **Cisco Aironet logs:** This data stream provides the core logging capabilities for the integration. Depending on the input method configured, it performs the following:
    *   **UDP/TCP Input:** Collects Cisco Aironet logs sent over the network. These logs include system messages, authentication events, and network status updates.
    *   **Logfile Input:** Collects Cisco Aironet logs from a file. This is used when logs are written to a local disk or a shared mount point.

Specific data categories include:
- **System Messages:** Logs including process status, hardware alerts, and system-level events generated by the WLC software.
- **Network Events:** Specific logs related to wireless protocol transitions, interface status changes, and DHCP/STP events.
- **Security Logs:** Authentication events (RADIUS/TACACS+), unauthorized access attempts, and configuration audit trails.
- **Data Formats:** The integration supports standard Cisco system message formats received via Syslog (RFC 3164/5424) or read directly from local log files, mapping them to the Elastic Common Schema (ECS).

## Compatibility

This integration is compatible with the following third-party vendor versions:
- **Cisco Aironet Wireless LAN Controllers (WLC)** running AireOS firmware (versions 8.x and later).
- Supported hardware includes the Cisco 2504, 3504, 5508, 5520, and 8540 series controllers.

## Scaling and Performance

To ensure optimal performance in high-volume environments, consider the following:

- **Transport/Collection Considerations:** While UDP is faster for syslog transmission, TCP is recommended for environments where delivery guarantees are required. When using UDP, ensure the **read_buffer** in `udp_options` is appropriately sized (default `100MiB`) to prevent packet loss during traffic bursts. For TCP, configure `max_connections` to handle concurrent streams from multiple controllers.
- **Data Volume Management:** Configure the Cisco WLC to forward only necessary events by adjusting the **Syslog Level**. It is recommended to use `Informational` (level 6) or `Warnings` (level 4). Avoid forwarding `Debugging` (level 7) logs in production as they can overwhelm the ingest pipeline and increase CPU load on both the source system and the Elastic Agent.
- **Elastic Agent Scaling:** For high-throughput environments with thousands of Access Points, deploy multiple Elastic Agents behind a network load balancer to distribute traffic evenly. Place Agents close to the data source to minimize latency and potential packet loss over the network.

# Set Up Instructions

## Vendor prerequisites

- **Administrative Access:** High-level administrative credentials (GUI) or Enable-level access (CLI) on the Cisco Wireless LAN Controller is required.
- **Network Connectivity:** Firewall rules must permit traffic from the WLC IP addresses to the Elastic Agent IP address on the configured port (default is `9009`) via TCP or UDP.
- **Feature Licensing:** Ensure the WLC has the appropriate software licenses enabled to support remote syslog forwarding.
- **System Time Synchronization:** It is highly recommended to configure NTP on the Cisco WLC to ensure timestamps in logs are accurate and align with the Elastic Stack environment.

## Elastic prerequisites

- **Elastic Stack Version:** Use Kibana and Elasticsearch version 8.0 or later for full compatibility with integration features.
- **Elastic Agent Installation:** The Elastic Agent must be installed on a host reachable by the Cisco WLC and successfully enrolled in Fleet.
- **Integration Policy:** An Elastic Agent policy must be created or updated to include the Cisco Aironet integration.
- **Input Port Availability:** The host running the Elastic Agent must have the target port (e.g., `9009`) open and not currently bound by another service.

## Vendor set up steps

### For AireOS (Traditional WLC) via Web GUI:
1.  Log in to the Cisco WLC web administration interface.
2.  Navigate to **Management > Logs > Config**.
3.  In the **Syslog Servers** section, locate the next available slot (up to 3 servers can be configured).
4.  Enter the **Syslog Server IP Address**. This is the IP address of the Elastic Agent host.
5.  Click **Add**.
6.  Configure the **Syslog Level** (Severity) from the drop-down menu. It is recommended to select `Informational` (Level 6) for production monitoring.
7.  Configure the **Syslog Facility** from the drop-down menu. The default is `Syslog` (Facility level 5).
8.  Click **Apply** in the top right corner to save the active configuration.
9.  To ensure the settings persist after a reboot, click **Save Configuration** at the top of the page.

### For AireOS (Traditional WLC) via CLI:
1.  Connect to the WLC via SSH or Console.
2.  Enter the command to add the Elastic Agent as a syslog host (up to 3 servers can be configured):
    `config logging syslog host <Elastic_Agent_IP>`
3.  Set the desired severity level (only messages with severity equal to or less than this level will be sent):
    `config logging syslog level <severity_level>`
4.  (Optional) Configure the syslog facility if required for filtering:
    `config logging syslog facility <facility_code>`
5.  (Optional) Enable debug logging to syslog if necessary for deep troubleshooting:
    `config logging debug syslog enable`
6.  Save the configuration to ensure settings persist after a reboot:
    `save config`

### Vendor Set up Resources

*   [Configure Syslog Server on Wireless LAN Controllers - Cisco](https://www.cisco.com/c/en/us/support/docs/wireless/4100-series-wireless-lan-controllers/107252-WLC-Syslog-Server.html) - Official guide for AireOS syslog configuration.

## Kibana set up steps

1.  In Kibana, navigate to **Management > Integrations**.
2.  Search for **Cisco Aironet** and click **Add Cisco Aironet**.
3.  Follow the prompts to add the integration to an Elastic Agent policy.
4.  Configure the available input types based on your vendor setup:

### Collecting logs from Cisco Aironet via TCP
*   **Listen Address** (`tcp_host`): The bind address to listen for TCP connections. Default: `0.0.0.0`.
*   **Listen Port** (`tcp_port`): The TCP port number to listen on. Default: `9009`.
*   **Preserve original event** (`preserve_original_event`): Preserves a raw copy of the original event, added to the field `event.original`. Default: `False`.
*   **Tags** (`tags`): Custom tags to append to the events. Default: `['cisco-aironet', 'forwarded']`.
*   **Timezone** (`tz_offset`): IANA time zone or time offset (e.g. `+0200`) to use when interpreting syslog timestamps without a time zone. Default: `UTC`.
*   **Processors** (`processors`): Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata.
*   **SSL Configuration** (`ssl`): SSL configuration options (e.g., `#certificate: "/etc/server/cert.pem"`).
*   **Custom TCP Options** (`tcp_options`): Specify custom configuration options like `max_connections` or `framing`.

### Collecting logs from Cisco Aironet via UDP
*   **Listen Address** (`udp_host`): The bind address to listen for UDP connections. Default: `0.0.0.0`.
*   **Listen Port** (`udp_port`): The UDP port number to listen on. Default: `9009`.
*   **Preserve original event** (`preserve_original_event`): Preserves a raw copy of the original event, added to the field `event.original`. Default: `False`.
*   **Tags** (`tags`): Custom tags for event categorization. Default: `['cisco-aironet', 'forwarded']`.
*   **Timezone** (`tz_offset`): IANA time zone or time offset used to interpret timestamps. Default: `UTC`.
*   **Custom UDP Options** (`udp_options`): Specify custom configuration options for the UDP input such as `read_buffer` or `max_message_size`.
*   **Processors** (`processors`): Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata.

### Collecting logs from Cisco Aironet via file
*   **Paths** (`paths`): The list of file paths to monitor for log data. Default: `['/var/log/cisco-aironet.log']`.
*   **Preserve original event** (`preserve_original_event`): Preserves a raw copy of the original event, added to the field `event.original`. Default: `False`.
*   **Tags** (`tags`): Custom tags for the file input. Default: `['cisco-aironet', 'forwarded']`.
*   **Timezone** (`tz_offset`): IANA time zone or time offset used to interpret timestamps. Default: `UTC`.
*   **Processors** (`processors`): Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata.

5.  Click **Save and continue** to deploy the configuration to the Elastic Agent.

# Validation Steps

After configuration is complete, verify that data is flowing correctly.

### 1. Trigger Data Flow on Cisco Aironet:
- **Authentication event:** Attempt to log into the WLC web interface or CLI with an incorrect password, then log in successfully to generate auth logs.
- **Configuration event:** Enter configuration mode in the CLI (`config t`) and then exit (`exit`) to trigger a configuration audit event.
- **Interface/AP event:** Power cycle an Access Point or toggle a test interface status using the `shutdown` and `no shutdown` commands to trigger join/disassociation messages.

### 2. Check Data in Kibana:
1. Navigate to **Analytics > Discover**.
2. Select the `logs-*` data view.
3. Enter the KQL filter: `data_stream.dataset : "cisco_aironet.log"`
4. Verify logs appear in the results. Expand a log entry and confirm these fields are populated:
   - `event.dataset` (should be `cisco_aironet.log`)
   - `source.ip` (the IP address of the Cisco WLC)
   - `event.action` or `event.outcome`
   - `log.syslog.priority`
   - `message` (the raw log payload)
5. Navigate to **Analytics > Dashboards** and search for "Cisco Aironet" to view pre-built visualizations.

# Troubleshooting

## Common Configuration Issues

- **Port Mismatch**: Cisco WLCs are frequently hardcoded to send syslog over **UDP port 514**. If the Elastic Agent integration is left at the default **9009**, no data will be received. Ensure the integration's "Listen Port" matches the port the WLC is actually using.
- **Firewall Blocking**: Local host firewalls (iptables/firewalld) or network firewalls may block UDP traffic on port 514 or 9009. Verify connectivity using `tcpdump` or `nc -u -l 514` on the Agent host.
- **WLC Syslog Level**: If no logs are appearing, check that the WLC **Syslog Level** is not set too high (e.g., "Critical" only). Set it to "Informational" to ensure enough data is generated for verification.
- **AP Global Configuration**: If WLC logs arrive but Access Point logs do not, ensure the **AP Remote Syslog Host** IP is specifically set in the Wireless > Global Configuration section.

## Ingestion Errors

- **Parsing Failures**: If logs are ingested but contain the `_grokparsefailure` tag, the syslog format from the WLC may be non-standard. Check the `event.original` field to see if the message matches the expected Cisco format.
- **Format Mismatches**: Cisco WLCs can sometimes include or exclude sequence numbers or timestamps. Ensure the WLC is configured to send standard system messages without excessive custom formatting.
- **Identifying Issues**: Check the `error.message` field in Kibana Discover to identify specific reasons why a message may have failed to process or map to the Elastic Common Schema (ECS).

## Vendor Resources

- [Cisco WLC System Message Guides](https://www.cisco.com/c/en/us/support/wireless/wireless-lan-controller-software/products-system-message-guides-list.html) - Use this to look up specific error codes and mnemonics found in the `message` field.

# Documentation sites

- [Cisco Aironet Integration Reference](https://www.cisco.com/c/en/us/support/wireless/wireless-lan-controller-software/products-system-message-guides-list.html) - Documentation for system message descriptions.
