---
description: Build ECS fields from an OpenCTI windows registry key observable
processors:

  - dissect:
      field: _ingest._value.attribute_key
      pattern: "%{threat.indicator._registry.hive}\\%{threat.indicator._registry.key}"

  # append object
  - append:
      field: threat.indicator.registry
      value: []
  - script:
      description: Append to the destination
      lang: painless
      source: |
        ctx.threat.indicator.registry.add(ctx.threat.indicator._registry);

  - remove:
      field: threat.indicator._registry
