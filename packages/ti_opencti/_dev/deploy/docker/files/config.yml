rules:
  - path: /graphql
    methods: ["POST"]
    request_headers:
      Authorization: "Bearer test_api_key"
      Content-Type: application/json
    request_body: '/"variables":\{"after":null,"first":3,"orderBy":"modified","orderMode":"asc"\}/'
    responses:
      - status_code: 200
        body: |-
          {
            "data": {
              "indicators": {
                "edges": [
                  {
                    "node": {
                      "id": "d019b01c-b637-4eb2-af53-6d527be3193d",
                      "standard_id": "indicator--cde0a6e1-c622-52c4-b857-e9aeac56131b",
                      "is_inferred": false,
                      "revoked": true,
                      "confidence": 15,
                      "lang": "en",
                      "created": "2018-02-05T08:04:53.000Z",
                      "modified": "2023-01-17T05:53:42.851Z",
                      "pattern_type": "stix",
                      "pattern_version": "2.1",
                      "pattern": "[hostname:value = 'ec2-23-21-172-164.compute-1.amazonaws.com']",
                      "name": "ec2-23-21-172-164.compute-1.amazonaws.com",
                      "description": "",
                      "valid_from": "2018-02-05T08:04:53.000Z",
                      "valid_until": "2019-02-05T08:04:53.000Z",
                      "x_opencti_score": 40,
                      "x_opencti_detection": false,
                      "x_opencti_main_observable_type": "Hostname",
                      "createdBy": {
                        "identity_class": "organization",
                        "name": "CthulhuSPRL.be"
                      },
                      "objectMarking": {
                        "edges": [
                          {
                            "node": {
                              "definition_type": "TLP",
                              "definition": "TLP:GREEN"
                            }
                          }
                        ]
                      },
                      "objectLabel": {
                        "edges": [
                          {
                            "node": {
                              "value": "information-credibility-6"
                            }
                          },
                          {
                            "node": {
                              "value": "osint"
                            }
                          }
                        ]
                      },
                      "killChainPhases": {
                        "edges": []
                      },
                      "externalReferences": {
                        "edges": []
                      },
                      "observables": {
                        "edges": [
                          {
                            "node": {
                              "id": "b0a91059-5637-4050-8dce-a976a607f75c",
                              "standard_id": "hostname--2047cd44-ffae-5b34-b912-5856add59b59",
                              "entity_type": "Hostname",
                              "observable_value": "ec2-23-21-172-164.compute-1.amazonaws.com",
                              "value": "ec2-23-21-172-164.compute-1.amazonaws.com"
                            }
                          }
                        ],
                        "pageInfo": {
                          "globalCount": 1
                        }
                      }
                    },
                    "cursor": "WzE2NzM5MzQ4MjI4NTEsImluZGljYXRvci0tY2RlMGE2ZTEtYzYyMi01MmM0LWI4NTctZTlhZWFjNTYxMzFiIl0="
                  },
                  {
                    "node": {
                      "id": "82ecce19-82e6-43e4-9565-70488293b7ec",
                      "standard_id": "indicator--c721b81a-6c3c-55ab-9bf3-038642e8add8",
                      "is_inferred": false,
                      "revoked": true,
                      "confidence": 15,
                      "lang": "en",
                      "created": "2020-08-03T06:40:58.000Z",
                      "modified": "2023-01-17T05:53:43.702Z",
                      "pattern_type": "stix",
                      "pattern_version": "2.1",
                      "pattern": "[ipv4-addr:value = '216.59.38.123']",
                      "name": "216.59.38.123",
                      "description": "associated with statcounter.com. Not malicious",
                      "valid_from": "2020-08-03T06:40:58.000Z",
                      "valid_until": "2020-09-02T06:40:58.000Z",
                      "x_opencti_score": 40,
                      "x_opencti_detection": false,
                      "x_opencti_main_observable_type": "IPv4-Addr",
                      "createdBy": {
                        "identity_class": "organization",
                        "name": "CthulhuSPRL.be"
                      },
                      "objectMarking": {
                        "edges": [
                          {
                            "node": {
                              "definition_type": "TLP",
                              "definition": "TLP:GREEN"
                            }
                          }
                        ]
                      },
                      "objectLabel": {
                        "edges": [
                          {
                            "node": {
                              "value": "information-credibility-6"
                            }
                          },
                          {
                            "node": {
                              "value": "osint"
                            }
                          }
                        ]
                      },
                      "killChainPhases": {
                        "edges": []
                      },
                      "externalReferences": {
                        "edges": []
                      },
                      "observables": {
                        "edges": [
                          {
                            "node": {
                              "id": "097ccc24-9e6b-4a7b-a924-d2acfed68f6f",
                              "standard_id": "ipv4-addr--06ef1f7c-c9f7-536e-abcf-d02ad807426e",
                              "entity_type": "IPv4-Addr",
                              "observable_value": "216.59.38.123",
                              "value": "216.59.38.123"
                            }
                          }
                        ],
                        "pageInfo": {
                          "globalCount": 1
                        }
                      }
                    },
                    "cursor": "WzE2NzM5MzQ4MjM3MDIsImluZGljYXRvci0tYzcyMWI4MWEtNmMzYy01NWFiLTliZjMtMDM4NjQyZThhZGQ4Il0="
                  },
                  {
                    "node": {
                      "id": "c7253531-0832-4839-accd-b2b3ee950465",
                      "standard_id": "indicator--bc622a61-52e0-5785-91d3-c7371f07f15d",
                      "is_inferred": false,
                      "revoked": true,
                      "confidence": 15,
                      "lang": "en",
                      "created": "2018-02-05T08:04:53.000Z",
                      "modified": "2023-01-17T05:53:45.716Z",
                      "pattern_type": "stix",
                      "pattern_version": "2.1",
                      "pattern": "[hostname:value = 'ec2-54-213-146-215.us-west-2.compute.amazonaws.com']",
                      "name": "ec2-54-213-146-215.us-west-2.compute.amazonaws.com",
                      "description": "",
                      "valid_from": "2018-02-05T08:04:53.000Z",
                      "valid_until": "2019-02-05T08:04:53.000Z",
                      "x_opencti_score": 40,
                      "x_opencti_detection": false,
                      "x_opencti_main_observable_type": "Hostname",
                      "createdBy": {
                        "identity_class": "organization",
                        "name": "CthulhuSPRL.be"
                      },
                      "objectMarking": {
                        "edges": [
                          {
                            "node": {
                              "definition_type": "TLP",
                              "definition": "TLP:GREEN"
                            }
                          }
                        ]
                      },
                      "objectLabel": {
                        "edges": [
                          {
                            "node": {
                              "value": "information-credibility-6"
                            }
                          },
                          {
                            "node": {
                              "value": "osint"
                            }
                          }
                        ]
                      },
                      "killChainPhases": {
                        "edges": []
                      },
                      "externalReferences": {
                        "edges": []
                      },
                      "observables": {
                        "edges": [
                          {
                            "node": {
                              "id": "4078386c-15f7-4114-8d87-37f4bed6a98e",
                              "standard_id": "hostname--fa547041-48b7-5dcf-8a25-14f74ae34341",
                              "entity_type": "Hostname",
                              "observable_value": "ec2-54-213-146-215.us-west-2.compute.amazonaws.com",
                              "value": "ec2-54-213-146-215.us-west-2.compute.amazonaws.com"
                            }
                          }
                        ],
                        "pageInfo": {
                          "globalCount": 1
                        }
                      }
                    },
                    "cursor": "WzE2NzM5MzQ4MjU3MTYsImluZGljYXRvci0tYmM2MjJhNjEtNTJlMC01Nzg1LTkxZDMtYzczNzFmMDdmMTVkIl0="
                  }
                ],
                "pageInfo": {
                  "endCursor": "WzE2NzM5MzQ4MjU3MTYsImluZGljYXRvci0tYmM2MjJhNjEtNTJlMC01Nzg1LTkxZDMtYzczNzFmMDdmMTVkIl0=",
                  "hasNextPage": true,
                  "globalCount": 1233582
                }
              }
            }
          }
  - path: /graphql
    methods: ["POST"]
    request_headers:
      Authorization: "Bearer test_api_key"
      Content-Type: application/json
    request_body: '/"variables":\{"after":"WzE2NzM5MzQ4MjU3MTYsImluZGljYXRvci0tYmM2MjJhNjEtNTJlMC01Nzg1LTkxZDMtYzczNzFmMDdmMTVkIl0=","first":3,"orderBy":"modified","orderMode":"asc"\}/'
    responses:
      - status_code: 200
        body: |-
          {
            "data": {
              "indicators": {
                "edges": [
                  {
                    "node": {
                      "id": "e572d399-18e7-4f76-939b-b8b30c2a79b3",
                      "standard_id": "indicator--65e96880-3652-5aa7-b625-b7b0f7103a37",
                      "is_inferred": false,
                      "revoked": true,
                      "confidence": 15,
                      "lang": "en",
                      "created": "2018-02-05T08:04:53.000Z",
                      "modified": "2023-01-17T05:54:00.005Z",
                      "pattern_type": "stix",
                      "pattern_version": "2.1",
                      "pattern": "[hostname:value = 'u.qurl.f.360.cn']",
                      "name": "u.qurl.f.360.cn",
                      "description": "",
                      "valid_from": "2018-02-05T08:04:53.000Z",
                      "valid_until": "2019-02-05T08:04:53.000Z",
                      "x_opencti_score": 40,
                      "x_opencti_detection": false,
                      "x_opencti_main_observable_type": "Hostname",
                      "createdBy": {
                        "identity_class": "organization",
                        "name": "CthulhuSPRL.be"
                      },
                      "objectMarking": {
                        "edges": [
                          {
                            "node": {
                              "definition_type": "TLP",
                              "definition": "TLP:GREEN"
                            }
                          }
                        ]
                      },
                      "objectLabel": {
                        "edges": [
                          {
                            "node": {
                              "value": "information-credibility-6"
                            }
                          },
                          {
                            "node": {
                              "value": "osint"
                            }
                          }
                        ]
                      },
                      "killChainPhases": {
                        "edges": []
                      },
                      "externalReferences": {
                        "edges": []
                      },
                      "observables": {
                        "edges": [
                          {
                            "node": {
                              "id": "40db29c4-2c47-468d-a0e7-8fe0a8900b5b",
                              "standard_id": "hostname--28a13762-5863-5f5c-8b12-1dc22012be30",
                              "entity_type": "Hostname",
                              "observable_value": "u.qurl.f.360.cn",
                              "value": "u.qurl.f.360.cn"
                            }
                          }
                        ],
                        "pageInfo": {
                          "globalCount": 1
                        }
                      }
                    },
                    "cursor": "WzE2NzM5MzQ4NDAwMDUsImluZGljYXRvci0tNjVlOTY4ODAtMzY1Mi01YWE3LWI2MjUtYjdiMGY3MTAzYTM3Il0="
                  },
                  {
                    "node": {
                      "id": "f123bd58-30c9-43c8-b3e9-28cc0740afca",
                      "standard_id": "indicator--62337ac9-3e17-50db-8c67-4a499cbca0a4",
                      "is_inferred": false,
                      "revoked": true,
                      "confidence": 15,
                      "lang": "en",
                      "created": "2018-02-05T08:04:53.000Z",
                      "modified": "2023-01-17T05:54:00.557Z",
                      "pattern_type": "stix",
                      "pattern_version": "2.1",
                      "pattern": "[hostname:value = 'ec2-184-73-167-20.compute-1.amazonaws.com']",
                      "name": "ec2-184-73-167-20.compute-1.amazonaws.com",
                      "description": "",
                      "valid_from": "2018-02-05T08:04:53.000Z",
                      "valid_until": "2019-02-05T08:04:53.000Z",
                      "x_opencti_score": 40,
                      "x_opencti_detection": false,
                      "x_opencti_main_observable_type": "Hostname",
                      "createdBy": {
                        "identity_class": "organization",
                        "name": "CthulhuSPRL.be"
                      },
                      "objectMarking": {
                        "edges": [
                          {
                            "node": {
                              "definition_type": "TLP",
                              "definition": "TLP:GREEN"
                            }
                          }
                        ]
                      },
                      "objectLabel": {
                        "edges": [
                          {
                            "node": {
                              "value": "information-credibility-6"
                            }
                          },
                          {
                            "node": {
                              "value": "osint"
                            }
                          }
                        ]
                      },
                      "killChainPhases": {
                        "edges": []
                      },
                      "externalReferences": {
                        "edges": []
                      },
                      "observables": {
                        "edges": [
                          {
                            "node": {
                              "id": "a3a83289-8944-48aa-96de-5e85a858483b",
                              "standard_id": "hostname--e5be9e2f-bdba-5eaf-b922-d6ab59868864",
                              "entity_type": "Hostname",
                              "observable_value": "ec2-184-73-167-20.compute-1.amazonaws.com",
                              "value": "ec2-184-73-167-20.compute-1.amazonaws.com"
                            }
                          }
                        ],
                        "pageInfo": {
                          "globalCount": 1
                        }
                      }
                    },
                    "cursor": "WzE2NzM5MzQ4NDA1NTcsImluZGljYXRvci0tNjIzMzdhYzktM2UxNy01MGRiLThjNjctNGE0OTljYmNhMGE0Il0="
                  },
                  {
                    "node": {
                      "id": "225c9e43-8b63-482b-a6af-897ab7f0d289",
                      "standard_id": "indicator--5f95a26a-f9f0-5f8d-9d37-c912539462e3",
                      "is_inferred": false,
                      "revoked": true,
                      "confidence": 15,
                      "lang": "en",
                      "created": "2018-02-05T08:04:53.000Z",
                      "modified": "2023-01-17T05:54:00.810Z",
                      "pattern_type": "stix",
                      "pattern_version": "2.1",
                      "pattern": "[hostname:value = 'ec2-52-28-3-6.eu-central-1.compute.amazonaws.com']",
                      "name": "ec2-52-28-3-6.eu-central-1.compute.amazonaws.com",
                      "description": "",
                      "valid_from": "2018-02-05T08:04:53.000Z",
                      "valid_until": "2019-02-05T08:04:53.000Z",
                      "x_opencti_score": 40,
                      "x_opencti_detection": false,
                      "x_opencti_main_observable_type": "Hostname",
                      "createdBy": {
                        "identity_class": "organization",
                        "name": "CthulhuSPRL.be"
                      },
                      "objectMarking": {
                        "edges": [
                          {
                            "node": {
                              "definition_type": "TLP",
                              "definition": "TLP:GREEN"
                            }
                          }
                        ]
                      },
                      "objectLabel": {
                        "edges": [
                          {
                            "node": {
                              "value": "information-credibility-6"
                            }
                          },
                          {
                            "node": {
                              "value": "osint"
                            }
                          }
                        ]
                      },
                      "killChainPhases": {
                        "edges": []
                      },
                      "externalReferences": {
                        "edges": []
                      },
                      "observables": {
                        "edges": [
                          {
                            "node": {
                              "id": "ac752342-67e9-4f6e-a5f0-01eb1efad4b0",
                              "standard_id": "hostname--9ff39d75-f242-561a-a1f4-17cec6d7759b",
                              "entity_type": "Hostname",
                              "observable_value": "ec2-52-28-3-6.eu-central-1.compute.amazonaws.com",
                              "value": "ec2-52-28-3-6.eu-central-1.compute.amazonaws.com"
                            }
                          }
                        ],
                        "pageInfo": {
                          "globalCount": 1
                        }
                      }
                    },
                    "cursor": "WzE2NzM5MzQ4NDA4MTAsImluZGljYXRvci0tNWY5NWEyNmEtZjlmMC01ZjhkLTlkMzctYzkxMjUzOTQ2MmUzIl0="
                  }
                ],
                "pageInfo": {
                  "endCursor": "WzE2NzM5MzQ4NDA4MTAsImluZGljYXRvci0tNWY5NWEyNmEtZjlmMC01ZjhkLTlkMzctYzkxMjUzOTQ2MmUzIl0=",
                  "hasNextPage": true,
                  "globalCount": 1233582
                }
              }
            }
          }
  - path: /graphql
    methods: ["POST"]
    request_headers:
      Authorization: "Bearer test_api_key"
      Content-Type: application/json
    request_body: '/"variables":\{"after":"WzE2NzM5MzQ4NDA4MTAsImluZGljYXRvci0tNWY5NWEyNmEtZjlmMC01ZjhkLTlkMzctYzkxMjUzOTQ2MmUzIl0=","first":3,"orderBy":"modified","orderMode":"asc"\}/'
    responses:
      - status_code: 200
        body: |-
          {
            "data": {
              "indicators": {
                "edges": [
                  {
                    "node": {
                      "id": "2b3fe8d7-29d9-403b-9454-2be96af85d7b",
                      "standard_id": "indicator--52fd9e7a-2ea9-5e9a-9aa0-9bea534c5158",
                      "is_inferred": false,
                      "revoked": true,
                      "confidence": 15,
                      "lang": "en",
                      "created": "2020-08-03T06:40:55.000Z",
                      "modified": "2023-01-17T05:54:02.636Z",
                      "pattern_type": "stix",
                      "pattern_version": "2.1",
                      "pattern": "[ipv4-addr:value = '67.215.253.139']",
                      "name": "67.215.253.139",
                      "description": "Ip used at statcounter.com not malicious",
                      "valid_from": "2020-08-03T06:40:55.000Z",
                      "valid_until": "2020-09-02T06:40:55.000Z",
                      "x_opencti_score": 40,
                      "x_opencti_detection": false,
                      "x_opencti_main_observable_type": "IPv4-Addr",
                      "createdBy": {
                        "identity_class": "organization",
                        "name": "CthulhuSPRL.be"
                      },
                      "objectMarking": {
                        "edges": [
                          {
                            "node": {
                              "definition_type": "TLP",
                              "definition": "TLP:GREEN"
                            }
                          }
                        ]
                      },
                      "objectLabel": {
                        "edges": [
                          {
                            "node": {
                              "value": "information-credibility-6"
                            }
                          },
                          {
                            "node": {
                              "value": "osint"
                            }
                          }
                        ]
                      },
                      "killChainPhases": {
                        "edges": []
                      },
                      "externalReferences": {
                        "edges": []
                      },
                      "observables": {
                        "edges": [
                          {
                            "node": {
                              "id": "6b50c3cc-bdd1-425c-8926-e12508d42207",
                              "standard_id": "ipv4-addr--0c358a87-b85a-5871-9b38-f2512d3f42af",
                              "entity_type": "IPv4-Addr",
                              "observable_value": "67.215.253.139",
                              "value": "67.215.253.139"
                            }
                          }
                        ],
                        "pageInfo": {
                          "globalCount": 1
                        }
                      }
                    },
                    "cursor": "WzE2NzM5MzQ4NDI2MzYsImluZGljYXRvci0tNTJmZDllN2EtMmVhOS01ZTlhLTlhYTAtOWJlYTUzNGM1MTU4Il0="
                  },
                  {
                    "node": {
                      "id": "f18778b9-f692-490d-9971-72012ea86520",
                      "standard_id": "indicator--363accc6-ab9b-5776-bb80-21abe4a049ce",
                      "is_inferred": false,
                      "revoked": true,
                      "confidence": 15,
                      "lang": "en",
                      "created": "2018-02-05T08:04:53.000Z",
                      "modified": "2023-01-17T05:54:07.310Z",
                      "pattern_type": "stix",
                      "pattern_version": "2.1",
                      "pattern": "[hostname:value = 'ec2-184-73-214-203.compute-1.amazonaws.com']",
                      "name": "ec2-184-73-214-203.compute-1.amazonaws.com",
                      "description": "",
                      "valid_from": "2018-02-05T08:04:53.000Z",
                      "valid_until": "2019-02-05T08:04:53.000Z",
                      "x_opencti_score": 40,
                      "x_opencti_detection": false,
                      "x_opencti_main_observable_type": "Hostname",
                      "createdBy": {
                        "identity_class": "organization",
                        "name": "CthulhuSPRL.be"
                      },
                      "objectMarking": {
                        "edges": [
                          {
                            "node": {
                              "definition_type": "TLP",
                              "definition": "TLP:GREEN"
                            }
                          }
                        ]
                      },
                      "objectLabel": {
                        "edges": [
                          {
                            "node": {
                              "value": "information-credibility-6"
                            }
                          },
                          {
                            "node": {
                              "value": "osint"
                            }
                          }
                        ]
                      },
                      "killChainPhases": {
                        "edges": []
                      },
                      "externalReferences": {
                        "edges": []
                      },
                      "observables": {
                        "edges": [
                          {
                            "node": {
                              "id": "ecf998aa-1cd9-4479-aecc-e5c05d714f78",
                              "standard_id": "hostname--1c12531c-65b4-5926-b58c-366c46982088",
                              "entity_type": "Hostname",
                              "observable_value": "ec2-184-73-214-203.compute-1.amazonaws.com",
                              "value": "ec2-184-73-214-203.compute-1.amazonaws.com"
                            }
                          }
                        ],
                        "pageInfo": {
                          "globalCount": 1
                        }
                      }
                    },
                    "cursor": "WzE2NzM5MzQ4NDczMTAsImluZGljYXRvci0tMzYzYWNjYzYtYWI5Yi01Nzc2LWJiODAtMjFhYmU0YTA0OWNlIl0="
                  },
                  {
                    "node": {
                      "id": "32b60cc0-4b03-4b28-8436-0979ae34712e",
                      "standard_id": "indicator--35e958f3-978e-56a9-9801-121c92a7142e",
                      "is_inferred": false,
                      "revoked": true,
                      "confidence": 15,
                      "lang": "en",
                      "created": "2018-02-05T08:04:53.000Z",
                      "modified": "2023-01-17T05:54:07.355Z",
                      "pattern_type": "stix",
                      "pattern_version": "2.1",
                      "pattern": "[hostname:value = 'ec2-52-28-249-128.eu-central-1.compute.amazonaws.com']",
                      "name": "ec2-52-28-249-128.eu-central-1.compute.amazonaws.com",
                      "description": "",
                      "valid_from": "2018-02-05T08:04:53.000Z",
                      "valid_until": "2019-02-05T08:04:53.000Z",
                      "x_opencti_score": 40,
                      "x_opencti_detection": false,
                      "x_opencti_main_observable_type": "Hostname",
                      "createdBy": {
                        "identity_class": "organization",
                        "name": "CthulhuSPRL.be"
                      },
                      "objectMarking": {
                        "edges": [
                          {
                            "node": {
                              "definition_type": "TLP",
                              "definition": "TLP:GREEN"
                            }
                          }
                        ]
                      },
                      "objectLabel": {
                        "edges": [
                          {
                            "node": {
                              "value": "information-credibility-6"
                            }
                          },
                          {
                            "node": {
                              "value": "osint"
                            }
                          }
                        ]
                      },
                      "killChainPhases": {
                        "edges": []
                      },
                      "externalReferences": {
                        "edges": []
                      },
                      "observables": {
                        "edges": [
                          {
                            "node": {
                              "id": "38384182-dec2-484c-8d80-e87346d4ce1f",
                              "standard_id": "hostname--ba0fdff0-757a-509a-be28-4180938ef5ac",
                              "entity_type": "Hostname",
                              "observable_value": "ec2-52-28-249-128.eu-central-1.compute.amazonaws.com",
                              "value": "ec2-52-28-249-128.eu-central-1.compute.amazonaws.com"
                            }
                          }
                        ],
                        "pageInfo": {
                          "globalCount": 1
                        }
                      }
                    },
                    "cursor": "WzE2NzM5MzQ4NDczNTUsImluZGljYXRvci0tMzVlOTU4ZjMtOTc4ZS01NmE5LTk4MDEtMTIxYzkyYTcxNDJlIl0="
                  }
                ],
                "pageInfo": {
                  "endCursor": null,
                  "hasNextPage": false,
                  "globalCount": 9
                }
              }
            }
          }
