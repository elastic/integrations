name: cloudflare
title: Cloudflare
version: 0.1.0
release: experimental
description: Cloudflare Integration
type: integration
format_version: 1.0.0
license: basic
categories: [security]
conditions:
  kibana.version: "^7.12.1"
icons:
  - src: /img/cf-logo-v.svg
    title: Cloudflare
    size: 216x216
    type: image/svg+xml
screenshots:
policy_templates:
  - name: cloudflare
    title: Cloudflare logs
    description: Collect logs from Cloudflare
    inputs:
      - type: httpjson
        title: "Collect Cloudflare logs via API"
        description: "Collecting logs from Cloudflare via API"
        vars:
          - name: auth_email
            type: text
            title: Auth Email
            multi: false
            required: false
            show_user: true
          - name: auth_key
            type: text
            title: Auth Key
            multi: false
            required: false
            show_user: true
          - name: zone_id
            type: text
            title: Zone ID
            multi: false
            required: false
            show_user: true
          - name: http_client_timeout
            type: text
            title: HTTP Client Timeout
            multi: false
            required: false
            show_user: true
            default: 60s
          - name: interval
            type: text
            title: Interval
            multi: false
            required: true
            show_user: true
            default: 60m
          - name: initial_interval
            type: text
            title: Initial Interval
            multi: false
            required: true
            show_user: true
            default: 24h
          - name: ssl
            type: yaml
            title: SSL
            multi: false
            required: false
            show_user: true
      - type: aws-s3
        title: "Collect Cloudflare logs via S3 Bucket"
        description: Collect Cloudflare logs using s3 input
        vars:
          - name: visibility_timeout
            type: text
            title: Visibility Timeout
            multi: false
            required: false
            show_user: false
            description: The duration that the received messages are hidden from subsequent retrieve requests after being retrieved by a ReceiveMessage request.  The maximum is 12 hours.
          - name: api_timeout
            type: text
            title: API Timeout
            multi: false
            required: false
            show_user: false
            description: The maximum duration of AWS API can take. The maximum is half of the visibility timeout value.
          - name: shared_credential_file
            type: text
            title: Shared Credential File
            multi: false
            required: false
            show_user: false
            description: Directory of the shared credentials file.
          - name: credential_profile_name
            type: text
            title: Credential Profile Name
            multi: false
            required: false
            show_user: true
          - name: access_key_id
            type: text
            title: Access Key ID
            multi: false
            required: false
            show_user: false
          - name: secret_access_key
            type: text
            title: Secret Access Key
            multi: false
            required: false
            show_user: false
          - name: session_token
            type: text
            title: Session Token
            multi: false
            required: false
            show_user: false
          - name: role_arn
            type: text
            title: Role ARN
            multi: false
            required: false
            show_user: false
          - name: endpoint
            type: text
            title: Endpoint
            multi: false
            required: false
            show_user: false
            default: "amazonaws.com"
            description: URL of the entry point for an AWS web service.
      - type: logfile
        title: "Collect Cloudflare logs via file"
        description: "Collecting logs from Cloudflare via file"
        vars:
          - name: paths
            type: text
            title: Paths
            multi: true
            required: false
            show_user: true
owner:
  github: elastic/security-external-integrations
