{
    "_id": "d2ba96b0-4cc6-11e9-bd1f-75f359ac0c3f",
    "_type": "visualization",
    "_source": {
        "title": "Top Bad Bots Referer",
        "visState": "{\"title\":\"Top Bad Bots Referer\",\"type\":\"table\",\"params\":{\"perPage\":10,\"showMetricsAtAllLevels\":false,\"showPartialRows\":false,\"showTotal\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"totalFunc\":\"sum\"},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"sum\",\"schema\":\"metric\",\"params\":{\"field\":\"Bad Bots\"}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"http.request.referrer\",\"size\":10,\"order\":\"desc\",\"orderBy\":\"1\",\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\"}}]}",
        "uiStateJSON": "{\"vis\":{\"params\":{\"sort\":{\"columnIndex\":null,\"direction\":null}}}}",
        "description": "",
        "version": 1,
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": "{\"query\":{\"query\":\"\",\"language\":\"lucene\"},\"filter\":[{\"script\":{\"script\":{\"inline\":\"boolean compare(Supplier s, def v) {return s.get() == v;}compare(() -> { int firstCount = 0;\\nint secondCount = 0;\\n\\nif (\\ndoc['cloudflare.log.edge.pathing.src'].value.equalsIgnoreCase(\\\"filterBasedFirewall\\\")\\n&& \\ndoc['cloudflare.log.edge.pathing.status'].value.equalsIgnoreCase(\\\"captchaNew\\\")\\n) \\n{ firstCount = 1  }\\n\\nif (\\ndoc['cloudflare.log.edge.pathing.src'].value.equalsIgnoreCase(\\\"filterBasedFirewall\\\")\\n&&\\ndoc['cloudflare.log.edge.pathing.status'].value.equalsIgnoreCase(\\\"captchaSucc\\\")\\n)\\n{ secondCount = 1 }\\n\\nreturn firstCount - secondCount;\\n }, params.value);\",\"lang\":\"painless\",\"params\":{\"value\":0}}},\"meta\":{\"type\":\"phrase\",\"disabled\":false,\"negate\":true,\"alias\":null,\"value\":0,\"params\":{\"query\":0},\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index\"},\"$state\":{\"store\":\"appState\"}}],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"
        }
    },
    "_meta": {
        "savedObjectVersion": 2
    },
    "_migrationVersion": {
        "visualization": "7.0.1"
    },
    "_references": [
        {
            "id": "logs-*",
            "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
            "type": "index-pattern"
        }
    ]
}