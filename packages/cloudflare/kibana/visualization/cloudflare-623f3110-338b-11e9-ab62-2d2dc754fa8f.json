{
    "_id": "623f3110-338b-11e9-ab62-2d2dc754fa8f",
    "_type": "visualization",
    "_source": {
        "title": "Top Threat Countries Map",
        "visState": "{\"title\":\"Top Threat Countries Map\",\"type\":\"tile_map\",\"params\":{\"colorSchema\":\"Yellow to Red\",\"mapType\":\"Scaled Circle Markers\",\"isDesaturated\":true,\"addTooltip\":true,\"heatClusterSize\":1.5,\"legendPosition\":\"bottomright\",\"mapZoom\":2,\"mapCenter\":[0,0],\"wms\":{\"enabled\":false,\"options\":{\"format\":\"image/png\",\"transparent\":true},\"selectedTmsLayer\":{\"id\":\"road_map\",\"url\":\"https://tiles.maps.elastic.co/v2/default/{z}/{x}/{y}.png?elastic_tile_service_tos=agree&my_app_name=kibana&my_app_version=6.5.4&license=4552d43c-e532-47b1-9552-27fed12f7d1a\",\"minZoom\":0,\"maxZoom\":18,\"attribution\":\"<p>&#169; <a href=\\\"http://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors | <a href=\\\"https://www.elastic.co/elastic-maps-service\\\">Elastic Maps Service</a></p>&#10;\",\"subdomains\":[]}}},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{}},{\"id\":\"2\",\"enabled\":true,\"type\":\"geohash_grid\",\"schema\":\"segment\",\"params\":{\"field\":\"source.geo.location\",\"autoPrecision\":true,\"isFilteredByCollar\":true,\"useGeocentroid\":true,\"mapZoom\":2,\"mapCenter\":[0,0],\"precision\":2}}]}",
        "uiStateJSON": "{}",
        "description": "",
        "version": 1,
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": "{\"query\":{\"query\":\"\",\"language\":\"lucene\"},\"filter\":[{\"size\":50,\"query\":{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.op\":{\"value\":\"ban\",\"boost\":1}}},{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"bic\",\"boost\":1}}},{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"hot\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.status\":{\"value\":\"unknown\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"hot\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.status\":{\"value\":\"ip\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"macro\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.status\":{\"value\":\"unknown\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"macro\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.op\":{\"value\":\"chl\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"term\":{\"cloudflare.log.edge.pathing.status\":{\"value\":\"captchaFail\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"macro\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.op\":{\"value\":\"chl\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"term\":{\"cloudflare.log.edge.pathing.status\":{\"value\":\"jschlFail\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"user\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.op\":{\"value\":\"ban\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"term\":{\"cloudflare.log.edge.pathing.status\":{\"value\":\"zl\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"user\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.op\":{\"value\":\"ban\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"term\":{\"cloudflare.log.edge.pathing.status\":{\"value\":\"us\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"user\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.op\":{\"value\":\"ban\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"term\":{\"cloudflare.log.edge.pathing.status\":{\"value\":\"rateLimit\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"filterBasedFirewall\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.op\":{\"value\":\"ban\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"term\":{\"cloudflare.log.edge.pathing.status\":{\"value\":\"unknown\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"filterBasedFirewall\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.op\":{\"value\":\"chl\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"user\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.op\":{\"value\":\"ban\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"term\":{\"cloudflare.log.edge.pathing.status\":{\"value\":\"ctry\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"user\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.op\":{\"value\":\"ban\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"term\":{\"cloudflare.log.edge.pathing.status\":{\"value\":\"ip\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"term\":{\"cloudflare.log.edge.pathing.src\":{\"value\":\"user\",\"boost\":1}}},{\"term\":{\"cloudflare.log.edge.pathing.op\":{\"value\":\"ban\",\"boost\":1}}}],\"adjust_pure_negative\":true,\"boost\":1}},{\"terms\":{\"cloudflare.log.edge.pathing.status\":[\"ipr16\",\"ipr24\",\"ip6\",\"ip6r64\",\"ip6r48\",\"ip6r32\"],\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}}],\"adjust_pure_negative\":true,\"boost\":1}},\"_source\":{\"includes\":[\"source.geo.region_name\",\"cloudflare.log.client.ip.class\",\"url.path\",\"cloudflare.log.client.request.protocol\",\"http.request.referrer\",\"url.full\",\"user_agent.original\",\"cloudflare.log.client.ssl.cipher\",\"cloudflare.log.client.ssl.protocol\",\"cloudflare.log.edge.rate.limit.action\",\"cloudflare.log.edge.response.content_type\",\"cloudflare.log.origin.response.http.expires\",\"cloudflare.log.origin.response.http.last_modified\",\"cloudflare.log.origin.ssl.protocol\",\"user_agent.os.full\",\"user_agent.name\",\"cloudflare.log.waf.action\",\"cloudflare.log.waf.flags\",\"cloudflare.log.waf.matched_var\",\"cloudflare.log.waf.profile\",\"cloudflare.log.waf.rule.id\",\"cloudflare.log.waf.rule.message\",\"cloudflare.log.worker.status\",\"message\",\"tags\"],\"excludes\":[]},\"docvalue_fields\":[{\"field\":\"@timestamp\",\"format\":\"epoch_millis\"},{\"field\":\"@version\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.cache.status\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.cache.response.bytes\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.cache.response.status\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.cache.tiered.fill\",\"format\":\"use_field_mapping\"},{\"field\":\"source.as.number\",\"format\":\"use_field_mapping\"},{\"field\":\"source.geo.country_iso_code\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.device.type\",\"format\":\"use_field_mapping\"},{\"field\":\"source.geo.city_name\",\"format\":\"use_field_mapping\"},{\"field\":\"source.geo.continent_name\",\"format\":\"use_field_mapping\"},{\"field\":\"source.geo.country_code2\",\"format\":\"use_field_mapping\"},{\"field\":\"source.geo.country_code3\",\"format\":\"use_field_mapping\"},{\"field\":\"source.geo.country_name\",\"format\":\"use_field_mapping\"},{\"field\":\"source.geo.dma_code\",\"format\":\"use_field_mapping\"},{\"field\":\"client.ip\",\"format\":\"use_field_mapping\"},{\"field\":\"source.geo.latitude\",\"format\":\"use_field_mapping\"},{\"field\":\"source.geo.longitude\",\"format\":\"use_field_mapping\"},{\"field\":\"source.geo.postal_code\",\"format\":\"use_field_mapping\"},{\"field\":\"source.geo.region_code\",\"format\":\"use_field_mapping\"},{\"field\":\"source.geo.timezone\",\"format\":\"use_field_mapping\"},{\"field\":\"http.request.bytes\",\"format\":\"use_field_mapping\"},{\"field\":\"url.domain\",\"format\":\"use_field_mapping\"},{\"field\":\"http.request.method\",\"format\":\"use_field_mapping\"},{\"field\":\"client.port\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.edge.colo.id\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.edge.end.timestamp\",\"format\":\"epoch_millis\"},{\"field\":\"cloudflare.log.edge.pathing.op\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.edge.pathing.src\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.edge.pathing.status\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.edge.rate.limit.id\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.edge.request.host\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.edge.response.bytes\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.edge.response.compression_ratio\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.edge.response.status\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.edge.server.ip\",\"format\":\"use_field_mapping\"},{\"field\":\"@timestamp\",\"format\":\"epoch_millis\"},{\"field\":\"cloudflare.log.origin.ip\",\"format\":\"use_field_mapping\"},{\"field\":\"http.response.bytes\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.http.response.status_code\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.origin.response.time\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.parent.ray_id\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.ray_id\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.security_level\",\"format\":\"use_field_mapping\"},{\"field\":\"user_agent.build\",\"format\":\"use_field_mapping\"},{\"field\":\"user_agent.device\",\"format\":\"use_field_mapping\"},{\"field\":\"user_agent.major\",\"format\":\"use_field_mapping\"},{\"field\":\"user_agent.minor\",\"format\":\"use_field_mapping\"},{\"field\":\"user_agent.name\",\"format\":\"use_field_mapping\"},{\"field\":\"user_agent.os_major\",\"format\":\"use_field_mapping\"},{\"field\":\"user_agent.os_minor\",\"format\":\"use_field_mapping\"},{\"field\":\"user_agent.patch\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.worker.cpu_time\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.worker.subrequest\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.worker.subrequest_count\",\"format\":\"use_field_mapping\"},{\"field\":\"cloudflare.log.zone_id\",\"format\":\"use_field_mapping\"}],\"sort\":[{\"_doc\":{\"order\":\"asc\"}}],\"meta\":{\"disabled\":false,\"alias\":null,\"type\":\"custom\",\"key\":\"size\",\"value\":\"50\",\"negate\":false,\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index\"},\"$state\":{\"store\":\"appState\"}}],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"
        }
    },
    "_meta": {
        "savedObjectVersion": 2
    },
    "_migrationVersion": {
        "visualization": "7.0.1"
    },
    "_references": [
        {
            "id": "logs-*",
            "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
            "type": "index-pattern"
        }
    ]
}