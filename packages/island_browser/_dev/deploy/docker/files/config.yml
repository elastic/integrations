rules:
  - path: /api/external/v1/devices
    methods: ['POST']
    request_body: '{"Limit":2,"Offset":0,"SortBy":"LastSeen","SortDirection":"Asc"}'
    request_headers:
      Content-Type:
        - "application/json"
      Api-Key:
        - "xxxx"
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "devices": [
              {
                "machineId": "iNUa5F_2xgA1L51ZX5_YCXX7b7Z",
                "machineName": "ub22-50-6-126.manage.local",
                "machineModel": "VMware Virtual Platform",
                "serialNumber": "",
                "userName": "John Doe",
                "userId": "auth0|cbbf1398-e567-4e6f-8929-5a786ffc2486",
                "email": "john.doe@example.com",
                "osPlatform": "Linux",
                "islandPlatform": "Browser",
                "osVersion": "22.04",
                "browserVersion": "1.72.30",
                "chromiumVersion": "139.0.7258.128",
                "extensionVersion": "1.12546.6",
                "lastSeen": "2025-08-31T04:19:55.342111Z",
                "policyUpdateTime": "2025-07-08T14:17:18.527794Z",
                "diskEncrypted": false,
                "osUserName": "serviceuser",
                "status": "Active",
                "internalIpAddress": "10.50.6.126",
                "externalIpAddress": "89.160.20.112",
                "osDomain": "",
                "osFirewallEnabled": true,
                "osScreenLockEnabled": true,
                "isVirtualMachine": true,
                "browserName": "Island",
                "isArchived": false,
                "macAddresses": "00:50:56:81:c9:17 | 02:42:7e:fe:2e:0b | 00:50:56:81:82:be",
                "cpuModel": "Intel(R) Xeon(R) Gold 5220R CPU @ 2.20GHz",
                "architecture": "x86_64",
                "ramSize": 16,
                "syncEnabled": true,
                "chassisType": "Laptop",
                "osCodeName": "Ubuntu 22.04.5 LTS",
                "country": "India",
                "countryCode": "IN",
                "browserUpdateStatus": "UpToDate",
                "isDefaultBrowser": false,
                "authMethod": "TenantToken",
                "manufacturer": "VMware, Inc.",
                "deviceType": "Laptop",
                "storageCapacity": 48,
                "tenantId": "elastic-testing",
                "id": "7748cf6a-1a23-4572-b5ee-129962616b25",
                "createdDate": "2025-08-21T08:38:14.478259Z",
                "updatedDate": "2025-08-31T04:19:55.345783Z",
                "windowsLicenseStatus": "Unlicensed"
              },
              {
                "machineId": "k7D4yH_9xzA3P62MN8_JSXX1a9Y",
                "machineName": "ub22-50-7-143.manage.local",
                "machineModel": "VMware Virtual Platform",
                "serialNumber": "",
                "userName": "Sarah Johnson",
                "userId": "auth0|e45f2189-c321-5d8a-7654-4a567bbc1234",
                "email": "sarah.johnson@example.com",
                "osPlatform": "MacOs",
                "islandPlatform": "Extension",
                "osVersion": "22.04",
                "browserVersion": "1.73.40",
                "chromiumVersion": "139.0.7258.130",
                "extensionVersion": "1.12547.8",
                "lastSeen": "2025-09-01T07:45:21.562371Z",
                "policyUpdateTime": "2025-08-12T11:28:45.218965Z",
                "diskEncrypted": true,
                "osUserName": "adminuser",
                "status": "Blocked",
                "internalIpAddress": "10.50.7.143",
                "externalIpAddress": "89.160.20.113",
                "osDomain": "",
                "osFirewallEnabled": true,
                "osScreenLockEnabled": true,
                "isVirtualMachine": true,
                "browserName": "Island",
                "isArchived": false,
                "macAddresses": "00:50:56:82:d7:28 | 02:42:8f:fe:3a:1c | 00:50:56:82:77:af",
                "cpuModel": "Intel(R) Xeon(R) Gold 5220R CPU @ 2.20GHz",
                "architecture": "x86_64",
                "ramSize": 32,
                "syncEnabled": true,
                "chassisType": "Desktop",
                "osCodeName": "Ubuntu 22.04.5 LTS",
                "country": "United States",
                "countryCode": "US",
                "browserUpdateStatus": "UpToDate",
                "isDefaultBrowser": false,
                "manufacturer": "VMware, Inc.",
                "deviceType": "Desktop",
                "storageCapacity": 64,
                "tenantId": "elastic-testing",
                "id": "9561df3b-2b45-4729-a7fc-354872927d63",
                "createdDate": "2025-08-25T14:27:36.781452Z",
                "updatedDate": "2025-09-01T07:45:21.568943Z",
                "windowsLicenseStatus": "Licensed"
              }
            ]
          }
          `}}
  - path: /api/external/v1/devices
    methods: ['POST']
    request_body: '{"Limit":2,"Offset":2,"SortBy":"LastSeen","SortDirection":"Asc"}'
    request_headers:
      Content-Type:
        - application/json
      Api-Key:
        - xxxx
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "devices": [
              {
                "machineId": "pR8nL2_5bhJ6K74XC3_WZQA4c2P",
                "machineName": "ub22-51-3-189.manage.local",
                "machineModel": "VMware Virtual Platform",
                "serialNumber": "",
                "userName": "Michael Chen",
                "userId": "auth0|7abc2345-f678-9e01-2d34-5ef6789a0123",
                "email": "michael.chen@example.com",
                "osPlatform": "Windows",
                "islandPlatform": "EndpointApp",
                "osVersion": "22.04",
                "browserVersion": "1.72.28",
                "chromiumVersion": "139.0.7258.126",
                "extensionVersion": "1.12545.9",
                "lastSeen": "2025-08-29T15:33:47.219875Z",
                "policyUpdateTime": "2025-07-15T08:42:56.789123Z",
                "diskEncrypted": true,
                "osUserName": "techuser",
                "status": "BlockedAcknowledged",
                "internalIpAddress": "10.51.3.189",
                "externalIpAddress": "89.160.20.114",
                "osDomain": "",
                "osFirewallEnabled": true,
                "osScreenLockEnabled": true,
                "isVirtualMachine": true,
                "browserName": "Island",
                "isArchived": false,
                "macAddresses": "00:50:56:83:e5:39 | 02:42:9a:fe:4b:2d | 00:50:56:83:91:ca",
                "cpuModel": "Intel(R) Xeon(R) Gold 5220R CPU @ 2.20GHz",
                "architecture": "x86_64",
                "ramSize": 24,
                "syncEnabled": true,
                "chassisType": "Desktop",
                "osCodeName": "Ubuntu 22.04.5 LTS",
                "country": "Germany",
                "countryCode": "DE",
                "browserUpdateStatus": "UpToDate",
                "isDefaultBrowser": true,
                "manufacturer": "VMware, Inc.",
                "deviceType": "Notebook",
                "storageCapacity": 96,
                "tenantId": "elastic-testing",
                "id": "3452ac8e-6f17-4891-b3ed-761549a8c720",
                "createdDate": "2025-08-18T11:15:42.562398Z",
                "updatedDate": "2025-08-29T15:33:47.223516Z",
                "windowsLicenseStatus": "OutofBoxGrace"
              },
              {
                "machineId": "tV6sQ9_7cdF8G42ZP1_BMXR5e3S",
                "machineName": "ub22-52-8-217.manage.local",
                "machineModel": "VMware Virtual Platform",
                "serialNumber": "",
                "userName": "Emma Rodriguez",
                "userId": "auth0|34ef5678-9012-3456-a789-bc01de234567",
                "email": "emma.rodriguez@example.com",
                "osPlatform": "Android",
                "islandPlatform": "EndpointApp",
                "osVersion": "22.04",
                "browserVersion": "1.73.35",
                "chromiumVersion": "139.0.7258.135",
                "extensionVersion": "1.12548.2",
                "lastSeen": "2025-09-02T08:17:39.481235Z",
                "policyUpdateTime": "2025-08-01T19:53:27.456789Z",
                "diskEncrypted": false,
                "osUserName": "devuser",
                "status": "BlockedSuspicious",
                "internalIpAddress": "10.52.8.217",
                "externalIpAddress": "89.160.20.128",
                "osDomain": "",
                "osFirewallEnabled": true,
                "osScreenLockEnabled": false,
                "isVirtualMachine": true,
                "browserName": "Island",
                "isArchived": false,
                "macAddresses": "00:50:56:84:f6:4a | 02:42:ab:fe:5c:3e | 00:50:56:84:b2:db",
                "cpuModel": "Intel(R) Xeon(R) Gold 5220R CPU @ 2.20GHz",
                "architecture": "x86_64",
                "ramSize": 48,
                "syncEnabled": true,
                "chassisType": "Notebook",
                "osCodeName": "Ubuntu 22.04.5 LTS",
                "country": "Brazil",
                "countryCode": "BR",
                "browserUpdateStatus": "PendingRelaunch",
                "isDefaultBrowser": false,
                "manufacturer": "VMware, Inc.",
                "deviceType": "Mobile",
                "storageCapacity": 128,
                "tenantId": "elastic-testing",
                "id": "1278ef9g-4h56-7i89-j0kl-123456789abc",
                "createdDate": "2025-08-27T16:58:23.789456Z",
                "updatedDate": "2025-09-02T08:17:39.487654Z",
                "windowsLicenseStatus": "OutofToleranceGrace"
              }
            ]
          }
          `}}
  - path: /api/external/v1/devices
    methods: ['POST']
    request_body: '{"Limit":2,"Offset":4,"SortBy":"LastSeen","SortDirection":"Asc"}'
    request_headers:
      Content-Type:
        - application/json
      Api-Key:
        - xxxx
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "devices": [
              {
                "machineId": "xZ2wT7_3deG4H96VM5_KNYS8f1Q",
                "machineName": "ub22-53-9-235.manage.local",
                "machineModel": "VMware Virtual Platform",
                "serialNumber": "",
                "userName": "David Kim",
                "userId": "auth0|56gh7890-1ij2-3kl4-m567-no89pq012345",
                "email": "david.kim@example.com",
                "osPlatform": "ChromeOs",
                "islandPlatform": "Other",
                "osVersion": "22.04",
                "browserVersion": "1.72.32",
                "chromiumVersion": "139.0.7258.129",
                "extensionVersion": "1.12546.7",
                "lastSeen": "2025-08-30T21:42:18.654321Z",
                "policyUpdateTime": "2025-07-22T05:36:49.123456Z",
                "diskEncrypted": true,
                "osUserName": "qauser",
                "status": "Suspicious",
                "internalIpAddress": "10.53.9.235",
                "externalIpAddress": "81.2.69.192",
                "osDomain": "",
                "osFirewallEnabled": false,
                "osScreenLockEnabled": true,
                "isVirtualMachine": true,
                "browserName": "Island",
                "isArchived": false,
                "macAddresses": "00:50:56:85:f7:5b | 02:42:bc:fe:6d:4f | 00:50:56:85:c3:ec",
                "cpuModel": "Intel(R) Xeon(R) Gold 5220R CPU @ 2.20GHz",
                "architecture": "x86_64",
                "ramSize": 64,
                "syncEnabled": false,
                "chassisType": "Mobile",
                "osCodeName": "Ubuntu 22.04.5 LTS",
                "country": "Japan",
                "countryCode": "JP",
                "browserUpdateStatus": "PendingRelaunch",
                "isDefaultBrowser": false,
                "manufacturer": "VMware, Inc.",
                "deviceType": "Desktop",
                "storageCapacity": 256,
                "tenantId": "elastic-testing",
                "id": "89rst0uv-1w23-4x56-y78z-9ab01cde2345",
                "createdDate": "2025-08-15T09:47:31.234567Z",
                "updatedDate": "2025-08-30T21:42:18.659876Z",
                "windowsLicenseStatus": "NonGenuineGrace"
              }
            ]
          }
          `}}
  - path: /api/external/v1/devices
    methods: ['POST']
    request_body: '{"Limit":2,"Offset":5,"SortBy":"LastSeen","SortDirection":"Asc"}'
    request_headers:
      Content-Type:
        - application/json
      Api-Key:
        - xxxx
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "devices": []
          }
          `}}
  - path: /api/external/v1/users
    methods: ['GET']
    query_params:
      Offset: 0
      Limit: 2
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "users": [
              {
                "id": "f3d9a7c8-42b1-4f19-9b51-8a3c56e6d912",
                "createdDate": "2025-08-15T10:30:00Z",
                "updatedDate": "2025-08-18T14:45:00Z",
                "tenantId": "acme-tenant-001",
                "userId": "user-12345",
                "userType": "Management",
                "userStatus": "Active",
                "groups": [
                  "Admins",
                  "Security"
                ],
                "connectionName": "AzureAD",
                "allowedTenantsIds": [
                  "acme-tenant-001",
                  "partner-tenant-002"
                ],
                "firstName": "John",
                "lastName": "Doe",
                "email": "john.doe@example.com",
                "lastLogin": "2025-08-18T14:40:10Z",
                "lastSeen": "2025-08-18T14:41:55Z",
                "invitationDate": "2025-08-10T09:00:00Z",
                "expirationDate": null,
                "emailVerified": true,
                "userSource": "Email",
                "claims": {},
                "scimId": null
              },
              {
                "id": "f3d9a7c8-42b1-4f19-9b51-8a3c56e6d913",
                "createdDate": "2025-08-15T10:30:01Z",
                "updatedDate": "2025-08-18T14:45:01Z",
                "tenantId": "acme-tenant-002",
                "userId": "user-1234",
                "userType": "Browser",
                "userStatus": "Invited",
                "groups": [
                  "Admins",
                  "Security"
                ],
                "connectionName": "AzureAD",
                "allowedTenantsIds": [
                  "acme-tenant-002",
                  "partner-tenant-003"
                ],
                "firstName": "Clerk",
                "lastName": "Doe",
                "email": "clerk.doe@example.com",
                "lastLogin": "2025-08-18T14:40:20Z",
                "lastSeen": "2025-08-18T14:41:56Z",
                "invitationDate": "2025-08-10T09:00:00Z",
                "expirationDate": null,
                "emailVerified": true,
                "userSource": "Idp",
                "claims": {},
                "scimId": null
              }
            ]
          }
          `}}
  - path: /api/external/v1/users
    methods: ['GET']
    query_params:
      Offset: 2
      Limit: 2
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "users": [
              {
                "id": "f3d9a7c8-42b1-4f19-9b51-8a3c56e6d929",
                "createdDate": "2025-08-15T10:30:01Z",
                "updatedDate": "2025-08-18T14:45:01Z",
                "tenantId": "acme-tenant-002",
                "userId": "user-1234",
                "userType": "Management",
                "userStatus": "BlockedSuspicious",
                "groups": [
                  "Admins",
                  "Security"
                ],
                "connectionName": "AzureAD",
                "allowedTenantsIds": [
                  "acme-tenant-002",
                  "partner-tenant-003"
                ],
                "firstName": "Richard",
                "lastName": "Smith",
                "email": "richard.Smith@example.com",
                "lastLogin": "2025-08-18T14:40:20Z",
                "lastSeen": "2025-08-18T14:41:56Z",
                "invitationDate": "2025-08-10T09:00:00Z",
                "expirationDate": null,
                "emailVerified": true,
                "userSource": "External",
                "claims": {},
                "scimId": null
              },
              {
                "id": "a8e5b2f1-73c4-4d28-8f67-1b9e4a5c7d84",
                "createdDate": "2025-08-27T07:09:49Z",
                "updatedDate": "2025-08-27T07:09:49Z",
                "tenantId": "acme-tenant-003",
                "userId": "user-67890",
                "userType": "Browser",
                "userStatus": "BlockedAcknowledged",
                "groups": [
                  "Users",
                  "Analytics"
                ],
                "connectionName": "GoogleSSO",
                "allowedTenantsIds": [
                  "acme-tenant-003",
                  "partner-tenant-004"
                ],
                "firstName": "Sarah",
                "lastName": "Connor",
                "email": "sarah.connor@example.com",
                "lastLogin": "2025-08-27T07:05:30Z",
                "lastSeen": "2025-08-27T07:09:45Z",
                "invitationDate": "2025-08-20T11:15:00Z",
                "expirationDate": null,
                "emailVerified": true,
                "userSource": "Email",
                "claims": {},
                "scimId": null
              }
            ]
          }
          `}}
  - path: /api/external/v1/users
    methods: ['GET']
    query_params:
      Offset: 4
      Limit: 2
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "users": [
              {
                "id": "c7f3e9d2-85a6-4b17-9c42-3e8f1a6b9d75",
                "createdDate": "2025-08-27T07:09:50Z",
                "updatedDate": "2025-08-27T07:09:50Z",
                "tenantId": "acme-tenant-004",
                "userId": "user-54321",
                "userType": "Management",
                "userStatus": "Subscribed",
                "groups": [
                  "Managers",
                  "Finance"
                ],
                "connectionName": "OKTA",
                "allowedTenantsIds": [
                  "acme-tenant-004"
                ],
                "firstName": "Michael",
                "lastName": "Smith",
                "email": "michael.smith@example.com",
                "lastLogin": null,
                "lastSeen": null,
                "invitationDate": "2025-08-27T07:00:00Z",
                "expirationDate": "2025-09-27T07:00:00Z",
                "emailVerified": false,
                "userSource": "GroupToken",
                "claims": {},
                "scimId": "scim-98765"
              }
            ]
          }
          `}}
  - path: /api/external/v1/users
    methods: ['GET']
    query_params:
      Offset: 5
      Limit: 2
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "users": []
          }
          `}}
  - path: /api/external/v1/timeline
    methods: ['GET']
    query_params:
      Offset: 0
      Limit: 2
      Start: "{Start:.*}"
      End: "{End:.*}"
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "events": [
              {
                "id": "0554e3ab-618a-4171-a5d7-33555ac4476b",
                "createdDate": "2025-09-09T09:24:36.278692Z",
                "updatedDate": "2025-09-09T09:24:36.278693Z",
                "tenantId": "elastic-testing",
                "userId": "auth0|cbbf1398-e567-4e6f-8929-5a786ffc2486",
                "deviceId": "7748cf6a-1a23-4572-b5ee-129962616b25",
                "clientEventId": "d14e7489-e627-4cf8-bf89-daeb6c4b6a55",
                "userName": "John Doe",
                "email": "john.doe@example.com",
                "type": "Navigation",
                "verdict": "Allowed",
                "verdictReason": "Navigation allowed by policy",
                "timestamp": "2025-09-09T13:29:38.000Z",
                "processedDate": "2025-09-09T13:29:39.123456Z",
                "topLevelUrl": "https://example.com",
                "country": "India",
                "region": "Asia",
                "urlWebCategories": [
                  "Business",
                  "Technology"
                ],
                "saasApplicationName": "Microsoft 365",
                "saasApplicationCategory": "Productivity",
                "urlWebReputation": 85,
                "tabId": 935959881,
                "ruleId": "rule-12345",
                "ruleName": "Standard Navigation Policy",
                "screenshotFileName": "screenshot_20250909_132938.png",
                "keystrokes": "example search query",
                "details": "{\n  \"navigation_details\": {\n    \"referrer\": \"https://google.com\",\n    \"user_agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36\"\n  },\n  \"policy_version_details\": {\n    \"application_access_policy_version\": \"1\",\n    \"browser_access_policy_version\": \"1\",\n    \"browser_policy_version\": \"1\",\n    \"dlp_policy_version\": \"1\",\n    \"pam_policy_version\": \"1\"\n  }\n}",
                "incognito": false,
                "submittedUrl": "https://example.com/page",
                "sourceIp": "10.50.6.126",
                "publicIp": "89.160.20.112",
                "machineName": "ub22-50-6-126.manage.local",
                "matchedDevicePosture": "Compliant",
                "devicePostureMatchingDetails": "Device meets all security requirements",
                "matchedUserGroup": "Standard Users",
                "countryCode": "IN",
                "origin": "Island",
                "windowId": 12345,
                "frameId": 67890,
                "isIslandPrivateAccess": false,
                "shortTopLevelUrl": "example.com",
                "websiteTopLevelUrl": "https://example.com",
                "frameUrl": "https://example.com/iframe",
                "compatibilityMode": "None",
                "osUserName": "serviceuser",
                "machineId": "iNUa5F_2xgH0L51ZW5_YCFI7b7U",
                "osPlatform": "Linux",
                "saasApplicationId": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                "domainOrTenant": "example.com"
              },
              {
                "id": "1a2b3c4d-5e6f-7890-abcd-ef1234567890",
                "createdDate": "2025-09-09T10:15:22.456789Z",
                "updatedDate": "2025-09-09T10:15:22.456790Z",
                "tenantId": "elastic-testing",
                "userId": "auth0|f9e8d7c6-b5a4-3210-9876-543210fedcba",
                "deviceId": "8859df7b-2b34-5683-c6ff-230073727c36",
                "clientEventId": "e25f8590-f738-5df9-cf90-ebfc7d5c7b66",
                "userName": "Sarah Smith",
                "email": "sarah.smith@company.com",
                "type": "FileDownload",
                "verdict": "Blocked",
                "verdictReason": "File download blocked due to DLP policy violation",
                "timestamp": "2025-09-09T14:45:12.000Z",
                "processedDate": "2025-09-09T14:45:13.789012Z",
                "topLevelUrl": "https://sharepoint.company.com",
                "country": "United States",
                "region": "North America",
                "urlWebCategories": [
                  "Business",
                  "Cloud Storage"
                ],
                "saasApplicationName": "SharePoint Online",
                "saasApplicationCategory": "Collaboration",
                "urlWebReputation": 95,
                "tabId": 246813579,
                "ruleId": "rule-67890",
                "ruleName": "DLP File Download Protection",
                "screenshotFileName": "screenshot_20250909_144512.png",
                "keystrokes": "",
                "details": "{\"download_details\":{\"filename\":\"confidential_report.pdf\",\"file_size\":2048576,\"mime_type\":\"application/pdf\",\"dlp_match\":\"SSN detected\"},\"policy_version_details\":{\"application_access_policy_version\":\"2\",\"browser_access_policy_version\":\"1\",\"browser_policy_version\":\"3\",\"dlp_policy_version\":\"4\",\"pam_policy_version\":\"1\"}}",
                "incognito": false,
                "submittedUrl": "https://sharepoint.company.com/sites/hr/documents/confidential_report.pdf",
                "sourceIp": "192.168.1.45",
                "publicIp": "81.2.69.142",
                "machineName": "WIN-DESKTOP-001",
                "matchedDevicePosture": "Compliant",
                "devicePostureMatchingDetails": "Device encryption verified, antivirus active",
                "matchedUserGroup": "HR Department",
                "countryCode": "US",
                "origin": "Island",
                "windowId": 54321,
                "frameId": 98765,
                "isIslandPrivateAccess": false,
                "shortTopLevelUrl": "sharepoint.company.com",
                "websiteTopLevelUrl": "https://sharepoint.company.com",
                "frameUrl": "https://sharepoint.company.com/sites/hr",
                "compatibilityMode": "InternetExplorer",
                "osUserName": "ssmith",
                "machineId": "jOPb6G_3yhI1M62XZ6_ZDGJ8c8V",
                "osPlatform": "Windows",
                "saasApplicationId": "b2c3d4e5-f6g7-8901-bcde-fg2345678901",
                "domainOrTenant": "company.com"
              }
            ]
          }
          `}}
  - path: /api/external/v1/timeline
    methods: ['GET']
    query_params:
      Offset: 2
      Limit: 2
      Start: "{Start:.*}"
      End: "{End:.*}"
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "events": [
              {
                "id": "2b3c4d5e-6f78-9012-cdef-gh3456789012",
                "createdDate": "2025-09-09T11:30:45.123456Z",
                "updatedDate": "2025-09-09T11:30:45.123457Z",
                "tenantId": "elastic-testing",
                "userId": "auth0|a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                "deviceId": "9960e08c-3c45-6794-d700-341184838d47",
                "clientEventId": "f36g9601-g849-6eg0-dg01-fcgd8e6d8c77",
                "userName": "Mike Johnson",
                "email": "mike.johnson@techcorp.com",
                "type": "Copy",
                "verdict": "Warned",
                "verdictReason": "Sensitive data copy operation - user warned",
                "timestamp": "2025-09-09T16:00:30.000Z",
                "processedDate": "2025-09-09T16:00:31.234567Z",
                "topLevelUrl": "https://salesforce.com",
                "country": "Canada",
                "region": "North America",
                "urlWebCategories": [
                  "Business",
                  "CRM"
                ],
                "saasApplicationName": "Salesforce",
                "saasApplicationCategory": "CRM",
                "urlWebReputation": 98,
                "tabId": 357924680,
                "ruleId": "rule-11111",
                "ruleName": "DLP Copy Protection Policy",
                "screenshotFileName": "screenshot_20250909_160030.png",
                "keystrokes": "Ctrl+C",
                "details": "{\"copy_details\":{\"content_type\":\"text\",\"content_length\":156,\"dlp_matches\":[\"Credit Card Number\",\"Phone Number\"],\"clipboard_protection\":true},\"policy_version_details\":{\"application_access_policy_version\":\"1\",\"browser_access_policy_version\":\"2\",\"browser_policy_version\":\"1\",\"dlp_policy_version\":\"3\",\"pam_policy_version\":\"1\"}}",
                "incognito": true,
                "submittedUrl": "https://salesforce.com/lightning/r/Account/0011234567890ABC/view",
                "sourceIp": "172.16.0.100",
                "publicIp": "81.2.69.143",
                "machineName": "MAC-BOOK-PRO-001",
                "matchedDevicePosture": "Non-Compliant",
                "devicePostureMatchingDetails": "OS update required",
                "matchedUserGroup": "Sales Team",
                "countryCode": "CA",
                "origin": "Island",
                "windowId": 11111,
                "frameId": 22222,
                "isIslandPrivateAccess": true,
                "shortTopLevelUrl": "salesforce.com",
                "websiteTopLevelUrl": "https://salesforce.com",
                "frameUrl": "https://salesforce.com/lightning",
                "compatibilityMode": "None",
                "osUserName": "mjohnson",
                "machineId": "kQRc7H_4ziJ2N73YA7_AEHK9d9W",
                "osPlatform": "MacOs",
                "saasApplicationId": "c3d4e5f6-g7h8-9012-defg-hi4567890123",
                "domainOrTenant": "techcorp.com"
              },
              {
                "id": "3c4d5e6f-7890-1234-efgh-ij5678901234",
                "createdDate": "2025-09-09T12:45:18.987654Z",
                "updatedDate": "2025-09-09T12:45:18.987655Z",
                "tenantId": "elastic-testing",
                "userId": "auth0|b2c3d4e5-f6g7-8901-bcde-fg2345678901",
                "deviceId": "aa71f19d-4d56-7805-e811-452295949e58",
                "clientEventId": "g47h0712-h950-7fh1-eh12-gdhe9f7e9d88",
                "userName": "Lisa Chen",
                "email": "lisa.chen@startup.io",
                "type": "Ssh",
                "verdict": "Allowed",
                "verdictReason": "SSH access granted to authorized server",
                "timestamp": "2025-09-09T17:15:45.000Z",
                "processedDate": "2025-09-09T17:15:46.345678Z",
                "topLevelUrl": "https://terminal.startup.io",
                "country": "Singapore",
                "region": "Asia",
                "urlWebCategories": [
                  "Technology",
                  "Development"
                ],
                "saasApplicationName": "SSH Terminal",
                "saasApplicationCategory": "Development Tools",
                "urlWebReputation": 75,
                "tabId": 468035791,
                "ruleId": "rule-22222",
                "ruleName": "SSH Access Control Policy",
                "screenshotFileName": "screenshot_20250909_171545.png",
                "keystrokes": "ssh user@prod-server-01",
                "details": "{\"ssh_details\":{\"target_server\":\"prod-server-01.startup.io\",\"port\":22,\"protocol\":\"SSH-2.0\",\"authentication_method\":\"public_key\",\"session_duration\":3600},\"policy_version_details\":{\"application_access_policy_version\":\"3\",\"browser_access_policy_version\":\"1\",\"browser_policy_version\":\"2\",\"dlp_policy_version\":\"1\",\"pam_policy_version\":\"2\"}}",
                "incognito": false,
                "submittedUrl": "https://terminal.startup.io/ssh/prod-server-01",
                "sourceIp": "10.0.1.200",
                "publicIp": "89.160.20.128",
                "machineName": "DEV-LINUX-001",
                "matchedDevicePosture": "Compliant",
                "devicePostureMatchingDetails": "All security checks passed",
                "matchedUserGroup": "DevOps Team",
                "countryCode": "SG",
                "origin": "Island",
                "windowId": 33333,
                "frameId": 44444,
                "isIslandPrivateAccess": false,
                "shortTopLevelUrl": "terminal.startup.io",
                "websiteTopLevelUrl": "https://terminal.startup.io",
                "frameUrl": "https://terminal.startup.io/console",
                "compatibilityMode": "None",
                "osUserName": "lchen",
                "machineId": "lSRd8I_5ajK3O84ZB8_BFIL0e0X",
                "osPlatform": "Linux",
                "saasApplicationId": "d4e5f6g7-h8i9-0123-fghi-jk6789012345",
                "domainOrTenant": "startup.io"
              }
            ]
          }
          `}}
  - path: /api/external/v1/timeline
    methods: ['GET']
    query_params:
      Offset: 4
      Limit: 2
      Start: "{Start:.*}"
      End: "{End:.*}"
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "events": [
              {
                "id": "4d5e6f78-9012-3456-ghij-kl7890123456",
                "createdDate": "2025-09-09T13:20:33.654321Z",
                "updatedDate": "2025-09-09T13:20:33.654322Z",
                "tenantId": "elastic-testing",
                "userId": "auth0|c3d4e5f6-g7h8-9012-defg-hi4567890123",
                "deviceId": "bb82g20e-5e67-8916-f922-563306060f69",
                "clientEventId": "h58i1823-i061-8gi2-fi23-hejf0g8f0e99",
                "userName": "David Wilson",
                "email": "david.wilson@finance.corp",
                "type": "Print",
                "verdict": "WarnedContinue",
                "verdictReason": "Print operation contains sensitive data - user acknowledged warning",
                "timestamp": "2025-09-09T18:30:20.000Z",
                "processedDate": "2025-09-09T18:30:21.456789Z",
                "topLevelUrl": "https://quickbooks.intuit.com",
                "country": "United Kingdom",
                "region": "Europe",
                "urlWebCategories": [
                  "Business",
                  "Finance",
                  "Accounting"
                ],
                "saasApplicationName": "QuickBooks Online",
                "saasApplicationCategory": "Accounting",
                "urlWebReputation": 92,
                "tabId": 579146802,
                "ruleId": "rule-33333",
                "ruleName": "Print DLP Protection Policy",
                "screenshotFileName": "screenshot_20250909_183020.png",
                "keystrokes": "Ctrl+P",
                "details": "{\"print_details\":{\"document_title\":\"Q3_Financial_Report.pdf\",\"page_count\":15,\"printer_name\":\"HP_LaserJet_Pro\",\"dlp_matches\":[\"Financial Data\",\"Revenue Information\"],\"print_protection_bypassed\":false},\"policy_version_details\":{\"application_access_policy_version\":\"2\",\"browser_access_policy_version\":\"3\",\"browser_policy_version\":\"1\",\"dlp_policy_version\":\"5\",\"pam_policy_version\":\"1\"}}",
                "incognito": false,
                "submittedUrl": "https://quickbooks.intuit.com/app/reports/profitandloss",
                "sourceIp": "192.168.10.75",
                "publicIp": "67.43.156.0",
                "machineName": "WIN-FINANCE-002",
                "matchedDevicePosture": "Compliant",
                "devicePostureMatchingDetails": "Device meets corporate security standards",
                "matchedUserGroup": "Finance Department",
                "countryCode": "GB",
                "origin": "Island",
                "windowId": 55555,
                "frameId": 66666,
                "isIslandPrivateAccess": false,
                "shortTopLevelUrl": "quickbooks.intuit.com",
                "websiteTopLevelUrl": "https://quickbooks.intuit.com",
                "frameUrl": "https://quickbooks.intuit.com/app",
                "compatibilityMode": "None",
                "osUserName": "dwilson",
                "machineId": "mTSe9J_6bkL4P95AC9_CGJM1f1Y",
                "osPlatform": "Windows",
                "saasApplicationId": "e5f6g7h8-i9j0-1234-hijk-lm8901234567",
                "domainOrTenant": "finance.corp"
              }
            ]
          }
          `}}
  - path: /api/external/v1/timeline
    methods: ['GET']
    query_params:
      Offset: 5
      Limit: 2
      Start: "{Start:.*}"
      End: "{End:.*}"
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "events": []
          }
          `}}
  - path: /api/external/v1/compromised-credentials
    methods: ['POST']
    request_body: /.*"limit":2,"offset":0,"sortBy":"CompromisedDate","sortDirection":"Asc".*/
    request_headers:
      Content-Type:
        - "application/json"
      Api-Key:
        - "xxxx"
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "compromisedCredentials": [
              {
                "breachSource": "Ransomware Attack - April 2025",
                "compromisedDate": "2024-09-13T00:00:00Z",
                "createdDate": "2024-09-21T09:46:00Z",
                "email": "john.doe364@enterprise.io",
                "id": "cc-10364-ae99d-20364",
                "impactedDomain": "enterprise.io",
                "status": "Unresolved",
                "tenantId": "tenant-005-tech",
                "updatedDate": "2024-09-21T14:40:00Z",
                "username": "john.doe364"
              },
              {
                "breachSource": "Data Leak - January 2025",
                "compromisedDate": "2024-09-14T00:00:00Z",
                "createdDate": "2024-10-03T04:41:00Z",
                "email": "emily.mitchell363@business.net",
                "id": "cc-10363-edb53-20363",
                "impactedDomain": "business.net",
                "status": "Investigating",
                "tenantId": "tenant-004-biz",
                "updatedDate": "2024-10-03T09:25:00Z",
                "username": "emily.mitchell363"
              }
            ]
          }
          `}}
  - path: /api/external/v1/compromised-credentials
    methods: ['POST']
    request_body: /.*"limit":2,"offset":2,"sortBy":"CompromisedDate","sortDirection":"Asc".*/
    request_headers:
      Content-Type:
        - "application/json"
      Api-Key:
        - "xxxx"
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "compromisedCredentials": [
              {
                "breachSource": "Phishing Campaign - March 2025",
                "compromisedDate": "2024-09-15T00:00:00Z",
                "createdDate": "2024-09-18T15:36:00Z",
                "email": "joseph.carter362@mycompany.org",
                "id": "cc-10362-9cee6-20362",
                "impactedDomain": "mycompany.org",
                "status": "In Progress",
                "tenantId": "tenant-003-corp",
                "updatedDate": "2024-09-18T19:28:00Z",
                "username": "joseph.carter362"
              },
              {
                "breachSource": "Corporate Breach - Q2 2025",
                "compromisedDate": "2024-09-16T00:00:00Z",
                "createdDate": "2024-10-12T03:43:00Z",
                "email": "abigail.nelson361@testcorp.com",
                "id": "cc-10361-1758b-20361",
                "impactedDomain": "testcorp.com",
                "status": "Resolved",
                "tenantId": "tenant-002-secure",
                "updatedDate": "2024-10-12T11:05:00Z",
                "username": "abigail.nelson361"
              }
            ]
          }
          `}}
  - path: /api/external/v1/compromised-credentials
    methods: ['POST']
    request_body: /.*"limit":2,"offset":4,"sortBy":"CompromisedDate","sortDirection":"Asc".*/
    request_headers:
      Content-Type:
        - "application/json"
      Api-Key:
        - "xxxx"
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "compromisedCredentials": [
              {
                "breachSource": "DarkWeb Dump - May 2025",
                "compromisedDate": "2024-09-17T00:00:00Z",
                "createdDate": "2024-09-23T16:47:00Z",
                "email": "christopher.gonzalez360@example.com",
                "id": "cc-10360-08b91-20360",
                "impactedDomain": "example.com",
                "status": "Unresolved",
                "tenantId": "tenant-001-island",
                "updatedDate": "2024-09-24T16:06:00Z",
                "username": "christopher.gonzalez360"
              }
            ]
          }
          `}}
  - path: /api/external/v1/compromised-credentials
    methods: ['POST']
    request_body: /.*"limit":2,"offset":5,"sortBy":"CompromisedDate","sortDirection":"Asc".*/
    request_headers:
      Content-Type:
        - "application/json"
      Api-Key:
        - "xxxx"
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "compromisedCredentials": []
          }
          `}}
