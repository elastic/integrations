rules:
  - path: /api/external/v1/devices
    methods: ['POST']
    request_body: '{"Limit":2,"Offset":0,"SortBy":"LastSeen","SortDirection":"Asc"}'
    request_headers:
      Content-Type:
        - "application/json"
      Api-Key:
        - "xxxx"
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "devices": [
              {
                "machineId": "iNUa5F_2xgA1L51ZX5_YCXX7b7Z",
                "machineName": "ub22-50-6-126.manage.local",
                "machineModel": "VMware Virtual Platform",
                "serialNumber": "",
                "userName": "John Doe",
                "userId": "auth0|cbbf1398-e567-4e6f-8929-5a786ffc2486",
                "email": "john.doe@example.com",
                "osPlatform": "Linux",
                "islandPlatform": "Browser",
                "osVersion": "22.04",
                "browserVersion": "1.72.30",
                "chromiumVersion": "139.0.7258.128",
                "extensionVersion": "1.12546.6",
                "lastSeen": "2025-08-31T04:19:55.342111Z",
                "policyUpdateTime": "2025-07-08T14:17:18.527794Z",
                "diskEncrypted": false,
                "osUserName": "serviceuser",
                "status": "Active",
                "internalIpAddress": "10.50.6.126",
                "externalIpAddress": "89.160.20.112",
                "osDomain": "",
                "osFirewallEnabled": true,
                "osScreenLockEnabled": true,
                "isVirtualMachine": true,
                "browserName": "Island",
                "isArchived": false,
                "macAddresses": "00:50:56:81:c9:17 | 02:42:7e:fe:2e:0b | 00:50:56:81:82:be",
                "cpuModel": "Intel(R) Xeon(R) Gold 5220R CPU @ 2.20GHz",
                "architecture": "x86_64",
                "ramSize": 16,
                "syncEnabled": true,
                "chassisType": "Laptop",
                "osCodeName": "Ubuntu 22.04.5 LTS",
                "country": "India",
                "countryCode": "IN",
                "browserUpdateStatus": "UpToDate",
                "isDefaultBrowser": false,
                "authMethod": "TenantToken",
                "manufacturer": "VMware, Inc.",
                "deviceType": "Laptop",
                "storageCapacity": 48,
                "tenantId": "elastic-testing",
                "id": "7748cf6a-1a23-4572-b5ee-129962616b25",
                "createdDate": "2025-08-21T08:38:14.478259Z",
                "updatedDate": "2025-08-31T04:19:55.345783Z",
                "windowsLicenseStatus": "Unlicensed"
              },
              {
                "machineId": "k7D4yH_9xzA3P62MN8_JSXX1a9Y",
                "machineName": "ub22-50-7-143.manage.local",
                "machineModel": "VMware Virtual Platform",
                "serialNumber": "",
                "userName": "Sarah Johnson",
                "userId": "auth0|e45f2189-c321-5d8a-7654-4a567bbc1234",
                "email": "sarah.johnson@example.com",
                "osPlatform": "MacOs",
                "islandPlatform": "Extension",
                "osVersion": "22.04",
                "browserVersion": "1.73.40",
                "chromiumVersion": "139.0.7258.130",
                "extensionVersion": "1.12547.8",
                "lastSeen": "2025-09-01T07:45:21.562371Z",
                "policyUpdateTime": "2025-08-12T11:28:45.218965Z",
                "diskEncrypted": true,
                "osUserName": "adminuser",
                "status": "Blocked",
                "internalIpAddress": "10.50.7.143",
                "externalIpAddress": "89.160.20.113",
                "osDomain": "",
                "osFirewallEnabled": true,
                "osScreenLockEnabled": true,
                "isVirtualMachine": true,
                "browserName": "Island",
                "isArchived": false,
                "macAddresses": "00:50:56:82:d7:28 | 02:42:8f:fe:3a:1c | 00:50:56:82:77:af",
                "cpuModel": "Intel(R) Xeon(R) Gold 5220R CPU @ 2.20GHz",
                "architecture": "x86_64",
                "ramSize": 32,
                "syncEnabled": true,
                "chassisType": "Desktop",
                "osCodeName": "Ubuntu 22.04.5 LTS",
                "country": "United States",
                "countryCode": "US",
                "browserUpdateStatus": "UpToDate",
                "isDefaultBrowser": false,
                "manufacturer": "VMware, Inc.",
                "deviceType": "Desktop",
                "storageCapacity": 64,
                "tenantId": "elastic-testing",
                "id": "9561df3b-2b45-4729-a7fc-354872927d63",
                "createdDate": "2025-08-25T14:27:36.781452Z",
                "updatedDate": "2025-09-01T07:45:21.568943Z",
                "windowsLicenseStatus": "Licensed"
              }
            ]
          }
          `}}
  - path: /api/external/v1/devices
    methods: ['POST']
    request_body: '{"Limit":2,"Offset":2,"SortBy":"LastSeen","SortDirection":"Asc"}'
    request_headers:
      Content-Type:
        - application/json
      Api-Key:
        - xxxx
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "devices": [
              {
                "machineId": "pR8nL2_5bhJ6K74XC3_WZQA4c2P",
                "machineName": "ub22-51-3-189.manage.local",
                "machineModel": "VMware Virtual Platform",
                "serialNumber": "",
                "userName": "Michael Chen",
                "userId": "auth0|7abc2345-f678-9e01-2d34-5ef6789a0123",
                "email": "michael.chen@example.com",
                "osPlatform": "Windows",
                "islandPlatform": "EndpointApp",
                "osVersion": "22.04",
                "browserVersion": "1.72.28",
                "chromiumVersion": "139.0.7258.126",
                "extensionVersion": "1.12545.9",
                "lastSeen": "2025-08-29T15:33:47.219875Z",
                "policyUpdateTime": "2025-07-15T08:42:56.789123Z",
                "diskEncrypted": true,
                "osUserName": "techuser",
                "status": "BlockedAcknowledged",
                "internalIpAddress": "10.51.3.189",
                "externalIpAddress": "89.160.20.114",
                "osDomain": "",
                "osFirewallEnabled": true,
                "osScreenLockEnabled": true,
                "isVirtualMachine": true,
                "browserName": "Island",
                "isArchived": false,
                "macAddresses": "00:50:56:83:e5:39 | 02:42:9a:fe:4b:2d | 00:50:56:83:91:ca",
                "cpuModel": "Intel(R) Xeon(R) Gold 5220R CPU @ 2.20GHz",
                "architecture": "x86_64",
                "ramSize": 24,
                "syncEnabled": true,
                "chassisType": "Desktop",
                "osCodeName": "Ubuntu 22.04.5 LTS",
                "country": "Germany",
                "countryCode": "DE",
                "browserUpdateStatus": "UpToDate",
                "isDefaultBrowser": true,
                "manufacturer": "VMware, Inc.",
                "deviceType": "Notebook",
                "storageCapacity": 96,
                "tenantId": "elastic-testing",
                "id": "3452ac8e-6f17-4891-b3ed-761549a8c720",
                "createdDate": "2025-08-18T11:15:42.562398Z",
                "updatedDate": "2025-08-29T15:33:47.223516Z",
                "windowsLicenseStatus": "OutofBoxGrace"
              },
              {
                "machineId": "tV6sQ9_7cdF8G42ZP1_BMXR5e3S",
                "machineName": "ub22-52-8-217.manage.local",
                "machineModel": "VMware Virtual Platform",
                "serialNumber": "",
                "userName": "Emma Rodriguez",
                "userId": "auth0|34ef5678-9012-3456-a789-bc01de234567",
                "email": "emma.rodriguez@example.com",
                "osPlatform": "Android",
                "islandPlatform": "EndpointApp",
                "osVersion": "22.04",
                "browserVersion": "1.73.35",
                "chromiumVersion": "139.0.7258.135",
                "extensionVersion": "1.12548.2",
                "lastSeen": "2025-09-02T08:17:39.481235Z",
                "policyUpdateTime": "2025-08-01T19:53:27.456789Z",
                "diskEncrypted": false,
                "osUserName": "devuser",
                "status": "BlockedSuspicious",
                "internalIpAddress": "10.52.8.217",
                "externalIpAddress": "89.160.20.128",
                "osDomain": "",
                "osFirewallEnabled": true,
                "osScreenLockEnabled": false,
                "isVirtualMachine": true,
                "browserName": "Island",
                "isArchived": false,
                "macAddresses": "00:50:56:84:f6:4a | 02:42:ab:fe:5c:3e | 00:50:56:84:b2:db",
                "cpuModel": "Intel(R) Xeon(R) Gold 5220R CPU @ 2.20GHz",
                "architecture": "x86_64",
                "ramSize": 48,
                "syncEnabled": true,
                "chassisType": "Notebook",
                "osCodeName": "Ubuntu 22.04.5 LTS",
                "country": "Brazil",
                "countryCode": "BR",
                "browserUpdateStatus": "PendingRelaunch",
                "isDefaultBrowser": false,
                "manufacturer": "VMware, Inc.",
                "deviceType": "Mobile",
                "storageCapacity": 128,
                "tenantId": "elastic-testing",
                "id": "1278ef9g-4h56-7i89-j0kl-123456789abc",
                "createdDate": "2025-08-27T16:58:23.789456Z",
                "updatedDate": "2025-09-02T08:17:39.487654Z",
                "windowsLicenseStatus": "OutofToleranceGrace"
              }
            ]
          }
          `}}
  - path: /api/external/v1/devices
    methods: ['POST']
    request_body: '{"Limit":2,"Offset":4,"SortBy":"LastSeen","SortDirection":"Asc"}'
    request_headers:
      Content-Type:
        - application/json
      Api-Key:
        - xxxx
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "devices": [
              {
                "machineId": "xZ2wT7_3deG4H96VM5_KNYS8f1Q",
                "machineName": "ub22-53-9-235.manage.local",
                "machineModel": "VMware Virtual Platform",
                "serialNumber": "",
                "userName": "David Kim",
                "userId": "auth0|56gh7890-1ij2-3kl4-m567-no89pq012345",
                "email": "david.kim@example.com",
                "osPlatform": "ChromeOs",
                "islandPlatform": "Other",
                "osVersion": "22.04",
                "browserVersion": "1.72.32",
                "chromiumVersion": "139.0.7258.129",
                "extensionVersion": "1.12546.7",
                "lastSeen": "2025-08-30T21:42:18.654321Z",
                "policyUpdateTime": "2025-07-22T05:36:49.123456Z",
                "diskEncrypted": true,
                "osUserName": "qauser",
                "status": "Suspicious",
                "internalIpAddress": "10.53.9.235",
                "externalIpAddress": "81.2.69.192",
                "osDomain": "",
                "osFirewallEnabled": false,
                "osScreenLockEnabled": true,
                "isVirtualMachine": true,
                "browserName": "Island",
                "isArchived": false,
                "macAddresses": "00:50:56:85:f7:5b | 02:42:bc:fe:6d:4f | 00:50:56:85:c3:ec",
                "cpuModel": "Intel(R) Xeon(R) Gold 5220R CPU @ 2.20GHz",
                "architecture": "x86_64",
                "ramSize": 64,
                "syncEnabled": false,
                "chassisType": "Mobile",
                "osCodeName": "Ubuntu 22.04.5 LTS",
                "country": "Japan",
                "countryCode": "JP",
                "browserUpdateStatus": "PendingRelaunch",
                "isDefaultBrowser": false,
                "manufacturer": "VMware, Inc.",
                "deviceType": "Desktop",
                "storageCapacity": 256,
                "tenantId": "elastic-testing",
                "id": "89rst0uv-1w23-4x56-y78z-9ab01cde2345",
                "createdDate": "2025-08-15T09:47:31.234567Z",
                "updatedDate": "2025-08-30T21:42:18.659876Z",
                "windowsLicenseStatus": "NonGenuineGrace"
              }
            ]
          }
          `}}
  - path: /api/external/v1/devices
    methods: ['POST']
    request_body: '{"Limit":2,"Offset":5,"SortBy":"LastSeen","SortDirection":"Asc"}'
    request_headers:
      Content-Type:
        - application/json
      Api-Key:
        - xxxx
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "devices": []
          }
          `}}
  - path: /api/external/v1/users
    methods: ['GET']
    query_params:
      Offset: 0
      Limit: 2
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "users": [
              {
                "id": "f3d9a7c8-42b1-4f19-9b51-8a3c56e6d912",
                "createdDate": "2025-08-15T10:30:00Z",
                "updatedDate": "2025-08-18T14:45:00Z",
                "tenantId": "acme-tenant-001",
                "userId": "user-12345",
                "userType": "Management",
                "userStatus": "Active",
                "groups": [
                  "Admins",
                  "Security"
                ],
                "connectionName": "AzureAD",
                "allowedTenantsIds": [
                  "acme-tenant-001",
                  "partner-tenant-002"
                ],
                "firstName": "John",
                "lastName": "Doe",
                "email": "john.doe@example.com",
                "lastLogin": "2025-08-18T14:40:10Z",
                "lastSeen": "2025-08-18T14:41:55Z",
                "invitationDate": "2025-08-10T09:00:00Z",
                "expirationDate": null,
                "emailVerified": true,
                "userSource": "Email",
                "claims": {},
                "scimId": null
              },
              {
                "id": "f3d9a7c8-42b1-4f19-9b51-8a3c56e6d913",
                "createdDate": "2025-08-15T10:30:01Z",
                "updatedDate": "2025-08-18T14:45:01Z",
                "tenantId": "acme-tenant-002",
                "userId": "user-1234",
                "userType": "Browser",
                "userStatus": "Invited",
                "groups": [
                  "Admins",
                  "Security"
                ],
                "connectionName": "AzureAD",
                "allowedTenantsIds": [
                  "acme-tenant-002",
                  "partner-tenant-003"
                ],
                "firstName": "Clerk",
                "lastName": "Doe",
                "email": "clerk.doe@example.com",
                "lastLogin": "2025-08-18T14:40:20Z",
                "lastSeen": "2025-08-18T14:41:56Z",
                "invitationDate": "2025-08-10T09:00:00Z",
                "expirationDate": null,
                "emailVerified": true,
                "userSource": "Idp",
                "claims": {},
                "scimId": null
              }
            ]
          }
          `}}
  - path: /api/external/v1/users
    methods: ['GET']
    query_params:
      Offset: 2
      Limit: 2
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "users": [
              {
                "id": "f3d9a7c8-42b1-4f19-9b51-8a3c56e6d929",
                "createdDate": "2025-08-15T10:30:01Z",
                "updatedDate": "2025-08-18T14:45:01Z",
                "tenantId": "acme-tenant-002",
                "userId": "user-1234",
                "userType": "Management",
                "userStatus": "BlockedSuspicious",
                "groups": [
                  "Admins",
                  "Security"
                ],
                "connectionName": "AzureAD",
                "allowedTenantsIds": [
                  "acme-tenant-002",
                  "partner-tenant-003"
                ],
                "firstName": "Richard",
                "lastName": "Smith",
                "email": "richard.Smith@example.com",
                "lastLogin": "2025-08-18T14:40:20Z",
                "lastSeen": "2025-08-18T14:41:56Z",
                "invitationDate": "2025-08-10T09:00:00Z",
                "expirationDate": null,
                "emailVerified": true,
                "userSource": "External",
                "claims": {},
                "scimId": null
              },
              {
                "id": "a8e5b2f1-73c4-4d28-8f67-1b9e4a5c7d84",
                "createdDate": "2025-08-27T07:09:49Z",
                "updatedDate": "2025-08-27T07:09:49Z",
                "tenantId": "acme-tenant-003",
                "userId": "user-67890",
                "userType": "Browser",
                "userStatus": "BlockedAcknowledged",
                "groups": [
                  "Users",
                  "Analytics"
                ],
                "connectionName": "GoogleSSO",
                "allowedTenantsIds": [
                  "acme-tenant-003",
                  "partner-tenant-004"
                ],
                "firstName": "Sarah",
                "lastName": "Connor",
                "email": "sarah.connor@example.com",
                "lastLogin": "2025-08-27T07:05:30Z",
                "lastSeen": "2025-08-27T07:09:45Z",
                "invitationDate": "2025-08-20T11:15:00Z",
                "expirationDate": null,
                "emailVerified": true,
                "userSource": "Email",
                "claims": {},
                "scimId": null
              }
            ]
          }
          `}}
  - path: /api/external/v1/users
    methods: ['GET']
    query_params:
      Offset: 4
      Limit: 2
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "users": [
              {
                "id": "c7f3e9d2-85a6-4b17-9c42-3e8f1a6b9d75",
                "createdDate": "2025-08-27T07:09:50Z",
                "updatedDate": "2025-08-27T07:09:50Z",
                "tenantId": "acme-tenant-004",
                "userId": "user-54321",
                "userType": "Management",
                "userStatus": "Subscribed",
                "groups": [
                  "Managers",
                  "Finance"
                ],
                "connectionName": "OKTA",
                "allowedTenantsIds": [
                  "acme-tenant-004"
                ],
                "firstName": "Michael",
                "lastName": "Smith",
                "email": "michael.smith@example.com",
                "lastLogin": null,
                "lastSeen": null,
                "invitationDate": "2025-08-27T07:00:00Z",
                "expirationDate": "2025-09-27T07:00:00Z",
                "emailVerified": false,
                "userSource": "GroupToken",
                "claims": {},
                "scimId": "scim-98765"
              }
            ]
          }
          `}}
  - path: /api/external/v1/users
    methods: ['GET']
    query_params:
      Offset: 5
      Limit: 2
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "users": []
          }
          `}}
