- name: panw.interfaces
  type: group
  fields:
    - name: physical
      type: group
      fields:
        - name: name
          type: keyword
          dimension: true
          description: >
            Physical interface name

        - name: id
          type: keyword
          dimension: true
          description: >
            Physical interface ID

        - name: type
          type: keyword
          description: >
            Physical interface type

        - name: mac
          type: keyword
          description: >
            Physical MAC address

        - name: speed
          type: keyword
          description: >
            Physical interface speed

        - name: duplex
          type: keyword
          description: >
            Duplex configuration, e.g., "full" or "half"

        - name: state
          type: keyword
          description: >
            Physical interface state: up/down

        - name: mode
          type: keyword
          description: >
            Physical interface mode, e.g., autoneg

        - name: full_state
          type: keyword
          dimension: true
          description: >
            Physical full state, speed/duplex/state, e.g., "1000/full/up"

        - name: ae_member
          type: keyword
          description: >
            For aggregate interfaces, the array of member interfaces

    - name: logical
      type: group
      fields:
        - name: name
          type: keyword
          dimension: true
          description: >
            Logical interface name

        - name: id
          type: keyword
          dimension: true
          description: >
            Logical interface ID

        - name: tag
          type: integer
          description: >
            VLAN tag associated with this interface

        - name: vsys
          type: integer
          description: >
            Virtual system to which this interface belongs

        - name: zone
          type: keyword
          dimension: true
          description: >
            Logical zone, e.g., "inside" or "outside"

        - name: fwd
          type: keyword
          description: >
            Indicates if the interface is used for forwarding

        - name: ip
          type: keyword
          description: >
            Logical IP Address with subnet mask, e.g., 111.222.333.10/29. Can also be "N/A"

        - name: addr
          type: keyword
          description: >
            Used to store additional static IP addresses

        - name: dyn_addr
          type: keyword
          description: >
            Dynamic addresses, e.g., generated by DHCP

        - name: addr6
          type: keyword
          description: >
            Logical IPv6 address

    - name: ha
      type: group
      fields:
        - name: enabled
          type: boolean
          description: >
            HA enabled

        - name: mode
          type: keyword
          dimension: true
          description: >
            HA mode, e.g., "active-active" or "active-passive"

        - name: running_sync
          type: keyword
          dimension: true
          description: >
            Indicates the sychronization status of the HA pair, e.g., "synchronized", "not-synchronized", "synchronizing"

        - name: running_sync_enabled
          type: boolean
          description: >
            Indicates if running configuration synchronization is enabled

        - name: local_info
          type: group
          fields:
            - name: version
              type: long
              description: >
                HA configuration info version

            - name: state
              type: keyword
              description: >
                HA state of the local device, e.g., "active" or "passive"

            - name: state_duration
              type: long
              unit: s
              metric_type: gauge
              description: >
                Duration in seconds of the current state

            - name: mgmt_ip
              type: keyword
              description: >
                HA local info management IP, in CIDR format.

            - name: preemptive
              type: keyword
              description: >
                Indicates whether the firewall is configured to preemptively take over as the active unit in an HA setup. This is a yes/no value which the beat is not converting to a boolean, so it will be a keyword.

            - name: mode
              type: keyword
              description: >
                HA mode, e.g., "active-active" or "active-passive"

            - name: platform_model
              type: keyword
              dimension: true
              description: >
                Platform model of the local device

            - name: state_sync
              type: keyword
              description: >
                Status of HA synchronization, e.g., "complete"

            - name: state_sync_type
              type: keyword
              description: >
                Type of interface used for HA synchronization

            - name: ha1_ipaddr
              type: keyword
              description: >
                IP Address of HA1 interface, used for heartbeat and management synchronization, in CIDR format.

            - name: ha1_macaddr
              type: keyword
              description: >
                HA local info HA1 MAC address

            - name: ha1_port
              type: keyword
              description: >
                Indicates which interface is used for HA1 traffic, e.g., "dedicated-ha1"

            - name: ha1_backup_ipaddr
              type: keyword
              description: >
                The backup IP address for the HA1 interface, in CIDR format.

            - name: ha1_backup_macaddr
              type: keyword
              description: >
                HA local info HA1 backup MAC address

            - name: ha1_backup_port
              type: keyword
              description: >
                HA local info HA1 backup port, e.g. "management"

            - name: ha1_backup_gateway
              type: keyword
              description: >
                Default gateway for the backup HA1 interface

            - name: ha2_ipaddr
              type: keyword
              description: >
                HA local info HA2 IP address, in CIDR format.

            - name: ha2_macaddr
              type: keyword
              description: >
                HA local info HA2 MAC address

            - name: ha2_port
              type: keyword
              description: >
                Indicates which interface is used for HA1 traffic, e.g., "dedicated-ha2"

            - name: build_rel
              type: keyword
              description: >
                The PAN-OS software version running on the firewall

            - name: url_version
              type: keyword
              description: >
                The version of the URL filtering database

            - name: app_version
              type: keyword
              description: >
                The version of the application database

            - name: iot_version
              type: keyword
              description: >
                HA local info IoT database version

            - name: av_version
              type: keyword
              description: >
                The version of the antivirus database

            - name: threat_version
              type: keyword
              description: >
                HA local info threat version

            - name: vpn_client_version
              type: keyword
              description: >
                Version of the VPN client (if installed)

            - name: gp_client_version
              type: keyword
              description: >
                Version of the GlobalProtect client software

        - name: peer_info
          type: group
          fields:
            - name: conn_status
              type: keyword
              description: >
                Overall status of the HA connections ("up" means all connections are operational)

            - name: state
              type: keyword
              description: >
                Current operational state of the peer firewall (passive means it is in standby mode and not handling traffic)

            - name: state_duration
              type: long
              metric_type: gauge
              unit: s
              description: >
                How long the peer has been in the current state in seconds

            - name: mgmt_ip
              type: keyword
              description: >
                Management IP address of the peer firewall. This is in CIDR format.

            - name: preemptive
              type: keyword
              description: >
                Indicates if preemption is enabled on the peer firewall

            - name: mode
              type: keyword
              description: >
                HA mode configured on the peer firewall, e.g. "Active-Passive"

            - name: platform_model
              type: keyword
              dimension: true
              description: >
                Model of the peer firewall

            - name: priority
              type: long
              description: >
                HA priority value of the peer firewall

            - name: ha1_ipaddr
              type: ip
              description: >
                IP address of the HA1 interface on the peer, in CIDR format.

            - name: ha1_macaddr
              type: keyword
              description: >
                HA1 MAC address of the peer

            - name: ha1_backup_ipaddr
              type: ip
              description: >
                HA peer info HA1 backup IP address, in CIDR format.

            - name: ha1_backup_macaddr
              type: keyword
              description: >
                HA peer info HA1 backup MAC address

            - name: ha2_ipaddr
              type: keyword
              description: >
                HA peer info HA2 IP address, in CIDR format.

            - name: ha2_macaddr
              type: keyword
              description: >
                HA peer info HA2 MAC address

            - name: conn_ha1
              type: group
              fields:
                - name: status
                  type: keyword
                  description: >
                    Peer HA1 connection status, e.g., "up"

                - name: primary
                  type: keyword
                  description: >
                    Specifies if the HA1 connection is primary

                - name: description
                  type: keyword
                  description: >
                    Description of the connection type ,e.g., "heartbeat status"

            - name: conn_ha2
              type: group
              fields:
                - name: status
                  type: keyword
                  description: >
                    HA peer info connection HA2 status

                - name: primary
                  type: keyword
                  description: >
                    Specifies if the HA2 connection is primary

                - name: description
                  type: keyword
                  description: >
                    HA peer info connection HA2 description

            - name: conn_ha1_backup
              type: group
              fields:
                - name: status
                  type: keyword
                  description: >
                    HA peer info connection HA1 backup status, e.g., "up" means it is operational

                - name: description
                  type: keyword
                  description: >
                    HA peer info connection HA1 backup description

        - name: link_monitoring
          type: group
          fields:
            - name: enabled
              type: boolean
              description: >
                Indicates if link monitoring is enabled

            - name: failure_condition
              type: keyword
              description: >
                Condition that triggers a link monitoring failure, e.g., "any"

            - name: group
              type: group
              fields:
                - name: name
                  type: keyword
                  description: >
                    Name of the link monitoring group

                - name: enabled
                  type: boolean
                  description: >
                    Indicates if the link monitoring group is enabled

                - name: failure_condition
                  type: keyword
                  description: >
                    Condition that triggers a failure in the link monitoring group

                - name: interface
                  type: group
                  fields:
                    - name: name
                      type: keyword
                      description: >
                        Name of the interface in the link monitoring group

                    - name: status
                      type: keyword
                      description: >
                        Status of the interface in the link monitoring group

    - name: ipsec_tunnel
      type: group
      fields:
        - name: id
          type: keyword
          dimension: true
          description: >
            ID of the IPsec tunnel

        - name: name
          type: keyword
          dimension: true
          description: >
            Name of the IPsec tunnel

        - name: gw
          type: keyword
          description: >
            Gateway of the IPsec tunnel

        - name: TSi_ip
          type: ip
          description: >
            Traffic Selector Initiator IP. This is the local IP (0.0.0.0 means any IP address)

        - name: TSi_prefix
          type: keyword
          description: >
            Network prefix for the TSi IP, 0 means no specific network is defined.

        - name: TSi_proto
          type: keyword
          description: >
            Protocol associated with the TSi (0 means any protocol)

        - name: TSi_port
          type: long
          description: >
            Port number associated with TSi (0 means any port)

        - name: TSr_ip
          type: ip
          description: >
            Traffic Selector Responder IP.

        - name: TSr_prefix
          type: keyword
          description: >
            Network prefix for the TSr IP. Similar to TSi_prefix

        - name: TSr_proto
          type: keyword
          description: >
            TSr protocol of the IPsec tunnel

        - name: TSr_port
          type: long
          description: >
            TSr port of the IPsec tunnel

        - name: proto
          type: keyword
          description: >
            Protocol of the IPsec tunnel

        - name: mode
          type: keyword
          description: >
            This specifies the IPsec mode. e.g., 'tunl'

        - name: dh
          type: keyword
          description: >
            Diffie-Hellman group of the IPsec tunnel

        - name: enc
          type: keyword
          description: >
            Encryption algorithm of the IPsec tunnel

        - name: hash
          type: keyword
          description: >
            Hash algorithm of the IPsec tunnel

        - name: life.sec
          type: long
          unit: s
          metric_type: gauge
          description: >
            The lifetime of the IPsec Security Association (SA) in seconds

        - name: kb
          type: long
          unit: byte
          metric_type: gauge
          description: >
            Traffic volume limit for SA rekeying

