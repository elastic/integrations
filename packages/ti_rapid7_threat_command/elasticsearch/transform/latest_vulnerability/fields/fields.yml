- name: rapid7.tc.vulnerability
  type: group
  fields:
    - name: cpe
      type: group
      fields:
        - name: range
          type: group
          fields:
            - name: version
              type: group
              fields:
                - name: end
                  type: group
                  fields:
                    - name: excluding
                      type: version
                      description: The CPE version end range.
                    - name: including
                      type: version
                      description: The CPE version end range.
                - name: start
                  type: group
                  fields:
                    - name: excluding
                      type: version
                      description: The CPE version start range.
                    - name: including
                      type: version
                      description: The CPE version start range.
        - name: title
          type: keyword
          description: Title of CPE.
        - name: value
          type: keyword
          description: Value of CPE.
        - name: vendor_product
          type: keyword
          description: Vendor and Product of CPE.
    - name: cvss_score
      type: double
      description: The severity score from NVD.
    - name: exploit_availability
      type: boolean
      description: If true, exploit is available for this CVE.
    - name: id
      type: keyword
      description: Unique ID of a CVE.
    - name: intsights_score
      type: double
      description: The severity score from Rapid7 Threat Command.
    - name: mention
      type: group
      fields:
        - name: first_date
          type: keyword
          description: CVE's first mention date.
        - name: last_date
          type: keyword
          description: CVE's last mention date.
    - name: mentions
      type: group
      fields:
        - name: source
          type: group
          fields:
            - name: clear_web_cyber_blogs
              type: long
              description: The number of times a CVE is mentioned by ClearWebCyberBlogs.
            - name: code_repositories
              type: long
              description: The number of times a CVE is mentioned by CodeRepositories.
            - name: dark_web
              type: long
              description: The number of times a CVE is mentioned by DarkWeb.
            - name: exploit
              type: long
              description: The number of times a CVE is mentioned by Exploit.
            - name: hacking_forum
              type: long
              description: The number of times a CVE is mentioned by HackingForum.
            - name: instant_message
              type: long
              description: The number of times a CVE is mentioned by InstantMessage.
            - name: paste_site
              type: long
              description: The number of times a CVE is mentioned by PasteSite.
            - name: social_media
              type: long
              description: The number of times a CVE is mentioned by SocialMedia.
        - name: total
          type: long
          description: The number of times a CVE is mentioned across all sources.
    - name: origin
      type: keyword
      description: The origin of vulnerability.
    - name: published_date
      type: date
      description: CVE's publish date in ISO 8601 format.
    - name: related
      type: group
      fields:
        - name: campaigns
          type: keyword
          description: List of related threat campaigns.
        - name: malware
          type: keyword
          description: List of related malware.
        - name: threat_actors
          type: keyword
          description: List of related threat actors.
    - name: severity
      type: keyword
      description: "CVE severity. Allowed values: 'Critical', 'High', 'Medium', 'Low'."
    - name: update_date
      type: date
      description: CVE's update date in ISO 8601 format.
