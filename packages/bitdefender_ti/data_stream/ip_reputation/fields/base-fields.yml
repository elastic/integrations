# -------------------------------------------------------------------
# Data stream metadata (required)
# -------------------------------------------------------------------
- name: data_stream.type
  type: constant_keyword
  description: Data stream type
- name: data_stream.dataset
  type: constant_keyword
  description: Data stream dataset
- name: data_stream.namespace
  type: constant_keyword
  description: Data stream namespace
# -------------------------------------------------------------------
# Event metadata
# -------------------------------------------------------------------
- name: '@timestamp'
  type: date
  description: Event timestamp
- name: event.kind
  type: keyword
  description: Event kind (enrichment)
- name: event.category
  type: keyword
  description: Event category (threat)
- name: event.type
  type: keyword
  description: Event type (indicator)
- name: event.dataset
  type: keyword
  description: Event dataset
- name: event.module
  type: keyword
  description: Event module
# -------------------------------------------------------------------
# Threat feed metadata
# -------------------------------------------------------------------
- name: threat.feed.vendor
  type: keyword
  description: Threat intelligence feed vendor
- name: threat.feed.name
  type: keyword
  description: Threat intelligence feed name
# -------------------------------------------------------------------
# Indicator core fields
# -------------------------------------------------------------------
- name: threat.indicator.ip
  type: ip
  description: IP address indicator
- name: threat.indicator.type
  type: keyword
  description: Indicator type (ipv4-addr or ipv6-addr)
- name: threat.indicator.id
  type: keyword
  description: Stable identifier for deduplication and aggregation
- name: threat.indicator.provider
  type: keyword
  description: Indicator provider name
- name: threat.indicator.description
  type: text
  description: Analyst-friendly indicator context
- name: threat.indicator.reference
  type: keyword
  description: Provider reference for the indicator
- name: threat.indicator.confidence
  type: keyword
  description: Confidence label of the indicator (low, medium, high)
- name: threat.indicator.severity
  type: long
  description: Severity score of the indicator
- name: threat.indicator.first_seen
  type: date
  description: First time the indicator was observed
- name: threat.indicator.last_seen
  type: date
  description: Last time the indicator was observed
# -------------------------------------------------------------------
# ASN information
# -------------------------------------------------------------------
- name: threat.indicator.as.number
  type: long
  description: Autonomous System number
- name: threat.indicator.as.organization.name
  type: keyword
  description: Autonomous System organization name
# -------------------------------------------------------------------
# Geographic information
# -------------------------------------------------------------------
- name: threat.indicator.geo.location
  type: geo_point
  description: Geographic location of the indicator
- name: threat.indicator.geo.country_iso_code
  type: keyword
  description: Country ISO code
# -------------------------------------------------------------------
# Correlation helpers
# -------------------------------------------------------------------
- name: related.ip
  type: ip
  description: Related IP addresses for correlation
# -------------------------------------------------------------------
# Vendor-specific / enrichment fields
# -------------------------------------------------------------------
- name: tags
  type: keyword
  description: Vendor-provided tags describing the indicator
- name: threat.indicator.cidr
  type: keyword
  description: CIDR range associated with the indicator
- name: threat.indicator.ttl
  type: long
  description: Time-to-live for the indicator in seconds
- name: threat.indicator.valid_until
  type: date
  description: Expiration timestamp derived from first_seen or @timestamp plus TTL
- name: timestamp
  type: long
  description: Vendor timestamp (unix seconds)
- name: first_seen
  type: long
  description: Vendor first_seen (unix seconds)
- name: type
  type: keyword
  description: Vendor indicator type
- name: bitdefender.confidence_score
  type: long
  description: Raw vendor confidence score (0-100)
