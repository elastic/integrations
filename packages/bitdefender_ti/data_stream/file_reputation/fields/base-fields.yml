# -------------------------------------------------------------------
# Data stream metadata (required)
# -------------------------------------------------------------------
- name: data_stream.type
  type: constant_keyword
  description: Data stream type
- name: data_stream.dataset
  type: constant_keyword
  description: Data stream dataset
- name: data_stream.namespace
  type: constant_keyword
  description: Data stream namespace
# -------------------------------------------------------------------
# Event metadata
# -------------------------------------------------------------------
- name: '@timestamp'
  type: date
  description: Event timestamp
- name: event.kind
  type: keyword
  description: Event kind (enrichment)
- name: event.category
  type: keyword
  description: Event category (threat)
- name: event.type
  type: keyword
  description: Event type (indicator)
- name: event.dataset
  type: keyword
  description: Event dataset
- name: event.module
  type: keyword
  description: Event module
# -------------------------------------------------------------------
# Threat feed metadata
# -------------------------------------------------------------------
- name: threat.feed.vendor
  type: keyword
  description: Threat intelligence feed vendor
- name: threat.feed.name
  type: keyword
  description: Threat intelligence feed name
# -------------------------------------------------------------------
# Indicator core fields
# -------------------------------------------------------------------
- name: threat.indicator.type
  type: keyword
  description: Indicator type (file)
- name: threat.indicator.id
  type: keyword
  description: Stable identifier for deduplication and aggregation
- name: threat.indicator.provider
  type: keyword
  description: Indicator provider name
- name: threat.indicator.description
  type: text
  description: Analyst-friendly indicator context
- name: threat.indicator.reference
  type: keyword
  description: Provider reference for the indicator
- name: threat.indicator.confidence
  type: keyword
  description: Confidence label of the indicator (low, medium, high)
- name: threat.indicator.first_seen
  type: date
  description: First time the indicator was observed
- name: threat.indicator.last_seen
  type: date
  description: Last time the indicator was observed
- name: threat.indicator.name
  type: keyword
  description: Malware/threat name
- name: threat.indicator.family
  type: keyword
  description: Malware family
# -------------------------------------------------------------------
# File hash fields
# -------------------------------------------------------------------
- name: threat.indicator.file.hash.sha256
  type: keyword
  description: SHA256 file hash
- name: threat.indicator.file.hash.sha1
  type: keyword
  description: SHA1 file hash
- name: threat.indicator.file.hash.md5
  type: keyword
  description: MD5 file hash
# -------------------------------------------------------------------
# File metadata
# -------------------------------------------------------------------
- name: threat.indicator.file.size
  type: long
  description: File size in bytes
- name: threat.indicator.file.mime_type
  type: keyword
  description: File format / mime-like string from Bitdefender
- name: threat.indicator.file.name
  type: keyword
  description: Observed file names
# -------------------------------------------------------------------
# Correlation helpers
# -------------------------------------------------------------------
- name: related.hash
  type: keyword
  description: Related hashes for correlation
# -------------------------------------------------------------------
# Vendor fields you keep as-is (optional but useful)
# -------------------------------------------------------------------
- name: TTL
  type: long
  description: Recommended validity of the verdict in seconds
- name: popularity
  type: long
  description: Prevalence score (1-5)
- name: timestamp
  type: long
  description: Vendor timestamp (unix seconds)
- name: first_seen
  type: long
  description: Vendor first_seen (unix seconds)
- name: file_format
  type: keyword
  description: Vendor file format string
- name: file_size
  type: long
  description: Vendor file size
- name: file_names
  type: keyword
  description: Vendor file names
- name: threat_name
  type: keyword
  description: Vendor threat name
- name: threat_family
  type: keyword
  description: Vendor threat family
- name: sha256
  type: keyword
  description: Vendor sha256
- name: sha1
  type: keyword
  description: Vendor sha1
- name: md5
  type: keyword
  description: Vendor md5
- name: bitdefender.confidence_score
  type: long
  description: Raw vendor confidence score (0-100)
