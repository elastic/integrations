{
    "id": "aws-bedrock-agentcore-memory-errors",
    "type": "alerting_rule_template",
    "attributes": {
      "name": "[AWS Bedrock AgentCore] Memory errors",
      "tags": ["AWS", "Amazon Bedrock AgentCore", "Memory"],
      "ruleTypeId": ".es-query",
      "schedule": {
        "interval": "5m"
      },
      "params": {
        "searchType": "esqlQuery",
        "timeWindowSize": 5,
        "timeWindowUnit": "m",
        "esqlQuery": {
          "esql": "// Alert triggers when errors occur during AWS Bedrock AgentCore Memory operations.\n//\n// Memory enables agents to persist and retrieve contextual information across\n// sessions, providing long-term memory capabilities. Operations include:\n// - CreateEvent: Creates new memory events\n// - RetrieveMemoryRecords: Retrieves stored memory records\n// - ListEvents: Lists memory events\n// - ListMemory: Lists available memory stores\n// - LongTermMemoryProcessing: Background processing for long-term memory\n// - Extraction/Consolidation: Memory optimization operations\n//\n// This alert monitors both user errors (4xx) and system errors (5xx).\n//\n// The alert is grouped by cloud account and region to identify affected environments.\n//\n// To reduce alert noise, increase the threshold (e.g., `total_errors > 5`).\n// For more details, see: https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/memory.html\n\nFROM metrics-aws_bedrock_agentcore.metrics-*\n| WHERE aws.dimensions.Operation IN (\"CreateEvent\", \"RetrieveMemoryRecords\", \"ListEvents\", \"ListMemory\", \"LongTermMemoryProcessing\", \"Extraction\", \"Consolidation\")\n| STATS total_user_errors = sum(aws.bedrock_agentcore.metrics.UserErrors.sum), total_system_errors = sum(aws.bedrock_agentcore.metrics.SystemErrors.sum) BY cloud.account.id, cloud.region\n| EVAL total_errors = COALESCE(total_user_errors, TO_LONG(0)) + COALESCE(total_system_errors, TO_LONG(0))\n| WHERE total_errors > 0"
        },
        "groupBy": "row",
        "timeField": "event.ingested"
      },
      "alertDelay": {
        "active": 1
      }
    },
    "managed": true,
    "coreMigrationVersion": "8.8.0",
    "typeMigrationVersion": "10.1.0"
  }






