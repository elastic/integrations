- name: aws.bedrock_agentcore
  type: group
  fields:
    - name: agent_name
      type: keyword
      description: The name of the Bedrock agent.

    - name: endpoint_name
      type: keyword
      description: The endpoint identifier.

    - name: session_id
      type: keyword
      description: Unique identifier for the AgentCore runtime session.

    - name: resource_arn
      type: keyword
      description: Amazon Resource Name (ARN) of the AgentCore runtime resource.

    - name: severity_number
      type: integer
      description: Numeric severity level associated with the event.

    # severity_text â†’ ECS log.level
    - name: request_id
      type: keyword
      description: ID of the processed request.

    - name: prompt
      type: text
      description: User prompt text captured by the event.

    - name: prompt_hash
      type: keyword
      description: Hash of the user prompt for deduplication and correlation.

    - name: operation
      type: keyword
      description: Name of the AgentCore operation executed.

    - name: service_name
      type: keyword
      description: Service handling the operation.

    - name: request_payload
      type: group
      fields:
        - name: actor_id
          type: keyword
          description: Actor initiating the request.

        - name: prompt
          type: text
          description: Prompt extracted from payload when it is a string.

    - name: request_payload_object
      type: flattened
      description: Request payload when it is an object, array, or map.

    - name: response_payload_object
      type: flattened
      description: Response payload from the agent.

    - name: conversation_id
      type: keyword
      description: Unique identifier for the conversation or session.

    - name: operation_name
      type: keyword
      description: Name of the GenAI operation performed.

    - name: provider_name
      type: keyword
      description: Name of the AI provider or platform.