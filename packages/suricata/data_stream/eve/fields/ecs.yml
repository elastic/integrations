- name: '@timestamp'
  level: core
  required: true
  type: date
  description: |-
    Date/time when the event originated.
    This is the date/time extracted from the event, typically representing when the event was generated by the source.
    If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline.
    Required field for all events.
- name: destination
  title: Destination
  group: 2
  type: group
  fields:
    - name: bytes
      level: core
      type: long
      format: bytes
      description: Bytes sent from the destination to the source.
    - name: ip
      level: core
      type: ip
      description: IP address of the destination (IPv4 or IPv6).
    - name: packets
      level: core
      type: long
      description: Packets sent from the destination to the source.
    - name: port
      level: core
      type: long
      format: string
      description: Port of the destination.
- name: event
  title: Event
  group: 2
  type: group
  fields:
    - name: outcome
      level: core
      type: keyword
      description: |-
        This is one of four ECS Categorization Fields, and indicates the lowest level in the ECS category hierarchy.
        `event.outcome` simply denotes whether the event represents a success or a failure from the perspective of the entity that produced the event.
        Note that when a single transaction is described in multiple events, each event may populate different values of `event.outcome`, according to their perspective.
        Also note that in the case of a compound event (a single event that contains multiple logical events), this field should be populated with the value that best captures the overall success or failure from the perspective of the event producer.
        Further note that not all events will have an associated outcome. For example, this field is generally not populated for metric events, events with `event.type:info`, or any events for which an outcome does not make logical sense.
      ignore_above: 1024
    - name: severity
      level: core
      type: long
      format: string
      description: |-
        The numeric severity of the event according to your event source.
        What the different severity values mean can be different between sources and use cases. It's up to the implementer to make sure severities are consistent across events from the same source.
        The Syslog severity belongs in `log.syslog.severity.code`. `event.severity` is meant to represent the severity according to the event source (e.g. firewall, IDS). If the event source does not publish its own severity, you may optionally copy the `log.syslog.severity.code` to `event.severity`.
    - name: start
      level: extended
      type: date
      description: event.start contains the date when the event started or when the activity was first observed.
    - name: end
      type: date
      description: event.end contains the date when the event ended or when the activity was last observed.
    - name: duration
      type: long
      description: Duration of the event in nanoseconds.
- name: threat
  title: Threat
  group: 2
  description: "Fields to classify events and alerts according to a threat taxonomy such as the MITRE ATT&CK® framework.\nThese fields are for users to classify alerts from all of their sources (e.g. IDS, NGFW, etc.) within a common taxonomy. The threat.tactic.* are meant to capture the high level category of the threat (e.g. \"impact\"). The threat.technique.* fields are meant to capture which kind of approach is used by this detected threat, to accomplish the goal (e.g. \"endpoint denial of service\")."
  type: group
  fields:
    - name: framework
      level: extended
      type: keyword
      ignore_above: 1024
      description: Name of the threat framework used to further categorize and classify the tactic and technique of the reported threat. Framework classification can be provided by detecting systems, evaluated at ingest time, or retrospectively tagged to events.
      example: MITRE ATT&CK
    - name: tactic.id
      level: extended
      type: keyword
      ignore_above: 1024
      description: "The id of tactic used by this threat. You can use a MITRE ATT&CK® tactic, for example. (ex. https://attack.mitre.org/tactics/TA0040/ )"
      example: TA0040
    - name: tactic.name
      level: extended
      type: keyword
      ignore_above: 1024
      description: "Name of the type of tactic used by this threat. You can use a MITRE ATT&CK® tactic, for example. (ex. https://attack.mitre.org/tactics/TA0040/)"
      example: impact
    - name: technique.id
      level: extended
      type: keyword
      ignore_above: 1024
      description: "The id of technique used by this threat. You can use a MITRE ATT&CK® technique, for example. (ex. https://attack.mitre.org/techniques/T1499/)"
      example: T1499
    - name: technique.name
      level: extended
      type: keyword
      ignore_above: 1024
      multi_fields:
        - name: text
          type: text
          norms: false
          default_field: false
      description: "The name of technique used by this threat. You can use a MITRE ATT&CK® technique, for example. (ex. https://attack.mitre.org/techniques/T1499/)"
      example: Endpoint Denial of Service
- name: file
  title: File
  group: 2
  type: group
  fields:
    - name: path
      level: extended
      type: keyword
      description: Full path to the file, including the file name. It should include the drive letter, when appropriate.
      ignore_above: 1024
      multi_fields:
        - name: text
          type: text
          norms: false
          default_field: false
    - name: size
      level: extended
      type: long
      description: |-
        File size in bytes.
        Only relevant when `file.type` is "file".
    - name: name
      level: extended
      type: keyword
      description: |-
        Name of the file including the extension, without the directory.
- name: http
  title: HTTP
  group: 2
  type: group
  fields:
    - name: request.method
      level: extended
      type: keyword
      description: |-
        HTTP request method.
        Prior to ECS 1.6.0 the following guidance was provided:
        "The field value must be normalized to lowercase for querying."
        As of ECS 1.6.0, the guidance is deprecated because the original case of the method may be useful in anomaly detection.  Original case will be mandated in ECS 2.0.0
      ignore_above: 1024
    - name: request.referrer
      level: extended
      type: keyword
      description: Referrer for this HTTP request.
      ignore_above: 1024
    - name: response.body.bytes
      level: extended
      type: long
      format: bytes
      description: Size in bytes of the response body.
    - name: response.status_code
      level: extended
      type: long
      format: string
      description: HTTP response status code.
- description: "Host ip addresses."
  name: host.ip
  type: ip
- name: network
  title: Network
  group: 2
  type: group
  fields:
    - name: protocol
      level: core
      type: keyword
      description: |-
        L7 Network protocol name. ex. http, lumberjack, transport protocol.
        The field value must be normalized to lowercase for querying. See the documentation section "Implementing ECS".
      ignore_above: 1024
    - name: transport
      level: core
      type: keyword
      description: |-
        Same as network.iana_number, but instead using the Keyword name of the transport layer (udp, tcp, ipv6-icmp, etc.)
        The field value must be normalized to lowercase for querying. See the documentation section "Implementing ECS".
      ignore_above: 1024
- name: source
  title: Source
  group: 2
  type: group
  fields:
    - name: bytes
      level: core
      type: long
      format: bytes
      description: Bytes sent from the source to the destination.
    - name: ip
      level: core
      type: ip
      description: IP address of the source (IPv4 or IPv6).
    - name: packets
      level: core
      type: long
      description: Packets sent from the source to the destination.
    - name: port
      level: core
      type: long
      format: string
      description: Port of the source.
    - name: geo.city_name
      type: keyword
      description: City name.
    - name: geo.continent_name
      type: keyword
      description: Name of the continent.
    - name: geo.country_iso_code
      type: keyword
      description: Country ISO code.
    - name: geo.country_name
      type: keyword
      description: Country name.
    - name: geo.location
      type: geo_point
      description: Longitude and latitude.
    - name: geo.region_iso_code
      type: keyword
      description: Region ISO code.
    - name: geo.region_name
      type: keyword
      description: Region name.
- name: url
  title: URL
  group: 2
  type: group
  fields:
    - name: domain
      level: extended
      type: keyword
      description: |-
        Domain of the url, such as "www.elastic.co".
        In some cases a URL may refer to an IP and/or port directly, without a domain name. In this case, the IP address would go to the `domain` field.
      ignore_above: 1024
    - name: original
      level: extended
      type: wildcard
      description: |-
        Unmodified original url as seen in the event source.
        Note that in network monitoring, the observed URL may be a full URL, whereas in access logs, the URL is often just represented as a path.
        This field is meant to represent the URL as it was observed, complete or not.
      ignore_above: 1024
      multi_fields:
        - name: text
          type: text
          norms: false
          default_field: false
    - name: query
      type: keyword
      ignore_above: 1024
      description: 'The query field describes the query string of the request, such as "q=elasticsearch".'
- name: user_agent
  title: User agent
  group: 2
  type: group
  fields:
    - name: original
      level: extended
      type: keyword
      description: Unparsed user_agent string.
      ignore_above: 1024
      multi_fields:
        - name: text
          type: text
          norms: false
- name: tags
  type: keyword
  description: List of keywords used to tag each event.
- name: tls.server.x509.issuer.common_name
  description: List of common name (CN) of issuing certificate authority.
  type: keyword
- name: tls.server.x509.issuer.country
  description: List of country (C) codes
  type: keyword
- name: tls.server.x509.issuer.locality
  description: List of locality names (L)
  type: keyword
- name: tls.server.x509.issuer.organization
  description: List of organizations (O) of issuing certificate authority.
  type: keyword
- name: tls.server.x509.issuer.organizational_unit
  description: List of organizational units (OU) of issuing certificate authority.
  type: keyword
- name: tls.server.x509.issuer.state_or_province
  description: List of state or province names (ST, S, or P)
  type: keyword
- name: tls.server.x509.not_after
  description: Time at which the certificate is no longer considered valid.
  type: date
- name: tls.server.x509.not_before
  description: Time at which the certificate is first considered valid.
  type: date
- name: tls.server.x509.serial_number
  description: Unique serial number issued by the certificate authority.
  type: keyword
- name: tls.server.x509.subject.common_name
  description: List of common names (CN) of subject.
  type: keyword
- name: tls.server.x509.subject.country
  description: List of country (C) code
  type: keyword
- name: tls.server.x509.subject.locality
  description: List of locality names (L)
  type: keyword
- name: tls.server.x509.subject.organization
  description: List of organizations (O) of subject.
  type: keyword
- name: tls.server.x509.subject.organizational_unit
  description: List of organizational units (OU) of subject.
  type: keyword
- name: tls.server.x509.subject.state_or_province
  description: List of state or province names (ST, S, or P)
  type: keyword
- name: related.hosts
  description: All the host identifiers seen on your event.
  type: keyword
- name: tls.server.not_after
  description: Timestamp indicating when server certificate is no longer considered valid.
  type: date
- name: tls.server.not_before
  description: Timestamp indicating when server certificate is first considered valid.
  type: date
- name: destination.mac
  type: keyword
  description: Destination mac address.
- name: destination.address
  type: keyword
  description: Destination network address.
- name: destination.as.number
  type: long
  description: Unique number allocated to the autonomous system.
- name: destination.as.organization.name
  type: keyword
  description: Organization name.
- name: destination.domain
  type: keyword
  description: Destination domain.
- name: destination.geo.city_name
  type: keyword
  description: City name.
- name: destination.geo.continent_name
  type: keyword
  description: Name of the continent.
- name: destination.geo.country_iso_code
  type: keyword
  description: Country ISO code.
- name: destination.geo.country_name
  type: keyword
  description: Country name.
- name: destination.geo.location
  type: geo_point
  description: Longitude and latitude.
- name: destination.geo.region_iso_code
  type: keyword
  description: Region ISO code.
- name: destination.geo.region_name
  type: keyword
  description: Region name.
- name: message
  type: text
  description: Log message optimized for viewing in a log viewer.
- name: network.bytes
  type: long
  description: Total bytes transferred in both directions.
- name: network.community_id
  type: keyword
  description: A hash of source and destination IPs and ports.
- name: network.packets
  type: long
  description: Total packets transferred in both directions.
- name: rule.category
  type: keyword
  description: Rule category
- name: rule.id
  type: keyword
  description: Rule ID
- name: rule.name
  type: keyword
  description: Rule name
- name: source.mac
  type: keyword
  description: Source mac address.
- name: source.address
  type: keyword
  description: Source network address.
- name: tls.client.server_name
  type: keyword
  description: Hostname the client is trying to connect to. Also called the SNI.
- name: tls.resumed
  type: boolean
  description: Boolean flag indicating if this TLS connection was resumed from an existing TLS negotiation.
- name: tls.version
  type: keyword
  description: Numeric part of the version parsed from the original string.
- name: tls.version_protocol
  type: keyword
  description: Normalized lowercase protocol name parsed from original string.
- name: url.path
  type: keyword
  description: Path of the request, such as "/search".
- name: user_agent.device.name
  type: keyword
  description: Name of the device.
- name: user_agent.name
  type: keyword
  description: Name of the user agent.
- name: user_agent.version
  type: keyword
  description: Version of the user agent.
- name: ecs.version
  type: keyword
  description: ECS version this event conforms to.
- name: related.hash
  type: keyword
  description: All the hashes seen on your event.
- name: tls.client.ja3
  type: keyword
  description: A hash that identifies clients based on how they perform an SSL/TLS handshake.
- name: tls.server.hash.sha1
  type: keyword
  description: Certificate fingerprint using the SHA1 digest of DER-encoded version of certificate offered by the server.
- name: tls.server.issuer
  type: keyword
  description: Subject of the issuer of the x.509 certificate presented by the server.
- name: tls.server.ja3s
  type: keyword
  description: A hash that identifies servers based on how they perform an SSL/TLS handshake.
- name: tls.server.subject
  type: keyword
  description: Subject of the x.509 certificate presented by the server.
- name: user_agent.os.full
  type: keyword
  description: Operating system name, including the version or code name.
- name: user_agent.os.name
  type: keyword
  description: Operating system name, without the version.
- name: user_agent.os.version
  type: keyword
  description: Operating system version as a raw string.
