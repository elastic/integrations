# Suricata Integration

This integration is for [Suricata](https://suricata-ids.org/). It reads the EVE
JSON output file. The EVE output writes alerts, anomalies, metadata, file info
and protocol specific records as JSON.

## Compatibility

This module has been developed against Suricata v4.0.4, but is expected to work
with other versions of Suricata.

## EVE

**Exported fields**

| Field | Description | Type |
|---|---|---|
| @timestamp | Date/time when the event originated. This is the date/time extracted from the event, typically representing when the event was generated by the source. If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline. Required field for all events. | date |
| dataset.name | Dataset name. | constant_keyword |
| dataset.namespace | Dataset namespace. | constant_keyword |
| dataset.type | Dataset type. | constant_keyword |
| destination.bytes | Bytes sent from the destination to the source. | long |
| destination.ip | IP address of the destination (IPv4 or IPv6). | ip |
| destination.packets | Packets sent from the destination to the source. | long |
| destination.port | Port of the destination. | long |
| event.outcome | This is one of four ECS Categorization Fields, and indicates the lowest level in the ECS category hierarchy. `event.outcome` simply denotes whether the event represents a success or a failure from the perspective of the entity that produced the event. Note that when a single transaction is described in multiple events, each event may populate different values of `event.outcome`, according to their perspective. Also note that in the case of a compound event (a single event that contains multiple logical events), this field should be populated with the value that best captures the overall success or failure from the perspective of the event producer. Further note that not all events will have an associated outcome. For example, this field is generally not populated for metric events, events with `event.type:info`, or any events for which an outcome does not make logical sense. | keyword |
| event.severity | The numeric severity of the event according to your event source. What the different severity values mean can be different between sources and use cases. It's up to the implementer to make sure severities are consistent across events from the same source. The Syslog severity belongs in `log.syslog.severity.code`. `event.severity` is meant to represent the severity according to the event source (e.g. firewall, IDS). If the event source does not publish its own severity, you may optionally copy the `log.syslog.severity.code` to `event.severity`. | long |
| event.start | event.start contains the date when the event started or when the activity was first observed. | date |
| file.path | Full path to the file, including the file name. It should include the drive letter, when appropriate. | keyword |
| file.size | File size in bytes. Only relevant when `file.type` is "file". | long |
| http.request.method | HTTP request method. Prior to ECS 1.6.0 the following guidance was provided: "The field value must be normalized to lowercase for querying." As of ECS 1.6.0, the guidance is deprecated because the original case of the method may be useful in anomaly detection.  Original case will be mandated in ECS 2.0.0 | keyword |
| http.request.referrer | Referrer for this HTTP request. | keyword |
| http.response.body.bytes | Size in bytes of the response body. | long |
| http.response.status_code | HTTP response status code. | long |
| network.protocol | L7 Network protocol name. ex. http, lumberjack, transport protocol. The field value must be normalized to lowercase for querying. See the documentation section "Implementing ECS". | keyword |
| network.transport | Same as network.iana_number, but instead using the Keyword name of the transport layer (udp, tcp, ipv6-icmp, etc.) The field value must be normalized to lowercase for querying. See the documentation section "Implementing ECS". | keyword |
| source.bytes | Bytes sent from the source to the destination. | long |
| source.ip | IP address of the source (IPv4 or IPv6). | ip |
| source.packets | Packets sent from the source to the destination. | long |
| source.port | Port of the source. | long |
| suricata.eve.alert.category |  | keyword |
| suricata.eve.alert.gid |  | long |
| suricata.eve.alert.rev |  | long |
| suricata.eve.alert.signature |  | keyword |
| suricata.eve.alert.signature_id |  | long |
| suricata.eve.app_proto_expected |  | keyword |
| suricata.eve.app_proto_orig |  | keyword |
| suricata.eve.app_proto_tc |  | keyword |
| suricata.eve.app_proto_ts |  | keyword |
| suricata.eve.dns.id |  | long |
| suricata.eve.dns.rcode |  | keyword |
| suricata.eve.dns.rdata |  | keyword |
| suricata.eve.dns.rrname |  | keyword |
| suricata.eve.dns.rrtype |  | keyword |
| suricata.eve.dns.ttl |  | long |
| suricata.eve.dns.tx_id |  | long |
| suricata.eve.dns.type |  | keyword |
| suricata.eve.email.status |  | keyword |
| suricata.eve.event_type |  | keyword |
| suricata.eve.fileinfo.gaps |  | boolean |
| suricata.eve.fileinfo.md5 |  | keyword |
| suricata.eve.fileinfo.sha1 |  | keyword |
| suricata.eve.fileinfo.sha256 |  | keyword |
| suricata.eve.fileinfo.state |  | keyword |
| suricata.eve.fileinfo.stored |  | boolean |
| suricata.eve.fileinfo.tx_id |  | long |
| suricata.eve.flow.age |  | long |
| suricata.eve.flow.alerted |  | boolean |
| suricata.eve.flow.end |  | date |
| suricata.eve.flow.reason |  | keyword |
| suricata.eve.flow.state |  | keyword |
| suricata.eve.flow_id |  | keyword |
| suricata.eve.http.http_content_type |  | keyword |
| suricata.eve.http.protocol |  | keyword |
| suricata.eve.http.redirect |  | keyword |
| suricata.eve.icmp_code |  | long |
| suricata.eve.icmp_type |  | long |
| suricata.eve.in_iface |  | keyword |
| suricata.eve.pcap_cnt |  | long |
| suricata.eve.smtp.helo |  | keyword |
| suricata.eve.smtp.mail_from |  | keyword |
| suricata.eve.smtp.rcpt_to |  | keyword |
| suricata.eve.ssh.client.proto_version |  | keyword |
| suricata.eve.ssh.client.software_version |  | keyword |
| suricata.eve.ssh.server.proto_version |  | keyword |
| suricata.eve.ssh.server.software_version |  | keyword |
| suricata.eve.stats.app_layer.flow.dcerpc_tcp |  | long |
| suricata.eve.stats.app_layer.flow.dcerpc_udp |  | long |
| suricata.eve.stats.app_layer.flow.dns_tcp |  | long |
| suricata.eve.stats.app_layer.flow.dns_udp |  | long |
| suricata.eve.stats.app_layer.flow.failed_tcp |  | long |
| suricata.eve.stats.app_layer.flow.failed_udp |  | long |
| suricata.eve.stats.app_layer.flow.ftp |  | long |
| suricata.eve.stats.app_layer.flow.http |  | long |
| suricata.eve.stats.app_layer.flow.imap |  | long |
| suricata.eve.stats.app_layer.flow.msn |  | long |
| suricata.eve.stats.app_layer.flow.smb |  | long |
| suricata.eve.stats.app_layer.flow.smtp |  | long |
| suricata.eve.stats.app_layer.flow.ssh |  | long |
| suricata.eve.stats.app_layer.flow.tls |  | long |
| suricata.eve.stats.app_layer.tx.dcerpc_tcp |  | long |
| suricata.eve.stats.app_layer.tx.dcerpc_udp |  | long |
| suricata.eve.stats.app_layer.tx.dns_tcp |  | long |
| suricata.eve.stats.app_layer.tx.dns_udp |  | long |
| suricata.eve.stats.app_layer.tx.ftp |  | long |
| suricata.eve.stats.app_layer.tx.http |  | long |
| suricata.eve.stats.app_layer.tx.smb |  | long |
| suricata.eve.stats.app_layer.tx.smtp |  | long |
| suricata.eve.stats.app_layer.tx.ssh |  | long |
| suricata.eve.stats.app_layer.tx.tls |  | long |
| suricata.eve.stats.capture.kernel_drops |  | long |
| suricata.eve.stats.capture.kernel_ifdrops |  | long |
| suricata.eve.stats.capture.kernel_packets |  | long |
| suricata.eve.stats.decoder.avg_pkt_size |  | long |
| suricata.eve.stats.decoder.bytes |  | long |
| suricata.eve.stats.decoder.dce.pkt_too_small |  | long |
| suricata.eve.stats.decoder.erspan |  | long |
| suricata.eve.stats.decoder.ethernet |  | long |
| suricata.eve.stats.decoder.gre |  | long |
| suricata.eve.stats.decoder.icmpv4 |  | long |
| suricata.eve.stats.decoder.icmpv6 |  | long |
| suricata.eve.stats.decoder.ieee8021ah |  | long |
| suricata.eve.stats.decoder.invalid |  | long |
| suricata.eve.stats.decoder.ipraw.invalid_ip_version |  | long |
| suricata.eve.stats.decoder.ipv4 |  | long |
| suricata.eve.stats.decoder.ipv4_in_ipv6 |  | long |
| suricata.eve.stats.decoder.ipv6 |  | long |
| suricata.eve.stats.decoder.ipv6_in_ipv6 |  | long |
| suricata.eve.stats.decoder.ltnull.pkt_too_small |  | long |
| suricata.eve.stats.decoder.ltnull.unsupported_type |  | long |
| suricata.eve.stats.decoder.max_pkt_size |  | long |
| suricata.eve.stats.decoder.mpls |  | long |
| suricata.eve.stats.decoder.null |  | long |
| suricata.eve.stats.decoder.pkts |  | long |
| suricata.eve.stats.decoder.ppp |  | long |
| suricata.eve.stats.decoder.pppoe |  | long |
| suricata.eve.stats.decoder.raw |  | long |
| suricata.eve.stats.decoder.sctp |  | long |
| suricata.eve.stats.decoder.sll |  | long |
| suricata.eve.stats.decoder.tcp |  | long |
| suricata.eve.stats.decoder.teredo |  | long |
| suricata.eve.stats.decoder.udp |  | long |
| suricata.eve.stats.decoder.vlan |  | long |
| suricata.eve.stats.decoder.vlan_qinq |  | long |
| suricata.eve.stats.defrag.ipv4.fragments |  | long |
| suricata.eve.stats.defrag.ipv4.reassembled |  | long |
| suricata.eve.stats.defrag.ipv4.timeouts |  | long |
| suricata.eve.stats.defrag.ipv6.fragments |  | long |
| suricata.eve.stats.defrag.ipv6.reassembled |  | long |
| suricata.eve.stats.defrag.ipv6.timeouts |  | long |
| suricata.eve.stats.defrag.max_frag_hits |  | long |
| suricata.eve.stats.detect.alert |  | long |
| suricata.eve.stats.dns.memcap_global |  | long |
| suricata.eve.stats.dns.memcap_state |  | long |
| suricata.eve.stats.dns.memuse |  | long |
| suricata.eve.stats.file_store.open_files |  | long |
| suricata.eve.stats.flow.emerg_mode_entered |  | long |
| suricata.eve.stats.flow.emerg_mode_over |  | long |
| suricata.eve.stats.flow.icmpv4 |  | long |
| suricata.eve.stats.flow.icmpv6 |  | long |
| suricata.eve.stats.flow.memcap |  | long |
| suricata.eve.stats.flow.memuse |  | long |
| suricata.eve.stats.flow.spare |  | long |
| suricata.eve.stats.flow.tcp |  | long |
| suricata.eve.stats.flow.tcp_reuse |  | long |
| suricata.eve.stats.flow.udp |  | long |
| suricata.eve.stats.flow_mgr.bypassed_pruned |  | long |
| suricata.eve.stats.flow_mgr.closed_pruned |  | long |
| suricata.eve.stats.flow_mgr.est_pruned |  | long |
| suricata.eve.stats.flow_mgr.flows_checked |  | long |
| suricata.eve.stats.flow_mgr.flows_notimeout |  | long |
| suricata.eve.stats.flow_mgr.flows_removed |  | long |
| suricata.eve.stats.flow_mgr.flows_timeout |  | long |
| suricata.eve.stats.flow_mgr.flows_timeout_inuse |  | long |
| suricata.eve.stats.flow_mgr.new_pruned |  | long |
| suricata.eve.stats.flow_mgr.rows_busy |  | long |
| suricata.eve.stats.flow_mgr.rows_checked |  | long |
| suricata.eve.stats.flow_mgr.rows_empty |  | long |
| suricata.eve.stats.flow_mgr.rows_maxlen |  | long |
| suricata.eve.stats.flow_mgr.rows_skipped |  | long |
| suricata.eve.stats.http.memcap |  | long |
| suricata.eve.stats.http.memuse |  | long |
| suricata.eve.stats.tcp.insert_data_normal_fail |  | long |
| suricata.eve.stats.tcp.insert_data_overlap_fail |  | long |
| suricata.eve.stats.tcp.insert_list_fail |  | long |
| suricata.eve.stats.tcp.invalid_checksum |  | long |
| suricata.eve.stats.tcp.memuse |  | long |
| suricata.eve.stats.tcp.no_flow |  | long |
| suricata.eve.stats.tcp.overlap |  | long |
| suricata.eve.stats.tcp.overlap_diff_data |  | long |
| suricata.eve.stats.tcp.pseudo |  | long |
| suricata.eve.stats.tcp.pseudo_failed |  | long |
| suricata.eve.stats.tcp.reassembly_gap |  | long |
| suricata.eve.stats.tcp.reassembly_memuse |  | long |
| suricata.eve.stats.tcp.rst |  | long |
| suricata.eve.stats.tcp.segment_memcap_drop |  | long |
| suricata.eve.stats.tcp.sessions |  | long |
| suricata.eve.stats.tcp.ssn_memcap_drop |  | long |
| suricata.eve.stats.tcp.stream_depth_reached |  | long |
| suricata.eve.stats.tcp.syn |  | long |
| suricata.eve.stats.tcp.synack |  | long |
| suricata.eve.stats.uptime |  | long |
| suricata.eve.tcp.ack |  | boolean |
| suricata.eve.tcp.fin |  | boolean |
| suricata.eve.tcp.psh |  | boolean |
| suricata.eve.tcp.rst |  | boolean |
| suricata.eve.tcp.state |  | keyword |
| suricata.eve.tcp.syn |  | boolean |
| suricata.eve.tcp.tcp_flags |  | keyword |
| suricata.eve.tcp.tcp_flags_tc |  | keyword |
| suricata.eve.tcp.tcp_flags_ts |  | keyword |
| suricata.eve.tls.fingerprint |  | keyword |
| suricata.eve.tls.issuerdn |  | keyword |
| suricata.eve.tls.ja3.hash |  | keyword |
| suricata.eve.tls.ja3.string |  | keyword |
| suricata.eve.tls.ja3s.hash |  | keyword |
| suricata.eve.tls.ja3s.string |  | keyword |
| suricata.eve.tls.notafter |  | date |
| suricata.eve.tls.notbefore |  | date |
| suricata.eve.tls.serial |  | keyword |
| suricata.eve.tls.session_resumed |  | boolean |
| suricata.eve.tls.sni |  | keyword |
| suricata.eve.tls.subject |  | keyword |
| suricata.eve.tls.version |  | keyword |
| suricata.eve.tx_id |  | long |
| url.domain | Domain of the url, such as "www.elastic.co". In some cases a URL may refer to an IP and/or port directly, without a domain name. In this case, the IP address would go to the `domain` field. | keyword |
| url.original | Unmodified original url as seen in the event source. Note that in network monitoring, the observed URL may be a full URL, whereas in access logs, the URL is often just represented as a path. This field is meant to represent the URL as it was observed, complete or not. | keyword |
| user_agent.original | Unparsed user_agent string. | keyword |

