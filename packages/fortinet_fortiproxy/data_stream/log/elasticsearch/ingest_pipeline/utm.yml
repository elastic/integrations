---
description: Pipeline for processing utm logs from Fortinet Fortiproxy.
processors:
# ------------------------------------------------------------------------------
# Convert fields.
  - convert:
      tag: convert_botnetip
      field: _fields_.botnetip
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_c-bytes
      field: _fields_.c-bytes
      type: long
      ignore_missing: true
  - convert:
      tag: convert_c-ggsn
      field: _fields_.c-ggsn
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_c-gsn
      field: _fields_.c-gsn
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_c-pkts
      field: _fields_.c-pkts
      type: long
      ignore_missing: true
  - convert:
      tag: convert_c-sgsn
      field: _fields_.c-sgsn
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_cfseidaddr
      field: _fields_.cfseidaddr
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_cggsn6
      field: _fields_.cggsn6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_cgsn6
      field: _fields_.cgsn6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_clashtunnelidx
      field: _fields_.clashtunnelidx
      type: long
      ignore_missing: true
  - convert:
      tag: convert_cpaddr
      field: _fields_.cpaddr
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_cpaddr6
      field: _fields_.cpaddr6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_cpdladdr
      field: _fields_.cpdladdr
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_cpdladdr6
      field: _fields_.cpdladdr6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_cpdlisraddr
      field: _fields_.cpdlisraddr
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_cpdlisraddr6
      field: _fields_.cpdlisraddr6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_cpuladdr
      field: _fields_.cpuladdr
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_cpuladdr6
      field: _fields_.cpuladdr6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_csgsn6
      field: _fields_.csgsn6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_dlpfilteridx
      field: _fields_.dlpfilteridx
      type: long
      ignore_missing: true
  - convert:
      tag: convert_domainfilteridx
      field: _fields_.domainfilteridx
      type: long
      ignore_missing: true
  - convert:
      tag: convert_end-usr-address
      field: _fields_.end-usr-address
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_endusraddress6
      field: _fields_.endusraddress6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_epoch
      field: _fields_.epoch
      type: long
      ignore_missing: true
  - convert:
      tag: convert_filteridx
      field: _fields_.filteridx
      type: long
      ignore_missing: true
  - convert:
      tag: convert_from4
      field: _fields_.from4
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_from6
      field: _fields_.from6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_ietype
      field: _fields_.ietype
      type: long
      ignore_missing: true
  - convert:
      tag: convert_incidentserialno
      field: _fields_.incidentserialno
      type: long
      ignore_missing: true
  - convert:
      tag: convert_infectedfilelevel
      field: _fields_.infectedfilelevel
      type: long
      ignore_missing: true
  - convert:
      tag: convert_infectedfilesize
      field: _fields_.infectedfilesize
      type: long
      ignore_missing: true
  - convert:
      tag: convert_keysize
      field: _fields_.keysize
      type: long
      ignore_missing: true
  - convert:
      tag: convert_linked-nsapi
      field: _fields_.linked-nsapi
      type: long
      ignore_missing: true
  - convert:
      tag: convert_msg-type
      field: _fields_.msg-type
      type: long
      ignore_missing: true
  - convert:
      tag: convert_nsapi
      field: _fields_.nsapi
      type: long
      ignore_missing: true
  - convert:
      tag: convert_ocrlog
      field: _fields_.ocrlog
      type: long
      ignore_missing: true
  - convert:
      tag: convert_qtypeval
      field: _fields_.qtypeval
      type: long
      ignore_missing: true
  - convert:
      tag: convert_quotamax
      field: _fields_.quotamax
      type: long
      ignore_missing: true
  - convert:
      tag: convert_quotaused
      field: _fields_.quotaused
      type: long
      ignore_missing: true
  - convert:
      tag: convert_rcode
      field: _fields_.rcode
      type: long
      ignore_missing: true
  - convert:
      tag: convert_seqnum
      field: _fields_.seqnum
      type: long
      ignore_missing: true
  - convert:
      tag: convert_timeoutdelete
      field: _fields_.timeoutdelete
      type: long
      ignore_missing: true
  - convert:
      tag: convert_to4
      field: _fields_.to4
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_to6
      field: _fields_.to6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_trueclntip
      field: _fields_.trueclntip
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_tunnel-idx
      field: _fields_.tunnel-idx
      type: long
      ignore_missing: true
  - convert:
      tag: convert_u-bytes
      field: _fields_.u-bytes
      type: long
      ignore_missing: true
  - convert:
      tag: convert_u-ggsn
      field: _fields_.u-ggsn
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_u-gsn
      field: _fields_.u-gsn
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_u-pkts
      field: _fields_.u-pkts
      type: long
      ignore_missing: true
  - convert:
      tag: convert_u-sgsn
      field: _fields_.u-sgsn
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_ufseidaddr
      field: _fields_.ufseidaddr
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_uggsn6
      field: _fields_.uggsn6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_ugsn6
      field: _fields_.ugsn6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_ulimcc
      field: _fields_.ulimcc
      type: long
      ignore_missing: true
  - convert:
      tag: convert_ulimnc
      field: _fields_.ulimnc
      type: long
      ignore_missing: true
  - convert:
      tag: convert_urlfilteridx
      field: _fields_.urlfilteridx
      type: long
      ignore_missing: true
  - convert:
      tag: convert_usgsn6
      field: _fields_.usgsn6
      type: ip
      ignore_missing: true
  - convert:
      tag: convert_violatescore
      field: _fields_.violatescore
      type: long
      ignore_missing: true

on_failure:
  - append:
      field: error.message
      value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: event.kind
      value: pipeline_error
