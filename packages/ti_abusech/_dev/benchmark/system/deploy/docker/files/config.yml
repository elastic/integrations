rules:
  # ja3_fingerprints data stream
  - path: /blacklist/ja3_fingerprints.csv
    methods: ["GET"]
    responses:
      - status_code: 200
        body: |-
          ################################################################
          # abuse.ch Suricata JA3 Fingerprint Blacklist (CSV)            #
          # For Suricata 4.1.0 or newer                                  #
          # Last updated: 2021-08-03 14:33:44 UTC                        #
          #                                                              #
          # Terms Of Use: https://sslbl.abuse.ch/blacklist/              #
          # For questions please contact sslbl [at] abuse.ch             #
          ################################################################
          #
          # ja3_md5,Firstseen,Lastseen,Listingreason
          {{- $g := glob "/var/log/corpus-*" -}}
          {{- range $g -}}
            {{- file . -}}
          {{- end -}}
          {{/* A last line of hard-coded data is required to avoid empty string from being sent to CEL program in the final line */}}
          b386946a5a44d1ddcc843bc75336dfce,2017-07-14 18:08:15,2019-07-27 20:42:54,Dridex
  # malware data stream
  - path: /v1/payloads/recent/
    methods: ["GET"]
    request_headers:
      Content-Type: "application/json"
      Auth-Key: "test_auth_key"
    responses:
      - status_code: 200
        body: |-
          {
            "query_status": "ok",
            "payloads": [
              {{/* Comma is added at the end of each line inside the template to preserve JSON format */}}
              {{- $g := glob "/var/log/corpus-*" -}}
              {{- range $g -}}
                {{- file . -}}
              {{- end -}}
              {{/* A last line of hard-coded data is required to properly close the JSON body */}}
              {"file_size":"68351956","file_type":"unknown","firstseen":"2025-08-25 00:00:00","imphash":"agatedagger","magika":"unknown","md5_hash":"daffodilcurtain","sha256_hash":"9f41ec69f076357ea6fa4f3de644b97b0a17cc165de4abb1394052304d426cdb","signature":"cyancoyote","ssdeep":"azurewasp","tlsh":"brindlebunny","urlhaus_download":"https://urlhaus-api.abuse.ch/v1/download/9f41ec69f076357ea6fa4f3de644b97b0a17cc165de4abb1394052304d426cdb/","virustotal":{"link":"https://www.virustotal.com/gui/file/9f41ec69f076357ea6fa4f3de644b97b0a17cc165de4abb1394052304d426cdb/detection/petalsword","percent":"92.50459264394924","result":"29 / 71"}}
            ]
          }
  # malwarebazaar data stream
  - path: /api/v1/
    methods: ["POST"]
    request_headers:
      Content-Type: "application/x-www-form-urlencoded"
      Auth-Key: "test_auth_key"
    query_params:
      query: "get_recent"
      selector: "time"
    responses:
      - status_code: 200
        body: |-
          {
            "query_status": "ok",
            "data": [
              {{/* Comma is added at the end of each line inside the template to preserve JSON format */}}
              {{- $g := glob "/var/log/corpus-*" -}}
              {{- range $g -}}
                {{- file . -}}
              {{- end -}}
              {{/* A last line of hard-coded data is required to properly close the JSON body */}}
              {"sha256_hash":"a1b2c3d4e5f67890123456789abcdef0123456789abcdef0123456789abcdef","sha3_384_hash":"b1c2d3e4f5a67890123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef","sha1_hash":"c1d2e3f4a567890123456789abcdef012345678","md5_hash":"d1e2f3a4567890123456789abcdef01","first_seen":"2023-06-15 10:30:45","last_seen":null,"file_name":"dummy_malware.exe","file_size":512345,"file_type_mime":"application/x-dosexec","file_type":"exe","reporter":"dummy_researcher","origin_country":"US","anonymous":0,"signature":"FakeSignature","imphash":"e1f2a3b4567890abcdef1234567890ab","tlsh":"F1E2D3C4B5A67890ABCDEF1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF12","telfhash":null,"ssdeep":"6144:ABCDEF0123456789abcdefABCDEF0123456789abcdefABCDEF0123456789abcdef:A1B2C3D4E5F6G7H8","dhash_icon":null,"tags":["64","exe","FakeSignature","ransomware"],"code_sign":[],"intelligence":{"clamav":null,"downloads":"25","uploads":"3","mail":null}}
            ]
          }
  # sslblacklist data stream
  - path: /blacklist/sslblacklist.csv
    methods: ["GET"]
    responses:
      - status_code: 200
        body: |-
          ################################################################
          # abuse.ch SSLBL SSL Certificate Blacklist (SHA1 Fingerprints) #
          # Last updated: 2025-06-25 06:50:28 UTC                        #
          #                                                              #
          # Terms Of Use: https://sslbl.abuse.ch/blacklist/              #
          # For questions please contact sslbl [at] abuse.ch             #
          ################################################################
          #
          # Listingdate,SHA1,Listingreason
          {{- $g := glob "/var/log/corpus-*" -}}
          {{- range $g -}}
            {{- file . -}}
          {{- end -}}
          {{/* A last line of hard-coded data is required to avoid empty string from being sent to CEL program in the final line */}}
          2025-06-25 00:00:28,029c128ec7f6c5a62ea19f5ad525cd1487971ce4,HijackLoader C&C
  # threatfox data stream
  - path: /api/v1/
    methods: ["POST"]
    request_headers:
      Content-Type: "application/json"
      Auth-Key: "test_auth_key"
    body:
      query: "get_iocs"
      days: /[1-7]+/
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "query_status": "ok",
            "data": [
              {{/* Comma is added at the end of each line inside the template to preserve JSON format */}}
              {{- $g := glob "/var/log/corpus-*" -}}
              {{- range $g -}}
                {{- file . -}}
              {{- end -}}
              {{/* A last line of hard-coded data is required to properly close the JSON body */}}
              {"id":"1","ioc":"949f512497334f4276ae9829a29deafd005529ab23bc921750d5968f898ebc8b","threat_type":"botnet_cc","threat_type_desc":"Indicator that identifies a botnet command&control server (C&C)","ioc_type":"sha256_hash","ioc_type_desc":"ip:port combination that delivery a malware payload","malware":"quiverreaper","malware_printable":"PyUzQbDc PyUzQbDc","malware_alias":"PyUzQbDc PyUzQbDc,PYUZQBDC,pyuzqbdc","malware_malpedia":"https://malpedia.caad.fkie.fraunhofer.de/details/quiverreaper","confidence_level":90,"first_seen":"2025-08-25 00:00:00","last_seen":"2025-08-25 01:00:00","reference":"https://intelinsights.substack.com/p/dourmask","reporter":"valleywing","tags":["PyUzQbDc","valleywing","quiverreaper"]}
            ]
          }
