{{- $timestamp := generate "timestamp" }}
{{- $fileSize := generate "filesize" }}
{{- $fileType := generate "filetype" }}
{{- $impHash := generate "imp_hash" }}
{{- $md5Hash := generate "md5_hash" }}
{{- $sha256Hash := sha256sum (generate "sha256_hash") }}
{{- $signature := generate "signature" }}
{{- $ssdeep := generate "ssdeep" }}
{{- $tlsh := generate "tlsh" }}
{{- $duration_start := generate "duration_start" }}
{{- $firstSeen := ($timestamp | date_modify (print $duration_start)).Format "2006-01-02 15:04:05" }}
{{- $virustotalPercent := generate "virustotal.percent" }}
{{- $virustotalDetectionId := generate "virustotal.detection_id" }}
{{- $virustotalResultNum := generate "virustotal.result_num" }}
{{- $virustotalResultDen := generate "virustotal.result_den" }}
{"file_size": "{{ $fileSize }}","file_type": "{{ $fileType }}","firstseen": "{{ $firstSeen }}","imphash": "{{ $impHash }}","magika": "{{ $fileType }}","md5_hash": "{{ $md5Hash }}","sha256_hash": "{{ $sha256Hash }}","signature": "{{ $signature }}","ssdeep": "{{ $ssdeep }}","tlsh": "{{ $tlsh }}","urlhaus_download": "https://urlhaus-api.abuse.ch/v1/download/{{ $sha256Hash }}/","virustotal": {"link": "https://www.virustotal.com/gui/file/{{ $sha256Hash }}/detection/{{ $virustotalDetectionId }}","percent": "{{ $virustotalPercent }}","result": "{{ $virustotalResultNum }} / {{ $virustotalResultDen }}"}},
