- name: abusech.malwarebazaar
  type: group
  description: All fields related to AbuseCH URL indicators.
  fields:
    - name: tags
      type: keyword
      description: >
        A list of tags associated with the queried malware sample.

    - name: intelligence
      type: group
      fields:
        - name: downloads
          type: long
          description: >
            Number of downloads from MalwareBazaar.

        - name: uploads
          type: long
          description: >
            Number of uploads from MalwareBazaar.

        - name: mail
          type: group
          fields:
            - name: Generic
              type: keyword
              description: >
                Malware seen in generic spam traffic.

            - name: IT
              type: keyword
              description: >
                Malware seen in IT spam traffic.

    - name: anonymous
      type: long
      description: >
        Identifies if the sample was submitted anonymously.

    - name: dhash_icon
      type: keyword
      description: >
        In case the file is a PE executable: dhash of the samples icon

    - name: code_sign
      type: nested
      description: >
        Code signing information for the sample.

      fields:
        - name: algorithm
          type: keyword
          description: >
            Algorithm used to generate the public key.

        - name: cscb_listed
          type: boolean
          description: >
            Whether the certificate is present on the Code Signing Certificate Blocklist (CSCB)

        - name: cscb_reason
          type: keyword
          description: >
            Why the certificate is present on the Code Signing Certificate Blocklist (CSCB)

        - name: issuer_cn
          type: keyword
          description: >
            Common name (CN) of issuing certificate authority.

        - name: serial_number
          type: keyword
          description: >
            Unique serial number issued by the certificate authority.

        - name: subject_cn
          type: keyword
          description: >
            Common name (CN) of subject.

        - name: thumbprint
          type: keyword
          description: >
            Hash of certificate

        - name: thumbprint_algorithm
          type: keyword
          description: >
            Algorithm used to create thumbprint

        - name: valid_from
          type: date
          description: >
            Time at which the certificate is first considered valid.

        - name: valid_to
          type: keyword
          description: >
            Time at which the certificate is no longer considered valid.

