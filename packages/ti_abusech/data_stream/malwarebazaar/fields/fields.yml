- name: abusech.malwarebazaar
  type: group
  description: All fields related to AbuseCH URL indicators.
  fields:
    - name: intelligence
      type: group
      fields:
        - name: clamav
          type: keyword
          description: >
            ClamAV detection name for the sample.

        - name: downloads
          type: long
          description: >
            Number of downloads from MalwareBazaar.

        - name: uploads
          type: long
          description: >
            Number of uploads from MalwareBazaar.

        - name: mail
          type: group
          fields:
            - name: Generic
              type: keyword
              description: >
                Malware seen in generic spam traffic.

            - name: IT
              type: keyword
              description: >
                Malware seen in IT spam traffic.

    - name: anonymous
      type: long
      description: >
        Identifies if the sample was submitted anonymously.

    - name: dhash_icon
      type: keyword
      description: >
        In case the file is a PE executable: dhash of the samples icon.

    - name: code_sign
      type: group
      description: >
        Code signing information for the sample.

      fields:
        - name: algorithm
          type: keyword
          description: >
            Algorithm used to generate the public key.

        - name: cscb_listed
          type: boolean
          description: >
            Whether the certificate is present on the Code Signing Certificate Blocklist (CSCB).

        - name: cscb_reason
          type: keyword
          description: >
            Why the certificate is present on the Code Signing Certificate Blocklist (CSCB).

        - name: issuer_cn
          type: keyword
          description: >
            Common name (CN) of issuing certificate authority.

        - name: serial_number
          type: keyword
          description: >
            Unique serial number issued by the certificate authority.

        - name: subject_cn
          type: keyword
          description: >
            Common name (CN) of subject.

        - name: thumbprint
          type: keyword
          description: >
            Hash of certificate.

        - name: thumbprint_algorithm
          type: keyword
          description: >
            Algorithm used to create thumbprint.

        - name: valid_from
          type: date
          description: >
            Time at which the certificate is first considered valid.

        - name: valid_to
          type: keyword
          description: >
            Time at which the certificate is no longer considered valid.

    - name: deleted_at
      type: date
      description: |
        The indicator expiration timestamp.
    - name: file_name
      type: keyword
      description: >
        Name of the malware sample file.
    - name: file_size
      type: long
      description: >
        Size of the file in bytes.
    - name: file_type
      type: keyword
      description: >
        Type of the file.
    - name: file_type_mime
      type: keyword
      description: >
        MIME type of the file.
    - name: gimphash
      type: keyword
      description: >
        GIMP hash of the sample.
    - name: imphash
      type: keyword
      description: >
        Import hash of the PE file.
    - name: ioc_expiration_duration
      type: keyword
      description: |
        The configured expiration duration.
    - name: md5_hash
      type: keyword
      description: >
        MD5 hash of the sample.
    - name: reporter
      type: keyword
      description: >
        Reporter who submitted the sample.
    - name: sha1_hash
      type: keyword
      description: >
        SHA-1 hash of the sample.
    - name: sha256_hash
      type: keyword
      description: >
        SHA-256 hash of the sample.
    - name: signature
      type: keyword
      description: >
        Malware signature name.
    - name: ssdeep
      type: keyword
      description: >
        SSDEEP hash of the sample.
    - name: telfhash
      type: keyword
      description: >
        TLSH hash of the sample.
    - name: tlsh
      type: keyword
      description: >
        TLSH hash of the sample.
    - name: trid_percent
      type: float
      description: >
        TRID file type identification confidence percentage.
