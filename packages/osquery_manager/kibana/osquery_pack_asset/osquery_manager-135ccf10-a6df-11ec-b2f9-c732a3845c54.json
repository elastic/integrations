{
    "attributes": {
        "name": "osx-attacks",
        "version": 1,
        "queries": [
            {
                "id": "WireLurker",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.apple.machook_damon.plist' OR name = 'com.apple.globalupdate.plist' OR name = 'com.apple.appstore.plughelper.plist' OR name = 'com.apple.MailServiceAgentHelper.plist' OR name = 'com.apple.systemkeychain-helper.plist' OR name = 'com.apple.periodic-dd-mm-yy.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Leverage-A_1",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where path like '%UserEvent.System.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Leverage-A_2",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from file where path = '/Users/Shared/UserEvent.app';",
                "version": "1.4.5"
            },
            {
                "id": "Leverage-A_3",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.GetFlashPlayer.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Tibet.D",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where path like '%com.apple.AudioService.plist';",
                "version": "1.4.5"
            },
            {
                "id": "DevilRobber",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.apple.legion.plist' or name = 'com.apple.pixel.plist';",
                "version": "1.4.5"
            },
            {
                "id": "XSLCmd",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.apple.service.clipboardd.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Olyx",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.apple.DockActions.plist' or name like '%www. google.com.tstart.plist%';",
                "version": "1.4.5"
            },
            {
                "id": "Imuler",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'checkflr.plist';",
                "version": "1.4.5"
            },
            {
                "id": "iWorkServ",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from startup_items where path like '%iWorkServices%';",
                "version": "1.4.5"
            },
            {
                "id": "Morcut",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.apple.mdworker.plist';",
                "version": "1.4.5"
            },
            {
                "id": "BlazingKeylogger",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.BT.BPK.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Icefog",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'apple.launchd.plist' or name = 'com.apple.launchport.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Careto",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where path like '%com.apple.launchport.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Inqtana",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.pwned.plist' or name = 'com.openbundle.plist' or name = 'com.adobe.reader.plist';",
                "version": "1.4.5"
            },
            {
                "id": "MacKontrol",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.apple.FolderActionsxl.plist';",
                "version": "1.4.5"
            },
            {
                "id": "PubSab",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.apple.PubSabAgent.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Dockster",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'mac.Dockset.deman.plist';",
                "version": "1.4.5"
            },
            {
                "id": "CallMe",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'realPlayerUpdate.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Whitesmoke",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.whitesmoke.uploader.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Codecm",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.codecm.uploader.plist';",
                "version": "1.4.5"
            },
            {
                "id": "iWorm",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.JavaW.plist';",
                "version": "1.4.5"
            },
            {
                "id": "iWorm_1",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from file where path like '/Library/Application Support/JavaW%';",
                "version": "1.4.5"
            },
            {
                "id": "SniperSpy",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.rxs.syslogagent.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Vsearch",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.vsearch.agent.plist' OR name = 'com.vsearch.daemon.plist' OR name = 'com.vsearch.helper.plist' OR name = 'Jack.plist' OR program_arguments = '/etc/run_upd.sh' OR program_arguments LIKE '/Library/Application Support/%/Agent/agent.app/Contents/MacOS/agent%';",
                "version": "1.4.5"
            },
            {
                "id": "Buca",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.webhelper.plist' or name = 'com.webtools.update.agent.plist' or name = 'com.webtools.uninstaller.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Conduit",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where path like '%com.conduit.loader.agent.plist' or name = 'com.conduit.loader.agent.plist' or path like '%com.perion.searchprotectd.plist' or name = 'com.perion.searchprotectd.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Genieo",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.genieo.completer.download.plist' OR name = 'com.genieo.completer.update.plist' OR name = 'com.genieo.completer.ltvbit.plist' OR name = 'com.installer.completer.download.plist' OR name = 'com.installer.completer.update.plist' OR name = 'com.installer.completer.ltvbit.plist' OR name = 'com.genieoinnovation.macextension.plist' OR name = 'com.genieoinnovation.macextension.client.plist' OR name = 'com.genieo.engine.plist';",
                "version": "1.4.5"
            },
            {
                "id": "GenieoPart2",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where program_arguments like '/Users/%/Library/Application Support/%/%.app/Contents/MacOS/App% -trigger download -isDev % -installVersion % -firstAppId % -identity %';",
                "version": "1.4.5"
            },
            {
                "id": "HackingTeam_Mac_RAT1",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from file where path = '/dev/ptmx0';",
                "version": "1.4.5"
            },
            {
                "id": "HackingTeam_Mac_RAT2",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from apps where bundle_identifier = 'com.ht.RCSMac';",
                "version": "1.4.5"
            },
            {
                "id": "HackingTeam_Mac_RAT3",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where label = 'com.ht.RCSMac' OR name = 'com.apple.loginStoreagent.plist' OR name = 'com.apple.mdworker.plist' OR name = 'com.apple.UIServerLogin.plist';",
                "version": "1.4.5"
            },
            {
                "id": "HackingTeam_Mac_Persistence",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from file where directory like '/Users/%/Library/Preferences/8pHbqThW%';",
                "version": "1.4.5"
            },
            {
                "id": "xprotect_reports",
                "interval": 1200,
                "platform": "darwin",
                "query": "select * from xprotect_reports;",
                "version": "1.4.5"
            },
            {
                "id": "Keranger_1",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from processes where name = 'kernel_service';",
                "version": "1.4.5"
            },
            {
                "id": "Keranger_2",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from file where path LIKE '/Users/%/Library/.kernel_%' OR path LIKE '/Users/%/Library/kernel_service';",
                "version": "1.4.5"
            },
            {
                "id": "PremierOpinion",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'PremierOpinion.plist' or name = 'PremierOpinionAgent.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Bundlore",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name like 'com.WebShoppy.%.plist' or name like 'com.SoftwareUpdater.%.plist' or name like 'cinema-plus%.plist' or name like 'com.WebTools.%.plist' or name like 'com.crossrider.%.plist' or name like 'shopy-mate_%.plist' or name like 'com.WebShopper.%.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Spigot",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name like 'com.spigot.%.plist';",
                "version": "1.4.5"
            },
            {
                "id": "SearchInstUpdater",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name like 'com.updater.mc%.plist' or name like 'com.updater.watch.mc%.plist';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_Pirrit",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from plist where path = '/Library/Preferences/com.common.plist' and key = 'net_pref';",
                "version": "1.4.5"
            },
            {
                "id": "Backdoor_MAC_Eleanor",
                "interval": 3600,
                "platform": "darwin",
                "query": "SELECT * FROM launchd WHERE name IN ('com.getdropbox.dropbox.integritycheck.plist','com.getdropbox.dropbox.timegrabber.plist','com.getdropbox.dropbox.usercontent.plist');",
                "version": "1.4.5"
            },
            {
                "id": "EliteKeylogger",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.apple.fonts.plist' and label = 'unknown';",
                "version": "1.4.5"
            },
            {
                "id": "Aobo_Keylogger",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name like 'com.ab.kl%.plist';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_Keydnap",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name IN ('com.apple.iCloud.sync.daemon', 'com.geticloud.icloud.photo');",
                "version": "1.4.5"
            },
            {
                "id": "Java_Adwind_Trojan",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name like 'org.%.plist' and program_arguments like '/Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/bin/java -Dapple.awt.UIElement=true -jar /Users/%/.%';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_Backdoor_Mokes",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from file where path LIKE '/Users/%/Library/App Store/storeuserd' OR path LIKE '/Users/%/Library/com.apple.spotlight/SpotlightHelper' OR path LIKE '/Users/%/Library/Dock/com.apple.dock.cache' OR path LIKE '/Users/%/Library/Dropbox/DropboxCache' OR path LIKE '/Users/%/Library/Skype/SkypeHelper' OR path LIKE '/Users/%/Library/Google/Chrome/nacld' OR path LIKE '/Users/%/Library/Firefox/Profiles/profiled';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_Komplex",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from file where path = '/Users/Shared/.local/kext' or path = '/Users/Shared/com.apple.updates.plist' or path = '/Users/Shared/start.sh';",
                "version": "1.4.5"
            },
            {
                "id": "OceanLotus_launchagent",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.google.plugins.plist';",
                "version": "1.4.5"
            },
            {
                "id": "OceanLotus_dropped_file_1",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from file, ( select '/Library/Logs/.Logs/corevideosd' ioc union select '/Library/.SystemPreferences/.prev/.ver.txt' ioc union select '/Library/Parallels/.cfg' ioc union select '/Library/Preferences/.fDTYuRs' ioc union select '/Library/Hash/.Hashtag/.hash' ioc union select '/Library/Hash/.hash' ioc ) iocs where file.path LIKE '/Users/%/' || ioc OR file.path = iocs.ioc OR file.path LIKE '/tmp/crunzip.temp.%';",
                "version": "1.4.5"
            },
            {
                "id": "XcodeGhost",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from ( select apps.bundle_short_version as xcode_version, apps.path as xcode_path, file.path, file.type as file_type from apps, file where apps.bundle_name='Xcode' and file.path like (apps.path || '/Contents/Developer/Platforms/%/Developer/SDKs/Library/%%') ) join hash using (path) where file_type = 'regular';",
                "version": "1.4.5"
            },
            {
                "id": "Quimitchin_Backdoor",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.client.client.plist';",
                "version": "1.4.5"
            },
            {
                "id": "Pronto",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'pronto.notification.plist' or name = 'pronto.update.plist';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_DOK_1",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.apple.Safari.proxy.plist' or name = 'com.apple.Safari.proxy.pac';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_DOK_2",
                "interval": 3600,
                "platform": "darwin",
                "query": "select common_name, sha1, subject_key_id from certificates where subject_key_id = 'e637d656f9f088ddca3b3b55c4fe698d8c97a552';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_DOK_3",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from file where path = '/Users/Shared/AppStore.app';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_DOK_4",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from apps where bundle_name = 'Truesteer.AppStore';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_Snake",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from file where path = '/Library/LaunchDaemons/com.adobe.update.plist' OR path = '/Library/Scripts/installd.sh' OR path = '/Library/Scripts/queue' OR path = '/tmp/.gdm-socket' OR path = '/tmp/.gdm-selinux' OR path LIKE '/var/tmp/.ur-%%';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_Proton_Files",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from file where path like '/Users/%/Library/RenderFiles/activity_agent.app/' OR path like '/Users/%/Library/LaunchAgents/fr.handbrake.activity_agent.plist' OR path='/tmp/Updater.app' OR path='/Library/.rand/updateragent.app' OR path='/Library/LaunchAgents/com.apple.xpcd.plist' OR path='/Library/.cachedir' OR path='/Library/.random';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_Proton_Launchd",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name='com.Eltima.UpdaterAgent.plist' OR name='com.apple.xpcd.plist';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_Proton_Process",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from processes where path like '/Users/%/Library/RenderFiles/activity_agent.app/Contents/MacOS/activity_agent' OR path='/Library/.rand/updateragent.app/Contents/MacOS/updateragent' OR path='/Library/.random/xpcd.app/Contents/MacOS/xpcd';",
                "version": "1.4.5"
            },
            {
                "id": "EmPyre_Agent",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.proxy.initialize.plist';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_FruitFly",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.client.client.plist';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_Mughthesec",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.Mughthesec.plist';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_HiddenLotus",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.apple.hidd.shared.plist';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_MaMi_DNS_Servers",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from dns_resolvers where type = 'nameserver' and address in ('82.163.143.135', '82.163.142.137');",
                "version": "2.8.0"
            },
            {
                "id": "OSX_MaMi_Certificate",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from certificates where common_name like '%cloudguard.me%' and not_valid_after = '2352216315';",
                "version": "2.8.0"
            },
            {
                "id": "Behavioral_Reverse_Shell",
                "interval": 3600,
                "platform": "darwin",
                "query": "SELECT DISTINCT(processes.pid), processes.parent, processes.name, processes.path, processes.cmdline, processes.cwd, processes.root, processes.uid, processes.gid, processes.start_time, process_open_sockets.remote_address, process_open_sockets.remote_port, (SELECT cmdline FROM processes AS parent_cmdline WHERE pid=processes.parent) AS parent_cmdline FROM processes JOIN process_open_sockets USING (pid) LEFT OUTER JOIN process_open_files ON processes.pid = process_open_files.pid WHERE (name='sh' OR name='bash') AND process_open_files.pid IS NULL;",
                "version": "2.8.0"
            },
            {
                "id": "OSX_ColdRoot_RAT_Launchd",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from launchd where name = 'com.apple.audio.driver.plist';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_ColdRoot_RAT_Files",
                "interval": 3600,
                "platform": "darwin",
                "query": "select * from file where path in ('/private/var/tmp/com.apple.audio.driver.app/', '/private/var/tmp/com.apple.audio.driver.app/Contents/MacOS/conx.wol');",
                "version": "1.4.5"
            },
            {
                "id": "MacSearch_Adware",
                "interval": 3600,
                "platform": "darwin",
                "query": "SELECT * FROM launchd WHERE path='/Library/LaunchAgents/tapufind.plist';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_Dummy_Launchd",
                "interval": 3600,
                "platform": "darwin",
                "query": "SELECT * FROM launchd WHERE name = 'com.startup.plist';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_Dummy_Files",
                "interval": 3600,
                "platform": "darwin",
                "query": "SELECT * FROM file WHERE path = '/Library/LaunchDaemons/com.startup.plist' OR path = '/var/root/script.sh' OR path = '/Users/Shared/dumpdummy' OR path = '/tmp/script.sh' OR path = '/tmp/com.startup.plist' OR path = '/tmp/dumpdummy';",
                "version": "1.4.5"
            },
            {
                "id": "OSX_SearchAwesome",
                "interval": 3600,
                "platform": "darwin",
                "query": "SELECT * FROM file WHERE path = '/Applications/spi.app' OR path = '/Users/%/Library/LaunchAgents/spid-uninstall.plist' OR path = '/Users/%/Library/LaunchAgents/spid.plist' OR path = '/Users/%/Library/SPI';",
                "version": "1.4.5"
            }
        ]
    },
    "coreMigrationVersion": "8.2.0",
    "id": "osquery_manager-135ccf10-a6df-11ec-b2f9-c732a3845c54",
    "references": [],
    "type": "osquery-pack-asset"
}