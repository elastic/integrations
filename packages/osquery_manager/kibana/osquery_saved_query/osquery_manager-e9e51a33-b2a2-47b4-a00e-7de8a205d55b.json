{
    "attributes": {
        "created_at": "2025-12-03T10:00:00.000Z",
        "created_by": "elastic",
        "description": "UserAssist Registry: Track applications executed via Windows Explorer. Shows execution count and last execution time per user. Useful for forensic investigation of user-initiated program execution. MITRE ATT&CK: T1204 (User Execution).",
        "ecs_mapping": [
            {
                "key": "file.path",
                "value": {
                    "field": "path"
                }
            },
            {
                "key": "file.name",
                "value": {
                    "field": "name"
                }
            },
            {
                "key": "user.id",
                "value": {
                    "field": "sid"
                }
            },
            {
                "key": "user.name",
                "value": {
                    "field": "username"
                }
            },
            {
                "key": "file.hash.md5",
                "value": {
                    "field": "md5"
                }
            },
            {
                "key": "file.hash.sha256",
                "value": {
                    "field": "sha256"
                }
            },
            {
                "key": "event.category",
                "value": {
                    "value": ["process"]
                }
            },
            {
                "key": "event.type",
                "value": {
                    "value": ["info"]
                }
            },
            {
                "key": "tags",
                "value": {
                    "value": ["userassist", "mitre_t1204", "forensics"]
                }
            }
        ],
        "id": "userassist_windows_elastic",
        "interval": "3600",
        "platform": "windows",
        "query": "-- UserAssist: Track applications executed via Windows Explorer\n-- Forensic value: Shows user-initiated program executions with timestamps\nSELECT\n  ua.path AS path,\n  REPLACE(ua.path, RTRIM(ua.path, REPLACE(ua.path, '\\', '')), '') AS name,\n  ua.sid AS sid,\n  u.username AS username,\n  datetime(ua.last_execution_time, 'unixepoch', 'UTC') AS last_execution_utc,\n  ua.last_execution_time,\n  ua.count AS execution_count,\n  h.md5 AS md5,\n  h.sha256 AS sha256\nFROM userassist ua\nLEFT JOIN users u ON ua.sid = u.uuid\nLEFT JOIN hash h ON ua.path = h.path\nWHERE ua.path != ''\n  AND ua.last_execution_time > 0",
        "updated_at": "2025-12-03T10:00:00.000Z",
        "updated_by": "elastic"
    },
    "coreMigrationVersion": "9.2.0",
    "id": "osquery_manager-e9e51a33-b2a2-47b4-a00e-7de8a205d55b",
    "references": [],
    "type": "osquery-saved-query",
    "updated_at": "2025-12-03T10:00:00.000Z",
    "version": "WzEsMV0="
}
