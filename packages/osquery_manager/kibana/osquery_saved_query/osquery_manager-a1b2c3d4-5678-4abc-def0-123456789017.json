{
    "attributes": {
        "created_at": "2025-01-29T12:00:00.000Z",
        "created_by": "elastic",
        "description": "Analyze LNK shortcut files showing recently accessed documents and programs",
        "ecs_mapping": [
            {
                "key": "file.path",
                "value": {
                    "field": "path"
                }
            },
            {
                "key": "file.name",
                "value": {
                    "field": "filename"
                }
            },
            {
                "key": "file.size",
                "value": {
                    "field": "size"
                }
            },
            {
                "key": "file.mtime",
                "value": {
                    "field": "mtime"
                }
            },
            {
                "key": "file.accessed",
                "value": {
                    "field": "atime"
                }
            },
            {
                "key": "file.ctime",
                "value": {
                    "field": "ctime"
                }
            },
            {
                "key": "file.extension",
                "value": {
                    "value": "lnk"
                }
            },
            {
                "key": "event.category",
                "value": {
                    "value": ["file"]
                }
            },
            {
                "key": "event.type",
                "value": {
                    "value": ["info"]
                }
            },
            {
                "key": "event.action",
                "value": {
                    "value": "lnk-file-enumeration"
                }
            },
            {
                "key": "event.dataset",
                "value": {
                    "value": "windows.lnk_files"
                }
            },
            {
                "key": "tags",
                "value": {
                    "value": ["recent_activity", "lnk_files", "user_activity", "forensics"]
                }
            }
        ],
        "id": "lnk_files_recent_activity_elastic",
        "interval": "3600",
        "platform": "windows",
        "query": "SELECT path, filename, size, mtime, atime, ctime FROM file WHERE (path LIKE 'C:\\Users\\%\\Recent\\%.lnk' OR path LIKE 'C:\\Users\\%\\Desktop\\%.lnk' OR path LIKE 'C:\\Users\\%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\%.lnk' OR path LIKE 'C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\%.lnk') AND filename LIKE '%.lnk' ORDER BY mtime DESC LIMIT 200;",
        "updated_at": "2025-01-29T12:00:00.000Z",
        "updated_by": "elastic"
    },
    "coreMigrationVersion": "8.3.0",
    "id": "osquery_manager-a1b2c3d4-5678-4abc-def0-123456789017",
    "references": [],
    "type": "osquery-saved-query",
    "updated_at": "2025-01-29T12:00:00.000Z",
    "version": "WzEsMV0="
}
