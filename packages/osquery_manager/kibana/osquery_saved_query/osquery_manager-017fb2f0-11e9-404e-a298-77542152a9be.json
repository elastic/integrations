{
  "attributes": {
    "created_at": "2025-11-05T09:19:01.000Z",
    "created_by": "elastic",
    "description": "Enumerate recently modified executables with file hashes from suspicious locations for threat intelligence correlation",
    "ecs_mapping": [
      {
        "key": "file.path",
        "value": {
          "field": "path"
        }
      },
      {
        "key": "file.name",
        "value": {
          "field": "filename"
        }
      },
      {
        "key": "file.size",
        "value": {
          "field": "size"
        }
      },
      {
        "key": "file.mtime",
        "value": {
          "field": "mtime"
        }
      },
      {
        "key": "file.hash.md5",
        "value": {
          "field": "md5"
        }
      },
      {
        "key": "file.hash.sha1",
        "value": {
          "field": "sha1"
        }
      },
      {
        "key": "file.hash.sha256",
        "value": {
          "field": "sha256"
        }
      },
      {
        "key": "event.category",
        "value": {
          "value": [
            "file"
          ]
        }
      },
      {
        "key": "event.type",
        "value": {
          "value": [
            "info"
          ]
        }
      },
      {
        "key": "tags",
        "value": {
          "value": [
            "file_analysis",
            "hashing",
            "threat_hunting"
          ]
        }
      }
    ],
    "id": "file_hashes_threat_intel_elastic",
    "interval": "86400",
    "query": "SELECT \n  f.path, \n  f.filename, \n  f.size, \n  f.mtime, \n  h.md5, \n  h.sha1, \n  h.sha256 \nFROM file f \nJOIN hash h ON f.path = h.path \nWHERE (\n    f.path LIKE 'C:\\\\Users\\\\%\\\\AppData\\\\Local\\\\Temp\\\\%.exe' \n    OR f.path LIKE 'C:\\\\Users\\\\%\\\\AppData\\\\Roaming\\\\%.exe' \n    OR f.path LIKE 'C:\\\\Users\\\\%\\\\Downloads\\\\%.exe' \n    OR f.path LIKE 'C:\\\\Users\\\\Public\\\\%.exe' \n    OR f.path LIKE 'C:\\\\ProgramData\\\\%.exe' \n    OR f.path LIKE 'C:\\\\Windows\\\\Temp\\\\%.exe' \n    OR f.path LIKE '/tmp/%.sh' \n    OR f.path LIKE '/var/tmp/%'\n  ) \n  AND f.size > 0 \n  AND f.size < 10485760 \n  AND f.mtime > datetime('now', '-30 days') \nORDER BY f.mtime DESC \nLIMIT 100;",
    "updated_at": "2025-11-05T09:19:01.000Z",
    "updated_by": "elastic"
  },
  "coreMigrationVersion": "9.2.0",
  "id": "osquery_manager-017fb2f0-11e9-404e-a298-77542152a9be",
  "references": [],
  "type": "osquery-saved-query",
  "updated_at": "2025-11-05T09:19:01.000Z",
  "version": "Wzg3LDJd"
}
