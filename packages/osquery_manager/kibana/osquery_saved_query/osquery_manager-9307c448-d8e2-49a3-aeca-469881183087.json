{
    "attributes": {
        "created_at": "2025-11-29T22:36:00.000Z",
        "created_by": "elastic",
        "description": "Windows network interfaces with DHCP/DNS configuration. Combines interface_details and interface_addresses for comprehensive network inventory including DHCP server, lease times, DNS settings. Useful for asset discovery, baseline configuration, detecting rogue DHCP servers, DNS hijacking, and unauthorized network adapters.",
        "ecs_mapping": [
            {
                "key": "event.category",
                "value": {
                    "value": ["network"]
                }
            },
            {
                "key": "event.type",
                "value": {
                    "value": ["info"]
                }
            },
            {
                "key": "event.action",
                "value": {
                    "value": "network-interface-enumeration"
                }
            },
            {
                "key": "event.module",
                "value": {
                    "value": "osquery"
                }
            },
            {
                "key": "event.dataset",
                "value": {
                    "value": "osquery.network_interfaces"
                }
            },
            {
                "key": "host.os.type",
                "value": {
                    "value": "windows"
                }
            },
            {
                "key": "host.domain",
                "value": {
                    "field": "dns_domain"
                }
            },
            {
                "key": "host.name",
                "value": {
                    "field": "dns_host_name"
                }
            },
            {
                "key": "host.network.egress.bytes",
                "value": {
                    "field": "bytes_sent"
                }
            },
            {
                "key": "host.network.egress.packets",
                "value": {
                    "field": "packets_sent"
                }
            },
            {
                "key": "host.network.ingress.bytes",
                "value": {
                    "field": "bytes_received"
                }
            },
            {
                "key": "host.network.ingress.packets",
                "value": {
                    "field": "packets_received"
                }
            },
            {
                "key": "observer.ingress.interface.alias",
                "value": {
                    "field": "friendly_name"
                }
            },
            {
                "key": "observer.ingress.interface.name",
                "value": {
                    "field": "interface_name"
                }
            },
            {
                "key": "observer.ip",
                "value": {
                    "field": "ip_address"
                }
            },
            {
                "key": "observer.mac",
                "value": {
                    "field": "mac_address"
                }
            },
            {
                "key": "tags",
                "value": {
                    "value": ["osquery", "network_discovery", "asset_inventory", "windows"]
                }
            }
        ],
        "id": "network_interfaces_windows_elastic",
        "interval": "3600",
        "platform": "windows",
        "query": "-- Windows network interface inventory with DHCP/DNS configuration\n-- Source: interface_details + interface_addresses\n-- Use case: Asset discovery, rogue DHCP detection, DNS hijacking, unauthorized adapters\nWITH interface_info AS (\n    SELECT\n        id.interface AS interface_name,\n        id.friendly_name,\n        id.description,\n        id.mac AS mac_address,\n        id.mtu,\n        id.link_speed,\n        id.flags,\n        id.last_change,\n        id.ibytes AS bytes_received,\n        id.obytes AS bytes_sent,\n        id.ipackets AS packets_received,\n        id.opackets AS packets_sent,\n        id.enabled,\n        id.dhcp_enabled,\n        id.dhcp_server,\n        id.dhcp_lease_obtained,\n        id.dhcp_lease_expires,\n        id.dns_server_search_order,\n        id.dns_domain,\n        id.dns_host_name,\n        id.connection_status\n    FROM interface_details id\n)\nSELECT\n    i.interface_name,\n    i.friendly_name,\n    i.description,\n    i.mac_address,\n    ia.address AS ip_address,\n    ia.mask AS netmask,\n    ia.broadcast AS broadcast_address,\n    ia.type AS address_type,\n    i.mtu,\n    i.link_speed,\n    i.flags,\n    i.last_change,\n    i.bytes_received,\n    i.bytes_sent,\n    i.packets_received,\n    i.packets_sent,\n    i.enabled,\n    i.dhcp_enabled,\n    i.dhcp_server,\n    i.dhcp_lease_obtained,\n    i.dhcp_lease_expires,\n    i.dns_server_search_order,\n    i.dns_domain,\n    i.dns_host_name,\n    i.connection_status\nFROM interface_info i\nLEFT JOIN interface_addresses ia ON i.interface_name = ia.interface\nORDER BY i.interface_name, ia.address",
        "updated_at": "2025-11-30T10:15:00.000Z",
        "updated_by": "elastic"
    },
    "coreMigrationVersion": "9.2.0",
    "id": "osquery_manager-9307c448-d8e2-49a3-aeca-469881183087",
    "references": [],
    "type": "osquery-saved-query",
    "updated_at": "2025-11-30T10:15:00.000Z",
    "version": "WzEsMV0="
}
