{
    "attributes": {
        "created_at": "2025-01-29T12:00:00.000Z",
        "created_by": "elastic",
        "description": "Detect suspicious running processes including fileless malware (not on disk), processes from temp folders, and encoded PowerShell commands",
        "ecs_mapping": [
            {
                "key": "process.pid",
                "value": {
                    "field": "pid"
                }
            },
            {
                "key": "process.name",
                "value": {
                    "field": "name"
                }
            },
            {
                "key": "process.executable",
                "value": {
                    "field": "path"
                }
            },
            {
                "key": "process.command_line",
                "value": {
                    "field": "cmdline"
                }
            },
            {
                "key": "process.start",
                "value": {
                    "field": "start_time"
                }
            },
            {
                "key": "process.parent.pid",
                "value": {
                    "field": "parent"
                }
            },
            {
                "key": "event.category",
                "value": {
                    "value": ["process"]
                }
            },
            {
                "key": "event.type",
                "value": {
                    "value": ["info"]
                }
            },
            {
                "key": "tags",
                "value": {
                    "value": ["process_activity", "suspicious_process"]
                }
            }
        ],
        "id": "suspicious_processes_elastic",
        "interval": "3600",
        "query": "SELECT \n  pid, \n  name, \n  path, \n  cmdline, \n  start_time, \n  parent, \n  uid, \n  on_disk \nFROM processes \nWHERE (\n    (path NOT LIKE 'C:\\\\Windows\\\\System32\\\\%' \n     OR cmdline LIKE '%powershell%' \n     OR cmdline LIKE '%-enc%' \n     OR cmdline LIKE '%http%' \n     OR on_disk = 0) \n    OR path LIKE '%\\\\Temp\\\\%' \n    OR path LIKE '%\\\\Users\\\\%\\\\AppData\\\\%' \n    OR path LIKE '%\\\\Users\\\\Public\\\\%'\n  ) \nORDER BY start_time DESC \nLIMIT 200;",
        "updated_at": "2025-01-29T12:00:00.000Z",
        "updated_by": "elastic"
    },
    "coreMigrationVersion": "8.3.0",
    "id": "osquery_manager-a1b2c3d4-5678-4abc-def0-123456789006",
    "references": [],
    "type": "osquery-saved-query",
    "updated_at": "2025-01-29T12:00:00.000Z",
    "version": "WzEsMV0="
}
