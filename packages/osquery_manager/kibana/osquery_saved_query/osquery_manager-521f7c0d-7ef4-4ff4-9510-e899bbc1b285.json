{
  "attributes": {
    "created_at": "2025-12-01T12:00:00.000Z",
    "created_by": "elastic",
    "description": "Tracks filesystem changes via inotify including file creation, modification, deletion with cryptographic hashes (md5, sha256). Provides forensic evidence of file system activity with hash verification for IOC matching. REQUIRED CONFIG: Add to Kibana osquery integration: {\"options\":{\"disable_events\":\"false\",\"enable_file_events\":\"true\"},\"file_paths\":{\"etc\":[\"/etc/%%\"],\"homes\":[\"/home/%%\"],\"tmp\":[\"/tmp/%%\"]},\"exclude_paths\":{\"proc\":[\"/proc/%\"],\"sys\":[\"/sys/%\"]}}.",
    "ecs_mapping": [
      {
        "key": "event.category",
        "value": {
          "value": ["file"]
        }
      },
      {
        "key": "event.type",
        "value": {
          "field": "event_type"
        }
      },
      {
        "key": "event.kind",
        "value": {
          "value": "event"
        }
      },
      {
        "key": "event.action",
        "value": {
          "value": "osquery.file_events"
        }
      },
      {
        "key": "event.created",
        "value": {
          "field": "event_time"
        }
      },
      {
        "key": "file.path",
        "value": {
          "field": "target_path"
        }
      },
      {
        "key": "file.hash.md5",
        "value": {
          "field": "md5"
        }
      },
      {
        "key": "file.hash.sha1",
        "value": {
          "field": "sha1"
        }
      },
      {
        "key": "file.hash.sha256",
        "value": {
          "field": "sha256"
        }
      },
      {
        "key": "file.inode",
        "value": {
          "field": "inode"
        }
      },
      {
        "key": "tags",
        "value": {
          "value": ["osquery", "file_events", "inotify", "filesystem_forensics", "linux"]
        }
      }
    ],
    "id": "file_system_events_linux_elastic",
    "interval": "3600",
    "platform": "linux",
    "query": "-- File System Events (Linux) via inotify\n-- Tracks filesystem changes including file creation, modification, deletion with hashes\n-- REQUIRED: Enable in Kibana osquery integration config:\n-- {\"options\":{\"disable_events\":\"false\",\"enable_file_events\":\"true\"},\"file_paths\":{\"etc\":[\"/etc/%%\"],\"homes\":[\"/home/%%\"],\"tmp\":[\"/tmp/%%\"]},\"exclude_paths\":{\"proc\":[\"/proc/%\"],\"sys\":[\"/sys/%\"]}}\nSELECT\n  action,\n  CASE\n    WHEN action = 'CREATED' THEN 'creation'\n    WHEN action = 'DELETED' THEN 'deletion'\n    ELSE 'change'\n  END AS event_type,\n  category,\n  target_path,\n  md5,\n  sha1,\n  sha256,\n  concat('https://www.virustotal.com/gui/file/', sha256) AS vt_link,\n  inode,\n  datetime(time, 'unixepoch') AS event_time,\n  transaction_id\nFROM file_events\nWHERE action IS NOT NULL\n  -- Exclude noisy system paths\n  AND target_path NOT LIKE '/proc/%'\n  AND target_path NOT LIKE '/sys/%'\n  AND target_path NOT LIKE '/run/%'\n  AND target_path NOT LIKE '%.swp'\n  AND target_path NOT LIKE '%.swx'",
    "updated_at": "2025-12-01T12:00:00.000Z",
    "updated_by": "elastic"
  },
  "coreMigrationVersion": "9.3.0",
  "id": "osquery_manager-521f7c0d-7ef4-4ff4-9510-e899bbc1b285",
  "references": [],
  "type": "osquery-saved-query",
  "updated_at": "2025-12-01T12:00:00.000Z",
  "version": "WzEsMV0="
}
