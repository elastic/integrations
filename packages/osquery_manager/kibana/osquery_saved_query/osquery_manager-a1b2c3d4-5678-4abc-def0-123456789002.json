{
    "attributes": {
        "created_at": "2025-01-29T12:00:00.000Z",
        "created_by": "elastic",
        "description": "Track application execution via Prefetch files focusing on LOLBins and recently executed programs with low run counts",
        "ecs_mapping": [
            {
                "key": "process.name",
                "value": {
                    "field": "executable_name"
                }
            },
            {
                "key": "event.start",
                "value": {
                    "field": "last_run_time"
                }
            },
            {
                "key": "file.name",
                "value": {
                    "field": "filename"
                }
            },
            {
                "key": "event.category",
                "value": {
                    "value": ["process"]
                }
            },
            {
                "key": "event.type",
                "value": {
                    "value": ["start", "info"]
                }
            },
            {
                "key": "event.action",
                "value": {
                    "value": "process-execution"
                }
            },
            {
                "key": "tags",
                "value": {
                    "value": ["execution_artifact", "prefetch", "forensics"]
                }
            }
        ],
        "id": "prefetch_execution_elastic",
        "interval": "3600",
        "platform": "windows",
        "query": "SELECT\n  filename AS executable_name,\n  hash AS prefetch_hash,\n  run_count,\n  last_run_time,\n  size,\n  volume_serial,\n  volume_creation,\n  accessed_files_count,\n  accessed_directories_count\nFROM prefetch\nWHERE\n  (filename LIKE '%POWERSHELL%'\n   OR filename LIKE '%CMD.EXE%'\n   OR filename LIKE '%WSCRIPT%'\n   OR filename LIKE '%CSCRIPT%'\n   OR filename LIKE '%RUNDLL32%'\n   OR filename LIKE '%REGSVR32%'\n   OR filename LIKE '%MSHTA%'\n   OR filename LIKE '%CERTUTIL%'\n   OR filename LIKE '%BITSADMIN%'\n   OR (run_count < 5 AND last_run_time > datetime('now', '-7 days')))\n  AND (filename NOT LIKE 'SVCHOST%' OR run_count < 10)\nORDER BY last_run_time DESC\nLIMIT 200;",
        "updated_at": "2025-01-29T12:00:00.000Z",
        "updated_by": "elastic"
    },
    "coreMigrationVersion": "8.3.0",
    "id": "osquery_manager-a1b2c3d4-5678-4abc-def0-123456789002",
    "references": [],
    "type": "osquery-saved-query",
    "updated_at": "2025-01-29T12:00:00.000Z",
    "version": "WzEsMV0="
}
