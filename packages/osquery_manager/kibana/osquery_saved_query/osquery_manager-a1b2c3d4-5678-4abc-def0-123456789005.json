{
    "attributes": {
        "created_at": "2025-01-29T12:00:00.000Z",
        "created_by": "elastic",
        "description": "Track startup items from registry and startup folders, focusing on non-Microsoft entries and suspicious paths",
        "ecs_mapping": [
            {
                "key": "process.name",
                "value": {
                    "field": "name"
                }
            },
            {
                "key": "process.executable",
                "value": {
                    "field": "path"
                }
            },
            {
                "key": "process.args",
                "value": {
                    "field": "args"
                }
            },
            {
                "key": "user.name",
                "value": {
                    "field": "username"
                }
            },
            {
                "key": "event.category",
                "value": {
                    "value": ["process"]
                }
            },
            {
                "key": "event.type",
                "value": {
                    "value": ["info"]
                }
            },
            {
                "key": "tags",
                "value": {
                    "value": ["persistence", "startup", "autorun"]
                }
            }
        ],
        "id": "startup_items_persistence_elastic",
        "interval": "3600",
        "platform": "windows",
        "query": "SELECT \n  name, \n  path, \n  args, \n  type, \n  source, \n  status, \n  username \nFROM startup_items \nWHERE (\n    (path NOT LIKE 'C:\\\\Windows\\\\System32\\\\%' \n     AND path NOT LIKE 'C:\\\\Windows\\\\SysWOW64\\\\%' \n     AND path NOT LIKE 'C:\\\\Program Files\\\\Windows%' \n     AND path NOT LIKE 'C:\\\\Program Files\\\\Microsoft%') \n    OR path LIKE '%\\\\Users\\\\%\\\\AppData\\\\%' \n    OR path LIKE '%\\\\Temp\\\\%' \n    OR path LIKE '%\\\\Users\\\\Public\\\\%' \n    OR path LIKE '%\\\\ProgramData\\\\%' \n    OR path LIKE '%powershell%' \n    OR path LIKE '%cmd.exe%' \n    OR path LIKE '%wscript%' \n    OR path LIKE '%cscript%'\n  ) \nORDER BY source, name \nLIMIT 100;",
        "updated_at": "2025-01-29T12:00:00.000Z",
        "updated_by": "elastic"
    },
    "coreMigrationVersion": "8.3.0",
    "id": "osquery_manager-a1b2c3d4-5678-4abc-def0-123456789005",
    "references": [],
    "type": "osquery-saved-query",
    "updated_at": "2025-01-29T12:00:00.000Z",
    "version": "WzEsMV0="
}
