{
    "attributes": {
        "created_at": "2025-11-07T00:00:00.000Z",
        "created_by": "elastic",
        "description": "Retrieves enriched ARP cache entries with local interface details including local IP addresses and MAC addresses. Combines ARP cache data with network interface configuration to provide complete neighbor relationship context. This enriched view helps investigate network communications, detect ARP spoofing, and understand both source and destination network endpoints. Equivalent to Windows.Network.ArpCache artifact functionality.",
        "ecs_mapping": [
            {
                "key": "destination.ip",
                "value": {
                    "field": "RemoteAddress"
                }
            },
            {
                "key": "destination.mac",
                "value": {
                    "field": "RemoteMACAddress"
                }
            },
            {
                "key": "host.ip",
                "value": {
                    "field": "LocalAddress"
                }
            },
            {
                "key": "host.mac",
                "value": {
                    "field": "LocalMAC"
                }
            },
            {
                "key": "network.name",
                "value": {
                    "field": "InterfaceName"
                }
            },
            {
                "key": "network.type",
                "value": {
                    "field": "AddressFamily"
                }
            },
            {
                "key": "tags",
                "value": {
                    "field": "Store"
                }
            }
        ],
        "id": "arp_cache_elastic",
        "interval": "3600",
        "query": "-- ARP Cache with Local Interface Information\n-- Provides complete network neighbor context by joining ARP cache with interface details\n-- Source: arp_cache + interface_details + interface_addresses tables\n-- Equivalent to Windows.Network.ArpCache artifact\n\nWITH arp_entries AS (\n    SELECT \n        a.address AS RemoteAddress,\n        a.mac AS RemoteMACAddress,\n        a.interface AS InterfaceName,\n        CASE \n            WHEN a.permanent = '1' THEN 'Persistent'\n            ELSE 'Active'\n        END AS Store,\n        CASE\n            WHEN a.address LIKE '%:%' THEN 'ipv6'\n            ELSE 'ipv4'\n        END AS AddressFamily\n    FROM arp_cache a\n),\nlocal_interfaces AS (\n    SELECT \n        id.interface,\n        id.mac AS LocalMAC,\n        ia.address AS LocalAddress\n    FROM interface_details id\n    LEFT JOIN interface_addresses ia ON id.interface = ia.interface\n    WHERE id.mac IS NOT NULL\n        AND ia.address IS NOT NULL\n)\nSELECT \n    ae.RemoteAddress,\n    ae.RemoteMACAddress,\n    ae.InterfaceName,\n    ae.Store,\n    ae.AddressFamily,\n    li.LocalAddress,\n    li.LocalMAC\nFROM arp_entries ae\nLEFT JOIN local_interfaces li ON ae.InterfaceName = li.interface\nORDER BY ae.InterfaceName, ae.RemoteAddress;",        "platform": "linux,darwin,windows",
        "updated_at": "2025-11-07T00:00:00.000Z",
        "updated_by": "elastic"
    },
    "coreMigrationVersion": "8.3.2",
    "id": "osquery_manager-b2c3d4e5-f6a7-11ef-89c6-331eb0db6d02",
    "references": [],
    "type": "osquery-saved-query",
    "updated_at": "2025-11-07T00:00:00.000Z",
    "version": "WzEsNV0="
}
