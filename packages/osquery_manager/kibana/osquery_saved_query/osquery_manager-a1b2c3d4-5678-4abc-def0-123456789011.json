{
    "attributes": {
        "created_at": "2025-01-29T12:00:00.000Z",
        "created_by": "elastic",
        "description": "Track shell command history on Linux and macOS systems focusing on suspicious commands like wget, curl, base64 encoding, and privilege escalation attempts",
        "ecs_mapping": [
            {
                "key": "user.name",
                "value": {
                    "field": "username"
                }
            },
            {
                "key": "@timestamp",
                "value": {
                    "field": "time"
                }
            },
            {
                "key": "process.command_line",
                "value": {
                    "field": "command"
                }
            },
            {
                "key": "file.path",
                "value": {
                    "field": "history_file"
                }
            },
            {
                "key": "process.name",
                "value": {
                    "value": "bash"
                }
            },
            {
                "key": "event.category",
                "value": {
                    "value": ["process"]
                }
            },
            {
                "key": "event.type",
                "value": {
                    "value": ["info"]
                }
            },
            {
                "key": "tags",
                "value": {
                    "value": ["shell_history", "command_history", "user_activity"]
                }
            }
        ],
        "id": "shell_history_suspicious_elastic",
        "interval": "3600",
        "platform": "linux",
        "query": "SELECT username, time, command, history_file FROM shell_history WHERE (command LIKE '%wget%' OR command LIKE '%curl%' OR command LIKE '%chmod%+x%' OR command LIKE '%/tmp/%' OR command LIKE '%/dev/shm/%' OR command LIKE '%base64%' OR command LIKE '%python%' OR command LIKE '%perl%' OR command LIKE '%ssh%' OR command LIKE '%scp%' OR command LIKE '%nc %' OR command LIKE '%netcat%' OR command LIKE '%sudo%' OR command LIKE '%passwd%' OR command LIKE '%useradd%' OR command LIKE '%crontab%' OR command LIKE '%systemctl%' OR command LIKE '%rm -rf%') AND command NOT LIKE 'ls%' AND command NOT LIKE 'cd %' AND command NOT LIKE 'pwd%' ORDER BY time DESC LIMIT 200;",
        "updated_at": "2025-01-29T12:00:00.000Z",
        "updated_by": "elastic"
    },
    "coreMigrationVersion": "8.3.0",
    "id": "osquery_manager-a1b2c3d4-5678-4abc-def0-123456789011",
    "references": [],
    "type": "osquery-saved-query",
    "updated_at": "2025-01-29T12:00:00.000Z",
    "version": "WzEsMV0="
}
