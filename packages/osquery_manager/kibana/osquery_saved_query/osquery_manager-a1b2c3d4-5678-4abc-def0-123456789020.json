{
    "attributes": {
        "created_at": "2025-01-29T12:00:00.000Z",
        "created_by": "elastic",
        "description": "Enumerate mounted storage devices focusing on removable media and unusual volumes (Linux/macOS: uses mounts table, Windows: use separate logical_drives query)",
        "ecs_mapping": [
            {
                "key": "host.disk.name",
                "value": {
                    "field": "device"
                }
            },
            {
                "key": "host.disk.type",
                "value": {
                    "field": "type"
                }
            },
            {
                "key": "host.disk.size",
                "value": {
                    "field": "total_size"
                }
            },
            {
                "key": "host.disk.free",
                "value": {
                    "field": "free_space"
                }
            },
            {
                "key": "file.path",
                "value": {
                    "field": "path"
                }
            },
            {
                "key": "file.device",
                "value": {
                    "field": "device"
                }
            },
            {
                "key": "event.category",
                "value": {
                    "value": ["host"]
                }
            },
            {
                "key": "event.type",
                "value": {
                    "value": ["info"]
                }
            },
            {
                "key": "event.action",
                "value": {
                    "value": "disk-enumeration"
                }
            },
            {
                "key": "event.dataset",
                "value": {
                    "value": "host.disk_info"
                }
            },
            {
                "key": "tags",
                "value": {
                    "value": ["removable_media", "disk_info", "storage", "host_info", "linux", "macos"]
                }
            }
        ],
        "id": "disk_drives_removable_elastic",
        "interval": "3600",
        "platform": "linux,darwin",
        "query": "SELECT device, device_alias, path, type, (blocks * blocks_size) AS total_size, (blocks_free * blocks_size) AS free_space, (blocks_available * blocks_size) AS available_space, flags FROM mounts WHERE (blocks * blocks_size) > 0 AND (path LIKE '/media/%' OR path LIKE '/mnt/%' OR path LIKE '/run/media/%' OR path LIKE '/Volumes/%' OR type IN ('vfat', 'exfat', 'ntfs', 'msdos', 'fuseblk', 'fuse', 'iso9660', 'udf')) AND path NOT IN ('/', '/boot', '/home', '/proc', '/sys', '/dev', '/run', '/tmp', '/var', '/usr') ORDER BY path;",
        "updated_at": "2025-01-29T12:00:00.000Z",
        "updated_by": "elastic"
    },
    "coreMigrationVersion": "8.3.0",
    "id": "osquery_manager-a1b2c3d4-5678-4abc-def0-123456789020",
    "references": [],
    "type": "osquery-saved-query",
    "updated_at": "2025-01-29T12:00:00.000Z",
    "version": "WzEsMV0="
}
