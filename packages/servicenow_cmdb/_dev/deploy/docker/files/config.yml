rules:
  - path: /api/now/table/incident
    methods: [GET]
    query_params:
      sysparm_display_value: all
      sysparm_exclude_reference_link: true
      sysparm_limit: 1
      sysparm_offset: 1
      sysparm_query: "{sysparm_query:.*}"
    request_headers:
      Authorization:
        - "Basic eHh4eDp4eHh4"
    responses:
      - status_code: 200
        headers:
          Link:
          - '<http://{{ hostname }}:{{ env "PORT" }}/api/now/table/incident?sysparm_query=TEST&sysparm_display_value=all&sysparm_exclude_reference_link=true&sysparm_limit=1&sysparm_offset=0>;rel="first",<http://{{ hostname }}:{{ env "PORT" }}/api/now/table/incident?sysparm_query=TEST&sysparm_display_value=all&sysparm_exclude_reference_link=true&sysparm_limit=1&sysparm_offset=0>;rel="prev",<http://{{ hostname }}:{{ env "PORT" }}/api/now/table/incident?sysparm_query=TEST&sysparm_display_value=all&sysparm_exclude_reference_link=true&sysparm_limit=1&sysparm_offset=1>;rel="last"'
        body: |-
          {{ minify_json `
          {
            "result": [
              {
                "parent": {
                  "display_value": "",
                  "value": ""
                },
                "made_sla": {
                  "display_value": "true",
                  "value": "true"
                },
                "caused_by": {
                  "display_value": "",
                  "value": ""
                },
                "watch_list": {
                  "display_value": "",
                  "value": ""
                },
                "upon_reject": {
                  "display_value": "Cancel all future Tasks",
                  "value": "cancel"
                },
                "sys_updated_on": {
                  "display_value": "2024-06-18 04:09:45",
                  "value": "2024-06-18 11:09:45"
                },
                "child_incidents": {
                  "display_value": "1",
                  "value": "1"
                },
                "hold_reason": {
                  "display_value": "",
                  "value": ""
                },
                "origin_table": {
                  "display_value": "",
                  "value": ""
                },
                "task_effective_number": {
                  "display_value": "INC0009002",
                  "value": "INC0009002"
                },
                "approval_history": {
                  "display_value": "",
                  "value": ""
                },
                "number": {
                  "display_value": "INC0009002",
                  "value": "INC0009002"
                },
                "resolved_by": {
                  "display_value": "System Administrator",
                  "value": "6816f79cc0a8016401c5a33be04be441"
                },
                "sys_updated_by": {
                  "display_value": "system",
                  "value": "system"
                },
                "opened_by": {
                  "display_value": "System Administrator",
                  "value": "6816f79cc0a8016401c5a33be04be441"
                },
                "user_input": {
                  "display_value": "",
                  "value": ""
                },
                "sys_created_on": {
                  "display_value": "2018-09-16 05:50:05",
                  "value": "2018-09-16 12:50:05"
                },
                "sys_domain": {
                  "display_value": "global",
                  "value": "global"
                },
                "state": {
                  "display_value": "Closed",
                  "value": "7"
                },
                "route_reason": {
                  "display_value": "",
                  "value": ""
                },
                "sys_created_by": {
                  "display_value": "admin",
                  "value": "admin"
                },
                "knowledge": {
                  "display_value": "false",
                  "value": "false"
                },
                "order": {
                  "display_value": "",
                  "value": ""
                },
                "calendar_stc": {
                  "display_value": "114",
                  "value": "114"
                },
                "closed_at": {
                  "display_value": "2018-12-09 19:29:08",
                  "value": "2018-12-10 03:29:08"
                },
                "cmdb_ci": {
                  "display_value": "",
                  "value": ""
                },
                "delivery_plan": {
                  "display_value": "",
                  "value": ""
                },
                "contract": {
                  "display_value": "",
                  "value": ""
                },
                "impact": {
                  "display_value": "2 - Medium",
                  "value": "2"
                },
                "active": {
                  "display_value": "false",
                  "value": "false"
                },
                "work_notes_list": {
                  "display_value": "",
                  "value": ""
                },
                "business_service": {
                  "display_value": "",
                  "value": ""
                },
                "business_impact": {
                  "display_value": "",
                  "value": ""
                },
                "priority": {
                  "display_value": "3 - Moderate",
                  "value": "3"
                },
                "sys_domain_path": {
                  "display_value": "/",
                  "value": "/"
                },
                "rfc": {
                  "display_value": "",
                  "value": ""
                },
                "time_worked": {
                  "display_value": "",
                  "value": ""
                },
                "expected_start": {
                  "display_value": "",
                  "value": ""
                },
                "opened_at": {
                  "display_value": "2018-09-16 05:49:23",
                  "value": "2018-09-16 12:49:23"
                },
                "business_duration": {
                  "display_value": "0 Seconds",
                  "value": "1970-01-01 00:00:00"
                },
                "group_list": {
                  "display_value": "",
                  "value": ""
                },
                "work_end": {
                  "display_value": "",
                  "value": ""
                },
                "caller_id": {
                  "display_value": "David Miller",
                  "value": "77ad8176731313005754660c4cf6a7de"
                },
                "reopened_time": {
                  "display_value": "",
                  "value": ""
                },
                "resolved_at": {
                  "display_value": "2018-09-16 05:51:17",
                  "value": "2018-09-16 12:51:17"
                },
                "approval_set": {
                  "display_value": "",
                  "value": ""
                },
                "subcategory": {
                  "display_value": null,
                  "value": ""
                },
                "work_notes": {
                  "display_value": "",
                  "value": ""
                },
                "universal_request": {
                  "display_value": "",
                  "value": ""
                },
                "short_description": {
                  "display_value": "My computer is not detecting the headphone device",
                  "value": "My computer is not detecting the headphone device"
                },
                "close_code": {
                  "display_value": "Solved (Permanently)",
                  "value": "Solved (Permanently)"
                },
                "correlation_display": {
                  "display_value": "",
                  "value": ""
                },
                "delivery_task": {
                  "display_value": "",
                  "value": ""
                },
                "work_start": {
                  "display_value": "",
                  "value": ""
                },
                "assignment_group": {
                  "display_value": "",
                  "value": ""
                },
                "additional_assignee_list": {
                  "display_value": "",
                  "value": ""
                },
                "business_stc": {
                  "display_value": "0",
                  "value": "0"
                },
                "cause": {
                  "display_value": "",
                  "value": ""
                },
                "description": {
                  "display_value": "My computer is not detecting the headphone device. It could be an issue with the USB port.",
                  "value": "My computer is not detecting the headphone device. It could be an issue with the USB port."
                },
                "origin_id": {
                  "display_value": "",
                  "value": ""
                },
                "calendar_duration": {
                  "display_value": "1 Minute",
                  "value": "1970-01-01 00:01:54"
                },
                "close_notes": {
                  "display_value": "This is not an issue with the USB port. Replaced the headset to resolve the issue.",
                  "value": "This is not an issue with the USB port. Replaced the headset to resolve the issue."
                },
                "notify": {
                  "display_value": "Do Not Notify",
                  "value": "1"
                },
                "service_offering": {
                  "display_value": "",
                  "value": ""
                },
                "sys_class_name": {
                  "display_value": "Incident",
                  "value": "incident"
                },
                "closed_by": {
                  "display_value": "System Administrator",
                  "value": "6816f79cc0a8016401c5a33be04be441"
                },
                "follow_up": {
                  "display_value": "",
                  "value": ""
                },
                "parent_incident": {
                  "display_value": "",
                  "value": ""
                },
                "sys_id": {
                  "display_value": "1c832706732023002728660c4cf6a7b9",
                  "value": "1c832706732023002728660c4cf6a7b9"
                },
                "contact_type": {
                  "display_value": null,
                  "value": ""
                },
                "reopened_by": {
                  "display_value": "",
                  "value": ""
                },
                "incident_state": {
                  "display_value": "Closed",
                  "value": "7"
                },
                "urgency": {
                  "display_value": "2 - Medium",
                  "value": "2"
                },
                "problem_id": {
                  "display_value": "",
                  "value": ""
                },
                "company": {
                  "display_value": "",
                  "value": ""
                },
                "reassignment_count": {
                  "display_value": "0",
                  "value": "0"
                },
                "activity_due": {
                  "display_value": "UNKNOWN",
                  "value": ""
                },
                "assigned_to": {
                  "display_value": "",
                  "value": ""
                },
                "severity": {
                  "display_value": "3 - Low",
                  "value": "3"
                },
                "comments": {
                  "display_value": "",
                  "value": ""
                },
                "approval": {
                  "display_value": "Not Yet Requested",
                  "value": "not requested"
                },
                "sla_due": {
                  "display_value": "UNKNOWN",
                  "value": ""
                },
                "comments_and_work_notes": {
                  "display_value": "",
                  "value": ""
                },
                "due_date": {
                  "display_value": "",
                  "value": ""
                },
                "sys_mod_count": {
                  "display_value": "9",
                  "value": "9"
                },
                "reopen_count": {
                  "display_value": "0",
                  "value": "0"
                },
                "sys_tags": {
                  "display_value": "",
                  "value": ""
                },
                "escalation": {
                  "display_value": "Normal",
                  "value": "0"
                },
                "upon_approval": {
                  "display_value": "Proceed to Next Task",
                  "value": "proceed"
                },
                "correlation_id": {
                  "display_value": "",
                  "value": ""
                },
                "location": {
                  "display_value": "",
                  "value": ""
                },
                "category": {
                  "display_value": "Hardware",
                  "value": "Hardware"
                }
              }
            ]
          }
          `}}
  - path: /api/now/table/incident
    methods: [GET]
    query_params:
      sysparm_display_value: all
      sysparm_exclude_reference_link: true
      sysparm_limit: 1
      sysparm_query: "{sysparm_query:.*}"
    request_headers:
      Authorization:
        - "Basic eHh4eDp4eHh4"
    responses:
      - status_code: 200
        headers:
          Link:
          - '<http://{{ hostname }}:{{ env "PORT" }}/api/now/table/incident?sysparm_query=TEST&sysparm_display_value=all&sysparm_exclude_reference_link=true&sysparm_limit=1&sysparm_offset=0>;rel="first",<http://{{ hostname }}:{{ env "PORT" }}/api/now/table/incident?sysparm_query=TEST&sysparm_display_value=all&sysparm_exclude_reference_link=true&sysparm_limit=1&sysparm_offset=-1>;rel="prev",<http://{{ hostname }}:{{ env "PORT" }}/api/now/table/incident?sysparm_query=TEST&sysparm_display_value=all&sysparm_exclude_reference_link=true&sysparm_limit=1&sysparm_offset=1>;rel="next",<http://{{ hostname }}:{{ env "PORT" }}/api/now/table/incident?sysparm_query=TEST&sysparm_display_value=all&sysparm_exclude_reference_link=true&sysparm_limit=1&sysparm_offset=1>;rel="last"'
        body: |-
          {{ minify_json `
          {
            "result": [
              {
                "parent": {
                  "display_value": "",
                  "value": ""
                },
                "made_sla": {
                  "display_value": "true",
                  "value": "true"
                },
                "caused_by": {
                  "display_value": "",
                  "value": ""
                },
                "watch_list": {
                  "display_value": "",
                  "value": ""
                },
                "upon_reject": {
                  "display_value": null,
                  "value": ""
                },
                "sys_updated_on": {
                  "display_value": "2024-09-23 22:39:40",
                  "value": "2024-09-24 05:39:40"
                },
                "child_incidents": {
                  "display_value": "0",
                  "value": "0"
                },
                "hold_reason": {
                  "display_value": "",
                  "value": ""
                },
                "origin_table": {
                  "display_value": "",
                  "value": ""
                },
                "task_effective_number": {
                  "display_value": "INC0000060",
                  "value": "INC0000060"
                },
                "approval_history": {
                  "display_value": "",
                  "value": ""
                },
                "number": {
                  "display_value": "INC0000060",
                  "value": "INC0000060"
                },
                "resolved_by": {
                  "display_value": "David Loo",
                  "value": "5137153cc611227c000bbd1bd8cd2007"
                },
                "sys_updated_by": {
                  "display_value": "admin",
                  "value": "admin"
                },
                "opened_by": {
                  "display_value": "Joe Employee",
                  "value": "681ccaf9c0a8016400b98a06818d57c7"
                },
                "user_input": {
                  "display_value": "",
                  "value": ""
                },
                "sys_created_on": {
                  "display_value": "2016-12-12 07:19:57",
                  "value": "2016-12-12 15:19:57"
                },
                "sys_domain": {
                  "display_value": "global",
                  "value": "global"
                },
                "state": {
                  "display_value": "Closed",
                  "value": "7"
                },
                "route_reason": {
                  "display_value": "",
                  "value": ""
                },
                "sys_created_by": {
                  "display_value": "employee",
                  "value": "employee"
                },
                "knowledge": {
                  "display_value": "false",
                  "value": "false"
                },
                "order": {
                  "display_value": "",
                  "value": ""
                },
                "calendar_stc": {
                  "display_value": "102,197",
                  "value": "102197"
                },
                "closed_at": {
                  "display_value": "2016-12-13 18:46:44",
                  "value": "2016-12-14 02:46:44"
                },
                "cmdb_ci": {
                  "display_value": "Storage Area Network 001",
                  "value": "109562a3c611227500a7b7ff98cc0dc7"
                },
                "delivery_plan": {
                  "display_value": "",
                  "value": ""
                },
                "contract": {
                  "display_value": "",
                  "value": ""
                },
                "impact": {
                  "display_value": "2 - Medium",
                  "value": "2"
                },
                "active": {
                  "display_value": "false",
                  "value": "false"
                },
                "work_notes_list": {
                  "display_value": "",
                  "value": ""
                },
                "business_service": {
                  "display_value": "Email",
                  "value": "27d32778c0a8000b00db970eeaa60f16"
                },
                "business_impact": {
                  "display_value": "",
                  "value": ""
                },
                "priority": {
                  "display_value": "3 - Moderate",
                  "value": "3"
                },
                "sys_domain_path": {
                  "display_value": "/",
                  "value": "/"
                },
                "rfc": {
                  "display_value": "",
                  "value": ""
                },
                "time_worked": {
                  "display_value": "",
                  "value": ""
                },
                "expected_start": {
                  "display_value": "",
                  "value": ""
                },
                "opened_at": {
                  "display_value": "2016-12-12 07:19:57",
                  "value": "2016-12-12 15:19:57"
                },
                "business_duration": {
                  "display_value": "8 Hours",
                  "value": "1970-01-01 08:00:00"
                },
                "group_list": {
                  "display_value": "",
                  "value": ""
                },
                "work_end": {
                  "display_value": "",
                  "value": ""
                },
                "caller_id": {
                  "display_value": "Joe Employee",
                  "value": "681ccaf9c0a8016400b98a06818d57c7"
                },
                "reopened_time": {
                  "display_value": "",
                  "value": ""
                },
                "resolved_at": {
                  "display_value": "2016-12-13 13:43:14",
                  "value": "2016-12-13 21:43:14"
                },
                "approval_set": {
                  "display_value": "",
                  "value": ""
                },
                "subcategory": {
                  "display_value": "Email",
                  "value": "email"
                },
                "work_notes": {
                  "display_value": "2016-12-12 16:56:57 - Beth Anglin (Work notes)\nUpdating priority as workaround for incident has been provided.\n\n2016-12-12 09:57:00 - Beth Anglin (Work notes)\nIncreasing priority as this incident is affecting more number of users\n\n2016-12-12 09:01:24 - Beth Anglin (Work notes)\nUpdating incident with correct Configuration item\n\n",
                  "value": ""
                },
                "universal_request": {
                  "display_value": "",
                  "value": ""
                },
                "short_description": {
                  "display_value": "Unable to connect to email",
                  "value": "Unable to connect to email"
                },
                "close_code": {
                  "display_value": "Solved (Permanently)",
                  "value": "Solved (Permanently)"
                },
                "correlation_display": {
                  "display_value": "",
                  "value": ""
                },
                "delivery_task": {
                  "display_value": "",
                  "value": ""
                },
                "work_start": {
                  "display_value": "",
                  "value": ""
                },
                "assignment_group": {
                  "display_value": "Network",
                  "value": "287ebd7da9fe198100f92cc8d1d2154e"
                },
                "additional_assignee_list": {
                  "display_value": "",
                  "value": ""
                },
                "business_stc": {
                  "display_value": "28,800",
                  "value": "28800"
                },
                "cause": {
                  "display_value": "",
                  "value": ""
                },
                "description": {
                  "display_value": "I am unable to connect to the email server. It appears to be down.",
                  "value": "I am unable to connect to the email server. It appears to be down."
                },
                "origin_id": {
                  "display_value": "",
                  "value": ""
                },
                "calendar_duration": {
                  "display_value": "1 Day 4 Hours 23 Minutes",
                  "value": "1970-01-02 04:23:17"
                },
                "close_notes": {
                  "display_value": "This incident is resolved.",
                  "value": "This incident is resolved."
                },
                "notify": {
                  "display_value": "Do Not Notify",
                  "value": "1"
                },
                "service_offering": {
                  "display_value": "",
                  "value": ""
                },
                "sys_class_name": {
                  "display_value": "Incident",
                  "value": "incident"
                },
                "closed_by": {
                  "display_value": "Joe Employee",
                  "value": "681ccaf9c0a8016400b98a06818d57c7"
                },
                "follow_up": {
                  "display_value": "",
                  "value": ""
                },
                "parent_incident": {
                  "display_value": "",
                  "value": ""
                },
                "sys_id": {
                  "display_value": "1c741bd70b2322007518478d83673af3",
                  "value": "1c741bd70b2322007518478d83673af3"
                },
                "contact_type": {
                  "display_value": "Self-service",
                  "value": "self-service"
                },
                "reopened_by": {
                  "display_value": "",
                  "value": ""
                },
                "incident_state": {
                  "display_value": "Closed",
                  "value": "7"
                },
                "urgency": {
                  "display_value": "2 - Medium",
                  "value": "2"
                },
                "problem_id": {
                  "display_value": "",
                  "value": ""
                },
                "company": {
                  "display_value": "ACME North America",
                  "value": "31bea3d53790200044e0bfc8bcbe5dec"
                },
                "reassignment_count": {
                  "display_value": "2",
                  "value": "2"
                },
                "activity_due": {
                  "display_value": "2016-12-12 17:26:36",
                  "value": "2016-12-13 01:26:36"
                },
                "assigned_to": {
                  "display_value": "David Loo",
                  "value": "5137153cc611227c000bbd1bd8cd2007"
                },
                "severity": {
                  "display_value": "3 - Low",
                  "value": "3"
                },
                "comments": {
                  "display_value": "",
                  "value": ""
                },
                "approval": {
                  "display_value": "Not Yet Requested",
                  "value": "not requested"
                },
                "sla_due": {
                  "display_value": "UNKNOWN",
                  "value": ""
                },
                "comments_and_work_notes": {
                  "display_value": "",
                  "value": ""
                },
                "due_date": {
                  "display_value": "",
                  "value": ""
                },
                "sys_mod_count": {
                  "display_value": "16",
                  "value": "16"
                },
                "reopen_count": {
                  "display_value": "0",
                  "value": "0"
                },
                "sys_tags": {
                  "display_value": "",
                  "value": ""
                },
                "escalation": {
                  "display_value": "Normal",
                  "value": "0"
                },
                "upon_approval": {
                  "display_value": "Proceed to Next Task",
                  "value": "proceed"
                },
                "correlation_id": {
                  "display_value": "",
                  "value": ""
                },
                "location": {
                  "display_value": "",
                  "value": ""
                },
                "category": {
                  "display_value": "Inquiry / Help",
                  "value": "inquiry"
                }
              }
            ]
          }
          `}}
