---
title: "Bitsight Vulnerability"
type: logs
streams:
  - input: cel
    title: Bitsight Vulnerability
    description: Collect vulnerability data from Bitsight Threats API
    template_path: cel.yml.hbs
    vars:
      - name: batch_size
        type: integer
        title: Batch Size
        description: Number of records retrieved per request.
        required: true
        show_user: true
        default: 100
      - name: interval
        type: text
        title: Poll Interval
        description: Defines how often data is collected from the Bitsight API.
        required: true
        show_user: true
        default: 5m
      - name: initial_interval
        type: text
        title: Initial Lookback Interval
        description: Defines how far back the first query should go when no cursor is set. Allowed time units are "s", "m", "h".
        required: true
        show_user: true
        default: 720h
      - name: tags
        type: text
        title: Tags
        description: Tags to apply to each event.
        multi: true
        required: false
        show_user: false
        default:
          - forwarded
          - bitsight-vulnerability
      - name: preserve_original_event
        type: bool
        title: Preserve original event
        description: Preserves a raw copy of the evidence payload in `event.original`.
        required: false
        show_user: true
        default: false
      - name: enable_request_tracer
        type: bool
        title: Enable request tracing
        description: Logs HTTP requests/responses locally for troubleshooting. Disable after collecting evidence.
        required: false
        show_user: false
        default: false
      - name: processors
        type: yaml
        title: Processors
        description: >-
          Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata.  This executes in the agent before the data is parsed. See  [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.
        multi: false
        required: false
        show_user: false
        default: |
          # - drop:
          #     when:
          #       equals:
          #         evidence.identifier: some-value
