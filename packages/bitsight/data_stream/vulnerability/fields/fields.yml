---
- name: bitsight
  type: group
  description: Bitsight data
  fields:
    - name: threat
      type: group
      description: Bitsight threat metadata
      fields:
        - name: guid
          type: keyword
          description: Unique threat GUID
        - name: name
          type: keyword
          description: Threat name (e.g. CVE-ID)
        - name: first_seen_date
          type: date
          description: Date when this threat was first seen
        - name: last_seen_date
          type: date
          description: Date when threat data was last available
        - name: support_started_date
          type: date
          description: Date when this threat was first supported in Bitsight
        - name: exposed_count
          type: integer
          description: Number of companies observed to have evidence of exposure
        - name: mitigated_count
          type: integer
          description: Number of companies with evidence of mitigation
        - name: exposure_trend
          type: integer
          description: Change in exposure count over the last 14 days
        - name: questionnaires_sent
          type: integer
          description: Number of questionnaires sent (when expanded)
        - name: evidence_certainty
          type: keyword
          description: Overall certainty for this threat's evidence
        - name: severity
          type: group
          description: Severity information
          fields:
            - name: level
              type: keyword
              description: Bitsight severity level
            - name: details
              type: keyword
              description: CVSS score details like type and base score (e.g. “CVSS 7.1”)
        - name: category
          type: group
          description: Threat category
          fields:
            - name: name
              type: keyword
              description: Category name
            - name: slug
              type: keyword
              description: Category slug
        - name: epss
          type: group
          description: Exploit Prediction Scoring System data
          fields:
            - name: score
              type: float
              description: EPSS score
            - name: percentile
              type: float
              description: EPSS percentile
        - name: dve
          type: group
          description: Dynamic Vulnerability Exploit data
          fields:
            - name: score
              type: float
              description: DVE score
            - name: highest_score
              type: float
              description: Highest recorded DVE score
            - name: highest_score_date
              type: date
              description: Date of highest DVE score
            - name: cti_attributes
              type: group
              description: CTI attributes
              fields:
                - name: name
                  type: keyword
                  description: CTI attribute name
                - name: slug
                  type: keyword
                  description: CTI attribute slug

    - name: company
      type: group
      description: Bitsight company exposure data
      fields:
        - name: company_name
          type: keyword
          description: Company name
        - name: company_guid
          type: keyword
          description: Company GUID
        - name: first_seen_date
          type: date
          description: Date when this threat first affected the company
        - name: last_seen_date
          type: date
          description: Date when this threat was last seen for the company
        - name: evidence_certainty
          type: keyword
          description: Certainty level of the company's evidence
        - name: exposure_detection
          type: keyword
          description: Company's exposure detection status
        - name: tier
          type: keyword
          description: Tier the company belongs to (Identifier)
        - name: tier_name
          type: keyword
          description: Tier name (Human readable)
        - name: logo
          type: keyword
          description: URL of the company logo
        - name: detection_types
          type: keyword
          description: How the data was collected
        - name: evidence_tags
          type: group
          description: Evidence tags for the company
          fields:
            - name: name
              type: keyword
              description: Evidence tag name
            - name: slug
              type: keyword
              description: Evidence tag slug

    - name: evidence
      type: group
      description: Bitsight evidence record details
      fields:
        - name: identifier
          type: keyword
          description: Asset identifier (e.g. “IP:port”)
        - name: detection_type
          type: keyword
          description: How the evidence was collected
        - name: certainty
          type: keyword
          description: Certainty level of this evidence
        - name: exposure_detection
          type: keyword
          description: Exposure detection status for this evidence
        - name: first_seen_date
          type: date
          description: Date when this evidence was first seen
        - name: last_seen_date
          type: date
          description: Date when this evidence was last seen
        - name: evidence_tag
          type: group
          description: Evidence tag details
          fields:
            - name: name
              type: keyword
              description: Evidence tag name
            - name: slug
              type: keyword
              description: Evidence tag slug
