rules:
  - path: /api/v2/assets/tickets
    methods: ['POST']
    request_headers:
      Content-Type: application/json
      api-key: xxxx
      api-secret: xxxx
    request_body: /.*"next_page":"xyz".*"page":{"limit":2}.*/
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "assets": [
              {
                "internal_axon_id": "81b209f43b54d018e5f5aa058f21e5e4",
                "adapters": [
                  "service_now_adapter"
                ],
                "adapter_list_length": 1,
                "specific_data": [
                  {
                    "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                    "adapter_categories": [
                      "CMDB",
                      "ITAM/ITSM",
                      "Ticketing",
                      "SaaS Management"
                    ],
                    "client_used": "67fd0999fe1c8e812a176ba2",
                    "data": {
                      "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                      "application_and_account_name": "servicenow/servicenow-dev",
                      "category": "Access Reviewer",
                      "closed": "Mon, 14 Apr 2025 03:04:11 GMT",
                      "created": "Sun, 06 Apr 2025 08:04:11 GMT",
                      "description": "Access Reviewer - Needs handling",
                      "display_id": "INC5904384",
                      "fetch_time": "Mon, 08 Dec 2025 00:02:42 GMT",
                      "first_fetch_time": "Sat, 30 Aug 2025 12:00:42 GMT",
                      "from_last_fetch": true,
                      "id": "ca9371ef-9218-4a93-9355-5e70f15495a6",
                      "is_fetched_from_adapter": true,
                      "last_fetch_connection_id": "67fd0999fe1c8e812a176ba2",
                      "last_fetch_connection_label": "servicenow-dev",
                      "not_fetched_count": 0,
                      "priority": "2 - High",
                      "reporter": "Glenda Wilgus",
                      "source_application": "ServiceNow",
                      "status": "Resolved",
                      "summary": "Access Reviewer",
                      "sys_class_name": "incident",
                      "tenant_number": [
                        "2"
                      ],
                      "ticket_id": "ca9371ef-9218-4a93-9355-5e70f15495a6",
                      "type": "Tickets",
                      "updated": "Mon, 14 Apr 2025 03:04:11 GMT"
                    },
                    "initial_plugin_unique_name": "service_now_adapter_0",
                    "plugin_name": "service_now_adapter",
                    "plugin_type": "Adapter",
                    "plugin_unique_name": "service_now_adapter_0",
                    "quick_id": "service_now_adapter_0!ca9371ef-9218-4a93-9355-5e70f15495a6",
                    "type": "entitydata"
                  }
                ]
              },
              {
                "internal_axon_id": "8873d108bfcabd90cf42e042ad01c60e",
                "adapters": [
                  "service_now_adapter"
                ],
                "adapter_list_length": 1,
                "specific_data": [
                  {
                    "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                    "adapter_categories": [
                      "CMDB",
                      "ITAM/ITSM",
                      "Ticketing",
                      "SaaS Management"
                    ],
                    "client_used": "67fd0999fe1c8e812a176ba2",
                    "data": {
                      "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                      "application_and_account_name": "servicenow/servicenow-dev",
                      "category": "Access Reviewer",
                      "closed": "Tue, 11 Mar 2025 00:51:41 GMT",
                      "created": "Sun, 24 Nov 2024 05:51:41 GMT",
                      "description": "Access Reviewer - Needs handling",
                      "display_id": "INC1691120",
                      "fetch_time": "Mon, 08 Dec 2025 00:02:42 GMT",
                      "first_fetch_time": "Sat, 30 Aug 2025 12:00:42 GMT",
                      "from_last_fetch": true,
                      "id": "1f8828e9-329a-46f4-9b3c-104ba5773ec4",
                      "is_fetched_from_adapter": true,
                      "last_fetch_connection_id": "67fd0999fe1c8e812a176ba2",
                      "last_fetch_connection_label": "servicenow-dev",
                      "not_fetched_count": 0,
                      "priority": "5 - Planning",
                      "reporter": "Chi Willis",
                      "source_application": "ServiceNow",
                      "status": "Resolved",
                      "summary": "Access Reviewer",
                      "sys_class_name": "incident",
                      "tenant_number": [
                        "1"
                      ],
                      "ticket_id": "1f8828e9-329a-46f4-9b3c-104ba5773ec4",
                      "type": "Tickets",
                      "updated": "Tue, 11 Mar 2025 00:51:41 GMT"
                    },
                    "initial_plugin_unique_name": "service_now_adapter_0",
                    "plugin_name": "service_now_adapter",
                    "plugin_type": "Adapter",
                    "plugin_unique_name": "service_now_adapter_0",
                    "quick_id": "service_now_adapter_0!1f8828e9-329a-46f4-9b3c-104ba5773ec4",
                    "type": "entitydata"
                  }
                ]
              }
            ],
            "meta": {
              "cache_last_updated": "Mon, 01 Dec 2025 13:37:38 GMT",
              "is_data_from_cache": true,
              "page": {
                "number": 2,
                "size": 2,
                "totalPages": 2,
                "totalResources": 4
              },
              "next_page": "abcd",
              "expand_row": false,
              "optimized_view": false,
              "relation_fields_data": false
            }
          }
          `}}

  - path: /api/v2/assets/tickets
    methods: ['POST']
    request_headers:
      Content-Type: application/json
      api-key: xxxx
      api-secret: xxxx
    request_body: /.*"page":{"limit":2}.*/
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "assets": [
              {
                "internal_axon_id": "3bd6051f3dd4493796aaf0d55dbcbe1f",
                "adapters": [
                  "service_now_adapter"
                ],
                "adapter_list_length": 1,
                "specific_data": [
                  {
                    "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                    "adapter_categories": [
                      "CMDB",
                      "ITAM/ITSM",
                      "Ticketing",
                      "SaaS Management"
                    ],
                    "client_used": "67fd0999fe1c8e812a176ba2",
                    "data": {
                      "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                      "application_and_account_name": "servicenow/servicenow-dev",
                      "category": "Access Reviewer",
                      "closed": "Sat, 10 Aug 2024 16:21:10 GMT",
                      "created": "Sun, 14 Jul 2024 23:21:10 GMT",
                      "description": "Access Reviewer - Needs addressing",
                      "display_id": "INC3566938",
                      "fetch_time": "Mon, 08 Dec 2025 00:02:42 GMT",
                      "first_fetch_time": "Sat, 30 Aug 2025 12:00:42 GMT",
                      "from_last_fetch": true,
                      "id": "b59da9ea-6814-4ee9-b7b1-ad9088b601cd",
                      "is_fetched_from_adapter": true,
                      "last_fetch_connection_id": "67fd0999fe1c8e812a176ba2",
                      "last_fetch_connection_label": "servicenow-dev",
                      "not_fetched_count": 0,
                      "priority": "5 - Planning",
                      "reporter": "Randy Mason",
                      "source_application": "ServiceNow",
                      "status": "Resolved",
                      "summary": "Access Reviewer",
                      "sys_class_name": "incident",
                      "tenant_number": [
                        "1"
                      ],
                      "ticket_id": "b59da9ea-6814-4ee9-b7b1-ad9088b601cd",
                      "type": "Tickets",
                      "updated": "Sat, 10 Aug 2024 16:21:10 GMT"
                    },
                    "initial_plugin_unique_name": "service_now_adapter_0",
                    "plugin_name": "service_now_adapter",
                    "plugin_type": "Adapter",
                    "plugin_unique_name": "service_now_adapter_0",
                    "quick_id": "service_now_adapter_0!b59da9ea-6814-4ee9-b7b1-ad9088b601cd",
                    "type": "entitydata"
                  }
                ]
              },
              {
                "internal_axon_id": "59afe6042c00bfb8e3238981bb3ba513",
                "adapters": [
                  "service_now_adapter"
                ],
                "adapter_list_length": 1,
                "specific_data": [
                  {
                    "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                    "adapter_categories": [
                      "CMDB",
                      "ITAM/ITSM",
                      "Ticketing",
                      "SaaS Management"
                    ],
                    "client_used": "67fd0999fe1c8e812a176ba2",
                    "data": {
                      "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                      "application_and_account_name": "servicenow/servicenow-dev",
                      "category": "Access Reviewer",
                      "closed": "Fri, 28 Feb 2025 17:51:16 GMT",
                      "created": "Sun, 09 Feb 2025 10:51:16 GMT",
                      "description": "Access Reviewer - Please take care of this",
                      "display_id": "INC7313850",
                      "fetch_time": "Mon, 08 Dec 2025 00:02:42 GMT",
                      "first_fetch_time": "Sat, 30 Aug 2025 12:00:42 GMT",
                      "from_last_fetch": true,
                      "id": "a0f31c41-1b21-4251-8704-0c7f68b6504d",
                      "is_fetched_from_adapter": true,
                      "last_fetch_connection_id": "67fd0999fe1c8e812a176ba2",
                      "last_fetch_connection_label": "servicenow-dev",
                      "not_fetched_count": 0,
                      "priority": "5 - Planning",
                      "reporter": "Jimmie Abram",
                      "source_application": "ServiceNow",
                      "status": "Resolved",
                      "summary": "Access Reviewer",
                      "sys_class_name": "incident",
                      "tenant_number": [
                        "2"
                      ],
                      "ticket_id": "a0f31c41-1b21-4251-8704-0c7f68b6504d",
                      "type": "Tickets",
                      "updated": "Fri, 28 Feb 2025 17:51:16 GMT"
                    },
                    "initial_plugin_unique_name": "service_now_adapter_0",
                    "plugin_name": "service_now_adapter",
                    "plugin_type": "Adapter",
                    "plugin_unique_name": "service_now_adapter_0",
                    "quick_id": "service_now_adapter_0!a0f31c41-1b21-4251-8704-0c7f68b6504d",
                    "type": "entitydata"
                  }
                ]
              }
            ],
            "meta": {
              "cache_last_updated": "Mon, 01 Dec 2025 13:37:38 GMT",
              "is_data_from_cache": true,
              "page": {
                  "number": 1,
                  "size": 2,
                  "totalPages": 2,
                  "totalResources": 4
              },
              "next_page": "xyz",
              "expand_row": false,
              "optimized_view": false,
              "relation_fields_data": false
            }
          }
          `}}

  - path: /api/v2/assets/cases
    methods: ['POST']
    request_headers:
      Content-Type: application/json
      api-key: xxxx
      api-secret: xxxx
    request_body: /.*"next_page":"xyz".*"page":{"limit":2}.*/
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "assets": [
              {
                "internal_axon_id": "3bd6051f3dd4493796aaf0d55dbcbe1f",
                "adapters": [
                  "service_now_adapter"
                ],
                "adapter_list_length": 1,
                "specific_data": [
                  {
                    "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                    "adapter_categories": [
                      "CMDB",
                      "ITAM/ITSM",
                      "Ticketing",
                      "SaaS Management"
                    ],
                    "client_used": "67fd0999fe1c8e812a176ba2",
                    "data": {
                      "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                      "application_and_account_name": "servicenow/servicenow-dev",
                      "category": "Access Reviewer",
                      "closed": "Sat, 10 Aug 2024 16:21:10 GMT",
                      "created": "Sun, 14 Jul 2024 23:21:10 GMT",
                      "description": "Access Reviewer - Needs addressing",
                      "display_id": "INC3566938",
                      "fetch_time": "Mon, 08 Dec 2025 00:02:42 GMT",
                      "first_fetch_time": "Sat, 30 Aug 2025 12:00:42 GMT",
                      "from_last_fetch": true,
                      "id": "b59da9ea-6814-4ee9-b7b1-ad9088b601cd",
                      "is_fetched_from_adapter": true,
                      "last_fetch_connection_id": "67fd0999fe1c8e812a176ba2",
                      "last_fetch_connection_label": "servicenow-dev",
                      "not_fetched_count": 0,
                      "priority": "5 - Planning",
                      "reporter": "Randy Mason",
                      "source_application": "ServiceNow",
                      "status": "Resolved",
                      "summary": "Access Reviewer",
                      "sys_class_name": "incident",
                      "tenant_number": [
                        "1"
                      ],
                      "ticket_id": "b59da9ea-6814-4ee9-b7b1-ad9088b601cd",
                      "type": "Tickets",
                      "updated": "Sat, 10 Aug 2024 16:21:10 GMT"
                    },
                    "initial_plugin_unique_name": "service_now_adapter_0",
                    "plugin_name": "service_now_adapter",
                    "plugin_type": "Adapter",
                    "plugin_unique_name": "service_now_adapter_0",
                    "quick_id": "service_now_adapter_0!b59da9ea-6814-4ee9-b7b1-ad9088b601cd",
                    "type": "entitydata"
                  }
                ]
              },
              {
                "internal_axon_id": "59afe6042c00bfb8e3238981bb3ba513",
                "adapters": [
                  "service_now_adapter"
                ],
                "adapter_list_length": 1,
                "specific_data": [
                  {
                    "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                    "adapter_categories": [
                      "CMDB",
                      "ITAM/ITSM",
                      "Ticketing",
                      "SaaS Management"
                    ],
                    "client_used": "67fd0999fe1c8e812a176ba2",
                    "data": {
                      "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                      "application_and_account_name": "servicenow/servicenow-dev",
                      "category": "Access Reviewer",
                      "closed": "Fri, 28 Feb 2025 17:51:16 GMT",
                      "created": "Sun, 09 Feb 2025 10:51:16 GMT",
                      "description": "Access Reviewer - Please take care of this",
                      "display_id": "INC7313850",
                      "fetch_time": "Mon, 08 Dec 2025 00:02:42 GMT",
                      "first_fetch_time": "Sat, 30 Aug 2025 12:00:42 GMT",
                      "from_last_fetch": true,
                      "id": "a0f31c41-1b21-4251-8704-0c7f68b6504d",
                      "is_fetched_from_adapter": true,
                      "last_fetch_connection_id": "67fd0999fe1c8e812a176ba2",
                      "last_fetch_connection_label": "servicenow-dev",
                      "not_fetched_count": 0,
                      "priority": "5 - Planning",
                      "reporter": "Jimmie Abram",
                      "source_application": "ServiceNow",
                      "status": "Resolved",
                      "summary": "Access Reviewer",
                      "sys_class_name": "incident",
                      "tenant_number": [
                        "2"
                      ],
                      "ticket_id": "a0f31c41-1b21-4251-8704-0c7f68b6504d",
                      "type": "Tickets",
                      "updated": "Fri, 28 Feb 2025 17:51:16 GMT"
                    },
                    "initial_plugin_unique_name": "service_now_adapter_0",
                    "plugin_name": "service_now_adapter",
                    "plugin_type": "Adapter",
                    "plugin_unique_name": "service_now_adapter_0",
                    "quick_id": "service_now_adapter_0!a0f31c41-1b21-4251-8704-0c7f68b6504d",
                    "type": "entitydata"
                  }
                ]
              }
            ],
            "meta": {
              "cache_last_updated": "Mon, 01 Dec 2025 13:37:38 GMT",
              "is_data_from_cache": true,
              "page": {
                  "number": 2,
                  "size": 2,
                  "totalPages": 2,
                  "totalResources": 4
              },
              "next_page": "abcd",
              "expand_row": false,
              "optimized_view": false,
              "relation_fields_data": false
            }
          }
          `}}


  - path: /api/v2/assets/cases
    methods: ['POST']
    request_headers:
      Content-Type: application/json
      api-key: xxxx
      api-secret: xxxx
    request_body: /.*"page":{"limit":2}.*/
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {{ minify_json `
          {
            "assets": [
              {
                "internal_axon_id": "3bd6051f3dd4493796aaf0d55dbcbe1f",
                "adapters": [
                  "service_now_adapter"
                ],
                "adapter_list_length": 1,
                "specific_data": [
                  {
                    "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                    "adapter_categories": [
                      "CMDB",
                      "ITAM/ITSM",
                      "Ticketing",
                      "SaaS Management"
                    ],
                    "client_used": "67fd0999fe1c8e812a176ba2",
                    "data": {
                      "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                      "application_and_account_name": "servicenow/servicenow-dev",
                      "category": "Access Reviewer",
                      "closed": "Sat, 10 Aug 2024 16:21:10 GMT",
                      "created": "Sun, 14 Jul 2024 23:21:10 GMT",
                      "description": "Access Reviewer - Needs addressing",
                      "display_id": "INC3566938",
                      "fetch_time": "Mon, 08 Dec 2025 00:02:42 GMT",
                      "first_fetch_time": "Sat, 30 Aug 2025 12:00:42 GMT",
                      "from_last_fetch": true,
                      "id": "b59da9ea-6814-4ee9-b7b1-ad9088b601cd",
                      "is_fetched_from_adapter": true,
                      "last_fetch_connection_id": "67fd0999fe1c8e812a176ba2",
                      "last_fetch_connection_label": "servicenow-dev",
                      "not_fetched_count": 0,
                      "priority": "5 - Planning",
                      "reporter": "Randy Mason",
                      "source_application": "ServiceNow",
                      "status": "Resolved",
                      "summary": "Access Reviewer",
                      "sys_class_name": "incident",
                      "tenant_number": [
                        "1"
                      ],
                      "ticket_id": "b59da9ea-6814-4ee9-b7b1-ad9088b601cd",
                      "type": "Tickets",
                      "updated": "Sat, 10 Aug 2024 16:21:10 GMT"
                    },
                    "initial_plugin_unique_name": "service_now_adapter_0",
                    "plugin_name": "service_now_adapter",
                    "plugin_type": "Adapter",
                    "plugin_unique_name": "service_now_adapter_0",
                    "quick_id": "service_now_adapter_0!b59da9ea-6814-4ee9-b7b1-ad9088b601cd",
                    "type": "entitydata"
                  }
                ]
              },
              {
                "internal_axon_id": "59afe6042c00bfb8e3238981bb3ba513",
                "adapters": [
                  "service_now_adapter"
                ],
                "adapter_list_length": 1,
                "specific_data": [
                  {
                    "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                    "adapter_categories": [
                      "CMDB",
                      "ITAM/ITSM",
                      "Ticketing",
                      "SaaS Management"
                    ],
                    "client_used": "67fd0999fe1c8e812a176ba2",
                    "data": {
                      "accurate_for_datetime": "Mon, 08 Dec 2025 00:02:48 GMT",
                      "application_and_account_name": "servicenow/servicenow-dev",
                      "category": "Access Reviewer",
                      "closed": "Fri, 28 Feb 2025 17:51:16 GMT",
                      "created": "Sun, 09 Feb 2025 10:51:16 GMT",
                      "description": "Access Reviewer - Please take care of this",
                      "display_id": "INC7313850",
                      "fetch_time": "Mon, 08 Dec 2025 00:02:42 GMT",
                      "first_fetch_time": "Sat, 30 Aug 2025 12:00:42 GMT",
                      "from_last_fetch": true,
                      "id": "a0f31c41-1b21-4251-8704-0c7f68b6504d",
                      "is_fetched_from_adapter": true,
                      "last_fetch_connection_id": "67fd0999fe1c8e812a176ba2",
                      "last_fetch_connection_label": "servicenow-dev",
                      "not_fetched_count": 0,
                      "priority": "5 - Planning",
                      "reporter": "Jimmie Abram",
                      "source_application": "ServiceNow",
                      "status": "Resolved",
                      "summary": "Access Reviewer",
                      "sys_class_name": "incident",
                      "tenant_number": [
                        "2"
                      ],
                      "ticket_id": "a0f31c41-1b21-4251-8704-0c7f68b6504d",
                      "type": "Tickets",
                      "updated": "Fri, 28 Feb 2025 17:51:16 GMT"
                    },
                    "initial_plugin_unique_name": "service_now_adapter_0",
                    "plugin_name": "service_now_adapter",
                    "plugin_type": "Adapter",
                    "plugin_unique_name": "service_now_adapter_0",
                    "quick_id": "service_now_adapter_0!a0f31c41-1b21-4251-8704-0c7f68b6504d",
                    "type": "entitydata"
                  }
                ]
              }
            ],
            "meta": {
              "cache_last_updated": "Mon, 01 Dec 2025 13:37:38 GMT",
              "is_data_from_cache": true,
              "page": {
                  "number": 1,
                  "size": 2,
                  "totalPages": 2,
                  "totalResources": 4
              },
              "next_page": "xyz",
              "expand_row": false,
              "optimized_view": false,
              "relation_fields_data": false
            }
          }
          `}}
