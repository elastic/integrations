---
description: Pipeline for processing network device logs.
processors:
  - append:
      field: event.category
      value: vulnerability
      tag: category_vulnerability
  - rename:
      field: json.event.action_if_exists
      tag: rename_event_action_if_exists
      target_field: axonius.network.event.action_if_exists
      ignore_missing: true
  - set:
      field: event.action
      tag: set_event_action_from_network_event_action_if_exists
      copy_from: axonius.network.event.action_if_exists
      ignore_empty_value: true
  - lowercase:
      field: event.action
      tag: lowercase_event_action
      ignore_missing: true
  - split:
      field: event.action
      tag: split_event_action
      separator: \s+
      ignore_missing: true
      if: ctx.event?.action != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - join:
      field: event.action
      tag: join_event_action
      separator: '-'
      if: ctx.event?.action != null && ctx.event.action != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.associated_adapter_plugin_name
      tag: rename_event_associated_adapter_plugin_name
      target_field: axonius.network.event.associated_adapter_plugin_name
      ignore_missing: true
  - rename:
      field: json.event.association_type
      tag: rename_event_association_type
      target_field: axonius.network.event.association_type
      ignore_missing: true
  - rename:
      field: json.event.data.__fields_to_unset__
      tag: rename_event_data___fields_to_unset__
      target_field: axonius.network.event.data.__fields_to_unset__
      ignore_missing: true
  - convert:
      field: json.event.data._keep_hostname_empty
      tag: convert_event_data__keep_hostname_empty_to_boolean
      target_field: axonius.network.event.data._keep_hostname_empty
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.adapter_properties
      tag: rename_event_data_adapter_properties
      target_field: axonius.network.event.data.adapter_properties
      ignore_missing: true
  - rename:
      field: json.event.data.agent_version
      tag: rename_event_data_agent_version
      target_field: axonius.network.event.data.agent_version
      ignore_missing: true
  - set:
      field: user_agent.version
      tag: set_user_agent_version_from_network_event_data_agent_version
      copy_from: axonius.network.event.data.agent_version
      ignore_empty_value: true
  - rename:
      field: json.event.data.agent_versions
      tag: rename_event_data_agent_versions
      target_field: axonius.network.event.data.agent_versions
      ignore_missing: true
  - rename:
      field: json.event.data.all_associated_email_addresses
      tag: rename_event_data_all_associated_email_addresses
      target_field: axonius.network.event.data.all_associated_email_addresses
      ignore_missing: true
  - rename:
      field: json.event.data.anti_malware_agent_status
      tag: rename_event_data_anti_malware_agent_status
      target_field: axonius.network.event.data.anti_malware_agent_status
      ignore_missing: true
  - rename:
      field: json.event.data.anti_malware_agent_status_message
      tag: rename_event_data_anti_malware_agent_status_message
      target_field: axonius.network.event.data.anti_malware_agent_status_message
      ignore_missing: true
  - rename:
      field: json.event.data.anti_malware_state
      tag: rename_event_data_anti_malware_state
      target_field: axonius.network.event.data.anti_malware_state
      ignore_missing: true
  - rename:
      field: json.event.data.arp_interface
      tag: rename_event_data_arp_interface
      target_field: axonius.network.event.data.arp_interface
      ignore_missing: true
  - rename:
      field: json.event.data.arp_port
      tag: rename_event_data_arp_port
      target_field: axonius.network.event.data.arp_port
      ignore_missing: true
  - rename:
      field: json.event.data.arp_status
      tag: rename_event_data_arp_status
      target_field: axonius.network.event.data.arp_status
      ignore_missing: true
  - convert:
      field: json.event.data.arp_ttl
      tag: convert_event_data_arp_ttl_to_long
      target_field: axonius.network.event.data.arp_ttl
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.assessed_for_policies
      tag: convert_event_data_assessed_for_policies_to_boolean
      target_field: axonius.network.event.data.assessed_for_policies
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.assessed_for_vulnerabilities
      tag: convert_event_data_assessed_for_vulnerabilities_to_boolean
      target_field: axonius.network.event.data.assessed_for_vulnerabilities
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.asset_install_status
      tag: rename_event_data_asset_install_status
      target_field: axonius.network.event.data.asset_install_status
      ignore_missing: true
  - rename:
      field: json.event.data.asset_tag
      tag: rename_event_data_asset_tag
      target_field: axonius.network.event.data.asset_tag
      ignore_missing: true
  - rename:
      field: json.event.data.asset_user_name
      tag: rename_event_data_asset_user_name
      target_field: axonius.network.event.data.asset_user_name
      ignore_missing: true
  - append:
      field: related.user
      tag: append_network_event_data_asset_user_name_into_related_user
      value: '{{{axonius.network.event.data.asset_user_name}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.asset_user_name != null
  - foreach:
      field: json.event.data.associated_device_users
      tag: foreach_event_data_associated_device_users_is_latest_used_user
      if: ctx.json?.event?.data?.associated_device_users instanceof List
      processor:
        convert:
          field: _ingest._value.is_latest_used_user
          tag: convert_event_data_associated_device_users_is_latest_used_user_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.is_latest_used_user
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.associated_device_users
      tag: foreach_event_data_associated_device_users_is_latest_used_user
      if: ctx.json?.event?.data?.associated_device_users instanceof List
      processor:
        append:
          field: related.user
          tag: append_event_data_associated_device_users_is_latest_used_user_into_related_user
          value: '{{{_ingest._value.is_latest_used_user}}}'
          allow_duplicates: false
  - foreach:
      field: json.event.data.associated_device_users
      tag: foreach_event_data_associated_device_users_last_used_email
      if: ctx.json?.event?.data?.associated_device_users instanceof List
      processor:
        append:
          field: related.user
          tag: append_event_data_associated_device_users_last_used_email_into_related_user
          value: '{{{_ingest._value.last_used_email}}}'
          allow_duplicates: false
  - foreach:
      field: json.event.data.associated_device_users
      tag: foreach_event_data_associated_device_users_last_used_user_manager
      if: ctx.json?.event?.data?.associated_device_users instanceof List
      processor:
        append:
          field: related.user
          tag: append_event_data_associated_device_users_last_used_user_manager_into_related_user
          value: '{{{_ingest._value.last_used_user_manager}}}'
          allow_duplicates: false
  - rename:
      field: json.event.data.associated_device_users
      tag: rename_event_data_associated_device_users
      target_field: axonius.network.event.data.associated_device_users
      ignore_missing: true
  - rename:
      field: json.event.data.associated_saas_applications
      tag: rename_event_data_associated_saas_applications
      target_field: axonius.network.event.data.associated_saas_applications
      ignore_missing: true
  - rename:
      field: json.event.data.axon_id
      tag: rename_event_data_axon_id
      target_field: axonius.network.event.data.axon_id
      ignore_missing: true
  - rename:
      field: json.event.data.axonius_instance_name
      tag: rename_event_data_axonius_instance_name
      target_field: axonius.network.event.data.axonius_instance_name
      ignore_missing: true
  - rename:
      field: json.event.data.browsers
      tag: rename_event_data_browsers
      target_field: axonius.network.event.data.browsers
      ignore_missing: true
  - rename:
      field: json.event.data.category
      tag: rename_event_data_category
      target_field: axonius.network.event.data.category
      ignore_missing: true
  - date:
      field: json.event.data.certificate_expiry_date
      tag: date_event_data_certificate_expiry_date
      target_field: axonius.network.event.data.certificate_expiry_date
      formats:
        - EEE, dd MMM yyyy HH:mm:ss 'GMT'
        - yyyy-MM-dd
        - EEE,dd MMM yyyy HH:mm:ss 'GMT'
      if: ctx.json?.event?.data?.certificate_expiry_date != null && ctx.json.event.data.certificate_expiry_date != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.chrome_device_type
      tag: rename_event_data_chrome_device_type
      target_field: axonius.network.event.data.chrome_device_type
      ignore_missing: true
  - foreach:
      field: json.event.data.cisa_vulnerabilities
      tag: foreach_event_data_cisa_vulnerabilities_added
      if: ctx.json?.event?.data?.cisa_vulnerabilities instanceof List
      processor:
        date:
          field: _ingest._value.added
          tag: date_event_data_cisa_vulnerabilities_added
          target_field: _ingest._value.added
          formats:
            - EEE, dd MMM yyyy HH:mm:ss 'GMT'
            - yyyy-MM-dd
            - EEE,dd MMM yyyy HH:mm:ss 'GMT'
          on_failure:
            - remove:
                field: _ingest._value.added
                ignore_missing: true
  - foreach:
      field: json.event.data.cisa_vulnerabilities
      tag: foreach_event_data_cisa_vulnerabilities_cve_id
      if: ctx.json?.event?.data?.cisa_vulnerabilities instanceof List
      processor:
        append:
          field: vulnerability.id
          tag: append_event_data_cisa_vulnerabilities_cve_id_into_vulnerability_id
          value: '{{{_ingest._value.cve_id}}}'
          allow_duplicates: false
  - foreach:
      field: json.event.data.cisa_vulnerabilities
      tag: foreach_event_data_cisa_vulnerabilities_desc
      if: ctx.json?.event?.data?.cisa_vulnerabilities instanceof List
      processor:
        append:
          field: vulnerability.description
          tag: append_event_data_cisa_vulnerabilities_desc_into_message
          value: '{{{_ingest._value.desc}}}'
          allow_duplicates: false
  - foreach:
      field: json.event.data.cisa_vulnerabilities
      tag: foreach_event_data_cisa_vulnerabilities_due_date
      if: ctx.json?.event?.data?.cisa_vulnerabilities instanceof List
      processor:
        date:
          field: _ingest._value.due_date
          tag: date_event_data_cisa_vulnerabilities_due_date
          target_field: _ingest._value.due_date
          formats:
            - EEE, dd MMM yyyy HH:mm:ss 'GMT'
            - yyyy-MM-dd
            - EEE,dd MMM yyyy HH:mm:ss 'GMT'
          on_failure:
            - remove:
                field: _ingest._value.due_date
                ignore_missing: true
  - foreach:
      field: json.event.data.cisa_vulnerabilities
      tag: foreach_event_data_cisa_vulnerabilities_used_in_ransomware
      if: ctx.json?.event?.data?.cisa_vulnerabilities instanceof List
      processor:
        convert:
          field: _ingest._value.used_in_ransomware
          tag: convert_event_data_cisa_vulnerabilities_used_in_ransomware_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.used_in_ransomware
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.cisa_vulnerabilities
      tag: rename_event_data_cisa_vulnerabilities
      target_field: axonius.network.event.data.cisa_vulnerabilities
      ignore_missing: true
  - rename:
      field: json.event.data.class_name
      tag: rename_event_data_class_name
      target_field: axonius.network.event.data.class_name
      ignore_missing: true
  - rename:
      field: json.event.data.class_title
      tag: rename_event_data_class_title
      target_field: axonius.network.event.data.class_title
      ignore_missing: true
  - rename:
      field: json.event.data.class_type
      tag: rename_event_data_class_type
      target_field: axonius.network.event.data.class_type
      ignore_missing: true
  - rename:
      field: json.event.data.cloud_provider_account_id
      tag: rename_event_data_cloud_provider_account_id
      target_field: axonius.network.event.data.cloud_provider_account_id
      ignore_missing: true
  - set:
      field: cloud.account.id
      tag: set_cloud_account_id_from_network_event_data_cloud_provider_account_id
      copy_from: axonius.network.event.data.cloud_provider_account_id
      ignore_empty_value: true
  - foreach:
      field: json.event.data.cmdb_business_applications
      tag: foreach_event_data_cmdb_business_applications_u_crown_jewel
      if: ctx.json?.event?.data?.cmdb_business_applications instanceof List
      processor:
        convert:
          field: _ingest._value.u_crown_jewel
          tag: convert_event_data_cmdb_business_applications_u_crown_jewel_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.u_crown_jewel
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.cmdb_business_applications
      tag: rename_event_data_cmdb_business_applications
      target_field: axonius.network.event.data.cmdb_business_applications
      ignore_missing: true
  - rename:
      field: json.event.data.color
      tag: rename_event_data_color
      target_field: axonius.network.event.data.color
      ignore_missing: true
  - foreach:
      field: json.event.data.common_users
      tag: foreach_event_data_common_users
      if: ctx.json?.event?.data?.common_users instanceof List
      processor:
        append:
          field: related.user
          tag: append_event_data_common_users_into_related_user
          value: '{{{_ingest._value}}}'
          allow_duplicates: false
  - rename:
      field: json.event.data.common_users
      tag: rename_event_data_common_users
      target_field: axonius.network.event.data.common_users
      ignore_missing: true
  - rename:
      field: json.event.data.company
      tag: rename_event_data_company
      target_field: axonius.network.event.data.company
      ignore_missing: true
  - convert:
      field: json.event.data.confidence_level
      tag: convert_event_data_confidence_level_to_long
      target_field: axonius.network.event.data.confidence_level
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.connected_devices
      tag: rename_event_data_connected_devices
      target_field: axonius.network.event.data.connected_devices
      ignore_missing: true
  - rename:
      field: json.event.data.cp_type
      tag: rename_event_data_cp_type
      target_field: axonius.network.event.data.cp_type
      ignore_missing: true
  - foreach:
      field: json.event.data.cpus
      tag: foreach_event_data_cpus_cores
      if: ctx.json?.event?.data?.cpus instanceof List
      processor:
        convert:
          field: _ingest._value.cores
          tag: convert_event_data_cpus_cores_to_long
          type: long
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.cores
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.cpus
      tag: foreach_event_data_cpus_ghz
      if: ctx.json?.event?.data?.cpus instanceof List
      processor:
        convert:
          field: _ingest._value.ghz
          tag: convert_event_data_cpus_ghz_to_double
          type: double
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.ghz
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.cpus
      tag: rename_event_data_cpus
      target_field: axonius.network.event.data.cpus
      ignore_missing: true
  - rename:
      field: json.event.data.criticality
      tag: rename_event_data_criticality
      target_field: axonius.network.event.data.criticality
      ignore_missing: true
  - rename:
      field: json.event.data.custom_risk_owner
      tag: rename_event_data_custom_risk_owner
      target_field: axonius.network.event.data.custom_risk_owner
      ignore_missing: true
  - rename:
      field: json.event.data.data_center
      tag: rename_event_data_data_center
      target_field: axonius.network.event.data.data_center
      ignore_missing: true
  - rename:
      field: json.event.data.device_manufacturer
      tag: rename_event_data_device_manufacturer
      target_field: axonius.network.event.data.device_manufacturer
      ignore_missing: true
  - set:
      field: device.manufacturer
      tag: set_device_manufacturer_from_network_event_data_device_manufacturer
      copy_from: axonius.network.event.data.device_manufacturer
      ignore_empty_value: true
  - rename:
      field: json.event.data.device_serial
      tag: rename_event_data_device_serial
      target_field: axonius.network.event.data.device_serial
      ignore_missing: true
  - set:
      field: device.serial_number
      tag: set_device_serial_number_from_network_event_data_device_serial
      copy_from: axonius.network.event.data.device_serial
      ignore_empty_value: true
  - append:
      field: related.hosts
      tag: append_network_event_data_device_serial_into_related_hosts
      value: '{{{axonius.network.event.data.device_serial}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.device_serial != null
  - rename:
      field: json.event.data.device_state
      tag: rename_event_data_device_state
      target_field: axonius.network.event.data.device_state
      ignore_missing: true
  - rename:
      field: json.event.data.device_type
      tag: rename_event_data_device_type
      target_field: axonius.network.event.data.device_type
      ignore_missing: true
  - set:
      field: device.type
      tag: set_device_type_from_network_event_data_device_type
      copy_from: axonius.network.event.data.device_type
      ignore_empty_value: true
  - rename:
      field: json.event.data.disk_encryption_configuration
      tag: rename_event_data_disk_encryption_configuration
      target_field: axonius.network.event.data.disk_encryption_configuration
      ignore_missing: true
  - rename:
      field: json.event.data.domain
      tag: rename_event_data_domain
      target_field: axonius.network.event.data.domain
      ignore_missing: true
  - set:
      field: host.domain
      tag: set_host_domain_from_network_event_data_domain
      copy_from: axonius.network.event.data.domain
      ignore_empty_value: true
  - rename:
      field: json.event.data.entity_id
      tag: rename_event_data_entity_id
      target_field: axonius.network.event.data.entity_id
      ignore_missing: true
  - rename:
      field: json.event.data.environment
      tag: rename_event_data_environment
      target_field: axonius.network.event.data.environment
      ignore_missing: true
  - rename:
      field: json.event.data.epo_host
      tag: rename_event_data_epo_host
      target_field: axonius.network.event.data.epo_host
      ignore_missing: true
  - append:
      field: related.hosts
      tag: append_network_event_data_epo_host_into_related_hosts
      value: '{{{axonius.network.event.data.epo_host}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.epo_host != null
  - rename:
      field: json.event.data.epo_id
      tag: rename_event_data_epo_id
      target_field: axonius.network.event.data.epo_id
      ignore_missing: true
  - rename:
      field: json.event.data.epo_products
      tag: rename_event_data_epo_products
      target_field: axonius.network.event.data.epo_products
      ignore_missing: true
  - rename:
      field: json.event.data.excluded_software_cves
      tag: rename_event_data_excluded_software_cves
      target_field: axonius.network.event.data.excluded_software_cves
      ignore_missing: true
  - rename:
      field: json.event.data.external_cloud_account_id
      tag: rename_event_data_external_cloud_account_id
      target_field: axonius.network.event.data.external_cloud_account_id
      ignore_missing: true
  - convert:
      field: json.event.data.external_ip
      tag: convert_event_data_external_ip_to_ip
      target_field: axonius.network.event.data.external_ip
      type: ip
      ignore_missing: true
      if: ctx.json?.event?.data?.external_ip != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - append:
      field: related.ip
      tag: append_network_event_data_external_ip_into_related_ip
      value: '{{{axonius.network.event.data.external_ip}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.external_ip != null
  - convert:
      field: json.event.data.external_nat_ip
      tag: convert_event_data_external_nat_ip_to_ip
      target_field: axonius.network.event.data.external_nat_ip
      type: ip
      ignore_missing: true
      if: ctx.json?.event?.data?.external_nat_ip != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - append:
      field: related.ip
      tag: append_network_event_data_external_nat_ip_into_related_ip
      value: '{{{axonius.network.event.data.external_nat_ip}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.external_nat_ip != null
  - rename:
      field: json.event.data.fetch_proto
      tag: rename_event_data_fetch_proto
      target_field: axonius.network.event.data.fetch_proto
      ignore_missing: true
  - rename:
      field: json.event.data.fingerprint
      tag: rename_event_data_fingerprint
      target_field: axonius.network.event.data.fingerprint
      ignore_missing: true
  - convert:
      field: json.event.data.firewall_enabled
      tag: convert_event_data_firewall_enabled_to_boolean
      target_field: axonius.network.event.data.firewall_enabled
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.firewall_rules
      tag: rename_event_data_firewall_rules
      target_field: axonius.network.event.data.firewall_rules
      ignore_missing: true
  - rename:
      field: json.event.data.fqdn
      tag: rename_event_data_fqdn
      target_field: axonius.network.event.data.fqdn
      ignore_missing: true
  - set:
      field: host.name
      tag: set_host_name_from_network_event_data_fqdn
      copy_from: axonius.network.event.data.fqdn
      ignore_empty_value: true
  - append:
      field: related.hosts
      tag: append_network_event_data_fqdn_into_related_hosts
      value: '{{{axonius.network.event.data.fqdn}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.fqdn != null
  - convert:
      field: json.event.data.free_physical_memory
      tag: convert_event_data_free_physical_memory_to_long
      target_field: axonius.network.event.data.free_physical_memory
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.general
      tag: rename_event_data_general
      target_field: axonius.network.event.data.general
      ignore_missing: true
  - foreach:
      field: json.event.data.generic_encryption
      tag: foreach_event_data_generic_encryption_status
      if: ctx.json?.event?.data?.generic_encryption instanceof List
      processor:
        convert:
          field: _ingest._value.status
          tag: convert_event_data_generic_encryption_status_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.status
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.generic_encryption
      tag: rename_event_data_generic_encryption
      target_field: axonius.network.event.data.generic_encryption
      ignore_missing: true
  - convert:
      field: json.event.data.ghost
      tag: convert_event_data_ghost_to_boolean
      target_field: axonius.network.event.data.ghost
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.guest_dns_name
      tag: rename_event_data_guest_dns_name
      target_field: axonius.network.event.data.guest_dns_name
      ignore_missing: true
  - append:
      field: host.name
      tag: append_axonius_network_event_data_guest_dns_name_into_host_name
      value: '{{{axonius.network.event.data.guest_dns_name}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.guest_dns_name != null
  - append:
      field: related.hosts
      tag: append_network_event_data_guest_dns_name_into_related_hosts
      value: '{{{axonius.network.event.data.guest_dns_name}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.guest_dns_name != null
  - rename:
      field: json.event.data.guest_family
      tag: rename_event_data_guest_family
      target_field: axonius.network.event.data.guest_family
      ignore_missing: true
  - rename:
      field: json.event.data.guest_name
      tag: rename_event_data_guest_name
      target_field: axonius.network.event.data.guest_name
      ignore_missing: true
  - rename:
      field: json.event.data.guest_state
      tag: rename_event_data_guest_state
      target_field: axonius.network.event.data.guest_state
      ignore_missing: true
  - convert:
      field: json.event.data.hard_drives.free_size
      tag: convert_event_data_hard_drives_free_size_to_long
      target_field: axonius.network.event.data.hard_drives.free_size
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.hard_drives.is_encrypted
      tag: convert_event_data_hard_drives_is_encrypted_to_boolean
      target_field: axonius.network.event.data.hard_drives.is_encrypted
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.hard_drives.total_size
      tag: convert_event_data_hard_drives_total_size_to_long
      target_field: axonius.network.event.data.hard_drives.total_size
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.hardware_status
      tag: rename_event_data_hardware_status
      target_field: axonius.network.event.data.hardware_status
      ignore_missing: true
  - rename:
      field: json.event.data.hostname
      tag: rename_event_data_hostname
      target_field: axonius.network.event.data.hostname
      ignore_missing: true
  - set:
      field: host.hostname
      tag: set_host_hostname_from_network_event_data_hostname
      copy_from: axonius.network.event.data.hostname
      ignore_empty_value: true
  - append:
      field: related.hosts
      tag: append_network_event_data_hostname_into_related_hosts
      value: '{{{axonius.network.event.data.hostname}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.hostname != null
  - rename:
      field: json.event.data.in_groups
      tag: rename_event_data_in_groups
      target_field: axonius.network.event.data.in_groups
      ignore_missing: true
  - rename:
      field: json.event.data.install_status
      tag: rename_event_data_install_status
      target_field: axonius.network.event.data.install_status
      ignore_missing: true
  - rename:
      field: json.event.data.installed_software
      tag: rename_event_data_installed_software
      target_field: axonius.network.event.data.installed_software
      ignore_missing: true
  - rename:
      field: json.event.data.ip_address_guid
      tag: rename_event_data_ip_address_guid
      target_field: axonius.network.event.data.ip_address_guid
      ignore_missing: true
  - convert:
      field: json.event.data.is_authenticated_scan
      tag: convert_event_data_is_authenticated_scan_to_boolean
      target_field: axonius.network.event.data.is_authenticated_scan
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.is_fragile
      tag: convert_event_data_is_fragile_to_boolean
      target_field: axonius.network.event.data.is_fragile
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.is_latest_last_seen
      tag: convert_event_data_is_latest_last_seen_to_boolean
      target_field: axonius.network.event.data.is_latest_last_seen
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.is_managed
      tag: convert_event_data_is_managed_to_boolean
      target_field: axonius.network.event.data.is_managed
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.is_network_infra_device
      tag: convert_event_data_is_network_infra_device_to_boolean
      target_field: axonius.network.event.data.is_network_infra_device
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.network_interfaces
      tag: foreach_event_data_network_interfaces_ips_v4
      if: ctx.json?.event?.data?.network_interfaces instanceof List
      processor:
        gsub:
          field: _ingest._value.mac
          tag: gsub_event_data_network_interfaces_mac
          pattern: ':'
          replacement: '-'
          ignore_missing: true
          on_failure:
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.network_interfaces
      tag: foreach_event_data_network_interfaces_ips_v4
      if: ctx.json?.event?.data?.network_interfaces instanceof List
      processor:
        uppercase:
          field: _ingest._value.mac
          tag: uppercase_event_data_network_interfaces_mac
          ignore_missing: true
  - convert:
      field: json.event.data.is_purchased
      tag: convert_event_data_is_purchased_to_boolean
      target_field: axonius.network.event.data.is_purchased
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.is_safe
      tag: convert_event_data_is_safe_to_boolean
      target_field: axonius.network.event.data.is_safe
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.jamf_groups
      tag: rename_event_data_jamf_groups
      target_field: axonius.network.event.data.jamf_groups
      ignore_missing: true
  - foreach:
      field: json.event.data.jamf_groups_detailed
      tag: foreach_event_data_jamf_groups_detailed_smart_group
      if: ctx.json?.event?.data?.jamf_groups_detailed instanceof List
      processor:
        convert:
          field: _ingest._value.smart_group
          tag: convert_event_data_jamf_groups_detailed_smart_group_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.smart_group
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.jamf_groups_detailed
      tag: foreach_event_data_jamf_groups_detailed_group_id
      if: ctx.json?.event?.data?.jamf_groups_detailed instanceof List
      processor:
        convert:
          field: _ingest._value.group_id
          tag: convert_event_data_jamf_groups_detailed_group_id_to_string
          type: string
          ignore_missing: true
  - rename:
      field: json.event.data.jamf_groups_detailed
      tag: rename_event_data_jamf_groups_detailed
      target_field: axonius.network.event.data.jamf_groups_detailed
      ignore_missing: true
  - convert:
      field: json.event.data.jamf_id
      tag: convert_event_data_jamf_id_into_keyword
      type: string
      target_field: axonius.network.event.data.jamf_id
      ignore_missing: true
  - rename:
      field: json.event.data.jamf_location.building
      tag: rename_event_data_jamf_location_building
      target_field: axonius.network.event.data.jamf_location.building
      ignore_missing: true
  - rename:
      field: json.event.data.jamf_location.email_address
      tag: rename_event_data_jamf_location_email_address
      target_field: axonius.network.event.data.jamf_location.email_address
      ignore_missing: true
  - append:
      field: related.user
      tag: append_network_event_data_jamf_location_email_address_into_related_user
      value: '{{{axonius.network.event.data.jamf_location.email_address}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.jamf_location?.email_address != null
  - rename:
      field: json.event.data.jamf_location.phone_number
      tag: rename_event_data_jamf_location_phone_number
      target_field: axonius.network.event.data.jamf_location.phone_number
      ignore_missing: true
  - rename:
      field: json.event.data.jamf_location.position
      tag: rename_event_data_jamf_location_position
      target_field: axonius.network.event.data.jamf_location.position
      ignore_missing: true
  - rename:
      field: json.event.data.jamf_location.real_name
      tag: rename_event_data_jamf_location_real_name
      target_field: axonius.network.event.data.jamf_location.real_name
      ignore_missing: true
  - rename:
      field: json.event.data.jamf_location.room
      tag: rename_event_data_jamf_location_room
      target_field: axonius.network.event.data.jamf_location.room
      ignore_missing: true
  - convert:
      field: json.event.data.jamf_location.room
      tag: convert_event_data_jamf_location_room_to_long
      target_field: axonius.network.event.data.jamf_location.room
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.jamf_location.username
      tag: rename_event_data_jamf_location_username
      target_field: axonius.network.event.data.jamf_location.username
      ignore_missing: true
  - append:
      field: related.user
      tag: append_network_event_data_jamf_location_username_into_related_user
      value: '{{{axonius.network.event.data.jamf_location.username}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.jamf_location?.username != null
  - rename:
      field: json.event.data.jamf_version
      tag: rename_event_data_jamf_version
      target_field: axonius.network.event.data.jamf_version
      ignore_missing: true
  - date:
      field: json.event.data.last_agent_import
      tag: date_event_data_last_agent_import
      target_field: axonius.network.event.data.last_agent_import
      formats:
        - EEE, dd MMM yyyy HH:mm:ss 'GMT'
        - yyyy-MM-dd
        - EEE,dd MMM yyyy HH:mm:ss 'GMT'
      if: ctx.json?.event?.data?.last_agent_import != null && ctx.json.event.data.last_agent_import != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: json.event.data.last_auth_run
      tag: date_event_data_last_auth_run
      target_field: axonius.network.event.data.last_auth_run
      formats:
        - EEE, dd MMM yyyy HH:mm:ss 'GMT'
        - yyyy-MM-dd
        - EEE,dd MMM yyyy HH:mm:ss 'GMT'
      if: ctx.json?.event?.data?.last_auth_run != null && ctx.json.event.data.last_auth_run != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: json.event.data.last_contact_time
      tag: date_event_data_last_contact_time
      target_field: axonius.network.event.data.last_contact_time
      formats:
        - EEE, dd MMM yyyy HH:mm:ss 'GMT'
        - yyyy-MM-dd
        - EEE,dd MMM yyyy HH:mm:ss 'GMT'
      if: ctx.json?.event?.data?.last_contact_time != null && ctx.json.event.data.last_contact_time != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: json.event.data.last_enrolled_date_utc
      tag: date_event_data_last_enrolled_date_utc
      target_field: axonius.network.event.data.last_enrolled_date_utc
      formats:
        - EEE, dd MMM yyyy HH:mm:ss 'GMT'
        - yyyy-MM-dd
        - EEE,dd MMM yyyy HH:mm:ss 'GMT'
      if: ctx.json?.event?.data?.last_enrolled_date_utc != null && ctx.json.event.data.last_enrolled_date_utc != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: json.event.data.last_scan
      tag: date_event_data_last_scan
      target_field: axonius.network.event.data.last_scan
      formats:
        - EEE, dd MMM yyyy HH:mm:ss 'GMT'
        - yyyy-MM-dd
        - EEE,dd MMM yyyy HH:mm:ss 'GMT'
      if: ctx.json?.event?.data?.last_scan != null && ctx.json.event.data.last_scan != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: json.event.data.last_seen_agents
      tag: date_event_data_last_seen_agents
      target_field: axonius.network.event.data.last_seen_agents
      formats:
        - EEE, dd MMM yyyy HH:mm:ss 'GMT'
        - yyyy-MM-dd
        - EEE,dd MMM yyyy HH:mm:ss 'GMT'
      if: ctx.json?.event?.data?.last_seen_agents != null && ctx.json.event.data.last_seen_agents != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: json.event.data.last_unauth_run
      tag: date_event_data_last_unauth_run
      target_field: axonius.network.event.data.last_unauth_run
      formats:
        - EEE, dd MMM yyyy HH:mm:ss 'GMT'
        - yyyy-MM-dd
        - EEE,dd MMM yyyy HH:mm:ss 'GMT'
      if: ctx.json?.event?.data?.last_unauth_run != null && ctx.json.event.data.last_unauth_run != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.last_used_users
      tag: foreach_event_data_last_used_users
      if: ctx.json?.event?.data?.last_used_users instanceof List
      processor:
        append:
          field: related.user
          tag: append_event_data_last_used_users_into_related_user
          value: '{{{_ingest._value}}}'
          allow_duplicates: false
  - rename:
      field: json.event.data.last_used_users
      tag: rename_event_data_last_used_users
      target_field: axonius.network.event.data.last_used_users
      ignore_missing: true
  - rename:
      field: json.event.data.last_used_users_departments_association
      tag: rename_event_data_last_used_users_departments_association
      target_field: axonius.network.event.data.last_used_users_departments_association
      ignore_missing: true
  - rename:
      field: json.event.data.last_used_users_email_domain_association
      tag: rename_event_data_last_used_users_email_domain_association
      target_field: axonius.network.event.data.last_used_users_email_domain_association
      ignore_missing: true
  - rename:
      field: json.event.data.last_used_users_internal_axon_id_association
      tag: rename_event_data_last_used_users_internal_axon_id_association
      target_field: axonius.network.event.data.last_used_users_internal_axon_id_association
      ignore_missing: true
  - foreach:
      field: json.event.data.last_used_users_mail_association
      tag: foreach_event_data_last_used_users_mail_association
      if: ctx.json?.event?.data?.last_used_users_mail_association instanceof List
      processor:
        append:
          field: related.user
          tag: append_event_data_last_used_users_mail_association_into_related_user
          value: '{{{_ingest._value}}}'
          allow_duplicates: false
  - rename:
      field: json.event.data.last_used_users_mail_association
      tag: rename_event_data_last_used_users_mail_association
      target_field: axonius.network.event.data.last_used_users_mail_association
      ignore_missing: true
  - foreach:
      field: json.event.data.last_used_users_user_manager_association
      tag: foreach_event_data_last_used_users_user_manager_association
      if: ctx.json?.event?.data?.last_used_users_user_manager_association instanceof List
      processor:
        append:
          field: related.user
          tag: append_event_data_last_used_users_user_manager_association_into_related_user
          value: '{{{_ingest._value}}}'
          allow_duplicates: false
  - rename:
      field: json.event.data.last_used_users_user_manager_association
      tag: rename_event_data_last_used_users_user_manager_association
      target_field: axonius.network.event.data.last_used_users_user_manager_association
      ignore_missing: true
  - foreach:
      field: json.event.data.last_used_users_user_manager_mail_association
      tag: foreach_event_data_last_used_users_user_manager_mail_association
      if: ctx.json?.event?.data?.last_used_users_user_manager_mail_association instanceof List
      processor:
        append:
          field: related.user
          tag: append_event_data_last_used_users_user_manager_mail_association_into_related_user
          value: '{{{_ingest._value}}}'
          allow_duplicates: false
  - rename:
      field: json.event.data.last_used_users_user_manager_mail_association
      tag: rename_event_data_last_used_users_user_manager_mail_association
      target_field: axonius.network.event.data.last_used_users_user_manager_mail_association
      ignore_missing: true
  - rename:
      field: json.event.data.last_used_users_user_status_association
      tag: rename_event_data_last_used_users_user_status_association
      target_field: axonius.network.event.data.last_used_users_user_status_association
      ignore_missing: true
  - rename:
      field: json.event.data.last_used_users_user_title_association
      tag: rename_event_data_last_used_users_user_title_association
      target_field: axonius.network.event.data.last_used_users_user_title_association
      ignore_missing: true
  - rename:
      field: json.event.data.latest_used_user
      tag: rename_event_data_latest_used_user
      target_field: axonius.network.event.data.latest_used_user
      ignore_missing: true
  - append:
      field: related.user
      tag: append_network_event_data_latest_used_user_into_related_user
      value: '{{{axonius.network.event.data.latest_used_user}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.latest_used_user != null
  - rename:
      field: json.event.data.latest_used_user_department
      tag: rename_event_data_latest_used_user_department
      target_field: axonius.network.event.data.latest_used_user_department
      ignore_missing: true
  - rename:
      field: json.event.data.latest_used_user_email_domain
      tag: rename_event_data_latest_used_user_email_domain
      target_field: axonius.network.event.data.latest_used_user_email_domain
      ignore_missing: true
  - rename:
      field: json.event.data.latest_used_user_mail
      tag: rename_event_data_latest_used_user_mail
      target_field: axonius.network.event.data.latest_used_user_mail
      ignore_missing: true
  - append:
      field: related.user
      tag: append_network_event_data_latest_used_user_mail_into_related_user
      value: '{{{axonius.network.event.data.latest_used_user_mail}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.latest_used_user_mail != null
  - rename:
      field: json.event.data.latest_used_user_user_manager
      tag: rename_event_data_latest_used_user_user_manager
      target_field: axonius.network.event.data.latest_used_user_user_manager
      ignore_missing: true
  - append:
      field: related.user
      tag: append_network_event_data_latest_used_user_user_manager_into_related_user
      value: '{{{axonius.network.event.data.latest_used_user_user_manager}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.latest_used_user_user_manager != null
  - rename:
      field: json.event.data.latest_used_user_user_status
      tag: rename_event_data_latest_used_user_user_status
      target_field: axonius.network.event.data.latest_used_user_user_status
      ignore_missing: true
  - rename:
      field: json.event.data.latest_used_user_user_title
      tag: rename_event_data_latest_used_user_user_title
      target_field: axonius.network.event.data.latest_used_user_user_title
      ignore_missing: true
  - foreach:
      field: json.event.data.linked_tickets
      tag: foreach_event_data_linked_tickets
      if: ctx.json?.event?.data?.linked_tickets instanceof List
      processor:
        date:
          field: _ingest._value.created
          tag: date_event_data_linked_tickets_created
          target_field: _ingest._value.created
          formats:
            - EEE, dd MMM yyyy HH:mm:ss 'GMT'
            - yyyy-MM-dd
            - EEE,dd MMM yyyy HH:mm:ss 'GMT'
          on_failure:
            - remove:
                field: _ingest._value.created
                ignore_missing: true
  - foreach:
      field: json.event.data.linked_tickets
      tag: foreach_event_data_linked_tickets
      if: ctx.json?.event?.data?.linked_tickets instanceof List
      processor:
        date:
          field: _ingest._value.updated
          tag: date_event_data_linked_tickets_updated
          target_field: _ingest._value.updated
          formats:
            - EEE, dd MMM yyyy HH:mm:ss 'GMT'
            - yyyy-MM-dd
            - EEE,dd MMM yyyy HH:mm:ss 'GMT'
          on_failure:
            - remove:
                field: _ingest._value.updated
                ignore_missing: true
  - rename:
      field: json.event.data.linked_tickets
      tag: rename_event_data_linked_tickets
      target_field: axonius.network.event.data.linked_tickets
      ignore_missing: true
  - rename:
      field: json.event.data.lock
      tag: rename_event_data_lock
      target_field: axonius.network.event.data.lock
      ignore_missing: true
  - rename:
      field: json.event.data.meeting_id
      tag: rename_event_data_meeting_id
      target_field: axonius.network.event.data.meeting_id
      ignore_missing: true
  - rename:
      field: json.event.data.microphone
      tag: rename_event_data_microphone
      target_field: axonius.network.event.data.microphone
      ignore_missing: true
  - foreach:
      field: json.event.data.nat_policy_ips
      tag: foreach_event_data_nat_policy_ips_address
      if: ctx.json?.event?.data?.nat_policy_ips instanceof List
      processor:
        convert:
          field: _ingest._value.address
          tag: convert_event_data_nat_policy_ips_address_to_ip
          type: ip
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.address
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.nat_policy_ips
      tag: foreach_event_data_nat_policy_ips_address
      if: ctx.json?.event?.data?.nat_policy_ips instanceof List
      processor:
        append:
          field: related.ip
          tag: append_event_data_nat_policy_ips_address_into_related_ip
          value: '{{{_ingest._value.address}}}'
          allow_duplicates: false
  - foreach:
      field: json.event.data.nat_policy_ips
      tag: foreach_event_data_nat_policy_ips_rule_num
      if: ctx.json?.event?.data?.nat_policy_ips instanceof List
      processor:
        convert:
          field: _ingest._value.rule_num
          tag: convert_event_data_nat_policy_ips_rule_num_to_long
          type: long
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.rule_num
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.nat_policy_ips
      tag: rename_event_data_nat_policy_ips
      target_field: axonius.network.event.data.nat_policy_ips
      ignore_missing: true
  - rename:
      field: json.event.data.network
      tag: rename_event_data_network
      target_field: axonius.network.event.data.network
      ignore_missing: true
  - foreach:
      field: json.event.data.network_interfaces
      tag: foreach_event_data_network_interfaces_ips
      if: ctx.json?.event?.data?.network_interfaces instanceof List
      processor:
        foreach:
          field: _ingest._value.ips
          tag: foreach_event_data_network_interfaces_ips
          ignore_missing: true
          processor:
            append:
              field: related.ip
              tag: append_event_data_network_interfaces_ips_into_related_ip
              value: '{{{_ingest._value}}}'
              allow_duplicates: false
  - foreach:
      field: json.event.data.network_interfaces
      tag: foreach_event_data_network_interfaces_ips_raw
      if: ctx.json?.event?.data?.network_interfaces instanceof List
      processor:
        foreach:
          field: _ingest._value.ips_raw
          tag: foreach_event_data_network_interfaces_ips_raw
          ignore_missing: true
          processor:
            convert:
              field: _ingest._value
              tag: convert_event_data_network_interfaces_ips_v4_into_long
              type: long
              ignore_missing: true
              on_failure:
                - remove:
                    field: _ingest._value
                    ignore_missing: true
                - append:
                    field: error.message
                    value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.network_interfaces
      tag: foreach_event_data_network_interfaces_ips_v4_raw
      if: ctx.json?.event?.data?.network_interfaces instanceof List
      processor:
        foreach:
          field: _ingest._value.ips_v4_raw
          tag: foreach_event_data_network_interfaces_ips_v4_raw
          ignore_missing: true
          processor:
            convert:
              field: _ingest._value
              tag: convert_event_data_network_interfaces_ips_v4_raw_into_long
              type: long
              ignore_missing: true
              on_failure:
                - remove:
                    field: _ingest._value
                    ignore_missing: true
                - append:
                    field: error.message
                    value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.network_interfaces
      tag: rename_event_data_network_interfaces
      target_field: axonius.network.event.data.network_interfaces
      ignore_missing: true
  - rename:
      field: json.event.data.network_status
      tag: rename_event_data_network_status
      target_field: axonius.network.event.data.network_status
      ignore_missing: true
  - rename:
      field: json.event.data.network_type
      tag: rename_event_data_network_type
      target_field: axonius.network.event.data.network_type
      ignore_missing: true
  - convert:
      field: json.event.data.nexpose_id
      tag: convert_event_data_nexpose_id_into_keyword
      type: string
      target_field: axonius.network.event.data.nexpose_id
      ignore_missing: true
  - rename:
      field: json.event.data.nexpose_type
      tag: rename_event_data_nexpose_type
      target_field: axonius.network.event.data.nexpose_type
      ignore_missing: true
  - rename:
      field: json.event.data.node_id
      tag: rename_event_data_node_id
      target_field: axonius.network.event.data.node_id
      ignore_missing: true
  - rename:
      field: json.event.data.node_name
      tag: rename_event_data_node_name
      target_field: axonius.network.event.data.node_name
      ignore_missing: true
  - foreach:
      field: json.event.data.normalization_reasons
      tag: foreach_event_data_normalization_reasons_calculated_time
      if: ctx.json?.event?.data?.normalization_reasons instanceof List
      processor:
        date:
          field: _ingest._value.calculated_time
          tag: date_event_data_normalization_reasons_calculated_time
          target_field: _ingest._value.calculated_time
          formats:
            - EEE, dd MMM yyyy HH:mm:ss 'GMT'
            - yyyy-MM-dd
            - EEE,dd MMM yyyy HH:mm:ss 'GMT'
          on_failure:
            - remove:
                field: _ingest._value.calculated_time
                ignore_missing: true
  - foreach:
      field: json.event.data.normalization_reasons
      tag: foreach_event_data_normalization_reasons_reason
      if: ctx.json?.event?.data?.normalization_reasons instanceof List
      processor:
        append:
          field: event.reason
          tag: append_event_data_normalization_reasons_reason_into_event_reason
          value: '{{{_ingest._value.reason}}}'
          allow_duplicates: false
  - rename:
      field: json.event.data.normalization_reasons
      tag: rename_event_data_normalization_reasons
      target_field: axonius.network.event.data.normalization_reasons
      ignore_missing: true
  - foreach:
      field: json.event.data.open_ports
      tag: foreach_event_data_open_ports_port_id
      if: ctx.json?.event?.data?.open_ports instanceof List
      processor:
        convert:
          field: _ingest._value.port_id
          tag: convert_event_data_open_ports_port_id_to_keyword
          type: string
          ignore_missing: true
  - rename:
      field: json.event.data.open_ports
      tag: rename_event_data_open_ports
      target_field: axonius.network.event.data.open_ports
      ignore_missing: true
  - rename:
      field: json.event.data.operational_status
      tag: rename_event_data_operational_status
      target_field: axonius.network.event.data.operational_status
      ignore_missing: true
  - rename:
      field: json.event.data.organizational_unit
      tag: event_data_organizational_unit
      target_field: axonius.network.event.data.organizational_unit
      ignore_missing: true
  - rename:
      field: json.event.data.os.codename
      tag: rename_event_data_os_codename
      target_field: axonius.network.event.data.os.codename
      ignore_missing: true
  - rename:
      field: json.event.data.os.distribution
      tag: rename_event_data_os_distribution
      target_field: axonius.network.event.data.os.distribution
      ignore_missing: true
  - rename:
      field: json.event.data.os.distribution_name
      tag: rename_event_data_os_distribution_name
      target_field: axonius.network.event.data.os.distribution_name
      ignore_missing: true
  - set:
      field: host.os.family
      tag: set_host_os_family_from_network_event_data_os_distribution_name
      copy_from: axonius.network.event.data.os.distribution_name
      ignore_empty_value: true
  - lowercase:
      field: host.os.family
      tag: lowercase_host_os_family
      ignore_missing: true
  - date:
      field: json.event.data.os.end_of_life
      tag: date_event_data_os_end_of_life
      target_field: axonius.network.event.data.os.end_of_life
      formats:
        - EEE, dd MMM yyyy HH:mm:ss 'GMT'
        - yyyy-MM-dd
        - EEE,dd MMM yyyy HH:mm:ss 'GMT'
      if: ctx.json?.event?.data?.os?.end_of_life != null && ctx.json.event.data.os.end_of_life != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: json.event.data.os.end_of_support
      tag: date_event_data_os_end_of_support
      target_field: axonius.network.event.data.os.end_of_support
      formats:
        - EEE, dd MMM yyyy HH:mm:ss 'GMT'
        - yyyy-MM-dd
        - EEE,dd MMM yyyy HH:mm:ss 'GMT'
      if: ctx.json?.event?.data?.os?.end_of_support != null && ctx.json.event.data.os.end_of_support != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.os.is_end_of_life
      tag: convert_event_data_os_is_end_of_life_to_boolean
      target_field: axonius.network.event.data.os.is_end_of_life
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.os.is_end_of_support
      tag: convert_event_data_os_is_end_of_support_to_boolean
      target_field: axonius.network.event.data.os.is_end_of_support
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.os.is_latest_os_version
      tag: convert_event_data_os_is_latest_os_version_to_boolean
      target_field: axonius.network.event.data.os.is_latest_os_version
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.os.is_windows_server
      tag: convert_event_data_os_is_windows_server_to_boolean
      target_field: axonius.network.event.data.os.is_windows_server
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.os.latest_os_version
      tag: rename_event_data_os_latest_os_version
      target_field: axonius.network.event.data.os.latest_os_version
      ignore_missing: true
  - set:
      field: host.os.version
      tag: set_host_os_version_from_network_event_data_os_latest_os_version
      copy_from: axonius.network.event.data.os.latest_os_version
      ignore_empty_value: true
  - convert:
      field: json.event.data.os.major
      tag: convert_event_data_os_major_to_long
      target_field: axonius.network.event.data.os.major
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.os.minor
      tag: convert_event_data_os_minor_to_long
      target_field: axonius.network.event.data.os.minor
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.os.os_cpe
      tag: rename_event_data_os_os_cpe
      target_field: axonius.network.event.data.os.os_cpe
      ignore_missing: true
  - convert:
      field: json.event.data.os.os_dotted
      tag: convert_event_data_os_os_dotted_to_keyword
      target_field: axonius.network.event.data.os.os_dotted
      type: string
      ignore_missing: true
  - convert:
      field: json.event.data.os.os_dotted_raw
      tag: convert_event_data_os_os_dotted_raw_to_float
      target_field: axonius.network.event.data.os.os_dotted_raw
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.os.os_str
      tag: rename_event_data_os_os_str
      target_field: axonius.network.event.data.os.os_str
      ignore_missing: true
  - rename:
      field: json.event.data.os.type
      tag: rename_event_data_os_type
      target_field: axonius.network.event.data.os.type
      ignore_missing: true
  - set:
      field: host.os.type
      tag: set_host_os_type_from_network_event_data_os_type
      copy_from: axonius.network.event.data.os.type
      if: >-
        ctx.axonius?.network?.event?.data?.os?.type != null && (
        ctx.axonius.network.event.data.os.type.toLowerCase().contains('linux') ||
        ctx.axonius.network.event.data.os.type.toLowerCase().contains('macos') ||
        ctx.axonius.network.event.data.os.type.toLowerCase().contains('unix') ||
        ctx.axonius.network.event.data.os.type.toLowerCase().contains('windows') ||
        ctx.axonius.network.event.data.os.type.toLowerCase().contains('ios') ||
        ctx.axonius.network.event.data.os.type.toLowerCase().contains('android')
        )
      ignore_empty_value: true
  - lowercase:
      field: host.os.type
      tag: lowercase_host_os_type
      ignore_missing: true
  - rename:
      field: json.event.data.os.type_distribution
      tag: rename_event_data_os_type_distribution
      target_field: axonius.network.event.data.os.type_distribution
      ignore_missing: true
  - set:
      field: host.os.full
      tag: set_host_os_full_from_network_event_data_os_type_distribution
      copy_from: axonius.network.event.data.os.type_distribution
      ignore_empty_value: true
  - foreach:
      field: json.event.data.os_ext_attributes
      tag: foreach_event_data_os_ext_attributes_is_enabled
      if: ctx.json?.event?.data?.os_ext_attributes instanceof List
      processor:
        convert:
          field: _ingest._value.is_enabled
          tag: convert_event_data_os_ext_attributes_is_enabled_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.is_enabled
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.os_ext_attributes
      tag: foreach_event_data_os_ext_attributes_definition_id
      if: ctx.json?.event?.data?.os_ext_attributes instanceof List
      processor:
        convert:
          field: _ingest._value.definition_id
          tag: convert_event_data_os_ext_attributes_definition_id_to_keyword
          type: string
          ignore_missing: true
  - foreach:
      field: json.event.data.os_ext_attributes
      tag: foreach_event_data_os_ext_attributes_is_multivalue
      if: ctx.json?.event?.data?.os_ext_attributes instanceof List
      processor:
        convert:
          field: _ingest._value.is_multivalue
          tag: convert_event_data_os_ext_attributes_is_multivalue_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.is_multivalue
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.os_ext_attributes
      tag: rename_event_data_os_ext_attributes
      target_field: axonius.network.event.data.os_ext_attributes
      ignore_missing: true
  - rename:
      field: json.event.data.owner
      tag: rename_event_data_owner
      target_field: axonius.network.event.data.owner
      ignore_missing: true
  - append:
      field: related.user
      tag: append_network_event_data_owner_into_related_user
      value: '{{{axonius.network.event.data.owner}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.owner != null
  - rename:
      field: json.event.data.paloalto_device_type
      tag: rename_event_data_paloalto_device_type
      target_field: axonius.network.event.data.paloalto_device_type
      ignore_missing: true
  - convert:
      field: json.event.data.part_of_domain
      tag: convert_event_data_part_of_domain_to_boolean
      target_field: axonius.network.event.data.part_of_domain
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.physical_location
      tag: rename_event_data_physical_location
      target_field: axonius.network.event.data.physical_location
      ignore_missing: true
  - convert:
      field: json.event.data.physical_memory_percentage
      tag: convert_event_data_physical_memory_percentage_to_double
      target_field: axonius.network.event.data.physical_memory_percentage
      type: double
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_cve
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        append:
          field: vulnerability.id
          tag: append_event_data_plugin_and_severities_cve_into_vulnerability_id
          value: '{{{_ingest._value.cve}}}'
          allow_duplicates: false
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_cvss_base_score
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.cvss_base_score
          tag: convert_event_data_plugin_and_severities_cvss_base_score_to_float
          type: float
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.cvss_base_score
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_family_id
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.family.id
          tag: convert_event_data_plugin_and_severities_family_id_to_keyword
          type: string
          ignore_missing: true
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_plugin_id
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.plugin_id
          tag: convert_event_data_plugin_and_severities_plugin_id_to_keyword
          type: string
          ignore_missing: true
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_plugin_id_number
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.plugin_id_number
          tag: convert_event_data_plugin_and_severities_plugin_id_number_to_keyword
          type: string
          ignore_missing: true
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_days_seen
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.days_seen
          tag: convert_event_data_plugin_and_severities_days_seen_to_long
          type: long
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.days_seen
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_exploit_available
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.exploit_available
          tag: convert_event_data_plugin_and_severities_exploit_available_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.exploit_available
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_first_found
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        date:
          field: _ingest._value.first_found
          tag: date_event_data_plugin_and_severities_first_found
          target_field: _ingest._value.first_found
          formats:
            - EEE, dd MMM yyyy HH:mm:ss 'GMT'
            - yyyy-MM-dd
            - EEE,dd MMM yyyy HH:mm:ss 'GMT'
          on_failure:
            - remove:
                field: _ingest._value.first_found
                ignore_missing: true
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_first_seen
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        date:
          field: _ingest._value.first_seen
          tag: date_event_data_plugin_and_severities_first_seen
          target_field: _ingest._value.first_seen
          formats:
            - EEE, dd MMM yyyy HH:mm:ss 'GMT'
            - yyyy-MM-dd
            - EEE,dd MMM yyyy HH:mm:ss 'GMT'
          on_failure:
            - remove:
                field: _ingest._value.first_seen
                ignore_missing: true
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_has_been_mitigated
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.has_been_mitigated
          tag: convert_event_data_plugin_and_severities_has_been_mitigated_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.has_been_mitigated
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_has_patch
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.has_patch
          tag: convert_event_data_plugin_and_severities_has_patch_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.has_patch
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_last_fixed
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        date:
          field: _ingest._value.last_fixed
          tag: date_event_data_plugin_and_severities_last_fixed
          target_field: _ingest._value.last_fixed
          formats:
            - EEE, dd MMM yyyy HH:mm:ss 'GMT'
            - yyyy-MM-dd
            - EEE,dd MMM yyyy HH:mm:ss 'GMT'
          on_failure:
            - remove:
                field: _ingest._value.last_fixed
                ignore_missing: true
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_last_found
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        date:
          field: _ingest._value.last_found
          tag: date_event_data_plugin_and_severities_last_found
          target_field: _ingest._value.last_found
          formats:
            - EEE, dd MMM yyyy HH:mm:ss 'GMT'
            - yyyy-MM-dd
            - EEE,dd MMM yyyy HH:mm:ss 'GMT'
          on_failure:
            - remove:
                field: _ingest._value.last_found
                ignore_missing: true
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_last_seen
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        date:
          field: _ingest._value.last_seen
          tag: date_event_data_plugin_and_severities_last_seen
          target_field: _ingest._value.last_seen
          formats:
            - EEE, dd MMM yyyy HH:mm:ss 'GMT'
            - yyyy-MM-dd
            - EEE,dd MMM yyyy HH:mm:ss 'GMT'
          on_failure:
            - remove:
                field: _ingest._value.last_seen
                ignore_missing: true
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_mitigated
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.mitigated
          tag: convert_event_data_plugin_and_severities_mitigated_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.mitigated
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_nessus_instance_display_superseded_patches
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.nessus_instance.display_superseded_patches
          tag: convert_event_data_plugin_and_severities_nessus_instance_display_superseded_patches_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.nessus_instance.display_superseded_patches
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_nessus_instance.plugin_feed_version
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.nessus_instance.plugin_feed_version
          tag: convert_event_data_plugin_and_severities_nessus_instance.plugin_feed_version_to_keyword
          type: string
          ignore_missing: true
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_nessus_instance_experimental_tests
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.nessus_instance.experimental_tests
          tag: convert_event_data_plugin_and_severities_nessus_instance_experimental_tests_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.nessus_instance.experimental_tests
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_nessus_instance_report_verbosity
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.nessus_instance.report_verbosity
          tag: convert_event_data_plugin_and_severities_nessus_instance_report_verbosity_to_long
          type: long
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.nessus_instance.report_verbosity
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_nessus_instance_safe_check
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.nessus_instance.safe_check
          tag: convert_event_data_plugin_and_severities_nessus_instance_safe_check_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.nessus_instance.safe_check
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_nessus_instance_scanner_ip
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.nessus_instance.scanner_ip
          tag: convert_event_data_plugin_and_severities_nessus_instance_scanner_ip_to_ip
          type: ip
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.nessus_instance.scanner_ip
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_nessus_instance_thorough_tests
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.nessus_instance.thorough_tests
          tag: convert_event_data_plugin_and_severities_nessus_instance_thorough_tests_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.nessus_instance.thorough_tests
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_patch_publication_date
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        date:
          field: _ingest._value.patch_publication_date
          tag: date_event_data_plugin_and_severities_patch_publication_date
          target_field: _ingest._value.patch_publication_date
          formats:
            - EEE, dd MMM yyyy HH:mm:ss 'GMT'
            - yyyy-MM-dd
            - EEE,dd MMM yyyy HH:mm:ss 'GMT'
          on_failure:
            - remove:
                field: _ingest._value.patch_publication_date
                ignore_missing: true
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_severity
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        append:
          field: vulnerability.severity
          tag: append_event_data_plugin_and_severities_severity_into_vulnerability_severity
          value: '{{{_ingest._value.severity}}}'
          allow_duplicates: false
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_unsupported_by_vendor
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.unsupported_by_vendor
          tag: convert_event_data_plugin_and_severities_unsupported_by_vendor_to_boolean
          type: boolean
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.unsupported_by_vendor
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: json.event.data.plugin_and_severities
      tag: foreach_event_data_plugin_and_severities_vpr_score
      if: ctx.json?.event?.data?.plugin_and_severities instanceof List
      processor:
        convert:
          field: _ingest._value.vpr_score
          tag: convert_event_data_plugin_and_severities_vpr_score_to_float
          type: float
          ignore_missing: true
          on_failure:
            - remove:
                field: _ingest._value.vpr_score
                ignore_missing: true
            - append:
                field: error.message
                value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: json.event.data.plugin_and_severities
      tag: rename_event_data_plugin_and_severities
      target_field: axonius.network.event.data.plugin_and_severities
      ignore_missing: true
  - rename:
      field: json.event.data.policy_id
      tag: rename_event_data_policy_id
      target_field: axonius.network.event.data.policy_id
      ignore_missing: true
  - rename:
      field: json.event.data.policy_name
      tag: rename_event_data_policy_name
      target_field: axonius.network.event.data.policy_name
      ignore_missing: true
  - rename:
      field: json.event.data.power_state
      tag: rename_event_data_power_state
      target_field: axonius.network.event.data.power_state
      ignore_missing: true
  - rename:
      field: json.event.data.ranger_version
      tag: rename_event_data_ranger_version
      target_field: axonius.network.event.data.ranger_version
      ignore_missing: true
  - rename:
      field: json.event.data.raw_hostname
      tag: rename_event_data_raw_hostname
      target_field: axonius.network.event.data.raw_hostname
      ignore_missing: true
  - append:
      field: related.hosts
      tag: append_network_event_data_raw_hostname_into_related_hosts
      value: '{{{axonius.network.event.data.raw_hostname}}}'
      allow_duplicates: false
      if: ctx.axonius?.network?.event?.data?.raw_hostname != null
  - convert:
      field: json.event.data.read_only
      tag: convert_event_data_read_only_to_boolean
      target_field: axonius.network.event.data.read_only
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: json.event.data.recording
      tag: convert_event_data_recording_to_boolean
      target_field: axonius.network.event.data.recording
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: axonius.network.event.data.cisa_vulnerabilities
      tag: foreach_axonius_network_event_data_cisa_vulnerabilities
      if: ctx.axonius?.network?.event?.data?.cisa_vulnerabilities instanceof List
      processor:
        remove:
          field:
            - _ingest._value.cve_id
            - _ingest._value.desc
          tag: remove_custom_duplicate_fields_from_axonius_network_event_data_cisa_vulnerabilities
          ignore_missing: true
          if: ctx.tags == null || !ctx.tags.contains('preserve_duplicate_custom_fields')
  - foreach:
      field: axonius.network.event.data.normalization_reasons
      tag: foreach_axonius_network_event_data_normalization_reasons
      if: ctx.axonius?.network?.event?.data?.normalization_reasons instanceof List
      processor:
        remove:
          field: _ingest._value.reason
          tag: remove_custom_duplicate_fields_from_axonius_network_event_data_normalization_reasons
          ignore_missing: true
          if: ctx.tags == null || !ctx.tags.contains('preserve_duplicate_custom_fields')
  - foreach:
      field: axonius.network.event.data.plugin_and_severities
      tag: foreach_axonius_network_event_data_plugin_and_severities
      if: ctx.axonius?.network?.event?.data?.plugin_and_severities instanceof List
      processor:
        remove:
          field:
            - _ingest._value.cve
            - _ingest._value.severity
          tag: remove_custom_duplicate_fields_from_axonius_network_event_data_plugin_and_severities
          ignore_missing: true
          if: ctx.tags == null || !ctx.tags.contains('preserve_duplicate_custom_fields')
on_failure:
  - append:
      field: error.message
      value: |-
        Processor '{{{ _ingest.on_failure_processor_type }}}'
        {{{#_ingest.on_failure_processor_tag}}}with tag '{{{ _ingest.on_failure_processor_tag }}}'
        {{{/_ingest.on_failure_processor_tag}}}failed with message '{{{ _ingest.on_failure_message }}}'
  - set:
      field: event.kind
      tag: set_pipeline_error_to_event_kind
      value: pipeline_error
  - append:
      field: tags
      value: preserve_original_event
      allow_duplicates: false
