# Use of "*" to use all namespaces defined.
source:
  index:
    - "logs-ti_flashpoint.indicator-*"
  query:
    bool:
      must_not:
        - exists:
            field: error.message
dest:
  index: "logs-ti_flashpoint_latest.dest_indicator-1"
  aliases:
    - alias: "logs-ti_flashpoint_latest.indicator"
      move_on_creation: true
latest:
  unique_key:
    - event.dataset
    - event.id
  sort: "@timestamp"
description: >-
  Latest indicators from Flashpoint. As indicators get updated, this transform stores only the latest state of each indicator inside the destination index. Thus the transform's destination index contains only the latest state of the indicator.
frequency: 30s
sync:
  time:
    field: event.ingested
    # Updated to 120s because of refresh delay in Serverless. With default 60s,
    # sometimes transform wouldn't process all documents.
    delay: 120s
retention_policy:
  time:
    field: event.ingested
    max_age: 30d
_meta:
  managed: true
  # Bump this version to delete, reinstall, and restart the transform during
  # package installation.
  fleet_transform_version: 0.1.0
