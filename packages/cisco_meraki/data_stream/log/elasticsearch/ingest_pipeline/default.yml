---
description: Pipeline for Cisco Meraki syslog
processors:
- set:
    field: ecs.version
    value: 1.12.0
- rename:
    field: message
    target_field: event.original
- dissect:
    description: Extract syslog words
    field: event.original
    pattern: "%{} %{_temp.ts_nano} %{observer.hostname} %{event.code} %{}"
- grok:
    description: Reduce precision from nanos to millis and set timestamp
    field: _temp.ts_nano
    patterns:
      - '%{TSMILLIS}'
    pattern_definitions:
      TSMILLIS: (?<_temp.ts_millis>\d{1,10}\.\d{1,6})(?:\d{3})
- date:
    field: _temp.ts_millis
    formats:
      - UNIX
    timezone: '{{{_conf.tz_offset}}}'
- pipeline:
    name: '{{ IngestPipeline "flows" }}'
    if: ctx.event.code == 'flows'
- remove:
    field:
      - _temp
      - _conf
      - sport
      - dport
      - mac
    ignore_missing: true
on_failure:
- set:
    field: error.message
    value: '{{ _ingest.on_failure_message }}'
