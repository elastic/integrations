- name: tenable_io.vulnerability
  type: group
  fields:
    - name: asset
      type: group
      fields:
        - name: agent_uuid
          type: keyword
          description: The UUID of the agent that performed the scan where the vulnerability was found.
        - name: bios_uuid
          type: keyword
          description: The BIOS UUID of the asset where the vulnerability was found.
        - name: device_type
          type: keyword
          description: The type of asset where the vulnerability was found.
        - name: fqdn
          type: keyword
          description: The fully-qualified domain name of the asset where a scan found the vulnerability.
        - name: hostname
          type: keyword
          description: The host name of the asset where a scan found the vulnerability.
        - name: ip_address
          type: keyword
        - name: ipv4
          type: ip
          description: The IPv4 address of the asset where a scan found the vulnerability.
        - name: ipv6
          type: ip
          description: The IPv6 address of the asset where a scan found the vulnerability.
        - name: last_authenticated_results
          type: date
          description: The last date credentials were used successfully to scan the asset.
        - name: last_unauthenticated_results
          type: date
          description: The last date when the asset was scanned without using credentials
        - name: mac_address
          type: keyword
          description: The MAC address of the asset where a scan found the vulnerability.
        - name: netbios
          type: group
          fields:
            - name: name
              type: keyword
              description: The NETBIOS name of the asset where a scan found the vulnerability.
            - name: workgroup
              type: keyword
              description: The NETBIOS workgroup of the asset where a scan found the vulnerability.
        - name: network_id
          type: keyword
          description: The ID of the network object associated with scanners that identified the asset. The default network ID is 00000000-0000-0000-0000-000000000000
        - name: operating_system
          type: keyword
          description: The operating system of the asset where a scan found the vulnerability.
        - name: tracked
          type: boolean
          description: A value specifying whether Tenable Vulnerability Management tracks the asset in the asset management system. Tenable Vulnerability Management still assigns untracked assets identifiers in scan results, but these identifiers change with each new scan of the asset. This parameter is relevant to PCI-type scans and in certain cases where there is not enough information in a scan to identify the asset. Untracked assets appear in the scan history, but do not appear in workbenches or reports.
        - name: uuid
          type: keyword
          description: The UUID of the asset where a scan found the vulnerability.
    - name: first_found
      type: date
      description: The ISO date when a scan first detected the vulnerability on the asset.
    - name: indexed
      type: date
      description: The date and time (in Unix time) when the vulnerability was indexed into Tenable Vulnerability Management.
    - name: last_fixed
      type: date
      description: The ISO date when a scan no longer detects the previously detected vulnerability on the asset.
    - name: last_found
      type: date
      description: The ISO date when a scan last detected the vulnerability on the asset.
    - name: output
      type: keyword
      description: The text output of the Nessus scanner.
    - name: package_nested
      type: nested
    - name: package_nested.fixed_version
      type: keyword
    - name: package_nested.name
      type: keyword
    - name: package_nested.path
      type: keyword
    - name: package_nested.version
      type: keyword
    - name: plugin
      type: group
      fields:
        - name: always_run
          type: boolean
        - name: bid
          type: long
          description: The Bugtraq ID for the plugin.
        - name: canvas_package
          type: keyword
          description: The name of the CANVAS exploit pack that includes the vulnerability.
        - name: checks_for_default_account
          type: boolean
          description: A value specifying whether the plugin checks for default accounts.
        - name: checks_for_malware
          type: boolean
          description: A value specifying whether the plugin checks for malware.
        - name: compliance
          type: boolean
        - name: cpe
          type: keyword
          description: The Common Platform Enumeration (CPE) number for the plugin.
        - name: cve
          type: keyword
          description: The Common Vulnerability and Exposure (CVE) ID for the plugin.
        - name: cvss
          type: group
          fields:
            - name: base_score
              type: double
              description: The CVSSv2 base score (intrinsic and fundamental characteristics of a vulnerability that are constant over time and user environments)
            - name: temporal
              type: group
              fields:
                - name: score
                  type: double
                  description: The CVSSv2 temporal score (characteristics of a vulnerability that change over time but not among user environments).
                - name: vector
                  type: group
                  fields:
                    - name: exploitability
                      type: keyword
                      description: "The CVSSv2 Exploitability (E) temporal metric for the vulnerability the plugin covers. Possible values include: U, POC, F, H  and ND."
                    - name: raw
                      type: keyword
                      description: The complete cvss_temporal_vector metrics and result values for the vulnerability the plugin covers in a condensed and coded format. For example, E:U/RL:OF/RC:C.
                    - name: remediation_level
                      type: keyword
                      description: "The CVSSv2 Remediation Level (RL) temporal metric for the vulnerability the plugin covers. Possible values include: OF, TF ,W, U and ND."
                    - name: report_confidence
                      type: keyword
                      description: "The CVSSv2 Report Confidence (RC) temporal metric for the vulnerability the plugin covers. Possible values include:  UC, UR, C and ND."
            - name: vector
              type: group
              fields:
                - name: access
                  type: group
                  fields:
                    - name: complexity
                      type: keyword
                      description: "The CVSSv2 Access Complexity (AC) metric for the vulnerability the plugin covers. Possible values include: H, M and  L."
                    - name: vector
                      type: keyword
                      description: "The CVSSv2 Access Vector (AV) metric for the vulnerability the plugin covers. Possible values include: L,A and N."
                - name: authentication
                  type: keyword
                  description: The CVSSv2 Authentication (Au) metric for the vulnerability the plugin covers. Possible values include N, S and M.
                - name: availability_impact
                  type: keyword
                  description: The CVSSv2 availability impact metric for the vulnerability the plugin covers. Possible values include N, P and C.
                - name: confidentiality_impact
                  type: keyword
                  description: "The CVSSv2 confidentiality impact metric for the vulnerability the plugin covers. Possible values include: N, P and C."
                - name: integrity_impact
                  type: keyword
                  description: "The CVSSv2 integrity impact metric for the vulnerability the plugin covers. Possible values include: N, P and C."
                - name: raw
                  type: keyword
                  description: The complete cvss_vector metrics and result values for the vulnerability the plugin covers in a condensed and coded format. For example, AV:N/AC:M/Au:N/C:C/I:C/A:C.
        - name: cvss3
          type: group
          fields:
            - name: base_score
              type: double
              description: The CVSSv3 base score (intrinsic and fundamental characteristics of a vulnerability that are constant over time and user environments).
            - name: temporal
              type: group
              fields:
                - name: score
                  type: double
                  description: The CVSSv3 temporal score (characteristics of a vulnerability that change over time but not among user environments).
                - name: vector
                  type: group
                  fields:
                    - name: exploit_code_maturity
                      type: keyword
                    - name: exploitability
                      type: keyword
                      description: "The CVSSv3 Exploit Maturity Code (E) for the vulnerability the plugin covers. Possible values include: Unproven, Proof-of-concept, Functional, High and Not-defined."
                    - name: raw
                      type: keyword
                      description: The complete cvss3_temporal_vector metrics and result values for the vulnerability the plugin covers in a condensed and coded format. For example, E:U/RL:OF/RC:C.
                    - name: remediation_level
                      type: keyword
                      description: The CVSSv3 Remediation Level (RL) temporal metric for the vulnerability the plugin covers. Possible values include:O, T, W, U, X.
                    - name: report_confidence
                      type: keyword
                      description: "The CVSSv3 Report Confidence (RC) temporal metric for the vulnerability the plugin covers. Possible values include: U R, C, X."
            - name: vector
              type: group
              fields:
                - name: access
                  type: group
                  fields:
                    - name: complexity
                      type: keyword
                      description: "The CVSSv3 Access Complexity (AC) metric for the vulnerability the plugin covers. Possible values include: H, M, L."
                    - name: vector
                      type: keyword
                      description: "The CVSSv2 Attack Vector (AV) metric for the vulnerability the plugin covers. Possible values include: Network ,Adjacent Network, Local."
                - name: attack
                  type: group
                  fields:
                    - name: complexity
                      type: keyword
                    - name: vector
                      type: keyword
                - name: authentication
                  type: keyword
                  description: "The CVSSv2 Authentication (Au) metric for the vulnerability the plugin covers. Possible values include: None required, Requires-single-instance, Requires-multiple-instances."
                - name: availability_impact
                  type: keyword
                  description: "The CVSSv2 availability impact metric for the vulnerability the plugin covers. Possible values include: H, M, L."
                - name: confidentiality_impact
                  type: keyword
                  description: "The CVSSv3 confidentiality impact metric of the vulnerability the plugin covers to the vulnerable component. Possible values include: H, M, L."
                - name: integrity_impact
                  type: keyword
                  description: "The CVSSv3 integrity impact metric for the vulnerability the plugin covers. Possible values include: H. M, L."
                - name: privileges_required
                  type: keyword
                - name: raw
                  type: keyword
                  description: The complete cvss3_vector metrics and result values for the vulnerability the plugin covers in a condensed and coded format. For example, AV:N/AC:M/Au:N/C:C/I:C/A:C.
                - name: scope
                  type: keyword
                - name: user_interaction
                  type: keyword
        - name: cvss4
          type: group
          fields:
            - name: base_score
              type: double
              description: The CVSS version 4 (CVSSv4) base score, representing the intrinsic and fundamental characteristics of a vulnerability that remain constant over time and across different user environments. The score ranges from 0 to 10, with higher values indicating greater severity.
            - name: threat_vector
              type: group
              fields:
                - name: threat_score
                  type: double
                - name: exploit_maturity
                  type: keyword
                  description: The CVSS v4.0 Exploit Maturity (E) metric, indicating the current development status of exploit techniques or code for the vulnerability.
                - name: raw
                  type: keyword
                  description: The complete cvss4_threat_vector metrics and their result values for the vulnerability, expressed as a concise, coded string. This threat vector is typically appended to the CVSSv4 Base vector. For example, CVSS:4.0/E:U.
            - name: vector
              type: group
              fields:
                - name: attack_vector
                  type: keyword
                  description: The CVSSv4 Attack Vector (AV) metric, which describes the context by which the vulnerability can be exploited.
                - name: attack_complexity
                  type: keyword
                  description: The CVSSv4 Attack Complexity (AC) metric, which indicates the conditions beyond the attacker's control that must exist to exploit the vulnerability.
                - name: attack_requirements
                  type: keyword
                  description: The CVSSv4 Attack Requirements (AR) metric specifies prerequisite conditions of the vulnerable component that must be met for an attack to succeed.
                - name: privileges_required
                  type: keyword
                  description: The CVSSv4 Privileges Required (PR) metric indicates the level of privileges an attacker must have to successfully exploit the vulnerability.
                - name: user_interaction
                  type: keyword
                  description: The CVSSv4 User Interaction (UI) metric describes the level of user interaction required for an attack to succeed.
                - name: vulnerable_system_confidentiality
                  type: keyword
                  description: The CVSSv4 Vulnerable System Confidentiality (VC) metric measures the impact on the confidentiality of information on the vulnerable system.
                - name: vulnerable_system_integrity
                  type: keyword
                  description: The CVSSv4 Vulnerable System Integrity (VI) metric measures the impact on the integrity of information on the vulnerable system.
                - name: vulnerable_system_availability
                  type: keyword
                  description: The CVSSv4 Vulnerable System Availability (VA) metric measures the impact on the availability of the vulnerable system.
                - name: subsequent_system_confidentiality
                  type: keyword
                  description: The CVSSv4 Subsequent System Confidentiality (SC) metric measures the impact on the confidentiality of information on systems subsequent to the vulnerable component.
                - name: subsequent_system_integrity
                  type: keyword
                  description: The CVSSv4 Subsequent System Integrity (SI) metric measures the impact on the integrity of information on systems subsequent to the vulnerable component.
                - name: subsequent_system_availability
                  type: keyword
                  description: The CVSSv4 Subsequent System Availability (SA) metric measures the impact on the availability of systems subsequent to the vulnerable component.
                - name: raw
                  type: keyword
                  description: The complete CVSSv4 Base vector string representing all metric values in a compact, standardized format. This includes metrics such as Attack Vector, Attack Complexity, Privileges Required, and others. For example, AV:N/AC:L/AT:P/PR:H/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:H.
        - name: d2_elliot_name
          type: keyword
          description: The name of the exploit in the D2 Elliot Web Exploitation framework.
        - name: description
          type: text
          description: Full text description of the vulnerability plugin.
        - name: epss_score
          type: double
          description: The Exploit Prediction Scoring System (EPSS) score estimates the likelihood (as a percentage) that a software vulnerability will be exploited in the wild within the next 30 days. The score ranges from 0 to 100, with higher values indicating a greater probability of exploitation.
        - name: exploit_available
          type: boolean
          description: A value specifying whether a public exploit exists for the vulnerability.
        - name: exploit_framework
          type: group
          fields:
            - name: canvas
              type: boolean
              description: A value specifying whether an exploit exists in the Immunity CANVAS framework.
            - name: core
              type: boolean
              description: A value specifying whether an exploit exists in the CORE Impact framework.
            - name: d2_elliot
              type: boolean
              description: A value specifying whether an exploit exists in the D2 Elliot Web Exploitation framework.
            - name: hub
              type: boolean
              description: A value specifying whether an exploit exists in the ExploitHub framework.
            - name: metasploit
              type: boolean
              description: A value specifying whether an exploit exists in the Metasploit framework.
        - name: exploitability_ease
          type: keyword
          description: Description of how easy it is to exploit the issue.
        - name: exploited_by
          type: group
          fields:
            - name: malware
              type: boolean
              description: The vulnerability discovered by this plugin is known to be exploited by malware.
            - name: nessus
              type: boolean
              description: A value specifying whether Nessus exploited the vulnerability during the process of identification.
        - name: exploithub_sku
          type: keyword
          description: The SKU number of the exploit in the ExploitHub framework.
        - name: family
          type: keyword
          description: The family to which plugin belongs.
        - name: family_id
          type: long
          description: The ID of the plugin family.
        - name: has_patch
          type: boolean
          description: A value specifying whether the vendor has published a patch for the vulnerability.
        - name: id
          type: long
          description: The ID of the plugin that identified the vulnerability.
        - name: in_the_news
          type: boolean
          description: A value specifying whether this plugin has received media attention (for example, ShellShock, Meltdown).
        - name: intel_type
          type: keyword
        - name: io_address
          type: keyword
        - name: metasploit_name
          type: keyword
          description: The name of the related exploit in the Metasploit framework.
        - name: modification_date
          type: date
          description: The date on which the plugin was last modified.
        - name: ms_bulletin
          type: keyword
          description: The Microsoft security bulletin that the plugin covers.
        - name: name
          type: keyword
          description: The name of the plugin that identified the vulnerability.
        - name: patch_publication_date
          type: date
          description: The date on which the vendor published a patch for the vulnerability.
        - name: plugin_modification_date
          type: date
        - name: plugin_publication_date
          type: date
        - name: publication_date
          type: date
          description: The date on which the plugin was published.
        - name: risk_factor
          type: keyword
          description: "The risk factor associated with the plugin. Possible values are: Low, Medium, High, or Critical."
        - name: see_also
          type: keyword
          description: Links to external websites that contain helpful information about the vulnerability.
        - name: solution
          type: keyword
          description: Remediation information for the vulnerability.
        - name: stig_severity
          type: keyword
          description: Security Technical Implementation Guide (STIG) severity code for the vulnerability.
        - name: synopsis
          type: keyword
          description: Brief description of the plugin or vulnerability.
        - name: type
          type: keyword
          description: The general type of plugin check (for example, local or remote).
        - name: unsupported_by_vendor
          type: boolean
          description: Software found by this plugin is unsupported by the software's vendor (for example, Windows 95 or Firefox 3).
        - name: usn
          type: keyword
          description: Ubuntu security notice that the plugin covers.
        - name: version
          type: version
          description: The version of the plugin used to perform the check.
        - name: vpr
          type: group
          fields:
            - name: drivers
              type: group
              fields:
                - name: age_of_vuln
                  type: group
                  fields:
                    - name: lower_bound
                      type: long
                      description: The lower bound of the range. For example, for the 0-7 days range, this attribute is "0". For the highest range (more than 730 days), this value is "731".
                    - name: upper_bound
                      type: long
                      description: The upper bound of the range. For example, for the 0-7 days range, this attribute is "7". For the highest range (more than 730 days), this value is "0", which signifies that there is no higher category.
                - name: cvss_impact_score_predicted
                  type: boolean
                  description: A value specifying whether Tenable predicted the CVSSv3 impact score for the vulnerability because NVD did not provide one (true) or used the NVD-provided CVSSv3 impact score (false) when calculating the VPR.
                - name: cvss3_impact_score
                  type: double
                  description: The NVD-provided CVSSv3 impact score for the vulnerability. If the NVD did not provide a score, Tenable Vulnerability Management displays a Tenable-predicted score.
                - name: exploit_code_maturity
                  type: keyword
                  description: The relative maturity of a possible exploit for the vulnerability based on the existence, sophistication, and prevalence of exploit intelligence from internal and external sources (for example, Reversinglabs, Exploit-db, Metasploit, etc.). The possible values ('High', 'Functional', 'PoC', or 'Unproven') parallel the CVSS Exploit Code Maturity categories.
                - name: product_coverage
                  type: keyword
                  description: "The relative number of unique products affected by the vulnerability: 'Low', 'Medium', 'High', or 'Very High'."
                - name: threat_intensity_last28
                  type: keyword
                  description: "The relative intensity based on the number and frequency of recently observed threat events related to this vulnerability: Very Low, Low, Medium, High, or Very High."
                - name: threat_recency
                  type: group
                  fields:
                    - name: lower_bound
                      type: long
                      description: The lower bound of the range. For example, for the 0-7 days range, this attribute is "0". For the highest range (more than 365 days), this value is "366".
                    - name: upper_bound
                      type: long
                      description: The upper bound of the range. For example, for the 0-7 days range, this attribute is "7". For the highest range (more than 730 days), this value is "0", which signifies that there is no higher category.
                - name: threat_sources_last28
                  type: keyword
                  description: "A list of all sources (for example, social media channels, the dark web, etc.) where threat events related to this vulnerability occurred. Item type: string."
            - name: score
              type: double
              description: The Vulnerability Priority Rating (VPR) for the vulnerability. If a plugin is designed to detect multiple vulnerabilities, the VPR represents the highest value calculated for a vulnerability associated with the plugin.
            - name: updated
              type: date
              description: The ISO timestamp when Tenable Vulnerability Management last imported the VPR for this vulnerability. Tenable Vulnerability Management imports updated VPR values every time you run a scan.
        - name: vpr_v2
          type: group
          fields:
            - name: score
              type: double
              description: The Vulnerability Priority Rating (VPR) version 2 score assigned to the vulnerability. This enhanced version is labeled VPR (Beta) in the user interface. If a plugin detects multiple vulnerabilities, this score reflects the highest VPR among them.
            - name: vpr_percentile
              type: double
              description: The percentile ranking of the Vulnerability Priority Rating (VPR) v2 score, indicating how the vulnerability compares in severity to all other scored vulnerabilities.
            - name: vpr_severity
              type: keyword
              description: The severity level associated with the Vulnerability Priority Rating (VPR) v2 score. This label reflects the relative risk of the vulnerability based on its VPR score.
            - name: exploit_probability
              type: double
              description: The likelihood (as a decimal value between 0 and 1) that this vulnerability will be exploited in the wild, as determined by the VPR v2 model. This value contributes to the overall VPR score and reflects real-world exploit potential based on threat intelligence and predictive analytics.
            - name: cve_id
              type: keyword
              description: The Common Vulnerability and Exposure (CVE) identifier associated with the vulnerability that the Vulnerability Priority Rating (VPR) V2 score is based on. This standardized identifier allows for consistent reference across security tools and databases.
            - name: exploit_code_maturity
              type: keyword
              description: The maturity level of publicly available exploit code for the vulnerability, as factored into the Vulnerability Priority Rating (VPR) V2. This metric helps assess how likely it is for the vulnerability to be actively exploited.
            - name: on_cisa_kev
              type: boolean
              description: Indicates whether the vulnerability is listed in the Cybersecurity and Infrastructure Security Agency's (CISA) Known Exploited Vulnerabilities (KEV) catalog. Presence on the KEV list highlights critical vulnerabilities that are actively exploited and prioritized for remediation.
            - name: exploit_chain
              type: keyword
              description: A list of Common Vulnerability and Exposure (CVE) identifiers representing vulnerabilities that are part of an exploit chain involving this vulnerability.
            - name: in_the_news_intensity_last30
              type: keyword
              description: Indicates the frequency and prominence of news coverage related to this vulnerability over the past 30 days. This metric reflects the level of public and media attention, which can correlate with increased exploitability and urgency for remediation.
            - name: in_the_news_recency
              type: keyword
              description: Indicates how recently this vulnerability has appeared in news coverage or public discussions. A more recent mention suggests increased current attention and potential exploitation risk.
            - name: in_the_news_sources_last30
              type: keyword
              description: A list of source categories from trending vulnerability data where this CVE has been mentioned in the past 30 days.
            - name: malware_observations_intensity_last30
              type: keyword
              description: The intensity level of malware observations related to this vulnerability in the past 30 days. This metric reflects how actively malware exploiting this vulnerability has been detected during that period.
            - name: malware_observations_recency
              type: keyword
              description: Indicates how recently malware exploiting this vulnerability has been observed. This value reflects the freshness of malware activity related to the vulnerability.
            - name: targeted_industries
              type: keyword
              description: A list of industries that have been targeted for exploitation via this CVE.
            - name: targeted_regions
              type: keyword
              description: A list of geographic regions where this CVE has been targeted for exploitation.
            - name: threat_summary
              type: flattened
              description: Summary information about the threat posed by the vulnerability, including relevant details that contribute to its Vulnerability Priority Rating (VPR) v2 score.
            - name: remediation
              type: flattened
              description: Information and recommended actions for mitigating or resolving the vulnerability. This may include patches, configuration changes, or other remediation guidance.
        - name: vuln_publication_date
          type: date
          description: The publication date of the plugin.
        - name: xref
          type: group
          fields:
            - name: id
              type: keyword
            - name: type
              type: keyword
        - name: xrefs
          type: group
          description: References to third-party information about the vulnerability, exploit, or update associated with the plugin. Each reference includes a type and an ID. For example, "FEDORA" and "2003-047".
          fields:
            - name: id
              type: keyword
            - name: type
              type: keyword
    - name: port
      type: group
      fields:
        - name: protocol
          type: keyword
          description: The protocol the scanner used to communicate with the asset.
        - name: service
          type: keyword
          description: The service the scanner used to communicate with the asset.
        - name: value
          type: long
          description: The port the scanner used to communicate with the asset.
    - name: recast
      type: group
      fields:
        - name: reason
          type: keyword
          description: The text that appears in the Comment field of the recast rule in the Tenable Vulnerability Management user interface.
        - name: rule_uuid
          type: keyword
          description: The UUID of the recast rule that applies to the plugin.
    - name: scan
      type: group
      fields:
        - name: completed_at
          type: date
          description: The ISO timestamp when the scan completed.
        - name: schedule_uuid
          type: keyword
          description: The schedule UUID for the scan that found the vulnerability.
        - name: started_at
          type: date
          description: The ISO timestamp when the scan started.
        - name: uuid
          type: keyword
          description: The UUID of the scan that found the vulnerability.
    - name: severity
      type: group
      fields:
        - name: default_id
          type: long
          description: The code for the severity originally assigned to a vulnerability before a user recast the risk associated with the vulnerability. Possible values are the same as for the severity_id attribute.
        - name: id
          type: long
          description: "The code for the severity assigned when a user recast the risk associated with the vulnerability. Possible values include: 0,1,2,3 and 4."
        - name: modification_type
          type: keyword
          description: "The type of modification a user made to the vulnerability's severity. Possible values include:none, recasted and accepted."
        - name: value
          type: keyword
          description: The severity of the vulnerability as defined using the Common Vulnerability Scoring System (CVSS) base score. Possible values include info, low, medium, high and critical.
    - name: state
      type: keyword
      description: "The state of the vulnerability as determined by the Tenable Vulnerability Management state service. Possible values include: open, reopen and fixed."
    - name: source
      type: keyword
      description: The source of the scans that identified the vulnerability. Sources can include sensors, connectors, and API imports. The values in the source field correspond to the names of the sources as defined in your organization's implementation of Tenable Vulnerability Management.
