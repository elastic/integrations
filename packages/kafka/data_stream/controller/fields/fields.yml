- name: kafka.controller
  type: group
  description: >
    Kafka controller metrics.
  fields:
    - name: metric_fingerprint
      type: keyword
      dimension: true
      description: >
        A fingerprint of the metric path.
        
    - name: controller_event_manager
      type: group
      description: Kafka controller event manager metrics.
      fields:
        - name: event_queue_processing_time_ms
          type: group
          description: Time in milliseconds to process events from the event queue.
          fields:
            - name: min
              type: double
              format: duration
              unit: ms
              metric_type: gauge
              description: Minimum time in milliseconds to process events from the event queue.
            - name: max
              type: double
              format: duration
              unit: ms
              metric_type: gauge
              description: Maximum time in milliseconds to process events from the event queue.
            - name: p95
              type: double
              format: duration
              unit: ms
              metric_type: gauge
              description: 95th percentile of time in milliseconds to process events from the event queue.
            - name: p99
              type: double
              format: duration
              unit: ms
              metric_type: gauge
              description: 99th percentile of time in milliseconds to process events from the event queue.

        - name: event_queue_time_ms
          type: group
          description: Time in milliseconds for an event to wait in the event queue.
          fields:
            - name: min
              type: double
              format: duration
              unit: ms
              metric_type: gauge
              description: Minimum time in milliseconds for an event to wait in the event queue.
            - name: max
              type: double
              format: duration
              unit: ms
              metric_type: gauge
              description: Maximum time in milliseconds for an event to wait in the event queue.
            - name: p95
              type: double
              format: duration
              unit: ms
              metric_type: gauge
              description: 95th percentile of time in milliseconds for an event to wait in the event queue.
            - name: p99
              type: double
              format: duration
              unit: ms
              metric_type: gauge
              description: 99th percentile of time in milliseconds for an event to wait in the event queue.

    - name: kafka_controller
      type: group
      description: Kafka controller metrics.
      fields:
        - name: active_broker_count
          type: long
          metric_type: gauge
          description: Number of active brokers in the cluster.
        - name: active_controller_count
          type: long
          metric_type: gauge
          description: Number of active controllers in the cluster (should be 1).
        - name: event_queue_operations_started_count
          type: long
          metric_type: counter
          description: Number of event queue operations that have been started.
        - name: event_queue_operations_timed_out_count
          type: long
          metric_type: counter
          description: Number of event queue operations that have timed out.
        - name: fenced_broker_count
          type: long
          metric_type: gauge
          description: Number of brokers that have been fenced.
        - name: global_partition_count
          type: long
          metric_type: gauge
          description: Total number of partitions in the cluster.
        - name: global_topic_count
          type: long
          metric_type: gauge
          description: Total number of topics in the cluster.
        - name: last_applied_record_lag_ms
          type: long
          format: duration
          unit: ms
          metric_type: gauge
          description: Lag in milliseconds between the last record that was applied and the current time.
        - name: last_applied_record_offset
          type: long
          metric_type: gauge
          description: Offset of the last record that was applied.
        - name: last_applied_record_timestamp
          type: date
          description: Timestamp of the last record that was applied in ISO8601 format.
        - name: last_committed_record_offset
          type: long
          metric_type: gauge
          description: Offset of the last committed record.
        - name: metadata_error_count
          type: long
          metric_type: counter
          description: Number of metadata errors that have occurred.
        - name: new_active_controllers_count
          type: long
          metric_type: counter
          description: Number of new active controllers that have been elected.
        - name: offline_partitions_count
          type: long
          metric_type: gauge
          description: Number of partitions that are offline.
        - name: preferred_replica_imbalance_count
          type: long
          metric_type: gauge
          description: Number of partitions that have a preferred replica imbalance.
        - name: timed_out_broker_heartbeat_count
          type: long
          metric_type: counter
          description: Number of broker heartbeats that have timed out.