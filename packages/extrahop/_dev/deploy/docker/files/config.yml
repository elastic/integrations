rules:
  - path: /oauth2/token
    methods: ['POST']
    query_params:
      grant_type: client_credentials
      client_id: xxxx
      client_secret: xxxx
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |
          {"access_token":"xxxx","expires_in":600,"token_type":"Bearer"}
  - path: /api/v1/investigations/search
    methods: ['POST']
    request_body: '{}'
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          [
            {
              "id": 3,
              "notes": "Investigate Internally with AD logs",
              "status": "closed",
              "creation_time": 1747825693321,
              "update_time": 1747825693321,
              "last_interaction_time": 1748613881434,
              "name": "BloodHound Enumeration Investigation",
              "assessment": "benign_true_positive",
              "created_by": "integration@example.com",
              "assignee": "user1",
              "last_interaction_by": "user1",
              "description": "This investigation focuses on potential enumeration behavior observed through BloodHound. Review AD logs and user group mappings to verify intent and exposure.",
              "investigation_types": [
                "Active Directory",
                "Threat Hunting"
              ],
              "is_user_created": true,
              "start_time": 1747825693321,
              "end_time": 1748613881434,
              "detections": [
                25769803958
              ],
              "url": "https://example.com/#/detections/investigations/3"
            },
            {
              "id": 4,
              "notes": "Investigate Internally",
              "status": "open",
              "creation_time": 1747825693321,
              "update_time": 1747825693321,
              "last_interaction_time": 1748613881434,
              "name": "Investigation name 1",
              "assessment": "false_positive",
              "created_by": "abc@example.com",
              "assignee": "john.doe",
              "last_interaction_by": "tom.latham",
              "description": "This is investigation description.",
              "investigation_types": [
                "Threat Hunting"
              ],
              "is_user_created": false,
              "start_time": null,
              "end_time": null,
              "detections": [
                25769803958
              ],
              "url": "https://example.com/#/detections/investigations/4"
            },
            {
              "id": 54,
              "notes": null,
              "status": "open",
              "creation_time": 1752476957453,
              "update_time": 1752476957453,
              "last_interaction_time": 1752476957453,
              "name": "Investigation_Name_46",
              "assessment": "benign_true_positive",
              "created_by": "rest_api_id_1njj2",
              "assignee": "user_46",
              "last_interaction_by": "rest_api_id_1njj2",
              "description": "This is test description",
              "investigation_types": null,
              "is_user_created": true,
              "start_time": null,
              "end_time": null,
              "detections": [
                null
              ],
              "url": "https://example.com/#/detections/investigations/54"
            },
            {
              "id": 206,
              "notes": null,
              "status": "closed",
              "creation_time": 1752477002849,
              "update_time": 1752477002849,
              "last_interaction_time": 1752477002849,
              "name": "Investigation_Name_198",
              "assessment": "benign_true_positive",
              "created_by": "rest_api_id_1njj2",
              "assignee": "user_198",
              "last_interaction_by": "rest_api_id_1njj2",
              "description": "This is user 198",
              "investigation_types": null,
              "is_user_created": true,
              "start_time": null,
              "end_time": null,
              "detections": [
                null
              ],
              "url": "https://example.com/#/detections/investigations/206"
            },
            {
              "id": 10,
              "notes": "Investigate Internally logs",
              "status": "open",
              "creation_time": 1747825693321,
              "update_time": 1747825693321,
              "last_interaction_time": 1748613881434,
              "name": "Enumeration Investigation",
              "assessment": "undecided",
              "created_by": "tom@example.com",
              "assignee": "user2",
              "last_interaction_by": "user2",
              "description": "This investigation observed through Integration.",
              "investigation_types": [
                "Active Directory"
              ],
              "is_user_created": false,
              "start_time": 1747825693321,
              "end_time": 1748613881434,
              "detections": [
                25769803958
              ],
              "url": "https://example.com/#/detections/investigations/10"
            }
          ]
          `}}
