rules:
  - path: /rest/plugin
    methods: [GET]
    request_headers:
      x-apikey: accesskey=some_access_key; secretkey=some_secret_key
    query_params:
      fields: id,name,description,family,type,copyright,version,sourceFile,dependencies,requiredPorts,requiredUDPPorts,cpe,srcPort,dstPort,protocol,riskFactor,solution,seeAlso,synopsis,checkType,exploitEase,exploitAvailable,exploitFrameworks,cvssVector,cvssVectorBF,baseScore,temporalScore,cvssV3Vector,cvssV3VectorBF,cvssV3BaseScore,cvssV3TemporalScore,vprScore,vprContext,stigSeverity,pluginPubDate,pluginModDate,patchPubDate,patchModDate,vulnPubDate,modifiedTime,md5,xrefs
      filterField: pluginModDate
      op: gt
      startOffset: 0
      endOffset: 1000
      sortField: modifiedTime
      sortDirection: ASC
    responses:
      - status_code: 200
        body: |
          {"type":"regular","response":[{"id":"10585","name":"Microsoft IIS Frontpage Server Extensions (FPSE) Malformed Form DoS","description":"Microsoft IIS, running Frontpage extensions, is vulnerable to a remote denial of service attack usually called the 'malformed web submission' vulnerability.  An attacker, exploiting this vulnerability, will be able to render the service unusable.\n\nIf this machine serves a business-critical function, there could be an impact to the business.","type":"active","copyright":"This script is Copyright (C) 2003-2020 John Lampe","version":"1.28","sourceFile":"IIS_frontpage_DOS_2.nasl","dependencies":"find_service1.nasl,http_version.nasl,www_fingerprinting_hmap.nasl","requiredPorts":"","requiredUDPPorts":"","cpe":"","srcPort":null,"dstPort":null,"protocol":"","riskFactor":"High","solution":"Microsoft has released a set of patches for IIS 4.0 and 5.0.","seeAlso":"https:\/\/docs.microsoft.com\/en-us\/security-updates\/SecurityBulletins\/2000\/ms00-100","synopsis":"The remote web server is vulnerable to a denial of service","checkType":"remote","exploitEase":"No known exploits are available","exploitAvailable":"false","exploitFrameworks":"","cvssVector":"AV:N\/AC:L\/Au:N\/C:N\/I:N\/A:C\/E:U\/RL:OF\/RC:C","cvssVectorBF":"2164920932","baseScore":"7.8","temporalScore":"5.8","cvssV3Vector":"","cvssV3VectorBF":"0","cvssV3BaseScore":null,"cvssV3TemporalScore":null,"vprScore":"4.4","vprContext":"[{\"id\":\"age_of_vuln\",\"name\":\"Vulnerability Age\",\"type\":\"string\",\"value\":\"730 days +\"},{\"id\":\"cvssV3_impactScore\",\"name\":\"CVSS v3 Impact Score\",\"type\":\"number\",\"value\":3.6000000000000001},{\"id\":\"exploit_code_maturity\",\"name\":\"Exploit Code Maturity\",\"type\":\"string\",\"value\":\"Unproven\"},{\"id\":\"product_coverage\",\"name\":\"Product Coverage\",\"type\":\"string\",\"value\":\"Low\"},{\"id\":\"threat_intensity_last_28\",\"name\":\"Threat Intensity\",\"type\":\"string\",\"value\":\"Very Low\"},{\"id\":\"threat_recency\",\"name\":\"Threat Recency\",\"type\":\"string\",\"value\":\"> 365 days\"},{\"id\":\"threat_sources_last_28\",\"name\":\"Threat Sources\",\"type\":\"string\",\"value\":\"No recorded events\"}]","stigSeverity":null,"pluginPubDate":"1058875200","pluginModDate":"1591963200","patchPubDate":"-1","patchModDate":"-1","vulnPubDate":"977486400","modifiedTime":"1632706433","md5":"38b2147401eb5c3a15af52182682f345","xrefs":"CVE:CVE-2001-0096, BID:2144, MSFT:MS00-100, MSKB:280322","family":{"id":"11","name":"Web Servers","type":"active"}}],"error_code":0,"error_msg":"","warnings":[],"timestamp":1411668488}
  - path: /rest/analysis
    methods: [POST]
    request_headers:
      x-apikey: accesskey=some_access_key; secretkey=some_secret_key
    responses:
      - status_code: 200
        body: |
          {"type":"regular","response":{"totalRecords":"1","returnedRecords":1,"matchingDataElementCount":"-1","results":[{"pluginID":"10114","severity":{"id":"0","name":"Info","description":"Informative"},"hasBeenMitigated":"0","acceptRisk":"0","recastRisk":"0","ip":"10.238.64.1","uuid":"","port":"0","protocol":"ICMP","pluginName":"ICMP Timestamp Request Remote Date Disclosure","firstSeen":"1551284872","lastSeen":"1632586125","exploitAvailable":"No","exploitEase":"","exploitFrameworks":"","synopsis":"It is possible to determine the exact time set on the remote host.","description":"The remote host answers to an ICMP timestamp request.  This allows an attacker to know the date that is set on the targeted machine, which may assist an unauthenticated, remote attacker in defeating time-based authentication protocols.\n\nTimestamps returned from machines running Windows Vista / 7 / 2008 / 2008 R2 are deliberately incorrect, but usually within 1000 seconds of the actual system time.","solution":"Filter out the ICMP timestamp requests (13), and the outgoing ICMP timestamp replies (14).","seeAlso":"","riskFactor":"None","stigSeverity":"","vprScore":"0.8","vprContext":"[{\"id\":\"age_of_vuln\",\"name\":\"Vulnerability Age\",\"type\":\"string\",\"value\":\"730 days +\"},{\"id\":\"cvssV3_impactScore\",\"name\":\"CVSS v3 Impact Score\",\"type\":\"number\",\"value\":0},{\"id\":\"exploit_code_maturity\",\"name\":\"Exploit Code Maturity\",\"type\":\"string\",\"value\":\"Unproven\"},{\"id\":\"product_coverage\",\"name\":\"Product Coverage\",\"type\":\"string\",\"value\":\"Very High\"},{\"id\":\"threat_intensity_last_28\",\"name\":\"Threat Intensity\",\"type\":\"string\",\"value\":\"Very Low\"},{\"id\":\"threat_recency\",\"name\":\"Threat Recency\",\"type\":\"string\",\"value\":\"No recorded events\"},{\"id\":\"threat_sources_last_28\",\"name\":\"Threat Sources\",\"type\":\"string\",\"value\":\"No recorded events\"}]","baseScore":"0.0","temporalScore":"","cvssVector":"AV:L/AC:L/Au:N/C:N/I:N/A:N","cvssV3BaseScore":"0.0","cvssV3TemporalScore":"","cvssV3Vector":"AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N","cpe":"","vulnPubDate":"788961600","patchPubDate":"-1","pluginPubDate":"933508800","pluginModDate":"1570190400","checkType":"remote","version":"1.48","cve":"CVE-1999-0524","bid":"","xref":"CWE #200","pluginText":"<plugin_output>The remote clock is synchronized with the local clock.\n</plugin_output>","dnsName":"_gateway.lxd","macAddress":"00:16:3e:a1:12:f7","netbiosName":"","operatingSystem":"Linux Kernel 2.6","ips":"10.238.64.1","hostUniqueness":"repositoryID,ip,dnsName","uniqueness":"repositoryID,ip,dnsName","family":{"id":"30","name":"General","type":"active"},"repository":{"id":"1","name":"Live","description":"","sciID":"1","dataFormat":"IPv4"},"pluginInfo":"10114 (0/1) ICMP Timestamp Request Remote Date Disclosure"}]},"error_code":0,"error_msg":"","warnings":[],"timestamp":1634709360}
  - path: /rest/analysis
    methods: [POST]
    request_headers:
      x-apikey: accesskey=asset_access_key; secretkey=asset_secret_key
    responses:
      - status_code: 200
        body: |-
          {"type":"regular","response":{"totalRecords":"3","returnedRecords":3,"matchingDataElementCount":"15331999:613202:409055:920153:21:13389568:31379110","results":[{"ip":"89.160.20.156","uuid":"4add65d0-27fc-491c-91ba-3f498a61f49e","score":"307","total":"150","severityInfo":"131","severityLow":"0","severityMedium":"9","severityHigh":"4","severityCritical":"6","macAddress":"00:00:00:47:05:0d","policyName":"Basic Agent Scan","pluginSet":"201901281542","netbiosName":"UNKNOWN\\RNKMIGAUV2L8ZEYF.EXAMPLE","dnsName":"rnkmigauv2l8zeyf.example","osCPE":"cpe:/o:microsoft:windows_10:::x64-home","biosGUID":"9e8c4d43-982b-4405-a76c-d56c1d6cf117","tpmID":"","mcafeeGUID":"","lastAuthRun":"","lastUnauthRun":"","hostUniqueness":"repositoryID,ip,dnsName","uniqueness":"repositoryID,ip,dnsName","repository":{"id":"2","name":"Staged-Large","description":"","sciID":"1","dataFormat":"IPv4"}},{"ip":"89.160.20.156","uuid":"f89a0aa7-5f35-4f05-9462-09c2b73b70ba","score":"307","total":"150","severityInfo":"131","severityLow":"0","severityMedium":"9","severityHigh":"4","severityCritical":"6","macAddress":"00:00:00:7d:34:48","policyName":"Basic Agent Scan","pluginSet":"201901281542","netbiosName":"UNKNOWN\\ZDER1KTDPSO1P0RO.EXAMPLE","dnsName":"zder1ktdpso1p0ro.example","osCPE":"cpe:/o:microsoft:windows_10:::x64-home","biosGUID":"8e0ab068-b851-4d1a-8a90-33afb6c5abb8","tpmID":"","mcafeeGUID":"","lastAuthRun":"","lastUnauthRun":"","hostUniqueness":"repositoryID,ip,dnsName","uniqueness":"repositoryID,ip,dnsName","repository":{"id":"2","name":"Staged-Large","description":"","sciID":"1","dataFormat":"IPv4"}},{"ip":"89.160.20.156","uuid":"7113d6ed-f91a-4fe2-bb8b-e653d2570507","score":"307","total":"150","severityInfo":"131","severityLow":"0","severityMedium":"9","severityHigh":"4","severityCritical":"6","macAddress":"00:00:00:2b:1d:2e","policyName":"Basic Agent Scan","pluginSet":"201901281542","netbiosName":"UNKNOWN\\G2OUNZT879FE2DJT.EXAMPLE","dnsName":"g2ounzt879fe2djt.example","osCPE":"cpe:/o:microsoft:windows_10:::x64-home","biosGUID":"8b8a7f3e-d8d2-4728-a661-08dff6da5f1a","tpmID":"","mcafeeGUID":"","lastAuthRun":"","lastUnauthRun":"","hostUniqueness":"repositoryID,ip,dnsName","uniqueness":"repositoryID,ip,dnsName","repository":{"id":"2","name":"Staged-Large","description":"","sciID":"1","dataFormat":"IPv4"}}]},"error_code":0,"error_msg":"","warnings":[],"timestamp":1634560288}
