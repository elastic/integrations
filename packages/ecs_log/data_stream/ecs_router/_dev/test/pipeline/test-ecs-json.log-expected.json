{
    "expected": [
        {
            "@timestamp": "2022-04-01T12:09:12.375Z",
            "data_stream": {
                "dataset": "foo",
                "namespace": "default",
                "type": "logs"
            },
            "ecs": {
                "version": "1.5.0"
            },
            "event": {
                "dataset": "foo"
            },
            "log": {
                "level": "INFO"
            },
            "message": "With event.dataset"
        },
        {
            "@timestamp": "2022-04-01T12:09:12.379Z",
            "data_stream": {
                "dataset": "bar",
                "namespace": "default",
                "type": "logs"
            },
            "ecs": {
                "version": "1.5.0"
            },
            "event": {
                "dataset": "bar"
            },
            "log": {
                "level": "INFO"
            },
            "message": "With data_stream.dataset"
        },
        {
            "@timestamp": "2022-04-01T12:09:12.379Z",
            "data_stream": {
                "dataset": "my_service",
                "namespace": "default",
                "type": "logs"
            },
            "ecs": {
                "version": "1.5.0"
            },
            "event": {
                "dataset": "my_service"
            },
            "log": {
                "level": "INFO"
            },
            "message": "With invalid chars in dataset"
        },
        {
            "@timestamp": "2022-04-01T14:08:40.199Z",
            "data_stream": {
                "dataset": "generic",
                "namespace": "default",
                "type": "logs"
            },
            "ecs": {
                "version": "1.5.0"
            },
            "event": {
                "dataset": "generic"
            },
            "log": {
                "level": "DEBUG"
            },
            "message": "Without dataset"
        },
        {
            "@timestamp": "2022-04-01T14:08:40.199Z",
            "data_stream": {
                "dataset": "generic",
                "namespace": "default",
                "type": "logs"
            },
            "ecs": {
                "version": "1.5.0"
            },
            "error": {
                "stack_trace": "Exception in thread \"main\" java.lang.NullPointerException\n        at com.example.myproject.Book.getTitle(Book.java:16)\n        at com.example.myproject.Author.getBookTitles(Author.java:25)\n        at com.example.myproject.Bootstrap.main(Bootstrap.java:14)"
            },
            "event": {
                "dataset": "generic"
            },
            "log": {
                "level": "DEBUG"
            },
            "message": "With stack trace"
        },
        {
            "@timestamp": "2022-04-01T14:08:40.199Z",
            "data_stream": {
                "dataset": "generic",
                "namespace": "default",
                "type": "logs"
            },
            "ecs": {
                "version": "1.5.0"
            },
            "error": {
                "stack_trace": "Exception in thread \"main\" java.lang.NullPointerException\n\n        at com.example.myproject.Book.getTitle(Book.java:16)\n\n        at com.example.myproject.Author.getBookTitles(Author.java:25)\n\n        at com.example.myproject.Bootstrap.main(Bootstrap.java:14)"
            },
            "event": {
                "dataset": "generic"
            },
            "log": {
                "level": "DEBUG"
            },
            "message": "With stack trace as array"
        }
    ]
}
