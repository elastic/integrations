input: cel
service: o365_metrics
vars:
  url: http://{{Hostname}}:{{Port}}
  token_url: http://{{Hostname}}:{{Port}}
  azure_tenant_id: "1234"
  client_id: "1234"
  client_secret: "1234"
data_stream:
  vars:
    interval: 5s
assert:
  hit_count: 2
  fields_present:
    - o365.metrics.entra.agent.last_reboot
    - o365.metrics.entra.agent.last_disabled
    - o365.metrics.entra.agent.last_updated
    - o365.metrics.entra.agent.active_alerts
    - o365.metrics.entra.agent.resolved_alerts
    - o365.metrics.entra.agent.created_date
    - o365.metrics.entra.agent.disabled
    - o365.metrics.entra.agent.service_id
    - o365.metrics.entra.agent.service_member_id
    - o365.metrics.entra.agent.machine_id
    - o365.metrics.entra.agent.machine_name
    - o365.metrics.entra.agent.role
    - o365.metrics.entra.agent.status
    - o365.metrics.entra.agent.os_version
    - o365.metrics.entra.agent.os_name