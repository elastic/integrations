input: cel
service: o365_metrics
vars:
  url: http://{{Hostname}}:{{Port}}
  token_url: http://{{Hostname}}:{{Port}}
  azure_tenant_id: "1234"
  client_id: "1234"
  client_secret: "1234"
data_stream:
  vars:
    interval: 5s
assert:
  hit_count: 12
  fields_present:
    - o365.metrics.entra.connect.on_premises_sync_enabled
    - o365.metrics.entra.connect.password_sync_enabled
    - o365.metrics.entra.connect.password_writeback_enabled
    - o365.metrics.entra.connect.directory_extensions_enabled
    - o365.metrics.entra.connect.quarantine_upon_upn_conflict_enabled
    - o365.metrics.entra.connect.quarantine_upon_proxy_addresses_conflict_enabled
    - o365.metrics.entra.connect.soft_match_on_upn_enabled
    - o365.metrics.entra.connect.cloud_password_policy_for_password_synced_users_enabled
    - o365.metrics.entra.connect.fope_conflict_resolution_enabled
    - o365.metrics.entra.connect.unified_group_writeback_enabled
    - o365.metrics.entra.connect.user_writeback_enabled
    - o365.metrics.entra.connect.device_writeback_enabled
    - o365.metrics.entra.connect.synchronize_upn_for_managed_users_enabled
    - o365.metrics.entra.connect.user_force_password_change_on_logon_enabled
    - o365.metrics.entra.connect.concurrent_org_id_provisioning_enabled
    - o365.metrics.entra.connect.concurrent_credential_update_enabled
    - o365.metrics.entra.connect.group_write_back_enabled
    - o365.metrics.entra.connect.block_soft_match_enabled
    - o365.metrics.entra.connect.block_cloud_object_takeover_through_hard_match_enabled
    - o365.metrics.entra.connect.bypass_dir_sync_overrides_enabled