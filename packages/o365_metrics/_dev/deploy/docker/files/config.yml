rules:
  - path: /1234/oauth2/v2.0/token
    methods: ['POST']
    responses: 
      - status_code: 200
        headers: 
          Content-Type: 
            'application/json'
        body: |-
          {"token_type":"Bearer","expires_in":3599,"ext_expires_in":3599,"access_token":"xxxx"}
  - path: /communications/callRecords
    methods: ['GET']
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {
            "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#communications/callRecords",
            "@odata.nextLink": "{{ env "SERVER_ADDRESS" }}/communications/callRecords?$skiptoken=1f9bdf3f-348e-49f0-8ac6-7e50a28da860",
            "value": [
              {
                "id": "6ce-b8fa-4d44-a613-7f81",
                "version": 2,
                "type": "unknown",
                "modalities": [
                  "audio"
                ],
                "lastModifiedDateTime": "2023-09-25T10:36:40Z",
                "startDateTime": "2023-09-25T09:28:38Z",
                "endDateTime": "2023-09-25T09:28:41Z",
                "organizer": {
                  "user": {
                    "id": "82f5-0000-0000-00-3b5777",
                    "displayName": "Aie Wins",
                    "tenantId": "dc3699-474c-4d40-900c-626d81f"
                  }
                },
                "organizer_v2@odata.context": "https://graph.microsoft.com/v1.0/$metadata#communications/callRecords('3cf3bbc8-b21d-4f2e-bfd0-b13603ae6c65')/organizer_v2/$entity",
                "organizer_v2": {
                  "id": "8209f5-0000-0000-0000-3b51777",
                  "identity": {
                    "user": {
                      "id": "8215-0000-0000-0000-3b51777",
                      "displayName": "Aie Wins",
                      "tenantId": "dc3699-474c-4d40-900c-626d81f"
                    }
                  }
                }
              },
              {
                "id": "1000abcd-b8fa-4d44-a613-7f5081",
                "version": 2,
                "type": "unknown",
                "modalities": [
                  "audio"
                ],
                "lastModifiedDateTime": "2023-09-25T10:36:40Z",
                "startDateTime": "2023-09-25T09:28:38Z",
                "endDateTime": "2023-09-25T09:28:41Z",
                "organizer": {
                  "user": {
                    "id": "821809f5-0000-0000-0000-3b5136c0e777",
                    "displayName": "Abbie Wilkins",
                    "tenantId": "dc368399-474c-4d40-900c-6265431fd81f"
                  }
                },
                "organizer_v2@odata.context": "https://graph.microsoft.com/v1.0/$metadata#communications/callRecords('3cf3bbc8-b21d-4f2e-bfd0-b13603ae6c65')/organizer_v2/$entity",
                "organizer_v2": {
                  "id": "821809f5-0000-0000-0000-3b5136c0e777",
                  "identity": {
                    "user": {
                      "id": "821809f5-0000-0000-0000-3b5136c0e777",
                      "displayName": "Abbie Wilkins",
                      "tenantId": "dc368399-474c-4d40-900c-6265431fd81f"
                    }
                  }
                }
              }
            ]
          }
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {
            "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#communications/callRecords",
            "value": [
              {
                "id": "a66d-b6f2-443-b12e-5aa1b6",
                "version": 3,
                "type": "groupCall",
                "modalities": [
                  "audio"
                ],
                "lastModifiedDateTime": "2025-03-26T13:42:01.8433333Z",
                "startDateTime": "2025-03-26T13:04:57.2290561Z",
                "endDateTime": "2025-03-26T13:06:31.4360658Z",
                "organizer": {
                  "user": {
                    "id": "ef5628b8-ad86-4de2-9357-014fe8c184e8",
                    "displayName": "Mun Decu",
                    "tenantId": "3f2c-bce5-42b7-8a68-14385af"
                  }
                },
                "organizer_v2@odata.context": "https://graph.microsoft.com/v1.0/$metadata#communications/callRecords('a66d-b6f2-443-b12e-5aa1b67e')/organizer_v2/$entity",
                "organizer_v2": {
                  "id": "ef56b8-ad86-4de2-9357-014fe4e8",
                  "identity": {
                    "user": {
                      "id": "ef56b8-ad86-4de2-9357-014fe4e8",
                      "displayName": "Mun Decu",
                      "tenantId": "3f2c-bce5-42b7-8a68-14385af"
                    }
                  }
                }
              }
            ]
          }              
  - path: /communications/callRecords/6ce-b8fa-4d44-a613-7f81/sessions
    methods: ['GET']
    query_params:
      '$expand': 'segments'
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {
              "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#communications/callRecords('key6ce-b8fa-4d44-a613-7f81word')/sessions(segments())",
              "@odata.nextLink": "{{ env "SERVER_ADDRESS" }}/communications/callRecords/6ce-b8fa-4d44-a613-7f81/sessions?$expand=segments&$skiptoken=a66d-b6f2-4403-b12e-5ae",
              "value": [
                  {
                      "id": "a66d-b6f2-443-b12e-5aa1b6",
                      "modalities": [
                          "audio"
                      ],
                      "startDateTime": "2025-03-26T13:16:59.5204625Z",
                      "endDateTime": "2025-03-26T13:21:43.2028167Z",
                      "segments": [
                          {
                              "startDateTime": "2025-03-26T13:04:57.232483Z",
                              "endDateTime": "2025-03-26T13:05:14.2824132Z",
                              "id": "a66d-b6f2-443-b12e-5aa1b6",
                              "failureInfo": {
                                "stage": "midcall",
                                "reason": ""
                              },
                              "caller": {
                                  "associatedIdentity": {
                                      "id": "d1941-76c2-45fc-b6ee-2c38dd3",
                                      "displayName": "oma Mrs",
                                      "tenantId": "3f3de92c-bce5-42b7-8a68-1438785455af",
                                      "userPrincipalName": "oma.mrs@m365596.onmoft.com"
                                  }
                              },
                              "callee": {
                                  "associatedIdentity": {
                                      "id": "75b-6ba8-4a80-8ffb-eeda7",
                                      "displayName": "Lu ias",
                                      "tenantId": "3f3de92c-bce5-42b7-8a68-1438785455af",
                                      "userPrincipalName": "lu.ias@m3596.onmicrosoft.com"
                                  }
                              },
                              "media": [
                                  {
                                      "label": "main-audio",
                                      "callerNetwork": {
                                          "ipAddress": "10.0.146.255",
                                          "subnet": null,
                                          "linkSpeed": 0,
                                          "connectionType": "wired",
                                          "port": 3492,
                                          "reflexiveIPAddress": "52.113.244.89",
                                          "relayIPAddress": null,
                                          "relayPort": null,
                                          "macAddress": null,
                                          "wifiMicrosoftDriver": null,
                                          "wifiMicrosoftDriverVersion": null,
                                          "wifiVendorDriver": null,
                                          "wifiVendorDriverVersion": null,
                                          "wifiChannel": null,
                                          "wifiBand": "unknown",
                                          "basicServiceSetIdentifier": null,
                                          "wifiRadioType": "unknown",
                                          "wifiSignalStrength": null,
                                          "wifiBatteryCharge": null,
                                          "dnsSuffix": null,
                                          "sentQualityEventRatio": null,
                                          "receivedQualityEventRatio": null,
                                          "delayEventRatio": null,
                                          "bandwidthLowEventRatio": null,
                                          "networkTransportProtocol": "udp",
                                          "traceRouteHops": []                                         
                                      },
                                      "calleeNetwork": {
                                          "ipAddress": "10.0.146.255",
                                          "subnet": null,
                                          "linkSpeed": 0,                                      
                                          "connectionType": "wired",
                                          "port": 3480,
                                          "reflexiveIPAddress": "52.112.234.86",
                                          "relayIPAddress": null,
                                          "relayPort": null,
                                          "macAddress": null,
                                          "wifiMicrosoftDriver": null,
                                          "wifiMicrosoftDriverVersion": null,
                                          "wifiVendorDriver": null,
                                          "wifiVendorDriverVersion": null,
                                          "wifiChannel": null,
                                          "wifiBand": "unknown",
                                          "basicServiceSetIdentifier": null,
                                          "wifiRadioType": "unknown",
                                          "wifiSignalStrength": null,
                                          "wifiBatteryCharge": null,
                                          "dnsSuffix": null,
                                          "sentQualityEventRatio": null,
                                          "receivedQualityEventRatio": null,
                                          "delayEventRatio": null,
                                          "bandwidthLowEventRatio": null,
                                          "networkTransportProtocol": "udp",
                                          "traceRouteHops": []
                                        },
                                      "streams": [
                                          {
                                              "streamId": "2386820939",
                                              "startDateTime": null,
                                              "endDateTime": null,
                                              "streamDirection": "callerToCallee",
                                              "averageAudioDegradation": null,
                                              "averageJitter": null,
                                              "maxJitter": null,
                                              "averagePacketLossRate": null,
                                              "maxPacketLossRate": null,
                                              "averageRatioOfConcealedSamples": null,
                                              "maxRatioOfConcealedSamples": null,
                                              "averageRoundTripTime": null,
                                              "maxRoundTripTime": null,
                                              "packetUtilization": 0,
                                              "averageBandwidthEstimate": null,
                                              "wasMediaBypassed": null,
                                              "postForwardErrorCorrectionPacketLossRate": null,
                                              "averageVideoFrameLossPercentage": null,
                                              "averageReceivedFrameRate": null,
                                              "lowFrameRateRatio": null,
                                              "averageVideoPacketLossRate": null,
                                              "averageVideoFrameRate": null,
                                              "lowVideoProcessingCapabilityRatio": null,
                                              "averageAudioNetworkJitter": null,
                                              "maxAudioNetworkJitter": null,
                                              "audioCodec": "unknown",
                                              "videoCodec": "unknown",
                                              "rmsFreezeDuration": null,
                                              "averageFreezeDuration": null,
                                              "isAudioForwardErrorCorrectionUsed": null
                                          },
                                          {
                                              "streamId": "8322863909",
                                              "startDateTime": null,
                                              "endDateTime": null,
                                              "streamDirection": "calleeToCaller",
                                              "averageAudioDegradation": null,
                                              "averageJitter": null,
                                              "maxJitter": null,
                                              "averagePacketLossRate": null,
                                              "maxPacketLossRate": null,
                                              "averageRatioOfConcealedSamples": null,
                                              "maxRatioOfConcealedSamples": null,
                                              "averageRoundTripTime": null,
                                              "maxRoundTripTime": null,
                                              "packetUtilization": 0,
                                              "averageBandwidthEstimate": null,
                                              "wasMediaBypassed": null,
                                              "postForwardErrorCorrectionPacketLossRate": null,
                                              "averageVideoFrameLossPercentage": null,
                                              "averageReceivedFrameRate": null,
                                              "lowFrameRateRatio": null,
                                              "averageVideoPacketLossRate": null,
                                              "averageVideoFrameRate": null,
                                              "lowVideoProcessingCapabilityRatio": null,
                                              "averageAudioNetworkJitter": null,
                                              "maxAudioNetworkJitter": null,
                                              "audioCodec": "unknown",
                                              "videoCodec": "unknown",
                                              "rmsFreezeDuration": null,
                                              "averageFreezeDuration": null,
                                              "isAudioForwardErrorCorrectionUsed": null
                                          }
                                      ]
                                  }
                              ]
                          }
                      ]
                  },
                  {
                      "id": "test1",
                      "modalities": [
                          "audio"
                      ],
                      "startDateTime": "2025-03-26T13:16:59.5204625Z",
                      "endDateTime": "2025-03-26T13:21:43.2028167Z",
                      "segments": [
                          {
                              "startDateTime": "2025-03-26T13:04:57.232483Z",
                              "endDateTime": "2025-03-26T13:05:14.2824132Z",
                              "id": "a66d-b6f2-443-b12e-5aa1b6",
                              "failureInfo": {
                                "stage": "midcall",
                                "reason": ""
                              },
                              "caller": {
                                  "associatedIdentity": {
                                      "id": "d1945381-76c2-45fc-b6ee-2c36c5128dd3",
                                      "displayName": "Tia mia",
                                      "tenantId": "3f92c-be5-47-88-14355af",
                                      "userPrincipalName": "tia.mia@m3596.onmicrosoft.com"
                                  }
                              },
                              "callee": {
                                  "associatedIdentity": {
                                      "id": "72cec15b-6ba8-4a80-8ffb-eeda50425a77",
                                      "displayName": "Lui Eia",
                                      "tenantId": "3f2c-b5-47-88-1435af",
                                      "userPrincipalName": "lui.eia@m365596.onmicrosoft.com"
                                  }
                              },
                              "media": [
                                  {
                                      "label": "main-audio",
                                      "callerNetwork": {
                                          "ipAddress": "10.0.146.255",
                                          "subnet": null,
                                          "linkSpeed": 0,                                      
                                          "connectionType": "wired",
                                          "port": 3492,
                                          "reflexiveIPAddress": "52.113.244.89",
                                          "relayIPAddress": null,
                                          "relayPort": null,
                                          "macAddress": null,
                                          "wifiMicrosoftDriver": null,
                                          "wifiMicrosoftDriverVersion": null,
                                          "wifiVendorDriver": null,
                                          "wifiVendorDriverVersion": null,
                                          "wifiChannel": null,
                                          "wifiBand": "unknown",
                                          "basicServiceSetIdentifier": null,
                                          "wifiRadioType": "unknown",
                                          "wifiSignalStrength": null,
                                          "wifiBatteryCharge": null,
                                          "dnsSuffix": null,
                                          "sentQualityEventRatio": null,
                                          "receivedQualityEventRatio": null,
                                          "delayEventRatio": null,
                                          "bandwidthLowEventRatio": null,
                                          "networkTransportProtocol": "udp",
                                          "traceRouteHops": []                                         
                                      },
                                      "calleeNetwork": {
                                          "ipAddress": "10.0.146.255",
                                          "subnet": null,
                                          "linkSpeed": 0,                                      
                                          "connectionType": "wired",
                                          "port": 3480,
                                          "reflexiveIPAddress": "52.112.234.86",
                                          "relayIPAddress": null,
                                          "relayPort": null,
                                          "macAddress": null,
                                          "wifiMicrosoftDriver": null,
                                          "wifiMicrosoftDriverVersion": null,
                                          "wifiVendorDriver": null,
                                          "wifiVendorDriverVersion": null,
                                          "wifiChannel": null,
                                          "wifiBand": "unknown",
                                          "basicServiceSetIdentifier": null,
                                          "wifiRadioType": "unknown",
                                          "wifiSignalStrength": null,
                                          "wifiBatteryCharge": null,
                                          "dnsSuffix": null,
                                          "sentQualityEventRatio": null,
                                          "receivedQualityEventRatio": null,
                                          "delayEventRatio": null,
                                          "bandwidthLowEventRatio": null,
                                          "networkTransportProtocol": "udp",
                                          "traceRouteHops": []
                                        },
                                      "streams": [
                                          {
                                              "streamId": "2386820939",
                                              "startDateTime": null,
                                              "endDateTime": null,
                                              "streamDirection": "callerToCallee",
                                              "averageAudioDegradation": null,
                                              "averageJitter": null,
                                              "maxJitter": null,
                                              "averagePacketLossRate": null,
                                              "maxPacketLossRate": null,
                                              "averageRatioOfConcealedSamples": null,
                                              "maxRatioOfConcealedSamples": null,
                                              "averageRoundTripTime": null,
                                              "maxRoundTripTime": null,
                                              "packetUtilization": 0,
                                              "averageBandwidthEstimate": null,
                                              "wasMediaBypassed": null,
                                              "postForwardErrorCorrectionPacketLossRate": null,
                                              "averageVideoFrameLossPercentage": null,
                                              "averageReceivedFrameRate": null,
                                              "lowFrameRateRatio": null,
                                              "averageVideoPacketLossRate": null,
                                              "averageVideoFrameRate": null,
                                              "lowVideoProcessingCapabilityRatio": null,
                                              "averageAudioNetworkJitter": null,
                                              "maxAudioNetworkJitter": null,
                                              "audioCodec": "unknown",
                                              "videoCodec": "unknown",
                                              "rmsFreezeDuration": null,
                                              "averageFreezeDuration": null,
                                              "isAudioForwardErrorCorrectionUsed": null
                                          },
                                          {
                                              "streamId": "8322863909",
                                              "startDateTime": null,
                                              "endDateTime": null,
                                              "streamDirection": "calleeToCaller",
                                              "averageAudioDegradation": null,
                                              "averageJitter": null,
                                              "maxJitter": null,
                                              "averagePacketLossRate": null,
                                              "maxPacketLossRate": null,
                                              "averageRatioOfConcealedSamples": null,
                                              "maxRatioOfConcealedSamples": null,
                                              "averageRoundTripTime": null,
                                              "maxRoundTripTime": null,
                                              "packetUtilization": 0,
                                              "averageBandwidthEstimate": null,
                                              "wasMediaBypassed": null,
                                              "postForwardErrorCorrectionPacketLossRate": null,
                                              "averageVideoFrameLossPercentage": null,
                                              "averageReceivedFrameRate": null,
                                              "lowFrameRateRatio": null,
                                              "averageVideoPacketLossRate": null,
                                              "averageVideoFrameRate": null,
                                              "lowVideoProcessingCapabilityRatio": null,
                                              "averageAudioNetworkJitter": null,
                                              "maxAudioNetworkJitter": null,
                                              "audioCodec": "unknown",
                                              "videoCodec": "unknown",
                                              "rmsFreezeDuration": null,
                                              "averageFreezeDuration": null,
                                              "isAudioForwardErrorCorrectionUsed": null
                                          }
                                      ]
                                  }
                              ]
                          }
                      ]
                  }
              ]
          }    
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {
              "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#communications/callRecords('key6ce-b8fa-4d44-a613-7f81word')/sessions(segments())",
              "value": [
                  {
                      "id": "2e89-b0db-40ad-b5d8-dcbc1",
                      "modalities": [
                          "video"
                      ],
                      "startDateTime": "2025-03-26T13:04:57.232483Z",
                      "endDateTime": "2025-03-26T13:06:31.4228153Z",
                      "segments": [
                          {
                              "startDateTime": "2025-03-26T13:04:57.232483Z",
                              "endDateTime": "2025-03-26T13:06:31.4228153Z",
                              "id": "2e569-b0db-40ad-b5d8-dcb2c1",
                              "failureInfo": {
                                "stage": "midcall",
                                "reason": ""
                              },
                              "caller": {
                                  "associatedIdentity": {
                                      "id": "efb8-ad86-4de2-9357-01184e8",
                                      "displayName": "Dev Desan",
                                      "tenantId": "3f2c-e5-b7-8a68-14af",
                                      "userPrincipalName": "dev.desan@m365x96.onmicrosoft.com"
                                  }
                              },
                              "callee": {
                                  "associatedIdentity": {
                                      "id": "75b-a8-80-8fb-ee5a77",
                                      "displayName": "Kung fu",
                                      "tenantId": "3f392c-bce5-42b7-8a68-14f",
                                      "userPrincipalName": "kung.fu@m3696.onmicrosoft.com"
                                  }
                              },
                              "media": [
                                  {
                                      "label": "main-video",
                                      "callerNetwork": {
                                          "ipAddress": "10.0.146.255",
                                          "subnet": null,
                                          "linkSpeed": 0,                                      
                                          "connectionType": "wired",
                                          "port": 3492,
                                          "reflexiveIPAddress": "52.113.244.89",
                                          "relayIPAddress": null,
                                          "relayPort": null,
                                          "macAddress": null,
                                          "wifiMicrosoftDriver": null,
                                          "wifiMicrosoftDriverVersion": null,
                                          "wifiVendorDriver": null,
                                          "wifiVendorDriverVersion": null,
                                          "wifiChannel": null,
                                          "wifiBand": "unknown",
                                          "basicServiceSetIdentifier": null,
                                          "wifiRadioType": "unknown",
                                          "wifiSignalStrength": null,
                                          "wifiBatteryCharge": null,
                                          "dnsSuffix": null,
                                          "sentQualityEventRatio": null,
                                          "receivedQualityEventRatio": null,
                                          "delayEventRatio": null,
                                          "bandwidthLowEventRatio": null,
                                          "networkTransportProtocol": "udp",
                                          "traceRouteHops": []                                         
                                      },
                                      "calleeNetwork": {
                                          "ipAddress": "10.0.146.255",
                                          "subnet": null,
                                          "linkSpeed": 0,                                      
                                          "connectionType": "wired",
                                          "port": 3480,
                                          "reflexiveIPAddress": "52.112.234.86",
                                          "relayIPAddress": null,
                                          "relayPort": null,
                                          "macAddress": null,
                                          "wifiMicrosoftDriver": null,
                                          "wifiMicrosoftDriverVersion": null,
                                          "wifiVendorDriver": null,
                                          "wifiVendorDriverVersion": null,
                                          "wifiChannel": null,
                                          "wifiBand": "unknown",
                                          "basicServiceSetIdentifier": null,
                                          "wifiRadioType": "unknown",
                                          "wifiSignalStrength": null,
                                          "wifiBatteryCharge": null,
                                          "dnsSuffix": null,
                                          "sentQualityEventRatio": null,
                                          "receivedQualityEventRatio": null,
                                          "delayEventRatio": null,
                                          "bandwidthLowEventRatio": null,
                                          "networkTransportProtocol": "udp",
                                          "traceRouteHops": []
                                        },
                                      "streams": [
                                          {
                                              "streamId": "2386820939",
                                              "startDateTime": null,
                                              "endDateTime": null,
                                              "streamDirection": "callerToCallee",
                                              "averageAudioDegradation": null,
                                              "averageJitter": null,
                                              "maxJitter": null,
                                              "averagePacketLossRate": null,
                                              "maxPacketLossRate": null,
                                              "averageRatioOfConcealedSamples": null,
                                              "maxRatioOfConcealedSamples": null,
                                              "averageRoundTripTime": null,
                                              "maxRoundTripTime": null,
                                              "packetUtilization": 0,
                                              "averageBandwidthEstimate": null,
                                              "wasMediaBypassed": null,
                                              "postForwardErrorCorrectionPacketLossRate": null,
                                              "averageVideoFrameLossPercentage": null,
                                              "averageReceivedFrameRate": null,
                                              "lowFrameRateRatio": null,
                                              "averageVideoPacketLossRate": null,
                                              "averageVideoFrameRate": null,
                                              "lowVideoProcessingCapabilityRatio": null,
                                              "averageAudioNetworkJitter": null,
                                              "maxAudioNetworkJitter": null,
                                              "audioCodec": "unknown",
                                              "videoCodec": "unknown",
                                              "rmsFreezeDuration": null,
                                              "averageFreezeDuration": null,
                                              "isAudioForwardErrorCorrectionUsed": null
                                          },
                                          {
                                              "streamId": "8322863909",
                                              "startDateTime": null,
                                              "endDateTime": null,
                                              "streamDirection": "calleeToCaller",
                                              "averageAudioDegradation": null,
                                              "averageJitter": null,
                                              "maxJitter": null,
                                              "averagePacketLossRate": null,
                                              "maxPacketLossRate": null,
                                              "averageRatioOfConcealedSamples": null,
                                              "maxRatioOfConcealedSamples": null,
                                              "averageRoundTripTime": null,
                                              "maxRoundTripTime": null,
                                              "packetUtilization": 0,
                                              "averageBandwidthEstimate": null,
                                              "wasMediaBypassed": null,
                                              "postForwardErrorCorrectionPacketLossRate": null,
                                              "averageVideoFrameLossPercentage": null,
                                              "averageReceivedFrameRate": null,
                                              "lowFrameRateRatio": null,
                                              "averageVideoPacketLossRate": null,
                                              "averageVideoFrameRate": null,
                                              "lowVideoProcessingCapabilityRatio": null,
                                              "averageAudioNetworkJitter": null,
                                              "maxAudioNetworkJitter": null,
                                              "audioCodec": "unknown",
                                              "videoCodec": "unknown",
                                              "rmsFreezeDuration": null,
                                              "averageFreezeDuration": null,
                                              "isAudioForwardErrorCorrectionUsed": null
                                          }
                                      ]
                                  }
                              ]
                          }
                      ]
                  }
              ]
          }
  - path: /communications/callRecords/1000abcd-b8fa-4d44-a613-7f5081/sessions
    methods: ['GET']
    query_params:
      '$expand': 'segments'
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {
              "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#communications/callRecords('1f9bdf3f-348e-49f0-8ac6-7e50a28da860')/sessions(segments())",
              "value": [
                  {
                      "id": "8ac2-bdf9-4b64-a43a-e8570ab",
                      "modalities": [
                          "audio"
                      ],
                      "startDateTime": "2025-03-26T13:16:59.5204625Z",
                      "endDateTime": "2025-03-26T13:21:43.2028167Z",
                      "segments": [
                          {
                              "startDateTime": "2025-03-26T13:16:59.5204625Z",
                              "endDateTime": "2025-03-26T13:21:43.2028167Z",
                              "id": "843a-e9fab",
                              "failureInfo": {
                                "stage": "midcall",
                                "reason": ""
                              },
                              "caller": {
                                  "associatedIdentity": {
                                      "id": "d81-76c2-45fc-b6ee-2c3dd3",
                                      "displayName": "Jeh Meh",
                                      "tenantId": "3f3c-bce5-42b7-8a68-1438af",
                                      "userPrincipalName": "jeh.meh@m365596.onmicrosoft.com"
                                  }
                              },
                              "media": [
                                  {
                                      "label": "main-audio",
                                      "callerNetwork": {
                                          "ipAddress": "10.0.146.255",
                                          "subnet": null,
                                          "linkSpeed": 0,                                      
                                          "connectionType": "wired",
                                          "port": 3492,
                                          "reflexiveIPAddress": "52.113.244.89",
                                          "relayIPAddress": null,
                                          "relayPort": null,
                                          "macAddress": null,
                                          "wifiMicrosoftDriver": null,
                                          "wifiMicrosoftDriverVersion": null,
                                          "wifiVendorDriver": null,
                                          "wifiVendorDriverVersion": null,
                                          "wifiChannel": null,
                                          "wifiBand": "unknown",
                                          "basicServiceSetIdentifier": null,
                                          "wifiRadioType": "unknown",
                                          "wifiSignalStrength": null,
                                          "wifiBatteryCharge": null,
                                          "dnsSuffix": null,
                                          "sentQualityEventRatio": null,
                                          "receivedQualityEventRatio": null,
                                          "delayEventRatio": null,
                                          "bandwidthLowEventRatio": null,
                                          "networkTransportProtocol": "udp",
                                          "traceRouteHops": []                                         
                                      },
                                      "calleeNetwork": {
                                          "ipAddress": "10.0.146.255",
                                          "subnet": null,
                                          "linkSpeed": 0,                                      
                                          "connectionType": "wired",
                                          "port": 3480,
                                          "reflexiveIPAddress": "52.112.234.86",
                                          "relayIPAddress": null,
                                          "relayPort": null,
                                          "macAddress": null,
                                          "wifiMicrosoftDriver": null,
                                          "wifiMicrosoftDriverVersion": null,
                                          "wifiVendorDriver": null,
                                          "wifiVendorDriverVersion": null,
                                          "wifiChannel": null,
                                          "wifiBand": "unknown",
                                          "basicServiceSetIdentifier": null,
                                          "wifiRadioType": "unknown",
                                          "wifiSignalStrength": null,
                                          "wifiBatteryCharge": null,
                                          "dnsSuffix": null,
                                          "sentQualityEventRatio": null,
                                          "receivedQualityEventRatio": null,
                                          "delayEventRatio": null,
                                          "bandwidthLowEventRatio": null,
                                          "networkTransportProtocol": "udp",
                                          "traceRouteHops": []
                                        },
                                      "streams": [
                                          {
                                              "streamId": "2386820939",
                                              "startDateTime": null,
                                              "endDateTime": null,
                                              "streamDirection": "callerToCallee",
                                              "averageAudioDegradation": null,
                                              "averageJitter": null,
                                              "maxJitter": null,
                                              "averagePacketLossRate": null,
                                              "maxPacketLossRate": null,
                                              "averageRatioOfConcealedSamples": null,
                                              "maxRatioOfConcealedSamples": null,
                                              "averageRoundTripTime": null,
                                              "maxRoundTripTime": null,
                                              "packetUtilization": 0,
                                              "averageBandwidthEstimate": null,
                                              "wasMediaBypassed": null,
                                              "postForwardErrorCorrectionPacketLossRate": null,
                                              "averageVideoFrameLossPercentage": null,
                                              "averageReceivedFrameRate": null,
                                              "lowFrameRateRatio": null,
                                              "averageVideoPacketLossRate": null,
                                              "averageVideoFrameRate": null,
                                              "lowVideoProcessingCapabilityRatio": null,
                                              "averageAudioNetworkJitter": null,
                                              "maxAudioNetworkJitter": null,
                                              "audioCodec": "unknown",
                                              "videoCodec": "unknown",
                                              "rmsFreezeDuration": null,
                                              "averageFreezeDuration": null,
                                              "isAudioForwardErrorCorrectionUsed": null
                                          },
                                          {
                                              "streamId": "8322863909",
                                              "startDateTime": null,
                                              "endDateTime": null,
                                              "streamDirection": "calleeToCaller",
                                              "averageAudioDegradation": null,
                                              "averageJitter": null,
                                              "maxJitter": null,
                                              "averagePacketLossRate": null,
                                              "maxPacketLossRate": null,
                                              "averageRatioOfConcealedSamples": null,
                                              "maxRatioOfConcealedSamples": null,
                                              "averageRoundTripTime": null,
                                              "maxRoundTripTime": null,
                                              "packetUtilization": 0,
                                              "averageBandwidthEstimate": null,
                                              "wasMediaBypassed": null,
                                              "postForwardErrorCorrectionPacketLossRate": null,
                                              "averageVideoFrameLossPercentage": null,
                                              "averageReceivedFrameRate": null,
                                              "lowFrameRateRatio": null,
                                              "averageVideoPacketLossRate": null,
                                              "averageVideoFrameRate": null,
                                              "lowVideoProcessingCapabilityRatio": null,
                                              "averageAudioNetworkJitter": null,
                                              "maxAudioNetworkJitter": null,
                                              "audioCodec": "unknown",
                                              "videoCodec": "unknown",
                                              "rmsFreezeDuration": null,
                                              "averageFreezeDuration": null,
                                              "isAudioForwardErrorCorrectionUsed": null
                                          }
                                      ]
                                  }
                              ]
                          }
                      ]
                  }
              ]
          }          
  - path: /communications/callRecords/a66d-b6f2-443-b12e-5aa1b6/sessions
    methods: ['GET']
    query_params:
      '$expand': 'segments'
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {
              "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#communications/callRecords('1f9bdf3f-348e-49f0-8ac6-7e50a28da860')/sessions(segments())",
              "value": [
                  {
                      "id": "82-bdf9-4b64-a43a-e9fab",
                      "modalities": [
                          "audio"
                      ],
                      "startDateTime": "2025-03-26T13:16:59.5204625Z",
                      "endDateTime": "2025-03-26T13:21:43.2028167Z",
                      "segments": [
                          {
                              "startDateTime": "2025-03-26T13:16:59.5204625Z",
                              "endDateTime": "2025-03-26T13:21:43.2028167Z",
                              "id": "8a61b4c2-bdf9-4b64-a43a-e85707b19fab",
                              "failureInfo": {
                                "stage": "midcall",
                                "reason": ""
                              },
                              "caller": {
                                  "associatedIdentity": {
                                      "id": "d1945381-76c2-45fc-b6ee-2c36c5128dd3",
                                      "displayName": "Mjs Rjs",
                                      "tenantId": "3f3de92c-bce5-42b7-8a68-1438785455af",
                                      "userPrincipalName": "mjs.rjs@m366596.onmicrosoft.com"
                                  }
                              },
                              "media": [
                                  {
                                      "label": "main-audio",
                                      "callerNetwork": {
                                          "ipAddress": "10.0.146.255",
                                          "subnet": null,
                                          "linkSpeed": 0,                                      
                                          "connectionType": "wired",
                                          "port": 3492,
                                          "reflexiveIPAddress": "52.113.244.89",
                                          "relayIPAddress": null,
                                          "relayPort": null,
                                          "macAddress": null,
                                          "wifiMicrosoftDriver": null,
                                          "wifiMicrosoftDriverVersion": null,
                                          "wifiVendorDriver": null,
                                          "wifiVendorDriverVersion": null,
                                          "wifiChannel": null,
                                          "wifiBand": "unknown",
                                          "basicServiceSetIdentifier": null,
                                          "wifiRadioType": "unknown",
                                          "wifiSignalStrength": null,
                                          "wifiBatteryCharge": null,
                                          "dnsSuffix": null,
                                          "sentQualityEventRatio": null,
                                          "receivedQualityEventRatio": null,
                                          "delayEventRatio": null,
                                          "bandwidthLowEventRatio": null,
                                          "networkTransportProtocol": "udp",
                                          "traceRouteHops": []                                         
                                      },
                                      "calleeNetwork": {
                                          "ipAddress": "10.0.146.255",
                                          "subnet": null,
                                          "linkSpeed": 0,                                      
                                          "connectionType": "wired",
                                          "port": 3480,
                                          "reflexiveIPAddress": "52.112.234.86",
                                          "relayIPAddress": null,
                                          "relayPort": null,
                                          "macAddress": null,
                                          "wifiMicrosoftDriver": null,
                                          "wifiMicrosoftDriverVersion": null,
                                          "wifiVendorDriver": null,
                                          "wifiVendorDriverVersion": null,
                                          "wifiChannel": null,
                                          "wifiBand": "unknown",
                                          "basicServiceSetIdentifier": null,
                                          "wifiRadioType": "unknown",
                                          "wifiSignalStrength": null,
                                          "wifiBatteryCharge": null,
                                          "dnsSuffix": null,
                                          "sentQualityEventRatio": null,
                                          "receivedQualityEventRatio": null,
                                          "delayEventRatio": null,
                                          "bandwidthLowEventRatio": null,
                                          "networkTransportProtocol": "udp",
                                          "traceRouteHops": []
                                        },
                                      "streams": [
                                          {
                                              "streamId": "2386820939",
                                              "startDateTime": null,
                                              "endDateTime": null,
                                              "streamDirection": "callerToCallee",
                                              "averageAudioDegradation": null,
                                              "averageJitter": null,
                                              "maxJitter": null,
                                              "averagePacketLossRate": null,
                                              "maxPacketLossRate": null,
                                              "averageRatioOfConcealedSamples": null,
                                              "maxRatioOfConcealedSamples": null,
                                              "averageRoundTripTime": null,
                                              "maxRoundTripTime": null,
                                              "packetUtilization": 0,
                                              "averageBandwidthEstimate": null,
                                              "wasMediaBypassed": null,
                                              "postForwardErrorCorrectionPacketLossRate": null,
                                              "averageVideoFrameLossPercentage": null,
                                              "averageReceivedFrameRate": null,
                                              "lowFrameRateRatio": null,
                                              "averageVideoPacketLossRate": null,
                                              "averageVideoFrameRate": null,
                                              "lowVideoProcessingCapabilityRatio": null,
                                              "averageAudioNetworkJitter": null,
                                              "maxAudioNetworkJitter": null,
                                              "audioCodec": "unknown",
                                              "videoCodec": "unknown",
                                              "rmsFreezeDuration": null,
                                              "averageFreezeDuration": null,
                                              "isAudioForwardErrorCorrectionUsed": null
                                          },
                                          {
                                              "streamId": "8322863909",
                                              "startDateTime": null,
                                              "endDateTime": null,
                                              "streamDirection": "calleeToCaller",
                                              "averageAudioDegradation": null,
                                              "averageJitter": null,
                                              "maxJitter": null,
                                              "averagePacketLossRate": null,
                                              "maxPacketLossRate": null,
                                              "averageRatioOfConcealedSamples": null,
                                              "maxRatioOfConcealedSamples": null,
                                              "averageRoundTripTime": null,
                                              "maxRoundTripTime": null,
                                              "packetUtilization": 0,
                                              "averageBandwidthEstimate": null,
                                              "wasMediaBypassed": null,
                                              "postForwardErrorCorrectionPacketLossRate": null,
                                              "averageVideoFrameLossPercentage": null,
                                              "averageReceivedFrameRate": null,
                                              "lowFrameRateRatio": null,
                                              "averageVideoPacketLossRate": null,
                                              "averageVideoFrameRate": null,
                                              "lowVideoProcessingCapabilityRatio": null,
                                              "averageAudioNetworkJitter": null,
                                              "maxAudioNetworkJitter": null,
                                              "audioCodec": "unknown",
                                              "videoCodec": "unknown",
                                              "rmsFreezeDuration": null,
                                              "averageFreezeDuration": null,
                                              "isAudioForwardErrorCorrectionUsed": null
                                          }
                                      ]
                                  }
                              ]
                          }
                      ]
                  }
              ]
          }        
  
  - path: /admin/reportSettings
    methods: ['GET']
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          { 
              "value": {
                  "@odata.type": "#microsoft.graph.adminReportSettings", 
                  "displayConcealedNames": true 
              }
          }
  - path: /organization
    methods: ['GET']
    query_params:
      '$select': 'id,displayName,tenantType'
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {
              "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#organization(id,displayName,tenantType)",
              "value": [
                  {
                      "id": "aa40685b-417d-4664-b4ec-8f7640719adb",
                      "displayName": "azure2",
                      "tenantType": "AAD"
                  }
              ]
          }