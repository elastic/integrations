rules:
  - path: /orgs/test/audit-log
    methods: ["GET"]
    request_headers:
      authorization: Bearer xxxxxxxxxx
    query_params:
      per_page: "100"
      order: asc
      phrase: "{phrase:created:>=\\d{4}-\\d{2}-\\d{2}T(?:\\d{2})(?::\\d{2}){2}\\+00:00}"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
          Link:
            - '<http://{{ hostname }}:{{ env "PORT" }}/orgs/test/audit-log?after=abcd>; rel="next"'
        body: |
          [{
            "@timestamp": 1606929874512,
            "action": "team.add_member",
            "actor": "octocat",
            "created_at": 1606929874512,
            "_document_id": "xJJFlFOhQ6b-5vaAFy9Rjw",
            "org": "octo-corp",
            "team": "octo-corp/example-team",
            "user": "monalisa"
          },{
            "@timestamp": 1606507117008,
            "action": "org.create",
            "actor": "octocat",
            "created_at": 1606507117008,
            "_document_id": "Vqvg6kZ4MYqwWRKFDzlMoQ",
            "org": "octocat-test-org"
          },{
            "@timestamp": 1605719148837,
            "action": "repo.destroy",
            "actor": "monalisa",
            "created_at": 1605719148837,
            "_document_id": "LwW2vpJZCDS-WUmo9Z-ifw",
            "org": "mona-org",
            "repo": "mona-org/mona-test-repo",
            "visibility": "private"
          }]
  - path: /orgs/test/audit-log
    methods: ["GET"]
    request_headers:
      authorization: Bearer xxxxxxxxxx
    query_params:
      after: "abcd"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
        body: |-
          [{
            "@timestamp": 1606929874512,
            "action": "team.add_member",
            "actor": "octocat",
            "created_at": 1606929874512,
            "_document_id": "xJJFlFOhQ6b-5vaAFy9Rjw",
            "org": "octo-corp",
            "team": "octo-corp/example-team",
            "user": "monalisa"
          },{
            "@timestamp": 1606507117008,
            "action": "org.create",
            "actor": "octocat",
            "created_at": 1606507117008,
            "_document_id": "Vqvg6kZ4MYqwWRKFDzlMoQ",
            "org": "octocat-test-org"
          },{
            "@timestamp": 1605719148837,
            "action": "repo.destroy",
            "actor": "monalisa",
            "created_at": 1605719148837,
            "_document_id": "LwW2vpJZCDS-WUmo9Z-ifw",
            "org": "mona-org",
            "repo": "mona-org/mona-test-repo",
            "visibility": "private"
          }]
  - path: /repos/sample_owner/sample_repo/code-scanning/alerts
    methods: ["GET"]
    request_headers:
      authorization: token xxxxxxxxxx
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
          Link:
            - '<http://{{ hostname }}:{{ env "PORT" }}/repos/sample_owner/sample_repo/code-scanning/alerts>; rel="next"'
        body: |-
          [{
            "number": 91,
            "created_at": "2022-06-29T18:03:27Z",
            "updated_at": "2022-07-07T17:10:47Z",
            "url": "https://api.github.com/repos/sample_owner-org/sample_repo/code-scanning/alerts/189",
            "html_url": "https://github.com/sample_owner-org/sample_repo/security/code-scanning/189",
            "state": "dismissed",
            "fixed_at": null,
            "dismissed_by": {
              "login": "sample_owner",
              "id": 11301409,
              "node_id": "MDQ6VXNlcjExMzAxNDA5",
              "avatar_url": "https://avatars.githubusercontent.com/u/11301409?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/sample_owner",
              "html_url": "https://github.com/sample_owner",
              "followers_url": "https://api.github.com/users/sample_owner/followers",
              "subscriptions_url": "https://api.github.com/users/sample_owner/subscriptions",
              "organizations_url": "https://api.github.com/users/sample_owner/orgs",
              "repos_url": "https://api.github.com/users/sample_owner/repos",
              "received_events_url": "https://api.github.com/users/sample_owner/received_events",
              "type": "User",
              "site_admin": false
            },
            "dismissed_at": "2022-07-07T17:10:47Z",
            "dismissed_reason": "false positive",
            "dismissed_comment": null,
            "rule": {
              "id": "js/ml-powered/xss",
              "severity": "error",
              "description": "Client-side cross-site scripting (experimental)",
              "name": "js/ml-powered/xss",
              "tags": ["experimental","external/cwe/cwe-079","security"],
              "security_severity_level": "medium"
            },
            "tool": {
              "name": "CodeQL",
              "guid": null,
              "version": "2.9.4"
            },
            "most_recent_instance": {
              "ref": "refs/heads/master",
              "analysis_key": ".github/workflows/codeql-analysis.yml:analyze",
              "category": ".github/workflows/codeql-analysis.yml:analyze/language:javascript",
              "state": "dismissed",
              "commit_sha": "3244e8b15cc1b8f2732eecd69fc1890b737f0dda",
              "message": {
                "text": "(Experimental) This may be a cross-site scripting vulnerability due to a user-provided value. Identified using machine learning. (Experimental) This may be a cross-site scripting vulnerability due to a user-provided value. Identified using machine learning. (Experimental) This may be a cross-site scripting vulnerability due to a user-provided value. Identified using machine learning."
              },
              "location": {
                "path": "routes/vulnCodeSnippet.ts",
                "start_line": 54,
                "end_line": 54,
                "start_column": 11,
                "end_column": 18
              },
              "classifications": []
            },
            "instances_url": "https://api.github.com/repos/sample_owner-org/sample_repo/code-scanning/alerts/189/instances"
          },
          {
            "number": 90,
            "created_at": "2022-06-29T18:03:27Z",
            "updated_at": "2022-06-29T18:03:27Z",
            "url": "https://api.github.com/repos/sample_owner/sample_repo/code-scanning/alerts/91",
            "html_url": "https://github.com/sample_owner/sample_repo/security/code-scanning/91",
            "state": "open",
            "rule": {
              "id": "js/ml-powered/sql-injection",
              "severity": "error",
              "description": "SQL database query built from user-controlled sources (experimental)",
              "tags": ["experimental","external/cwe/cwe-089","security"],
              "security_severity_level": "high"
            },
            "tool": {
              "name": "CodeQL",
              "version": "2.9.4"
            },
            "most_recent_instance": {
              "ref": "refs/heads/master",
              "analysis_key": ".github/workflows/codeql-analysis.yml:analyze",
              "category": ".github/workflows/codeql-analysis.yml:analyze/language:javascript",
              "state": "open",
              "commit_sha": "3244e8b15cc1b8f2732eecd69fc1890b737f0dda",
              "message": {
                "text": "(Experimental) This may be a database query that depends on a user-provided value. Identified using machine learning.(Experimental) This may be a database query that depends on a user-provided value. Identified using machine learning."
              },
              "location": {
                "path": "routes/chatbot.ts",
                "start_line": 67,
                "end_line": 67,
                "start_column": 23,
                "end_column": 50
              },
              "classifications": []
            }
          }]
  - path: /repos/sample_owner/sample_repo/secret-scanning/alerts
    methods: ["GET"]
    request_headers:
      authorization: token xxxxxxxxxx
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
          Link:
            - '<http://{{ hostname }}:{{ env "PORT" }}/repos/sample_owner/sample_repo/secret-scanning/alerts>; rel="next"'
        body: |-
          [{
            "number": 3,
            "created_at": "2022-06-30T18:07:27Z",
            "url": "https://api.github.com/repos/sample_owner/sample_repo/secret-scanning/alerts/3",
            "html_url": "https://github.com/sample_owner/sample_repo/security/secret-scanning/3",
            "state": "open",
            "secret_type": "npm_access_token",
            "secret_type_display_name": "npm Access Token",
            "secret": "npm_2vYJ3QzGXoGbEgMYduYS1k2M4D0wDu2opJbl",
            "resolution": "revoked",
            "resolved_by": {
              "login": "sample_owner",
              "url": "https://api.github.com/users/sample_owner",
              "type": "User"
            },
            "push_protection_bypassed": true,
            "push_protection_bypassed_by": {
              "login": "sample_owner",
              "url": "https://api.github.com/users/sample_owner",
              "type": "User",
              "html_url": "https://github.com/sample_owner"
            }
          },{
            "number": 2,
            "created_at": "2022-07-03T18:03:27Z",
            "url": "https://api.github.com/repos/sample_owner/sample_repo/secret-scanning/alerts/2",
            "html_url": "https://github.com/sample_owner/sample_repo/security/secret-scanning/2",
            "state": "resolved",
            "secret_type": "npm_access_token",
            "secret_type_display_name": "npm Access Token",
            "secret": "npm_2aYH3QzGXoPbEgMKduZS1k2M4D0wDu2opMbj",
            "resolution": "revoked",
            "resolved_by": {
              "login": "sample_owner",
              "url": "https://api.github.com/users/sample_owner",
              "type": "User"
            }
          },{
            "number": 1,
            "created_at": "2022-07-07T20:03:27Z",
            "url": "https://api.github.com/repos/sample_owner/sample_repo/secret-scanning/alerts/1",
            "html_url": "https://github.com/sample_owner/sample_repo/security/secret-scanning/1",
            "state": "open",
            "secret_type": "custom_pattern_1",
            "secret": "custom_58fH9"
          }]
  - path: /graphql
    methods: ["POST"]
    request_headers:
      authorization: bearer xxxxxxxxxx
    request_body: /.*/
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
        body: |-
          {
            "data": {
                "repository": {
                    "vulnerabilityAlerts": {
                        "nodes": [
                            {
                                "createdAt": "2022-07-11T11:39:07Z",
                                "dependabotUpdate": {
                                    "error": {
                                        "body": "The currently installed version can't be determined.\n\nTo resolve the issue add a supported lockfile (package-lock.json or yarn.lock).",
                                        "errorType": "dependency_file_not_supported",
                                        "title": "Dependabot can't update vulnerable dependencies without a lockfile"
                                    },
                                    "pullRequest": null
                                },
                                "dependencyScope": "RUNTIME",
                                "dismissReason": null,
                                "dismissedAt": null,
                                "dismisser": null,
                                "fixedAt": null,
                                "number": 1,
                                "repository": {
                                    "description": "OWASP Juice Shop: Probably the most modern and sophisticated insecure web application",
                                    "isInOrganization": false,
                                    "isPrivate": false,
                                    "name": "sample_repo",
                                    "owner": {
                                        "login": "sample_owner",
                                        "url": "https://github.com/sample_owner"
                                    },
                                    "url": "https://github.com/sample_owner/sample_repo"
                                },
                                "securityAdvisory": {
                                    "classification": "GENERAL",
                                    "cvss": {
                                        "score": 0,
                                        "vectorString": null
                                    },
                                    "cwes": {
                                        "nodes": [
                                            {
                                                "cweId": "CWE-20",
                                                "description": "The product receives input or data, but it does not validate or incorrectly validates that the input has the properties that are required to process the data safely and correctly.",
                                                "name": "Improper Input Validation"
                                            }
                                        ]
                                    },
                                    "description": "Versions 4.2.1 and earlier of `jsonwebtoken` are affected by a verification bypass vulnerability. This is a result of weak validation of the JWT algorithm type, occuring when an attacker is allowed to arbitrarily specify the JWT algorithm.\n\n\n\n\n## Recommendation\n\nUpdate to version 4.2.2 or later.",
                                    "ghsaId": "GHSA-c7hr-j4mj-j2w6",
                                    "identifiers": [
                                        {
                                            "type": "GHSA",
                                            "value": "GHSA-c7hr-j4mj-j2w6"
                                        },
                                        {
                                            "type": "CVE",
                                            "value": "CVE-2015-9235"
                                        }
                                    ],
                                    "origin": "UNSPECIFIED",
                                    "permalink": "https://github.com/advisories/GHSA-c7hr-j4mj-j2w6",
                                    "references": [
                                        {
                                            "url": "https://nvd.nist.gov/vuln/detail/CVE-2015-9235"
                                        },
                                        {
                                            "url": "https://github.com/auth0/node-jsonwebtoken/commit/1bb584bc382295eeb7ee8c4452a673a77a68b687"
                                        },
                                        {
                                            "url": "https://auth0.com/blog/2015/03/31/critical-vulnerabilities-in-json-web-token-libraries/"
                                        },
                                        {
                                            "url": "https://github.com/advisories/GHSA-c7hr-j4mj-j2w6"
                                        },
                                        {
                                            "url": "https://www.npmjs.com/advisories/17"
                                        },
                                        {
                                            "url": "https://www.timmclean.net/2015/02/25/jwt-alg-none.html"
                                        },
                                        {
                                            "url": "https://nodesecurity.io/advisories/17"
                                        }
                                    ],
                                    "publishedAt": "2018-10-09T00:38:30Z",
                                    "severity": "CRITICAL",
                                    "summary": "Verification Bypass in jsonwebtoken",
                                    "updatedAt": "2021-01-08T19:00:39Z",
                                    "withdrawnAt": null
                                },
                                "securityVulnerability": {
                                    "firstPatchedVersion": {
                                        "identifier": "4.2.2"
                                    },
                                    "package": {
                                        "ecosystem": "NPM",
                                        "name": "jsonwebtoken"
                                    },
                                    "severity": "CRITICAL",
                                    "updatedAt": "2018-11-30T19:54:28Z",
                                    "vulnerableVersionRange": "< 4.2.2"
                                },
                                "state": "OPEN",
                                "vulnerableManifestPath": "package.json",
                                "vulnerableManifestFilename": "package.json",
                                "vulnerableRequirements": "= 0.4.0"
                            },
                            {
                                "createdAt": "2022-07-11T11:39:07Z",
                                "dependabotUpdate": {
                                    "error": {
                                        "body": "The currently installed version can't be determined.\n\nTo resolve the issue add a supported lockfile (package-lock.json or yarn.lock).",
                                        "errorType": "dependency_file_not_supported",
                                        "title": "Dependabot can't update vulnerable dependencies without a lockfile"
                                    },
                                    "pullRequest": null
                                },
                                "dependencyScope": "RUNTIME",
                                "dismissReason": "No bandwidth to fix this",
                                "dismissedAt": "2022-07-12T03:02:16Z",
                                "dismisser": {
                                    "login": "sample_owner",
                                    "url": "https://github.com/sample_owner"
                                },
                                "fixedAt": null,
                                "number": 7,
                                "repository": {
                                    "description": "OWASP Juice Shop: Probably the most modern and sophisticated insecure web application",
                                    "isInOrganization": false,
                                    "isPrivate": false,
                                    "name": "sample_repo",
                                    "owner": {
                                        "login": "sample_owner",
                                        "url": "https://github.com/sample_owner"
                                    },
                                    "url": "https://github.com/sample_owner/sample_repo"
                                },
                                "securityAdvisory": {
                                    "classification": "GENERAL",
                                    "cvss": {
                                        "score": 5.3,
                                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N"
                                    },
                                    "cwes": {
                                        "nodes": [
                                            {
                                                "cweId": "CWE-20",
                                                "description": "The product receives input or data, but it does not validate or incorrectly validates that the input has the properties that are required to process the data safely and correctly.",
                                                "name": "Improper Input Validation"
                                            }
                                        ]
                                    },
                                    "description": "Apostrophe Technologies sanitize-html before 2.3.1 does not properly handle internationalized domain name (IDN) which could allow an attacker to bypass hostname whitelist validation set by the \"allowedIframeHostnames\" option.",
                                    "ghsaId": "GHSA-rjqq-98f6-6j3r",
                                    "identifiers": [
                                        {
                                            "type": "GHSA",
                                            "value": "GHSA-rjqq-98f6-6j3r"
                                        },
                                        {
                                            "type": "CVE",
                                            "value": "CVE-2021-26539"
                                        }
                                    ],
                                    "origin": "UNSPECIFIED",
                                    "permalink": "https://github.com/advisories/GHSA-rjqq-98f6-6j3r",
                                    "references": [
                                        {
                                            "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-26539"
                                        },
                                        {
                                            "url": "https://github.com/apostrophecms/sanitize-html/pull/458"
                                        },
                                        {
                                            "url": "https://advisory.checkmarx.net/advisory/CX-2021-4308"
                                        },
                                        {
                                            "url": "https://github.com/apostrophecms/sanitize-html/blob/main/CHANGELOG.md#231-2021-01-22"
                                        },
                                        {
                                            "url": "https://github.com/advisories/GHSA-rjqq-98f6-6j3r"
                                        }
                                    ],
                                    "publishedAt": "2021-05-06T16:10:05Z",
                                    "severity": "MODERATE",
                                    "summary": "Improper Input Validation in sanitize-html",
                                    "updatedAt": "2022-04-27T19:14:13Z",
                                    "withdrawnAt": null
                                },
                                "securityVulnerability": {
                                    "firstPatchedVersion": {
                                        "identifier": "2.3.1"
                                    },
                                    "package": {
                                        "ecosystem": "NPM",
                                        "name": "sanitize-html"
                                    },
                                    "severity": "MODERATE",
                                    "updatedAt": "2021-03-29T23:13:26Z",
                                    "vulnerableVersionRange": "< 2.3.1"
                                },
                                "state": "DISMISSED",
                                "vulnerableManifestPath": "package.json",
                                "vulnerableManifestFilename": "package.json",
                                "vulnerableRequirements": "= 1.4.2"
                            }
                        ],
                        "pageInfo": {
                            "hasNextPage": false,
                            "endCursor": "Y3Vyc29yOnYyOpHOo0xegA=="
                        }
                    }
                }
            }
          }
  - path: /repos/sample_owner/sample_repo/issues
    methods: ["GET"]
    request_headers:
      authorization: Bearer xxxxxxxxxx
    query_params:
      per_page: 100
      state: all
      filter: all
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
          Link:
            - '<http://{{ hostname }}:{{ env "PORT" }}/repos/sample_owner/sample_repo/issues?page=2>; rel="next"'
        body: |
          [{
            "url": "https://api.github.com/repos/elastic/integrations/issues/4703",
            "repository_url": "https://api.github.com/repos/elastic/integrations",
            "labels_url": "https://api.github.com/repos/elastic/integrations/issues/4703/labels{/name}",
            "comments_url": "https://api.github.com/repos/elastic/integrations/issues/4703/comments",
            "events_url": "https://api.github.com/repos/elastic/integrations/issues/4703/events",
            "html_url": "https://github.com/elastic/integrations/pull/4703",
            "id": 1461503410,
            "node_id": "PR_kwDODAw23M5DjHjk",
            "number": 4703,
            "title": "[Enhancement] [AWS Security Hub] Update the Pagination Termination Condition",
            "user": {
                "login": "vinit-elastic",
                "id": 89848047,
                "node_id": "MDQ6VXNlcjg5ODQ4MDQ3",
                "avatar_url": "https://avatars.githubusercontent.com/u/89848047?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/vinit-elastic",
                "html_url": "https://github.com/vinit-elastic",
                "followers_url": "https://api.github.com/users/vinit-elastic/followers",
                "following_url": "https://api.github.com/users/vinit-elastic/following{/other_user}",
                "gists_url": "https://api.github.com/users/vinit-elastic/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/vinit-elastic/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/vinit-elastic/subscriptions",
                "organizations_url": "https://api.github.com/users/vinit-elastic/orgs",
                "repos_url": "https://api.github.com/users/vinit-elastic/repos",
                "events_url": "https://api.github.com/users/vinit-elastic/events{/privacy}",
                "received_events_url": "https://api.github.com/users/vinit-elastic/received_events",
                "type": "User",
                "site_admin": false
            },
            "labels": [
                {
                    "id": 1498531540,
                    "node_id": "MDU6TGFiZWwxNDk4NTMxNTQw",
                    "url": "https://api.github.com/repos/elastic/integrations/labels/enhancement",
                    "name": "enhancement",
                    "color": "a2eeef",
                    "default": true,
                    "description": "New feature or request"
                },
                {
                    "id": 2404921703,
                    "node_id": "MDU6TGFiZWwyNDA0OTIxNzAz",
                    "url": "https://api.github.com/repos/elastic/integrations/labels/Team:Security-External%20Integrations",
                    "name": "Team:Security-External Integrations",
                    "color": "1d76db",
                    "default": false,
                    "description": "Label for the Security External Integrations team"
                },
                {
                    "id": 2607750240,
                    "node_id": "MDU6TGFiZWwyNjA3NzUwMjQw",
                    "url": "https://api.github.com/repos/elastic/integrations/labels/Integration:AWS",
                    "name": "Integration:AWS",
                    "color": "FFFFFF",
                    "default": false,
                    "description": ""
                }
            ],
            "state": "open",
            "locked": false,
            "assignee": null,
            "assignees": [],
            "milestone": null,
            "comments": 4,
            "created_at": "2022-11-23T10:44:59Z",
            "updated_at": "2022-11-23T11:23:56Z",
            "closed_at": null,
            "author_association": "COLLABORATOR",
            "active_lock_reason": null,
            "draft": false,
            "pull_request": {
                "url": "https://api.github.com/repos/elastic/integrations/pulls/4703",
                "html_url": "https://github.com/elastic/integrations/pull/4703",
                "diff_url": "https://github.com/elastic/integrations/pull/4703.diff",
                "patch_url": "https://github.com/elastic/integrations/pull/4703.patch",
                "merged_at": null
            },
            "body": " Type of change\r\n- Enhancement\r\n<!--Please label this PR with one of the following labels, depending on the scope of your change:\r\n- Bug\r\n- Breaking change\r\n- Deprecation\r\n-->\r\n\r\n## What does this PR do?\r\nUpdate the Pagination Termination Condition for AWS Security Hub connector.\r\n\r\nCurrent condition for pagination termination contains `[[else]][[.last_response.terminate_pagination]][[end]]` which results in error logs when pagination is completed.\r\n\r\nRemoving this `else` condition will not result in error logs.\r\n\r\n<!-- Mandatory\r\nExplain here the changes you made on the PR.\r\n-->\r\n\r\n## Checklist\r\n\r\n- [x] I have reviewed [tips for building integrations](https://github.com/elastic/integrations/blob/main/docs/tips_for_building_integrations.md) and this pull request is aligned with them.\r\n- [x] I have verified that all data streams collect metrics or logs.\r\n- [x] I have added an entry to my package's `changelog.yml` file.\r\n- [x] I have verified that Kibana version constraints are current according to [guidelines](https://github.com/elastic/elastic-package/blob/master/docs/howto/stack_version_support.md#when-to-update-the-condition).\r\n\r\n<!--## Author's Checklist\r\n\r\n Recommended\r\nAdd a checklist of things that are required to be reviewed in order to have the PR approved\r\n-->\r\n\r\n## How to test this PR locally\r\n- Clone integrations repo.\r\n- Install elastic package locally.\r\n- Start elastic stack using elastic-package.\r\n- Move to integrations/packages/aws directory.\r\n- Run the following command to run tests. \r\n> elastic-package test \r\n<!-- Recommended\r\nExplain here how this PR will be tested by the reviewer: commands, dependencies, steps, etc.\r\n-->\r\n\r\n## Related issues\r\n\r\n<!-- Recommended\r\nLink related issues below. Insert the issue link or reference after the word \"Closes\" if merging this should automatically close it.\r\n\r\n- Closes #123\r\n- Requires #123\r\n- Supersedes #123\r\n-->\r\n- Relates https://github.com/elastic/integrations/issues/4527\r\n\r\n## Screenshots\r\n![image](https://user-images.githubusercontent.com/89848047/203526900-06519c95-3de5-4f88-a65d-555d03d7f9a1.png)\r\n![image](https://user-images.githubusercontent.com/89848047/203527000-b050f059-03c6-4ead-a88e-9f2e42efb537.png)\r\n![image](https://user-images.githubusercontent.com/89848047/203527123-ea1f8513-8371-4d06-8a17-b71c0dae7a5a.png)\r\n\r\n<!-- Optional\r\nAdd here screenshots presenting:\r\n- Kibana UI forms presenting configuration options exposed by the integration\r\n- dashboards with collected metrics or logs\r\n-->\r\n",
            "reactions": {
                "url": "https://api.github.com/repos/elastic/integrations/issues/4703/reactions",
                "total_count": 0,
                "+1": 0,
                "-1": 0,
                "laugh": 0,
                "hooray": 0,
                "confused": 0,
                "heart": 0,
                "rocket": 0,
                "eyes": 0
            },
            "timeline_url": "https://api.github.com/repos/elastic/integrations/issues/4703/timeline",
            "performed_via_github_app": null,
            "state_reason": null
          },
          {
            "url": "https://api.github.com/repos/elastic/integrations/issues/4710",
            "repository_url": "https://api.github.com/repos/elastic/integrations",
            "labels_url": "https://api.github.com/repos/elastic/integrations/issues/4710/labels{/name}",
            "comments_url": "https://api.github.com/repos/elastic/integrations/issues/4710/comments",
            "events_url": "https://api.github.com/repos/elastic/integrations/issues/4710/events",
            "html_url": "https://github.com/elastic/integrations/issues/4710",
            "id": 1461928292,
            "node_id": "I_kwDODAw23M5XI0Fk",
            "number": 4710,
            "title": "Custom STIX Package",
            "user": {
                "login": "jamiehynds",
                "id": 62879768,
                "node_id": "MDQ6VXNlcjYyODc5NzY4",
                "avatar_url": "https://avatars.githubusercontent.com/u/62879768?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/jamiehynds",
                "html_url": "https://github.com/jamiehynds",
                "followers_url": "https://api.github.com/users/jamiehynds/followers",
                "following_url": "https://api.github.com/users/jamiehynds/following{/other_user}",
                "gists_url": "https://api.github.com/users/jamiehynds/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/jamiehynds/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jamiehynds/subscriptions",
                "organizations_url": "https://api.github.com/users/jamiehynds/orgs",
                "repos_url": "https://api.github.com/users/jamiehynds/repos",
                "events_url": "https://api.github.com/users/jamiehynds/events{/privacy}",
                "received_events_url": "https://api.github.com/users/jamiehynds/received_events",
                "type": "User",
                "site_admin": false
            },
            "labels": [
                {
                    "id": 2404921703,
                    "node_id": "MDU6TGFiZWwyNDA0OTIxNzAz",
                    "url": "https://api.github.com/repos/elastic/integrations/labels/Team:Security-External%20Integrations",
                    "name": "Team:Security-External Integrations",
                    "color": "1d76db",
                    "default": false,
                    "description": "Label for the Security External Integrations team"
                },
                {
                    "id": 3104073484,
                    "node_id": "MDU6TGFiZWwzMTA0MDczNDg0",
                    "url": "https://api.github.com/repos/elastic/integrations/labels/Integration:Threat%20Intel",
                    "name": "Integration:Threat Intel",
                    "color": "ffffff",
                    "default": false,
                    "description": ""
                }
            ],
            "state": "open",
            "locked": false,
            "assignee": {
                "login": "P1llus",
                "id": 8027539,
                "node_id": "MDQ6VXNlcjgwMjc1Mzk=",
                "avatar_url": "https://avatars.githubusercontent.com/u/8027539?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/P1llus",
                "html_url": "https://github.com/P1llus",
                "followers_url": "https://api.github.com/users/P1llus/followers",
                "following_url": "https://api.github.com/users/P1llus/following{/other_user}",
                "gists_url": "https://api.github.com/users/P1llus/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/P1llus/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/P1llus/subscriptions",
                "organizations_url": "https://api.github.com/users/P1llus/orgs",
                "repos_url": "https://api.github.com/users/P1llus/repos",
                "events_url": "https://api.github.com/users/P1llus/events{/privacy}",
                "received_events_url": "https://api.github.com/users/P1llus/received_events",
                "type": "User",
                "site_admin": false
            },
            "assignees": [
                {
                    "login": "P1llus",
                    "id": 8027539,
                    "node_id": "MDQ6VXNlcjgwMjc1Mzk=",
                    "avatar_url": "https://avatars.githubusercontent.com/u/8027539?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/P1llus",
                    "html_url": "https://github.com/P1llus",
                    "followers_url": "https://api.github.com/users/P1llus/followers",
                    "following_url": "https://api.github.com/users/P1llus/following{/other_user}",
                    "gists_url": "https://api.github.com/users/P1llus/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/P1llus/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/P1llus/subscriptions",
                    "organizations_url": "https://api.github.com/users/P1llus/orgs",
                    "repos_url": "https://api.github.com/users/P1llus/repos",
                    "events_url": "https://api.github.com/users/P1llus/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/P1llus/received_events",
                    "type": "User",
                    "site_admin": false
                }
            ],
            "milestone": null,
            "comments": 2,
            "created_at": "2022-11-23T15:06:34Z",
            "updated_at": "2022-11-23T15:07:18Z",
            "closed_at": null,
            "author_association": "NONE",
            "active_lock_reason": null,
            "body": "Structured Threat Information Expression (STIX) is a language for expressing cyber threat and observable information. While we have several Threat Intel integrations which map STIX formatted data to Elastic Common Schema, users will always have need to ingest IOC's from threat feeds that we don't support out of the box. 'How do I ingest STIX feeds' remains a very common questions across community Slack, Discuss, Github, etc. A custom package would solve for this. \r\n\r\nTo allow for the broad range of STIX formatted feeds, we should provide a way for users to ingest data from ANY STIX feed, via a 'Custom STIX' package. The package will leverage our httpjson input under the hood, but include an ingest pipeline which maps STIX fields to ECS (we expect there'll still be a need for custom fields, as not all STIX fields have a corresponding field in ECS). \r\n\r\nThere may be cases where some feeds/vendors don't strictly conform to STIX, and in those cases, users may have to modify our pipeline and that's ok. We'll focus on correctly formatted STIX data. ",
            "reactions": {
                "url": "https://api.github.com/repos/elastic/integrations/issues/4710/reactions",
                "total_count": 0,
                "+1": 0,
                "-1": 0,
                "laugh": 0,
                "hooray": 0,
                "confused": 0,
                "heart": 0,
                "rocket": 0,
                "eyes": 0
            },
            "timeline_url": "https://api.github.com/repos/elastic/integrations/issues/4710/timeline",
            "performed_via_github_app": null,
            "state_reason": null
          }]
  - path: /repos/sample_owner/sample_repo/issues
    methods: ["GET"]
    request_headers:
      authorization: Bearer xxxxxxxxxx
    query_params:
      page: 2
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
        body: |-
          [{
            "id": 1,
            "node_id": "MDU6SXNzdWUx",
            "url": "https://api.github.com/repos/octocat/Hello-World/issues/1347",
            "repository_url": "https://api.github.com/repos/octocat/Hello-World",
            "labels_url": "https://api.github.com/repos/octocat/Hello-World/issues/1347/labels{/name}",
            "comments_url": "https://api.github.com/repos/octocat/Hello-World/issues/1347/comments",
            "events_url": "https://api.github.com/repos/octocat/Hello-World/issues/1347/events",
            "html_url": "https://github.com/octocat/Hello-World/issues/1347",
            "number": 1347,
            "state": "open",
            "title": "Found a bug",
            "body": "I'm having a problem with this.",
            "user": {
                "login": "octocat",
                "id": 1,
                "node_id": "MDQ6VXNlcjE=",
                "avatar_url": "https://github.com/images/error/octocat_happy.gif",
                "gravatar_id": "",
                "url": "https://api.github.com/users/octocat",
                "html_url": "https://github.com/octocat",
                "followers_url": "https://api.github.com/users/octocat/followers",
                "following_url": "https://api.github.com/users/octocat/following{/other_user}",
                "gists_url": "https://api.github.com/users/octocat/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/octocat/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/octocat/subscriptions",
                "organizations_url": "https://api.github.com/users/octocat/orgs",
                "repos_url": "https://api.github.com/users/octocat/repos",
                "events_url": "https://api.github.com/users/octocat/events{/privacy}",
                "received_events_url": "https://api.github.com/users/octocat/received_events",
                "type": "User",
                "site_admin": false
            },
            "labels": [
                {
                    "id": 208045946,
                    "node_id": "MDU6TGFiZWwyMDgwNDU5NDY=",
                    "url": "https://api.github.com/repos/octocat/Hello-World/labels/bug",
                    "name": "bug",
                    "description": "Something isn't working",
                    "color": "f29513",
                    "default": true
                }
            ],
            "assignee": {
                "login": "octocat",
                "id": 1,
                "node_id": "MDQ6VXNlcjE=",
                "avatar_url": "https://github.com/images/error/octocat_happy.gif",
                "gravatar_id": "",
                "url": "https://api.github.com/users/octocat",
                "html_url": "https://github.com/octocat",
                "followers_url": "https://api.github.com/users/octocat/followers",
                "following_url": "https://api.github.com/users/octocat/following{/other_user}",
                "gists_url": "https://api.github.com/users/octocat/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/octocat/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/octocat/subscriptions",
                "organizations_url": "https://api.github.com/users/octocat/orgs",
                "repos_url": "https://api.github.com/users/octocat/repos",
                "events_url": "https://api.github.com/users/octocat/events{/privacy}",
                "received_events_url": "https://api.github.com/users/octocat/received_events",
                "type": "User",
                "site_admin": false
            },
            "assignees": [
                {
                    "login": "octocat",
                    "id": 1,
                    "node_id": "MDQ6VXNlcjE=",
                    "avatar_url": "https://github.com/images/error/octocat_happy.gif",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/octocat",
                    "html_url": "https://github.com/octocat",
                    "followers_url": "https://api.github.com/users/octocat/followers",
                    "following_url": "https://api.github.com/users/octocat/following{/other_user}",
                    "gists_url": "https://api.github.com/users/octocat/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/octocat/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/octocat/subscriptions",
                    "organizations_url": "https://api.github.com/users/octocat/orgs",
                    "repos_url": "https://api.github.com/users/octocat/repos",
                    "events_url": "https://api.github.com/users/octocat/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/octocat/received_events",
                    "type": "User",
                    "site_admin": false
                }
            ],
            "milestone": {
                "url": "https://api.github.com/repos/octocat/Hello-World/milestones/1",
                "html_url": "https://github.com/octocat/Hello-World/milestones/v1.0",
                "labels_url": "https://api.github.com/repos/octocat/Hello-World/milestones/1/labels",
                "id": 1002604,
                "node_id": "MDk6TWlsZXN0b25lMTAwMjYwNA==",
                "number": 1,
                "state": "open",
                "title": "v1.0",
                "description": "Tracking milestone for version 1.0",
                "creator": {
                    "login": "octocat",
                    "id": 1,
                    "node_id": "MDQ6VXNlcjE=",
                    "avatar_url": "https://github.com/images/error/octocat_happy.gif",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/octocat",
                    "html_url": "https://github.com/octocat",
                    "followers_url": "https://api.github.com/users/octocat/followers",
                    "following_url": "https://api.github.com/users/octocat/following{/other_user}",
                    "gists_url": "https://api.github.com/users/octocat/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/octocat/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/octocat/subscriptions",
                    "organizations_url": "https://api.github.com/users/octocat/orgs",
                    "repos_url": "https://api.github.com/users/octocat/repos",
                    "events_url": "https://api.github.com/users/octocat/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/octocat/received_events",
                    "type": "User",
                    "site_admin": false
                },
                "open_issues": 4,
                "closed_issues": 8,
                "created_at": "2011-04-10T20:09:31Z",
                "updated_at": "2014-03-03T18:58:10Z",
                "closed_at": "2013-02-12T13:22:01Z",
                "due_on": "2012-10-09T23:39:01Z"
            },
            "locked": true,
            "active_lock_reason": "too heated",
            "comments": 0,
            "pull_request": {
                "url": "https://api.github.com/repos/octocat/Hello-World/pulls/1347",
                "html_url": "https://github.com/octocat/Hello-World/pull/1347",
                "diff_url": "https://github.com/octocat/Hello-World/pull/1347.diff",
                "patch_url": "https://github.com/octocat/Hello-World/pull/1347.patch"
            },
            "closed_at": null,
            "created_at": "2011-04-22T13:33:48Z",
            "updated_at": "2011-04-22T13:33:48Z",
            "closed_by": {
                "login": "octocat",
                "id": 1,
                "node_id": "MDQ6VXNlcjE=",
                "avatar_url": "https://github.com/images/error/octocat_happy.gif",
                "gravatar_id": "",
                "url": "https://api.github.com/users/octocat",
                "html_url": "https://github.com/octocat",
                "followers_url": "https://api.github.com/users/octocat/followers",
                "following_url": "https://api.github.com/users/octocat/following{/other_user}",
                "gists_url": "https://api.github.com/users/octocat/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/octocat/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/octocat/subscriptions",
                "organizations_url": "https://api.github.com/users/octocat/orgs",
                "repos_url": "https://api.github.com/users/octocat/repos",
                "events_url": "https://api.github.com/users/octocat/events{/privacy}",
                "received_events_url": "https://api.github.com/users/octocat/received_events",
                "type": "User",
                "site_admin": false
            },
            "author_association": "COLLABORATOR",
            "state_reason": "completed"
          }]
