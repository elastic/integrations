- name: github
  type: group
  fields:
    - name: project
      type: group
      description: >-
        Project's metadata
      fields:
        - name: template
          type: boolean
        - name: creator
          type: group
          fields:
            - name: login
              type: keyword
        - name: resource_path
          type: keyword
        - name: readme
          type: keyword
        - name: short_description
          type: keyword
        - name: workflows
          type: flattened
        - name: title
          type: keyword
        - name: url
          type: keyword
        - name: viewer_can_close
          type: boolean
        - name: created_at
          type: date
        - name: number
          type: long
        - name: viewer_can_reopen
          type: boolean
        - name: public
          type: boolean
        - name: repositories
          type: flattened
        - name: closed
          type: boolean
        - name: id
          type: keyword
        - name: viewer_can_update
          type: boolean
        - name: database_id
          type: long
        - name: updated_at
          type: date
        - name: owner
          type: keyword
        - name: owner_is_org
          type: boolean
    - name: project_items
      type: group
      fields:
        - name: id
          type: keyword
          description: "The id of project item "
        - name: created_at
          type: date
        - name: creator
          type: group
          fields:
            - name: login
              type: keyword
        - name: updated_at
          type: date
        - name: field_values
          type: group
          description: >-
            key-value pairs of project item's fields and values
          fields:
            - name: provided
              type: group
              description: >-
                The default project fields provided by Github
              fields:
                - name: assignees
                  type: keyword
                - name: title
                  type: keyword
                - name: labels
                  type: keyword
                - name: status
                  type: keyword
                - name: linked_pull_requests
                  type: keyword
                - name: reviewers
                  type: keyword
                - name: repository
                  type: keyword
            - name: custom
              type: flattened
              description: >-
                The custom fields defined by users
        - name: content
          type: group
          description: >-
            The issue/pull_request of the project item
          fields:
            - name: is_draft
              type: boolean
            - name: merged
              type: boolean
            - name: assignees
              type: keyword
            - name: body
              type: text
            - name: repository
              type: group
              fields:
                - name: name
                  type: keyword
                - name: url
                  type: keyword
            - name: title
              type: keyword
            - name: url
              type: keyword
            - name: labels
              type: keyword
            - name: created_at
              type: date
            - name: closed_at
              type: date
            - name: number
              type: integer
            - name: closing_issues_references
              type: flattened
            - name: mergeable
              type: keyword
            - name: changed_files
              type: integer
            - name: closed
              type: boolean
            - name: state
              type: keyword
            - name: database_id
              type: long
            - name: updated_at
              type: date
            - name: creator
              type: group
              fields:
                - name: login
                  type: keyword
            - name: time_to_close.sec
              type: long
              format: duration
              unit: s
              metric_type: gauge
              description: >
                The time taken to close an issue in seconds.

    - name: state
      type: keyword
      description: >
        State of github issue i.e., project item content's state.

    - name: repository
      type: group
      description: >
        Information on the Github repository associated with the alert

      fields:
        - name: name
          type: keyword
          description: >
            The name of the repository.

        - name: html_url
          type: keyword
          description: >
            The URL to view the repository on GitHub.com.

        - name: description
          type: text
          description: >
            The repository description.

        - name: url
          type: keyword
          description: >
            The URL to get more information about the repository from the GitHub API.

        - name: owner
          type: group
          description: >
            Owner of github repository

          fields:
            - name: login
              type: keyword
