project_id: {{project_id}}
topic: {{topic}}
subscription.name: {{subscription_name}}
{{#if credentials_file}}
credentials_file: {{credentials_file}}
{{/if}}
{{#if credentials_json}}
credentials_json: {{credentials_json}}
{{/if}}
{{#if alternative_host}}
alternative_host: {{alternative_host}}
{{/if}}
subscription.create: {{subscription_create}}
tags:
  {{#each tags as |tag i|}}
  - {{tag}}
  {{/each}}
{{#contains tags "forwarded"}}
publisher_pipeline.disable_host: true
{{/contains}}
processors:
  - decode_json_fields:
      fields: ["message"]
      target: "json"
  - community_id:
      fields:
        source_ip: json.jsonPayload.connection.src_ip
        source_port: json.jsonPayload.connection.src_port
        destination_ip: json.jsonPayload.connection.dest_ip
        destination_port: json.jsonPayload.connection.dest_port
        iana_number: json.jsonPayload.connection.protocol
  - add_fields:
      target: ''
      fields:
        ecs.version: 1.7.0