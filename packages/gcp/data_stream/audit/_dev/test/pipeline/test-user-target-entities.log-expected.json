{
    "expected": [
        {
            "@timestamp": "2024-11-06T11:00:00.000Z",
            "actor": {
                "entity": {
                    "id": [
                        "user:admin@elastic.co",
                        "admin@elastic.co"
                    ]
                }
            },
            "client": {
                "user": {
                    "email": "admin@elastic.co",
                    "id": "user:admin@elastic.co"
                }
            },
            "cloud": {
                "project": {
                    "id": "test-project"
                },
                "provider": "gcp"
            },
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "google.iam.admin.v1.CreateServiceAccountKey",
                "category": [
                    "network",
                    "configuration"
                ],
                "id": "test-user-target-1",
                "kind": "event",
                "original": "{\"insertId\":\"test-user-target-1\",\"logName\":\"projects/test-project/logs/cloudaudit.googleapis.com%2Factivity\",\"protoPayload\":{\"@type\":\"type.googleapis.com/google.cloud.audit.AuditLog\",\"authenticationInfo\":{\"principalEmail\":\"admin@elastic.co\",\"principalSubject\":\"user:admin@elastic.co\"},\"authorizationInfo\":[{\"granted\":true,\"permission\":\"iam.serviceAccountKeys.create\",\"resourceAttributes\":{}}],\"methodName\":\"google.iam.admin.v1.CreateServiceAccountKey\",\"requestMetadata\":{\"callerIp\":\"198.51.100.1\"},\"resourceName\":\"projects/test-project/serviceAccounts/users/alice@example.com\",\"serviceName\":\"iam.googleapis.com\"},\"receiveTimestamp\":\"2024-11-06T11:00:00.000000Z\",\"resource\":{\"labels\":{\"project_id\":\"test-project\"},\"type\":\"service_account\"},\"severity\":\"NOTICE\",\"timestamp\":\"2024-11-06T11:00:00.000000Z\"}",
                "outcome": "success",
                "provider": "activity",
                "type": [
                    "access",
                    "allowed"
                ]
            },
            "gcp": {
                "audit": {
                    "authorization_info": [
                        {
                            "granted": true,
                            "permission": "iam.serviceAccountKeys.create"
                        }
                    ],
                    "receive_timestamp": "2024-11-06T11:00:00.000Z",
                    "resource": {
                        "type": "service_account"
                    },
                    "resource_name": "projects/test-project/serviceAccounts/users/alice@example.com",
                    "type": "type.googleapis.com/google.cloud.audit.AuditLog"
                }
            },
            "log": {
                "level": "NOTICE",
                "logger": "projects/test-project/logs/cloudaudit.googleapis.com%2Factivity"
            },
            "related": {
                "entity": [
                    "admin@elastic.co",
                    "user:admin@elastic.co",
                    "projects/test-project/serviceAccounts/users/alice@example.com"
                ],
                "ip": [
                    "198.51.100.1"
                ],
                "user": [
                    "admin@elastic.co"
                ]
            },
            "service": {
                "name": "iam.googleapis.com",
                "target": {
                    "entity": {
                        "id": [
                            "projects/test-project/serviceAccounts/users/alice@example.com"
                        ]
                    }
                }
            },
            "source": {
                "as": {
                    "number": 64501,
                    "organization": {
                        "name": "Documentation ASN"
                    }
                },
                "geo": {
                    "city_name": "Amsterdam",
                    "continent_name": "Europe",
                    "country_iso_code": "NL",
                    "country_name": "Netherlands",
                    "location": {
                        "lat": 52.37404,
                        "lon": 4.88969
                    },
                    "region_iso_code": "NL-NH",
                    "region_name": "North Holland"
                },
                "ip": "198.51.100.1"
            },
            "tags": [
                "preserve_original_event"
            ],
            "target": {
                "entity": {
                    "id": [
                        "projects/test-project/serviceAccounts/users/alice@example.com"
                    ]
                }
            },
            "user": {
                "entity": {
                    "id": [
                        "user:admin@elastic.co",
                        "admin@elastic.co"
                    ]
                }
            }
        },
        {
            "@timestamp": "2024-11-06T11:01:00.000Z",
            "actor": {
                "entity": {
                    "id": [
                        "superadmin@company.com"
                    ]
                }
            },
            "client": {
                "user": {
                    "email": "superadmin@company.com"
                }
            },
            "cloud": {
                "project": {
                    "id": "test-project"
                },
                "provider": "gcp"
            },
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "SetIamPolicy",
                "category": [
                    "network",
                    "configuration"
                ],
                "id": "test-user-target-2",
                "kind": "event",
                "original": "{\"insertId\":\"test-user-target-2\",\"logName\":\"projects/test-project/logs/cloudaudit.googleapis.com%2Factivity\",\"protoPayload\":{\"@type\":\"type.googleapis.com/google.cloud.audit.AuditLog\",\"authenticationInfo\":{\"principalEmail\":\"superadmin@company.com\"},\"authorizationInfo\":[{\"granted\":true,\"permission\":\"resourcemanager.projects.setIamPolicy\",\"resourceAttributes\":{}}],\"methodName\":\"SetIamPolicy\",\"requestMetadata\":{\"callerIp\":\"198.51.100.2\"},\"resourceName\":\"projects/test-project/groups/engineering-team\",\"serviceName\":\"cloudresourcemanager.googleapis.com\"},\"receiveTimestamp\":\"2024-11-06T11:01:00.000000Z\",\"resource\":{\"labels\":{\"project_id\":\"test-project\"},\"type\":\"project\"},\"severity\":\"NOTICE\",\"timestamp\":\"2024-11-06T11:01:00.000000Z\"}",
                "outcome": "success",
                "provider": "activity",
                "type": [
                    "access",
                    "allowed"
                ]
            },
            "gcp": {
                "audit": {
                    "authorization_info": [
                        {
                            "granted": true,
                            "permission": "resourcemanager.projects.setIamPolicy"
                        }
                    ],
                    "receive_timestamp": "2024-11-06T11:01:00.000Z",
                    "resource": {
                        "type": "project"
                    },
                    "resource_name": "projects/test-project/groups/engineering-team",
                    "type": "type.googleapis.com/google.cloud.audit.AuditLog"
                }
            },
            "log": {
                "level": "NOTICE",
                "logger": "projects/test-project/logs/cloudaudit.googleapis.com%2Factivity"
            },
            "related": {
                "entity": [
                    "projects/test-project/groups/engineering-team",
                    "superadmin@company.com"
                ],
                "ip": [
                    "198.51.100.2"
                ],
                "user": [
                    "superadmin@company.com"
                ]
            },
            "service": {
                "name": "cloudresourcemanager.googleapis.com"
            },
            "source": {
                "as": {
                    "number": 64501,
                    "organization": {
                        "name": "Documentation ASN"
                    }
                },
                "geo": {
                    "city_name": "Amsterdam",
                    "continent_name": "Europe",
                    "country_iso_code": "NL",
                    "country_name": "Netherlands",
                    "location": {
                        "lat": 52.37404,
                        "lon": 4.88969
                    },
                    "region_iso_code": "NL-NH",
                    "region_name": "North Holland"
                },
                "ip": "198.51.100.2"
            },
            "tags": [
                "preserve_original_event"
            ],
            "target": {
                "entity": {
                    "id": [
                        "projects/test-project/groups/engineering-team"
                    ]
                }
            },
            "user": {
                "entity": {
                    "id": [
                        "superadmin@company.com"
                    ]
                },
                "target": {
                    "entity": {
                        "id": [
                            "projects/test-project/groups/engineering-team"
                        ]
                    }
                }
            }
        }
    ]
}
