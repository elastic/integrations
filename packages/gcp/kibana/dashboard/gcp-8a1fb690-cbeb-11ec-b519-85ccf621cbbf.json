{
    "attributes": {
        "description": "Overview of the firewall log data from Google Cloud.",
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": {
                "filter": [
                    {
                        "$state": {
                            "store": "appState"
                        },
                        "meta": {
                            "alias": "Only data from gcp.firewall dataset",
                            "disabled": false,
                            "indexRefName": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
                            "key": "data_stream.dataset",
                            "negate": false,
                            "params": {
                                "query": "gcp.firewall"
                            },
                            "type": "phrase"
                        },
                        "query": {
                            "match_phrase": {
                                "data_stream.dataset": "gcp.firewall"
                            }
                        }
                    }
                ],
                "query": {
                    "language": "kuery",
                    "query": ""
                }
            }
        },
        "optionsJSON": {
            "hidePanelTitles": false,
            "syncColors": false,
            "syncCursor": true,
            "syncTooltips": false,
            "useMargins": true
        },
        "panelsJSON": [
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-3a32ec4e-e826-4732-a33c-af6e11d7218e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "917600a0-613f-48df-8da5-86ea26a2614c",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "3a32ec4e-e826-4732-a33c-af6e11d7218e": {
                                            "columnOrder": [
                                                "3938f412-fdf3-4714-a1d5-a06e36a8128b",
                                                "fc59d35f-50a2-491b-b243-d55c3a2c936b"
                                            ],
                                            "columns": {
                                                "3938f412-fdf3-4714-a1d5-a06e36a8128b": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top values of cloud.project.id",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "fc59d35f-50a2-491b-b243-d55c3a2c936b",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "cloud.project.id"
                                                },
                                                "fc59d35f-50a2-491b-b243-d55c3a2c936b": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count of records",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "917600a0-613f-48df-8da5-86ea26a2614c",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "gcp.firewall"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "gcp.firewall"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "layerId": "3a32ec4e-e826-4732-a33c-af6e11d7218e",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "legendSize": "auto",
                                        "metrics": [
                                            "fc59d35f-50a2-491b-b243-d55c3a2c936b"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "3938f412-fdf3-4714-a1d5-a06e36a8128b"
                                        ]
                                    }
                                ],
                                "shape": "donut"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 11,
                    "i": "77c85299-e3b8-4338-9113-a3b56ba741c7",
                    "w": 8,
                    "x": 0,
                    "y": 0
                },
                "panelIndex": "77c85299-e3b8-4338-9113-a3b56ba741c7",
                "title": "GCP Project",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-2f350b92-4c75-4171-887e-1787cc418027",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "9fc7d90c-6a67-45c5-be92-3fec7871dfc9",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "2f350b92-4c75-4171-887e-1787cc418027": {
                                            "columnOrder": [
                                                "772e05df-b7e8-4757-bcbf-35d17f2faec7",
                                                "e93ea5b6-65da-4993-a462-fb610a41824b"
                                            ],
                                            "columns": {
                                                "772e05df-b7e8-4757-bcbf-35d17f2faec7": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top values of cloud.region",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "e93ea5b6-65da-4993-a462-fb610a41824b",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "cloud.region"
                                                },
                                                "e93ea5b6-65da-4993-a462-fb610a41824b": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count of records",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "9fc7d90c-6a67-45c5-be92-3fec7871dfc9",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "gcp.firewall"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "gcp.firewall"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "layerId": "2f350b92-4c75-4171-887e-1787cc418027",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "legendSize": "auto",
                                        "metrics": [
                                            "e93ea5b6-65da-4993-a462-fb610a41824b"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "772e05df-b7e8-4757-bcbf-35d17f2faec7"
                                        ]
                                    }
                                ],
                                "shape": "donut"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 11,
                    "i": "0fc7a288-d3c6-4f18-8d0e-ca3c0f66aeb6",
                    "w": 8,
                    "x": 8,
                    "y": 0
                },
                "panelIndex": "0fc7a288-d3c6-4f18-8d0e-ca3c0f66aeb6",
                "title": "GCP region",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-654ef7b2-0b28-4fc9-82a4-95e925db36a6",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "13a20dda-d7f4-41e4-adea-8aff30111125",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "654ef7b2-0b28-4fc9-82a4-95e925db36a6": {
                                            "columnOrder": [
                                                "1ffd51e6-7ef8-4109-ad72-3d5e90bbdb31",
                                                "95c9e43b-8993-46f0-b21f-09a26f940dbb"
                                            ],
                                            "columns": {
                                                "1ffd51e6-7ef8-4109-ad72-3d5e90bbdb31": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top values of gcp.firewall.rule_details.direction",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "95c9e43b-8993-46f0-b21f-09a26f940dbb",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "gcp.firewall.rule_details.direction"
                                                },
                                                "95c9e43b-8993-46f0-b21f-09a26f940dbb": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count of records",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "13a20dda-d7f4-41e4-adea-8aff30111125",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "gcp.firewall"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "gcp.firewall"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "layerId": "654ef7b2-0b28-4fc9-82a4-95e925db36a6",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "legendSize": "auto",
                                        "metrics": [
                                            "95c9e43b-8993-46f0-b21f-09a26f940dbb"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "1ffd51e6-7ef8-4109-ad72-3d5e90bbdb31"
                                        ]
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 11,
                    "i": "fe15fb67-185b-426d-a575-86a6570e9b39",
                    "w": 8,
                    "x": 16,
                    "y": 0
                },
                "panelIndex": "fe15fb67-185b-426d-a575-86a6570e9b39",
                "title": "Rule direction",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-1f9dacfe-adbe-4312-8752-e6ef33190614",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "23fc92ff-ea76-4e2a-9310-9aa7db29ccdb",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "1f9dacfe-adbe-4312-8752-e6ef33190614": {
                                            "columnOrder": [
                                                "428cb2ae-d9d0-4f84-8771-9045dc7ad6b2",
                                                "513d8907-d730-452a-8949-a1253e54092f"
                                            ],
                                            "columns": {
                                                "428cb2ae-d9d0-4f84-8771-9045dc7ad6b2": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top values of gcp.firewall.rule_details.action",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "513d8907-d730-452a-8949-a1253e54092f",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "gcp.firewall.rule_details.action"
                                                },
                                                "513d8907-d730-452a-8949-a1253e54092f": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count of records",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "23fc92ff-ea76-4e2a-9310-9aa7db29ccdb",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "gcp.firewall"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "gcp.firewall"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "layerId": "1f9dacfe-adbe-4312-8752-e6ef33190614",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "legendSize": "auto",
                                        "metrics": [
                                            "513d8907-d730-452a-8949-a1253e54092f"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "428cb2ae-d9d0-4f84-8771-9045dc7ad6b2"
                                        ]
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 11,
                    "i": "5e11178e-7303-48dc-8549-73e80f5c9b2c",
                    "w": 8,
                    "x": 24,
                    "y": 0
                },
                "panelIndex": "5e11178e-7303-48dc-8549-73e80f5c9b2c",
                "title": "Rule action",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-9c02e90f-5fb4-4c58-9c74-bf76f2b246fc",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "1d06d2aa-1d79-4322-a98d-3b012910b97b",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "9c02e90f-5fb4-4c58-9c74-bf76f2b246fc": {
                                            "columnOrder": [
                                                "b24ed9f4-2bd9-42fd-8924-f63ad2780146",
                                                "6ce82469-1771-4f1a-96af-1387e676492f"
                                            ],
                                            "columns": {
                                                "6ce82469-1771-4f1a-96af-1387e676492f": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count of records",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "b24ed9f4-2bd9-42fd-8924-f63ad2780146": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top values of gcp.firewall.rule_details.ip_port_info.ip_protocol",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "6ce82469-1771-4f1a-96af-1387e676492f",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "size": 7
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "gcp.firewall.rule_details.ip_port_info.ip_protocol"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "1d06d2aa-1d79-4322-a98d-3b012910b97b",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "gcp.firewall"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "gcp.firewall"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "layerId": "9c02e90f-5fb4-4c58-9c74-bf76f2b246fc",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "legendSize": "auto",
                                        "metrics": [
                                            "6ce82469-1771-4f1a-96af-1387e676492f"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "b24ed9f4-2bd9-42fd-8924-f63ad2780146"
                                        ]
                                    }
                                ],
                                "shape": "donut"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 11,
                    "i": "735c4030-d5b3-459c-9000-427ca5cb9d70",
                    "w": 8,
                    "x": 32,
                    "y": 0
                },
                "panelIndex": "735c4030-d5b3-459c-9000-427ca5cb9d70",
                "title": "Protocols",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-49f72f3e-4ec2-418f-8183-30f7ca58c8e7",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "1518d141-10d3-459d-9fc2-f4aa855cd235",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "49f72f3e-4ec2-418f-8183-30f7ca58c8e7": {
                                            "columnOrder": [
                                                "9162c285-d838-46ea-99c3-54cf59ec1a1d",
                                                "5783f5fa-33c4-407f-8ee6-b0e7d693e993"
                                            ],
                                            "columns": {
                                                "5783f5fa-33c4-407f-8ee6-b0e7d693e993": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Events",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "9162c285-d838-46ea-99c3-54cf59ec1a1d": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Target Tag",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "5783f5fa-33c4-407f-8ee6-b0e7d693e993",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "gcp.firewall.rule_details.target_tag"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "1518d141-10d3-459d-9fc2-f4aa855cd235",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "gcp.firewall"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "gcp.firewall"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "layerId": "49f72f3e-4ec2-418f-8183-30f7ca58c8e7",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "legendSize": "auto",
                                        "metrics": [
                                            "5783f5fa-33c4-407f-8ee6-b0e7d693e993"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "9162c285-d838-46ea-99c3-54cf59ec1a1d"
                                        ]
                                    }
                                ],
                                "shape": "donut"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 11,
                    "i": "b8028d6f-bf4e-43a0-b19a-65047c757821",
                    "w": 8,
                    "x": 40,
                    "y": 0
                },
                "panelIndex": "b8028d6f-bf4e-43a0-b19a-65047c757821",
                "title": "Target Tag",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-942bb851-a16a-4422-afaf-8521bb72644f",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "84c18667-75dc-4425-8f07-1fc70bea1d55",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "942bb851-a16a-4422-afaf-8521bb72644f": {
                                            "columnOrder": [
                                                "ad5cb314-cb12-40c6-a623-d6ffdf0ee027",
                                                "a2c30dbc-5784-423d-a343-177a03140465",
                                                "da23fc0e-33d4-4361-8ddb-67862b6e0951"
                                            ],
                                            "columns": {
                                                "a2c30dbc-5784-423d-a343-177a03140465": {
                                                    "dataType": "date",
                                                    "isBucketed": true,
                                                    "label": "@timestamp",
                                                    "operationType": "date_histogram",
                                                    "params": {
                                                        "includeEmptyRows": true,
                                                        "interval": "auto"
                                                    },
                                                    "scale": "interval",
                                                    "sourceField": "@timestamp"
                                                },
                                                "ad5cb314-cb12-40c6-a623-d6ffdf0ee027": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top values of gcp.firewall.rule_details.action",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "da23fc0e-33d4-4361-8ddb-67862b6e0951",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 3
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "gcp.firewall.rule_details.action"
                                                },
                                                "da23fc0e-33d4-4361-8ddb-67862b6e0951": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Events",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "84c18667-75dc-4425-8f07-1fc70bea1d55",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "gcp.firewall"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "gcp.firewall"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "None",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "da23fc0e-33d4-4361-8ddb-67862b6e0951"
                                        ],
                                        "layerId": "942bb851-a16a-4422-afaf-8521bb72644f",
                                        "layerType": "data",
                                        "position": "top",
                                        "seriesType": "bar_stacked",
                                        "showGridlines": false,
                                        "splitAccessor": "ad5cb314-cb12-40c6-a623-d6ffdf0ee027",
                                        "xAccessor": "a2c30dbc-5784-423d-a343-177a03140465"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "legendSize": "auto",
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide",
                                "yLeftExtent": {
                                    "mode": "full"
                                },
                                "yRightExtent": {
                                    "mode": "full"
                                }
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 10,
                    "i": "63b2dd96-9ce1-43cc-add3-7bc34ff4b296",
                    "w": 48,
                    "x": 0,
                    "y": 11
                },
                "panelIndex": "63b2dd96-9ce1-43cc-add3-7bc34ff4b296",
                "title": "Firewall events over time",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-609d8521-e339-49d2-8564-713fd932c285",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "5350e9b4-b6d0-4ecb-b61a-d858ab6a49a8",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "609d8521-e339-49d2-8564-713fd932c285": {
                                            "columnOrder": [
                                                "f9145218-da9e-43c9-9e22-c707834256cc",
                                                "426e0fb0-db17-4e02-8fc8-60d472e450f2",
                                                "d2e14e21-2c9b-46b9-8508-288c81cbc712"
                                            ],
                                            "columns": {
                                                "426e0fb0-db17-4e02-8fc8-60d472e450f2": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": true,
                                                    "label": "Priority",
                                                    "operationType": "range",
                                                    "params": {
                                                        "maxBars": "auto",
                                                        "ranges": [
                                                            {
                                                                "from": 0,
                                                                "label": "",
                                                                "to": 1000
                                                            }
                                                        ],
                                                        "type": "histogram"
                                                    },
                                                    "scale": "interval",
                                                    "sourceField": "gcp.firewall.rule_details.priority"
                                                },
                                                "d2e14e21-2c9b-46b9-8508-288c81cbc712": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Events",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "f9145218-da9e-43c9-9e22-c707834256cc": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "VM",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "d2e14e21-2c9b-46b9-8508-288c81cbc712",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "cloud.instance.name"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "5350e9b4-b6d0-4ecb-b61a-d858ab6a49a8",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "gcp.firewall"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "gcp.firewall"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "None",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "d2e14e21-2c9b-46b9-8508-288c81cbc712"
                                        ],
                                        "layerId": "609d8521-e339-49d2-8564-713fd932c285",
                                        "layerType": "data",
                                        "position": "top",
                                        "seriesType": "bar_horizontal",
                                        "showGridlines": false,
                                        "splitAccessor": "426e0fb0-db17-4e02-8fc8-60d472e450f2",
                                        "xAccessor": "f9145218-da9e-43c9-9e22-c707834256cc"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "legendSize": "auto",
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_horizontal",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide",
                                "yLeftExtent": {
                                    "mode": "full"
                                },
                                "yRightExtent": {
                                    "mode": "full"
                                }
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 13,
                    "i": "e9a02bc3-c20c-4a38-8c75-2db4923c60a3",
                    "w": 24,
                    "x": 0,
                    "y": 21
                },
                "panelIndex": "e9a02bc3-c20c-4a38-8c75-2db4923c60a3",
                "title": "Top VMs",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-1559a734-d79f-47af-95f1-0278d058a38c",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "eefc04f6-67b4-4e6b-9351-f1484bbbb807",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "1559a734-d79f-47af-95f1-0278d058a38c": {
                                            "columnOrder": [
                                                "45e4569d-d389-4118-8079-431dd014760b",
                                                "d7154085-306d-4cf4-89bf-522a2a4dc723"
                                            ],
                                            "columns": {
                                                "45e4569d-d389-4118-8079-431dd014760b": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top values of rule.name",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "d7154085-306d-4cf4-89bf-522a2a4dc723",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "rule.name"
                                                },
                                                "d7154085-306d-4cf4-89bf-522a2a4dc723": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count of records",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "eefc04f6-67b4-4e6b-9351-f1484bbbb807",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "gcp.firewall"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "gcp.firewall"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "layerId": "1559a734-d79f-47af-95f1-0278d058a38c",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "legendSize": "auto",
                                        "metrics": [
                                            "d7154085-306d-4cf4-89bf-522a2a4dc723"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "percentDecimals": 2,
                                        "primaryGroups": [
                                            "45e4569d-d389-4118-8079-431dd014760b"
                                        ]
                                    }
                                ],
                                "shape": "treemap"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 13,
                    "i": "c704818b-a568-4142-92f0-3ff09f0fb8e6",
                    "w": 24,
                    "x": 24,
                    "y": 21
                },
                "panelIndex": "c704818b-a568-4142-92f0-3ff09f0fb8e6",
                "title": "Firewall rules",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-ced29d00-2d8b-43b9-bcc5-361f940b534c",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "c39a889b-ec8e-4b85-b88f-383a1c8e81cf",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "ced29d00-2d8b-43b9-bcc5-361f940b534c": {
                                            "columnOrder": [
                                                "3d150b77-0069-4770-8e55-38e152a4e97c",
                                                "8aa7938e-eccd-4b41-8147-ac09a0ba4b1c",
                                                "4ed872b0-f56b-4d53-b5a6-82d6f177fadc"
                                            ],
                                            "columns": {
                                                "3d150b77-0069-4770-8e55-38e152a4e97c": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": true,
                                                    "label": "Destination Port",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "4ed872b0-f56b-4d53-b5a6-82d6f177fadc",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "destination.port"
                                                },
                                                "4ed872b0-f56b-4d53-b5a6-82d6f177fadc": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Events",
                                                    "operationType": "count",
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "8aa7938e-eccd-4b41-8147-ac09a0ba4b1c": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": true,
                                                    "label": "Source IP",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "4ed872b0-f56b-4d53-b5a6-82d6f177fadc",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "source.port"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "c39a889b-ec8e-4b85-b88f-383a1c8e81cf",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "gcp.firewall"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "gcp.firewall"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "gridConfig": {
                                    "isCellLabelVisible": false,
                                    "isXAxisLabelVisible": true,
                                    "isYAxisLabelVisible": true,
                                    "type": "lens_heatmap_grid"
                                },
                                "layerId": "ced29d00-2d8b-43b9-bcc5-361f940b534c",
                                "layerType": "data",
                                "legend": {
                                    "isVisible": true,
                                    "legendSize": "auto",
                                    "maxLines": 1,
                                    "position": "right",
                                    "shouldTruncate": true,
                                    "type": "lens_heatmap_legendConfig"
                                },
                                "palette": {
                                    "accessor": "4ed872b0-f56b-4d53-b5a6-82d6f177fadc",
                                    "name": "cool",
                                    "params": {
                                        "continuity": "above",
                                        "name": "cool",
                                        "rangeMax": null,
                                        "rangeMin": 0,
                                        "reverse": false,
                                        "stops": [
                                            {
                                                "color": "#e0e8f2",
                                                "stop": 0
                                            },
                                            {
                                                "color": "#c2d2e6",
                                                "stop": 20
                                            },
                                            {
                                                "color": "#a2bcd9",
                                                "stop": 40
                                            },
                                            {
                                                "color": "#82a7cd",
                                                "stop": 60
                                            },
                                            {
                                                "color": "#6092c0",
                                                "stop": 80
                                            }
                                        ]
                                    },
                                    "type": "palette"
                                },
                                "shape": "heatmap",
                                "title": "Empty Heatmap chart",
                                "valueAccessor": "4ed872b0-f56b-4d53-b5a6-82d6f177fadc",
                                "xAccessor": "3d150b77-0069-4770-8e55-38e152a4e97c",
                                "yAccessor": "8aa7938e-eccd-4b41-8147-ac09a0ba4b1c"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsHeatmap"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 15,
                    "i": "f5d8c4eb-716d-4286-9f82-4cff620b3b11",
                    "w": 24,
                    "x": 0,
                    "y": 34
                },
                "panelIndex": "f5d8c4eb-716d-4286-9f82-4cff620b3b11",
                "title": "Events between Ports",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-ced29d00-2d8b-43b9-bcc5-361f940b534c",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "2a2409bf-8225-4d5b-8fb4-3667bc1a8da4",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "ced29d00-2d8b-43b9-bcc5-361f940b534c": {
                                            "columnOrder": [
                                                "3d150b77-0069-4770-8e55-38e152a4e97c",
                                                "8aa7938e-eccd-4b41-8147-ac09a0ba4b1c",
                                                "4ed872b0-f56b-4d53-b5a6-82d6f177fadc"
                                            ],
                                            "columns": {
                                                "3d150b77-0069-4770-8e55-38e152a4e97c": {
                                                    "customLabel": true,
                                                    "dataType": "ip",
                                                    "isBucketed": true,
                                                    "label": "Destination IP",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "4ed872b0-f56b-4d53-b5a6-82d6f177fadc",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "destination.ip"
                                                },
                                                "4ed872b0-f56b-4d53-b5a6-82d6f177fadc": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Events",
                                                    "operationType": "count",
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "8aa7938e-eccd-4b41-8147-ac09a0ba4b1c": {
                                                    "customLabel": true,
                                                    "dataType": "ip",
                                                    "isBucketed": true,
                                                    "label": "Source IP",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "4ed872b0-f56b-4d53-b5a6-82d6f177fadc",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "source.ip"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "2a2409bf-8225-4d5b-8fb4-3667bc1a8da4",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "gcp.firewall"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "gcp.firewall"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "gridConfig": {
                                    "isCellLabelVisible": false,
                                    "isXAxisLabelVisible": true,
                                    "isYAxisLabelVisible": true,
                                    "type": "lens_heatmap_grid"
                                },
                                "layerId": "ced29d00-2d8b-43b9-bcc5-361f940b534c",
                                "layerType": "data",
                                "legend": {
                                    "isVisible": true,
                                    "legendSize": "auto",
                                    "maxLines": 1,
                                    "position": "right",
                                    "shouldTruncate": true,
                                    "type": "lens_heatmap_legendConfig"
                                },
                                "palette": {
                                    "accessor": "4ed872b0-f56b-4d53-b5a6-82d6f177fadc",
                                    "name": "cool",
                                    "params": {
                                        "continuity": "above",
                                        "name": "cool",
                                        "rangeMax": null,
                                        "rangeMin": 0,
                                        "reverse": false,
                                        "stops": [
                                            {
                                                "color": "#e0e8f2",
                                                "stop": 0
                                            },
                                            {
                                                "color": "#c2d2e6",
                                                "stop": 20
                                            },
                                            {
                                                "color": "#a2bcd9",
                                                "stop": 40
                                            },
                                            {
                                                "color": "#82a7cd",
                                                "stop": 60
                                            },
                                            {
                                                "color": "#6092c0",
                                                "stop": 80
                                            }
                                        ]
                                    },
                                    "type": "palette"
                                },
                                "shape": "heatmap",
                                "title": "Empty Heatmap chart",
                                "valueAccessor": "4ed872b0-f56b-4d53-b5a6-82d6f177fadc",
                                "xAccessor": "3d150b77-0069-4770-8e55-38e152a4e97c",
                                "yAccessor": "8aa7938e-eccd-4b41-8147-ac09a0ba4b1c"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsHeatmap"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 15,
                    "i": "bfc4e50a-001c-4d8a-9074-8b1c969eabd5",
                    "w": 24,
                    "x": 24,
                    "y": 34
                },
                "panelIndex": "bfc4e50a-001c-4d8a-9074-8b1c969eabd5",
                "title": "Events between IPs",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": false,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [
                                    {
                                        "$state": {
                                            "store": "appState"
                                        },
                                        "meta": {
                                            "alias": null,
                                            "disabled": false,
                                            "field": "data_stream.dataset",
                                            "indexRefName": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
                                            "key": "data_stream.dataset",
                                            "negate": false,
                                            "params": {
                                                "query": "gcp.firewall"
                                            },
                                            "type": "phrase"
                                        },
                                        "query": {
                                            "match_phrase": {
                                                "data_stream.dataset": "gcp.firewall"
                                            }
                                        }
                                    }
                                ],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "spec": "{\r\n  $schema: https://vega.github.io/schema/vega/v3.0.json\r\n  data: [\r\n    {\r\n      // query ES based on the currently selected time range and filter string\r\n      name: rawData\r\n      url: {\r\n        %context%: true\r\n        %timefield%: @timestamp\r\n        index: logs*\r\n        body: {\r\n          size: 0\r\n          aggs: {\r\n            table: {\r\n              composite: {\r\n                size: 10000\r\n                sources: [\r\n                  {\r\n                    stk1: {\r\n                      terms: {field: \"source.domain\"}\r\n                    }\r\n                  }\r\n                  {\r\n                    stk2: {\r\n                      terms: {field: \"destination.domain\"}\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      // From the result, take just the data we are interested in\r\n      format: {property: \"aggregations.table.buckets\"}\r\n      // Convert key.stk1 -\u003e stk1 for simpler access below\r\n      transform: [\r\n        {type: \"formula\", expr: \"datum.key.stk1\", as: \"stk1\"}\r\n        {type: \"formula\", expr: \"datum.key.stk2\", as: \"stk2\"}\r\n        {type: \"formula\", expr: \"datum.doc_count\", as: \"size\"}\r\n      ]\r\n    }\r\n    {\r\n      name: nodes\r\n      source: rawData\r\n      transform: [\r\n        // when a country is selected, filter out unrelated data\r\n        {\r\n          type: filter\r\n          expr: !groupSelector || groupSelector.stk1 == datum.stk1 || groupSelector.stk2 == datum.stk2\r\n        }\r\n        // Set new key for later lookups - identifies each node\r\n        {type: \"formula\", expr: \"datum.stk1+datum.stk2\", as: \"key\"}\r\n        // instead of each table row, create two new rows,\r\n        // one for the source (stack=stk1) and one for destination node (stack=stk2).\r\n        // The country code stored in stk1 and stk2 fields is placed into grpId field.\r\n        {\r\n          type: fold\r\n          fields: [\"stk1\", \"stk2\"]\r\n          as: [\"stack\", \"grpId\"]\r\n        }\r\n        // Create a sortkey, different for stk1 and stk2 stacks.\r\n        // Space separator ensures proper sort order in some corner cases.\r\n        {\r\n          type: formula\r\n          expr: datum.stack == 'stk1' ? datum.stk1+' '+datum.stk2 : datum.stk2+' '+datum.stk1\r\n          as: sortField\r\n        }\r\n        // Calculate y0 and y1 positions for stacking nodes one on top of the other,\r\n        // independently for each stack, and ensuring they are in the proper order,\r\n        // alphabetical from the top (reversed on the y axis)\r\n        {\r\n          type: stack\r\n          groupby: [\"stack\"]\r\n          sort: {field: \"sortField\", order: \"descending\"}\r\n          field: size\r\n        }\r\n        // calculate vertical center point for each node, used to draw edges\r\n        {type: \"formula\", expr: \"(datum.y0+datum.y1)/2\", as: \"yc\"}\r\n      ]\r\n    }\r\n    {\r\n      name: groups\r\n      source: nodes\r\n      transform: [\r\n        // combine all nodes into country groups, summing up the doc counts\r\n        {\r\n          type: aggregate\r\n          groupby: [\"stack\", \"grpId\"]\r\n          fields: [\"size\"]\r\n          ops: [\"sum\"]\r\n          as: [\"total\"]\r\n        }\r\n        // re-calculate the stacking y0,y1 values\r\n        {\r\n          type: stack\r\n          groupby: [\"stack\"]\r\n          sort: {field: \"grpId\", order: \"descending\"}\r\n          field: total\r\n        }\r\n        // project y0 and y1 values to screen coordinates\r\n        // doing it once here instead of doing it several times in marks\r\n        {type: \"formula\", expr: \"scale('y', datum.y0)\", as: \"scaledY0\"}\r\n        {type: \"formula\", expr: \"scale('y', datum.y1)\", as: \"scaledY1\"}\r\n        // boolean flag if the label should be on the right of the stack\r\n        {type: \"formula\", expr: \"datum.stack == 'stk1'\", as: \"rightLabel\"}\r\n        // Calculate traffic percentage for this country using \"y\" scale\r\n        // domain upper bound, which represents the total traffic\r\n        {\r\n          type: formula\r\n          expr: datum.total/domain('y')[1]\r\n          as: percentage\r\n        }\r\n      ]\r\n    }\r\n    {\r\n      // This is a temp lookup table with all the 'stk2' stack nodes\r\n      name: destinationNodes\r\n      source: nodes\r\n      transform: [\r\n        {type: \"filter\", expr: \"datum.stack == 'stk2'\"}\r\n      ]\r\n    }\r\n    {\r\n      name: edges\r\n      source: nodes\r\n      transform: [\r\n        // we only want nodes from the left stack\r\n        {type: \"filter\", expr: \"datum.stack == 'stk1'\"}\r\n        // find corresponding node from the right stack, keep it as \"target\"\r\n        {\r\n          type: lookup\r\n          from: destinationNodes\r\n          key: key\r\n          fields: [\"key\"]\r\n          as: [\"target\"]\r\n        }\r\n        // calculate SVG link path between stk1 and stk2 stacks for the node pair\r\n        {\r\n          type: linkpath\r\n          orient: horizontal\r\n          shape: diagonal\r\n          sourceY: {expr: \"scale('y', datum.yc)\"}\r\n          sourceX: {expr: \"scale('x', 'stk1') + bandwidth('x')\"}\r\n          targetY: {expr: \"scale('y', datum.target.yc)\"}\r\n          targetX: {expr: \"scale('x', 'stk2')\"}\r\n        }\r\n        // A little trick to calculate the thickness of the line.\r\n        // The value needs to be the same as the hight of the node, but scaling\r\n        // size to screen's height gives inversed value because screen's Y\r\n        // coordinate goes from the top to the bottom, whereas the graph's Y=0\r\n        // is at the bottom. So subtracting scaled doc count from screen height\r\n        // (which is the \"lower\" bound of the \"y\" scale) gives us the right value\r\n        {\r\n          type: formula\r\n          expr: range('y')[0]-scale('y', datum.size)\r\n          as: strokeWidth\r\n        }\r\n        // Tooltip needs individual link's percentage of all traffic\r\n        {\r\n          type: formula\r\n          expr: datum.size/domain('y')[1]\r\n          as: percentage\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n  scales: [\r\n    {\r\n      // calculates horizontal stack positioning\r\n      name: x\r\n      type: band\r\n      range: width\r\n      domain: [\"stk1\", \"stk2\"]\r\n      paddingOuter: 0.05\r\n      paddingInner: 0.95\r\n    }\r\n    {\r\n      // this scale goes up as high as the highest y1 value of all nodes\r\n      name: y\r\n      type: linear\r\n      range: height\r\n      domain: {data: \"nodes\", field: \"y1\"}\r\n    }\r\n    {\r\n      // use rawData to ensure the colors stay the same when clicking.\r\n      name: color\r\n      type: ordinal\r\n      range: category\r\n      domain: {data: \"rawData\", fields: [\"stk1\", \"stk2\"]}\r\n    }\r\n    {\r\n      // this scale is used to map internal ids (stk1, stk2) to stack names\r\n      name: stackNames\r\n      type: ordinal\r\n      range: [\"Source\", \"Destination\"]\r\n      domain: [\"stk1\", \"stk2\"]\r\n    }\r\n  ]\r\n  axes: [\r\n    {\r\n      // x axis should use custom label formatting to print proper stack names\r\n      orient: bottom\r\n      scale: x\r\n      encode: {\r\n        labels: {\r\n          update: {\r\n            text: {scale: \"stackNames\", field: \"value\"}\r\n          }\r\n        }\r\n      }\r\n    }\r\n    {orient: \"left\", scale: \"y\"}\r\n  ]\r\n  marks: [\r\n    {\r\n      // draw the connecting line between stacks\r\n      type: path\r\n      name: edgeMark\r\n      from: {data: \"edges\"}\r\n      // this prevents some autosizing issues with large strokeWidth for paths\r\n      clip: true\r\n      encode: {\r\n        update: {\r\n          // By default use color of the left node, except when showing traffic\r\n          // from just one country, in which case use destination color.\r\n          stroke: [\r\n            {\r\n              test: groupSelector \u0026\u0026 groupSelector.stack=='stk1'\r\n              scale: color\r\n              field: stk2\r\n            }\r\n            {scale: \"color\", field: \"stk1\"}\r\n          ]\r\n          strokeWidth: {field: \"strokeWidth\"}\r\n          path: {field: \"path\"}\r\n          // when showing all traffic, and hovering over a country,\r\n          // highlight the traffic from that country.\r\n          strokeOpacity: {\r\n            signal: !groupSelector \u0026\u0026 (groupHover.stk1 == datum.stk1 || groupHover.stk2 == datum.stk2) ? 0.9 : 0.3\r\n          }\r\n          // Ensure that the hover-selected edges show on top\r\n          zindex: {\r\n            signal: !groupSelector \u0026\u0026 (groupHover.stk1 == datum.stk1 || groupHover.stk2 == datum.stk2) ? 1 : 0\r\n          }\r\n          // format tooltip string\r\n          tooltip: {\r\n            signal: datum.stk1 + ' \u0026#x2192; ' + datum.stk2 + '    ' + format(datum.size, ',.0f') + '   (' + format(datum.percentage, '.1%') + ')'\r\n          }\r\n        }\r\n        // Simple mouseover highlighting of a single line\r\n        hover: {\r\n          strokeOpacity: {value: 1}\r\n        }\r\n      }\r\n    }\r\n    {\r\n      // draw stack groups (countries)\r\n      type: rect\r\n      name: groupMark\r\n      from: {data: \"groups\"}\r\n      encode: {\r\n        enter: {\r\n          fill: {scale: \"color\", field: \"grpId\"}\r\n          width: {scale: \"x\", band: 1}\r\n        }\r\n        update: {\r\n          x: {scale: \"x\", field: \"stack\"}\r\n          y: {field: \"scaledY0\"}\r\n          y2: {field: \"scaledY1\"}\r\n          fillOpacity: {value: 0.6}\r\n          tooltip: {\r\n            signal: datum.grpId + '   ' + format(datum.total, ',.0f') + '   (' + format(datum.percentage, '.1%') + ')'\r\n          }\r\n        }\r\n        hover: {\r\n          fillOpacity: {value: 1}\r\n        }\r\n      }\r\n    }\r\n    {\r\n      // draw country code labels on the inner side of the stack\r\n      type: text\r\n      from: {data: \"groups\"}\r\n      // don't process events for the labels - otherwise line mouseover is unclean\r\n      interactive: false\r\n      encode: {\r\n        update: {\r\n          // depending on which stack it is, position x with some padding\r\n          x: {\r\n            signal: scale('x', datum.stack) + (datum.rightLabel ? bandwidth('x') + 8 : -8)\r\n          }\r\n          // middle of the group\r\n          yc: {signal: \"(datum.scaledY0 + datum.scaledY1)/2\"}\r\n          align: {signal: \"datum.rightLabel ? 'left' : 'right'\"}\r\n          baseline: {value: \"middle\"}\r\n          fontWeight: {value: \"bold\"}\r\n          // only show text label if the group's height is large enough\r\n          text: {signal: \"abs(datum.scaledY0-datum.scaledY1) \u003e 13 ? datum.grpId : ''\"}\r\n        }\r\n      }\r\n    }\r\n    {\r\n      // Create a \"show all\" button. Shown only when a country is selected.\r\n      type: group\r\n      data: [\r\n        // We need to make the button show only when groupSelector signal is true.\r\n        // Each mark is drawn as many times as there are elements in the backing data.\r\n        // Which means that if values list is empty, it will not be drawn.\r\n        // Here I create a data source with one empty object, and filter that list\r\n        // based on the signal value. This can only be done in a group.\r\n        {\r\n          name: dataForShowAll\r\n          values: [{}]\r\n          transform: [{type: \"filter\", expr: \"groupSelector\"}]\r\n        }\r\n      ]\r\n      // Set button size and positioning\r\n      encode: {\r\n        enter: {\r\n          xc: {signal: \"width/2\"}\r\n          y: {value: 30}\r\n          width: {value: 80}\r\n          height: {value: 30}\r\n        }\r\n      }\r\n      marks: [\r\n        {\r\n          // This group is shown as a button with rounded corners.\r\n          type: group\r\n          // mark name allows signal capturing\r\n          name: groupReset\r\n          // Only shows button if dataForShowAll has values.\r\n          from: {data: \"dataForShowAll\"}\r\n          encode: {\r\n            enter: {\r\n              cornerRadius: {value: 6}\r\n              fill: {value: \"#f5f5f5\"}\r\n              stroke: {value: \"#c1c1c1\"}\r\n              strokeWidth: {value: 2}\r\n              // use parent group's size\r\n              height: {\r\n                field: {group: \"height\"}\r\n              }\r\n              width: {\r\n                field: {group: \"width\"}\r\n              }\r\n            }\r\n            update: {\r\n              // groups are transparent by default\r\n              opacity: {value: 1}\r\n            }\r\n            hover: {\r\n              opacity: {value: 0.7}\r\n            }\r\n          }\r\n          marks: [\r\n            {\r\n              type: text\r\n              // if true, it will prevent clicking on the button when over text.\r\n              interactive: false\r\n              encode: {\r\n                enter: {\r\n                  // center text in the paren group\r\n                  xc: {\r\n                    field: {group: \"width\"}\r\n                    mult: 0.5\r\n                  }\r\n                  yc: {\r\n                    field: {group: \"height\"}\r\n                    mult: 0.5\r\n                    offset: 2\r\n                  }\r\n                  align: {value: \"center\"}\r\n                  baseline: {value: \"middle\"}\r\n                  fontWeight: {value: \"bold\"}\r\n                  text: {value: \"Show All\"}\r\n                }\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n  signals: [\r\n    {\r\n      // used to highlight traffic to/from the same country\r\n      name: groupHover\r\n      value: {}\r\n      on: [\r\n        {\r\n          events: @groupMark:mouseover\r\n          update: \"{stk1:datum.stack=='stk1' \u0026\u0026 datum.grpId, stk2:datum.stack=='stk2' \u0026\u0026 datum.grpId}\"\r\n        }\r\n        {events: \"mouseout\", update: \"{}\"}\r\n      ]\r\n    }\r\n    // used to filter only the data related to the selected country\r\n    {\r\n      name: groupSelector\r\n      value: false\r\n      on: [\r\n        {\r\n          // Clicking groupMark sets this signal to the filter values\r\n          events: @groupMark:click!\r\n          update: \"{stack:datum.stack, stk1:datum.stack=='stk1' \u0026\u0026 datum.grpId, stk2:datum.stack=='stk2' \u0026\u0026 datum.grpId}\"\r\n        }\r\n        {\r\n          // Clicking \"show all\" button, or double-clicking anywhere resets it\r\n          events: [\r\n            {type: \"click\", markname: \"groupReset\"}\r\n            {type: \"dblclick\"}\r\n          ]\r\n          update: \"false\"\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}"
                        },
                        "title": "[GCP] Sankey Source to Destination domain",
                        "type": "vega",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 15,
                    "i": "899f49c0-9400-452b-b833-5b59e3ad0338",
                    "w": 24,
                    "x": 0,
                    "y": 49
                },
                "panelIndex": "899f49c0-9400-452b-b833-5b59e3ad0338",
                "title": "Sankey Source to Destination domain",
                "type": "visualization",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": false,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [
                                    {
                                        "$state": {
                                            "store": "appState"
                                        },
                                        "meta": {
                                            "alias": null,
                                            "disabled": false,
                                            "field": "data_stream.dataset",
                                            "indexRefName": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
                                            "key": "data_stream.dataset",
                                            "negate": false,
                                            "params": {
                                                "query": "gcp.firewall"
                                            },
                                            "type": "phrase"
                                        },
                                        "query": {
                                            "match_phrase": {
                                                "data_stream.dataset": "gcp.firewall"
                                            }
                                        }
                                    }
                                ],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "spec": "{\r\n  $schema: https://vega.github.io/schema/vega/v3.0.json\r\n  data: [\r\n    {\r\n      // query ES based on the currently selected time range and filter string\r\n      name: rawData\r\n      url: {\r\n        %context%: true\r\n        %timefield%: @timestamp\r\n        index: logs*\r\n        body: {\r\n          size: 0\r\n          aggs: {\r\n            table: {\r\n              composite: {\r\n                size: 10000\r\n                sources: [\r\n                  {\r\n                    stk1: {\r\n                      terms: {field: \"gcp.source.vpc.vpc_name\"}\r\n                    }\r\n                  }\r\n                  {\r\n                    stk2: {\r\n                      terms: {field: \"gcp.destination.vpc.vpc_name\"}\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      // From the result, take just the data we are interested in\r\n      format: {property: \"aggregations.table.buckets\"}\r\n      // Convert key.stk1 -\u003e stk1 for simpler access below\r\n      transform: [\r\n        {type: \"formula\", expr: \"datum.key.stk1\", as: \"stk1\"}\r\n        {type: \"formula\", expr: \"datum.key.stk2\", as: \"stk2\"}\r\n        {type: \"formula\", expr: \"datum.doc_count\", as: \"size\"}\r\n      ]\r\n    }\r\n    {\r\n      name: nodes\r\n      source: rawData\r\n      transform: [\r\n        // when a country is selected, filter out unrelated data\r\n        {\r\n          type: filter\r\n          expr: !groupSelector || groupSelector.stk1 == datum.stk1 || groupSelector.stk2 == datum.stk2\r\n        }\r\n        // Set new key for later lookups - identifies each node\r\n        {type: \"formula\", expr: \"datum.stk1+datum.stk2\", as: \"key\"}\r\n        // instead of each table row, create two new rows,\r\n        // one for the source (stack=stk1) and one for destination node (stack=stk2).\r\n        // The country code stored in stk1 and stk2 fields is placed into grpId field.\r\n        {\r\n          type: fold\r\n          fields: [\"stk1\", \"stk2\"]\r\n          as: [\"stack\", \"grpId\"]\r\n        }\r\n        // Create a sortkey, different for stk1 and stk2 stacks.\r\n        // Space separator ensures proper sort order in some corner cases.\r\n        {\r\n          type: formula\r\n          expr: datum.stack == 'stk1' ? datum.stk1+' '+datum.stk2 : datum.stk2+' '+datum.stk1\r\n          as: sortField\r\n        }\r\n        // Calculate y0 and y1 positions for stacking nodes one on top of the other,\r\n        // independently for each stack, and ensuring they are in the proper order,\r\n        // alphabetical from the top (reversed on the y axis)\r\n        {\r\n          type: stack\r\n          groupby: [\"stack\"]\r\n          sort: {field: \"sortField\", order: \"descending\"}\r\n          field: size\r\n        }\r\n        // calculate vertical center point for each node, used to draw edges\r\n        {type: \"formula\", expr: \"(datum.y0+datum.y1)/2\", as: \"yc\"}\r\n      ]\r\n    }\r\n    {\r\n      name: groups\r\n      source: nodes\r\n      transform: [\r\n        // combine all nodes into country groups, summing up the doc counts\r\n        {\r\n          type: aggregate\r\n          groupby: [\"stack\", \"grpId\"]\r\n          fields: [\"size\"]\r\n          ops: [\"sum\"]\r\n          as: [\"total\"]\r\n        }\r\n        // re-calculate the stacking y0,y1 values\r\n        {\r\n          type: stack\r\n          groupby: [\"stack\"]\r\n          sort: {field: \"grpId\", order: \"descending\"}\r\n          field: total\r\n        }\r\n        // project y0 and y1 values to screen coordinates\r\n        // doing it once here instead of doing it several times in marks\r\n        {type: \"formula\", expr: \"scale('y', datum.y0)\", as: \"scaledY0\"}\r\n        {type: \"formula\", expr: \"scale('y', datum.y1)\", as: \"scaledY1\"}\r\n        // boolean flag if the label should be on the right of the stack\r\n        {type: \"formula\", expr: \"datum.stack == 'stk1'\", as: \"rightLabel\"}\r\n        // Calculate traffic percentage for this country using \"y\" scale\r\n        // domain upper bound, which represents the total traffic\r\n        {\r\n          type: formula\r\n          expr: datum.total/domain('y')[1]\r\n          as: percentage\r\n        }\r\n      ]\r\n    }\r\n    {\r\n      // This is a temp lookup table with all the 'stk2' stack nodes\r\n      name: destinationNodes\r\n      source: nodes\r\n      transform: [\r\n        {type: \"filter\", expr: \"datum.stack == 'stk2'\"}\r\n      ]\r\n    }\r\n    {\r\n      name: edges\r\n      source: nodes\r\n      transform: [\r\n        // we only want nodes from the left stack\r\n        {type: \"filter\", expr: \"datum.stack == 'stk1'\"}\r\n        // find corresponding node from the right stack, keep it as \"target\"\r\n        {\r\n          type: lookup\r\n          from: destinationNodes\r\n          key: key\r\n          fields: [\"key\"]\r\n          as: [\"target\"]\r\n        }\r\n        // calculate SVG link path between stk1 and stk2 stacks for the node pair\r\n        {\r\n          type: linkpath\r\n          orient: horizontal\r\n          shape: diagonal\r\n          sourceY: {expr: \"scale('y', datum.yc)\"}\r\n          sourceX: {expr: \"scale('x', 'stk1') + bandwidth('x')\"}\r\n          targetY: {expr: \"scale('y', datum.target.yc)\"}\r\n          targetX: {expr: \"scale('x', 'stk2')\"}\r\n        }\r\n        // A little trick to calculate the thickness of the line.\r\n        // The value needs to be the same as the hight of the node, but scaling\r\n        // size to screen's height gives inversed value because screen's Y\r\n        // coordinate goes from the top to the bottom, whereas the graph's Y=0\r\n        // is at the bottom. So subtracting scaled doc count from screen height\r\n        // (which is the \"lower\" bound of the \"y\" scale) gives us the right value\r\n        {\r\n          type: formula\r\n          expr: range('y')[0]-scale('y', datum.size)\r\n          as: strokeWidth\r\n        }\r\n        // Tooltip needs individual link's percentage of all traffic\r\n        {\r\n          type: formula\r\n          expr: datum.size/domain('y')[1]\r\n          as: percentage\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n  scales: [\r\n    {\r\n      // calculates horizontal stack positioning\r\n      name: x\r\n      type: band\r\n      range: width\r\n      domain: [\"stk1\", \"stk2\"]\r\n      paddingOuter: 0.05\r\n      paddingInner: 0.95\r\n    }\r\n    {\r\n      // this scale goes up as high as the highest y1 value of all nodes\r\n      name: y\r\n      type: linear\r\n      range: height\r\n      domain: {data: \"nodes\", field: \"y1\"}\r\n    }\r\n    {\r\n      // use rawData to ensure the colors stay the same when clicking.\r\n      name: color\r\n      type: ordinal\r\n      range: category\r\n      domain: {data: \"rawData\", fields: [\"stk1\", \"stk2\"]}\r\n    }\r\n    {\r\n      // this scale is used to map internal ids (stk1, stk2) to stack names\r\n      name: stackNames\r\n      type: ordinal\r\n      range: [\"Source\", \"Destination\"]\r\n      domain: [\"stk1\", \"stk2\"]\r\n    }\r\n  ]\r\n  axes: [\r\n    {\r\n      // x axis should use custom label formatting to print proper stack names\r\n      orient: bottom\r\n      scale: x\r\n      encode: {\r\n        labels: {\r\n          update: {\r\n            text: {scale: \"stackNames\", field: \"value\"}\r\n          }\r\n        }\r\n      }\r\n    }\r\n    {orient: \"left\", scale: \"y\"}\r\n  ]\r\n  marks: [\r\n    {\r\n      // draw the connecting line between stacks\r\n      type: path\r\n      name: edgeMark\r\n      from: {data: \"edges\"}\r\n      // this prevents some autosizing issues with large strokeWidth for paths\r\n      clip: true\r\n      encode: {\r\n        update: {\r\n          // By default use color of the left node, except when showing traffic\r\n          // from just one country, in which case use destination color.\r\n          stroke: [\r\n            {\r\n              test: groupSelector \u0026\u0026 groupSelector.stack=='stk1'\r\n              scale: color\r\n              field: stk2\r\n            }\r\n            {scale: \"color\", field: \"stk1\"}\r\n          ]\r\n          strokeWidth: {field: \"strokeWidth\"}\r\n          path: {field: \"path\"}\r\n          // when showing all traffic, and hovering over a country,\r\n          // highlight the traffic from that country.\r\n          strokeOpacity: {\r\n            signal: !groupSelector \u0026\u0026 (groupHover.stk1 == datum.stk1 || groupHover.stk2 == datum.stk2) ? 0.9 : 0.3\r\n          }\r\n          // Ensure that the hover-selected edges show on top\r\n          zindex: {\r\n            signal: !groupSelector \u0026\u0026 (groupHover.stk1 == datum.stk1 || groupHover.stk2 == datum.stk2) ? 1 : 0\r\n          }\r\n          // format tooltip string\r\n          tooltip: {\r\n            signal: datum.stk1 + ' \u0026#x2192; ' + datum.stk2 + '    ' + format(datum.size, ',.0f') + '   (' + format(datum.percentage, '.1%') + ')'\r\n          }\r\n        }\r\n        // Simple mouseover highlighting of a single line\r\n        hover: {\r\n          strokeOpacity: {value: 1}\r\n        }\r\n      }\r\n    }\r\n    {\r\n      // draw stack groups (countries)\r\n      type: rect\r\n      name: groupMark\r\n      from: {data: \"groups\"}\r\n      encode: {\r\n        enter: {\r\n          fill: {scale: \"color\", field: \"grpId\"}\r\n          width: {scale: \"x\", band: 1}\r\n        }\r\n        update: {\r\n          x: {scale: \"x\", field: \"stack\"}\r\n          y: {field: \"scaledY0\"}\r\n          y2: {field: \"scaledY1\"}\r\n          fillOpacity: {value: 0.6}\r\n          tooltip: {\r\n            signal: datum.grpId + '   ' + format(datum.total, ',.0f') + '   (' + format(datum.percentage, '.1%') + ')'\r\n          }\r\n        }\r\n        hover: {\r\n          fillOpacity: {value: 1}\r\n        }\r\n      }\r\n    }\r\n    {\r\n      // draw country code labels on the inner side of the stack\r\n      type: text\r\n      from: {data: \"groups\"}\r\n      // don't process events for the labels - otherwise line mouseover is unclean\r\n      interactive: false\r\n      encode: {\r\n        update: {\r\n          // depending on which stack it is, position x with some padding\r\n          x: {\r\n            signal: scale('x', datum.stack) + (datum.rightLabel ? bandwidth('x') + 8 : -8)\r\n          }\r\n          // middle of the group\r\n          yc: {signal: \"(datum.scaledY0 + datum.scaledY1)/2\"}\r\n          align: {signal: \"datum.rightLabel ? 'left' : 'right'\"}\r\n          baseline: {value: \"middle\"}\r\n          fontWeight: {value: \"bold\"}\r\n          // only show text label if the group's height is large enough\r\n          text: {signal: \"abs(datum.scaledY0-datum.scaledY1) \u003e 13 ? datum.grpId : ''\"}\r\n        }\r\n      }\r\n    }\r\n    {\r\n      // Create a \"show all\" button. Shown only when a country is selected.\r\n      type: group\r\n      data: [\r\n        // We need to make the button show only when groupSelector signal is true.\r\n        // Each mark is drawn as many times as there are elements in the backing data.\r\n        // Which means that if values list is empty, it will not be drawn.\r\n        // Here I create a data source with one empty object, and filter that list\r\n        // based on the signal value. This can only be done in a group.\r\n        {\r\n          name: dataForShowAll\r\n          values: [{}]\r\n          transform: [{type: \"filter\", expr: \"groupSelector\"}]\r\n        }\r\n      ]\r\n      // Set button size and positioning\r\n      encode: {\r\n        enter: {\r\n          xc: {signal: \"width/2\"}\r\n          y: {value: 30}\r\n          width: {value: 80}\r\n          height: {value: 30}\r\n        }\r\n      }\r\n      marks: [\r\n        {\r\n          // This group is shown as a button with rounded corners.\r\n          type: group\r\n          // mark name allows signal capturing\r\n          name: groupReset\r\n          // Only shows button if dataForShowAll has values.\r\n          from: {data: \"dataForShowAll\"}\r\n          encode: {\r\n            enter: {\r\n              cornerRadius: {value: 6}\r\n              fill: {value: \"#f5f5f5\"}\r\n              stroke: {value: \"#c1c1c1\"}\r\n              strokeWidth: {value: 2}\r\n              // use parent group's size\r\n              height: {\r\n                field: {group: \"height\"}\r\n              }\r\n              width: {\r\n                field: {group: \"width\"}\r\n              }\r\n            }\r\n            update: {\r\n              // groups are transparent by default\r\n              opacity: {value: 1}\r\n            }\r\n            hover: {\r\n              opacity: {value: 0.7}\r\n            }\r\n          }\r\n          marks: [\r\n            {\r\n              type: text\r\n              // if true, it will prevent clicking on the button when over text.\r\n              interactive: false\r\n              encode: {\r\n                enter: {\r\n                  // center text in the paren group\r\n                  xc: {\r\n                    field: {group: \"width\"}\r\n                    mult: 0.5\r\n                  }\r\n                  yc: {\r\n                    field: {group: \"height\"}\r\n                    mult: 0.5\r\n                    offset: 2\r\n                  }\r\n                  align: {value: \"center\"}\r\n                  baseline: {value: \"middle\"}\r\n                  fontWeight: {value: \"bold\"}\r\n                  text: {value: \"Show All\"}\r\n                }\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n  signals: [\r\n    {\r\n      // used to highlight traffic to/from the same country\r\n      name: groupHover\r\n      value: {}\r\n      on: [\r\n        {\r\n          events: @groupMark:mouseover\r\n          update: \"{stk1:datum.stack=='stk1' \u0026\u0026 datum.grpId, stk2:datum.stack=='stk2' \u0026\u0026 datum.grpId}\"\r\n        }\r\n        {events: \"mouseout\", update: \"{}\"}\r\n      ]\r\n    }\r\n    // used to filter only the data related to the selected country\r\n    {\r\n      name: groupSelector\r\n      value: false\r\n      on: [\r\n        {\r\n          // Clicking groupMark sets this signal to the filter values\r\n          events: @groupMark:click!\r\n          update: \"{stack:datum.stack, stk1:datum.stack=='stk1' \u0026\u0026 datum.grpId, stk2:datum.stack=='stk2' \u0026\u0026 datum.grpId}\"\r\n        }\r\n        {\r\n          // Clicking \"show all\" button, or double-clicking anywhere resets it\r\n          events: [\r\n            {type: \"click\", markname: \"groupReset\"}\r\n            {type: \"dblclick\"}\r\n          ]\r\n          update: \"false\"\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}"
                        },
                        "title": "[GCP] Sankey Source to Destination VPC",
                        "type": "vega",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 15,
                    "i": "6f5213ce-73ea-4438-88e4-b5cb5506a9c9",
                    "w": 24,
                    "x": 24,
                    "y": 49
                },
                "panelIndex": "6f5213ce-73ea-4438-88e4-b5cb5506a9c9",
                "title": "Sankey Source to Destination VPC",
                "type": "visualization",
                "version": "8.7.1"
            }
        ],
        "timeRestore": false,
        "title": "[Logs GCP] Firewall",
        "version": 1
    },
    "coreMigrationVersion": "8.7.1",
    "created_at": "2023-07-19T15:39:34.883Z",
    "id": "gcp-8a1fb690-cbeb-11ec-b519-85ccf621cbbf",
    "migrationVersion": {
        "dashboard": "8.7.0"
    },
    "references": [
        {
            "id": "logs-*",
            "name": "77c85299-e3b8-4338-9113-a3b56ba741c7:indexpattern-datasource-layer-3a32ec4e-e826-4732-a33c-af6e11d7218e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "77c85299-e3b8-4338-9113-a3b56ba741c7:917600a0-613f-48df-8da5-86ea26a2614c",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "0fc7a288-d3c6-4f18-8d0e-ca3c0f66aeb6:indexpattern-datasource-layer-2f350b92-4c75-4171-887e-1787cc418027",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "0fc7a288-d3c6-4f18-8d0e-ca3c0f66aeb6:9fc7d90c-6a67-45c5-be92-3fec7871dfc9",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "fe15fb67-185b-426d-a575-86a6570e9b39:indexpattern-datasource-layer-654ef7b2-0b28-4fc9-82a4-95e925db36a6",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "fe15fb67-185b-426d-a575-86a6570e9b39:13a20dda-d7f4-41e4-adea-8aff30111125",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "5e11178e-7303-48dc-8549-73e80f5c9b2c:indexpattern-datasource-layer-1f9dacfe-adbe-4312-8752-e6ef33190614",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "5e11178e-7303-48dc-8549-73e80f5c9b2c:23fc92ff-ea76-4e2a-9310-9aa7db29ccdb",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "735c4030-d5b3-459c-9000-427ca5cb9d70:indexpattern-datasource-layer-9c02e90f-5fb4-4c58-9c74-bf76f2b246fc",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "735c4030-d5b3-459c-9000-427ca5cb9d70:1d06d2aa-1d79-4322-a98d-3b012910b97b",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "b8028d6f-bf4e-43a0-b19a-65047c757821:indexpattern-datasource-layer-49f72f3e-4ec2-418f-8183-30f7ca58c8e7",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "b8028d6f-bf4e-43a0-b19a-65047c757821:1518d141-10d3-459d-9fc2-f4aa855cd235",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "63b2dd96-9ce1-43cc-add3-7bc34ff4b296:indexpattern-datasource-layer-942bb851-a16a-4422-afaf-8521bb72644f",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "63b2dd96-9ce1-43cc-add3-7bc34ff4b296:84c18667-75dc-4425-8f07-1fc70bea1d55",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "e9a02bc3-c20c-4a38-8c75-2db4923c60a3:indexpattern-datasource-layer-609d8521-e339-49d2-8564-713fd932c285",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "e9a02bc3-c20c-4a38-8c75-2db4923c60a3:5350e9b4-b6d0-4ecb-b61a-d858ab6a49a8",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c704818b-a568-4142-92f0-3ff09f0fb8e6:indexpattern-datasource-layer-1559a734-d79f-47af-95f1-0278d058a38c",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c704818b-a568-4142-92f0-3ff09f0fb8e6:eefc04f6-67b4-4e6b-9351-f1484bbbb807",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "f5d8c4eb-716d-4286-9f82-4cff620b3b11:indexpattern-datasource-layer-ced29d00-2d8b-43b9-bcc5-361f940b534c",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "f5d8c4eb-716d-4286-9f82-4cff620b3b11:c39a889b-ec8e-4b85-b88f-383a1c8e81cf",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "bfc4e50a-001c-4d8a-9074-8b1c969eabd5:indexpattern-datasource-layer-ced29d00-2d8b-43b9-bcc5-361f940b534c",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "bfc4e50a-001c-4d8a-9074-8b1c969eabd5:2a2409bf-8225-4d5b-8fb4-3667bc1a8da4",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "899f49c0-9400-452b-b833-5b59e3ad0338:kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "6f5213ce-73ea-4438-88e4-b5cb5506a9c9:kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
            "type": "index-pattern"
        }
    ],
    "type": "dashboard"
}