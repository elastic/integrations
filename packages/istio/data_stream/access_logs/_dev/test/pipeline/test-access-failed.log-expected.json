{
    "expected": [
        {
            "@timestamp": "2022-06-22T10:17:14.118Z",
            "ecs": {
                "version": "8.3.0"
            },
            "event": {
                "category": [
                    "web"
                ],
                "created": "2020-04-28T11:07:58.223Z",
                "id": "5735b2d0-4949-9384-b082-9d4c368eb9dc",
                "ingested": "2022-09-01T12:52:50.048697585Z",
                "kind": "event",
                "module": "istio",
                "original": "[2022-06-22T10:17:14.118Z] \"GET /status/418 HTTP/1.1\" 503 UH no_healthy_upstream - \"-\" 0 19 1 - \"-\" \"curl/7.83.1-DEV\" \"5735b2d0-4949-9384-b082-9d4c368eb9dc\" \"httpbin:8000\" \"-\" outbound|8000||httpbin.default.svc.cluster.local - 10.99.37.119:8000 172.17.0.6:44690 - default",
                "outcome": "failure",
                "type": [
                    "access"
                ]
            },
            "http": {
                "request": {
                    "body": {
                        "bytes": 19
                    },
                    "id": "5735b2d0-4949-9384-b082-9d4c368eb9dc",
                    "method": "GET"
                },
                "response": {
                    "body": {
                        "bytes": 0
                    },
                    "status_code": 503
                },
                "version": "1.1"
            },
            "istio": {
                "access": {
                    "authority": "httpbin:8000",
                    "bytes": {
                        "received": 0,
                        "sent": 19
                    },
                    "downstream": {
                        "local_address": "10.99.37.119:8000",
                        "remote_address": "172.17.0.6:44690"
                    },
                    "duration": 1,
                    "response": {
                        "code_details": "no_healthy_upstream",
                        "flags": "UH"
                    },
                    "route_name": "default",
                    "upstream": {
                        "cluster": "outbound|8000||httpbin.default.svc.cluster.local"
                    }
                }
            },
            "network": {
                "protocol": "http",
                "transport": "tcp"
            },
            "related": {
                "ip": [
                    "172.17.0.6"
                ]
            },
            "source": {
                "address": "172.17.0.6:44690",
                "ip": "172.17.0.6",
                "port": 44690
            },
            "tags": [
                "preserve_original_event"
            ],
            "url": {
                "original": "/status/418"
            },
            "user_agent": {
                "device": {
                    "name": "Other"
                },
                "name": "curl",
                "original": "curl/7.83.1-DEV",
                "version": "7.83.1"
            }
        },
        {
            "@timestamp": "2022-06-22T10:27:00.362Z",
            "destination": {
                "address": "172.17.0.7:80",
                "ip": "172.17.0.7",
                "port": 80
            },
            "ecs": {
                "version": "8.3.0"
            },
            "event": {
                "category": [
                    "web"
                ],
                "created": "2020-04-28T11:07:58.223Z",
                "duration": 25000000,
                "id": "adc1465d-589f-9119-bdcf-2ea373ff7d7a",
                "ingested": "2022-09-01T12:52:50.048706627Z",
                "kind": "event",
                "module": "istio",
                "original": "[2022-06-22T10:27:00.362Z] \"GET /status/418 HTTP/1.1\" 418 - via_upstream - \"-\" 0 135 25 25 \"-\" \"curl/7.83.1-DEV\" \"adc1465d-589f-9119-bdcf-2ea373ff7d7a\" \"httpbin:8000\" \"172.17.0.7:80\" outbound|8000||httpbin.default.svc.cluster.local 172.17.0.6:57130 10.99.37.119:8000 172.17.0.6:50514 - default",
                "outcome": "failure",
                "type": [
                    "access"
                ]
            },
            "http": {
                "request": {
                    "body": {
                        "bytes": 135
                    },
                    "id": "adc1465d-589f-9119-bdcf-2ea373ff7d7a",
                    "method": "GET"
                },
                "response": {
                    "body": {
                        "bytes": 0
                    },
                    "status_code": 418
                },
                "version": "1.1"
            },
            "istio": {
                "access": {
                    "authority": "httpbin:8000",
                    "bytes": {
                        "received": 0,
                        "sent": 135
                    },
                    "downstream": {
                        "local_address": "10.99.37.119:8000",
                        "remote_address": "172.17.0.6:50514"
                    },
                    "duration": 25,
                    "response": {
                        "code_details": "via_upstream"
                    },
                    "route_name": "default",
                    "upstream": {
                        "cluster": "outbound|8000||httpbin.default.svc.cluster.local",
                        "host": "172.17.0.7:80",
                        "local_address": "172.17.0.6:57130",
                        "service_time": 25
                    }
                }
            },
            "network": {
                "community_id": "1:TaDghxLP5ONy+/xDrUziNfiFI5s=",
                "protocol": "http",
                "transport": "tcp"
            },
            "related": {
                "ip": [
                    "172.17.0.6",
                    "172.17.0.7"
                ]
            },
            "source": {
                "address": "172.17.0.6:50514",
                "ip": "172.17.0.6",
                "port": 50514
            },
            "tags": [
                "preserve_original_event"
            ],
            "url": {
                "original": "/status/418"
            },
            "user_agent": {
                "device": {
                    "name": "Other"
                },
                "name": "curl",
                "original": "curl/7.83.1-DEV",
                "version": "7.83.1"
            }
        },
        {
            "@timestamp": "2022-09-01T09:50:40.396Z",
            "ecs": {
                "version": "8.3.0"
            },
            "event": {
                "category": [
                    "web"
                ],
                "created": "2020-04-28T11:07:58.223Z",
                "id": "5169ae9d-b98e-9d3c-bf74-2fb5bc5102f3",
                "ingested": "2022-09-01T12:52:50.048707918Z",
                "kind": "event",
                "module": "istio",
                "original": "[2022-09-01T09:50:40.396Z] \"GET /favicon.ico HTTP/1.1\" 404 NR route_not_found - \"-\" 0 0 0 - \"10.124.2.1\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36\" \"5169ae9d-b98e-9d3c-bf74-2fb5bc5102f3\" \"35.232.196.88\" \"-\" - - 10.124.2.10:8080 10.124.2.1:51978 - -",
                "outcome": "failure",
                "type": [
                    "access"
                ]
            },
            "http": {
                "request": {
                    "body": {
                        "bytes": 0
                    },
                    "id": "5169ae9d-b98e-9d3c-bf74-2fb5bc5102f3",
                    "method": "GET"
                },
                "response": {
                    "body": {
                        "bytes": 0
                    },
                    "status_code": 404
                },
                "version": "1.1"
            },
            "istio": {
                "access": {
                    "authority": "35.232.196.88",
                    "bytes": {
                        "received": 0,
                        "sent": 0
                    },
                    "downstream": {
                        "local_address": "10.124.2.10:8080",
                        "remote_address": "10.124.2.1:51978"
                    },
                    "duration": 0,
                    "response": {
                        "code_details": "route_not_found",
                        "flags": "NR"
                    },
                    "x-forwarded-for": "10.124.2.1"
                }
            },
            "network": {
                "protocol": "http",
                "transport": "tcp"
            },
            "related": {
                "ip": [
                    "10.124.2.1"
                ]
            },
            "source": {
                "address": "10.124.2.1:51978",
                "ip": "10.124.2.1",
                "port": 51978
            },
            "tags": [
                "preserve_original_event"
            ],
            "url": {
                "original": "/favicon.ico"
            },
            "user_agent": {
                "device": {
                    "name": "Mac"
                },
                "name": "Chrome",
                "original": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36",
                "os": {
                    "full": "Mac OS X 10.15.7",
                    "name": "Mac OS X",
                    "version": "10.15.7"
                },
                "version": "104.0.5112.102"
            }
        },
        {
            "@timestamp": "2022-09-01T11:33:22.455Z",
            "ecs": {
                "version": "8.3.0"
            },
            "event": {
                "category": [
                    "web"
                ],
                "created": "2020-04-28T11:07:58.223Z",
                "id": "ae9ca454-2d21-956c-9cf4-813929267bb5",
                "ingested": "2022-09-01T12:52:50.048709043Z",
                "kind": "event",
                "module": "istio",
                "original": "[2022-09-01T11:33:22.455Z] \"GET /portal/redlion HTTP/1.1\" 404 NR route_not_found - \"-\" 0 0 0 - \"10.124.2.1\" \"Mozilla/5.0 zgrab/0.x\" \"ae9ca454-2d21-956c-9cf4-813929267bb5\" \"35.232.196.88\" \"-\" - - 10.124.2.10:8080 10.124.2.1:46713 - -",
                "outcome": "failure",
                "type": [
                    "access"
                ]
            },
            "http": {
                "request": {
                    "body": {
                        "bytes": 0
                    },
                    "id": "ae9ca454-2d21-956c-9cf4-813929267bb5",
                    "method": "GET"
                },
                "response": {
                    "body": {
                        "bytes": 0
                    },
                    "status_code": 404
                },
                "version": "1.1"
            },
            "istio": {
                "access": {
                    "authority": "35.232.196.88",
                    "bytes": {
                        "received": 0,
                        "sent": 0
                    },
                    "downstream": {
                        "local_address": "10.124.2.10:8080",
                        "remote_address": "10.124.2.1:46713"
                    },
                    "duration": 0,
                    "response": {
                        "code_details": "route_not_found",
                        "flags": "NR"
                    },
                    "x-forwarded-for": "10.124.2.1"
                }
            },
            "network": {
                "protocol": "http",
                "transport": "tcp"
            },
            "related": {
                "ip": [
                    "10.124.2.1"
                ]
            },
            "source": {
                "address": "10.124.2.1:46713",
                "ip": "10.124.2.1",
                "port": 46713
            },
            "tags": [
                "preserve_original_event"
            ],
            "url": {
                "original": "/portal/redlion"
            },
            "user_agent": {
                "device": {
                    "name": "Other"
                },
                "name": "Other",
                "original": "Mozilla/5.0 zgrab/0.x"
            }
        },
        {
            "@timestamp": "2022-09-01T09:36:33.553Z",
            "ecs": {
                "version": "8.3.0"
            },
            "event": {
                "created": "2020-04-28T11:07:58.223Z",
                "ingested": "2022-09-01T12:52:50.048709918Z",
                "kind": "event",
                "module": "istio",
                "original": "[2022-09-01T09:36:33.553Z] \"- - HTTP/1.1\" 400 DPE http1.codec_error - \"-\" 0 11 46 - \"-\" \"-\" \"-\" \"-\" \"-\" - - 10.124.2.10:8080 10.128.0.60:51643 - -",
                "outcome": "failure"
            },
            "http": {
                "request": {
                    "body": {
                        "bytes": 11
                    }
                },
                "response": {
                    "body": {
                        "bytes": 0
                    },
                    "status_code": 400
                },
                "version": "1.1"
            },
            "istio": {
                "access": {
                    "bytes": {
                        "received": 0,
                        "sent": 11
                    },
                    "downstream": {
                        "local_address": "10.124.2.10:8080",
                        "remote_address": "10.128.0.60:51643"
                    },
                    "duration": 46,
                    "response": {
                        "code_details": "http1.codec_error",
                        "flags": "DPE"
                    }
                }
            },
            "network": {
                "protocol": "http",
                "transport": "tcp"
            },
            "related": {
                "ip": [
                    "10.128.0.60"
                ]
            },
            "source": {
                "address": "10.128.0.60:51643",
                "ip": "10.128.0.60",
                "port": 51643
            },
            "tags": [
                "preserve_original_event"
            ]
        }
    ]
}