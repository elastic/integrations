{
  "attributes": {
    "title": "[AWS VPC OTEL] Traffic Analysis",
    "description": "Detailed traffic distribution, source analysis, and security deep dive",
    "panelsJSON": "[{\"panelIndex\": \"5ec9d4e9-3f1c-8f1e-41f0-eb022308081d\", \"gridData\": {\"x\": 0, \"y\": 0, \"w\": 48, \"h\": 2, \"i\": \"5ec9d4e9-3f1c-8f1e-41f0-eb022308081d\"}, \"type\": \"links\", \"embeddableConfig\": {\"enhancements\": {}, \"attributes\": {\"layout\": \"horizontal\", \"links\": [{\"id\": \"3af4ba12-6f83-488a-bdc9-0c7216a22d73\", \"order\": 0, \"label\": \"Overview\", \"type\": \"dashboardLink\", \"destinationRefName\": \"link_3af4ba12-6f83-488a-bdc9-0c7216a22d73_dashboard\"}, {\"id\": \"ef117464-3e9c-10b3-bb29-d1d6f9d3c452\", \"order\": 1, \"label\": \"Traffic Analysis\", \"type\": \"dashboardLink\", \"destinationRefName\": \"link_ef117464-3e9c-10b3-bb29-d1d6f9d3c452_dashboard\"}, {\"id\": \"1f78b936-37d7-285d-d766-136934e7d1c5\", \"order\": 2, \"label\": \"Interface Analysis\", \"type\": \"dashboardLink\", \"destinationRefName\": \"link_1f78b936-37d7-285d-d766-136934e7d1c5_dashboard\"}]}}}, {\"panelIndex\": \"d52e5724-45e6-6551-60c3-8d99b4e5c435\", \"gridData\": {\"x\": 0, \"y\": 2, \"w\": 10, \"h\": 4, \"i\": \"d52e5724-45e6-6551-60c3-8d99b4e5c435\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"hidePanelTitles\": true, \"attributes\": {\"title\": \"Total Flow Records\", \"visualizationType\": \"lnsMetric\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layerId\": \"ef16c77d-474f-0e07-5ef4-bd4b64978a9e\", \"layerType\": \"data\", \"metricAccessor\": \"673e6b96-cdc3-3207-b791-0b3f4fb41dba\", \"showBar\": false}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\"\\n| STATS total_flows = COUNT()\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"ef16c77d-474f-0e07-5ef4-bd4b64978a9e\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\"\\n| STATS total_flows = COUNT()\"}, \"columns\": [{\"fieldName\": \"total_flows\", \"columnId\": \"673e6b96-cdc3-3207-b791-0b3f4fb41dba\", \"label\": \"Flow Records\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"allColumns\": [{\"fieldName\": \"total_flows\", \"columnId\": \"673e6b96-cdc3-3207-b791-0b3f4fb41dba\", \"label\": \"Flow Records\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"19ea32b5-8afa-4855-772a-64f301699a2f\", \"gridData\": {\"x\": 10, \"y\": 2, \"w\": 10, \"h\": 4, \"i\": \"19ea32b5-8afa-4855-772a-64f301699a2f\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"hidePanelTitles\": true, \"attributes\": {\"title\": \"Unique Source IPs\", \"visualizationType\": \"lnsMetric\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layerId\": \"e77e8578-c3d7-93b4-9b94-c8612ee5d922\", \"layerType\": \"data\", \"metricAccessor\": \"9d5d3b2a-5721-b422-3a22-7d5f0e4a5c8d\", \"showBar\": false}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND source.address IS NOT NULL\\n| STATS unique_sources = COUNT_DISTINCT(source.address)\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"e77e8578-c3d7-93b4-9b94-c8612ee5d922\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND source.address IS NOT NULL\\n| STATS unique_sources = COUNT_DISTINCT(source.address)\"}, \"columns\": [{\"fieldName\": \"unique_sources\", \"columnId\": \"9d5d3b2a-5721-b422-3a22-7d5f0e4a5c8d\", \"label\": \"Unique Sources\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"allColumns\": [{\"fieldName\": \"unique_sources\", \"columnId\": \"9d5d3b2a-5721-b422-3a22-7d5f0e4a5c8d\", \"label\": \"Unique Sources\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"c2a2f81c-d9b7-ae27-a260-b59ed2e01a55\", \"gridData\": {\"x\": 20, \"y\": 2, \"w\": 9, \"h\": 4, \"i\": \"c2a2f81c-d9b7-ae27-a260-b59ed2e01a55\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"hidePanelTitles\": true, \"attributes\": {\"title\": \"Unique Destination IPs\", \"visualizationType\": \"lnsMetric\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layerId\": \"91098f81-a84e-b536-b595-9947df7e0286\", \"layerType\": \"data\", \"metricAccessor\": \"6f71393e-a5d6-8aea-79e8-bf89db24a2cd\", \"showBar\": false}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND destination.address IS NOT NULL\\n| STATS unique_destinations = COUNT_DISTINCT(destination.address)\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"91098f81-a84e-b536-b595-9947df7e0286\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND destination.address IS NOT NULL\\n| STATS unique_destinations = COUNT_DISTINCT(destination.address)\"}, \"columns\": [{\"fieldName\": \"unique_destinations\", \"columnId\": \"6f71393e-a5d6-8aea-79e8-bf89db24a2cd\", \"label\": \"Unique Destinations\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"allColumns\": [{\"fieldName\": \"unique_destinations\", \"columnId\": \"6f71393e-a5d6-8aea-79e8-bf89db24a2cd\", \"label\": \"Unique Destinations\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"418f69a0-177f-f005-7540-23da36cd7c43\", \"gridData\": {\"x\": 29, \"y\": 2, \"w\": 10, \"h\": 4, \"i\": \"418f69a0-177f-f005-7540-23da36cd7c43\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"hidePanelTitles\": true, \"attributes\": {\"title\": \"Unique Protocols\", \"visualizationType\": \"lnsMetric\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layerId\": \"43d4fe41-3a19-c47b-8995-f399cb74b224\", \"layerType\": \"data\", \"metricAccessor\": \"e960f750-fb9b-7807-8707-6f84b1a96407\", \"showBar\": false}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND network.protocol.name IS NOT NULL\\n| STATS unique_protocols = COUNT_DISTINCT(network.protocol.name)\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"43d4fe41-3a19-c47b-8995-f399cb74b224\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND network.protocol.name IS NOT NULL\\n| STATS unique_protocols = COUNT_DISTINCT(network.protocol.name)\"}, \"columns\": [{\"fieldName\": \"unique_protocols\", \"columnId\": \"e960f750-fb9b-7807-8707-6f84b1a96407\", \"label\": \"Protocols\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"allColumns\": [{\"fieldName\": \"unique_protocols\", \"columnId\": \"e960f750-fb9b-7807-8707-6f84b1a96407\", \"label\": \"Protocols\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"a9434d8d-826a-d525-b65c-f96f447b98df\", \"gridData\": {\"x\": 39, \"y\": 2, \"w\": 9, \"h\": 4, \"i\": \"a9434d8d-826a-d525-b65c-f96f447b98df\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"hidePanelTitles\": true, \"attributes\": {\"title\": \"Unique Destination Ports\", \"visualizationType\": \"lnsMetric\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layerId\": \"bab780cb-63c4-84a4-ff61-b93bb9810e23\", \"layerType\": \"data\", \"metricAccessor\": \"4b9d811c-d13d-6e05-754f-eed400db3d9a\", \"showBar\": false}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND destination.port IS NOT NULL\\n| STATS unique_ports = COUNT_DISTINCT(destination.port)\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"bab780cb-63c4-84a4-ff61-b93bb9810e23\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND destination.port IS NOT NULL\\n| STATS unique_ports = COUNT_DISTINCT(destination.port)\"}, \"columns\": [{\"fieldName\": \"unique_ports\", \"columnId\": \"4b9d811c-d13d-6e05-754f-eed400db3d9a\", \"label\": \"Dest Ports\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"allColumns\": [{\"fieldName\": \"unique_ports\", \"columnId\": \"4b9d811c-d13d-6e05-754f-eed400db3d9a\", \"label\": \"Dest Ports\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"a3ee7fb6-d070-5ab7-c98f-b905bfa5cab9\", \"gridData\": {\"x\": 0, \"y\": 6, \"w\": 48, \"h\": 10, \"i\": \"a3ee7fb6-d070-5ab7-c98f-b905bfa5cab9\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Traffic by Action Over Time\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"99471935-94a6-3765-5318-c3cd504903a8\", \"accessors\": [\"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\"], \"layerType\": \"data\", \"seriesType\": \"area\", \"xAccessor\": \"f5872ebb-4e77-90f5-2418-365a17960f1f\", \"position\": \"top\", \"showGridlines\": false, \"splitAccessor\": \"b569b462-851f-619c-5e78-87185e395392\", \"colorMapping\": {\"assignments\": [{\"rule\": {\"type\": \"matchExactly\", \"values\": [\"REJECT\"]}, \"color\": {\"type\": \"colorCode\", \"colorCode\": \"#BD271E\"}, \"touched\": false}, {\"rule\": {\"type\": \"matchExactly\", \"values\": [\"ACCEPT\"]}, \"color\": {\"type\": \"colorCode\", \"colorCode\": \"#00BF6F\"}, \"touched\": false}], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"area\", \"legend\": {\"position\": \"right\"}, \"valueLabels\": \"hide\", \"xTitle\": \"@timestamp\", \"yTitle\": \"Flow Count\", \"yLeftTitle\": \"Flow Count\", \"axisTitlesVisibilitySettings\": {\"x\": true, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.action IS NOT NULL\\n| STATS flow_count = COUNT() BY aws.vpc.flow.action, time_bucket = BUCKET(@timestamp, 50, ?_tstart, ?_tend)\\n| SORT time_bucket ASC\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"99471935-94a6-3765-5318-c3cd504903a8\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.action IS NOT NULL\\n| STATS flow_count = COUNT() BY aws.vpc.flow.action, time_bucket = BUCKET(@timestamp, 50, ?_tstart, ?_tend)\\n| SORT time_bucket ASC\"}, \"columns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"time_bucket\", \"columnId\": \"f5872ebb-4e77-90f5-2418-365a17960f1f\", \"label\": \"Time\", \"customLabel\": true, \"meta\": {\"type\": \"date\", \"esType\": \"date\"}}, {\"fieldName\": \"aws.vpc.flow.action\", \"columnId\": \"b569b462-851f-619c-5e78-87185e395392\", \"label\": \"aws.vpc.flow.action\", \"customLabel\": false}], \"allColumns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"time_bucket\", \"columnId\": \"f5872ebb-4e77-90f5-2418-365a17960f1f\", \"label\": \"Time\", \"customLabel\": true, \"meta\": {\"type\": \"date\", \"esType\": \"date\"}}, {\"fieldName\": \"aws.vpc.flow.action\", \"columnId\": \"b569b462-851f-619c-5e78-87185e395392\", \"label\": \"aws.vpc.flow.action\", \"customLabel\": false}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"1a0ebea3-d7c3-f94a-a16a-b6fc8b15453d\", \"gridData\": {\"x\": 0, \"y\": 16, \"w\": 24, \"h\": 12, \"i\": \"1a0ebea3-d7c3-f94a-a16a-b6fc8b15453d\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Top Protocols\", \"visualizationType\": \"lnsPie\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"a7554187-7770-bf76-a312-2144a5540fb0\", \"layerType\": \"data\", \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}, \"primaryGroups\": [\"b81a2a3c-14d7-2453-2032-02b2242947ee\"], \"metrics\": [\"f9e36592-2264-8d45-f59b-cfdf0be5cb51\"], \"numberDisplay\": \"percent\", \"categoryDisplay\": \"default\", \"legendDisplay\": \"default\", \"nestedLegend\": false}], \"shape\": \"pie\"}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND network.protocol.name IS NOT NULL\\n| STATS flow_count = COUNT() BY network.protocol.name\\n| SORT flow_count DESC\\n| LIMIT 10\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"a7554187-7770-bf76-a312-2144a5540fb0\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND network.protocol.name IS NOT NULL\\n| STATS flow_count = COUNT() BY network.protocol.name\\n| SORT flow_count DESC\\n| LIMIT 10\"}, \"columns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"f9e36592-2264-8d45-f59b-cfdf0be5cb51\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"network.protocol.name\", \"columnId\": \"b81a2a3c-14d7-2453-2032-02b2242947ee\", \"label\": \"Protocol\", \"customLabel\": true}], \"allColumns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"f9e36592-2264-8d45-f59b-cfdf0be5cb51\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"network.protocol.name\", \"columnId\": \"b81a2a3c-14d7-2453-2032-02b2242947ee\", \"label\": \"Protocol\", \"customLabel\": true}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"ecf540b7-4fb4-3c72-ec6f-def8b60936ce\", \"gridData\": {\"x\": 24, \"y\": 16, \"w\": 24, \"h\": 12, \"i\": \"ecf540b7-4fb4-3c72-ec6f-def8b60936ce\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Top Destination Ports\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"323cea78-1adf-af1f-8e9e-3881254e01b0\", \"accessors\": [\"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\"], \"layerType\": \"data\", \"seriesType\": \"bar_stacked\", \"xAccessor\": \"d96118cf-e8d4-3a89-2b3e-89d5eeb3c54f\", \"position\": \"top\", \"showGridlines\": false, \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"bar_stacked\", \"legend\": {\"isVisible\": false, \"position\": \"right\"}, \"valueLabels\": \"hide\", \"yTitle\": \"Flow Count\", \"yLeftTitle\": \"Flow Count\", \"axisTitlesVisibilitySettings\": {\"x\": false, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND destination.port IS NOT NULL\\n| STATS flow_count = COUNT() BY destination.port\\n| SORT flow_count DESC\\n| LIMIT 10\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"323cea78-1adf-af1f-8e9e-3881254e01b0\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND destination.port IS NOT NULL\\n| STATS flow_count = COUNT() BY destination.port\\n| SORT flow_count DESC\\n| LIMIT 10\"}, \"columns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"destination.port\", \"columnId\": \"d96118cf-e8d4-3a89-2b3e-89d5eeb3c54f\", \"label\": \"Dest Port\", \"customLabel\": true}], \"allColumns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"destination.port\", \"columnId\": \"d96118cf-e8d4-3a89-2b3e-89d5eeb3c54f\", \"label\": \"Dest Port\", \"customLabel\": true}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"9bb34872-674a-9335-c976-5794eebc5b7e\", \"gridData\": {\"x\": 0, \"y\": 28, \"w\": 48, \"h\": 3, \"i\": \"9bb34872-674a-9335-c976-5794eebc5b7e\"}, \"type\": \"visualization\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"savedVis\": {\"type\": \"markdown\", \"id\": \"\", \"title\": \"\", \"description\": \"\", \"params\": {\"fontSize\": 12, \"openLinksInNewTab\": false, \"markdown\": \"### Source Analysis\"}, \"uiState\": {}, \"data\": {\"aggs\": [], \"searchSource\": {\"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filter\": []}}}}}, {\"panelIndex\": \"e53589c7-8eef-1911-61b5-14a75a22475e\", \"gridData\": {\"x\": 0, \"y\": 31, \"w\": 48, \"h\": 13, \"i\": \"e53589c7-8eef-1911-61b5-14a75a22475e\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Top Source IPs - Detailed\", \"visualizationType\": \"lnsDatatable\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"columns\": [{\"columnId\": \"4cb6775d-bc03-5e8b-c2d7-2ac88307ac3f\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"0e17532e-14eb-9b11-6af6-1e0ef9882621\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"77d9a380-6526-50d5-a027-461069942dc1\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"5d8547e6-f902-5398-7064-05c335d75a0b\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"ab08f77f-ca5a-892b-838b-1377e35744f9\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"ce6ccb2c-a77b-ec23-130a-fb87ed00783c\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"03088b5e-ecf3-303c-a32c-0dffe2f9b794\", \"isTransposed\": false, \"isMetric\": true}], \"layerId\": \"0171af4f-7089-bfa3-9109-8cc130c04620\", \"layerType\": \"data\", \"paging\": {\"size\": 10, \"enabled\": true}}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND source.address IS NOT NULL\\n| EVAL is_accepted = CASE(aws.vpc.flow.action == \\\"ACCEPT\\\", 1, 0)\\n| EVAL is_rejected = CASE(aws.vpc.flow.action == \\\"REJECT\\\", 1, 0)\\n| STATS total_flows = COUNT(), accepted_flows = SUM(is_accepted), rejected_flows = SUM(is_rejected), total_bytes = SUM(aws.vpc.flow.bytes), total_packets = SUM(aws.vpc.flow.packets) BY source.address\\n| EVAL rejection_rate = CASE(total_flows > 0, rejected_flows::double / total_flows::double, 0)\\n| SORT total_flows DESC\\n| LIMIT 20\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"0171af4f-7089-bfa3-9109-8cc130c04620\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND source.address IS NOT NULL\\n| EVAL is_accepted = CASE(aws.vpc.flow.action == \\\"ACCEPT\\\", 1, 0)\\n| EVAL is_rejected = CASE(aws.vpc.flow.action == \\\"REJECT\\\", 1, 0)\\n| STATS total_flows = COUNT(), accepted_flows = SUM(is_accepted), rejected_flows = SUM(is_rejected), total_bytes = SUM(aws.vpc.flow.bytes), total_packets = SUM(aws.vpc.flow.packets) BY source.address\\n| EVAL rejection_rate = CASE(total_flows > 0, rejected_flows::double / total_flows::double, 0)\\n| SORT total_flows DESC\\n| LIMIT 20\"}, \"columns\": [{\"fieldName\": \"source.address\", \"columnId\": \"4cb6775d-bc03-5e8b-c2d7-2ac88307ac3f\", \"label\": \"Source IP\", \"customLabel\": true}, {\"fieldName\": \"total_flows\", \"columnId\": \"0e17532e-14eb-9b11-6af6-1e0ef9882621\", \"label\": \"Total Flows\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"accepted_flows\", \"columnId\": \"77d9a380-6526-50d5-a027-461069942dc1\", \"label\": \"Accepted\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"rejected_flows\", \"columnId\": \"5d8547e6-f902-5398-7064-05c335d75a0b\", \"label\": \"Rejected\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"rejection_rate\", \"columnId\": \"ab08f77f-ca5a-892b-838b-1377e35744f9\", \"label\": \"Rejection %\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"percent\", \"params\": {\"decimals\": 1}}}}, {\"fieldName\": \"total_bytes\", \"columnId\": \"ce6ccb2c-a77b-ec23-130a-fb87ed00783c\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"total_packets\", \"columnId\": \"03088b5e-ecf3-303c-a32c-0dffe2f9b794\", \"label\": \"Packets\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"allColumns\": [{\"fieldName\": \"source.address\", \"columnId\": \"4cb6775d-bc03-5e8b-c2d7-2ac88307ac3f\", \"label\": \"Source IP\", \"customLabel\": true}, {\"fieldName\": \"total_flows\", \"columnId\": \"0e17532e-14eb-9b11-6af6-1e0ef9882621\", \"label\": \"Total Flows\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"accepted_flows\", \"columnId\": \"77d9a380-6526-50d5-a027-461069942dc1\", \"label\": \"Accepted\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"rejected_flows\", \"columnId\": \"5d8547e6-f902-5398-7064-05c335d75a0b\", \"label\": \"Rejected\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"rejection_rate\", \"columnId\": \"ab08f77f-ca5a-892b-838b-1377e35744f9\", \"label\": \"Rejection %\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"percent\", \"params\": {\"decimals\": 1}}}}, {\"fieldName\": \"total_bytes\", \"columnId\": \"ce6ccb2c-a77b-ec23-130a-fb87ed00783c\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"total_packets\", \"columnId\": \"03088b5e-ecf3-303c-a32c-0dffe2f9b794\", \"label\": \"Packets\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"e0e9c4a7-fe7d-308a-35cb-06988e829786\", \"gridData\": {\"x\": 0, \"y\": 44, \"w\": 48, \"h\": 3, \"i\": \"e0e9c4a7-fe7d-308a-35cb-06988e829786\"}, \"type\": \"visualization\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"savedVis\": {\"type\": \"markdown\", \"id\": \"\", \"title\": \"\", \"description\": \"\", \"params\": {\"fontSize\": 12, \"openLinksInNewTab\": false, \"markdown\": \"### Security Deep Dive\"}, \"uiState\": {}, \"data\": {\"aggs\": [], \"searchSource\": {\"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filter\": []}}}}}, {\"panelIndex\": \"fc6ede7b-5f7f-51fa-e976-4f022ce2a776\", \"gridData\": {\"x\": 0, \"y\": 47, \"w\": 24, \"h\": 12, \"i\": \"fc6ede7b-5f7f-51fa-e976-4f022ce2a776\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Rejected Traffic by Protocol\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"166cc54e-727c-50fe-e7f0-fc90a3d5b061\", \"accessors\": [\"80a1ef92-a0a7-4bbf-24e6-fcdb11e4b3c6\"], \"layerType\": \"data\", \"seriesType\": \"bar_stacked\", \"xAccessor\": \"b81a2a3c-14d7-2453-2032-02b2242947ee\", \"position\": \"top\", \"showGridlines\": false, \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"negative\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"bar_stacked\", \"legend\": {\"isVisible\": false, \"position\": \"right\"}, \"valueLabels\": \"hide\", \"yTitle\": \"Rejected Count\", \"yLeftTitle\": \"Rejected Count\", \"axisTitlesVisibilitySettings\": {\"x\": false, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.action == \\\"REJECT\\\" AND network.protocol.name IS NOT NULL\\n| STATS rejected_count = COUNT() BY network.protocol.name\\n| SORT rejected_count DESC\\n| LIMIT 10\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"166cc54e-727c-50fe-e7f0-fc90a3d5b061\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.action == \\\"REJECT\\\" AND network.protocol.name IS NOT NULL\\n| STATS rejected_count = COUNT() BY network.protocol.name\\n| SORT rejected_count DESC\\n| LIMIT 10\"}, \"columns\": [{\"fieldName\": \"rejected_count\", \"columnId\": \"80a1ef92-a0a7-4bbf-24e6-fcdb11e4b3c6\", \"label\": \"Rejected Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"network.protocol.name\", \"columnId\": \"b81a2a3c-14d7-2453-2032-02b2242947ee\", \"label\": \"Protocol\", \"customLabel\": true}], \"allColumns\": [{\"fieldName\": \"rejected_count\", \"columnId\": \"80a1ef92-a0a7-4bbf-24e6-fcdb11e4b3c6\", \"label\": \"Rejected Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"network.protocol.name\", \"columnId\": \"b81a2a3c-14d7-2453-2032-02b2242947ee\", \"label\": \"Protocol\", \"customLabel\": true}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"78530514-74bc-a2d5-8d31-bd3d0f9182f8\", \"gridData\": {\"x\": 24, \"y\": 47, \"w\": 24, \"h\": 12, \"i\": \"78530514-74bc-a2d5-8d31-bd3d0f9182f8\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Top Rejected Ports\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"718a7624-3b62-0276-69a0-d283faad8a75\", \"accessors\": [\"80a1ef92-a0a7-4bbf-24e6-fcdb11e4b3c6\"], \"layerType\": \"data\", \"seriesType\": \"bar_stacked\", \"xAccessor\": \"d96118cf-e8d4-3a89-2b3e-89d5eeb3c54f\", \"position\": \"top\", \"showGridlines\": false, \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"negative\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"bar_stacked\", \"legend\": {\"isVisible\": false, \"position\": \"right\"}, \"valueLabels\": \"hide\", \"yTitle\": \"Rejected Count\", \"yLeftTitle\": \"Rejected Count\", \"axisTitlesVisibilitySettings\": {\"x\": false, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.action == \\\"REJECT\\\" AND destination.port IS NOT NULL\\n| STATS rejected_count = COUNT() BY destination.port\\n| SORT rejected_count DESC\\n| LIMIT 10\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"718a7624-3b62-0276-69a0-d283faad8a75\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.action == \\\"REJECT\\\" AND destination.port IS NOT NULL\\n| STATS rejected_count = COUNT() BY destination.port\\n| SORT rejected_count DESC\\n| LIMIT 10\"}, \"columns\": [{\"fieldName\": \"rejected_count\", \"columnId\": \"80a1ef92-a0a7-4bbf-24e6-fcdb11e4b3c6\", \"label\": \"Rejected Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"destination.port\", \"columnId\": \"d96118cf-e8d4-3a89-2b3e-89d5eeb3c54f\", \"label\": \"Dest Port\", \"customLabel\": true}], \"allColumns\": [{\"fieldName\": \"rejected_count\", \"columnId\": \"80a1ef92-a0a7-4bbf-24e6-fcdb11e4b3c6\", \"label\": \"Rejected Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"destination.port\", \"columnId\": \"d96118cf-e8d4-3a89-2b3e-89d5eeb3c54f\", \"label\": \"Dest Port\", \"customLabel\": true}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"0800f497-4545-6bd5-8a58-c9855f670572\", \"gridData\": {\"x\": 0, \"y\": 59, \"w\": 48, \"h\": 13, \"i\": \"0800f497-4545-6bd5-8a58-c9855f670572\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Detailed Rejection Logs\", \"visualizationType\": \"lnsDatatable\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"columns\": [{\"columnId\": \"1a2627cc-4656-11d0-a70b-1eddf548e921\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"4cb6775d-bc03-5e8b-c2d7-2ac88307ac3f\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"366b4cb6-3376-f652-0125-6881c68169cd\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"d96118cf-e8d4-3a89-2b3e-89d5eeb3c54f\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"b81a2a3c-14d7-2453-2032-02b2242947ee\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"c58e61db-8bd4-f17c-021e-82a7fe50eeb5\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"ca180367-8dba-9671-069e-b19084667732\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"b9ddfc71-f60e-c020-42f2-374dc66be145\", \"isTransposed\": false, \"isMetric\": true}], \"layerId\": \"64304942-2fe5-33b8-1482-ba7c38ee5076\", \"layerType\": \"data\", \"paging\": {\"size\": 15, \"enabled\": true}}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.action == \\\"REJECT\\\"\\n| KEEP @timestamp, source.address, destination.address, destination.port, network.protocol.name, network.interface.name, aws.vpc.flow.bytes, aws.vpc.flow.packets\\n| SORT @timestamp DESC\\n| LIMIT 1000\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"64304942-2fe5-33b8-1482-ba7c38ee5076\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.action == \\\"REJECT\\\"\\n| KEEP @timestamp, source.address, destination.address, destination.port, network.protocol.name, network.interface.name, aws.vpc.flow.bytes, aws.vpc.flow.packets\\n| SORT @timestamp DESC\\n| LIMIT 1000\"}, \"columns\": [{\"fieldName\": \"@timestamp\", \"columnId\": \"1a2627cc-4656-11d0-a70b-1eddf548e921\", \"label\": \"Timestamp\", \"customLabel\": true}, {\"fieldName\": \"source.address\", \"columnId\": \"4cb6775d-bc03-5e8b-c2d7-2ac88307ac3f\", \"label\": \"Source IP\", \"customLabel\": true}, {\"fieldName\": \"destination.address\", \"columnId\": \"366b4cb6-3376-f652-0125-6881c68169cd\", \"label\": \"Destination IP\", \"customLabel\": true}, {\"fieldName\": \"destination.port\", \"columnId\": \"d96118cf-e8d4-3a89-2b3e-89d5eeb3c54f\", \"label\": \"Dest Port\", \"customLabel\": true}, {\"fieldName\": \"network.protocol.name\", \"columnId\": \"b81a2a3c-14d7-2453-2032-02b2242947ee\", \"label\": \"Protocol\", \"customLabel\": true}, {\"fieldName\": \"network.interface.name\", \"columnId\": \"c58e61db-8bd4-f17c-021e-82a7fe50eeb5\", \"label\": \"Interface\", \"customLabel\": true}, {\"fieldName\": \"aws.vpc.flow.bytes\", \"columnId\": \"ca180367-8dba-9671-069e-b19084667732\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"aws.vpc.flow.packets\", \"columnId\": \"b9ddfc71-f60e-c020-42f2-374dc66be145\", \"label\": \"Packets\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"allColumns\": [{\"fieldName\": \"@timestamp\", \"columnId\": \"1a2627cc-4656-11d0-a70b-1eddf548e921\", \"label\": \"Timestamp\", \"customLabel\": true}, {\"fieldName\": \"source.address\", \"columnId\": \"4cb6775d-bc03-5e8b-c2d7-2ac88307ac3f\", \"label\": \"Source IP\", \"customLabel\": true}, {\"fieldName\": \"destination.address\", \"columnId\": \"366b4cb6-3376-f652-0125-6881c68169cd\", \"label\": \"Destination IP\", \"customLabel\": true}, {\"fieldName\": \"destination.port\", \"columnId\": \"d96118cf-e8d4-3a89-2b3e-89d5eeb3c54f\", \"label\": \"Dest Port\", \"customLabel\": true}, {\"fieldName\": \"network.protocol.name\", \"columnId\": \"b81a2a3c-14d7-2453-2032-02b2242947ee\", \"label\": \"Protocol\", \"customLabel\": true}, {\"fieldName\": \"network.interface.name\", \"columnId\": \"c58e61db-8bd4-f17c-021e-82a7fe50eeb5\", \"label\": \"Interface\", \"customLabel\": true}, {\"fieldName\": \"aws.vpc.flow.bytes\", \"columnId\": \"ca180367-8dba-9671-069e-b19084667732\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"aws.vpc.flow.packets\", \"columnId\": \"b9ddfc71-f60e-c020-42f2-374dc66be145\", \"label\": \"Packets\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"d09c5dd0-c0f0-ed37-4ae3-43ea3972c25d\", \"gridData\": {\"x\": 0, \"y\": 72, \"w\": 48, \"h\": 3, \"i\": \"d09c5dd0-c0f0-ed37-4ae3-43ea3972c25d\"}, \"type\": \"visualization\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"savedVis\": {\"type\": \"markdown\", \"id\": \"\", \"title\": \"\", \"description\": \"\", \"params\": {\"fontSize\": 12, \"openLinksInNewTab\": false, \"markdown\": \"### Top Sources and Destinations\"}, \"uiState\": {}, \"data\": {\"aggs\": [], \"searchSource\": {\"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filter\": []}}}}}, {\"panelIndex\": \"336e6bdb-8186-5269-04a1-1cfe8763b894\", \"gridData\": {\"x\": 0, \"y\": 75, \"w\": 16, \"h\": 12, \"i\": \"336e6bdb-8186-5269-04a1-1cfe8763b894\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Top Destination Ports\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"323cea78-1adf-af1f-8e9e-3881254e01b0\", \"accessors\": [\"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\"], \"layerType\": \"data\", \"seriesType\": \"bar_stacked\", \"xAccessor\": \"d96118cf-e8d4-3a89-2b3e-89d5eeb3c54f\", \"position\": \"top\", \"showGridlines\": false, \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"bar_stacked\", \"legend\": {\"isVisible\": false, \"position\": \"right\"}, \"valueLabels\": \"hide\", \"yTitle\": \"Flow Count\", \"yLeftTitle\": \"Flow Count\", \"axisTitlesVisibilitySettings\": {\"x\": false, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND destination.port IS NOT NULL\\n| STATS flow_count = COUNT() BY destination.port\\n| SORT flow_count DESC\\n| LIMIT 10\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"323cea78-1adf-af1f-8e9e-3881254e01b0\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND destination.port IS NOT NULL\\n| STATS flow_count = COUNT() BY destination.port\\n| SORT flow_count DESC\\n| LIMIT 10\"}, \"columns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"destination.port\", \"columnId\": \"d96118cf-e8d4-3a89-2b3e-89d5eeb3c54f\", \"label\": \"Dest Port\", \"customLabel\": true}], \"allColumns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"destination.port\", \"columnId\": \"d96118cf-e8d4-3a89-2b3e-89d5eeb3c54f\", \"label\": \"Dest Port\", \"customLabel\": true}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"d3302995-9522-9062-1dfb-848a6e97ccf6\", \"gridData\": {\"x\": 16, \"y\": 75, \"w\": 16, \"h\": 12, \"i\": \"d3302995-9522-9062-1dfb-848a6e97ccf6\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Top Destination IPs\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"06b6b49f-b46a-00c2-a5e4-86112b59140f\", \"accessors\": [\"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\"], \"layerType\": \"data\", \"seriesType\": \"bar_stacked\", \"xAccessor\": \"366b4cb6-3376-f652-0125-6881c68169cd\", \"position\": \"top\", \"showGridlines\": false, \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"bar_stacked\", \"legend\": {\"isVisible\": false, \"position\": \"right\"}, \"valueLabels\": \"hide\", \"yTitle\": \"Flow Count\", \"yLeftTitle\": \"Flow Count\", \"axisTitlesVisibilitySettings\": {\"x\": false, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND destination.address IS NOT NULL\\n| STATS flow_count = COUNT() BY destination.address\\n| SORT flow_count DESC\\n| LIMIT 10\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"06b6b49f-b46a-00c2-a5e4-86112b59140f\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND destination.address IS NOT NULL\\n| STATS flow_count = COUNT() BY destination.address\\n| SORT flow_count DESC\\n| LIMIT 10\"}, \"columns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"destination.address\", \"columnId\": \"366b4cb6-3376-f652-0125-6881c68169cd\", \"label\": \"Destination IP\", \"customLabel\": true}], \"allColumns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"destination.address\", \"columnId\": \"366b4cb6-3376-f652-0125-6881c68169cd\", \"label\": \"Destination IP\", \"customLabel\": true}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"410f943c-6118-fabb-4b45-6a8cd2057490\", \"gridData\": {\"x\": 32, \"y\": 75, \"w\": 16, \"h\": 12, \"i\": \"410f943c-6118-fabb-4b45-6a8cd2057490\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Top Source IPs\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"65ab073d-79fc-eaba-a9d4-e387ed182fbf\", \"accessors\": [\"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\"], \"layerType\": \"data\", \"seriesType\": \"bar_stacked\", \"xAccessor\": \"4cb6775d-bc03-5e8b-c2d7-2ac88307ac3f\", \"position\": \"top\", \"showGridlines\": false, \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"bar_stacked\", \"legend\": {\"isVisible\": false, \"position\": \"right\"}, \"valueLabels\": \"hide\", \"yTitle\": \"Flow Count\", \"yLeftTitle\": \"Flow Count\", \"axisTitlesVisibilitySettings\": {\"x\": false, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND source.address IS NOT NULL\\n| STATS flow_count = COUNT() BY source.address\\n| SORT flow_count DESC\\n| LIMIT 10\"}, \"filters\": [], \"datasourceStates\": {\"textBased\": {\"layers\": {\"65ab073d-79fc-eaba-a9d4-e387ed182fbf\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND source.address IS NOT NULL\\n| STATS flow_count = COUNT() BY source.address\\n| SORT flow_count DESC\\n| LIMIT 10\"}, \"columns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"source.address\", \"columnId\": \"4cb6775d-bc03-5e8b-c2d7-2ac88307ac3f\", \"label\": \"Source IP\", \"customLabel\": true}], \"allColumns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"7e75e440-9f2e-7dee-7e38-c0f4e56f835e\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"number\", \"params\": {\"decimals\": 0}}}}, {\"fieldName\": \"source.address\", \"columnId\": \"4cb6775d-bc03-5e8b-c2d7-2ac88307ac3f\", \"label\": \"Source IP\", \"customLabel\": true}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}]",
    "optionsJSON": "{\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"hidePanelTitles\":false}",
    "kibanaSavedObjectMeta": {
      "searchSourceJSON": "{\"filter\":[{\"$state\":{\"store\":\"appState\"},\"meta\":{\"disabled\":false,\"negate\":false,\"alias\":null,\"type\":\"phrase\",\"key\":\"data_stream.dataset\",\"field\":\"data_stream.dataset\",\"params\":{\"query\":\"aws.vpcflow.otel\"}},\"query\":{\"match_phrase\":{\"data_stream.dataset\":\"aws.vpcflow.otel\"}}}],\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"
    },
    "timeRestore": false,
    "version": 1,
    "controlGroupInput": {
      "chainingSystem": "HIERARCHICAL",
      "controlStyle": "oneLine",
      "ignoreParentSettingsJSON": "{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}",
      "panelsJSON": "{\"e155cda7-38a2-040c-3e6a-33339866c123\":{\"grow\":false,\"order\":0,\"width\":\"medium\",\"type\":\"optionsListControl\",\"explicitInput\":{\"id\":\"e155cda7-38a2-040c-3e6a-33339866c123\",\"dataViewId\":\"logs-*\",\"fieldName\":\"cloud.account.id\",\"title\":\"Cloud Account ID\",\"searchTechnique\":\"prefix\",\"selectedOptions\":[],\"sort\":{\"by\":\"_count\",\"direction\":\"desc\"}}},\"41c0e666-862f-ba61-3001-48c7a555c788\":{\"grow\":false,\"order\":1,\"width\":\"medium\",\"type\":\"optionsListControl\",\"explicitInput\":{\"id\":\"41c0e666-862f-ba61-3001-48c7a555c788\",\"dataViewId\":\"logs-*\",\"fieldName\":\"network.interface.name\",\"title\":\"Network Interface\",\"searchTechnique\":\"prefix\",\"selectedOptions\":[],\"sort\":{\"by\":\"_count\",\"direction\":\"desc\"}}},\"a6de1714-9b30-7483-8189-4f53daa21992\":{\"grow\":false,\"order\":2,\"width\":\"small\",\"type\":\"optionsListControl\",\"explicitInput\":{\"id\":\"a6de1714-9b30-7483-8189-4f53daa21992\",\"dataViewId\":\"logs-*\",\"fieldName\":\"aws.vpc.flow.action\",\"title\":\"Action\",\"searchTechnique\":\"prefix\",\"selectedOptions\":[],\"sort\":{\"by\":\"_count\",\"direction\":\"desc\"}}},\"2ab2d2c5-ce3e-9cbb-e027-36ca1ac94987\":{\"grow\":false,\"order\":3,\"width\":\"small\",\"type\":\"optionsListControl\",\"explicitInput\":{\"id\":\"2ab2d2c5-ce3e-9cbb-e027-36ca1ac94987\",\"dataViewId\":\"logs-*\",\"fieldName\":\"network.protocol.name\",\"title\":\"Protocol\",\"searchTechnique\":\"prefix\",\"selectedOptions\":[],\"sort\":{\"by\":\"_count\",\"direction\":\"desc\"}}},\"056d9865-1eaa-90fa-a56d-28cf7d889abb\":{\"grow\":false,\"order\":4,\"width\":\"small\",\"type\":\"optionsListControl\",\"explicitInput\":{\"id\":\"056d9865-1eaa-90fa-a56d-28cf7d889abb\",\"dataViewId\":\"logs-*\",\"fieldName\":\"destination.port\",\"title\":\"Destination Port\",\"searchTechnique\":\"prefix\",\"selectedOptions\":[],\"sort\":{\"by\":\"_count\",\"direction\":\"desc\"}}},\"dc63970a-1a81-ce93-33e1-c32236299d7d\":{\"grow\":false,\"order\":5,\"width\":\"small\",\"type\":\"optionsListControl\",\"explicitInput\":{\"id\":\"dc63970a-1a81-ce93-33e1-c32236299d7d\",\"dataViewId\":\"logs-*\",\"fieldName\":\"source.port\",\"title\":\"Source Port\",\"searchTechnique\":\"prefix\",\"selectedOptions\":[],\"sort\":{\"by\":\"_count\",\"direction\":\"desc\"}}}}",
      "showApplySelections": false
    }
  },
  "coreMigrationVersion": "8.8.0",
  "created_at": "2023-10-01T00:00:00Z",
  "created_by": "admin",
  "id": "aws_vpcflow_otel-traffic",
  "managed": false,
  "references": [
    {
      "type": "dashboard",
      "id": "aws_vpcflow_otel-overview",
      "name": "5ec9d4e9-3f1c-8f1e-41f0-eb022308081d:link_3af4ba12-6f83-488a-bdc9-0c7216a22d73_dashboard"
    },
    {
      "type": "dashboard",
      "id": "aws_vpcflow_otel-traffic",
      "name": "5ec9d4e9-3f1c-8f1e-41f0-eb022308081d:link_ef117464-3e9c-10b3-bb29-d1d6f9d3c452_dashboard"
    },
    {
      "type": "dashboard",
      "id": "aws_vpcflow_otel-interface",
      "name": "5ec9d4e9-3f1c-8f1e-41f0-eb022308081d:link_1f78b936-37d7-285d-d766-136934e7d1c5_dashboard"
    },
    {
      "type": "index-pattern",
      "id": "logs-*",
      "name": "controlGroup_e155cda7-38a2-040c-3e6a-33339866c123:optionsListDataView"
    },
    {
      "type": "index-pattern",
      "id": "logs-*",
      "name": "controlGroup_41c0e666-862f-ba61-3001-48c7a555c788:optionsListDataView"
    },
    {
      "type": "index-pattern",
      "id": "logs-*",
      "name": "controlGroup_a6de1714-9b30-7483-8189-4f53daa21992:optionsListDataView"
    },
    {
      "type": "index-pattern",
      "id": "logs-*",
      "name": "controlGroup_2ab2d2c5-ce3e-9cbb-e027-36ca1ac94987:optionsListDataView"
    },
    {
      "type": "index-pattern",
      "id": "logs-*",
      "name": "controlGroup_056d9865-1eaa-90fa-a56d-28cf7d889abb:optionsListDataView"
    },
    {
      "type": "index-pattern",
      "id": "logs-*",
      "name": "controlGroup_dc63970a-1a81-ce93-33e1-c32236299d7d:optionsListDataView"
    }
  ],
  "type": "dashboard",
  "typeMigrationVersion": "10.2.0",
  "updated_at": "2023-10-01T00:00:00Z",
  "updated_by": "admin",
  "version": "1"
}