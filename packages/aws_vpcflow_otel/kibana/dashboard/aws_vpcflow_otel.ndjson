{
    "attributes": {
        "title": "[AWS VPC OTEL] VPC Flow Logs Overview",
        "description": "",
        "panelsJSON": "[{\"panelIndex\": \"a8fc4e5b-abf9-c7e5-bff7-f442a2fc4f56\", \"gridData\": {\"x\": 0, \"y\": 0, \"w\": 48, \"h\": 3, \"i\": \"a8fc4e5b-abf9-c7e5-bff7-f442a2fc4f56\"}, \"type\": \"visualization\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"savedVis\": {\"type\": \"markdown\", \"id\": \"\", \"title\": \"\", \"description\": \"\", \"params\": {\"fontSize\": 12, \"openLinksInNewTab\": false, \"markdown\": \"## AWS VPC Flow Logs DevOps/SRE Dashboard\\nMonitor VPC network traffic, security, and performance with actionable insights.\\n**Quick Insights:**\\n- **KPI Metrics** - Track total flows, rejection rates, bandwidth, and active interfaces\\n- **Distribution Analysis** - Identify top protocols, interfaces, and destination ports\\n- **Time-Series Trends** - Visualize traffic volume and bandwidth patterns over time\\n- **Source Analysis** - Analyze traffic patterns from top source IPs\\n- **Security Deep Dive** - Investigate rejected traffic by protocol, port, and detailed logs\\n- **Performance Analysis** - Monitor interface-level traffic breakdown by action\\n- **Account Analysis** - Track multi-account traffic metrics and patterns\\n\"}, \"uiState\": {}, \"data\": {\"aggs\": [], \"searchSource\": {\"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filter\": []}}}}}, {\"panelIndex\": \"4e3959c5-36db-a93d-6448-4f5a34ccffa4\", \"gridData\": {\"x\": 0, \"y\": 3, \"w\": 12, \"h\": 6, \"i\": \"4e3959c5-36db-a93d-6448-4f5a34ccffa4\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Total Flow Records\", \"visualizationType\": \"lnsMetric\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layerId\": \"7397e3d3-caa7-11e0-2a25-58181dc96cea\", \"layerType\": \"data\", \"metricAccessor\": \"c44b362d-d2f3-80d1-5224-acb64552e5d6\", \"showBar\": false}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"7397e3d3-caa7-11e0-2a25-58181dc96cea\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\"\\n| STATS total_flows = COUNT()\"}, \"columns\": [{\"fieldName\": \"total_flows\", \"columnId\": \"c44b362d-d2f3-80d1-5224-acb64552e5d6\", \"label\": \"Flow Records\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}], \"allColumns\": [{\"fieldName\": \"total_flows\", \"columnId\": \"c44b362d-d2f3-80d1-5224-acb64552e5d6\", \"label\": \"Flow Records\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"d7739108-360d-01f4-8a90-d4871b826f21\", \"gridData\": {\"x\": 12, \"y\": 3, \"w\": 12, \"h\": 6, \"i\": \"d7739108-360d-01f4-8a90-d4871b826f21\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Rejection Rate\", \"visualizationType\": \"lnsMetric\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layerId\": \"14c2582f-ab02-40c2-5bea-6bbdc6e5fe94\", \"layerType\": \"data\", \"metricAccessor\": \"9c0e3410-038b-6719-10fe-c0b7dcdb1661\", \"showBar\": false}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"14c2582f-ab02-40c2-5bea-6bbdc6e5fe94\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\"\\n| STATS total_flows = COUNT(), rejected_flows = COUNT(*) WHERE aws.vpc.flow.action == \\\"REJECT\\\"\\n| EVAL rejection_rate = rejected_flows / total_flows\"}, \"columns\": [{\"fieldName\": \"rejection_rate\", \"columnId\": \"9c0e3410-038b-6719-10fe-c0b7dcdb1661\", \"label\": \"Rejection Rate\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"percent\", \"params\": {\"decimals\": 1}}}}], \"allColumns\": [{\"fieldName\": \"rejection_rate\", \"columnId\": \"9c0e3410-038b-6719-10fe-c0b7dcdb1661\", \"label\": \"Rejection Rate\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"percent\", \"params\": {\"decimals\": 1}}}}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"e10e2f1c-c140-9c9a-876e-9d1806779ad8\", \"gridData\": {\"x\": 24, \"y\": 3, \"w\": 12, \"h\": 6, \"i\": \"e10e2f1c-c140-9c9a-876e-9d1806779ad8\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Total Bandwidth\", \"visualizationType\": \"lnsMetric\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layerId\": \"337fb98f-7f76-f938-2845-6f58fdf75293\", \"layerType\": \"data\", \"metricAccessor\": \"03eba9e2-2cf9-1d68-2650-755bd2d9e597\", \"showBar\": false}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"337fb98f-7f76-f938-2845-6f58fdf75293\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.bytes IS NOT NULL\\n| STATS total_bytes = SUM(aws.vpc.flow.bytes)\"}, \"columns\": [{\"fieldName\": \"total_bytes\", \"columnId\": \"03eba9e2-2cf9-1d68-2650-755bd2d9e597\", \"label\": \"Total Bandwidth\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}], \"allColumns\": [{\"fieldName\": \"total_bytes\", \"columnId\": \"03eba9e2-2cf9-1d68-2650-755bd2d9e597\", \"label\": \"Total Bandwidth\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"ebc095ed-6839-5dec-af83-471910d255c2\", \"gridData\": {\"x\": 36, \"y\": 3, \"w\": 12, \"h\": 6, \"i\": \"ebc095ed-6839-5dec-af83-471910d255c2\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Unique Active Interfaces\", \"visualizationType\": \"lnsMetric\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layerId\": \"86cacf37-ba0d-df6c-3fd7-fa43b2eacc0a\", \"layerType\": \"data\", \"metricAccessor\": \"1ecf3092-d67b-51f2-6ccb-78053afb1dfc\", \"showBar\": false}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"86cacf37-ba0d-df6c-3fd7-fa43b2eacc0a\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND network.interface.name IS NOT NULL\\n| STATS unique_interfaces = COUNT_DISTINCT(network.interface.name)\"}, \"columns\": [{\"fieldName\": \"unique_interfaces\", \"columnId\": \"1ecf3092-d67b-51f2-6ccb-78053afb1dfc\", \"label\": \"Active Interfaces\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}], \"allColumns\": [{\"fieldName\": \"unique_interfaces\", \"columnId\": \"1ecf3092-d67b-51f2-6ccb-78053afb1dfc\", \"label\": \"Active Interfaces\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"d892e5e1-e176-7cc1-bb41-9a586a48f07f\", \"gridData\": {\"x\": 0, \"y\": 9, \"w\": 16, \"h\": 12, \"i\": \"d892e5e1-e176-7cc1-bb41-9a586a48f07f\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Top Protocols\", \"visualizationType\": \"lnsPie\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"02ad7eb4-da09-ab04-ef30-0279a478e377\", \"layerType\": \"data\", \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}, \"primaryGroups\": [\"4b5e1c23-896c-02f2-2aa7-994856aa7f43\"], \"metrics\": [\"87628248-2d16-ab0f-c81e-9ffcc1559705\"], \"numberDisplay\": \"percent\", \"categoryDisplay\": \"default\", \"legendDisplay\": \"default\", \"nestedLegend\": false}], \"shape\": \"pie\"}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"02ad7eb4-da09-ab04-ef30-0279a478e377\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND network.protocol.name IS NOT NULL\\n| STATS flow_count = COUNT() BY network.protocol.name\\n| SORT flow_count DESC\\n| LIMIT 10\"}, \"columns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"87628248-2d16-ab0f-c81e-9ffcc1559705\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"network.protocol.name\", \"columnId\": \"4b5e1c23-896c-02f2-2aa7-994856aa7f43\", \"label\": \"network.protocol.name\", \"customLabel\": false}], \"allColumns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"87628248-2d16-ab0f-c81e-9ffcc1559705\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"network.protocol.name\", \"columnId\": \"4b5e1c23-896c-02f2-2aa7-994856aa7f43\", \"label\": \"network.protocol.name\", \"customLabel\": false}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"e417eca8-4855-67ab-6697-35dee1cd901f\", \"gridData\": {\"x\": 16, \"y\": 9, \"w\": 16, \"h\": 12, \"i\": \"e417eca8-4855-67ab-6697-35dee1cd901f\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Top Interfaces by Traffic\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"631b9063-1c0f-ad04-b75c-b1f8b1c9ca2d\", \"accessors\": [\"919207e1-ae62-2daa-a393-71b91f587045\"], \"layerType\": \"data\", \"seriesType\": \"bar_stacked\", \"xAccessor\": \"2788f4c9-d1ee-96a4-8352-f9024c526c7d\", \"position\": \"top\", \"showGridlines\": false, \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"bar_stacked\", \"legend\": {\"isVisible\": false, \"position\": \"right\"}, \"valueLabels\": \"hide\", \"yTitle\": \"Bytes\", \"yLeftTitle\": \"Bytes\", \"axisTitlesVisibilitySettings\": {\"x\": false, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"631b9063-1c0f-ad04-b75c-b1f8b1c9ca2d\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND network.interface.name IS NOT NULL AND aws.vpc.flow.bytes IS NOT NULL\\n| STATS total_bytes = SUM(aws.vpc.flow.bytes) BY network.interface.name\\n| SORT total_bytes DESC\\n| LIMIT 10\"}, \"columns\": [{\"fieldName\": \"total_bytes\", \"columnId\": \"919207e1-ae62-2daa-a393-71b91f587045\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"network.interface.name\", \"columnId\": \"2788f4c9-d1ee-96a4-8352-f9024c526c7d\", \"label\": \"network.interface.name\", \"customLabel\": false}], \"allColumns\": [{\"fieldName\": \"total_bytes\", \"columnId\": \"919207e1-ae62-2daa-a393-71b91f587045\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"network.interface.name\", \"columnId\": \"2788f4c9-d1ee-96a4-8352-f9024c526c7d\", \"label\": \"network.interface.name\", \"customLabel\": false}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"9d69ec2c-0654-fc86-81ab-f5e03bef605c\", \"gridData\": {\"x\": 32, \"y\": 9, \"w\": 16, \"h\": 12, \"i\": \"9d69ec2c-0654-fc86-81ab-f5e03bef605c\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Top Destination Ports\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"c56fe27e-dfa6-4be4-7d09-5721839365df\", \"accessors\": [\"27b0a929-73f1-f2f6-2988-f1edd1d608cd\"], \"layerType\": \"data\", \"seriesType\": \"bar_stacked\", \"xAccessor\": \"88a278ce-c1b4-cdf7-61ae-b3613ef96826\", \"position\": \"top\", \"showGridlines\": false, \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"bar_stacked\", \"legend\": {\"isVisible\": false, \"position\": \"right\"}, \"valueLabels\": \"hide\", \"yTitle\": \"Flow Count\", \"yLeftTitle\": \"Flow Count\", \"axisTitlesVisibilitySettings\": {\"x\": false, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"c56fe27e-dfa6-4be4-7d09-5721839365df\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND destination.port IS NOT NULL\\n| STATS flow_count = COUNT() BY destination.port\\n| SORT flow_count DESC\\n| LIMIT 10\"}, \"columns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"27b0a929-73f1-f2f6-2988-f1edd1d608cd\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"destination.port\", \"columnId\": \"88a278ce-c1b4-cdf7-61ae-b3613ef96826\", \"label\": \"destination.port\", \"customLabel\": false}], \"allColumns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"27b0a929-73f1-f2f6-2988-f1edd1d608cd\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"destination.port\", \"columnId\": \"88a278ce-c1b4-cdf7-61ae-b3613ef96826\", \"label\": \"destination.port\", \"customLabel\": false}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"24a2df0d-fa98-7ad8-7659-5a86f7ca6e85\", \"gridData\": {\"x\": 0, \"y\": 21, \"w\": 48, \"h\": 14, \"i\": \"24a2df0d-fa98-7ad8-7659-5a86f7ca6e85\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Traffic Volume Over Time\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"354cb314-ccf7-76b9-ca51-730ee6eac510\", \"accessors\": [\"27b0a929-73f1-f2f6-2988-f1edd1d608cd\"], \"layerType\": \"data\", \"seriesType\": \"area\", \"xAccessor\": \"481f408e-a414-9d0a-cb75-390b420b91f7\", \"position\": \"top\", \"showGridlines\": false, \"splitAccessor\": \"e89e8672-f13c-04ac-9edb-eeaf0b84098e\", \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"area\", \"legend\": {\"position\": \"right\"}, \"valueLabels\": \"hide\", \"xTitle\": \"@timestamp\", \"yTitle\": \"Flow Count\", \"yLeftTitle\": \"Flow Count\", \"axisTitlesVisibilitySettings\": {\"x\": true, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"354cb314-ccf7-76b9-ca51-730ee6eac510\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.action IS NOT NULL\\n| STATS flow_count = COUNT() BY aws.vpc.flow.action, time_bucket = BUCKET(@timestamp, 50, ?_tstart, ?_tend)\\n| SORT time_bucket ASC\"}, \"columns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"27b0a929-73f1-f2f6-2988-f1edd1d608cd\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"time_bucket\", \"columnId\": \"481f408e-a414-9d0a-cb75-390b420b91f7\", \"label\": \"time_bucket\", \"customLabel\": false}, {\"fieldName\": \"aws.vpc.flow.action\", \"columnId\": \"e89e8672-f13c-04ac-9edb-eeaf0b84098e\", \"label\": \"aws.vpc.flow.action\", \"customLabel\": false}], \"allColumns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"27b0a929-73f1-f2f6-2988-f1edd1d608cd\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"time_bucket\", \"columnId\": \"481f408e-a414-9d0a-cb75-390b420b91f7\", \"label\": \"time_bucket\", \"customLabel\": false}, {\"fieldName\": \"aws.vpc.flow.action\", \"columnId\": \"e89e8672-f13c-04ac-9edb-eeaf0b84098e\", \"label\": \"aws.vpc.flow.action\", \"customLabel\": false}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"83c75081-1f25-a16d-b49b-9a67c5a9bc26\", \"gridData\": {\"x\": 0, \"y\": 35, \"w\": 48, \"h\": 14, \"i\": \"83c75081-1f25-a16d-b49b-9a67c5a9bc26\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Bandwidth Usage Over Time\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"4e0819de-3eef-ba74-cc42-910d898cdcc9\", \"accessors\": [\"919207e1-ae62-2daa-a393-71b91f587045\"], \"layerType\": \"data\", \"seriesType\": \"line\", \"xAccessor\": \"481f408e-a414-9d0a-cb75-390b420b91f7\", \"position\": \"top\", \"showGridlines\": false, \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"line\", \"legend\": {\"position\": \"right\"}, \"valueLabels\": \"hide\", \"xTitle\": \"@timestamp\", \"yTitle\": \"Bandwidth\", \"yLeftTitle\": \"Bandwidth\", \"axisTitlesVisibilitySettings\": {\"x\": true, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"4e0819de-3eef-ba74-cc42-910d898cdcc9\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.bytes IS NOT NULL\\n| STATS total_bytes = SUM(aws.vpc.flow.bytes) BY time_bucket = BUCKET(@timestamp, 50, ?_tstart, ?_tend)\\n| SORT time_bucket ASC\"}, \"columns\": [{\"fieldName\": \"total_bytes\", \"columnId\": \"919207e1-ae62-2daa-a393-71b91f587045\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"time_bucket\", \"columnId\": \"481f408e-a414-9d0a-cb75-390b420b91f7\", \"label\": \"time_bucket\", \"customLabel\": false}], \"allColumns\": [{\"fieldName\": \"total_bytes\", \"columnId\": \"919207e1-ae62-2daa-a393-71b91f587045\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"time_bucket\", \"columnId\": \"481f408e-a414-9d0a-cb75-390b420b91f7\", \"label\": \"time_bucket\", \"customLabel\": false}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"1e7e0db2-a7f2-bbb1-c121-6abe508ae53a\", \"gridData\": {\"x\": 0, \"y\": 49, \"w\": 48, \"h\": 15, \"i\": \"1e7e0db2-a7f2-bbb1-c121-6abe508ae53a\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Top Source IPs - Detailed\", \"visualizationType\": \"lnsDatatable\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"columns\": [{\"columnId\": \"0f18fa44-2751-ddb8-fb2d-3f5d1990d2a1\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"bc4a4a9b-751c-838d-c6d6-819735bec531\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"c8971972-6b5d-82e6-8ffa-3dbc37120d48\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"ba07d667-9823-451d-5f7d-eef813bdd612\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"ab08f77f-ca5a-892b-838b-1377e35744f9\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"ce6ccb2c-a77b-ec23-130a-fb87ed00783c\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"8af0b417-fad4-ebbb-ca9e-3894f7694d4a\", \"isTransposed\": false, \"isMetric\": true}], \"layerId\": \"bf5b73d4-4058-9657-e824-20dbbc8962ed\", \"layerType\": \"data\", \"paging\": {\"size\": 20, \"enabled\": true}}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"bf5b73d4-4058-9657-e824-20dbbc8962ed\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND source.address IS NOT NULL\\n| STATS total_flows = COUNT(), accepted_flows = COUNT(*) WHERE aws.vpc.flow.action == \\\"ACCEPT\\\", rejected_flows = COUNT(*) WHERE aws.vpc.flow.action == \\\"REJECT\\\", total_bytes = SUM(aws.vpc.flow.bytes), total_packets = SUM(aws.vpc.flow.packets) BY source.address\\n| EVAL rejection_rate = rejected_flows / total_flows\\n| SORT total_flows DESC\\n| LIMIT 20\"}, \"columns\": [{\"fieldName\": \"source.address\", \"columnId\": \"0f18fa44-2751-ddb8-fb2d-3f5d1990d2a1\", \"label\": \"source.address\", \"customLabel\": false}, {\"fieldName\": \"total_flows\", \"columnId\": \"bc4a4a9b-751c-838d-c6d6-819735bec531\", \"label\": \"Total Flows\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"accepted_flows\", \"columnId\": \"c8971972-6b5d-82e6-8ffa-3dbc37120d48\", \"label\": \"Accepted\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"rejected_flows\", \"columnId\": \"ba07d667-9823-451d-5f7d-eef813bdd612\", \"label\": \"Rejected\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"rejection_rate\", \"columnId\": \"ab08f77f-ca5a-892b-838b-1377e35744f9\", \"label\": \"Rejection %\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"percent\", \"params\": {\"decimals\": 1}}}}, {\"fieldName\": \"total_bytes\", \"columnId\": \"ce6ccb2c-a77b-ec23-130a-fb87ed00783c\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"total_packets\", \"columnId\": \"8af0b417-fad4-ebbb-ca9e-3894f7694d4a\", \"label\": \"Packets\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}], \"allColumns\": [{\"fieldName\": \"source.address\", \"columnId\": \"0f18fa44-2751-ddb8-fb2d-3f5d1990d2a1\", \"label\": \"source.address\", \"customLabel\": false}, {\"fieldName\": \"total_flows\", \"columnId\": \"bc4a4a9b-751c-838d-c6d6-819735bec531\", \"label\": \"Total Flows\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"accepted_flows\", \"columnId\": \"c8971972-6b5d-82e6-8ffa-3dbc37120d48\", \"label\": \"Accepted\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"rejected_flows\", \"columnId\": \"ba07d667-9823-451d-5f7d-eef813bdd612\", \"label\": \"Rejected\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"rejection_rate\", \"columnId\": \"ab08f77f-ca5a-892b-838b-1377e35744f9\", \"label\": \"Rejection %\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"percent\", \"params\": {\"decimals\": 1}}}}, {\"fieldName\": \"total_bytes\", \"columnId\": \"ce6ccb2c-a77b-ec23-130a-fb87ed00783c\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"total_packets\", \"columnId\": \"8af0b417-fad4-ebbb-ca9e-3894f7694d4a\", \"label\": \"Packets\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"8ff71a8f-2144-269b-0f8e-18f7edafe436\", \"gridData\": {\"x\": 0, \"y\": 64, \"w\": 24, \"h\": 15, \"i\": \"8ff71a8f-2144-269b-0f8e-18f7edafe436\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Rejected Traffic by Protocol\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"5164d629-87ec-3601-c929-e97b129d776f\", \"accessors\": [\"4905555a-5316-91d6-86ed-5018408316ae\"], \"layerType\": \"data\", \"seriesType\": \"bar_stacked\", \"xAccessor\": \"4b5e1c23-896c-02f2-2aa7-994856aa7f43\", \"position\": \"top\", \"showGridlines\": false, \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"bar_stacked\", \"legend\": {\"isVisible\": false, \"position\": \"right\"}, \"valueLabels\": \"hide\", \"yTitle\": \"Rejected Count\", \"yLeftTitle\": \"Rejected Count\", \"axisTitlesVisibilitySettings\": {\"x\": false, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"5164d629-87ec-3601-c929-e97b129d776f\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.action == \\\"REJECT\\\" AND network.protocol.name IS NOT NULL\\n| STATS rejected_count = COUNT() BY network.protocol.name\\n| SORT rejected_count DESC\\n| LIMIT 10\"}, \"columns\": [{\"fieldName\": \"rejected_count\", \"columnId\": \"4905555a-5316-91d6-86ed-5018408316ae\", \"label\": \"Rejected Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"network.protocol.name\", \"columnId\": \"4b5e1c23-896c-02f2-2aa7-994856aa7f43\", \"label\": \"network.protocol.name\", \"customLabel\": false}], \"allColumns\": [{\"fieldName\": \"rejected_count\", \"columnId\": \"4905555a-5316-91d6-86ed-5018408316ae\", \"label\": \"Rejected Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"network.protocol.name\", \"columnId\": \"4b5e1c23-896c-02f2-2aa7-994856aa7f43\", \"label\": \"network.protocol.name\", \"customLabel\": false}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"5428d3b9-46b6-1f6d-29b2-6bde76d7489a\", \"gridData\": {\"x\": 24, \"y\": 64, \"w\": 24, \"h\": 15, \"i\": \"5428d3b9-46b6-1f6d-29b2-6bde76d7489a\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Top Rejected Ports\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"98dcbfae-5f6a-7250-de94-eca38f9b2892\", \"accessors\": [\"4905555a-5316-91d6-86ed-5018408316ae\"], \"layerType\": \"data\", \"seriesType\": \"bar_stacked\", \"xAccessor\": \"88a278ce-c1b4-cdf7-61ae-b3613ef96826\", \"position\": \"top\", \"showGridlines\": false, \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"bar_stacked\", \"legend\": {\"isVisible\": false, \"position\": \"right\"}, \"valueLabels\": \"hide\", \"yTitle\": \"Rejected Count\", \"yLeftTitle\": \"Rejected Count\", \"axisTitlesVisibilitySettings\": {\"x\": false, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"98dcbfae-5f6a-7250-de94-eca38f9b2892\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.action == \\\"REJECT\\\" AND destination.port IS NOT NULL\\n| STATS rejected_count = COUNT() BY destination.port\\n| SORT rejected_count DESC\\n| LIMIT 10\"}, \"columns\": [{\"fieldName\": \"rejected_count\", \"columnId\": \"4905555a-5316-91d6-86ed-5018408316ae\", \"label\": \"Rejected Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"destination.port\", \"columnId\": \"88a278ce-c1b4-cdf7-61ae-b3613ef96826\", \"label\": \"destination.port\", \"customLabel\": false}], \"allColumns\": [{\"fieldName\": \"rejected_count\", \"columnId\": \"4905555a-5316-91d6-86ed-5018408316ae\", \"label\": \"Rejected Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"destination.port\", \"columnId\": \"88a278ce-c1b4-cdf7-61ae-b3613ef96826\", \"label\": \"destination.port\", \"customLabel\": false}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"ae7ddfbd-706d-5876-adb1-3c9b554c85a9\", \"gridData\": {\"x\": 0, \"y\": 79, \"w\": 48, \"h\": 15, \"i\": \"ae7ddfbd-706d-5876-adb1-3c9b554c85a9\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Detailed Rejection Logs\", \"visualizationType\": \"lnsDatatable\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"columns\": [{\"columnId\": \"bef18ddb-6400-b90d-91cb-7b407c4ce0bd\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"0f18fa44-2751-ddb8-fb2d-3f5d1990d2a1\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"37ef9773-24b2-e811-417e-c11fe3f9bfb1\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"88a278ce-c1b4-cdf7-61ae-b3613ef96826\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"4b5e1c23-896c-02f2-2aa7-994856aa7f43\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"2788f4c9-d1ee-96a4-8352-f9024c526c7d\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"ca180367-8dba-9671-069e-b19084667732\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"bf74f69b-feac-a5df-ed92-b302f0040a5d\", \"isTransposed\": false, \"isMetric\": true}], \"layerId\": \"9ff94ae7-b1eb-aae7-b958-57005b3a746f\", \"layerType\": \"data\", \"paging\": {\"size\": 25, \"enabled\": true}}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"9ff94ae7-b1eb-aae7-b958-57005b3a746f\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND aws.vpc.flow.action == \\\"REJECT\\\"\\n| KEEP @timestamp, source.address, destination.address, destination.port, network.protocol.name, network.interface.name, aws.vpc.flow.bytes, aws.vpc.flow.packets\\n| SORT @timestamp DESC\\n| LIMIT 1000\"}, \"columns\": [{\"fieldName\": \"@timestamp\", \"columnId\": \"bef18ddb-6400-b90d-91cb-7b407c4ce0bd\", \"label\": \"@timestamp\", \"customLabel\": false}, {\"fieldName\": \"source.address\", \"columnId\": \"0f18fa44-2751-ddb8-fb2d-3f5d1990d2a1\", \"label\": \"source.address\", \"customLabel\": false}, {\"fieldName\": \"destination.address\", \"columnId\": \"37ef9773-24b2-e811-417e-c11fe3f9bfb1\", \"label\": \"destination.address\", \"customLabel\": false}, {\"fieldName\": \"destination.port\", \"columnId\": \"88a278ce-c1b4-cdf7-61ae-b3613ef96826\", \"label\": \"destination.port\", \"customLabel\": false}, {\"fieldName\": \"network.protocol.name\", \"columnId\": \"4b5e1c23-896c-02f2-2aa7-994856aa7f43\", \"label\": \"network.protocol.name\", \"customLabel\": false}, {\"fieldName\": \"network.interface.name\", \"columnId\": \"2788f4c9-d1ee-96a4-8352-f9024c526c7d\", \"label\": \"network.interface.name\", \"customLabel\": false}, {\"fieldName\": \"aws.vpc.flow.bytes\", \"columnId\": \"ca180367-8dba-9671-069e-b19084667732\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"aws.vpc.flow.packets\", \"columnId\": \"bf74f69b-feac-a5df-ed92-b302f0040a5d\", \"label\": \"Packets\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}], \"allColumns\": [{\"fieldName\": \"@timestamp\", \"columnId\": \"bef18ddb-6400-b90d-91cb-7b407c4ce0bd\", \"label\": \"@timestamp\", \"customLabel\": false}, {\"fieldName\": \"source.address\", \"columnId\": \"0f18fa44-2751-ddb8-fb2d-3f5d1990d2a1\", \"label\": \"source.address\", \"customLabel\": false}, {\"fieldName\": \"destination.address\", \"columnId\": \"37ef9773-24b2-e811-417e-c11fe3f9bfb1\", \"label\": \"destination.address\", \"customLabel\": false}, {\"fieldName\": \"destination.port\", \"columnId\": \"88a278ce-c1b4-cdf7-61ae-b3613ef96826\", \"label\": \"destination.port\", \"customLabel\": false}, {\"fieldName\": \"network.protocol.name\", \"columnId\": \"4b5e1c23-896c-02f2-2aa7-994856aa7f43\", \"label\": \"network.protocol.name\", \"customLabel\": false}, {\"fieldName\": \"network.interface.name\", \"columnId\": \"2788f4c9-d1ee-96a4-8352-f9024c526c7d\", \"label\": \"network.interface.name\", \"customLabel\": false}, {\"fieldName\": \"aws.vpc.flow.bytes\", \"columnId\": \"ca180367-8dba-9671-069e-b19084667732\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"aws.vpc.flow.packets\", \"columnId\": \"bf74f69b-feac-a5df-ed92-b302f0040a5d\", \"label\": \"Packets\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"0b00ec74-ed7d-6485-8be2-029187c4547a\", \"gridData\": {\"x\": 0, \"y\": 94, \"w\": 48, \"h\": 15, \"i\": \"0b00ec74-ed7d-6485-8be2-029187c4547a\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Interface Traffic Analysis\", \"visualizationType\": \"lnsXY\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"layers\": [{\"layerId\": \"e15cb5e6-cf90-6007-cda6-f771eea24d4e\", \"accessors\": [\"27b0a929-73f1-f2f6-2988-f1edd1d608cd\"], \"layerType\": \"data\", \"seriesType\": \"bar_stacked\", \"xAccessor\": \"2788f4c9-d1ee-96a4-8352-f9024c526c7d\", \"position\": \"top\", \"showGridlines\": false, \"splitAccessor\": \"e89e8672-f13c-04ac-9edb-eeaf0b84098e\", \"colorMapping\": {\"assignments\": [], \"specialAssignments\": [{\"rule\": {\"type\": \"other\"}, \"color\": {\"type\": \"loop\"}, \"touched\": false}], \"paletteId\": \"eui_amsterdam_color_blind\", \"colorMode\": {\"type\": \"categorical\"}}}], \"preferredSeriesType\": \"bar_stacked\", \"legend\": {\"position\": \"right\"}, \"valueLabels\": \"hide\", \"yTitle\": \"Flow Count\", \"yLeftTitle\": \"Flow Count\", \"axisTitlesVisibilitySettings\": {\"x\": false, \"yLeft\": true, \"yRight\": false}}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"e15cb5e6-cf90-6007-cda6-f771eea24d4e\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND network.interface.name IS NOT NULL AND aws.vpc.flow.action IS NOT NULL\\n| STATS flow_count = COUNT() BY network.interface.name, aws.vpc.flow.action\\n| SORT flow_count DESC\"}, \"columns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"27b0a929-73f1-f2f6-2988-f1edd1d608cd\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"network.interface.name\", \"columnId\": \"2788f4c9-d1ee-96a4-8352-f9024c526c7d\", \"label\": \"network.interface.name\", \"customLabel\": false}, {\"fieldName\": \"aws.vpc.flow.action\", \"columnId\": \"e89e8672-f13c-04ac-9edb-eeaf0b84098e\", \"label\": \"aws.vpc.flow.action\", \"customLabel\": false}], \"allColumns\": [{\"fieldName\": \"flow_count\", \"columnId\": \"27b0a929-73f1-f2f6-2988-f1edd1d608cd\", \"label\": \"Flow Count\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"network.interface.name\", \"columnId\": \"2788f4c9-d1ee-96a4-8352-f9024c526c7d\", \"label\": \"network.interface.name\", \"customLabel\": false}, {\"fieldName\": \"aws.vpc.flow.action\", \"columnId\": \"e89e8672-f13c-04ac-9edb-eeaf0b84098e\", \"label\": \"aws.vpc.flow.action\", \"customLabel\": false}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}, {\"panelIndex\": \"0f71a5c4-682f-620f-9d4c-85197178a1a2\", \"gridData\": {\"x\": 0, \"y\": 109, \"w\": 48, \"h\": 15, \"i\": \"0f71a5c4-682f-620f-9d4c-85197178a1a2\"}, \"type\": \"lens\", \"embeddableConfig\": {\"enhancements\": {\"dynamicActions\": {\"events\": []}}, \"attributes\": {\"title\": \"Traffic by Cloud Account\", \"visualizationType\": \"lnsDatatable\", \"type\": \"lens\", \"references\": [], \"state\": {\"visualization\": {\"columns\": [{\"columnId\": \"af9cffe4-5fab-2f1a-dd82-307ea80449fb\", \"isTransposed\": false, \"isMetric\": false}, {\"columnId\": \"bc4a4a9b-751c-838d-c6d6-819735bec531\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"c8971972-6b5d-82e6-8ffa-3dbc37120d48\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"ba07d667-9823-451d-5f7d-eef813bdd612\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"ab08f77f-ca5a-892b-838b-1377e35744f9\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"ce6ccb2c-a77b-ec23-130a-fb87ed00783c\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"5eea3ff8-93de-5a37-646a-b9dd473bc242\", \"isTransposed\": false, \"isMetric\": true}, {\"columnId\": \"8affc994-df35-e752-861a-707194b11554\", \"isTransposed\": false, \"isMetric\": true}], \"layerId\": \"6f1b3b99-7e6d-d01b-b466-6c8446856e65\", \"layerType\": \"data\", \"paging\": {\"size\": 20, \"enabled\": true}}, \"query\": {\"query\": \"\", \"language\": \"kuery\"}, \"filters\": [], \"datasourceStates\": {\"formBased\": {\"layers\": {}}, \"indexpattern\": {\"layers\": {}}, \"textBased\": {\"layers\": {\"6f1b3b99-7e6d-d01b-b466-6c8446856e65\": {\"query\": {\"esql\": \"FROM logs-*\\n| WHERE data_stream.dataset == \\\"aws.vpcflow.otel\\\" AND cloud.account.id IS NOT NULL\\n| STATS total_flows = COUNT(), accepted_flows = COUNT(*) WHERE aws.vpc.flow.action == \\\"ACCEPT\\\", rejected_flows = COUNT(*) WHERE aws.vpc.flow.action == \\\"REJECT\\\", total_bytes = SUM(aws.vpc.flow.bytes), unique_interfaces = COUNT_DISTINCT(network.interface.name), unique_sources = COUNT_DISTINCT(source.address) BY cloud.account.id\\n| EVAL rejection_rate = rejected_flows / total_flows\\n| SORT total_flows DESC\"}, \"columns\": [{\"fieldName\": \"cloud.account.id\", \"columnId\": \"af9cffe4-5fab-2f1a-dd82-307ea80449fb\", \"label\": \"cloud.account.id\", \"customLabel\": false}, {\"fieldName\": \"total_flows\", \"columnId\": \"bc4a4a9b-751c-838d-c6d6-819735bec531\", \"label\": \"Total Flows\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"accepted_flows\", \"columnId\": \"c8971972-6b5d-82e6-8ffa-3dbc37120d48\", \"label\": \"Accepted\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"rejected_flows\", \"columnId\": \"ba07d667-9823-451d-5f7d-eef813bdd612\", \"label\": \"Rejected\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"rejection_rate\", \"columnId\": \"ab08f77f-ca5a-892b-838b-1377e35744f9\", \"label\": \"Rejection %\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"percent\", \"params\": {\"decimals\": 1}}}}, {\"fieldName\": \"total_bytes\", \"columnId\": \"ce6ccb2c-a77b-ec23-130a-fb87ed00783c\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"unique_interfaces\", \"columnId\": \"5eea3ff8-93de-5a37-646a-b9dd473bc242\", \"label\": \"Interfaces\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"unique_sources\", \"columnId\": \"8affc994-df35-e752-861a-707194b11554\", \"label\": \"Unique Sources\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}], \"allColumns\": [{\"fieldName\": \"cloud.account.id\", \"columnId\": \"af9cffe4-5fab-2f1a-dd82-307ea80449fb\", \"label\": \"cloud.account.id\", \"customLabel\": false}, {\"fieldName\": \"total_flows\", \"columnId\": \"bc4a4a9b-751c-838d-c6d6-819735bec531\", \"label\": \"Total Flows\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"accepted_flows\", \"columnId\": \"c8971972-6b5d-82e6-8ffa-3dbc37120d48\", \"label\": \"Accepted\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"rejected_flows\", \"columnId\": \"ba07d667-9823-451d-5f7d-eef813bdd612\", \"label\": \"Rejected\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"rejection_rate\", \"columnId\": \"ab08f77f-ca5a-892b-838b-1377e35744f9\", \"label\": \"Rejection %\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"percent\", \"params\": {\"decimals\": 1}}}}, {\"fieldName\": \"total_bytes\", \"columnId\": \"ce6ccb2c-a77b-ec23-130a-fb87ed00783c\", \"label\": \"Bytes\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true, \"params\": {\"format\": {\"id\": \"bytes\", \"params\": {\"decimals\": 2}}}}, {\"fieldName\": \"unique_interfaces\", \"columnId\": \"5eea3ff8-93de-5a37-646a-b9dd473bc242\", \"label\": \"Interfaces\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}, {\"fieldName\": \"unique_sources\", \"columnId\": \"8affc994-df35-e752-861a-707194b11554\", \"label\": \"Unique Sources\", \"customLabel\": true, \"meta\": {\"type\": \"number\", \"esType\": \"long\"}, \"inMetricDimension\": true}], \"timeField\": \"@timestamp\"}}}}, \"internalReferences\": [], \"adHocDataViews\": {}}}, \"syncTooltips\": false, \"syncColors\": false, \"syncCursor\": true, \"filters\": [], \"query\": {\"query\": \"\", \"language\": \"kuery\"}}}]",
        "optionsJSON": "{\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"hidePanelTitles\":false}",
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": "{\"filter\":[{\"$state\":{\"store\":\"appState\"},\"meta\":{\"disabled\":false,\"negate\":false,\"alias\":null,\"type\":\"phrase\",\"key\":\"data_stream.dataset\",\"field\":\"data_stream.dataset\",\"params\":{\"query\":\"aws.vpcflow.otel\"}},\"query\":{\"match_phrase\":{\"data_stream.dataset\":\"aws.vpcflow.otel\"}}}],\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"
        },
        "timeRestore": false,
        "version": 1,
        "controlGroupInput": {
            "chainingSystem": "HIERARCHICAL",
            "controlStyle": "oneLine",
            "ignoreParentSettingsJSON": "{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}",
            "panelsJSON": "{\"175201b0-71e2-a365-afb6-386f23d2e675\":{\"grow\":false,\"order\":0,\"width\":\"medium\",\"type\":\"optionsListControl\",\"explicitInput\":{\"id\":\"175201b0-71e2-a365-afb6-386f23d2e675\",\"dataViewId\":\"logs-*\",\"fieldName\":\"cloud.account.id\",\"title\":\"Cloud Account ID\",\"searchTechnique\":\"prefix\",\"selectedOptions\":[],\"sort\":{\"by\":\"_count\",\"direction\":\"desc\"}}},\"eac97581-c275-db09-8907-aec61b371471\":{\"grow\":false,\"order\":1,\"width\":\"medium\",\"type\":\"optionsListControl\",\"explicitInput\":{\"id\":\"eac97581-c275-db09-8907-aec61b371471\",\"dataViewId\":\"logs-*\",\"fieldName\":\"network.interface.name\",\"title\":\"Network Interface\",\"searchTechnique\":\"prefix\",\"selectedOptions\":[],\"sort\":{\"by\":\"_count\",\"direction\":\"desc\"}}},\"a6de1714-9b30-7483-8189-4f53daa21992\":{\"grow\":false,\"order\":2,\"width\":\"small\",\"type\":\"optionsListControl\",\"explicitInput\":{\"id\":\"a6de1714-9b30-7483-8189-4f53daa21992\",\"dataViewId\":\"logs-*\",\"fieldName\":\"aws.vpc.flow.action\",\"title\":\"Action\",\"searchTechnique\":\"prefix\",\"selectedOptions\":[],\"sort\":{\"by\":\"_count\",\"direction\":\"desc\"}}}}",
            "showApplySelections": false
        }
    },
    "coreMigrationVersion": "8.8.0",
    "created_at": "2023-10-01T00:00:00Z",
    "created_by": "admin",
    "id": "aa1f4e48-10fc-be91-2468-1606496408b9",
    "managed": false,
    "references": [
        {
            "type": "index-pattern",
            "id": "logs-*",
            "name": "controlGroup_175201b0-71e2-a365-afb6-386f23d2e675:optionsListDataView"
        },
        {
            "type": "index-pattern",
            "id": "logs-*",
            "name": "controlGroup_eac97581-c275-db09-8907-aec61b371471:optionsListDataView"
        },
        {
            "type": "index-pattern",
            "id": "logs-*",
            "name": "controlGroup_a6de1714-9b30-7483-8189-4f53daa21992:optionsListDataView"
        }
    ],
    "type": "dashboard",
    "typeMigrationVersion": "10.2.0",
    "updated_at": "2023-10-01T00:00:00Z",
    "updated_by": "admin",
    "version": "1"
}