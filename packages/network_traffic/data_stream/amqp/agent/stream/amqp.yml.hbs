type: amqp
{{#if port}}
ports:
{{#each port as |p|}}
  - {{p}}
{{/each}}
{{/if}}
fields_under_root: true
fields:
  _conf:
    geoip_enrich: {{geoip_enrich}}
{{#if max_body_length}}
max_body_length: {{max_body_length}}
{{/if}}
{{#if parse_headers}}
parse_headers: {{parse_headers}}
{{/if}}
{{#if parse_arguments}}
parse_arguments: {{parse_arguments}}
{{/if}}
{{#if hide_connection_information}}
hide_connection_information: {{hide_connection_information}}
{{/if}}
{{#if send_request}}
send_request: {{send_request}}
{{/if}}
{{#if send_response}}
send_response: {{send_response}}
{{/if}}
{{#if keep_null}}
keep_null: {{keep_null}}
{{/if}}
{{#if transaction_timeout}}
transaction_timeout: {{transaction_timeout}}
{{/if}}
{{#if processors}}
processors:
{{processors}}
{{/if}}
{{#if tags}}
tags:
{{#each tags as |tag|}}
  - {{tag}}
{{/each}}
{{/if}}
{{#if monitor_processes}}
procs:
  enabled: true
{{/if}}
{{#if interface}}
interface:
{{#if (contains ".pcap" interface)}}
  file: {{interface}}
{{else}}
  device: {{interface}}
{{/if}}
{{/if}}
