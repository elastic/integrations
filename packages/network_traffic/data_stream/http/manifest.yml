title: HTTP
type: logs
streams:
  - title: HTTP
    description: Capture HTTP Traffic
    input: packet
    template_path: http.yml.hbs
    vars:
      - name: port
        title: Ports
        # currently the Kibana UI doesn't support multi inputs
        # that are numeric, you get "Error: r.toLowerCase is not a function"
        # so map this as text
        type: text
        required: true
        show_user: true
        multi: true
        default: [80, 8080, 8000, 5000, 8002]
      - name: monitor_processes
        title: Monitor Processes
        type: bool
        description: |-
          If this option is enabled then network traffic events will be enriched
          with information about the process associated with the events.
        required: false
        show_user: true
        multi: false
      - name: hide_keywords
        title: Hide Keywords
        type: text
        description: |-
          Uncomment the following to hide certain parameters in URL or forms attached
          to HTTP requests. The names of the parameters are case insensitive.
          The value of the parameters will be replaced with the 'xxxxx' string.
          This is generally useful for avoiding storing user passwords or other
          sensitive information.
          Only query parameters and top level form parameters are replaced.
        required: false
        show_user: false
        multi: true
      - name: send_headers
        title: Send Headers
        type: text
        description: |-
          A list of header names to capture and send to Elasticsearch. These headers
          are placed under the `headers` dictionary in the resulting JSON.
        required: false
        show_user: false
        multi: true
      - name: send_all_headers
        title: Send All Headers
        type: bool
        description: |-
          Instead of sending a white list of headers to Elasticsearch, you can send
          all headers by setting this option to true. The default is false.
        required: false
        show_user: false
        multi: false
      - name: redact_headers
        title: Redact Headers
        type: text
        description: |-
          A list of headers to redact if present in the HTTP request. This will keep
          the header field present, but will redact it's value to show the headers
          presence.
        required: false
        show_user: false
        multi: true
      - name: include_body_for
        title: Include Body For
        type: text
        description: |-
          The list of content types for which Packetbeat includes the full HTTP
          payload. If the request's or response's Content-Type matches any on this
          list, the full body will be included under the request or response field.
        required: false
        show_user: false
        multi: true
      - name: include_request_body_for
        title: Include Request Body For
        type: text
        description: |-
          The list of content types for which Packetbeat includes the full HTTP
          request payload.
        required: false
        show_user: false
        multi: true
      - name: include_response_body_for
        title: Include Response Body For
        type: text
        description: |-
          The list of content types for which Packetbeat includes the full HTTP
          response payload.
        required: false
        show_user: false
        multi: true
      - name: decode_body
        title: Decode Body
        type: bool
        description: |-
          Whether the body of a request must be decoded when a content-encoding
          or transfer-encoding has been applied.
        required: false
        show_user: false
        multi: false
      - name: split_cookie
        title: Split Cookie
        type: bool
        description: |-
          If the Cookie or Set-Cookie headers are sent, this option controls whether
          they are split into individual values.
        required: false
        show_user: false
        multi: false
      - name: real_ip_header
        title: Real IP Header
        type: text
        description: |-
          The header field to extract the real IP from. This setting is useful when
          you want to capture traffic behind a reverse proxy, but you want to get the
          geo-location information.
        required: false
        show_user: false
        multi: false
      - name: send_request
        title: Send Request
        type: bool
        description: |-
          If this option is enabled, the raw message of the request (`request` field)
          is sent to Elasticsearch. The default is false.
        required: false
        show_user: false
        multi: false
      - name: send_response
        title: Send Response
        type: bool
        description: |-
          If this option is enabled, the raw message of the response (`response`
          field) is sent to Elasticsearch. The default is false.
        required: false
        show_user: false
        multi: false
      - name: keep_null
        title: Keep Null
        type: bool
        description: Set to true to publish fields with null values in events.
        required: false
        show_user: false
        multi: false
      - name: transaction_timeout
        title: Transaction Timeout
        type: text
        description: |-
          Transaction timeout. Expired transactions will no longer be correlated to
          incoming responses, but sent to Elasticsearch immediately.
        required: false
        show_user: false
        multi: false
      - name: max_message_size
        title: Max Message Size
        type: integer
        description: |-
          Maximum message size. If an HTTP message is larger than this, it will
          be trimmed to this size. Default is 10 MB.
        required: false
        show_user: false
        multi: false
      - name: processors
        title: Processors
        type: yaml
        description: Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.
        required: false
        show_user: false
        multi: false
      - name: tags
        title: Tags
        type: text
        description: Tags to include in the published event.
        required: false
        show_user: false
        multi: true
