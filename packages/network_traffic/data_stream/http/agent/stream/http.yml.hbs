type: http
{{#if port}}
ports:
{{#each port as |p|}}
  - {{p}}
{{/each}}
{{/if}}
fields_under_root: true
fields:
  _conf:
    geoip_enrich: {{geoip_enrich}}
    map_to_ecs: {{map_to_ecs}}
{{#if hide_keywords}}
hide_keywords:
{{#each hide_keywords as |hide_keyword|}}
  - {{hide_keyword}}
{{/each}}
{{/if}}
{{#if send_headers}}
send_headers:
{{#each send_headers as |send_header|}}
  - {{send_header}}
{{/each}}
{{/if}}
{{#if send_all_headers}}
send_all_headers: {{send_all_headers}}
{{/if}}
{{#if redact_headers}}
redact_headers:
{{#each redact_headers as |redact_header|}}
  - {{redact_header}}
{{/each}}
{{/if}}
{{#if include_body_for}}
include_body_for:
{{#each include_body_for as |include_body_for_elem|}}
  - {{include_body_for_elem}}
{{/each}}
{{/if}}
{{#if include_request_body_for}}
include_request_body_for:
{{#each include_request_body_for as |include_request_body_for_elem|}}
  - {{include_request_body_for_elem}}
{{/each}}
{{/if}}
{{#if include_response_body_for}}
include_response_body_for:
{{#each include_response_body_for as |include_response_body_for_elem|}}
  - {{include_response_body_for_elem}}
{{/each}}
{{/if}}
{{#if decode_body}}
decode_body: {{decode_body}}
{{/if}}
{{#if split_cookie}}
split_cookie: {{split_cookie}}
{{/if}}
{{#if real_ip_header}}
real_ip_header: {{real_ip_header}}
{{/if}}
{{#if send_request}}
send_request: {{send_request}}
{{/if}}
{{#if send_response}}
send_response: {{send_response}}
{{/if}}
{{#if keep_null}}
keep_null: {{keep_null}}
{{/if}}
{{#if transaction_timeout}}
transaction_timeout: {{transaction_timeout}}
{{/if}}
{{#if max_message_size}}
max_message_size: {{max_message_size}}
{{/if}}
processors:
{{#contains "forwarded" tags}}
- add_observer_metadata: ~
{{else}}
- add_host_metadata: ~
{{/contains}}
{{processors}}
{{#if tags}}
tags:
{{#each tags as |tag|}}
  - {{tag}}
{{/each}}
{{/if}}
{{#if monitor_processes}}
procs:
  enabled: true
{{/if}}
{{#if interface}}
interface:
{{#if (contains ".pcap" interface)}}
  file: {{interface}}
{{else}}
  device: {{interface}}
{{/if}}
{{/if}}
{{#if never_install}}
npcap:
  never_install: true
{{/if}}
{{#if with_vlans}}
interfaces:
  with_vlans: true
{{/if}}
{{#if ignore_outgoing}}
ignore_outgoing: true
{{/if}}
