type: mongodb
{{#if port}}
ports:
{{#each port as |p|}}
  - {{p}}
{{/each}}
{{/if}}
fields_under_root: true
fields:
  _conf:
    geoip_enrich: {{geoip_enrich}}
    map_to_ecs: {{map_to_ecs}}
{{#if max_docs}}
max_docs: {{max_docs}}
{{/if}}
{{#if max_doc_length}}
max_doc_length: {{max_doc_length}}
{{/if}}
{{#if send_request}}
send_request: {{send_request}}
{{/if}}
{{#if send_response}}
send_response: {{send_response}}
{{/if}}
{{#if keep_null}}
keep_null: {{keep_null}}
{{/if}}
{{#if transaction_timeout}}
transaction_timeout: {{transaction_timeout}}
{{/if}}
processors:
{{#contains "forwarded" tags}}
- add_observer_metadata: ~
{{else}}
- add_host_metadata: ~
{{/contains}}
{{processors}}
{{#if tags}}
tags:
{{#each tags as |tag|}}
  - {{tag}}
{{/each}}
{{/if}}
{{#if monitor_processes}}
procs:
  enabled: true
{{/if}}
{{#if interface}}
interface:
{{#if (contains ".pcap" interface)}}
  file: {{interface}}
{{else}}
  device: {{interface}}
{{/if}}
{{/if}}
{{#if never_install}}
npcap:
  never_install: true
{{/if}}
{{#if with_vlans}}
interfaces:
  with_vlans: true
{{/if}}
