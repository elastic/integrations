{
    "@timestamp": "2025-09-16T07:09:22.352Z",
    "agent": {
        "ephemeral_id": "44ca4103-4c73-4286-9a0c-4b20ac6bdb81",
        "id": "af37b9a4-71dd-4ebb-964e-85832bb68218",
        "name": "elastic-agent-32566",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "data_stream": {
        "dataset": "sysdig.cspm",
        "namespace": "30841",
        "type": "logs"
    },
    "ecs": {
        "version": "8.17.0"
    },
    "elastic_agent": {
        "id": "af37b9a4-71dd-4ebb-964e-85832bb68218",
        "snapshot": false,
        "version": "8.16.0"
    },
    "event": {
        "agent_id_status": "verified",
        "category": [
            "configuration"
        ],
        "dataset": "sysdig.cspm",
        "id": "21344",
        "ingested": "2025-09-16T07:09:25Z",
        "kind": "state",
        "original": "{\"acceptedCount\":0,\"control\":{\"acceptedCount\":0,\"authors\":\"Sysdig\",\"description\":\"Ensure that your Amazon Lambda environment variables are using customer-managed Customer Master Keys (CMKs) instead of AWS managed-keys (i.e. default keys used when there are no customer keys defined) in order to benefit from a more granular control over the data encryption and decryption process. The environment variables defined for your Amazon Lambda functions are key-value pairs that are used to store configuration settings without the need to change function code.\",\"id\":\"21344\",\"isManual\":false,\"lastUpdate\":\"1752149383\",\"name\":\"Lambda - Enable Encryption at Rest for Environment Variables using Customer Master Keys\",\"objectsCount\":2879,\"pass\":false,\"passingCount\":0,\"platform\":\"\",\"remediationId\":\"21344\",\"resourceApiEndpoint\":\"/api/cspm/v1/cloud/resources?controlId=21344\\u0026providerType=AWS\\u0026resourceKind=AWS_LAMBDA_FUNCTION\\u0026filter=policyId=52 and zones.id=119\",\"resourceKind\":\"AWS_LAMBDA_FUNCTION\",\"severity\":\"High\",\"supportedDistributions\":[{\"maxVersion\":0,\"minVersion\":0,\"name\":\"AWS\"}],\"target\":\"AWS\",\"type\":8},\"description\":\"All Amazon Web Services Controls.\",\"failedControls\":136,\"highSeverityCount\":3147,\"lowSeverityCount\":2926,\"mediumSeverityCount\":20805,\"name\":\"AWS Controls\",\"pass\":false,\"passingCount\":23735,\"policyId\":\"52\",\"policyName\":\"All Posture Findings\",\"requirementId\":\"637489\",\"severity\":\"High\",\"zone\":{\"id\":\"119\",\"name\":\"Entire Infrastructure\"}}",
        "outcome": "failure",
        "severity": 73,
        "type": [
            "info"
        ]
    },
    "input": {
        "type": "cel"
    },
    "message": "AWS Controls",
    "observer": {
        "product": "Sysdig Secure",
        "vendor": "Sysdig"
    },
    "result": {
        "evaluation": "failed"
    },
    "rule": {
        "benchmark": {
            "name": "All Posture Findings",
            "rule_number": "52"
        },
        "description": "Ensure that your Amazon Lambda environment variables are using customer-managed Customer Master Keys (CMKs) instead of AWS managed-keys (i.e. default keys used when there are no customer keys defined) in order to benefit from a more granular control over the data encryption and decryption process. The environment variables defined for your Amazon Lambda functions are key-value pairs that are used to store configuration settings without the need to change function code.",
        "id": "21344",
        "name": "Lambda - Enable Encryption at Rest for Environment Variables using Customer Master Keys",
        "uuid": "oa/CQUKtlb6YkI7MHaPyXvYQoss="
    },
    "sysdig": {
        "cspm": {
            "accepted_count": 0,
            "control": {
                "accepted_count": 0,
                "authors": "Sysdig",
                "is_manual": false,
                "last_update": "2025-07-10T12:09:43.000Z",
                "objects_count": 2879,
                "pass": false,
                "passing_count": 0,
                "remediation_id": "21344",
                "resource_api_endpoint": "/api/cspm/v1/cloud/resources?controlId=21344&providerType=AWS&resourceKind=AWS_LAMBDA_FUNCTION&filter=policyId=52 and zones.id=119",
                "resource_kind": "AWS_LAMBDA_FUNCTION",
                "severity": "High",
                "supported_distributions": [
                    {
                        "max_version": "0",
                        "min_version": "0",
                        "name": "AWS"
                    }
                ],
                "target": "AWS",
                "type": 8
            },
            "description": "All Amazon Web Services Controls.",
            "failed_controls": 136,
            "high_severity_count": 3147,
            "low_severity_count": 2926,
            "medium_severity_count": 20805,
            "name": "AWS Controls",
            "pass": false,
            "passing_count": 23735,
            "requirement_id": "637489",
            "severity": "High",
            "zone": {
                "id": "119",
                "name": "Entire Infrastructure"
            }
        }
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "sysdig-cspm"
    ]
}
