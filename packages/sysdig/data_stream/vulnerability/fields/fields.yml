- name: sysdig
  type: group
  fields:
    - name: vulnerability
      type: group
      fields:
        - name: asset_type
          type: keyword
          description: scan result asset type.
        - name: created_at
          type: date
          description: datetime of creation.
        - name: image_id
          type: keyword
          description: Identifier of the image.
        - name: image_id_algorithm
          type: keyword
          description: algorithm of the image hash.
        - name: image_id_hash
          type: keyword
          description: Identifier of the image (hash).
        - name: is_risk_spotlight_enabled
          type: boolean
          description: Whether risk spotlight is enabled or not.
        - name: main_asset_name
          type: keyword
          description: Name of the scanned asset.
        - name: metadata
          type: group
          fields:
            - name: architecture
              type: keyword
              description: image or host architecture.
            - name: author
              type: keyword
              description: image author.
            - name: base_os
              type: keyword
              description: image base os.
            - name: created_at
              type: date
              description: datetime of creation.
            - name: digest
              type: keyword
              description: image digest.
            - name: host_id
              type: keyword
              description: host id.
            - name: host_name
              type: keyword
              description: host name.
            - name: image_id
              type: keyword
              description: image id.
            - name: labels
              type: group
              fields:
                - name: homepage
                  type: keyword
                - name: io
                  type: group
                  fields:
                    - name: mend
                      type: group
                      fields:
                        - name: image
                          type: group
                          fields:
                            - name: dockerfile
                              type: group
                              fields:
                                - name: path
                                  type: keyword
                - name: maintainer
                  type: keyword
                - name: org
                  type: group
                  fields:
                    - name: label_schema
                      type: group
                      fields:
                        - name: build_date
                          type: date
                        - name: name
                          type: keyword
                        - name: vcs_ref
                          type: keyword
                        - name: vcs_url
                          type: keyword
                    - name: opencontainers
                      type: group
                      fields:
                        - name: image
                          type: group
                          fields:
                            - name: description
                              type: keyword
                            - name: source
                              type: keyword
                - name: repository
                  type: keyword
            - name: os
              type: keyword
              description: image os.
            - name: pull_string
              type: keyword
              description: image pull string.
            - name: size
              type: long
              description: image size in bytes.
        - name: package
          type: group
          fields:
            - name: is_removed
              type: boolean
              description: whether the package has been removed.
            - name: is_running
              type: boolean
              description: whether the package is used by a running process.
            - name: layers
              type: group
              fields:
                - name: base_images
                  type: group
                  fields:
                    - name: base_images_ref
                      type: keyword
                      description: base images refs.
                    - name: pull_strings
                      type: keyword
                - name: command
                  type: keyword
                  description: layer command.
                - name: digest
                  type: keyword
                  description: sha256 digest of the layer.
                - name: digest_algorithm
                  type: keyword
                  description: algorithm of the layer digest hash.
                - name: digest_hash
                  type: keyword
                  description: sha256 digest of the layer.
                - name: index
                  type: long
                  description: layer's index.
                - name: layer_ref
                  type: keyword
                  description: reference to layer.
                - name: size
                  type: long
                  description: size of the layer in bytes.
            - name: license
              type: keyword
              description: license of the package.
            - name: name
              type: keyword
              description: name of the package.
            - name: package_ref
              type: keyword
              description: reference to package.
            - name: path
              type: keyword
              description: path of the package.
            - name: suggested_fix
              type: keyword
              description: suggested fix for the package.
            - name: type
              type: keyword
              description: 'scan result package type, example values are: os, rust, java, ruby, javascript, python, php, golang, C#.'
            - name: version
              type: keyword
              description: version of the affected package.
            - name: vulnerability
              type: group
              fields:
                - name: cvss_score
                  type: group
                  fields:
                    - name: score
                      type: double
                      description: CVSS score.
                    - name: vector
                      type: keyword
                      description: attack vector.
                    - name: version
                      type: keyword
                - name: disclosure_date
                  type: date
                - name: exploit
                  type: group
                  fields:
                    - name: links
                      type: keyword
                    - name: publication_date
                      type: date
                      description: exploit publication date.
                - name: exploitable
                  type: boolean
                - name: fix_version
                  type: keyword
                - name: main_provider
                  type: keyword
                - name: name
                  type: keyword
                - name: package_ref
                  type: keyword
                  description: reference to the affected package.
                - name: providers_metadata
                  type: group
                  fields:
                    - name: almalinux
                      type: group
                      fields:
                        - name: publish_date
                          type: date
                    - name: amazon
                      type: group
                      fields:
                        - name: publish_date
                          type: date
                    - name: cisakev
                      type: group
                      fields:
                        - name: publish_date
                          type: date
                    - name: euleros
                      type: group
                      fields:
                        - name: publish_date
                          type: date
                    - name: first
                      type: group
                      fields:
                        - name: org
                          type: group
                          fields:
                            - name: epss_score
                              type: group
                              fields:
                                - name: percentile
                                  type: double
                                - name: score
                                  type: double
                                - name: timestamp
                                  type: date
                    - name: gentoo
                      type: group
                      fields:
                        - name: publish_date
                          type: date
                    - name: github
                      type: group
                      fields:
                        - name: publish_date
                          type: date
                    - name: gitlab
                      type: group
                      fields:
                        - name: publish_date
                          type: date
                    - name: nvd
                      type: group
                      fields:
                        - name: cvss_score
                          type: group
                          fields:
                            - name: score
                              type: double
                            - name: vector
                              type: keyword
                            - name: version
                              type: keyword
                        - name: publish_date
                          type: date
                        - name: severity
                          type: keyword
                    - name: pypiadvisory
                      type: group
                      fields:
                        - name: publish-date
                          type: date
                    - name: rhel
                      type: group
                      fields:
                        - name: cvss_score
                          type: group
                          fields:
                            - name: score
                              type: double
                            - name: vector
                              type: keyword
                            - name: version
                              type: keyword
                        - name: publish_date
                          type: date
                        - name: severity
                          type: keyword
                    - name: rocky
                      type: group
                      fields:
                        - name: publish_date
                          type: date
                    - name: rubyadvisory
                      type: group
                      fields:
                        - name: publish_date
                          type: date
                    - name: ubuntu
                      type: group
                      fields:
                        - name: publish_date
                          type: date
                    - name: vulndb
                      type: group
                      fields:
                        - name: publish_date
                          type: date
                - name: risk_accepts
                  type: group
                  fields:
                    - name: context
                      type: group
                      fields:
                        - name: type
                          type: keyword
                          description: 'Enum: "packageName" "packageVersion" "imageName" "imagePrefix" "imageSuffix" "imageAssetToken" "hostName" "hostAssetToken".'
                        - name: value
                          type: keyword
                          description: Value for the context entry.
                    - name: created_at
                      type: date
                      description: datetime of creation.
                    - name: description
                      type: keyword
                      description: risk acceptance description.
                    - name: entity_type
                      type: keyword
                      description: entity type for the risk.
                    - name: entity_value
                      type: keyword
                      description: entity value relative to the the entity type.
                    - name: expiration_date
                      type: date
                    - name: id
                      type: keyword
                      description: id of the risk acceptance.
                    - name: reason
                      type: keyword
                      description: risk acceptance reason.
                    - name: risk_accept_refs
                      type: keyword
                      description: reference to risk acceptance.
                    - name: status
                      type: keyword
                      description: 'Enum: "active" "expired".'
                    - name: updated_at
                      type: date
                      description: datetime of last update.
                - name: severity
                  type: keyword
                  description: 'Enum: "critical" "high" "medium" "low" "negligible".'
                - name: solution_date
                  type: date
                - name: vulnerabilities_ref
                  type: keyword
        - name: policies
          type: group
          fields:
            - name: evaluations
              type: group
              fields:
                - name: bundles
                  type: group
                  fields:
                    - name: identifier
                      type: keyword
                      description: Identifier of the bundle.
                    - name: name
                      type: keyword
                      description: Name of the bundle.
                    - name: rules
                      type: group
                      fields:
                        - name: description
                          type: keyword
                          description: rule description.
                        - name: evaluation_result
                          type: keyword
                          description: 'Enum: "passed" "failed" "notApplicable" "accepted"'
                        - name: failure_type
                          type: keyword
                          description: 'Enum: "pkgVulnFailure" "imageConfigFailure" rule failure type.'
                        - name: predicates
                          type: group
                          fields:
                            - name: type
                              type: keyword
                              description: predicate type.
                        - name: rule_id
                          type: keyword
                          description: rule's id.
                        - name: rule_type
                          type: keyword
                          description: rule type.
                    - name: type
                      type: keyword
                      description: 'Enum: "predefined" "custom"'
                - name: created_at
                  type: date
                  description: datetime of creation.
                - name: description
                  type: keyword
                  description: policy evaluation description.
                - name: evaluation
                  type: keyword
                  description: 'Enum: "passed" "failed" "accepted" "noPolicy"'
                - name: identifier
                  type: keyword
                  description: policy evaluation id.
                - name: name
                  type: keyword
                  description: policy evaluation name.
                - name: updated_at
                  type: date
                  description: datetime of last update.
            - name: global_evaluation
              type: keyword
              description: 'Enum: "passed" "failed" "accepted" "noPolicy"'
        - name: policy_evaluation_result
          type: keyword
          description: 'Enum: "passed" "failed" "accepted" "noPolicy" "notApplicable" Policy evaluation result.'
        - name: producer
          type: group
          fields:
            - name: produced_at
              type: date
        - name: pull_string
          type: keyword
          description: image pull string.
        - name: resource_id
          type: keyword
          description: 'Identifier of the scanned resource: it will be the image ID for container images or the host ID for hosts.'
        - name: result_id
          type: keyword
          description: Identifier of the scan result.
        - name: running_vuln_total_by_severity
          type: group
          fields:
            - name: critical
              type: long
              description: number of critical vulnerabilities.
            - name: high
              type: long
              description: number of high vulnerabilities.
            - name: low
              type: long
              description: number of low vulnerabilities.
            - name: medium
              type: long
              description: number of medium vulnerabilities.
            - name: negligible
              type: long
              description: number of negligible vulnerabilities.
        - name: sbom_id
          type: keyword
          description: Identifier of the sbom.
        - name: scope
          type: group
          fields:
            - name: asset
              type: group
              fields:
                - name: type
                  type: keyword
            - name: aws
              type: group
              fields:
                - name: account
                  type: group
                  fields:
                    - name: id
                      type: keyword
                - name: host
                  type: group
                  fields:
                    - name: name
                      type: keyword
                - name: region
                  type: keyword
            - name: azure
              type: group
              fields:
                - name: instance
                  type: group
                  fields:
                    - name: id
                      type: keyword
                    - name: name
                      type: keyword
                - name: resource_group
                  type: keyword
                - name: subscription
                  type: group
                  fields:
                    - name: id
                      type: keyword
            - name: cloud_provider
              type: group
              fields:
                - name: account
                  type: group
                  fields:
                    - name: id
                      type: keyword
                - name: name
                  type: keyword
                - name: region
                  type: keyword
            - name: gcp
              type: group
              fields:
                - name: instance
                  type: group
                  fields:
                    - name: id
                      type: keyword
                    - name: zone
                      type: keyword
                - name: project
                  type: group
                  fields:
                    - name: id
                      type: keyword
                    - name: numeric_id
                      type: keyword
            - name: host
              type: group
              fields:
                - name: host_name
                  type: keyword
            - name: kubernetes
              type: group
              fields:
                - name: cluster
                  type: group
                  fields:
                    - name: name
                      type: keyword
                - name: namespace
                  type: group
                  fields:
                    - name: name
                      type: keyword
                - name: node
                  type: group
                  fields:
                    - name: name
                      type: keyword
                - name: pod
                  type: group
                  fields:
                    - name: container
                      type: group
                      fields:
                        - name: name
                          type: keyword
                - name: workload
                  type: group
                  fields:
                    - name: name
                      type: keyword
                    - name: type
                      type: keyword
            - name: registry
              type: group
              fields:
                - name: name
                  type: keyword
                - name: vendor
                  type: keyword
                  description: Identifier the vendor of the image.
            - name: workload
              type: group
              fields:
                - name: name
                  type: keyword
                - name: orchestrator
                  type: keyword
        - name: stage
          type: keyword
          description: 'Enum: "pipeline" "runtime" "registry" scan result stage.'
        - name: vendor
          type: keyword
          description: Identifier the vendor of the image.
        - name: vuln_total_by_severity
          type: group
          fields:
            - name: critical
              type: long
              description: number of critical vulnerabilities.
            - name: high
              type: long
              description: number of high vulnerabilities.
            - name: low
              type: long
              description: number of low vulnerabilities.
            - name: medium
              type: long
              description: number of medium vulnerabilities.
            - name: negligible
              type: long
              description: number of negligible vulnerabilities.
