{"rawmsg":"{\"id\":\"17e047bb57e1dd327116c24c51b0e80b\",\"type\":\"policy\",\"timestamp\":1720453927614405938,\"timestampRFC3339Nano\":\"2024-07-08T15:52:07.614405938Z\",\"originator\":\"policy\",\"category\":\"runtime\",\"source\":\"syscall\",\"name\":\"Sysdig Runtime Activity Logs\",\"description\":\"This policy contains rules which provide a greater insight into general activities occuring on the system. They are very noisy, but useful in threat hunting situations if you are looking for specific actions being taken during runtime. It is not recommended to use this policy for detection purposes unless tuning is enabled.  Additional manual tuning will likely be required.\",\"severity\":7,\"agentId\":58462617,\"containerId\":\"dca8e7062087\",\"machineId\":\"7c:1e:52:18:ea:95\",\"hostMac\":\"7c:1e:52:18:ea:95\",\"content\":{\"policyId\":10011704,\"baselineId\":\"\",\"ruleName\":\"Drop and execute new binary in container\",\"ruleType\":\"RULE_TYPE_FALCO\",\"ruleTags\":[\"container\",\"MITRE\",\"MITRE_T1525_implant_internal_image\",\"MITRE_TA0003_persistence\"],\"output\":\"Executing binary ruby with parent livenessprobe.s not part of base image mcr.microsoft.com/azuremonitor/containerinsights/ciprod on ama-logs under user root and execution path /usr/bin/ruby (proc.name=ruby proc.pname=livenessprobe.s fd.name=\\u003cNA\\u003e proc.cmdline=ruby /opt/dcr-config-parser.rb proc.pcmdline=livenessprobe.s /opt/livenessprobe.sh gparent=runc ggparent=containerd-shim gggparent=systemd evt.type=execveproc.args=/opt/dcr-config-parser.rb proc.pid=2873847 proc.cwd=/opt/ proc.ppid=2873833 proc.exepath=/usr/bin/ruby user.uid=0 user.loginuid=-1 user.loginname=\\u003cNA\\u003e user.name=root group.gid=0 group.name=root container.id=dca8e7062087 container.name=ama-logs image=mcr.microsoft.com/azuremonitor/containerinsights/ciprod:3.1.21)\",\"fields\":{\"container.id\":\"dca8e7062087\",\"container.image.repository\":\"mcr.microsoft.com/azuremonitor/containerinsights/ciprod\",\"container.image.tag\":\"3.1.21\",\"container.name\":\"ama-logs\",\"evt.type\":\"execve\",\"falco.rule\":\"Drop and execute new binary in container\",\"fd.name\":\"\\u003cNA\\u003e\",\"group.gid\":\"0\",\"group.name\":\"root\",\"proc.aname[2]\":\"runc\",\"proc.aname[3]\":\"containerd-shim\",\"proc.aname[4]\":\"systemd\",\"proc.args\":\"/opt/dcr-config-parser.rb\",\"proc.cmdline\":\"ruby /opt/dcr-config-parser.rb\",\"proc.cwd\":\"/opt/\",\"proc.exepath\":\"/usr/bin/ruby\",\"proc.name\":\"ruby\",\"proc.pcmdline\":\"livenessprobe.s /opt/livenessprobe.sh\",\"proc.pid\":\"2873847\",\"proc.pname\":\"livenessprobe.s\",\"proc.ppid\":\"2873833\",\"user.loginname\":\"\\u003cNA\\u003e\",\"user.loginuid\":\"-1\",\"user.name\":\"root\",\"user.uid\":\"0\"},\"falsePositive\":false,\"matchedOnDefault\":false,\"policyVersion\":35,\"policyOrigin\":\"Sysdig\"},\"labels\":{\"azure.instanceId\":\"0e9d8b7c-f35a-4b9f-b204-a686a6bbeeff\",\"azure.instanceName\":\"aks-userpool-12996081-vmss_0\",\"azure.instanceSize\":\"Standard_D8ds_v5\",\"azure.location\":\"eastus\",\"azure.resourceGroupName\":\"MC_strategic-alliances-resource-group_servicenow-test-alliances_eastus\",\"azure.subscriptionId\":\"7a100e05-8316-474d-99c0-b824d0e86366\",\"cloudProvider.account.id\":\"7a100e05-8316-474d-99c0-b824d0e86366\",\"cloudProvider.name\":\"azure\",\"cloudProvider.region\":\"eastus\",\"container.image.digest\":\"sha256:23d7f85cb62d86e87932e1af382be27cd07d744c350cb825b591b9f00d71babe\",\"container.image.id\":\"23d7f85cb62d\",\"container.image.repo\":\"mcr.microsoft.com/azuremonitor/containerinsights/ciprod\",\"container.image.tag\":\"3.1.21\",\"container.label.io.kubernetes.container.name\":\"ama-logs\",\"container.label.io.kubernetes.pod.name\":\"ama-logs-g6jtg\",\"container.label.io.kubernetes.pod.namespace\":\"kube-system\",\"container.name\":\"ama-logs\",\"host.hostName\":\"aks-userpool-12996081-vmss000000\",\"host.mac\":\"7c:1e:52:18:ea:95\",\"kubernetes.cluster.name\":\"servicenow-test-cluster\",\"kubernetes.daemonSet.name\":\"ama-logs\",\"kubernetes.namespace.name\":\"kube-system\",\"kubernetes.node.name\":\"aks-userpool-12996081-vmss000000\",\"kubernetes.pod.name\":\"ama-logs-g6jtg\",\"kubernetes.workload.name\":\"ama-logs\",\"kubernetes.workload.type\":\"daemonset\",\"process.name\":\"ruby /opt/dcr-config-parser.rb\"}}"}
{"rawmsg":"{\"id\":\"17e047bbc60085466d8dfa9f45689b14\",\"type\":\"policy\",\"timestamp\":1720453929461908806,\"timestampRFC3339Nano\":\"2024-07-08T15:52:09.461908806Z\",\"originator\":\"policy\",\"category\":\"runtime\",\"source\":\"syscall\",\"name\":\"Sysdig Runtime Activity Logs\",\"description\":\"This policy contains rules which provide a greater insight into general activities occuring on the system. They are very noisy, but useful in threat hunting situations if you are looking for specific actions being taken during runtime. It is not recommended to use this policy for detection purposes unless tuning is enabled.  Additional manual tuning will likely be required.\",\"severity\":7,\"agentId\":58462627,\"containerId\":\"c7d7862a3972\",\"machineId\":\"60:45:bd:ec:8a:77\",\"hostMac\":\"60:45:bd:ec:8a:77\",\"content\":{\"policyId\":10011704,\"baselineId\":\"\",\"ruleName\":\"Drop and execute new binary in container\",\"ruleType\":\"RULE_TYPE_FALCO\",\"ruleTags\":[\"container\",\"MITRE\",\"MITRE_T1525_implant_internal_image\",\"MITRE_TA0003_persistence\"],\"output\":\"Executing binary ruby with parent livenessprobe.s not part of base image mcr.microsoft.com/azuremonitor/containerinsights/ciprod on ama-logs under user root and execution path /usr/bin/ruby (proc.name=ruby proc.pname=livenessprobe.s fd.name=\\u003cNA\\u003e proc.cmdline=ruby /opt/dcr-config-parser.rb proc.pcmdline=livenessprobe.s /opt/livenessprobe.sh gparent=runc ggparent=containerd-shim gggparent=systemd evt.type=execveproc.args=/opt/dcr-config-parser.rb proc.pid=2860010 proc.cwd=/opt/ proc.ppid=2860000 proc.exepath=/usr/bin/ruby user.uid=0 user.loginuid=-1 user.loginname=\\u003cNA\\u003e user.name=root group.gid=0 group.name=root container.id=c7d7862a3972 container.name=ama-logs image=mcr.microsoft.com/azuremonitor/containerinsights/ciprod:3.1.21)\",\"fields\":{\"container.id\":\"c7d7862a3972\",\"container.image.repository\":\"mcr.microsoft.com/azuremonitor/containerinsights/ciprod\",\"container.image.tag\":\"3.1.21\",\"container.name\":\"ama-logs\",\"evt.type\":\"execve\",\"falco.rule\":\"Drop and execute new binary in container\",\"fd.name\":\"\\u003cNA\\u003e\",\"group.gid\":\"0\",\"group.name\":\"root\",\"proc.aname[2]\":\"runc\",\"proc.aname[3]\":\"containerd-shim\",\"proc.aname[4]\":\"systemd\",\"proc.args\":\"/opt/dcr-config-parser.rb\",\"proc.cmdline\":\"ruby /opt/dcr-config-parser.rb\",\"proc.cwd\":\"/opt/\",\"proc.exepath\":\"/usr/bin/ruby\",\"proc.name\":\"ruby\",\"proc.pcmdline\":\"livenessprobe.s /opt/livenessprobe.sh\",\"proc.pid\":\"2860010\",\"proc.pname\":\"livenessprobe.s\",\"proc.ppid\":\"2860000\",\"user.loginname\":\"\\u003cNA\\u003e\",\"user.loginuid\":\"-1\",\"user.name\":\"root\",\"user.uid\":\"0\"},\"falsePositive\":false,\"matchedOnDefault\":false,\"policyVersion\":35,\"policyOrigin\":\"Sysdig\"},\"labels\":{\"azure.instanceId\":\"944d3ff8-7d04-495b-80e1-056fd3fd003c\",\"azure.instanceName\":\"aks-alliancespl-12996081-vmss_0\",\"azure.instanceSize\":\"Standard_B4ms\",\"azure.location\":\"eastus\",\"azure.resourceGroupName\":\"MC_strategic-alliances-resource-group_servicenow-test-alliances_eastus\",\"azure.subscriptionId\":\"7a100e05-8316-474d-99c0-b824d0e86366\",\"cloudProvider.account.id\":\"7a100e05-8316-474d-99c0-b824d0e86366\",\"cloudProvider.name\":\"azure\",\"cloudProvider.region\":\"eastus\",\"container.image.digest\":\"sha256:23d7f85cb62d86e87932e1af382be27cd07d744c350cb825b591b9f00d71babe\",\"container.image.id\":\"23d7f85cb62d\",\"container.image.repo\":\"mcr.microsoft.com/azuremonitor/containerinsights/ciprod\",\"container.image.tag\":\"3.1.21\",\"container.label.io.kubernetes.container.name\":\"ama-logs\",\"container.label.io.kubernetes.pod.name\":\"ama-logs-4q4q5\",\"container.label.io.kubernetes.pod.namespace\":\"kube-system\",\"container.name\":\"ama-logs\",\"host.hostName\":\"aks-alliancespl-12996081-vmss000000\",\"host.mac\":\"60:45:bd:ec:8a:77\",\"kubernetes.cluster.name\":\"servicenow-test-cluster\",\"kubernetes.daemonSet.name\":\"ama-logs\",\"kubernetes.namespace.name\":\"kube-system\",\"kubernetes.node.name\":\"aks-alliancespl-12996081-vmss000000\",\"kubernetes.pod.name\":\"ama-logs-4q4q5\",\"kubernetes.workload.name\":\"ama-logs\",\"kubernetes.workload.type\":\"daemonset\",\"process.name\":\"ruby /opt/dcr-config-parser.rb\"}}"}
{"rawmsg":"{\"id\":\"17e047bb57e1dd327116c24c51b0e80b\",\"type\":\"policy\",\"timestamp\":1720453927614405938,\"timestampRFC3339Nano\":\"2024-07-08T15:52:07.614405938Z\",\"originator\":\"policy\",\"category\":\"runtime\",\"source\":\"syscall\",\"name\":\"Sysdig Runtime Activity Logs\",\"description\":\"This policy contains rules which provide a greater insight into general activities occuring on the system. They are very noisy, but useful in threat hunting situations if you are looking for specific actions being taken during runtime. It is not recommended to use this policy for detection purposes unless tuning is enabled.  Additional manual tuning will likely be required.\",\"severity\":7,\"agentId\":58462617,\"containerId\":\"dca8e7062087\",\"machineId\":\"7c:1e:52:18:ea:95\",\"hostMac\":\"7c:1e:52:18:ea:95\",\"content\":{\"policyId\":10011704,\"baselineId\":\"\",\"ruleName\":\"Drop and execute new binary in container\",\"ruleType\":\"RULE_TYPE_FALCO\",\"ruleTags\":[\"container\",\"MITRE\",\"MITRE_T1525_implant_internal_image\",\"MITRE_TA0003_persistence\"],\"output\":\"Executing binary ruby with parent livenessprobe.s not part of base image mcr.microsoft.com/azuremonitor/containerinsights/ciprod on ama-logs under user root and execution path /usr/bin/ruby (proc.name=ruby proc.pname=livenessprobe.s fd.name=\\u003cNA\\u003e proc.cmdline=ruby /opt/dcr-config-parser.rb proc.pcmdline=livenessprobe.s /opt/livenessprobe.sh gparent=runc ggparent=containerd-shim gggparent=systemd evt.type=execveproc.args=/opt/dcr-config-parser.rb proc.pid=2873847 proc.cwd=/opt/ proc.ppid=2873833 proc.exepath=/usr/bin/ruby user.uid=0 user.loginuid=-1 user.loginname=\\u003cNA\\u003e user.name=root group.gid=0 group.name=root container.id=dca8e7062087 container.name=ama-logs image=mcr.microsoft.com/azuremonitor/containerinsights/ciprod:3.1.21)\",\"fields\":{\"container.id\":\"dca8e7062087\",\"container.image.repository\":\"mcr.microsoft.com/azuremonitor/containerinsights/ciprod\",\"container.image.tag\":\"3.1.21\",\"container.name\":\"ama-logs\",\"evt.type\":\"execve\",\"falco.rule\":\"Drop and execute new binary in container\",\"fd.name\":\"\\u003cNA\\u003e\",\"group.gid\":\"0\",\"group.name\":\"root\",\"proc.aname[2]\":\"runc\",\"proc.aname[3]\":\"containerd-shim\",\"proc.aname[4]\":\"systemd\",\"proc.args\":\"/opt/dcr-config-parser.rb\",\"proc.cmdline\":\"ruby /opt/dcr-config-parser.rb\",\"proc.cwd\":\"/opt/\",\"proc.exepath\":\"/usr/bin/ruby\",\"proc.name\":\"ruby\",\"proc.pcmdline\":\"livenessprobe.s /opt/livenessprobe.sh\",\"proc.pid\":\"2873847\",\"proc.pname\":\"livenessprobe.s\",\"proc.ppid\":\"2873833\",\"user.loginname\":\"\\u003cNA\\u003e\",\"user.loginuid\":\"-1\",\"user.name\":\"root\",\"user.uid\":\"0\"},\"falsePositive\":false,\"matchedOnDefault\":false,\"policyVersion\":35,\"policyOrigin\":\"Sysdig\"},\"labels\":{\"azure.instanceId\":\"0e9d8b7c-f35a-4b9f-b204-a686a6bbeeff\",\"azure.instanceName\":\"aks-userpool-12996081-vmss_0\",\"azure.instanceSize\":\"Standard_D8ds_v5\",\"azure.location\":\"eastus\",\"azure.resourceGroupName\":\"MC_strategic-alliances-resource-group_servicenow-test-alliances_eastus\",\"azure.subscriptionId\":\"7a100e05-8316-474d-99c0-b824d0e86366\",\"cloudProvider.account.id\":\"7a100e05-8316-474d-99c0-b824d0e86366\",\"cloudProvider.name\":\"azure\",\"cloudProvider.region\":\"eastus\",\"container.image.digest\":\"sha256:23d7f85cb62d86e87932e1af382be27cd07d744c350cb825b591b9f00d71babe\",\"container.image.id\":\"23d7f85cb62d\",\"container.image.repo\":\"mcr.microsoft.com/azuremonitor/containerinsights/ciprod\",\"container.image.tag\":\"3.1.21\",\"container.label.io.kubernetes.container.name\":\"ama-logs\",\"container.label.io.kubernetes.pod.name\":\"ama-logs-g6jtg\",\"container.label.io.kubernetes.pod.namespace\":\"kube-system\",\"container.name\":\"ama-logs\",\"host.hostName\":\"aks-userpool-12996081-vmss000000\",\"host.mac\":\"7c:1e:52:18:ea:95\",\"kubernetes.cluster.name\":\"servicenow-test-cluster\",\"kubernetes.daemonSet.name\":\"ama-logs\",\"kubernetes.namespace.name\":\"kube-system\",\"kubernetes.node.name\":\"aks-userpool-12996081-vmss000000\",\"kubernetes.pod.name\":\"ama-logs-g6jtg\",\"kubernetes.workload.name\":\"ama-logs\",\"kubernetes.workload.type\":\"daemonset\",\"process.name\":\"ruby /opt/dcr-config-parser.rb\"}}"}