- name: teleport.audit.kubernetes
  type: group
  description: >
    Common metadata for kubernetes-related events.

  fields:
    - name: cluster
      type: keyword
      description: >
        KubernetesCluster is a Kubernetes cluster name.

    - name: users
      type: flattened
      description: >
        KubernetesUsers is a list of Kubernetes usernames for the user.

    - name: groups
      type: flattened
      description: >
        KubernetesGroups is a list of Kubernetes groups for the user.

    - name: labels
      type: object
      object_type: keyword
      description: "KubernetesLabels are the labels (static and dynamic) of the Kubernetes cluster the session occurred on."
    - name: pod
      type: group
      description: >
        Common metadata for kubernetes pod-related events.

      fields:
        - name: pod_name
          type: flattened
          description: >
            KubernetesPodName is the name of the pod.

        - name: pod_namespace
          type: keyword
          description: >
            KubernetesPodNamespace is the namespace of the pod.

        - name: container_name
          type: flattened
          description: >
            KubernetesContainerName is the name of the container within the pod.

        - name: container_image
          type: flattened
          description: >
            KubernetesContainerImage is the image of the container within the pod.

        - name: node_name
          type: keyword
          description: "KubernetesNodeName is the node that runs the pod."
    - name: resource
      type: group
      description: "Kubernetes API request event metadata"
      fields:
        #        - name: request_path
        #          type: keyword
        #          description: >
        #            RequestPath is the raw request URL path.
        #        - name: verb
        #          type: keyword
        #          description: >
        #            Verb is the HTTP verb used for this request (e.g. GET, POST, etc)
        - name: api_group
          type: keyword
          description: >
            ResourceAPIGroup is the resource API group.

        - name: namespace
          type: keyword
          description: >
            ResourceNamespace is the resource namespace.

        - name: kind
          type: keyword
          description: >
            ResourceKind is the API resource kind (e.g. "pod", "service", etc).

        - name: name
          type: keyword
          description: >
            ResourceName is the API resource name.


#        - name: response_code
#          type: long
#          description: >
#            ResponseCode is the HTTP response code for this request.
