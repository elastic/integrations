- name: teleport.audit.database
  type: group
  description: "Common database information"
  fields:
    - name: service
      type: keyword
      description: >
        DatabaseService is the name of the database service proxying the database.

    - name: protocol
      type: keyword
      description: >
        DatabaseProtocol is the database type, e.g. postgres or mysql.

    - name: name
      type: keyword
      description: >
        DatabaseName is the name of the database a user is connecting to.

    - name: user
      type: keyword
      description: >
        DatabaseUser is the database username used to connect.

    - name: labels
      type: object
      object_type: keyword
      description: >
        DatabaseLabels is the database resource labels.

    - name: aws
      type: group
      description: >
        AWS specific fields.

      fields:
        - name: region
          type: keyword
          description: >
            DatabaseAWSRegion is AWS regions for AWS hosted databases.

        - name: redshift_cluster_id
          type: keyword
          description: >
            DatabaseAWSRedshiftClusterID is cluster ID for Redshift databases.

    - name: gcp
      type: group
      description: >
        GCP specific fields.

      fields:
        - name: project_id
          type: keyword
          description: >
            DatabaseGCPProjectID is project ID for GCP hosted databases.

        - name: instance_id
          type: keyword
          description: >
            DatabaseGCPInstanceID is instance ID for GCP hosted databases.

    - name: roles
      type: keyword
      description: >
        DatabaseRoles is a list of database roles for auto-provisioned users.

    - name: type
      type: keyword
      description: >
        DatabaseType is the database type.

    - name: origin
      type: keyword
      description: "DatabaseOrigin is the database origin source."
    - name: query
      type: keyword
      description: >
        DatabaseQuery is the executed query string.

    - name: query_parameters
      type: keyword
      description: >
        DatabaseQueryParameters are the query parameters for prepared statements.

    - name: permission_summary
      type: object
      object_type: keyword
      description: >
        PermissionSummary is a summary of applied permissions.

    - name: affected_object_counts
      type: object
      object_type: long
      description: >
        AffectedObjectCounts counts how many distinct objects of each kind were affected.

    - name: user_change
      type: group
      description: >
        Provision, disable or delete the user.

      fields:
        - name: username
          type: keyword
          description: >
            Username is the username chosen for the database user. Due to database limitations (e.g. username length, allowed charset) it may differ from Teleport username.

        - name: is_deleted
          type: boolean
          description: >
            Delete indicates if the user was deleted entirely or merely disabled.

    - name: postgres
      type: group
      description: "Postgres related metadata"
      fields:
        - name: statement_name
          type: keyword
          description: >
            StatementName is the prepared statement name.

        - name: portal_name
          type: keyword
          description: >
            PortalName is the destination portal name that binds statement to parameters.

        - name: parameters
          type: keyword
          description: >
            Parameters are the query bind parameters.

        - name: function_oid
          type: keyword
          description: >
            FunctionOID is the Postgres object ID of the called function.

        - name: function_args
          type: keyword
          description: "FunctionArgs contains formatted function arguments."
