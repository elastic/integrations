- name: teleport.audit.certificate
  type: group
  description: "Certificate issuance metadata"
  fields:
    - name: type
      type: keyword
      description: CertificateType is the type of certificate that was just issued.
    - name: identity
      type: group
      description: Identity is the identity associated with the certificate, as interpreted by Teleport.
      fields:
        - name: user
          type: keyword
          description: >
            User is a username or name of the node connection

        - name: impersonator
          type: keyword
          description: >
            Impersonator is a username of a user impersonating this user

        - name: roles
          type: keyword
          description: >
            Roles is a list of groups (Teleport roles) encoded in the identity

        - name: usage
          type: keyword
          description: >
            Usage is a list of usage restrictions encoded in the identity

        - name: logins
          type: keyword
          description: >
            Logins is a list of Unix logins allowed.

        - name: kubernetes_groups
          type: keyword
          description: >
            KubernetesGroups is a list of Kubernetes groups allowed

        - name: kubernetes_users
          type: keyword
          description: >
            KubernetesUsers is a list of Kubernetes users allowed

        - name: expires
          type: date
          description: >
            Expires specifies whenever the session will expire

        - name: route_to_cluster
          type: keyword
          description: >
            RouteToCluster specifies the target cluster if present in the session

        - name: kubernetes_cluster
          type: keyword
          description: >
            KubernetesCluster specifies the target kubernetes cluster for TLS identities.

        - name: traits
          type: object
          object_type: keyword
          description: >
            Traits hold claim data used to populate a role at runtime.

        - name: route_to_app
          type: group
          description: >
            RouteToApp holds routing information for applications.

          fields:
            - name: name
              type: keyword
              description: >
                Name is the application name certificate is being requested for.

            - name: session_id
              type: keyword
              description: >
                SessionID is the ID of the application session.

            - name: public_addr
              type: keyword
              description: >
                PublicAddr is the application public address.

            - name: cluster_name
              type: keyword
              description: >
                ClusterName is the cluster where the application resides.

            - name: aws_role_arn
              type: keyword
              description: >
                AWSRoleARN is the AWS role to assume when accessing AWS API.

            - name: azure_identity
              type: keyword
              description: >
                AzureIdentity is the Azure identity ot assume when accessing Azure API.

            - name: gcp_service_account
              type: keyword
              description: >
                GCPServiceAccount is the GCP service account to assume when accessing GCP API.

        - name: teleport_cluster
          type: keyword
          description: >
            TeleportCluster is the name of the teleport cluster that this identity originated from.

        - name: route_to_database
          type: group
          description: >
            RouteToDatabase contains routing information for databases.

          fields:
            - name: service_name
              type: keyword
              description: >
                ServiceName is the Teleport database proxy service name the cert is for.

            - name: protocol
              type: keyword
              description: >
                Protocol is the type of the database the cert is for.

            - name: username
              type: keyword
              description: >
                Username is an optional database username to embed.

            - name: database
              type: keyword
              description: >
                Database is an optional database name to embed.

            - name: roles
              type: keyword
              description: >
                Roles is an optional list of database roles to embed.

        - name: database_names
          type: keyword
          description: >
            DatabaseNames is a list of allowed database names.

        - name: database_users
          type: keyword
          description: >
            DatabaseUsers is a list of allowed database users.

        - name: aws_role_arns
          type: keyword
          description: >
            AWSRoleARNs is a list of allowed AWS role ARNs user can assume.

        - name: access_requests
          type: keyword
          description: >
            AccessRequests is a list of UUIDs of active requests for this Identity.

        - name: disallow_reissue
          type: boolean
          description: >
            DisallowReissue is a flag that, if set, instructs the auth server to deny any attempts to reissue new certificates while authenticated with this certificate.

        - name: allowed_resource_ids
          type: keyword
          description: >
            AllowedResourceIDs is the list of resources which the identity will be allowed to access. An empty list indicates that no resource-specific restrictions will be applied.

        - name: prev_identity_expires
          type: date
          description: >
            PreviousIdentityExpires is the expiry time of the identity/cert that this identity/cert was derived from.

        - name: azure_identities
          type: keyword
          description: >
            AzureIdentities is a list of allowed Azure identities user can assume.

        - name: gcp_service_accounts
          type: keyword
          description: >
            GCPServiceAccounts is a list of allowed GCP service accounts user can assume.

        - name: private_key_policy
          type: keyword
          description: >
            PrivateKeyPolicy is the private key policy of the user's private key.

        - name: bot_name
          type: keyword
          description: >
            BotName indicates the name of the Machine ID bot this identity was issued to, if any.

        - name: device_extensions
          type: group
          description: >
            DeviceExtensions holds the device trust device extensions for the identity, if any.

          fields:
            - name: device_id
              type: keyword
              description: >
                DeviceID is the trusted device identifier.

            - name: asset_tag
              type: keyword
              description: >
                AssetTag is the device inventory identifier.

            - name: credential_id
              type: keyword
              description: "CredentialID is the identifier for the credential used by the device to authenticate itself.  \n"
