---
description: Pipeline for processing Arista NG Firewall system metrics
processors:
  #######################
  ## Web Filter Events ##
  #######################
  - dissect:
      tag: dissect_arista_requestLine_29153989
      description: Parse HTTP request method and full URL from requestLine
      if: ctx.arista?.requestLine != null && ctx.arista.requestLine.contains(' ')
      field: arista.requestLine
      pattern: '%{http.request.method} %{_temp.url_full}'
  - uri_parts:
      tag: uri_parts__temp_url_full_4359ea69
      if: ctx._temp?.url_full != null
      field: _temp.url_full
      ignore_failure: true
  - rename:
      tag: rename__temp_url_full_to_url_full_893448c8
      field: _temp.url_full
      target_field: url.full
      ignore_missing: true
  ##############
  ## Clean Up ##
  ##############
  - remove:
      tag: remove_5d9e854a
      description: Remove Arista fields that are not necessary after parsing to ECS
      field:
        - arista.appName
      ignore_missing: true
on_failure:
  - set:
      field: event.kind
      value: pipeline_error
  - append:
      field: error.message
      value: >-
        Processor '{{{ _ingest.on_failure_processor_type }}}'
        {{#_ingest.on_failure_processor_tag}}with tag '{{{ _ingest.on_failure_processor_tag }}}'
        {{/_ingest.on_failure_processor_tag}}in pipeline '{{{ _ingest.pipeline }}}'
        failed with message '{{{ _ingest.on_failure_message }}}'
  - append:
      field: tags
      value: preserve_original_event
      allow_duplicates: false
