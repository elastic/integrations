---
description: Pipeline for processing Arista NG Firewall session stats
processors:
  ########################
  ## Session Statistics ##
  ########################
  - rename:
      tag: rename_arista_endTime_to_event_end_f17d936f
      field: arista.endTime
      target_field: event.end
      ignore_missing: true
  - rename:
      tag: rename_arista_sessionEvent_timeStamp_to_event_start_8d0ccb7c
      field: arista.sessionEvent.timeStamp
      target_field: event.start
      ignore_missing: true

  ##############
  ## Clean Up ##
  ##############
  - remove:
      tag: remove_e048e5f1
      description: Remove Arista fields that are not necessary after parsing to ECS
      field:
        - arista.p2cBytes
        - arista.p2sBytes
        - arista.sessionEvent.sessionId
      ignore_missing: true
on_failure:
  - set:
      field: event.kind
      value: pipeline_error
  - append:
      field: error.message
      value: >-
        Processor '{{{ _ingest.on_failure_processor_type }}}'
        {{#_ingest.on_failure_processor_tag}}with tag '{{{ _ingest.on_failure_processor_tag }}}'
        {{/_ingest.on_failure_processor_tag}}in pipeline '{{{ _ingest.pipeline }}}'
        failed with message '{{{ _ingest.on_failure_message }}}'
  - append:
      field: tags
      value: preserve_original_event
      allow_duplicates: false
