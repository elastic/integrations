{{- $timestamp := generate "timestamp" }}
{{- $dpt := generate "dpt" }}
{{- $dst := generate "dst" }}
{{- $endpointGuid := generate "endpointGuid" }}
{{- $endpointHostName := generate "endpointHostName" }}
{{- $endpointIp := generate "endpointIp" }}
{{- $eventId := generate "eventId" }}
{{- $eventSubId := generate "eventSubId" }}
{{- $eventTime := generate "eventTime" }}
{{- $eventTimeDT := generate "eventTimeDT" | date "2006-01-02T15:04:05.000000+00:00" }}
{{- $hostName := generate "hostName" }}
{{- $logonUser := generate "logonUser" }}
{{- $objectCmd := generate "objectCmd" }}
{{- $objectFileHashSha1 := generate "objectFileHashSha1" }}
{{- $objectFilePath := generate "objectFilePath" }}
{{- $objectHostName := generate "objectHostName" }}
{{- $objectIntegrityLevel := generate "objectIntegrityLevel" }}
{{- $objectIp := generate "objectIp" }}
{{- $objectPort := generate "objectPort" }}
{{- $objectRegistryData := generate "objectRegistryData" }}
{{- $objectRegistryKeyHandle := generate "objectRegistryKeyHandle" }}
{{- $objectRegistryValue := generate "objectRegistryValue" }}
{{- $objectSigner := generate "objectSigner" }}
{{- $objectUser := generate "objectUser" }}
{{- $os := generate "os" }}
{{- $parentCmd := generate "parentCmd" }}
{{- $parentFileHashSha1 := generate "parentFileHashSha1" }}
{{- $parentFilePath := generate "parentFilePath" }}
{{- $processCmd := generate "processCmd" }}
{{- $processFileHashSha1 := generate "processFileHashSha1" }}
{{- $processFilePath := generate "processFilePath" }}
{{- $request := generate "request" }}
{{- $searchDL := generate "searchDL" }}
{{- $spt := generate "spt" }}
{{- $src := generate "src" }}
{{- $srcFileHashSha1 := generate "srcFileHashSha1" }}
{{- $srcFilePath := generate "srcFilePath" }}
{{- $tags := generate "tags" }}
{{- $uuid := generate "uuid" }}
{
    "@timestamp": "{{ $timestamp.Format "2006-01-02T15:04:05.999999Z07:00" }}",
    "agent": {
        "ephemeral_id": "cdaaaabb-be7e-432f-816b-bda019fd7c15",
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.18.0"
    },
    "data_stream": {
        "dataset": "trend_micro_vision_one.endpoint_activity",
        "namespace": "93724",
        "type": "logs"
    },
    "elastic_agent": {
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "snapshot": false,
        "version": "8.18.0"
    },
    "message": "{\"dpt\":{{ $dpt }},\"dst\":\"{{ $dst }}\",\"endpointGuid\":\"{{ $endpointGuid }}\",\"endpointHostName\":\"{{ $endpointHostName }}\",\"endpointIp\":[\"{{ $endpointIp }}\"],\"eventId\":\"{{ $eventId }}\",\"eventSubId\":{{ $eventSubId }},\"objectIntegrityLevel\":{{ $objectIntegrityLevel }},\"eventTime\":{{ $eventTime }},\"eventTimeDT\":\"{{ $eventTimeDT }}\",\"hostName\":\"{{ $hostName }}\",\"logonUser\":[\"{{ $logonUser }}\"],\"objectCmd\":\"{{ $objectCmd }}\",\"objectFileHashSha1\":\"{{ $objectFileHashSha1 }}\",\"objectFilePath\":\"{{ $objectFilePath }}\",\"objectHostName\":\"{{ $objectHostName }}\",\"objectIp\":\"{{ $objectIp }}\",\"objectIps\":[\"{{ $objectIp }}\"],\"objectPort\":{{ $objectPort }},\"objectRegistryData\":\"{{ $objectRegistryData }}\",\"objectRegistryKeyHandle\":\"{{ $objectRegistryKeyHandle }}\",\"objectRegistryValue\":\"{{ $objectRegistryValue }}\",\"objectSigner\":[\"{{ $objectSigner }}\"],\"objectSignerValid\":[true],\"objectUser\":\"{{ $objectUser }}\",\"os\":\"{{ $os }}\",\"parentCmd\":\"{{ $parentCmd }}\",\"parentFileHashSha1\":\"{{ $parentFileHashSha1 }}\",\"parentFilePath\":\"{{ $parentFilePath }}\",\"processCmd\":\"{{ $processCmd }}\",\"processFileHashSha1\":\"{{ $processFileHashSha1 }}\",\"processFilePath\":\"{{ $processFilePath }}\",\"request\":\"{{ $request }}\",\"searchDL\":\"{{ $searchDL }}\",\"spt\":{{ $spt }},\"src\":\"{{ $src }}\",\"srcFileHashSha1\":\"{{ $srcFileHashSha1 }}\",\"srcFilePath\":\"{{ $srcFilePath }}\",\"tags\":[\"{{ $tags }}\"],\"uuid\":\"{{ $uuid }}\"}",
    "event": {
        "dataset": "trend_micro_vision_one.endpoint_activity"
    },
    "input": {
        "type": "cel"
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "trend_micro_vision_one-endpoint_activity"
    ]
}
