rules:
  - path: /v3.0/workbench/alerts
    methods: ['GET']
    responses:
      - status_code: 200
        body: |
          {"totalCount":100,"count":10,"items":[{"schemaVersion":"1.0","id":"WB-9002-20200427-0002","investigationStatus":"New","workbenchLink":"https://THE_WORKBENCH_URL","alertProvider":"SAE","model":"Possible APT Attack","score":63,"severity":"critical","impactScope":{"desktopCount":0,"serverCount":0,"accountCount":0,"emailAddressCount":0,"entities":[{"entityType":"host","entityValue":"user@email.com","entityId":"5257b401-2fd7-469c-94fa-39a4f11eb925","relatedEntities":["CODERED\\\\user"],"relatedIndicatorIds":[1],"provenance":["Alert"]}]},"createdDateTime":"2020-04-30T00:01:15Z","updatedDateTime":"2030-04-30T00:01:16Z","description":"A backdoor was possibly implanted after a user received a possible spear phishing email message.","indicators":[{"id":1,"type":"url","field":"request url","value":"http://www.example.com/ab001.zip","relatedEntities":["user@example.com"],"provenance":["Alert"],"filterIds":["f862df72-7f5e-4b2b-9f7f-9148e875f908"]}],"matchedRules":[{"id":"5f52d1f1-53e7-411a-b74f-745ee81fa30b","name":"Possible SpearPhishing Email","matchedFilters":[{"id":"ccf86fc1-688f-4131-a46f-1d7a6ee2f88e","name":"(T1192) Spearphishing Link","matchedDateTime":"2019-08-02T04:00:01Z","mitreTechniqueIds":["T1192"],"matchedEvents":[{"uuid":"fa9ff47c-e1b8-459e-a3d0-a5b104b854a5","matchedDateTime":"2019-08-02T04:00:01Z","type":"TELEMETRY_REGISTRY"}]}]}]}],"nextLink":"https://api.xdr.trendmicro.com/v3.0/workbench/alerts?skipToken=MTA=&orderBy=score%20desc"}
  - path: /v3.0/audit/logs
    methods: ['GET']
    responses:
      - status_code: 200
        body: |
          {"items":[{"loggedDateTime":"2022-02-24T07:29:48Z","loggedUser":"Root Account","loggedRole":"Master Administrator","accessType":"Console","category":"Logon and Logoff","activity":"string","result":"Unsuccessful","details":{"property1":"string","property2":"string"}}],"nextLink":"https://api.xdr.trendmicro.com/v3.0/audit/logs?skipToken=<skipToken>","labels":{"property1":"string","property2":"string"}}
  - path: /v3.0/search/detections
    methods: ['GET']
    responses:
      - status_code: 200
        body: |
          {"nextLink":"https://api.xdr.trendmicro.com/v3.0/endpointActivities?...&skipToken=ewogICJvdXRlcl9zbGl...","progressRate":30,"items":[
            {"act":"Clean","actResult":"Quarantined successfully","app":"HTTP","appGroup":"HTTP","aptRelated":"0","behaviorCat":"Grey-Detection","blocking":"Web reputation","cat":50,"cccaDetection":"Yes","cccaDetectionSource":"GLOBAL_INTELLIGENCE","cccaRiskLevel":3,"clientFlag":"dst","cnt":"1","component":["PATTERN_VSAPI 17.101.92 2021-09-30 04:23:27-07:00"],"compressedFileSize":"0","detectionType":"File","deviceDirection":"outbound","deviceGUID":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx","deviceProcessName":"/snap/core/10126/usr/lib/snapd/snapd","deviceMacAddress":"00-00-5E-00-53-23","dhost":"samplehost","domainName":"Workgroup","dpt":53,"dst":["81.2.69.142"],"dstGroup":"Default","end":"2021-09-30T09:40:04-08:00","endpointGUID":"1234-1234-1234","endpointHostName":"abc-docker","endpointIp":["81.2.69.142"],"endpointMacAddress":"00-00-5E-00-53-23","engType":"Virus Scan Engine (OS 2003, x64)","engVer":"12.500.1004","eventId":"100117","eventName":"INTEGRITY_MONITORING_EVENT","eventSubName":"Attack Discovery","eventTime":1602724592000,"eventTimeDT":"2021-06-10T01:38:38+00:00","fileHash":"3395856ce81f2b7382dee72602f798b642f14140","fileName":["Unconfirmed 145081.crdownload"],"fileOperation":"Deleted","filePath":"/etc/systemd/system","filePathName":"/etc/systemd/system/snap-xxxx-1246.xxxx","fileSize":"0","firstAct":"Clean","firstActResult":"Unable to clean file","fullPath":"C:\\\\Users\\\\user1\\\\Downloads\\\\Unconfirmed 145081.crdownload","hostName":"samplehost","httpReferer":"http://www.example.com/","interestedHost":"abc-docker","interestedIp":["81.2.69.192"],"interestedMacAddress":"00-00-5E-00-53-23","malName":"Eicar_test_1","malType":"Virus/Malware","mDevice":["81.2.69.192"],"mDeviceGUID":"C5B09EDD-C725-907F-29D9-B8C30D18C48F","mitreMapping":["T1090 (TA0005)"],"mitreVersion":"v6","mpname":"Cloud One - Workload Security","mpver":"Deep Security/20.0.222","objectCmd":["C:\\\\Program Files (x86)\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe --profile-directory=Default"],"objectFileHashMd5":"761AEFF7E6B110970285B9C20C9E1DCA","objectFileHashSha1":"00496B4D53CEFE031B9702B3385C9F4430999932","objectFileHashSha256":"7778ED68F4646BAA38C4F36B16A1AE393ACECD694948102B5CF0773AB08237D7","objectFileName":"Unconfirmed 142899.crdownload:SmartScreen","objectFilePath":"C:\\\\Users\\\\user1\\\\Downloads\\\\Unconfirmed 142899.crdownload:SmartScreen","objectName":"CloudEndpointService.exe","objectPid":7660,"objectSigner":["OS"],"parentCmd":"C:\\\\os\\\\system32\\\\svchost.exe -k DcomLaunch -p","parentFileHashSha1":"00496B4D53CEFE031B9702B3385C9F4430999932","parentFileHashSha256":"7778ED68F4646BAA38C4F36B16A1AE393ACECD694948102B5CF0773AB08237D7","parentFilePath":"C:\\\\os\\\\System32\\\\svchost.exe","peerHost":"samplehost","peerIp":["81.2.69.192"],"pname":"Apex One","processCmd":"-ServerName:App.AppX9yct9q388jvt4h7y0gn06smzkxcsnt8m.mca","processFileHashMd5":"761AEFF7E6B110970285B9C20C9E1DCA","processFileHashSha1":"00496B4D53CEFE031B9702B3385C9F4430999932","processFileHashSha256":"7778ED68F4646BAA38C4F36B16A1AE393ACECD694948102B5CF0773AB08237D7","processFilePath":"C:\\\\Program Files (x86)\\\\os\\\\Application\\\\msedge.exe","processName":"string","processPid":0,"processSigner":"OS Publisher","productCode":"sao","pver":"20.0.0.877","request":"https://example.com","requestClientApplication":"Mozilla/5.0 (iPhone; CPU iPhone OS 12_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 Mobile/15E148 Safari/604.1","rt":"2020-10-15T01:16:32.000Z","rt_utc":"2020-10-15T01:16:32.000Z","searchDL":"DDL","spt":58871,"src":"81.2.69.192","srcGroup":"Default","tacticId":["TA0005"],"tags":["XSAE.F2140","XSAE.F3066"],"threatName":"Malicious_identified_CnC_querying_on_UDP_detected","uuid":"1234-1234-1234"},
            {"act":"Clean","actResult":"Quarantined successfully","app":"HTTP","appGroup":"HTTP","aptRelated":"0","behaviorCat":"Grey-Detection","blocking":"Web reputation","cat":50,"cccaDetection":"Yes","cccaDetectionSource":"GLOBAL_INTELLIGENCE","cccaRiskLevel":3,"clientFlag":"dst","cnt":"1","component":["PATTERN_VSAPI 17.101.92 2021-09-30 04:23:27-07:00"],"compressedFileSize":"0","detectionType":"File","deviceDirection":"outbound","deviceGUID":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx","deviceProcessName":"/snap/core/10126/usr/lib/snapd/snapd","deviceMacAddress":"00-00-5E-00-53-23","dhost":"samplehost","domainName":"Workgroup","dpt":53,"dst":["81.2.69.142"],"dstGroup":"Default","end":"2021-09-30T09:40:04-08:00","endpointGUID":"1234-1234-1234","endpointHostName":"abc-docker","endpointIp":["81.2.69.142"],"endpointMacAddress":"00-00-5E-00-53-23","engType":"Virus Scan Engine (OS 2003, x64)","engVer":"12.500.1004","eventId":"100117","eventName":"INTEGRITY_MONITORING_EVENT","eventSubName":"Attack Discovery","eventTime":1602724592000,"eventTimeDT":"2021-06-10T01:38:38+00:00","fileHash":"3395856ce81f2b7382dee72602f798b642f14140","fileName":["Unconfirmed 145081.crdownload"],"fileOperation":"Deleted","filePath":"/etc/systemd/system","filePathName":"/etc/systemd/system/snap-xxxx-1246.xxxx","fileSize":"0","firstAct":"Clean","firstActResult":"Unable to clean file","fullPath":"C:\\\\Users\\\\user1\\\\Downloads\\\\Unconfirmed 145081.crdownload","hostName":"samplehost","httpReferer":"http://www.example.com/","interestedHost":"abc-docker","interestedIp":["81.2.69.192"],"interestedMacAddress":"00-00-5E-00-53-23","malName":"Eicar_test_1","malType":"Virus/Malware","mDevice":["81.2.69.192"],"mDeviceGUID":"C5B09EDD-C725-907F-29D9-B8C30D18C48F","mitreMapping":["T1090 (TA0005)"],"mitreVersion":"v6","mpname":"Cloud One - Workload Security","mpver":"Deep Security/20.0.222","objectCmd":["C:\\\\Program Files (x86)\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe --profile-directory=Default"],"objectFileHashMd5":"761AEFF7E6B110970285B9C20C9E1DCA","objectFileHashSha1":"00496B4D53CEFE031B9702B3385C9F4430999932","objectFileHashSha256":"7778ED68F4646BAA38C4F36B16A1AE393ACECD694948102B5CF0773AB08237D7","objectFileName":"Unconfirmed 142899.crdownload:SmartScreen","objectFilePath":"C:\\\\Users\\\\user1\\\\Downloads\\\\Unconfirmed 142899.crdownload:SmartScreen","objectName":"CloudEndpointService.exe","objectPid":7660,"objectSigner":["OS"],"parentCmd":"C:\\\\os\\\\system32\\\\svchost.exe -k DcomLaunch -p","parentFileHashSha1":"00496B4D53CEFE031B9702B3385C9F4430999932","parentFileHashSha256":"7778ED68F4646BAA38C4F36B16A1AE393ACECD694948102B5CF0773AB08237D7","parentFilePath":"C:\\\\os\\\\System32\\\\svchost.exe","peerHost":"samplehost","peerIp":["81.2.69.192"],"pname":"Apex One","processCmd":"-ServerName:App.AppX9yct9q388jvt4h7y0gn06smzkxcsnt8m.mca","processFileHashMd5":"761AEFF7E6B110970285B9C20C9E1DCA","processFileHashSha1":"00496B4D53CEFE031B9702B3385C9F4430999932","processFileHashSha256":"7778ED68F4646BAA38C4F36B16A1AE393ACECD694948102B5CF0773AB08237D7","processFilePath":"C:\\\\Program Files (x86)\\\\os\\\\Application\\\\msedge.exe","processName":"string","processPid":0,"processSigner":"OS Publisher","productCode":"sao","pver":"20.0.0.877","requests":["https://ex-ample.com","https://ex-maple.ca"],"requestClientApplication":"Mozilla/5.0 (iPhone; CPU iPhone OS 12_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 Mobile/15E148 Safari/604.1","rt":"2020-10-15T01:16:32.000Z","rt_utc":"2020-10-15T01:16:32.000Z","searchDL":"DDL","spt":58871,"src":"81.2.69.192","srcGroup":"Default","tacticId":["TA0005"],"tags":["XSAE.F2140","XSAE.F3066"],"threatName":"Malicious_identified_CnC_querying_on_UDP_detected","uuid":"1234-1234-1234"}
          ]}
