- name: trend_micro_vision_one
  type: group
  fields:
    - name: network_activity
      type: group
      fields:
        - name: act
          type: long
          description: Action taken for the violation.
        - name: application
          type: keyword
          description: Name of the requested application.
        - name: client
          type: group
          fields:
            - name: ip
              type: ip
              description: Internal IP address of source endpoint.
        - name: company_name
          type: keyword
          description: Company name.
        - name: customer
          type: group
          fields:
            - name: id
              type: keyword
              description: Company ID.
        - name: destination
          type: group
          fields:
            - name: ip
              type: ip
              description: Destination IP address.
            - name: port
              type: long
              description: Destination port of private application server.
        - name: detection
          type: group
          fields:
            - name: type
              type: long
              description: Scan type.
        - name: device
          type: group
          fields:
            - name: guid
              type: keyword
              description: GUID of the agent which reported this detection.
        - name: duration
          type: long
          description: Scan complete time, in milliseconds.
        - name: endpoint
          type: group
          fields:
            - name: guid
              type: keyword
              description: GUID of the agent which reported the detection.
            - name: host_name
              type: keyword
              description: Endpoint hostname.
        - name: event
          type: group
          fields:
            - name: name
              type: keyword
              description: Event type name.
            - name: sub_name
              type: keyword
              description: Event type subname.
            - name: time
              type: date
              description: Event generation time on the agent side.
        - name: file
          type: group
          fields:
            - name: hash_sha1
              type: keyword
              description: The SHA-1 of the file which violated the policy.
            - name: hash_sha256
              type: keyword
              description: The SHA-256 of the file which violated the policy.
            - name: mime_type
              type: keyword
              description: The MIME type/content type of the response body.
            - name: name
              type: keyword
              description: File name of the file which violated the policy.
            - name: size
              type: long
              description: Size of the file which violated the policy.
            - name: type
              type: keyword
              description: File type of the file which violated the policy.
        - name: malware
          type: group
          fields:
            - name: name
              type: keyword
              description: Name of the malware detected.
        - name: object
          type: group
          fields:
            - name: id
              type: keyword
              description: UUID of private access application.
        - name: os
          type: group
          fields:
            - name: name
              type: keyword
              description: Endpoint device operating system.
        - name: pname
          type: keyword
          description: Internal product ID (Deprecated use productCode).
        - name: policy
          type: group
          fields:
            - name: uuid
              type: keyword
              description: UUID of the triggered Private Access or Risk Control rule.
        - name: profile
          type: keyword
          description: Name of the Threat Protection template or Data Loss Prevention profile triggered.
        - name: pver
          type: keyword
          description: Product version.
        - name: request
          type: group
          fields:
            - name: base
              type: keyword
              description: Domain of the requested URL.
            - name: method
              type: keyword
              description: HTTP/HTTPS request method.
            - name: mime_type
              type: keyword
              description: Requested content type.
            - name: url
              type: keyword
              description: The requested destination URL the user is accessing.
        - name: rt
          type: long
          description: Report received time.
        - name: rule
          type: group
          fields:
            - name: name
              type: keyword
              description: Name of the rule that triggered the event.
            - name: type
              type: keyword
              description: Type of rule which triggered.
            - name: uuid
              type: keyword
              description: UUID of the triggered rule.
        - name: score
          type: long
          description: Web Reputation Services URL rating.
        - name: sender
          type: keyword
          description: Roaming users or gateway where the web traffic passed.
        - name: server
          type: group
          fields:
            - name: protocol
              type: keyword
              description: HTTP protocol version of destination server.
            - name: tls
              type: keyword
              description: Server TLS/SSL version.
        - name: source
          type: group
          fields:
            - name: ip
              type: ip
              description: Source IP address that is connecting to the Internet Access gateway.
            - name: port
              type: long
              description: Source virtual port assigned to endpoint Secure Access Module.
        - name: start
          type: long
          description: Secure Access Module session start time.
        - name: tenant
          type: group
          fields:
            - name: guid
              type: keyword
              description: Tenant GUID of the Internet Access Gateway.
        - name: user
          type: group
          fields:
            - name: department
              type: keyword
              description: User department.
            - name: domain
              type: keyword
              description: Domain of the username.
            - name: id
              type: keyword
              description: User name or IP address.
            - name: principal_name
              type: keyword
              description: User principal name used to log on to Trend Micro Web Security admin portal.
        - name: user_agent
          type: keyword
          description: Name of the web browser app user connects from.
