{
    "attributes": {
        "controlGroupInput": {
            "chainingSystem": "HIERARCHICAL",
            "controlStyle": "oneLine",
            "ignoreParentSettingsJSON": {
                "ignoreFilters": false,
                "ignoreQuery": false,
                "ignoreTimerange": false,
                "ignoreValidations": false
            },
            "panelsJSON": {
                "7a89389e-fbce-4995-91fe-5008f45ed779": {
                    "explicitInput": {
                        "dataViewId": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                        "exclude": false,
                        "existsSelected": false,
                        "fieldName": "deployment_id",
                        "searchTechnique": "prefix",
                        "selectedOptions": [],
                        "sort": {
                            "by": "_count",
                            "direction": "desc"
                        },
                        "title": "Deployment ID"
                    },
                    "grow": false,
                    "order": 0,
                    "type": "optionsListControl",
                    "width": "large"
                }
            },
            "showApplySelections": false
        },
        "description": "Provides visual insights into cluster-level cost and usage metrics, helping track Elastic consumption across tiers, deployments, and data streams. Built from transformed billing and usage data, this dashboard enables transparent chargeback calculations and trend analysis.",
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": {
                "filter": [],
                "query": {
                    "language": "kuery",
                    "query": ""
                }
            }
        },
        "optionsJSON": {
            "hidePanelTitles": false,
            "syncColors": false,
            "syncCursor": true,
            "syncTooltips": false,
            "useMargins": true
        },
        "panelsJSON": [
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "# Data tier and data stream overview",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 3,
                    "i": "4ef16514-210f-4d21-a07c-ec5bd72e9181",
                    "w": 48,
                    "x": 0,
                    "y": 2
                },
                "panelIndex": "4ef16514-210f-4d21-a07c-ec5bd72e9181",
                "title": "",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Indexing",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 3,
                    "i": "e1ad64c9-cb51-4108-8bf6-6ac575f3b291",
                    "w": 12,
                    "x": 0,
                    "y": 15
                },
                "panelIndex": "e1ad64c9-cb51-4108-8bf6-6ac575f3b291",
                "title": "",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Querying",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 3,
                    "i": "e33085b2-69de-4ab7-b7ec-29eaabc9c9e9",
                    "w": 12,
                    "x": 12,
                    "y": 15
                },
                "panelIndex": "e33085b2-69de-4ab7-b7ec-29eaabc9c9e9",
                "title": "",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Storage",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 3,
                    "i": "47260515-6d55-4658-859b-580a83f567b3",
                    "w": 12,
                    "x": 24,
                    "y": 15
                },
                "panelIndex": "47260515-6d55-4658-859b-580a83f567b3",
                "title": "",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Blended",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 3,
                    "i": "11d6918c-678c-408b-a709-966dda0bd4b3",
                    "w": 12,
                    "x": 36,
                    "y": 15
                },
                "panelIndex": "11d6918c-678c-408b-a709-966dda0bd4b3",
                "title": "",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "# Data tier and data stream per day",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 3,
                    "i": "ea0cde1e-e30f-4245-9d3e-ab36c71b874b",
                    "w": 48,
                    "x": 0,
                    "y": 48
                },
                "panelIndex": "ea0cde1e-e30f-4245-9d3e-ab36c71b874b",
                "title": "",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "b1264a89-c168-4c4a-9eb0-50b641ebbe2e": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_querying",
                                                    "customLabel": true,
                                                    "fieldName": "agg_querying",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    querying = CASE (\n        deployment_sum_query_time \u003e 0,\n        datastream_sum_query_time / deployment_sum_query_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying) \n    BY \n        @timestamp, \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    querying = CASE (\n        deployment_sum_query_time \u003e 0,\n        datastream_sum_query_time / deployment_sum_query_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying) \n    BY \n        @timestamp, \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_querying"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "b1264a89-c168-4c4a-9eb0-50b641ebbe2e",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_querying over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    querying = CASE (\n        deployment_sum_query_time \u003e 0,\n        datastream_sum_query_time / deployment_sum_query_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying) \n    BY \n        @timestamp, \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "3b250135-89a4-4b3b-9062-0404ddae4998",
                    "w": 16,
                    "x": 0,
                    "y": 71
                },
                "panelIndex": "3b250135-89a4-4b3b-9062-0404ddae4998",
                "title": "Querying: Normalised cost per data stream per day",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "cbf4762c-990a-4304-bafb-c90223a60e71": {
                                            "columns": [
                                                {
                                                    "columnId": "Indexing",
                                                    "customLabel": true,
                                                    "fieldName": "agg_indexing",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "tier",
                                                    "customLabel": false,
                                                    "fieldName": "tier",
                                                    "label": "tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    indexing = CASE (\n        deployment_sum_indexing_time \u003e 0,\n        tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    Indexing = sum(indexing)\n    BY \n        @timestamp,\n        tier\n| WHERE Indexing \u003e 0"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    indexing = CASE (\n        deployment_sum_indexing_time \u003e 0,\n        tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    Indexing = sum(indexing)\n    BY \n        @timestamp,\n        tier\n| WHERE Indexing \u003e 0"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_indexing"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "cbf4762c-990a-4304-bafb-c90223a60e71",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "tier",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_indexing over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    indexing = CASE (\n        deployment_sum_indexing_time \u003e 0,\n        tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    Indexing = sum(indexing)\n    BY \n        @timestamp,\n        tier\n| WHERE Indexing \u003e 0"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "33cb2b13-1ed8-4eb3-9d95-016dae837c97",
                    "w": 16,
                    "x": 16,
                    "y": 54
                },
                "panelIndex": "33cb2b13-1ed8-4eb3-9d95-016dae837c97",
                "title": "Indexing: Normalised cost per tier per day",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "0075fd45-aa9d-4db7-ace5-da6ab2804584": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_indexing",
                                                    "customLabel": true,
                                                    "fieldName": "agg_indexing",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    indexing = CASE (\n        deployment_sum_indexing_time \u003e 0,\n        datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp,\n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    indexing = CASE (\n        deployment_sum_indexing_time \u003e 0,\n        datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp,\n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "Indexing"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "0075fd45-aa9d-4db7-ace5-da6ab2804584",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_indexing over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    indexing = CASE (\n        deployment_sum_indexing_time \u003e 0,\n        datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    Indexing = sum(indexing)\n    BY \n        @timestamp,\n        datastream\n| WHERE Indexing \u003e 0\n| SORT Indexing DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "8113fa3f-c38e-4b70-9caf-506e4563e0d5",
                    "w": 16,
                    "x": 32,
                    "y": 54
                },
                "panelIndex": "8113fa3f-c38e-4b70-9caf-506e4563e0d5",
                "title": "Indexing: % Normalised cost per data stream per day",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "ab054c6b-f482-4a59-bcf6-9105d0baaa98": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_querying",
                                                    "customLabel": true,
                                                    "fieldName": "agg_querying",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "tier",
                                                    "customLabel": false,
                                                    "fieldName": "tier",
                                                    "label": "tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    querying = CASE (\n        deployment_sum_query_time \u003e 0,\n        tier_sum_query_time / deployment_sum_query_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_querying \u003e 0"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    querying = CASE (\n        deployment_sum_query_time \u003e 0,\n        tier_sum_query_time / deployment_sum_query_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_querying \u003e 0"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_querying"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "ab054c6b-f482-4a59-bcf6-9105d0baaa98",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "tier",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_querying over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    querying = CASE (\n        deployment_sum_query_time \u003e 0,\n        tier_sum_query_time / deployment_sum_query_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_querying \u003e 0"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "5472303e-a606-45a0-87eb-a494b1f595a0",
                    "w": 16,
                    "x": 16,
                    "y": 71
                },
                "panelIndex": "5472303e-a606-45a0-87eb-a494b1f595a0",
                "title": "Querying: Noralised cost per tier per day",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "8589daba-0384-45fc-9136-6db7be8e6a43": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_blended",
                                                    "customLabel": true,
                                                    "fieldName": "agg_blended",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store),\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight)) / total_weight_hot,\n        ((storage * conf_storage_weight) + (querying * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        datastream,\n        tier\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store),\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight)) / total_weight_hot,\n        ((storage * conf_storage_weight) + (querying * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        datastream,\n        tier\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "8589daba-0384-45fc-9136-6db7be8e6a43",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "metrics": [
                                            "agg_blended"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "datastream"
                                        ]
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store),\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight)) / total_weight_hot,\n        ((storage * conf_storage_weight) + (querying * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        datastream,\n        tier\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 15,
                    "i": "2e2c3a82-75c7-4dfc-9fb6-09e5f1e0594c",
                    "w": 12,
                    "x": 36,
                    "y": 18
                },
                "panelIndex": "2e2c3a82-75c7-4dfc-9fb6-09e5f1e0594c",
                "title": "Blended: Normalised cost totals by data stream",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "0fc4147b-445d-4adb-ac31-e0709a0cada8": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_indexing",
                                                    "customLabel": true,
                                                    "fieldName": "agg_indexing",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                                            }
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "0fc4147b-445d-4adb-ac31-e0709a0cada8",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "metrics": [
                                            "agg_indexing"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "datastream"
                                        ]
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 15,
                    "i": "d7ffa351-7eb5-45e5-861e-1ed5a44ac39e",
                    "w": 12,
                    "x": 0,
                    "y": 18
                },
                "panelIndex": "d7ffa351-7eb5-45e5-861e-1ed5a44ac39e",
                "title": "Indexing: Normalised cost totals by data stream",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "f2668878-3a88-4590-9c3d-edb30b0ac7e0": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_querying",
                                                    "customLabel": true,
                                                    "fieldName": "agg_querying",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying)\n    BY \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                                            }
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying)\n    BY \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "f2668878-3a88-4590-9c3d-edb30b0ac7e0",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "metrics": [
                                            "agg_querying"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "datastream"
                                        ]
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying)\n    BY \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 15,
                    "i": "8d446af6-059b-4eb3-a31a-017b25506c62",
                    "w": 12,
                    "x": 12,
                    "y": 18
                },
                "panelIndex": "8d446af6-059b-4eb3-a31a-017b25506c62",
                "title": "Querying: Normalised cost totals by data stream",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "5ebd6571-c76e-45b3-b5a7-92baa2968144": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_storage",
                                                    "customLabel": true,
                                                    "fieldName": "agg_storage",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "5ebd6571-c76e-45b3-b5a7-92baa2968144",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "metrics": [
                                            "agg_storage"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "datastream"
                                        ]
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 15,
                    "i": "53993ab2-a932-4147-9d2b-a45e4a9af889",
                    "w": 12,
                    "x": 24,
                    "y": 18
                },
                "panelIndex": "53993ab2-a932-4147-9d2b-a45e4a9af889",
                "title": "Storage: Normalised cost totals by data stream",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "17e6c1e2-bbd6-48c8-b48a-e07aea3dee88": {
                                            "columns": [
                                                {
                                                    "columnId": "ecu_indexing",
                                                    "customLabel": false,
                                                    "fieldName": "ecu_indexing",
                                                    "inMetricDimension": true,
                                                    "label": "ecu_indexing",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "ecu_querying",
                                                    "customLabel": false,
                                                    "fieldName": "ecu_querying",
                                                    "inMetricDimension": true,
                                                    "label": "ecu_querying",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "ecu_storage",
                                                    "customLabel": false,
                                                    "fieldName": "ecu_storage",
                                                    "inMetricDimension": true,
                                                    "label": "ecu_storage",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "ecu_blended",
                                                    "customLabel": false,
                                                    "fieldName": "ecu_blended",
                                                    "inMetricDimension": true,
                                                    "label": "ecu_blended",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "inMetricDimension": true,
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "91e55199-fd23-4ecc-8c42-e9fb02829b28",
                                                    "fieldName": "tier",
                                                    "label": "tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "sourceParams": {
                                                            "indexPattern": "billing_cluster_cost_lookup"
                                                        },
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_tier_and_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE(deployment_sum_indexing_time \u003e 0, tier_and_datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE(deployment_sum_query_time \u003e 0, tier_and_datastream_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE(deployment_sum_data_set_store_size \u003e 0, tier_and_datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE(deployment_sum_store_size \u003e 0, tier_and_datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE(store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE(\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    ecu_indexing = sum(indexing),\n    ecu_querying = sum(querying),\n    ecu_storage = sum(storage),\n    ecu_blended = sum(blended)\n    BY datastream, tier\n| SORT ecu_blended DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_tier_and_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE(deployment_sum_indexing_time \u003e 0, tier_and_datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE(deployment_sum_query_time \u003e 0, tier_and_datastream_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE(deployment_sum_data_set_store_size \u003e 0, tier_and_datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE(deployment_sum_store_size \u003e 0, tier_and_datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE(store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE(\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    ecu_indexing = sum(indexing),\n    ecu_querying = sum(querying),\n    ecu_storage = sum(storage),\n    ecu_blended = sum(blended)\n    BY datastream, tier\n| SORT ecu_blended DESC"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "ecu_indexing"
                                    },
                                    {
                                        "columnId": "ecu_querying"
                                    },
                                    {
                                        "columnId": "ecu_storage"
                                    },
                                    {
                                        "columnId": "ecu_blended"
                                    },
                                    {
                                        "columnId": "datastream"
                                    },
                                    {
                                        "columnId": "91e55199-fd23-4ecc-8c42-e9fb02829b28",
                                        "isMetric": true,
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "17e6c1e2-bbd6-48c8-b48a-e07aea3dee88",
                                "layerType": "data"
                            }
                        },
                        "title": "ecu_indexing \u0026 ecu_querying \u0026 ecu_storage \u0026 ecu_blended of datastream",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_tier_and_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE(deployment_sum_indexing_time \u003e 0, tier_and_datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE(deployment_sum_query_time \u003e 0, tier_and_datastream_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE(deployment_sum_data_set_store_size \u003e 0, tier_and_datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE(deployment_sum_store_size \u003e 0, tier_and_datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE(store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE(\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    ecu_indexing = sum(indexing),\n    ecu_querying = sum(querying),\n    ecu_storage = sum(storage),\n    ecu_blended = sum(blended)\n    BY datastream, tier\n| SORT ecu_blended DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 15,
                    "i": "113bbf0b-522c-49e0-bfda-a5a0c58eba89",
                    "w": 48,
                    "x": 0,
                    "y": 33
                },
                "panelIndex": "113bbf0b-522c-49e0-bfda-a5a0c58eba89",
                "title": "Normalised cost per data stream per tier",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "4e6c98f0-e509-41fa-8b40-b2c827478739": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_blended",
                                                    "customLabel": true,
                                                    "fieldName": "agg_blended",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised blended cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store),\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    blended = ((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight)) / total_weight_hot * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        datastream\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store),\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    blended = ((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight)) / total_weight_hot * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        datastream\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_blended"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "4e6c98f0-e509-41fa-8b40-b2c827478739",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_blended over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store),\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    blended = ((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight)) / total_weight_hot * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        datastream\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "d4781531-b2d9-4748-a2f8-aa73ba419b79",
                    "w": 16,
                    "x": 0,
                    "y": 106
                },
                "panelIndex": "d4781531-b2d9-4748-a2f8-aa73ba419b79",
                "title": "Blended value: Normalised cost per data stream per day",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "f4e98c2b-6e27-47f4-bb2b-793a89bd51e1": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_storage",
                                                    "customLabel": true,
                                                    "fieldName": "agg_storage",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_storage"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "f4e98c2b-6e27-47f4-bb2b-793a89bd51e1",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_storage over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 15,
                    "i": "5f36343a-f4e9-4595-a16f-cf791fc73b6a",
                    "w": 16,
                    "x": 0,
                    "y": 88
                },
                "panelIndex": "5f36343a-f4e9-4595-a16f-cf791fc73b6a",
                "title": "Storage: Nomalised cost per data stream per day",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "4bb200b0-61b6-4dad-aa11-66e5b308252e": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_querying",
                                                    "customLabel": true,
                                                    "fieldName": "agg_querying",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate\n| STATS \n    agg_querying = sum(querying)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate\n| STATS \n    agg_querying = sum(querying)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_querying"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "4bb200b0-61b6-4dad-aa11-66e5b308252e",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_querying over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate\n| STATS \n    agg_querying = sum(querying)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "8657457b-9a0c-4f0a-9d5c-8886841c5d27",
                    "w": 16,
                    "x": 32,
                    "y": 71
                },
                "panelIndex": "8657457b-9a0c-4f0a-9d5c-8886841c5d27",
                "title": "Querying: % Normalised cost per data stream per day",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "2980520c-4654-45c2-919d-e37519dcea28": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_storage",
                                                    "customLabel": true,
                                                    "fieldName": "agg_storage",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_storage"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "2980520c-4654-45c2-919d-e37519dcea28",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_storage over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 15,
                    "i": "0dbbda20-29b0-4b8f-89b5-bb19083f5260",
                    "w": 16,
                    "x": 32,
                    "y": 88
                },
                "panelIndex": "0dbbda20-29b0-4b8f-89b5-bb19083f5260",
                "title": "Storage: % Normalised cost per data stream per day",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "5f582f9a-7282-4ecd-8159-3d0427a2c8de": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_blended",
                                                    "customLabel": true,
                                                    "fieldName": "agg_blended",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised blended cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        datastream,\n        tier\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        datastream,\n        tier\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_blended"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "5f582f9a-7282-4ecd-8159-3d0427a2c8de",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "Pie",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        datastream,\n        tier\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "fca39c87-b3fd-4786-ab6c-99b00cfbcf30",
                    "w": 16,
                    "x": 32,
                    "y": 106
                },
                "panelIndex": "fca39c87-b3fd-4786-ab6c-99b00cfbcf30",
                "title": "Blended value: % Normalised cost per data stream per day",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "5b92f01a-c208-4537-bc68-d502592bd1c9": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_blended",
                                                    "customLabel": true,
                                                    "fieldName": "agg_blended",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised blended cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "tier",
                                                    "customLabel": false,
                                                    "fieldName": "tier",
                                                    "label": "tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        tier\n| WHERE agg_blended \u003e 0"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        tier\n| WHERE agg_blended \u003e 0"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_blended"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "5b92f01a-c208-4537-bc68-d502592bd1c9",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "tier",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_blended over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        tier\n| WHERE agg_blended \u003e 0"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "40f1766c-5494-4599-8f78-01da6cb81992",
                    "w": 16,
                    "x": 16,
                    "y": 106
                },
                "panelIndex": "40f1766c-5494-4599-8f78-01da6cb81992",
                "title": "Blended value: Normalised cost per tier per day",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "72984ac5-ecc1-4125-9f80-ff1c478d0589": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_indexing",
                                                    "customLabel": true,
                                                    "fieldName": "agg_indexing",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_indexing"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "72984ac5-ecc1-4125-9f80-ff1c478d0589",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_indexing over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    indexing = CASE (deployment_sum_indexing_time \u003e 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "d46916d2-99bf-49fa-a7d0-1284ade150b7",
                    "w": 16,
                    "x": 0,
                    "y": 54
                },
                "panelIndex": "d46916d2-99bf-49fa-a7d0-1284ade150b7",
                "title": "Indexing: Normalised per data stream per day",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "a2148ccd-cbc4-4a43-bacd-c194083ff789": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_storage",
                                                    "customLabel": true,
                                                    "fieldName": "agg_storage",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "tier",
                                                    "customLabel": false,
                                                    "fieldName": "tier",
                                                    "label": "tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_storage \u003e 0"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_storage \u003e 0"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_storage"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "a2148ccd-cbc4-4a43-bacd-c194083ff789",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "tier",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_storage over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_storage \u003e 0"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 15,
                    "i": "33bf2915-ddf8-4017-b835-1607002ccf1d",
                    "w": 16,
                    "x": 16,
                    "y": 88
                },
                "panelIndex": "33bf2915-ddf8-4017-b835-1607002ccf1d",
                "title": "Storage: Normalised cost per tier per day",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Indexing details",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 3,
                    "i": "5007544b-2d1d-42df-a28f-e75515d93cfe",
                    "w": 48,
                    "x": 0,
                    "y": 51
                },
                "panelIndex": "5007544b-2d1d-42df-a28f-e75515d93cfe",
                "title": "",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Querying details",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 3,
                    "i": "98a2cde6-bfbc-4dcb-a802-e1bafe94b634",
                    "w": 48,
                    "x": 0,
                    "y": 68
                },
                "panelIndex": "98a2cde6-bfbc-4dcb-a802-e1bafe94b634",
                "title": "",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Storage details",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 3,
                    "i": "0aa60583-0c33-4bbe-8881-4772c751be20",
                    "w": 48,
                    "x": 0,
                    "y": 85
                },
                "panelIndex": "0aa60583-0c33-4bbe-8881-4772c751be20",
                "title": "",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Blended details",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 3,
                    "i": "1b7924fc-0c60-421b-a94f-5c32e96a77e9",
                    "w": 48,
                    "x": 0,
                    "y": 103
                },
                "panelIndex": "1b7924fc-0c60-421b-a94f-5c32e96a77e9",
                "title": "",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "028914d5-5b34-4db1-b06e-ee4d5c6feb1b": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_indexing",
                                                    "customLabel": false,
                                                    "fieldName": "agg_indexing",
                                                    "inMetricDimension": true,
                                                    "label": "agg_indexing",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "agg_querying",
                                                    "customLabel": false,
                                                    "fieldName": "agg_querying",
                                                    "inMetricDimension": true,
                                                    "label": "agg_querying",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "agg_storage",
                                                    "customLabel": false,
                                                    "fieldName": "agg_storage",
                                                    "inMetricDimension": true,
                                                    "label": "agg_storage",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "agg_blended",
                                                    "customLabel": false,
                                                    "fieldName": "agg_blended",
                                                    "inMetricDimension": true,
                                                    "label": "agg_blended",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "tier",
                                                    "customLabel": false,
                                                    "fieldName": "tier",
                                                    "inMetricDimension": true,
                                                    "label": "tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| EVAL config_join_key = \"chargeback_config\"\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_indexing = sum(indexing),\n    agg_querying = sum(querying),\n    agg_storage = sum(storage),\n    agg_blended = sum(blended)\n    BY\n        tier\n| WHERE agg_blended \u003e 0"
                                            }
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| EVAL config_join_key = \"chargeback_config\"\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_indexing = sum(indexing),\n    agg_querying = sum(querying),\n    agg_storage = sum(storage),\n    agg_blended = sum(blended)\n    BY\n        tier\n| WHERE agg_blended \u003e 0"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "agg_indexing"
                                    },
                                    {
                                        "columnId": "agg_querying"
                                    },
                                    {
                                        "columnId": "agg_storage"
                                    },
                                    {
                                        "columnId": "agg_blended"
                                    },
                                    {
                                        "columnId": "tier"
                                    }
                                ],
                                "layerId": "028914d5-5b34-4db1-b06e-ee4d5c6feb1b",
                                "layerType": "data"
                            }
                        },
                        "title": "agg_indexing \u0026 agg_querying \u0026 agg_storage \u0026 agg_blended of tier",
                        "visualizationType": "lnsDatatable"
                    },
                    "description": "Normalised cost breakdown per tier, based on Indexing, Querying, Storage and a blended ratio of all of these.",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| grok sku \"%{WORD}.es.%{WORD:es_node_type}\"\n| GROK sku \"%{WORD}.%{WORD:non_es_node_type}\"\n| eval cost_type = CASE(\n    es_node_type is not null, es_node_type,\n    non_es_node_type  \n)\n| eval cost_type = CASE(\n    cost_type == \"data\", \"data-transfer\",\n    cost_type == \"datahot\", \"datahot/datacontent\",\n    cost_type\n)\n| DROP es_node_type, non_es_node_type\n| EVAL config_join_key = \"chargeback_config\"\n| where cost_type IN (\"datahot/datacontent\", \"datawarm\", \"datacold\", \"datafrozen\")\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_indexing = sum(indexing),\n    agg_querying = sum(querying),\n    agg_storage = sum(storage),\n    agg_blended = sum(blended)\n    BY\n        tier\n| WHERE agg_blended \u003e 0"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 10,
                    "i": "0cba2249-3ce4-4fdf-be19-e590029f15e5",
                    "w": 48,
                    "x": 0,
                    "y": 5
                },
                "panelIndex": "0cba2249-3ce4-4fdf-be19-e590029f15e5",
                "title": "Normalised cost per tier",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "layout": "horizontal",
                        "links": [
                            {
                                "destinationRefName": "link_c8c565f3-89f9-483a-b120-2c84ea6d0043_dashboard",
                                "id": "c8c565f3-89f9-483a-b120-2c84ea6d0043",
                                "order": 0,
                                "type": "dashboardLink"
                            },
                            {
                                "destinationRefName": "link_4e3d9521-0167-4508-ac8f-445a37260b9c_dashboard",
                                "id": "4e3d9521-0167-4508-ac8f-445a37260b9c",
                                "order": 1,
                                "type": "dashboardLink"
                            }
                        ]
                    },
                    "enhancements": {}
                },
                "gridData": {
                    "h": 2,
                    "i": "3d15a159-4fb1-4527-afc4-a26e4713ffd3",
                    "w": 48,
                    "x": 0,
                    "y": 0
                },
                "panelIndex": "3d15a159-4fb1-4527-afc4-a26e4713ffd3",
                "type": "links"
            }
        ],
        "timeRestore": false,
        "title": "[Chargeback] Cost and Consumption - data tiers",
        "version": 3
    },
    "coreMigrationVersion": "8.8.0",
    "created_at": "2025-08-22T07:56:30.077Z",
    "created_by": "u_mGBROF_q5bmFCATbLXAcCwKa0k8JvONAwSruelyKA5E_0",
    "id": "chargeback-83310c33-f1b8-4025-994e-e69e3c228f08",
    "references": [
        {
            "id": "chargeback-50b05ec2-9115-4102-b98f-8ea4943a96ac",
            "name": "3d15a159-4fb1-4527-afc4-a26e4713ffd3:link_c8c565f3-89f9-483a-b120-2c84ea6d0043_dashboard",
            "type": "dashboard"
        },
        {
            "id": "chargeback-83310c33-f1b8-4025-994e-e69e3c228f08",
            "name": "3d15a159-4fb1-4527-afc4-a26e4713ffd3:link_4e3d9521-0167-4508-ac8f-445a37260b9c_dashboard",
            "type": "dashboard"
        },
        {
            "id": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
            "name": "controlGroup_7a89389e-fbce-4995-91fe-5008f45ed779:optionsListDataView",
            "type": "index-pattern"
        }
    ],
    "type": "dashboard",
    "typeMigrationVersion": "10.2.0",
    "updated_by": "u_mGBROF_q5bmFCATbLXAcCwKa0k8JvONAwSruelyKA5E_0"
}