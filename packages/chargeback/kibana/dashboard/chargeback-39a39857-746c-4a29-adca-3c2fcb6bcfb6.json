{
    "attributes": {
        "controlGroupInput": {
            "chainingSystem": "HIERARCHICAL",
            "controlStyle": "oneLine",
            "ignoreParentSettingsJSON": {
                "ignoreFilters": false,
                "ignoreQuery": false,
                "ignoreTimerange": false,
                "ignoreValidations": false
            },
            "panelsJSON": {
                "ab7831d2-e2cb-4ece-a4a6-b22c17f30aec": {
                    "explicitInput": {
                        "dataViewId": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                        "exclude": false,
                        "existsSelected": false,
                        "fieldName": "deployment_id",
                        "searchTechnique": "prefix",
                        "selectedOptions": [],
                        "sort": {
                            "by": "_count",
                            "direction": "desc"
                        },
                        "title": "Deployment ID"
                    },
                    "grow": false,
                    "order": 0,
                    "type": "optionsListControl",
                    "width": "large"
                }
            },
            "showApplySelections": false
        },
        "description": "Provides visual insights into cluster-level cost and usage metrics, helping track Elastic consumption across tiers, deployments, and data streams. Built from transformed billing and usage data, this dashboard enables transparent chargeback calculations and trend analysis.",
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": {
                "filter": [],
                "query": {
                    "language": "kuery",
                    "query": ""
                }
            }
        },
        "optionsJSON": {
            "hidePanelTitles": false,
            "syncColors": false,
            "syncCursor": true,
            "syncTooltips": false,
            "useMargins": true
        },
        "panelsJSON": [
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                    "name": "billing_cluster_cost_lookup",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "billing_cluster_cost_lookup",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "timeField": "@timestamp",
                                            "title": "billing_cluster_cost_lookup"
                                        }
                                    ],
                                    "layers": {
                                        "c2dbde04-0769-4485-b4fa-4cb05a1d975e": {
                                            "columns": [
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": true,
                                                    "fieldName": "@timestamp",
                                                    "label": "Date",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "deployment",
                                                    "customLabel": true,
                                                    "fieldName": "deployment",
                                                    "label": "Deployment",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "total_ecu_value",
                                                    "customLabel": true,
                                                    "fieldName": "total_ecu_value",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL total_ecu_value = total_ecu * conf_ecu_rate, deployment = CONCAT(deployment_name, \" (\", LEFT(deployment_id, 6), \")\")\n| KEEP @timestamp, deployment, total_ecu_value | SORT @timestamp desc | LIMIT 5000"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL total_ecu_value = total_ecu * conf_ecu_rate, deployment = CONCAT(deployment_name, \" (\", LEFT(deployment_id, 6), \")\")\n| KEEP @timestamp, deployment, total_ecu_value | SORT @timestamp desc | LIMIT 5000"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "total_ecu_value"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "c2dbde04-0769-4485-b4fa-4cb05a1d975e",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "deployment",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "Normalised cost over time",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL total_ecu_value = total_ecu * conf_ecu_rate, deployment = CONCAT(deployment_name, \" (\", LEFT(deployment_id, 6), \")\")\n| KEEP @timestamp, deployment, total_ecu_value | SORT @timestamp desc | LIMIT 5000"
                    },
                    "searchSessionId": "48b157e3-14ff-4c71-8178-4a69f0592d85",
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "timeRange": {
                        "from": "now-6M",
                        "to": "now"
                    },
                    "title": "Normalised cost over the last 6 months"
                },
                "gridData": {
                    "h": 9,
                    "i": "d9069c7e-bfaf-4045-aedf-ca1042c21010",
                    "w": 34,
                    "x": 0,
                    "y": 0
                },
                "panelIndex": "d9069c7e-bfaf-4045-aedf-ca1042c21010",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "id": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "In this dashboard, normalised cost is the ECU (Elastic Consumption Units) * conversion rate (`conf_ecu_rate`).",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    },
                    "title": "Normalised cost"
                },
                "gridData": {
                    "h": 5,
                    "i": "27ce47e9-a75f-4a58-9dd5-da735ef85ab2",
                    "w": 8,
                    "x": 34,
                    "y": 0
                },
                "panelIndex": "27ce47e9-a75f-4a58-9dd5-da735ef85ab2",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "8f632b34627f697e9702333f8ef042ab73e3436b01f9a29710a96cc9dad323b9": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "8f632b34627f697e9702333f8ef042ab73e3436b01f9a29710a96cc9dad323b9",
                                    "name": "chargeback_conf_lookup",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "title": "chargeback_conf_lookup",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "8f632b34627f697e9702333f8ef042ab73e3436b01f9a29710a96cc9dad323b9",
                                            "title": "chargeback_conf_lookup"
                                        }
                                    ],
                                    "layers": {
                                        "005d9023-92e0-4783-a349-4a2e05b0bce4": {
                                            "columns": [
                                                {
                                                    "columnId": "conf_indexing_weight",
                                                    "customLabel": true,
                                                    "fieldName": "conf_indexing_weight",
                                                    "inMetricDimension": true,
                                                    "label": "Weight",
                                                    "meta": {
                                                        "esType": "integer",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "conf_query_weight",
                                                    "customLabel": true,
                                                    "fieldName": "conf_query_weight",
                                                    "inMetricDimension": true,
                                                    "label": "Weight",
                                                    "meta": {
                                                        "esType": "integer",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "conf_storage_weight",
                                                    "customLabel": false,
                                                    "fieldName": "conf_storage_weight",
                                                    "inMetricDimension": true,
                                                    "label": "Weight",
                                                    "meta": {
                                                        "esType": "integer",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "8f632b34627f697e9702333f8ef042ab73e3436b01f9a29710a96cc9dad323b9",
                                            "query": {
                                                "esql": "FROM chargeback_conf_lookup | KEEP *weight"
                                            }
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM chargeback_conf_lookup | KEEP *weight"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "conf_indexing_weight",
                                            "conf_query_weight",
                                            "conf_storage_weight"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "005d9023-92e0-4783-a349-4a2e05b0bce4",
                                        "layerType": "data",
                                        "seriesType": "bar_percentage_stacked"
                                    }
                                ],
                                "legend": {
                                    "horizontalAlignment": "right",
                                    "isInside": true,
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false,
                                    "verticalAlignment": "bottom"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "conf_indexing_weight \u0026 conf_query_weight \u0026 conf_storage_weight of (empty)",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM chargeback_conf_lookup | KEEP *weight"
                    },
                    "searchSessionId": "62d2fe44-dd84-4cd0-ac53-38b090b0eff6",
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Blended rate weighting percentages"
                },
                "gridData": {
                    "h": 9,
                    "i": "a3a091e7-6bff-4edf-bc65-993e8a3648de",
                    "w": 6,
                    "x": 42,
                    "y": 0
                },
                "panelIndex": "a3a091e7-6bff-4edf-bc65-993e8a3648de",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "8f632b34627f697e9702333f8ef042ab73e3436b01f9a29710a96cc9dad323b9": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "8f632b34627f697e9702333f8ef042ab73e3436b01f9a29710a96cc9dad323b9",
                                    "name": "chargeback_conf_lookup",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "title": "chargeback_conf_lookup",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "8f632b34627f697e9702333f8ef042ab73e3436b01f9a29710a96cc9dad323b9",
                                            "title": "chargeback_conf_lookup"
                                        }
                                    ],
                                    "layers": {
                                        "4dba9fd5-8ec5-498a-b710-1512bd5dc18f": {
                                            "columns": [
                                                {
                                                    "columnId": "conf_ecu_rate_unit",
                                                    "customLabel": true,
                                                    "fieldName": "conf_ecu_rate_unit",
                                                    "label": "Unit",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "conf_ecu_rate",
                                                    "customLabel": true,
                                                    "fieldName": "conf_ecu_rate",
                                                    "inMetricDimension": true,
                                                    "label": "Rate",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                }
                                            ],
                                            "index": "8f632b34627f697e9702333f8ef042ab73e3436b01f9a29710a96cc9dad323b9",
                                            "query": {
                                                "esql": "FROM chargeback_conf_lookup | keep conf_ecu_rate_unit, conf_ecu_rate"
                                            }
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM chargeback_conf_lookup | keep conf_ecu_rate_unit, conf_ecu_rate"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "conf_ecu_rate_unit"
                                    },
                                    {
                                        "columnId": "conf_ecu_rate"
                                    }
                                ],
                                "layerId": "4dba9fd5-8ec5-498a-b710-1512bd5dc18f",
                                "layerType": "data"
                            }
                        },
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM chargeback_conf_lookup | keep conf_ecu_rate_unit, conf_ecu_rate"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 4,
                    "i": "54ff8784-cfb6-41dc-ad15-50547f49f9e7",
                    "w": 8,
                    "x": 34,
                    "y": 5
                },
                "panelIndex": "54ff8784-cfb6-41dc-ad15-50547f49f9e7",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "id": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "# Deployment statistics",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 3,
                    "i": "08bdbcda-fa42-4fb2-bb50-b4ed2620ef6b",
                    "w": 48,
                    "x": 0,
                    "y": 9
                },
                "panelIndex": "08bdbcda-fa42-4fb2-bb50-b4ed2620ef6b",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                    "name": "billing_cluster_cost_lookup",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "billing_cluster_cost_lookup",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "timeField": "@timestamp",
                                            "title": "billing_cluster_cost_lookup"
                                        }
                                    ],
                                    "layers": {
                                        "ba345378-8ee0-40ec-9fb0-d26588d09107": {
                                            "columns": [
                                                {
                                                    "columnId": "c33c8ff5-8a22-4f4f-9b92-5e16485f5d9a",
                                                    "customLabel": true,
                                                    "fieldName": "deployment",
                                                    "label": "Deployment",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "sourceParams": {
                                                            "indexPattern": "billing_cluster_cost_lookup"
                                                        },
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "2ab259ce-29c3-4c5c-817b-b7f036c62be8",
                                                    "customLabel": true,
                                                    "fieldName": "agg_blended",
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "sourceParams": {
                                                            "indexPattern": "billing_cluster_cost_lookup"
                                                        },
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "af3de6ff-d14d-4cea-bb56-4ee9012054b6",
                                                    "customLabel": true,
                                                    "fieldName": "tier",
                                                    "label": "Data tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "sourceParams": {
                                                            "indexPattern": "billing_cluster_cost_lookup"
                                                        },
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu), querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu), data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), storage = CASE (store == 0, data_set, store), total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight, total_weight_cold = conf_storage_weight + conf_query_weight, blended = CASE (tier == \"hot/content\", ((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight)) / total_weight_hot, ((storage * conf_storage_weight) + (querying * conf_query_weight)) / total_weight_cold) * conf_ecu_rate, deployment = CONCAT(deployment_name, \" (\", LEFT(deployment_id, 6), \")\")\n| STATS agg_blended = sum(blended) BY deployment, tier\n| KEEP deployment, tier, agg_blended\n| WHERE agg_blended \u003e 0"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu), querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu), data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), storage = CASE (store == 0, data_set, store), total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight, total_weight_cold = conf_storage_weight + conf_query_weight, blended = CASE (tier == \"hot/content\", ((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight)) / total_weight_hot, ((storage * conf_storage_weight) + (querying * conf_query_weight)) / total_weight_cold) * conf_ecu_rate, deployment = CONCAT(deployment_name, \" (\", LEFT(deployment_id, 6), \")\")\n| STATS agg_blended = sum(blended) BY deployment, tier\n| KEEP deployment, tier, agg_blended\n| WHERE agg_blended \u003e 0"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "c33c8ff5-8a22-4f4f-9b92-5e16485f5d9a",
                                        "isMetric": false,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "2ab259ce-29c3-4c5c-817b-b7f036c62be8",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "af3de6ff-d14d-4cea-bb56-4ee9012054b6",
                                        "isMetric": false,
                                        "isTransposed": true
                                    }
                                ],
                                "layerId": "ba345378-8ee0-40ec-9fb0-d26588d09107",
                                "layerType": "data"
                            }
                        },
                        "title": "Table ",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu), querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu), data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), storage = CASE (store == 0, data_set, store), total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight, total_weight_cold = conf_storage_weight + conf_query_weight, blended = CASE (tier == \"hot/content\", ((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight)) / total_weight_hot, ((storage * conf_storage_weight) + (querying * conf_query_weight)) / total_weight_cold) * conf_ecu_rate, deployment = CONCAT(deployment_name, \" (\", LEFT(deployment_id, 6), \")\")\n| STATS agg_blended = sum(blended) BY deployment, tier\n| KEEP deployment, tier, agg_blended\n| WHERE agg_blended \u003e 0"
                    },
                    "searchSessionId": "48b157e3-14ff-4c71-8178-4a69f0592d85",
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Normalised cost per deployment and tier"
                },
                "gridData": {
                    "h": 15,
                    "i": "8049f13b-c56d-4a6e-a4e3-5cf4274fef60",
                    "w": 24,
                    "x": 0,
                    "y": 12
                },
                "panelIndex": "8049f13b-c56d-4a6e-a4e3-5cf4274fef60",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                    "name": "billing_cluster_cost_lookup",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "billing_cluster_cost_lookup",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "timeField": "@timestamp",
                                            "title": "billing_cluster_cost_lookup"
                                        }
                                    ],
                                    "layers": {
                                        "91b4be84-6eb5-4b77-ad13-b85d992f3bbf": {
                                            "columns": [
                                                {
                                                    "columnId": "deployment",
                                                    "customLabel": true,
                                                    "fieldName": "deployment",
                                                    "label": "Deployment",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "tier",
                                                    "customLabel": true,
                                                    "fieldName": "tier",
                                                    "label": "Data tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "agg_blended",
                                                    "customLabel": true,
                                                    "fieldName": "agg_blended",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu), querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu), data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), storage = CASE (store == 0, data_set, store), total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight, total_weight_cold = conf_storage_weight + conf_query_weight, blended = CASE (tier == \"hot/content\", ((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight)) / total_weight_hot, ((storage * conf_storage_weight) + (querying * conf_query_weight)) / total_weight_cold) * conf_ecu_rate, deployment = CONCAT(deployment_name, \" (\", LEFT(deployment_id, 6), \")\")\n| STATS agg_blended = sum(blended) BY deployment, tier\n| KEEP deployment, tier, agg_blended\n| WHERE agg_blended \u003e 0"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu), querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu), data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), storage = CASE (store == 0, data_set, store), total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight, total_weight_cold = conf_storage_weight + conf_query_weight, blended = CASE (tier == \"hot/content\", ((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight)) / total_weight_hot, ((storage * conf_storage_weight) + (querying * conf_query_weight)) / total_weight_cold) * conf_ecu_rate, deployment = CONCAT(deployment_name, \" (\", LEFT(deployment_id, 6), \")\")\n| STATS agg_blended = sum(blended) BY deployment, tier\n| KEEP deployment, tier, agg_blended\n| WHERE agg_blended \u003e 0"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "91b4be84-6eb5-4b77-ad13-b85d992f3bbf",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "metrics": [
                                            "agg_blended"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "deployment",
                                            "tier"
                                        ]
                                    }
                                ],
                                "shape": "treemap"
                            }
                        },
                        "title": "Pie",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu), querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu), data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), storage = CASE (store == 0, data_set, store), total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight, total_weight_cold = conf_storage_weight + conf_query_weight, blended = CASE (tier == \"hot/content\", ((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight)) / total_weight_hot, ((storage * conf_storage_weight) + (querying * conf_query_weight)) / total_weight_cold) * conf_ecu_rate, deployment = CONCAT(deployment_name, \" (\", LEFT(deployment_id, 6), \")\")\n| STATS agg_blended = sum(blended) BY deployment, tier\n| KEEP deployment, tier, agg_blended\n| WHERE agg_blended \u003e 0"
                    },
                    "searchSessionId": "48b157e3-14ff-4c71-8178-4a69f0592d85",
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Normalised cost per deployment and tier"
                },
                "gridData": {
                    "h": 15,
                    "i": "normalised-cost-per-deployment-and-tier",
                    "w": 24,
                    "x": 24,
                    "y": 12
                },
                "panelIndex": "normalised-cost-per-deployment-and-tier",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "# Data tier and data stream overview",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    },
                    "title": ""
                },
                "gridData": {
                    "h": 3,
                    "i": "784ed861-b61f-4c71-a3bc-02cb513a8019",
                    "w": 48,
                    "x": 0,
                    "y": 27
                },
                "panelIndex": "784ed861-b61f-4c71-a3bc-02cb513a8019",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                    "name": "billing_cluster_cost_lookup",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "billing_cluster_cost_lookup",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "timeField": "@timestamp",
                                            "title": "billing_cluster_cost_lookup"
                                        }
                                    ],
                                    "layers": {
                                        "9d199172-f9fa-4fc4-82af-c7e2672a3f54": {
                                            "columns": [
                                                {
                                                    "columnId": "a76076ce-f372-4a48-857d-75010bbf5970",
                                                    "fieldName": "tier",
                                                    "label": "tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "sourceParams": {
                                                            "indexPattern": "billing_cluster_cost_lookup"
                                                        },
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "6e881cac-4719-493c-95f8-e3bfa38c3219",
                                                    "customLabel": true,
                                                    "fieldName": "agg_indexing",
                                                    "label": "Indexing",
                                                    "meta": {
                                                        "esType": "double",
                                                        "sourceParams": {
                                                            "indexPattern": "billing_cluster_cost_lookup"
                                                        },
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "97a86307-08fc-4b2d-a82a-36a2ecc9c75d",
                                                    "customLabel": true,
                                                    "fieldName": "agg_querying",
                                                    "label": "Querying",
                                                    "meta": {
                                                        "esType": "double",
                                                        "sourceParams": {
                                                            "indexPattern": "billing_cluster_cost_lookup"
                                                        },
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "2b086331-8a38-4df2-b042-7827d3519d63",
                                                    "customLabel": true,
                                                    "fieldName": "agg_storage",
                                                    "label": "Storage",
                                                    "meta": {
                                                        "esType": "double",
                                                        "sourceParams": {
                                                            "indexPattern": "billing_cluster_cost_lookup"
                                                        },
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "307273f7-1b4c-450c-80cd-ef0326b38f6e",
                                                    "customLabel": true,
                                                    "fieldName": "agg_blended",
                                                    "label": "Blended",
                                                    "meta": {
                                                        "esType": "double",
                                                        "sourceParams": {
                                                            "indexPattern": "billing_cluster_cost_lookup"
                                                        },
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_indexing = sum(indexing),\n    agg_querying = sum(querying),\n    agg_storage = sum(storage),\n    agg_blended = sum(blended)\n    BY\n        tier\n| WHERE agg_blended \u003e 0"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_indexing = sum(indexing),\n    agg_querying = sum(querying),\n    agg_storage = sum(storage),\n    agg_blended = sum(blended)\n    BY\n        tier\n| WHERE agg_blended \u003e 0"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "a76076ce-f372-4a48-857d-75010bbf5970",
                                        "isMetric": false,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "6e881cac-4719-493c-95f8-e3bfa38c3219",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "97a86307-08fc-4b2d-a82a-36a2ecc9c75d",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "2b086331-8a38-4df2-b042-7827d3519d63",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "307273f7-1b4c-450c-80cd-ef0326b38f6e",
                                        "isMetric": true,
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "9d199172-f9fa-4fc4-82af-c7e2672a3f54",
                                "layerType": "data"
                            }
                        },
                        "title": "agg_indexing \u0026 agg_querying \u0026 agg_storage \u0026 agg_blended of tier",
                        "visualizationType": "lnsDatatable"
                    },
                    "description": "Normalised cost breakdown per tier, based on Indexing, Querying, Storage and a blended ratio of all of these.",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, tier_sum_query_time / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, tier_sum_store_size / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_indexing = sum(indexing),\n    agg_querying = sum(querying),\n    agg_storage = sum(storage),\n    agg_blended = sum(blended)\n    BY\n        tier\n| WHERE agg_blended \u003e 0"
                    },
                    "searchSessionId": "48b157e3-14ff-4c71-8178-4a69f0592d85",
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Normalised cost per tier"
                },
                "gridData": {
                    "h": 10,
                    "i": "18643569-92d3-4a30-aafe-6ae11acc4c58",
                    "w": 48,
                    "x": 0,
                    "y": 30
                },
                "panelIndex": "18643569-92d3-4a30-aafe-6ae11acc4c58",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Indexing",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    },
                    "title": ""
                },
                "gridData": {
                    "h": 3,
                    "i": "4d8d5ff0-b63f-4d39-be03-e6f85a8b60ce",
                    "w": 12,
                    "x": 0,
                    "y": 40
                },
                "panelIndex": "4d8d5ff0-b63f-4d39-be03-e6f85a8b60ce",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Querying",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    },
                    "title": ""
                },
                "gridData": {
                    "h": 3,
                    "i": "40a91be7-f01d-47ce-ba7f-683bcee42626",
                    "w": 12,
                    "x": 12,
                    "y": 40
                },
                "panelIndex": "40a91be7-f01d-47ce-ba7f-683bcee42626",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Storage",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    },
                    "title": ""
                },
                "gridData": {
                    "h": 3,
                    "i": "d0c647b4-4b26-49d3-b54a-1ddbdf995143",
                    "w": 12,
                    "x": 24,
                    "y": 40
                },
                "panelIndex": "d0c647b4-4b26-49d3-b54a-1ddbdf995143",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Blended",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    },
                    "title": ""
                },
                "gridData": {
                    "h": 3,
                    "i": "540d6135-d996-43ed-a192-30d51e2e5454",
                    "w": 12,
                    "x": 36,
                    "y": 40
                },
                "panelIndex": "540d6135-d996-43ed-a192-30d51e2e5454",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "0f6d5278-b325-49bc-9eb7-2febd2a5de0f": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_indexing",
                                                    "customLabel": true,
                                                    "fieldName": "agg_indexing",
                                                    "inMetricDimension": true,
                                                    "label": "Indexing",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": true,
                                                    "fieldName": "datastream",
                                                    "label": "Data stream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC\n| Limit 20"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC\n| Limit 20"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "emptySizeRatio": 0.3,
                                        "layerId": "0f6d5278-b325-49bc-9eb7-2febd2a5de0f",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "metrics": [
                                            "agg_indexing"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "datastream"
                                        ]
                                    }
                                ],
                                "shape": "donut"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC\n| Limit 20"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Indexing: Normalised cost totals by data stream"
                },
                "gridData": {
                    "h": 15,
                    "i": "ed65354e-848c-4d93-bcd6-b9c50793e242",
                    "w": 12,
                    "x": 0,
                    "y": 43
                },
                "panelIndex": "ed65354e-848c-4d93-bcd6-b9c50793e242",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "3b03b6a8-35ae-4554-8bd6-a887d8b36748": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_querying",
                                                    "customLabel": true,
                                                    "fieldName": "agg_querying",
                                                    "inMetricDimension": true,
                                                    "label": "Querying",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": true,
                                                    "fieldName": "datastream",
                                                    "label": "Data stream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying)\n    BY \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC\n| Limit 20"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying)\n    BY \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC\n| Limit 20"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "emptySizeRatio": 0.3,
                                        "layerId": "3b03b6a8-35ae-4554-8bd6-a887d8b36748",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "metrics": [
                                            "agg_querying"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "datastream"
                                        ]
                                    }
                                ],
                                "shape": "donut"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying)\n    BY \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC\n| Limit 20"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Querying: Normalised cost totals by data stream"
                },
                "gridData": {
                    "h": 15,
                    "i": "4a2ecf27-21c7-4fff-986b-05b25e0ce8f8",
                    "w": 12,
                    "x": 12,
                    "y": 43
                },
                "panelIndex": "4a2ecf27-21c7-4fff-986b-05b25e0ce8f8",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "2813628b-2a20-484c-9a19-11955d86e9ff": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_storage",
                                                    "customLabel": true,
                                                    "fieldName": "agg_storage",
                                                    "inMetricDimension": true,
                                                    "label": "Storage",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": true,
                                                    "fieldName": "datastream",
                                                    "label": "Data stream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC\n| limit 20"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC\n| limit 20"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "emptySizeRatio": 0.3,
                                        "layerId": "2813628b-2a20-484c-9a19-11955d86e9ff",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "metrics": [
                                            "agg_storage"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "datastream"
                                        ]
                                    }
                                ],
                                "shape": "donut"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC\n| limit 20"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Storage: Normalised cost totals by data stream"
                },
                "gridData": {
                    "h": 15,
                    "i": "3269b898-7190-40b6-ad0e-d29fcf98e762",
                    "w": 12,
                    "x": 24,
                    "y": 43
                },
                "panelIndex": "3269b898-7190-40b6-ad0e-d29fcf98e762",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "ee58e17d-eba7-48a7-bae8-2df3607d9653": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_blended",
                                                    "customLabel": false,
                                                    "fieldName": "agg_blended",
                                                    "inMetricDimension": true,
                                                    "label": "agg_blended",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu),\n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu),\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store),\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        TO_DOUBLE(((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight))) / total_weight_hot,\n        TO_DOUBLE(((storage * conf_storage_weight) + (querying * conf_query_weight))) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        datastream\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC\n| limit 20"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu),\n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu),\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store),\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        TO_DOUBLE(((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight))) / total_weight_hot,\n        TO_DOUBLE(((storage * conf_storage_weight) + (querying * conf_query_weight))) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        datastream\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC\n| limit 20"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "ee58e17d-eba7-48a7-bae8-2df3607d9653",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "metrics": [
                                            "agg_blended"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "datastream"
                                        ]
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "Treemap",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu),\n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu),\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store),\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        TO_DOUBLE(((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight))) / total_weight_hot,\n        TO_DOUBLE(((storage * conf_storage_weight) + (querying * conf_query_weight))) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        datastream\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC\n| limit 20"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Blended: Normalised cost totals by data stream"
                },
                "gridData": {
                    "h": 15,
                    "i": "cb467fdf-5cb1-41b5-8235-8b823cbd9310",
                    "w": 12,
                    "x": 36,
                    "y": 43
                },
                "panelIndex": "cb467fdf-5cb1-41b5-8235-8b823cbd9310",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "23693fb0-43a5-4f95-bd77-d6a54e18e34a": {
                                            "columns": [
                                                {
                                                    "columnId": "Data stream",
                                                    "customLabel": false,
                                                    "fieldName": "Data stream",
                                                    "inMetricDimension": true,
                                                    "label": "Data stream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Data tier",
                                                    "customLabel": false,
                                                    "fieldName": "Data tier",
                                                    "inMetricDimension": true,
                                                    "label": "Data tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Indexing",
                                                    "customLabel": false,
                                                    "fieldName": "Indexing",
                                                    "inMetricDimension": true,
                                                    "label": "Indexing",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "Querying",
                                                    "customLabel": false,
                                                    "fieldName": "Querying",
                                                    "inMetricDimension": true,
                                                    "label": "Querying",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "Storage",
                                                    "customLabel": false,
                                                    "fieldName": "Storage",
                                                    "inMetricDimension": true,
                                                    "label": "Storage",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_tier_and_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE(deployment_sum_indexing_time \u003e 0, TO_DOUBLE(tier_and_datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE(deployment_sum_query_time \u003e 0, TO_DOUBLE(tier_and_datastream_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE(deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(tier_and_datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE(deployment_sum_store_size \u003e 0, TO_DOUBLE(tier_and_datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE(store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE(\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    Indexing = round(sum(indexing),2),\n    Querying = round(sum(querying),2),\n    Storage = round(sum(storage),2),\n    Blended = round(sum(blended),2)\n    BY datastream, tier\n| SORT Blended DESC\n| RENAME tier as `Data tier`, datastream as `Data stream`\n| Keep `Data stream`, `Data tier`, Indexing, Querying, Storage, Blended\n| WHERE `Data stream` is not null"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_tier_and_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE(deployment_sum_indexing_time \u003e 0, TO_DOUBLE(tier_and_datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE(deployment_sum_query_time \u003e 0, TO_DOUBLE(tier_and_datastream_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE(deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(tier_and_datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE(deployment_sum_store_size \u003e 0, TO_DOUBLE(tier_and_datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE(store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE(\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    Indexing = round(sum(indexing),2),\n    Querying = round(sum(querying),2),\n    Storage = round(sum(storage),2),\n    Blended = round(sum(blended),2)\n    BY datastream, tier\n| SORT Blended DESC\n| RENAME tier as `Data tier`, datastream as `Data stream`\n| Keep `Data stream`, `Data tier`, Indexing, Querying, Storage, Blended\n| WHERE `Data stream` is not null"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "Data stream"
                                    },
                                    {
                                        "columnId": "Data tier"
                                    },
                                    {
                                        "columnId": "Indexing"
                                    },
                                    {
                                        "columnId": "Querying"
                                    },
                                    {
                                        "columnId": "Storage"
                                    }
                                ],
                                "layerId": "23693fb0-43a5-4f95-bd77-d6a54e18e34a",
                                "layerType": "data"
                            }
                        },
                        "title": "Indexing \u0026 Querying \u0026 Storage of Data tier",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_tier_and_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE(deployment_sum_indexing_time \u003e 0, TO_DOUBLE(tier_and_datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE(deployment_sum_query_time \u003e 0, TO_DOUBLE(tier_and_datastream_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE(deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(tier_and_datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE(deployment_sum_store_size \u003e 0, TO_DOUBLE(tier_and_datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE(store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE(\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    Indexing = round(sum(indexing),2),\n    Querying = round(sum(querying),2),\n    Storage = round(sum(storage),2),\n    Blended = round(sum(blended),2)\n    BY datastream, tier\n| SORT Blended DESC\n| RENAME tier as `Data tier`, datastream as `Data stream`\n| Keep `Data stream`, `Data tier`, Indexing, Querying, Storage, Blended\n| WHERE `Data stream` is not null"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Normalised cost per data stream per tier"
                },
                "gridData": {
                    "h": 15,
                    "i": "964a716b-bb61-4cc0-ba77-c1e73e2da836",
                    "w": 48,
                    "x": 0,
                    "y": 58
                },
                "panelIndex": "964a716b-bb61-4cc0-ba77-c1e73e2da836",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "# Data tier and data stream per day",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    },
                    "title": ""
                },
                "gridData": {
                    "h": 3,
                    "i": "b1e12ff9-83d2-4dd7-a16e-ec4597d14dbc",
                    "w": 48,
                    "x": 0,
                    "y": 73
                },
                "panelIndex": "b1e12ff9-83d2-4dd7-a16e-ec4597d14dbc",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Indexing details",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    },
                    "title": ""
                },
                "gridData": {
                    "h": 3,
                    "i": "9cd4730b-d3f5-438e-a816-4d5aebf1eae6",
                    "w": 48,
                    "x": 0,
                    "y": 76
                },
                "panelIndex": "9cd4730b-d3f5-438e-a816-4d5aebf1eae6",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "0ee24895-1496-4b23-96ec-ec09a8f49332": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_indexing",
                                                    "customLabel": true,
                                                    "fieldName": "agg_indexing",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": true,
                                                    "fieldName": "@timestamp",
                                                    "label": "Date",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": true,
                                                    "fieldName": "datastream",
                                                    "label": "Data stream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_indexing"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "0ee24895-1496-4b23-96ec-ec09a8f49332",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_indexing over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Indexing: Normalised per data stream per day"
                },
                "gridData": {
                    "h": 14,
                    "i": "dafb7c36-3a1d-4cbb-9944-51beedf535f6",
                    "w": 16,
                    "x": 0,
                    "y": 79
                },
                "panelIndex": "dafb7c36-3a1d-4cbb-9944-51beedf535f6",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "d24af063-ec41-4736-bf4e-70f1fe4da4cf": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_indexing",
                                                    "customLabel": true,
                                                    "fieldName": "agg_indexing",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": true,
                                                    "fieldName": "@timestamp",
                                                    "label": "Date",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "tier",
                                                    "customLabel": true,
                                                    "fieldName": "tier",
                                                    "label": "Data tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    indexing = CASE (\n        deployment_sum_indexing_time \u003e 0,\n        TO_DOUBLE(tier_sum_indexing_time) / deployment_sum_indexing_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_indexing \u003e 0"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    indexing = CASE (\n        deployment_sum_indexing_time \u003e 0,\n        TO_DOUBLE(tier_sum_indexing_time) / deployment_sum_indexing_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_indexing \u003e 0"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_indexing"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "d24af063-ec41-4736-bf4e-70f1fe4da4cf",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "tier",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_indexing over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    indexing = CASE (\n        deployment_sum_indexing_time \u003e 0,\n        TO_DOUBLE(tier_sum_indexing_time) / deployment_sum_indexing_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_indexing \u003e 0"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Indexing: Normalised cost per tier per day"
                },
                "gridData": {
                    "h": 14,
                    "i": "45a29dd3-1990-4717-bf6b-25a5d85d2344",
                    "w": 16,
                    "x": 16,
                    "y": 79
                },
                "panelIndex": "45a29dd3-1990-4717-bf6b-25a5d85d2344",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "d5520b0e-567f-4f0a-b424-fc79eb79e2cc": {
                                            "columns": [
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": true,
                                                    "fieldName": "@timestamp",
                                                    "label": "Date",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": true,
                                                    "fieldName": "datastream",
                                                    "label": "Data stream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "agg_indexing",
                                                    "customLabel": true,
                                                    "fieldName": "agg_indexing",
                                                    "inMetricDimension": true,
                                                    "label": "% Normalised cost",
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "percent",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    }
                                                }
                                            ],
                                            "index": "3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    indexing = CASE (\n        deployment_sum_indexing_time \u003e 0,\n        TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp,\n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    indexing = CASE (\n        deployment_sum_indexing_time \u003e 0,\n        TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp,\n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_indexing"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "d5520b0e-567f-4f0a-b424-fc79eb79e2cc",
                                        "layerType": "data",
                                        "seriesType": "bar_percentage_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_indexing over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    indexing = CASE (\n        deployment_sum_indexing_time \u003e 0,\n        TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_indexing = sum(indexing)\n    BY \n        @timestamp,\n        datastream\n| WHERE agg_indexing \u003e 0\n| SORT agg_indexing DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Indexing: % Normalised cost per data stream per day"
                },
                "gridData": {
                    "h": 14,
                    "i": "9bc8fa5a-d47a-4a79-ab6a-032d726f085f",
                    "w": 16,
                    "x": 32,
                    "y": 79
                },
                "panelIndex": "9bc8fa5a-d47a-4a79-ab6a-032d726f085f",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Querying details",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    },
                    "title": ""
                },
                "gridData": {
                    "h": 3,
                    "i": "8de95af1-8e9a-424a-baaf-8cfcb2577f59",
                    "w": 48,
                    "x": 0,
                    "y": 93
                },
                "panelIndex": "8de95af1-8e9a-424a-baaf-8cfcb2577f59",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "1a2f8269-f56f-4c02-8506-76b723acc828": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_querying",
                                                    "customLabel": true,
                                                    "fieldName": "agg_querying",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": true,
                                                    "fieldName": "@timestamp",
                                                    "label": "Date",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": true,
                                                    "fieldName": "datastream",
                                                    "label": "Data stream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    querying = CASE (\n        deployment_sum_query_time \u003e 0,\n        TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying) \n    BY \n        @timestamp, \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    querying = CASE (\n        deployment_sum_query_time \u003e 0,\n        TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying) \n    BY \n        @timestamp, \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_querying"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "1a2f8269-f56f-4c02-8506-76b723acc828",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_querying over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    querying = CASE (\n        deployment_sum_query_time \u003e 0,\n        TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying) \n    BY \n        @timestamp, \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Querying: Normalised cost per data stream per day"
                },
                "gridData": {
                    "h": 14,
                    "i": "83bbd574-571b-4401-af7f-d0998cd9af2e",
                    "w": 16,
                    "x": 0,
                    "y": 96
                },
                "panelIndex": "83bbd574-571b-4401-af7f-d0998cd9af2e",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "61842c44-afd9-429c-bf2e-18a4a079e5e8": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_querying",
                                                    "customLabel": true,
                                                    "fieldName": "agg_querying",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": true,
                                                    "fieldName": "@timestamp",
                                                    "label": "Date",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "tier",
                                                    "customLabel": false,
                                                    "fieldName": "tier",
                                                    "label": "tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    querying = CASE (\n        deployment_sum_query_time \u003e 0,\n        TO_DOUBLE(tier_sum_query_time) / deployment_sum_query_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_querying \u003e 0"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    querying = CASE (\n        deployment_sum_query_time \u003e 0,\n        TO_DOUBLE(tier_sum_query_time) / deployment_sum_query_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_querying \u003e 0"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_querying"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "61842c44-afd9-429c-bf2e-18a4a079e5e8",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "tier",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_querying over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| EVAL \n    querying = CASE (\n        deployment_sum_query_time \u003e 0,\n        TO_DOUBLE(tier_sum_query_time) / deployment_sum_query_time * total_ecu\n    ) * conf_ecu_rate\n| STATS  \n    agg_querying = sum(querying)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_querying \u003e 0"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Querying: Noralised cost per tier per day"
                },
                "gridData": {
                    "h": 14,
                    "i": "b0df8c79-87d4-4a7a-8c7b-4752862fb2dd",
                    "w": 16,
                    "x": 16,
                    "y": 96
                },
                "panelIndex": "b0df8c79-87d4-4a7a-8c7b-4752862fb2dd",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "91bcc41e-3a2c-434d-8df7-29c01340e712": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_querying",
                                                    "customLabel": true,
                                                    "fieldName": "agg_querying",
                                                    "inMetricDimension": true,
                                                    "label": "% Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": true,
                                                    "fieldName": "@timestamp",
                                                    "label": "Date",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": true,
                                                    "fieldName": "datastream",
                                                    "label": "Data stream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate\n| STATS \n    agg_querying = sum(querying)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate\n| STATS \n    agg_querying = sum(querying)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_querying"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "91bcc41e-3a2c-434d-8df7-29c01340e712",
                                        "layerType": "data",
                                        "seriesType": "bar_percentage_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_querying over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate\n| STATS \n    agg_querying = sum(querying)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_querying \u003e 0\n| SORT agg_querying DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Querying: % Normalised cost per data stream per day"
                },
                "gridData": {
                    "h": 14,
                    "i": "b3e62c24-abb9-431e-a228-cbc5e7b8b02a",
                    "w": 16,
                    "x": 32,
                    "y": 96
                },
                "panelIndex": "b3e62c24-abb9-431e-a228-cbc5e7b8b02a",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Storage details",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    },
                    "title": ""
                },
                "gridData": {
                    "h": 3,
                    "i": "4d3f1bfb-ea89-4978-ab6f-9033a507785f",
                    "w": 48,
                    "x": 0,
                    "y": 110
                },
                "panelIndex": "4d3f1bfb-ea89-4978-ab6f-9033a507785f",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "b72a0ab5-dbf5-4fd2-bdef-c855fe354bee": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_storage",
                                                    "customLabel": true,
                                                    "fieldName": "agg_storage",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": true,
                                                    "fieldName": "@timestamp",
                                                    "label": "Date",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": true,
                                                    "fieldName": "datastream",
                                                    "label": "Data stream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_storage"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "b72a0ab5-dbf5-4fd2-bdef-c855fe354bee",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_storage over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Storage: Nomalised cost per data stream per day"
                },
                "gridData": {
                    "h": 15,
                    "i": "6430d172-9b7f-45a0-a836-c46af0276b19",
                    "w": 16,
                    "x": 0,
                    "y": 113
                },
                "panelIndex": "6430d172-9b7f-45a0-a836-c46af0276b19",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "93fd5f12-463f-4e8e-a9b8-0ac77d0522a9": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_storage",
                                                    "customLabel": true,
                                                    "fieldName": "agg_storage",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": true,
                                                    "fieldName": "@timestamp",
                                                    "label": "Date",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "tier",
                                                    "customLabel": true,
                                                    "fieldName": "tier",
                                                    "label": "Data tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(tier_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(tier_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_storage \u003e 0"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(tier_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(tier_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_storage \u003e 0"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_storage"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "93fd5f12-463f-4e8e-a9b8-0ac77d0522a9",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "tier",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_storage over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(tier_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(tier_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp,\n        tier\n| WHERE agg_storage \u003e 0"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Storage: Normalised cost per tier per day"
                },
                "gridData": {
                    "h": 15,
                    "i": "ba7efeab-de6c-4301-8e97-7adb98dae58b",
                    "w": 16,
                    "x": 16,
                    "y": 113
                },
                "panelIndex": "ba7efeab-de6c-4301-8e97-7adb98dae58b",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "b72a0ab5-dbf5-4fd2-bdef-c855fe354bee": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_storage",
                                                    "customLabel": true,
                                                    "fieldName": "agg_storage",
                                                    "inMetricDimension": true,
                                                    "label": "% Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": true,
                                                    "fieldName": "@timestamp",
                                                    "label": "Date",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": true,
                                                    "fieldName": "datastream",
                                                    "label": "Data stream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_storage"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "b72a0ab5-dbf5-4fd2-bdef-c855fe354bee",
                                        "layerType": "data",
                                        "seriesType": "bar_percentage_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_storage over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL \n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate\n| STATS  \n    agg_storage = sum(storage)\n    BY \n        @timestamp, \n        datastream\n| WHERE agg_storage \u003e 0\n| SORT agg_storage DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Storage: % Normalised cost per data stream per day"
                },
                "gridData": {
                    "h": 15,
                    "i": "a672f0fa-cdf6-4e27-a2c8-f753eef30a06",
                    "w": 16,
                    "x": 32,
                    "y": 113
                },
                "panelIndex": "a672f0fa-cdf6-4e27-a2c8-f753eef30a06",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Blended details",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    },
                    "title": ""
                },
                "gridData": {
                    "h": 3,
                    "i": "a2cb12f7-9b9e-4bf7-864e-9101107e0c3e",
                    "w": 48,
                    "x": 0,
                    "y": 128
                },
                "panelIndex": "a2cb12f7-9b9e-4bf7-864e-9101107e0c3e",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "52906f25-a114-4d45-b425-f0ff154f4ac1": {
                                            "columns": [
                                                {
                                                    "columnId": "agg_blended",
                                                    "customLabel": true,
                                                    "fieldName": "agg_blended",
                                                    "inMetricDimension": true,
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": true,
                                                    "fieldName": "@timestamp",
                                                    "label": "Date",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu),\n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu),\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store),\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    blended = TO_DOUBLE(((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight))) / total_weight_hot * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        datastream\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu),\n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu),\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store),\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    blended = TO_DOUBLE(((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight))) / total_weight_hot * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        datastream\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "agg_blended"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "52906f25-a114-4d45-b425-f0ff154f4ac1",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_blended over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu),\n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu),\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store),\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    blended = TO_DOUBLE(((storage * conf_storage_weight) + (querying * conf_query_weight) + (indexing * conf_indexing_weight))) / total_weight_hot * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        datastream\n| WHERE agg_blended \u003e 0\n| SORT agg_blended DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Blended value: Normalised cost per data stream per day"
                },
                "gridData": {
                    "h": 14,
                    "i": "4c97109a-2048-470f-ae18-8c424ba2c12e",
                    "w": 16,
                    "x": 0,
                    "y": 131
                },
                "panelIndex": "4c97109a-2048-470f-ae18-8c424ba2c12e",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "43f9cfe6-d828-4773-ab65-129f92cf7f4d": {
                                            "columns": [
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": true,
                                                    "fieldName": "@timestamp",
                                                    "inMetricDimension": true,
                                                    "label": "Date",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "50a91b89-2e68-4a69-90a0-d2ab79115b96",
                                                    "customLabel": true,
                                                    "fieldName": "tier",
                                                    "label": "Data tier",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "sourceParams": {
                                                            "indexPattern": "billing_cluster_cost_lookup"
                                                        },
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "1501af72-2509-4ae0-88a0-c1481e438377",
                                                    "customLabel": true,
                                                    "fieldName": "agg_blended",
                                                    "label": "Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "sourceParams": {
                                                            "indexPattern": "billing_cluster_cost_lookup"
                                                        },
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(tier_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(tier_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(tier_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(tier_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        tier\n| WHERE agg_blended \u003e 0"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(tier_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(tier_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(tier_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(tier_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        tier\n| WHERE agg_blended \u003e 0"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "1501af72-2509-4ae0-88a0-c1481e438377"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "43f9cfe6-d828-4773-ab65-129f92cf7f4d",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "50a91b89-2e68-4a69-90a0-d2ab79115b96",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "agg_indexing \u0026 agg_querying \u0026 agg_storage \u0026 agg_blended over @timestamp",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(tier_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(tier_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(tier_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(tier_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    agg_blended = sum(blended)\n    BY\n        @timestamp,\n        tier\n| WHERE agg_blended \u003e 0"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Blended value: Normalised cost per tier per day"
                },
                "gridData": {
                    "h": 14,
                    "i": "5732f95c-3cc0-46c8-a8ab-14f8c6937f9f",
                    "w": 16,
                    "x": 16,
                    "y": 131
                },
                "panelIndex": "5732f95c-3cc0-46c8-a8ab-14f8c6937f9f",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {
                                        "d720a72f-fe61-4baf-bdee-8a50d4247670": {
                                            "columns": [
                                                {
                                                    "columnId": "% Normalised cost",
                                                    "customLabel": false,
                                                    "fieldName": "% Normalised cost",
                                                    "inMetricDimension": true,
                                                    "label": "% Normalised cost",
                                                    "meta": {
                                                        "esType": "double",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "@timestamp",
                                                    "customLabel": false,
                                                    "fieldName": "@timestamp",
                                                    "label": "@timestamp",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    }
                                                },
                                                {
                                                    "columnId": "datastream",
                                                    "customLabel": false,
                                                    "fieldName": "datastream",
                                                    "label": "datastream",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
                                            "query": {
                                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    `% Normalised cost` = sum(blended)\n    BY\n        @timestamp,\n        datastream,\n        tier\n| WHERE `% Normalised cost` \u003e 0\n| SORT `% Normalised cost` DESC"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    `% Normalised cost` = sum(blended)\n    BY\n        @timestamp,\n        datastream,\n        tier\n| WHERE `% Normalised cost` \u003e 0\n| SORT `% Normalised cost` DESC"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "% Normalised cost"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "d720a72f-fe61-4baf-bdee-8a50d4247670",
                                        "layerType": "data",
                                        "seriesType": "bar_percentage_stacked",
                                        "splitAccessor": "datastream",
                                        "xAccessor": "@timestamp"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "Pie",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM billing_cluster_cost_lookup\n| EVAL config_join_key = \"chargeback_config\"\n| LOOKUP JOIN chargeback_conf_lookup ON config_join_key\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\n| EVAL\n    indexing = CASE (deployment_sum_indexing_time \u003e 0, TO_DOUBLE(datastream_sum_indexing_time) / deployment_sum_indexing_time * total_ecu) * conf_ecu_rate,\n    querying = CASE (deployment_sum_query_time \u003e 0, TO_DOUBLE(datastream_sum_query_time) / deployment_sum_query_time * total_ecu) * conf_ecu_rate,\n    data_set = CASE (deployment_sum_data_set_store_size \u003e 0, TO_DOUBLE(datastream_sum_data_set_store_size) / deployment_sum_data_set_store_size * total_ecu),\n    store = CASE (deployment_sum_store_size \u003e 0, TO_DOUBLE(datastream_sum_store_size) / deployment_sum_store_size * total_ecu),\n    storage = CASE (store == 0, data_set, store) * conf_ecu_rate,\n    total_weight_hot = conf_storage_weight + conf_query_weight + conf_indexing_weight,\n    total_weight_cold = conf_storage_weight + conf_query_weight,\n    blended = CASE (\n        tier == \"hot/content\",\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight) + (indexing / conf_ecu_rate * conf_indexing_weight)) / total_weight_hot,\n        ((storage / conf_ecu_rate * conf_storage_weight) + (querying / conf_ecu_rate * conf_query_weight)) / total_weight_cold\n    ) * conf_ecu_rate\n| STATS\n    `% Normalised cost` = sum(blended)\n    BY\n        @timestamp,\n        datastream,\n        tier\n| WHERE `% Normalised cost` \u003e 0\n| SORT `% Normalised cost` DESC"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Blended value: % Normalised cost per data stream per day"
                },
                "gridData": {
                    "h": 14,
                    "i": "4dbbad0a-7ceb-443b-912b-0c1ae9fb3a6a",
                    "w": 16,
                    "x": 32,
                    "y": 131
                },
                "panelIndex": "4dbbad0a-7ceb-443b-912b-0c1ae9fb3a6a",
                "type": "lens"
            }
        ],
        "timeRestore": false,
        "title": "[Chargeback] Cost and Consumption breakdown",
        "version": 3
    },
    "coreMigrationVersion": "8.8.0",
    "created_at": "2025-11-06T13:31:17.614Z",
    "id": "chargeback-39a39857-746c-4a29-adca-3c2fcb6bcfb6",
    "references": [
        {
            "id": "2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f",
            "name": "controlGroup_ab7831d2-e2cb-4ece-a4a6-b22c17f30aec:optionsListDataView",
            "type": "index-pattern"
        }
    ],
    "type": "dashboard",
    "typeMigrationVersion": "10.3.0",
    "updated_by": "u_mGBROF_q5bmFCATbLXAcCwKa0k8JvONAwSruelyKA5E_0"
}