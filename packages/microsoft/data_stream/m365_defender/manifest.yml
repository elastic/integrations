type: logs
title: Microsoft m365_defender logs
release: beta
streams:
  - input: httpjson
    template_path: httpjson.yml.hbs
    title: Microsoft m365_defender logs (httpjson)
    description: Collect Microsoft m365_defender logs using httpjson input
    vars:
      - name: interval
        type: text
        title: Interval
        multi: false
        required: true
        show_user: true
        default: 5m
      - name: tags
        type: text
        title: Tags
        multi: true
        required: true
        show_user: true
        default:
          - defender-atp
          - forwarded
      - name: http_headers
        type: yaml
        title: Http Headers
        multi: false
        required: true
        show_user: false
        default: |
          User-Agent: MdatpPartner-Elastic-Filebeat/1.0.0
      - name: url
        type: text
        title: Url
        multi: false
        required: true
        show_user: false
        default: https://api.security.microsoft.com/api/incidents
      - name: oauth2_client_id
        type: text
        title: Oauth2 Client ID
        multi: false
        required: true
        show_user: true
        default: ""
      - name: oauth2_client_secret
        type: text
        title: Oauth2 Client Secret
        multi: false
        required: true
        show_user: true
        default: ""
      - name: oauth2_token_url
        type: text
        title: Oauth2 Token URL
        multi: false
        required: true
        show_user: true
        default: ""
  - input: logfile
    template_path: log.yml.hbs
    title: Microsoft m365_defender logs (log)
    description: Collect Microsoft m365_defender logs using log input
    vars:
      - name: tags
        type: text
        title: Tags
        multi: true
        required: true
        show_user: true
        default:
          - m365_defender
          - forwarded
