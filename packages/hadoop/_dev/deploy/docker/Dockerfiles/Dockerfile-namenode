ARG SERVICE_VERSION=${SERVICE_VERSION:-3}
FROM apache/hadoop:${SERVICE_VERSION}

ENV JOLOKIA_VERSION=1.6.0 JOLOKIA_ENABLED='yes' JOLOKIA_HOST=0.0.0.0
RUN wget "http://search.maven.org/remotecontent?filepath=org/jolokia/jolokia-jvm/${JOLOKIA_VERSION}/jolokia-jvm-${JOLOKIA_VERSION}-agent.jar" -O "jolokia-jvm-${JOLOKIA_VERSION}-agent.jar" && \
    echo "export HDFS_NAMENODE_OPTS="-javaagent\:`echo /opt/hadoop/jolokia-jvm-${JOLOKIA_VERSION}-agent.jar=host=${JOLOKIA_HOST},port=7777`"" >> "/opt/hadoop/etc/hadoop/hadoop-env.sh"
