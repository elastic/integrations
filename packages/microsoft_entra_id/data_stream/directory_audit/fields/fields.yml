- name: microsoft_entra_id.directory_audit
  type: group
  fields:
    - name: id
      type: keyword
      description: Unique identifier for the event.
    - name: category
      type: keyword
      description: Category of the event, e.g., user_management.
    - name: correlation_id
      type: keyword
      description: Correlation ID for tracking related events.
    - name: result
      type: keyword
      description: Outcome of the activity, e.g., success or failure.
    - name: result_reason
      type: text
      description: Detailed reason for the result.
    - name: activity_display_name
      type: text
      description: Name of the activity performed.
    - name: activity_date_time
      type: date
      format: date_time
      description: Timestamp of when the activity occurred.
    - name: logged_by_service
      type: keyword
      description: Service responsible for logging the event.
    - name: operation_type
      type: keyword
      description: Indicates the type of operation that was performed.
    - name: initiated_by
      type: group
      description: Details about who or what initiated the event.
      fields:
        - name: user
          type: group
          description: User who initiated the event.
          fields:
            - name: id
              type: keyword
              description: Unique identifier of the user.
            - name: display_name
              type: text
              description: Display name of the user.
            - name: user_principal_name
              type: keyword
              description: User principal name (email format).
            - name: ip_address
              type: ip
              description: IP address of the user.
        - name: app
          type: group
          description: Application that initiated the event, if applicable.
          fields:
            - name: app_id
              type: keyword
              description: Refers to the unique ID representing application in Microsoft Entra ID.
            - name: display_name
              type: text
              description: Refers to the application name displayed in the Microsoft Entra admin center.
            - name: service_principal_id
              type: keyword
              description: Refers to the unique ID for the service principal in Microsoft Entra ID.
            - name: service_principal_name
              type: keyword
              description: Refers to the Service Principal Name is the Application name in the tenant.
    - name: target_resources
      type: group
      description: List of resources targeted by the action.
      fields:
        - name: id
          type: keyword
          description: Unique identifier of the target resource.
        - name: display_name
          type: text
          description: Display name of the target resource.
        - name: type
          type: keyword
          description: Type of the target resource, e.g., group or user.
        - name: modified_properties
          type: group
          description: Properties that were modified as part of the action.
          fields:
            - name: display_name
              type: text
              description: Name of the modified property.
            - name: old_value
              type: text
              description: Previous value of the property.
            - name: new_value
              type: text
              description: Updated value of the property.
        - name: group_type
          type: keyword
          description: Type of group, e.g., unified_groups.
        - name: user_principal_name
          type: keyword
          description: User principal name if the target is a user.
    - name: additional_details
      type: group
      description: Additional details related to the event.
      fields:
        - name: key
          type: keyword
          description: Key of the additional detail.
        - name: value
          type: text
          description: Value of the additional detail.
