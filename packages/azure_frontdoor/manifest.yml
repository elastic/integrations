format_version: "3.0.2"
name: azure_frontdoor
title: "Azure Frontdoor"
version: "2.3.0"
description: "This Elastic integration collects logs from Azure Frontdoor."
type: integration
categories:
  - azure
  - cloud
  - network
  # Observability is a parent category for web
  - observability
  - security
  - web
conditions:
  kibana:
    version: "^8.13.0 || ^9.0.0"
screenshots:
  - src: /img/azure-frontdoor-overview.png
    title: Azure Frontdoor Overview
    size: 600x600
    type: image/png
icons:
  - src: /img/front-door.svg
    title: Frontdoor logo
    size: 32x32
    type: image/svg+xml
policy_templates:
  - name: azure_frontdoor
    title: Azure Frontdoor logs
    description: Collect sample logs
    inputs:
      - type: "azure-eventhub"
        title: "Collect azure frontdoor events from Event Hub"
        description: "Collecting azure frontdooor events from Azure eventhub inputs (input: azure-eventhub)."
        vars:
          - name: eventhub
            type: text
            title: Eventhub
            multi: false
            required: true
            show_user: true
          - name: consumer_group
            type: text
            title: Consumer Group
            multi: false
            required: true
            show_user: true
            default: $Default
          - name: auth_type
            type: select
            title: Authentication Type
            multi: false
            required: false
            show_user: true
            default: connection_string
            options:
              - text: Connection String (Shared Access Key)
                value: connection_string
              - text: Client Secret (OAuth2 with RBAC)
                value: client_secret
            description: >-
              Authentication method to use for Event Hub and Storage Account. When set to 'connection_string' or left blank: connection_string and storage_account_key are required. When set to 'client_secret': OAuth2 authentication with Azure AD is used, requiring tenant_id, client_id, client_secret, and eventhub_namespace. Note: The same authentication type applies to both Event Hub and Storage Account for security consistency.
          - name: connection_string
            type: password
            secret: true
            title: Connection String
            multi: false
            required: false
            show_user: true
            description: >-
              (Required when auth_type is 'connection_string' or left blank) The connection string required to communicate with Event Hubs. See [Get an Event Hubs connection string](https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-get-connection-string) to learn more.
          - name: storage_account
            type: text
            title: Storage Account
            multi: false
            required: true
            show_user: true
            description: >-
              The name of the storage account where the consumer group's state/offsets will be stored and updated.
          - name: eventhub_namespace
            type: text
            title: Event Hub Namespace
            multi: false
            required: false
            show_user: true
            description: >-
              (Required when auth_type is 'client_secret') Fully qualified Event Hub namespace (e.g., namespace.servicebus.windows.net). Do not use the short namespace name; use the complete FQDN.
          - name: tenant_id
            type: text
            title: Tenant ID
            multi: false
            required: false
            show_user: true
            description: >-
              (Required when auth_type is 'client_secret') Azure AD (Microsoft Entra ID) tenant ID. This is the directory/tenant where your Azure AD application is registered.
          - name: client_id
            type: text
            title: Client ID
            multi: false
            required: false
            show_user: true
            description: >-
              (Required when auth_type is 'client_secret') Azure AD application (client) ID. The service principal must have 'Azure Event Hubs Data Receiver' role on the Event Hub and 'Storage Blob Data Contributor' role on the Storage Account.
          - name: client_secret
            type: password
            secret: true
            title: Client Secret
            multi: false
            required: false
            show_user: true
            description: >-
              (Required when auth_type is 'client_secret') Azure AD application client secret. Generate this secret in your Azure AD app registration.
          - name: authority_host
            type: text
            title: Authority Host
            multi: false
            required: false
            show_user: false
            default: https://login.microsoftonline.com
            description: >-
              (Optional, for OAuth2) Azure AD authority endpoint. Defaults to https://login.microsoftonline.com (Azure Public Cloud). Change for other Azure environments: Azure Government (https://login.microsoftonline.us), Azure China (https://login.chinacloudapi.cn), or Azure Germany (https://login.microsoftonline.de).
          - name: storage_account_key
            type: password
            secret: true
            title: Storage Account Key
            multi: false
            required: false
            show_user: true
            description: >-
              (Required when auth_type is 'connection_string' or left blank) The storage account key used to authorize access to data in your storage account. Not used when auth_type is 'client_secret'; OAuth2 is used for storage authentication instead.
          - name: resource_manager_endpoint
            type: text
            title: Resource Manager Endpoint
            multi: false
            required: false
            show_user: true
owner:
  github: elastic/security-service-integrations
  type: community
