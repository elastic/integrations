rules:
  - path: /oauth/token
    methods: ['POST']
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |
          {"access_token":"xxxx","expires_in":3600,"token_type":"Bearer","refresh_token":"yyyy"}
  - path: /graphql
    methods: ['POST']
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    request_body: /.*"after":null.*/
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
        body: |
          {"data": {"issues": {"nodes": [{"createdAt": "2023-08-23T07:56:09.903743Z","dueAt": "2023-08-30T21:00:00Z","entitySnapshot": {"cloudPlatform": "Kubernetes","cloudProviderURL": "https://portal.az.com/#@sectest.on.com/resource//subscriptions/","externalId": "k8s/clusterrole/aaa8e7ca2bf9bc85a75d5bbdd8ffd08d69f8852782a6341c3c3519sad45/system:aggregate-to-edit/12","id": "e507d472-b7da-5f05-9b25-72a271336b14","name": "system:aggregate-to-edit","nativeType": "ClusterRole","providerId": "k8s/clusterrole/aaa8e7ca2bf9bc85a75d5bbdd8ffd08d69f8852782a6341c3c3519bac0f24ae9/system:aggregate-to-edit/12","region": "us-01","resourceGroupExternalId": "/subscriptions/cfd132be-3bc7-4f86-8efd-ed53ae498fec/resourcegroups/test-selfmanaged-eastus","status": "Active","subscriptionExternalId": "998231069301","subscriptionName": "demo-integrations","subscriptionTags": {},"tags": {"kubernetes.io/bootstrapping": "rbac-defaults","rbac.authorization.k8s.io/aggregate-to-edit": "true"},"type": "ACCESS_ROLE"},"id": "fff9cffd-64a7-412c-9535-cf837f4b0b40","notes": [{"createdAt": "2023-08-23T07:56:09.903743Z","serviceAccount": {"name": "rev-ke"},"text": "updated","updatedAt": "2023-08-09T23:10:22.588721Z"},{"createdAt": "2023-08-09T23:08:49.918941Z","serviceAccount": {"name": "rev-ke2"},"text": "updated","updatedAt": "2023-08-09T23:10:22.591487Z"}],"projects": [{"businessUnit": "","id": "83b76efe-a7b6-5762-8a53-8e8f59e68bd8","name": "Project 2","riskProfile": {"businessImpact": "MBI"},"slug": "project-2"},{"businessUnit": "Dev","id": "af52828c-4eb1-5c4e-847c-ebc3a5ead531","name": "project 4","riskProfile": {"businessImpact": "MBI"},"slug": "project-4"},{"businessUnit": "Dev","id": "d6ac50bb-aec0-52fc-80ab-bacd7b02f178","name": "Project1","riskProfile": {"businessImpact": "MBI"},"slug": "project1"}],"resolvedAt": "2023-08-09T23:10:22.588721Z","serviceTickets": [{"externalId": "638361121bbfdd10f6c1cbf3604bcb7e","name": "SIR0010002","url": "https://ven05658.testing.com/nav_to.do?uri=%2Fsn_si_incident.do%3Fsys_id%3D6385248sdsae421"}],"severity": "INFORMATIONAL","sourceRule": {"__typename": "Control","controlDescription": "These EKS principals assume roles that provide bind, escalate and impersonate permissions. \n\nThe `bind` permission allows users to create bindings to roles with rights they do not already have. The `escalate` permission allows users effectively escalate their privileges. The `impersonate` permission allows users to impersonate and gain the rights of other users in the cluster. Running containers with these permissions has the potential to effectively allow privilege escalation to the cluster-admin level.","id": "wc-id-1335","name": "EKS principals assume roles that provide bind, escalate and impersonate permissions","resolutionRecommendation": "To follow the principle of least privilege and minimize the risk of unauthorized access and data breaches, it is recommended not to grant `bind`, `escalate` or `impersonate` permissions.","securitySubCategories": [{"category": {"framework": {"name": "CIS EKS 1.2.0"},"name": "4.1 RBAC and Service Accounts"},"title": "4.1.8 Limit use of the Bind, Impersonate and Escalate permissions in the Kubernetes cluster - Level 1 (Manual)"},{"category": {"framework": {"name": "Wiz for Risk Assessment"},"name": "Identity Management"},"title": "Privileged principal"},{"category": {"framework": {"name": "Wiz"},"name": "9 Container Security"},"title": "Container Security"},{"category": {"framework": {"name": "Wiz for Risk Assessment"},"name": "Container & Kubernetes Security"},"title": "Cluster misconfiguration"}]},"status": "IN_PROGRESS","statusChangedAt": "2023-07-31T06:26:08.708199Z","updatedAt": "2023-08-14T06:06:18.331647Z"},{"id": "fffe7a37-d47f-49cd-873a-ccebd509050b","sourceRule": {"__typename": "Control","id": "9d7ef6e4-baed-47ba-99ec-a78a801f1e19","name": "Publicly Exposed Assets with DataFindings ","controlDescription": "","resolutionRecommendation": "","securitySubCategories": [{"title": "Data Security","category": {"name": "8 Data Security","framework": {"name": "Wiz"}}}]},"createdAt": "2023-08-23T07:56:09.903743Z","updatedAt": "2023-08-30T08:17:54.613564Z","dueAt": null,"resolvedAt": "2023-08-30T08:17:54.613564Z","statusChangedAt": "2023-08-30T08:17:54.613564Z","projects": [{"id": "83b76efe-a7b6-5762-8a53-8e8f59e68bd8","name": "Project 2","slug": "project-2","businessUnit": "","riskProfile": {"businessImpact": "MBI"}},{"id": "af52828c-4eb1-5c4e-847c-ebc3a5ead531","name": "project 4","slug": "project-4","businessUnit": "Dev","riskProfile": {"businessImpact": "MBI"}},{"id": "d6ac50bb-aec0-52fc-80ab-bacd7b02f178","name": "Project1","slug": "project1","businessUnit": "Dev","riskProfile": {"businessImpact": "MBI"}}],"status": "RESOLVED","severity": "HIGH","entitySnapshot": {"id": "36c6a09d-1b56-51d1-af4e-28f8fba35254","type": "DATA_FINDING","nativeType": "","name": "GDPR 3569","status": null,"cloudPlatform": null,"cloudProviderURL": "","providerId": "data##wizt-recEIECHXqlRPMZRw##ja63-kx0z-f27x-mpvl","region": "","resourceGroupExternalId": "","subscriptionExternalId": "","subscriptionName": "","subscriptionTags": null,"tags": {},"externalId": "data##wizt-recEIECHXqlRPMZRw##ja63-kx0z-f27x-mpvl"},"serviceTickets": [],"notes": []},{"id": "fffe17a2-4864-4d9a-ac94-7cb9e997c8e9","sourceRule": {"__typename": "Control","id": "9d7ef6e4-baed-47ba-99ec-a78a801f1e19","name": "Publicly Exposed Assets with DataFindings ","controlDescription": "","resolutionRecommendation": "","securitySubCategories": [{"title": "Data Security","category": {"name": "8 Data Security","framework": {"name": "Wiz"}}}]},"createdAt": "2023-08-23T07:56:09.903743Z","updatedAt": "2023-08-30T08:17:54.613564Z","dueAt": null,"resolvedAt": "2023-08-30T08:17:54.613564Z","statusChangedAt": "2023-08-30T08:17:54.613564Z","projects": [{"id": "83b76efe-a7b6-5762-8a53-8e8f59e68bd8","name": "Project 2","slug": "project-2","businessUnit": "","riskProfile": {"businessImpact": "MBI"}},{"id": "af52828c-4eb1-5c4e-847c-ebc3a5ead531","name": "project 4","slug": "project-4","businessUnit": "Dev","riskProfile": {"businessImpact": "MBI"}},{"id": "d6ac50bb-aec0-52fc-80ab-bacd7b02f178","name": "Project1","slug": "project1","businessUnit": "Dev","riskProfile": {"businessImpact": "MBI"}}],"status": "RESOLVED","severity": "HIGH","entitySnapshot": {"id": "264cb64b-4243-5f25-b1fd-8abb4fbe5e15","type": "DATA_FINDING","nativeType": "","name": "GDPR 2699","status": null,"cloudPlatform": null,"cloudProviderURL": "","providerId": "data##wizt-recEIECHXqlRPMZRw##tefj-nqup-p84u-cgx6","region": "","resourceGroupExternalId": "","subscriptionExternalId": "","subscriptionName": "","subscriptionTags": null,"tags": {},"externalId": "data##wizt-recEIECHXqlRPMZRw##tefj-nqup-p84u-cgx6"},"serviceTickets": [],"notes": []}],"pageInfo": {"hasNextPage": true,"endCursor": "eyJmaWVsZHMiOlt7IkZpZWxkIjoiVGltZXN0YW1wIiwiVmFsdWUiOiIyMDIzLTA5LTA0VDExOjE5OjM3LjgwMTU0MVoifV19"}}}}
  - path: /graphql
    methods: ['POST']
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    request_body: /.*"after":"eyJmaWVsZHMiOlt7IkZpZWxkIjoiVGltZXN0YW1wIiwiVmFsdWUiOiIyMDIzLTA5LTA0VDExOjE5OjM3LjgwMTU0MVoifV19".*/
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
        body: |
          {"data": {"issues": {"nodes": [{"createdAt": "2023-08-21T07:56:09.903743Z","dueAt": "2023-08-28T21:00:00Z","entitySnapshot": {"cloudPlatform": "Kubernetes","cloudProviderURL": "https://portal.az.com/#@sectest.on.com/resource//subscriptions/","externalId": "k8s/clusterrole/aaa8e7ca2bf9bc85a75d5bbdd8ffd08d69f8852782a6341c3c3519sad45/system:aggregate-to-edit/12","id": "f307d472-b7da-5t05-9b25-71a271336b14","name": "system:aggregate-to-edit","nativeType": "ClusterRole","providerId": "k8s/clusterrole/aaa8e7ca2bf9bc85a75d5bbdd8ffd08d69f8852782a6341c3c3519bac0f24ae9/system:aggregate-to-edit/12","region": "us-01","resourceGroupExternalId": "/subscriptions/cfd132be-3bc7-4f86-8efd-ed53ae498fec/resourcegroups/test-selfmanaged-eastus","status": "Active","subscriptionExternalId": "998231069301","subscriptionName": "demo-integrations","subscriptionTags": {},"tags": {"kubernetes.io/bootstrapping": "rbac-defaults","rbac.authorization.k8s.io/aggregate-to-edit": "true"},"type": "ACCESS_ROLE"},"id": "ggf9cggd-64a7-412c-9445-cf837f4b0b10","notes": [{"createdAt": "2023-08-21T07:56:09.903743Z","serviceAccount": {"name": "rev-ke"},"text": "updated","updatedAt": "2023-09-09T23:10:22.588721Z"},{"createdAt": "2023-08-07T23:08:49.918941Z","serviceAccount": {"name": "rev-ke2"},"text": "updated","updatedAt": "2023-08-09T23:10:22.591487Z"}],"projects": [{"businessUnit": "","id": "jf77n35n-a7b6-5762-8a53-8e8f59e68bd8","name": "Project 2","riskProfile": {"businessImpact": "MBI"},"slug": "project-2"},{"businessUnit": "Dev","id": "af52828c-4eb1-5c4e-847c-ebc3a5ead531","name": "project 4","riskProfile": {"businessImpact": "MBI"},"slug": "project-4"},{"businessUnit": "Dev","id": "d5h1545-aec0-52fc-80ab-bacd7b02f178","name": "Project1","riskProfile": {"businessImpact": "MBI"},"slug": "project1"}],"resolvedAt": "2023-08-09T23:10:22.588721Z","serviceTickets": [{"externalId": "638361121bbfdd10f6c1cbf3604bcb7e","name": "SIR0010002","url": "https://ven05658.testing.com/nav_to.do?uri=%2Fsn_si_incident.do%3Fsys_id%3D6385248sdsae421"}],"severity": "INFORMATIONAL","sourceRule": {"__typename": "Control","controlDescription": "These EKS principals assume roles that provide bind, escalate and impersonate permissions. \n\nThe `bind` permission allows users to create bindings to roles with rights they do not already have. The `escalate` permission allows users effectively escalate their privileges. The `impersonate` permission allows users to impersonate and gain the rights of other users in the cluster. Running containers with these permissions has the potential to effectively allow privilege escalation to the cluster-admin level.","id": "wc-id-1335","name": "EKS principals assume roles that provide bind, escalate and impersonate permissions","resolutionRecommendation": "To follow the principle of least privilege and minimize the risk of unauthorized access and data breaches, it is recommended not to grant `bind`, `escalate` or `impersonate` permissions.","securitySubCategories": [{"category": {"framework": {"name": "CIS EKS 1.2.0"},"name": "4.1 RBAC and Service Accounts"},"title": "4.1.8 Limit use of the Bind, Impersonate and Escalate permissions in the Kubernetes cluster - Level 1 (Manual)"},{"category": {"framework": {"name": "Wiz for Risk Assessment"},"name": "Identity Management"},"title": "Privileged principal"},{"category": {"framework": {"name": "Wiz"},"name": "9 Container Security"},"title": "Container Security"},{"category": {"framework": {"name": "Wiz for Risk Assessment"},"name": "Container & Kubernetes Security"},"title": "Cluster misconfiguration"}]},"status": "IN_PROGRESS","statusChangedAt": "2023-07-21T06:26:08.708199Z","updatedAt": "2023-08-14T06:06:18.331647Z"},{"id": "fffe7a37-d47f-49cd-873a-ccebd509050b","sourceRule": {"__typename": "Control","id": "9d7ef6e4-baed-47ba-99ec-a78a801f1e19","name": "Publicly Exposed Assets with DataFindings ","controlDescription": "","resolutionRecommendation": "","securitySubCategories": [{"title": "Data Security","category": {"name": "8 Data Security","framework": {"name": "Wiz"}}}]},"createdAt": "2023-08-23T07:56:09.903743Z","updatedAt": "2023-08-30T08:17:54.613564Z","dueAt": null,"resolvedAt": "2023-08-30T08:17:54.613564Z","statusChangedAt": "2023-08-30T08:17:54.613564Z","projects": [{"id": "83c76efe-a7b6-5762-8a53-8e8f59e68bd8","name": "Project 2","slug": "project-2","businessUnit": "","riskProfile": {"businessImpact": "MBI"}},{"id": "af52828c-4eb1-5c4e-847c-ebc3a5ead531","name": "project 4","slug": "project-4","businessUnit": "Dev","riskProfile": {"businessImpact": "MBI"}},{"id": "d6ac50bb-aec0-52fc-80ab-bacd7b02f178","name": "Project1","slug": "project1","businessUnit": "Dev","riskProfile": {"businessImpact": "MBI"}}],"status": "RESOLVED","severity": "HIGH","entitySnapshot": {"id": "36c6a09d-1b56-51d1-af4e-28f8fba35254","type": "DATA_FINDING","nativeType": "","name": "GDPR 3569","status": null,"cloudPlatform": null,"cloudProviderURL": "","providerId": "data##wizt-recEIECHXqlRPMZRw##ja63-kx0z-f27x-mpvl","region": "","resourceGroupExternalId": "","subscriptionExternalId": "","subscriptionName": "","subscriptionTags": null,"tags": {},"externalId": "data##wizt-recEIECHXqlRPMZRw##ja63-kx0z-f27x-mpvl"},"serviceTickets": [],"notes": []},{"id": "fffe17a2-4864-4d9a-ac94-7cb9e997c8e9","sourceRule": {"__typename": "Control","id": "9d7ef6e4-baed-47ba-99ec-a78a801f1e19","name": "Publicly Exposed Assets with DataFindings ","controlDescription": "","resolutionRecommendation": "","securitySubCategories": [{"title": "Data Security","category": {"name": "8 Data Security","framework": {"name": "Wiz"}}}]},"createdAt": "2023-08-27T07:56:09.903743Z","updatedAt": "2023-08-30T08:17:54.613564Z","dueAt": null,"resolvedAt": "2023-08-30T08:17:54.613564Z","statusChangedAt": "2023-08-30T08:17:54.613564Z","projects": [{"id": "83b74efe-a7b6-5762-8a53-8e8f59e68bd8","name": "Project 2","slug": "project-2","businessUnit": "","riskProfile": {"businessImpact": "MBI"}},{"id": "af52828c-4eb1-5c4e-847c-ebc3a5ead531","name": "project 4","slug": "project-4","businessUnit": "Dev","riskProfile": {"businessImpact": "MBI"}},{"id": "d6ac50bb-aec0-52fc-80ab-bacd7b02f178","name": "Project1","slug": "project1","businessUnit": "Dev","riskProfile": {"businessImpact": "MBI"}}],"status": "RESOLVED","severity": "HIGH","entitySnapshot": {"id": "264cb64b-4243-5f25-b1fd-8abb4fbe5e15","type": "DATA_FINDING","nativeType": "","name": "GDPR 2699","status": null,"cloudPlatform": null,"cloudProviderURL": "","providerId": "data##wizt-recEIECHXqlRPMZRw##tefj-nqup-p84u-cgx6","region": "","resourceGroupExternalId": "","subscriptionExternalId": "","subscriptionName": "","subscriptionTags": null,"tags": {},"externalId": "data##wizt-recEIECHXqlRPMZRw##tefj-nqup-p84u-cgx6"},"serviceTickets": [],"notes": []}],"pageInfo": {"hasNextPage": false,"endCursor": "eyYmpRVsZHMiOlt7IkZpZWxkItpiVGltZXN0YW1wIiwiVmFsdWUiOiIyMDIzLTA5LTA0VDExOjE5OjM3LjgwMTU0MVoifV19"}}}}
