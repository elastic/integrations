---
description: Pipeline for parsing specific fields related to volumen mount events in Jamf Protect
processors:

##########################
## ECS Event Specific ##
##########################
    - set:
        field: event.reason
        value: A file system has been mounted
    - append:
        field: event.type
        value: start
    - rename:
        field: jamf_protect.telemetry.event.mount.statfs.f_mntfromname
        target_field: volume.device_name
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.mount.statfs.f_mntonname
        target_field: volume.mount_name
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.mount.statfs.f_fstypename
        target_field: volume.file_system_type
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.mount.device.size
        target_field: volume.size
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.mount.device.bus_name
        target_field: volume.bus_type
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.mount.device.product_id
        target_field: volume.product_id
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.mount.device.product_name
        target_field: volume.product_name
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.mount.device.vendor_id
        target_field: volume.vendor_id
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.mount.device.vendor_name
        target_field: volume.vendor_name
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.mount.device.protocol
        target_field: volume.device_type
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.mount.device.is_removable
        target_field: volume.removable
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.mount.device.is_writable
        target_field: volume.writable
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.mount.device.serial_number
        target_field: volume.serial_number
        ignore_missing: true
##########################
## ECS Process ##
##########################
    - pipeline:
        name: '{{ IngestPipeline "pipeline_object_process" }}'