---
description: Pipeline for parsing specific fields related to xprotect malware remediated events in Jamf Protect
processors:

##########################
## ECS Event Specific ##
##########################
    - set:
        field: event.reason
        value: Appleâ€™s XProtect remediated malware on the system
    - append:
        field: event.category
        value: malware  
    - script:
        lang: painless
        source: >
            ctx.event = ctx.event != null ? ctx.event : new HashMap();
            if (ctx.jamf_protect?.telemetry?.event?.xp_malware_remediated?.success instanceof boolean) {
              if (ctx.jamf_protect.telemetry.event.xp_malware_remediated.success) {
                ctx.event.outcome = 'success';
              } else {
                ctx.event.outcome = 'failure';
              }
            }
            if (ctx.event.outcome == null) {
              ctx.event.outcome = 'unknown';
            }
    - rename:
        field: jamf_protect.telemetry.event.xp_malware_remediated.remediated_path
        target_field: threat.indicator.file.path
        ignore_missing: true
    - set:
        field: threat.indicator.type
        value: file
    - rename:
        field: jamf_protect.telemetry.event.xp_malware_remediated.malware_identifier
        target_field: rule.name
        ignore_missing: true
    - rename:
        field: jamf_protect.telemetry.event.xp_malware_remediated.signature_version
        target_field: rule.version
        ignore_missing: true
##########################
## ECS Process ##
##########################
    - pipeline:
        name: '{{ IngestPipeline "pipeline_object_process" }}'
