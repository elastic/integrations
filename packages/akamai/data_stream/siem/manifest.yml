title: Akamai SIEM Logs
type: logs
streams:
  - title: Akamai SIEM logs
    description: Collect Akamai logs via the SIEM API
    input: httpjson
    template_path: httpjson.yml.hbs
    vars:
      - name: api_host
        title: API Host
        type: text
        description: API Hostname in the form of http(s)://akzz-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.luna.akamaiapis.net without path
        required: true
        show_user: true
        multi: false
        default: https://akzz-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.luna.akamaiapis.net
      - name: client_token
        title: Client Token
        type: text
        description: Client token provided by "Credentials" ui
        required: true
        show_user: true
        multi: false
      - name: client_secret
        title: Client Secret
        type: password
        description: Client secret provided by "Credentials" ui
        required: true
        show_user: true
        multi: false
      - name: access_token
        title: Access Token
        type: password
        description: Access token provided by "Authorizations" ui
        required: true
        show_user: true
        multi: false
      - name: config_ids
        title: Zone ID
        type: text
        description: Unique identifier for each security configuration. To report on more than one configuration, separate integer identifiers with semicolons. ex. 12892;29182;82912
        required: true
        show_user: true
        multi: false
      - name: http_client_timeout
        title: HTTP Client Timeout
        type: text
        required: false
        show_user: true
        multi: false
        default: 60s
      - name: interval
        title: Interval
        type: text
        description: Interval at which the logs will be pulled. The value must be between 2m and 1h.
        required: true
        show_user: true
        multi: false
        default: 1h
      - name: initial_interval
        title: Initial Interval
        type: text
        description: Initial interval to poll for events.  Default is 24 hours.
        required: true
        show_user: true
        multi: false
        default: 24h
      - name: proxy_url
        title: Proxy URL
        type: text
        description: URL to proxy connections in the form of http\[s\]://<user>:<password>@<server name/ip>:<port>
        required: false
        show_user: false
        multi: false
      - name: ssl
        title: SSL
        type: yaml
        required: false
        show_user: false
        multi: false
      - name: tags
        title: Tags
        type: text
        required: true
        show_user: true
        multi: true
        default:
          - akamai-siem
          - forwarded
      - name: preserve_original_event
        title: Preserve original event
        type: bool
        description: Preserves a raw copy of the original event, added to the field `event.original`
        required: true
        show_user: true
        multi: false
        default: false
      - name: processors
        title: Processors
        type: yaml
        description: Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.
        required: false
        show_user: false
        multi: false
  - title: Collect Akamai SIEM logs via Google Cloud Storage [Beta]
    description: Collecting SIEM logs from Akamai via Google Cloud Storage.
    input: gcs
    template_path: gcs.yml.hbs
    vars:
      - name: project_id
        title: Project Id
        type: text
        description: It is a required parameter to collect logs via GCS.
        required: true
        show_user: true
        multi: false
        default: my-project-id
      - name: service_account_key
        title: Credentials json key
        type: password
        description: It is an optional parameter for authentication.
        required: false
        show_user: true
        multi: false
      - name: service_account_file
        title: Credentials file path
        type: text
        description: It is an optional parameter for authentication.
        required: false
        show_user: false
        multi: false
      - name: max_workers
        title: Maximum number of workers
        type: integer
        description: Determines how many workers are spawned per bucket.
        required: false
        show_user: true
        multi: false
        default: 3
      - name: poll
        title: Polling
        type: bool
        description: Determines if the bucket will be continuously polled for new documents.
        required: false
        show_user: true
        multi: false
        default: true
      - name: poll_interval
        title: Polling interval
        type: text
        description: Determines the time interval between polling operations.
        required: false
        show_user: true
        multi: false
        default: 15s
      - name: bucket_timeout
        title: Bucket Timeout
        type: text
        description: Defines the maximum time that the sdk will wait for a bucket api response before timing out.
        required: false
        show_user: true
        multi: false
        default: 120s
      - name: buckets
        title: Buckets
        type: yaml
        description: This attribute contains the details about a specific bucket like, name, max_workers, poll, poll_interval and bucket_timeout. The attribute 'name' is specific to a bucket as it describes the bucket name, while the fields max_workers, poll, poll_interval and bucket_timeout can exist both at the bucket level and at the global level. If you have already defined the attributes globally, then you can only specify the name in this yaml config. If you want to override any specific attribute for a specific bucket, then, you can define it here. Any attribute defined in the yaml will override the global definitions. Please see the relevant [Documentation](https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-input-gcs.html#attrib-buckets) for further information.
        required: true
        show_user: true
        default: |
          # You can define as many buckets as you want here.
          - name: siem_gcs_bucket_1
            max_workers: 3
            poll: true
            poll_interval: 10s
            bucket_timeout: 30s
          #- name: siem_gcs_bucket_2
          #  max_workers: 3
          #  poll: true
          #  poll_interval: 10s
          #  bucket_timeout: 30s
      - name: processors
        title: Processors
        type: yaml
        description: |
          Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.
        required: false
        show_user: false
        multi: false
      - name: tags
        title: Tags
        type: text
        required: true
        show_user: false
        multi: true
        default:
          - forwarded
          - akamai-siem
