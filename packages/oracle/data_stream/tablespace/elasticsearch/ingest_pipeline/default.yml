---
description: Pipeline for processing oracle performance
processors:
    - remove:
        field: sql.driver
        ignore_missing: true
        ignore_failure: true
    - remove:
        field: sql.query
        ignore_missing: true
        ignore_failure: true
    - rename:
        field: sql
        target_field: oracle
        ignore_missing: true
        ignore_failure: true
    - rename:
        field: "oracle.metrics"
        target_field: "oracle.tablespace"
        ignore_missing: true
    - rename:
        field: oracle.tablespace.file_id
        target_field: oracle.tablespace.data_file.id
        ignore_failure: true
        ignore_missing: true
    - rename:
        field: oracle.tablespace.file_name
        target_field: oracle.tablespace.data_file.name
        ignore_failure: true
        ignore_missing: true
    - rename:
        field: oracle.tablespace.status
        target_field: oracle.tablespace.data_file.status
        ignore_failure: true
        ignore_missing: true
    - rename:
        field: oracle.tablespace.online_status
        target_field: oracle.tablespace.data_file.online_status
        ignore_failure: true
        ignore_missing: true
    - rename:
        field: oracle.tablespace.bytes
        target_field: oracle.tablespace.data_file.size.bytes
        ignore_failure: true
        ignore_missing: true
    - rename:
        field: oracle.tablespace.maxbytes
        target_field: oracle.tablespace.data_file.size.max.bytes
        ignore_failure: true
        ignore_missing: true
    - rename:
        field : oracle.tablespace.user_bytes
        target_field: oracle.tablespace.data_file.size.free.bytes
        ignore_failure: true
        ignore_missing: true
    - rename:
        field : oracle.tablespace.tb_size_free
        target_field: oracle.tablespace.space.free.bytes
        ignore_failure: true
        ignore_missing: true
    - rename:
        field: oracle.tablespace.tb_size_used
        target_field: oracle.tablespace.space.used.bytes
        ignore_failure: true
        ignore_missing: true
    - rename:
        field: oracle.tablespace.tablespace_name
        target_field: oracle.tablespace.name
        ignore_failure: true
        ignore_missing: true
    - rename:
        field: oracle.tablespace.total_bytes
        target_field: oracle.tablespace.space.total.bytes
        ignore_failure: true
        ignore_missing: true

on_failure:
- set:
    field: error.message
    value: "{{ _ingest.on_failure_message }}"



#     - name: data_file
#       type: group
#       description: Database files information
#       fields:
#         - name: id
#           type: long
#           description: Tablespace unique identifier
#         - name: name
#           type: keyword
#           description: Filename of the data file
#         - name: size
#           type: group
#           description: Size information about the file
#           fields:
#             - name: max.bytes
#               format: bytes
#               type: long
#               description: Maximum file size in bytes
#             - name: bytes
#               format: bytes
#               type: long
#               description: Size of the file in bytes
#             - name: free.bytes
#               format: bytes
#               type: long
#               description: >
#                 The size of the file available for user data. The actual size of the file minus this value is used to store file related metadata.
#         - name: status
#           type: keyword
#           description: >
#             'File status: AVAILABLE or INVALID (INVALID means that the file number is not in use, for example, a file in
#             a tablespace that was dropped)'
#         - name: online_status
#           type: keyword
#           description: Last known online status of the data file. One of SYSOFF, SYSTEM, OFFLINE, ONLINE or RECOVER.

#     - name: space
#       type: group
#       description: Tablespace space usage information
#       fields:
#         - name: free.bytes
#           format: bytes
#           type: long
#           description: Tablespace total free space available, in bytes.
#         - name: used.bytes
#           format: bytes
#           type: long
#           description: Tablespace used space, in bytes.
#         - name: total.bytes
#           format: bytes
#           type: long
#           description: Tablespace total size, in bytes.
