---
description: Pipeline for Hard Drives
processors:
  - dot_expander:
      field: "*"
  - set:
      field: "@timestamp"
      value: "{{_ingest.timestamp}}"
  - set:
      field: event.ingested
      value: "{{_ingest.timestamp}}"
  - set:
      field: ecs.version
      value: 8.8.0
  - set:
      field: event.kind
      value: state
  - set:
      field: event.module
      value: tychon
  - set:
      field: event.category
      value: hard drive
  - split:
      field: host.uptime
      separator: "\\.+"
      target_field: tempuptime
  - set:
      field: host.uptime
      value: "{{tempuptime.0}}"
  - remove:
      field: tempuptime
  - convert:
      field: script.current_duration
      type: float
  - set:
      field: disk.partition_style
      value: '{{disk_partition_style}}'
  - remove:
      field: disk_partition_style
  - set:
      field: disk.number_of_partitions
      value: '{{disk_NumberOfPartitions}}'
  - remove:
      field: disk_NumberOfPartitions
  - set:
      field: disk.operational_status
      value: '{{disk_operational_status}}'
  - remove:
      field: disk_operational_status
  - set:
      field: disk.health_status
      value: '{{disk_health_status}}'
  - remove:
      field: disk_health_status
  - set:
      field: disk.highly_available
      value: '{{disk.is_highly_available}}'
  - remove:
      field: disk.is_highly_available
  - set:
      field: disk.offline
      value: '{{disk.is_offline}}'
  - remove:
      field: disk.is_offline
  - set:
      field: disk.bus_type
      value: '{{disk.bus_type}}'
  - remove:
      field: disk.bus_type
  - set:
      field: disk.adapter.serial_number
      value: '{{disk_adapter_serialnumber}}'
  - remove:
      field: disk_adapter_serialnumber
  - set:
      field: disk.adapter.serial_number
      value: '{{disk_adapter_serialnumber}}'
  - remove:
      field: disk_adapter_serialnumber
  - set:
      field: disk.size
      value: '{{disk_size}}'
  - remove:
      field: disk_size
  - set:
      field: disk.system
      value: '{{disk_system}}'
  - remove:
      field: disk_system
  - set:
      field: disk.manufacturer
      value: '{{disk_manufacturer}}'
  - remove:
      field: disk_manufacturer
  - set:
      field: disk.clustered
      value: '{{disk.is_clustered}}'
  - remove:
      field: disk.is_clustered
  - set:
      field: disk.model
      value: '{{disk_model}}'
  - remove:
      field: disk_model
  - set:
      field: disk.number
      value: '{{disk_number}}'
  - remove:
      field: disk_number
  - set:
      field: disk.location.function
      value: '{{disk_location_function}}'
  - remove:
      field: disk_location_function
  - set:
      field: disk.location.device
      value: '{{disk_location_device}}'
  - remove:
      field: disk_location_device
  - set:
      field: disk.location.bus
      value: '{{disk_location_bus}}'
  - remove:
      field: disk_location_bus
  - set:
      field: disk.location.adapter
      value: '{{disk_location_adapter}}'
  - remove:
      field: disk_location_adapter
  - set:
      field: disk.is_boot
      value: '{{disk_is_boot}}'
  - remove:
      field: disk_is_boot
  - set:
      field: disk.guid
      value: '{{disk_guid}}'
  - remove:
      field: disk_guid
  - set:
      field: disk.boot_from
      value: '{{disk_boot_from}}'
  - remove:
      field: disk_boot_from
  - convert:
      field: script.current_duration
      type: float
on_failure:
  - set:
      field: event.kind
      value: pipeline_error
  - append:
      field: error.message
      value: '{{{ _ingest.on_failure_message }}}'
 