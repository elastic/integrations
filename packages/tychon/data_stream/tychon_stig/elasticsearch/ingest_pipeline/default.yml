---
description: Pipeline for parsing TYCHON Windows Patches
processors:  
  - set:
      if: "ctx.containsKey('tychon') && ctx.tychon.containsKey('id')"
      field: 'host.id'
      value: '{{tychon.id}}'  
  - remove:
      if: "ctx.containsKey('tychon') && ctx.tychon.containsKey('id')"
      field: 'tychon'
  - set:
      if: "!(ctx.containsKey('id'))"
      field: 'id'
      value: '{{host.id}}'  
  - set:      
      field: '_id'
      value: '{{id}}'     
  - set:
      field: '@timestamp'
      value: '{{_ingest.timestamp}}'
  - set:
      field: 'rule.result'
      value: '{{rule.test_result}}'
  - remove:
      field: 'rule.test_result'        
  - set:
      field: ecs.version
      value: '8.5.1'
  - set:
      field: event.kind
      value: state
  - set:
      field: event.module
      value: tychon
  - set:
      field: event.category
      value: host
  - set:
      field: event.ingested
      value: '{{_ingest.timestamp}}'
on_failure:
  - set:
      field: error.message
      value: '{{ _ingest.on_failure_message }}'