{{- $timestamp := generate "timestamp" }}
{{- $ip := generate "client.ip" }}
{{- $hostname := generate "host.name" }}
{{- $agentId := generate "agent.id" }}
{{- $processPid := generate "process.pid" }}
{{- $processThreadId := generate "process.thread.id" }}
{{- $httpRequestMethod := generate "http.request.method" }}
{{- $httpResponseStatusCode := generate "http.response.status_code" }}
{{- $httpResponseBodyBytes := generate "http.response.body.bytes" }}
{{- $timezoneOffset := "+0100" }}
{
  "@timestamp": "{{ $timestamp.Format "2006-01-02T15:04:05.999999Z07:00" }}",
  "log.file.path": "/var/log/nginx/access.log",
  "data_stream": {
    "namespace": "ep",
    "type": "logs",
    "dataset": "nginx.access"
  },
  "message": "{{$ip}} - - [{{$timestamp | date "02/Jan/2006:15:04:05"}} {{$timezoneOffset}}] \"{{$httpRequestMethod}} /favicon.ico HTTP/1.1\" {{$httpResponseStatusCode}} {{$httpResponseBodyBytes}} \"http://localhost:8080/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.59 Safari/537.36\"",
  "event": {
    "dataset": "nginx.access"
  },
  "host": {
    "name": "{{$hostname}}"
  },
  "agent": {
    "id": "{{$agentId}}",
    "name": "{{$hostname}}",
    "type": "filebeat",
    "version": "8.8.0",
    "ephemeral_id": "{{$agentId}}"
  },
  "tags": [
    "preserve_original_event"
  ]
}