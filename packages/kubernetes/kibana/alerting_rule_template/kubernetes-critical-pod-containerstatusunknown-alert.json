{
    "id": "kubernetes-critical-pod-containerstatusunknown-alert",
    "type": "alerting_rule_template",
    "attributes": {
        "name": "[Kubernetes] Critical Pod ContainerStatusUnknown Alert",
        "tags": [
            "Kubernetes",
            "Container",
            "Status"
        ],
        "ruleTypeId": ".es-query",
        "schedule": {
            "interval": "1m"
        },
        "params": {
            "searchType": "esqlQuery",
            "timeWindowSize": 5,
            "timeWindowUnit": "m",
            "esqlQuery": {
                "esql": "// Alert when critical pods report ContainerStatusUnknown status.\n//\n// What triggers this alert:\n// Kubernetes cannot determine if containers are running, stopped, or crashed.\n//\n// Placeholders to replace:\n// - Add pod name filter for your critical pods, e.g.:\n//   AND (`kubernetes.pod.name` LIKE \"cilium*\" OR `kubernetes.pod.name` LIKE \"coredns*\")\n//\n// What it means:\n// Communication failure between Kubernetes and the container runtime.\n// May cause service disruptions, failed health checks, unpredictable pod behavior.\n//\n// Common causes:\n// Container runtime issues, node communication failure, kubelet problems.\n//\n// To reduce noise, increase the threshold (e.g., doc_count > 3).\nTS metrics-kubernetes.container-*\n| WHERE `kubernetes.container.status.reason` == \"ContainerStatusUnknown\"\n  AND `kubernetes.pod.name` IS NOT NULL\n| STATS doc_count = COUNT(*)\n  BY `orchestrator.cluster.name`, `kubernetes.pod.name`\n| WHERE doc_count > 1"
            },
            "groupBy": "row",
            "timeField": "@timestamp"
        },
        "alertDelay": {
            "active": 3
        }
    },
    "managed": true,
    "coreMigrationVersion": "8.8.0",
    "typeMigrationVersion": "10.1.0"
}
