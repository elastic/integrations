{
    "expected": [
        {
            "client": {
                "ip": [
                    "67.43.156.1"
                ]
            },
            "event": {
                "action": "get",
                "kind": "event",
                "original": "{\"kind\":\"Event\",\"apiVersion\":\"audit.k8s.io/v1\",\"level\":\"Metadata\",\"auditID\":\"abcde12345\",\"stage\":\"ResponseComplete\",\"requestURI\":\"/api/v1/namespaces/default/pods\",\"verb\":\"get\",\"user\":{\"username\":\"system:serviceaccounts:default:default\",\"uid\":\"12345678\",\"groups\":[\"system:authenticated\"]},\"sourceIPs\":[\"67.43.156.1\"],\"userAgent\":\"kubectl/v1.26.1\",\"objectRef\":{\"resource\":\"pods\",\"namespace\":\"default\",\"name\":\"my-pod\",\"apiGroup\":\"\",\"apiVersion\":\"v1\"},\"responseStatus\":{\"metadata\":{},\"code\":200},\"requestReceivedTimestamp\":\"2025-03-04T06:22:18.819232Z\",\"stageTimestamp\":\"2025-03-04T06:22:18.822532Z\",\"annotations\":{\"authorization.k8s.io/decision\":\"allow\",\"authorization.k8s.io/reason\":\"\"}}",
                "outcome": "success"
            },
            "kubernetes": {
                "audit": {
                    "annotations": {
                        "authorization_k8s_io/decision": "allow"
                    },
                    "apiVersion": "audit.k8s.io/v1",
                    "auditID": "abcde12345",
                    "kind": "Event",
                    "level": "Metadata",
                    "objectRef": {
                        "apiVersion": "v1",
                        "name": "my-pod",
                        "namespace": "default",
                        "resource": "pods"
                    },
                    "requestReceivedTimestamp": "2025-03-04T06:22:18.819232Z",
                    "requestURI": "/api/v1/namespaces/default/pods",
                    "responseStatus": {
                        "code": 200
                    },
                    "sourceIPs": [
                        "67.43.156.1"
                    ],
                    "stage": "ResponseComplete",
                    "stageTimestamp": "2025-03-04T06:22:18.822532Z",
                    "user": {
                        "groups": [
                            "system:authenticated"
                        ],
                        "uid": "12345678",
                        "username": "system:serviceaccounts:default:default"
                    },
                    "userAgent": "kubectl/v1.26.1",
                    "verb": "get"
                }
            },
            "related": {
                "ip": [
                    "67.43.156.1"
                ],
                "user": [
                    "12345678",
                    "system:serviceaccounts:default:default"
                ]
            },
            "source": {
                "ip": [
                    "67.43.156.1"
                ]
            },
            "tags": [
                "preserve_original_event"
            ],
            "user": {
                "id": "12345678",
                "name": "system:serviceaccounts:default:default"
            },
            "user_agent": {
                "original": "kubectl/v1.26.1"
            }
        },
        {
            "client": {
                "ip": [
                    "67.43.156.1"
                ]
            },
            "event": {
                "action": "get",
                "kind": "event",
                "original": "{\"kind\":\"Event\",\"apiVersion\":\"audit.k8s.io/v1\",\"level\":\"Metadata\",\"auditID\":\"abcde12345\",\"stage\":\"ResponseComplete\",\"requestURI\":\"/apis/coordination.k8s.io/v1/namespaces/kube-system/leases/elastic-agent-cluster-test\",\"verb\":\"get\",\"user\":{\"username\":\"system:serviceaccount:kube-system:elastic-agent\",\"uid\":\"12345678\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:kube-system\",\"system:authenticated\"],\"extra\":{}},\"sourceIPs\":[\"67.43.156.1\"],\"userAgent\":\"elastic-agent/v0.0.0 (linux/amd64) kubernetes/$Format\",\"objectRef\":{\"resource\":\"leases\",\"namespace\":\"kube-system\",\"name\":\"elastic-agent-cluster-test\",\"apiGroup\":\"coordination.k8s.io\",\"apiVersion\":\"v1\"},\"responseStatus\":{\"metadata\":{},\"code\":200},\"requestReceivedTimestamp\":\"2025-07-16T10:12:56.525137Z\",\"stageTimestamp\":\"2025-07-16T10:12:56.563177Z\",\"annotations\":{\"authorization.k8s.io/decision\":\"allow\",\"authorization.k8s.io/reason\":\"RBAC: allowed by RoleBinding \\\"elastic-agent/kube-system\\\" of Role \\\"elastic-agent\\\" to ServiceAccount \\\"elastic-agent/kube-system\\\"\"}}",
                "outcome": "success"
            },
            "kubernetes": {
                "audit": {
                    "annotations": {
                        "authorization_k8s_io/decision": "allow",
                        "authorization_k8s_io/reason": "RBAC: allowed by RoleBinding \"elastic-agent/kube-system\" of Role \"elastic-agent\" to ServiceAccount \"elastic-agent/kube-system\""
                    },
                    "apiVersion": "audit.k8s.io/v1",
                    "auditID": "abcde12345",
                    "kind": "Event",
                    "level": "Metadata",
                    "objectRef": {
                        "apiGroup": "coordination.k8s.io",
                        "apiVersion": "v1",
                        "name": "elastic-agent-cluster-test",
                        "namespace": "kube-system",
                        "resource": "leases"
                    },
                    "requestReceivedTimestamp": "2025-07-16T10:12:56.525137Z",
                    "requestURI": "/apis/coordination.k8s.io/v1/namespaces/kube-system/leases/elastic-agent-cluster-test",
                    "responseStatus": {
                        "code": 200
                    },
                    "sourceIPs": [
                        "67.43.156.1"
                    ],
                    "stage": "ResponseComplete",
                    "stageTimestamp": "2025-07-16T10:12:56.563177Z",
                    "user": {
                        "groups": [
                            "system:serviceaccounts",
                            "system:serviceaccounts:kube-system",
                            "system:authenticated"
                        ],
                        "uid": "12345678",
                        "username": "system:serviceaccount:kube-system:elastic-agent"
                    },
                    "userAgent": "elastic-agent/v0.0.0 (linux/amd64) kubernetes/$Format",
                    "verb": "get"
                }
            },
            "related": {
                "ip": [
                    "67.43.156.1"
                ],
                "user": [
                    "12345678",
                    "system:serviceaccount:kube-system:elastic-agent"
                ]
            },
            "source": {
                "ip": [
                    "67.43.156.1"
                ]
            },
            "tags": [
                "preserve_original_event"
            ],
            "user": {
                "id": "12345678",
                "name": "system:serviceaccount:kube-system:elastic-agent"
            },
            "user_agent": {
                "original": "elastic-agent/v0.0.0 (linux/amd64) kubernetes/$Format"
            }
        },
        {
            "client": {
                "ip": [
                    "67.43.156.1"
                ]
            },
            "event": {
                "action": "get",
                "kind": "event",
                "original": "{\"kind\":\"Event\",\"apiVersion\":\"audit.k8s.io/v1\",\"level\":\"Metadata\",\"auditID\":\"abcde12345\",\"stage\":\"ResponseComplete\",\"requestURI\":\"/apis/coordination.k8s.io/v1/namespaces/kube-system/leases/elastic-agent-cluster-test\",\"verb\":\"get\",\"user\":{\"username\":\"system:serviceaccount:kube-system:elastic-agent\",\"uid\":\"12345678\",\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:kube-system\",\"system:authenticated\"],\"extra\":{}},\"sourceIPs\":[\"67.43.156.1\"],\"userAgent\":\"elastic-agent/v0.0.0 (linux/amd64) kubernetes/$Format\",\"objectRef\":{\"resource\":\"leases\",\"namespace\":\"kube-system\",\"name\":\"elastic-agent-cluster-test\",\"apiGroup\":\"coordination.k8s.io\",\"apiVersion\":\"v1\"},\"responseStatus\":{\"metadata\":{},\"code\":200},\"requestReceivedTimestamp\":\"2025-07-16T10:12:56.525137Z\",\"stageTimestamp\":\"2025-07-16T10:12:56.563177Z\",\"annotations\":{\"authorization.k8s.io/decision\":\"allow\",\"authorization.k8s.io/reason\":\"RBAC: allowed by RoleBinding \\\"elastic-agent/kube-system\\\" of Role \\\"elastic-agent\\\" to ServiceAccount \\\"elastic-agent/kube-system\\\"\"}}",
                "outcome": "success"
            },
            "kubernetes": {
                "audit": {
                    "annotations": {
                        "authorization_k8s_io/decision": "allow",
                        "authorization_k8s_io/reason": "RBAC: allowed by RoleBinding \"elastic-agent/kube-system\" of Role \"elastic-agent\" to ServiceAccount \"elastic-agent/kube-system\""
                    },
                    "apiVersion": "audit.k8s.io/v1",
                    "auditID": "abcde12345",
                    "kind": "Event",
                    "level": "Metadata",
                    "objectRef": {
                        "apiGroup": "coordination.k8s.io",
                        "apiVersion": "v1",
                        "name": "elastic-agent-cluster-test",
                        "namespace": "kube-system",
                        "resource": "leases"
                    },
                    "requestReceivedTimestamp": "2025-07-16T10:12:56.525137Z",
                    "requestURI": "/apis/coordination.k8s.io/v1/namespaces/kube-system/leases/elastic-agent-cluster-test",
                    "responseStatus": {
                        "code": 200
                    },
                    "sourceIPs": [
                        "67.43.156.1"
                    ],
                    "stage": "ResponseComplete",
                    "stageTimestamp": "2025-07-16T10:12:56.563177Z",
                    "user": {
                        "groups": [
                            "system:serviceaccounts",
                            "system:serviceaccounts:kube-system",
                            "system:authenticated"
                        ],
                        "uid": "12345678",
                        "username": "system:serviceaccount:kube-system:elastic-agent"
                    },
                    "userAgent": "elastic-agent/v0.0.0 (linux/amd64) kubernetes/$Format",
                    "verb": "get"
                }
            },
            "related": {
                "ip": [
                    "67.43.156.1"
                ],
                "user": [
                    "12345678",
                    "system:serviceaccount:kube-system:elastic-agent"
                ]
            },
            "source": {
                "ip": [
                    "67.43.156.1"
                ]
            },
            "tags": [
                "preserve_original_event"
            ],
            "user": {
                "id": "12345678",
                "name": "system:serviceaccount:kube-system:elastic-agent"
            },
            "user_agent": {
                "original": "elastic-agent/v0.0.0 (linux/amd64) kubernetes/$Format"
            }
        },
        {
            "event": {
                "kind": "event",
                "original": "{\"protoPayload\":{\"@type\":\"type.googleapis.com/google.cloud.audit.AuditLog\",\"authenticationInfo\":{\"principalEmail\":\"system:gke-master-healthcheck\"},\"authorizationInfo\":[{\"granted\":true,\"permission\":\"io.k8s.get\",\"resource\":\"readyz\"}],\"methodName\":\"io.k8s.get\",\"requestMetadata\":{\"callerIp\":\"67.43.156.1\",\"callerSuppliedUserAgent\":\"gke-master-healthcheck\"},\"resourceName\":\"readyz\",\"serviceName\":\"k8s.io\",\"status\":{\"code\":0}},\"insertId\":\"1234abcd\",\"resource\":{\"type\":\"k8s_cluster\",\"labels\":{\"cluster_name\":\"test-cluster\",\"location\":\"us-central1\",\"project_id\":\"elastic-siem\"}},\"timestamp\":\"2025-07-13T08:38:39.127266Z\",\"labels\":{\"authorization.k8s.io/decision\":\"allow\",\"authorization.k8s.io/reason\":\"RBAC: allowed by ClusterRoleBinding \\\"system:public-info-viewer\\\" of ClusterRole \\\"system:public-info-viewer\\\" to Group \\\"system:authenticated\\\"\"},\"logName\":\"projects/elastic-siem/logs/cloudaudit.googleapis.com%2Fdata_access\",\"operation\":{\"id\":\"1234abcd\",\"producer\":\"k8s.io\",\"first\":true,\"last\":true},\"receiveTimestamp\":\"2025-07-13T08:38:41.005864307Z\"}",
                "outcome": "success"
            },
            "kubernetes": {
                "audit": {
                    "annotations": {
                        "authorization_k8s_io/decision": "allow",
                        "authorization_k8s_io/reason": "RBAC: allowed by ClusterRoleBinding \"system:public-info-viewer\" of ClusterRole \"system:public-info-viewer\" to Group \"system:authenticated\""
                    },
                    "auditID": "1234abcd",
                    "logName": "projects/elastic-siem/logs/cloudaudit.googleapis.com%2Fdata_access",
                    "operation": {
                        "first": true,
                        "id": "1234abcd",
                        "last": true,
                        "producer": "k8s.io"
                    },
                    "protoPayload": {
                        "@type": "type.googleapis.com/google.cloud.audit.AuditLog",
                        "authenticationInfo": {
                            "principalEmail": "system:gke-master-healthcheck"
                        },
                        "authorizationInfo": [
                            {
                                "granted": true,
                                "permission": "io.k8s.get",
                                "resource": "readyz"
                            }
                        ],
                        "methodName": "io.k8s.get",
                        "requestMetadata": {
                            "callerIp": "67.43.156.1",
                            "callerSuppliedUserAgent": "gke-master-healthcheck"
                        },
                        "resourceName": "readyz",
                        "serviceName": "k8s.io"
                    },
                    "requestReceivedTimestamp": "2025-07-13T08:38:41.005864307Z",
                    "resource": {
                        "labels": {
                            "cluster_name": "test-cluster",
                            "location": "us-central1",
                            "project_id": "elastic-siem"
                        },
                        "type": "k8s_cluster"
                    },
                    "responseStatus": {
                        "code": 0
                    },
                    "stageTimestamp": "2025-07-13T08:38:39.127266Z"
                }
            },
            "tags": [
                "preserve_original_event"
            ]
        }
    ]
}
