{
    "attributes": {
        "controlGroupInput": {
            "chainingSystem": "HIERARCHICAL",
            "controlStyle": "oneLine",
            "ignoreParentSettingsJSON": {
                "ignoreFilters": false,
                "ignoreQuery": false,
                "ignoreTimerange": false,
                "ignoreValidations": false
            },
            "panelsJSON": {
                "283ff494-ed87-44c1-b0cf-9eb8fdce11c4": {
                    "explicitInput": {
                        "dataViewId": "logs-*",
                        "fieldName": "source.ip",
                        "id": "283ff494-ed87-44c1-b0cf-9eb8fdce11c4",
                        "searchTechnique": "prefix",
                        "selectedOptions": [],
                        "sort": {
                            "by": "_count",
                            "direction": "desc"
                        },
                        "title": "Originating IP"
                    },
                    "grow": false,
                    "order": 0,
                    "type": "optionsListControl",
                    "width": "medium"
                }
            },
            "showApplySelections": false
        },
        "description": "",
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": {
                "filter": [
                    {
                        "$state": {
                            "store": "appState"
                        },
                        "meta": {
                            "alias": null,
                            "disabled": false,
                            "field": "observer.vendor",
                            "indexRefName": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
                            "key": "observer.vendor",
                            "negate": false,
                            "params": {
                                "query": "Corelight"
                            },
                            "type": "phrase"
                        },
                        "query": {
                            "match_phrase": {
                                "observer.vendor": "Corelight"
                            }
                        }
                    }
                ],
                "query": {
                    "language": "kuery",
                    "query": ""
                }
            }
        },
        "optionsJSON": {
            "hidePanelTitles": false,
            "syncColors": false,
            "syncCursor": true,
            "syncTooltips": false,
            "useMargins": true
        },
        "panelsJSON": [
            {
                "embeddableConfig": {
                    "description": "",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "**Navigation**\n\n**Corelight**\n\n- [Security Posture](#/dashboard/corelight-7c0946bc-acd0-4ec3-ab3b-8a92853f4a3b)\n- Data Insights\n  - [Name Resolution Insights](#/dashboard/corelight-8546a96c-86c9-4edf-9d46-88338d6ac40e)\n  - [Secure Channel Insights](#/dashboard/corelight-45197477-c13f-4e52-a5dd-fb4f53564963)\n  - [Remote Activity Insights](#/dashboard/corelight-f4864774-ed73-4b78-b861-5b8235ec12cf)\n- **Security Workflows**\n  - [Intel](#/dashboard/corelight-323b0f27-993e-4fee-ae6e-b5977d7cab11)\n  - **IP Interrogation**\n  - [Log Hunting](#/dashboard/corelight-ff07e65c-2703-4cbe-a45f-3881025352a3)\n  - [Notices](#/dashboard/corelight-f7da14f0-85db-48e8-a591-1f650af0f618)\n  - [RDP Inferences Overview](#/dashboard/corelight-2d4dc345-cbbe-4d7a-9203-5ab11c8cb5ba)\n  - [SSH Inferences Overview](#/dashboard/corelight-65a5fa91-06e4-459b-b4bb-998c85a6cf08)\n  - [Corelight Suricata IDS Alert Overview](#/dashboard/corelight-f1208ffe-d168-46d1-9531-24de523d1bfb)\n  - [VPN Insights](#/dashboard/corelight-023162b6-94da-4d8d-b1f6-de6192356cce)\n- Data Explorer\n  - [Connections](#/dashboard/corelight-eff0434c-1e27-4c02-959e-9f5d95488efb)\n  - [DNS](#/dashboard/corelight-58885f47-95e1-4242-a1ee-783de69ace17)\n  - [Files](#/dashboard/corelight-0cfc8a95-4979-4265-b9ad-91edf63f01a9)\n  - [HTTP](#/dashboard/corelight-8c5f15f7-7063-4228-be54-fb8c20b29caa)\n  - [Software](#/dashboard/corelight-40bbc19b-dd9c-4b43-a88a-e29fc8701902)\n  - [SSL and x509](#/dashboard/corelight-e4a93cfe-4b1f-44df-ab99-50c74f6f2203)\n\n[**Integrations Page**](/app/integrations/detail/corelight/overview)",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 32,
                    "i": "134aac43-ce2d-4060-b8ef-19144057e7dc",
                    "w": 11,
                    "x": 0,
                    "y": 0
                },
                "panelIndex": "134aac43-ce2d-4060-b8ef-19144057e7dc",
                "title": "Table of Contents",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                    "name": "logs-corelight.conn*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn*"
                                        }
                                    ],
                                    "layers": {
                                        "1aaffd29-2c91-47a0-8e65-e459c12f43ee": {
                                            "columns": [
                                                {
                                                    "columnId": "Count",
                                                    "fieldName": "Count",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "transport/port",
                                                    "fieldName": "transport/port",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "query": {
                                                "esql": "from logs-corelight.conn*\r\n| limit 10000\r\n| where (source.ip is not null or destination.ip is not null) and destination.port not in (80, 8080 ,443)\r\n| stats values(destination.port), values(network.transport), count() by network.transport, destination.port\r\n| eval tp = concat(`values(network.transport)`,\"/\",to_string(`values(destination.port)`))\r\n| rename `count()` as Count, tp as `transport/port`\r\n| sort Count desc\r\n| limit 10\r\n| keep Count, `transport/port`"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.conn*\r\n| limit 10000\r\n| where (source.ip is not null or destination.ip is not null) and destination.port not in (80, 8080 ,443)\r\n| stats values(destination.port), values(network.transport), count() by network.transport, destination.port\r\n| eval tp = concat(`values(network.transport)`,\"/\",to_string(`values(destination.port)`))\r\n| rename `count()` as Count, tp as `transport/port`\r\n| sort Count desc\r\n| limit 10\r\n| keep Count, `transport/port`"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "None",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "Count"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "1aaffd29-2c91-47a0-8e65-e459c12f43ee",
                                        "layerType": "data",
                                        "seriesType": "bar_horizontal_stacked",
                                        "xAccessor": "transport/port"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right",
                                    "shouldTruncate": false,
                                    "showSingleSeries": true
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "description": "Connections",
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 16,
                    "i": "e02755af-5eca-4ac2-a1b0-356f39bac7b5",
                    "w": 24,
                    "x": 11,
                    "y": 0
                },
                "panelIndex": "e02755af-5eca-4ac2-a1b0-356f39bac7b5",
                "title": "Top Non-Web Protocol Usage [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                    "name": "logs-corelight.conn*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn*"
                                        }
                                    ],
                                    "layers": {
                                        "732b48bc-c9a4-4112-99b7-4d399cde08e6": {
                                            "columns": [
                                                {
                                                    "columnId": "Count",
                                                    "fieldName": "Count",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "ie",
                                                    "fieldName": "ie",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "query": {
                                                "esql": "FROM logs-corelight.conn*\r\n| LIMIT 10000\r\n| WHERE source.ip IS NOT NULL AND destination.ip IS NOT NULL\r\n| STATS VALUES(destination.ip) BY event.id\r\n| EVAL is_dest_internal_ip = CASE(CIDR_MATCH(`VALUES(destination.ip)`, \"10.0.0.0/8\")==\"true\",\"true\", CIDR_MATCH(`VALUES(destination.ip)`, \"172.16.0.0/12\")==\"true\",\"true\", CIDR_MATCH(`VALUES(destination.ip)`, \"192.168.0.0/16\")==\"true\",\"true\",\"false\")\r\n| EVAL ie=CASE(is_dest_internal_ip==\"true\", \"Internal\",is_dest_internal_ip==\"false\",\"External\",\"unknown\")\r\n| STATS COUNT() by ie\r\n| RENAME `COUNT()` as Count\r\n| KEEP Count,ie"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "FROM logs-corelight.conn*\r\n| LIMIT 10000\r\n| WHERE source.ip IS NOT NULL AND destination.ip IS NOT NULL\r\n| STATS VALUES(destination.ip) BY event.id\r\n| EVAL is_dest_internal_ip = CASE(CIDR_MATCH(`VALUES(destination.ip)`, \"10.0.0.0/8\")==\"true\",\"true\", CIDR_MATCH(`VALUES(destination.ip)`, \"172.16.0.0/12\")==\"true\",\"true\", CIDR_MATCH(`VALUES(destination.ip)`, \"192.168.0.0/16\")==\"true\",\"true\",\"false\")\r\n| EVAL ie=CASE(is_dest_internal_ip==\"true\", \"Internal\",is_dest_internal_ip==\"false\",\"External\",\"unknown\")\r\n| STATS COUNT() by ie\r\n| RENAME `COUNT()` as Count\r\n| KEEP Count,ie"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "732b48bc-c9a4-4112-99b7-4d399cde08e6",
                                        "layerType": "data",
                                        "legendDisplay": "show",
                                        "legendSize": "small",
                                        "metrics": [
                                            "Count"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "ie"
                                        ],
                                        "truncateLegend": false
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "description": "Connections",
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 16,
                    "i": "252430f9-44eb-4690-95f7-95a16f4bbce5",
                    "w": 13,
                    "x": 35,
                    "y": 0
                },
                "panelIndex": "252430f9-44eb-4690-95f7-95a16f4bbce5",
                "title": "Internal vs External [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                    "name": "logs-corelight.conn*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn*"
                                        }
                                    ],
                                    "layers": {
                                        "7c1b32eb-1a8c-49cb-952b-d6c0be0f48ab": {
                                            "columns": [
                                                {
                                                    "columnId": "Source IP",
                                                    "fieldName": "Source IP",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Destination IP",
                                                    "fieldName": "Destination IP",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Service",
                                                    "fieldName": "Service",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "UID",
                                                    "fieldName": "UID",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Country",
                                                    "fieldName": "Country",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "8a35af2a-36ab-4af1-86b7-fad39f1260e1",
                                                    "fieldName": "Bytes",
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "query": {
                                                "esql": "FROM logs-corelight.conn*\r\n| LIMIT 10000\r\n| WHERE (source.ip IS NOT NULL or destination.ip IS NOT NULL) and source.ip not in (\"0.0.0.0\", \"255.255.255.255\") and destination.ip NOT IN (\"0.0.0.0\", \"255.255.255.255\", \"192.168.0.255\") and network.bytes IS NOT NULL\r\n| STATS values(source.ip), values(destination.ip), values(network.transport), values(destination.port), values(event.id), values(destination.geo.country_iso_code), sum(network.bytes) BY source.ip, destination.ip, event.id\r\n| EVAL tp = concat(`values(network.transport)`,\"/\", to_string(`values(destination.port)`))\r\n| SORT `sum(network.bytes)` DESC\r\n| LIMIT 10\r\n| RENAME `values(source.ip)` AS `Source IP`, `values(destination.ip)` AS `Destination IP`, tp AS Service, `values(event.id)` AS UID, `values(destination.geo.country_iso_code)` AS Country, `sum(network.bytes)` AS Bytes\r\n| KEEP `Source IP`,`Destination IP`, Service, UID, Country, Bytes"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "FROM logs-corelight.conn*\r\n| LIMIT 10000\r\n| WHERE (source.ip IS NOT NULL or destination.ip IS NOT NULL) and source.ip not in (\"0.0.0.0\", \"255.255.255.255\") and destination.ip NOT IN (\"0.0.0.0\", \"255.255.255.255\", \"192.168.0.255\") and network.bytes IS NOT NULL\r\n| STATS values(source.ip), values(destination.ip), values(network.transport), values(destination.port), values(event.id), values(destination.geo.country_iso_code), sum(network.bytes) BY source.ip, destination.ip, event.id\r\n| EVAL tp = concat(`values(network.transport)`,\"/\", to_string(`values(destination.port)`))\r\n| SORT `sum(network.bytes)` DESC\r\n| LIMIT 10\r\n| RENAME `values(source.ip)` AS `Source IP`, `values(destination.ip)` AS `Destination IP`, tp AS Service, `values(event.id)` AS UID, `values(destination.geo.country_iso_code)` AS Country, `sum(network.bytes)` AS Bytes\r\n| KEEP `Source IP`,`Destination IP`, Service, UID, Country, Bytes"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "Source IP"
                                    },
                                    {
                                        "columnId": "Destination IP"
                                    },
                                    {
                                        "columnId": "Service"
                                    },
                                    {
                                        "columnId": "UID"
                                    },
                                    {
                                        "columnId": "Country"
                                    },
                                    {
                                        "columnId": "8a35af2a-36ab-4af1-86b7-fad39f1260e1",
                                        "isMetric": true,
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "7c1b32eb-1a8c-49cb-952b-d6c0be0f48ab",
                                "layerType": "data"
                            }
                        },
                        "title": "Table Source IP \u0026 Destination IP \u0026 Service \u0026 UID \u0026 Country",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "description": "Connections",
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 16,
                    "i": "e0da9ea0-fc22-44bf-be3a-e1d65d2d0626",
                    "w": 37,
                    "x": 11,
                    "y": 16
                },
                "panelIndex": "e0da9ea0-fc22-44bf-be3a-e1d65d2d0626",
                "title": "Top Connections/Services by Bytes Transferred [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "6aca573bd91405e29061774c47708367fafd5165b53f364a28649651ed65671e": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "6aca573bd91405e29061774c47708367fafd5165b53f364a28649651ed65671e",
                                    "name": "logs-corelight.http*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.http*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "6aca573bd91405e29061774c47708367fafd5165b53f364a28649651ed65671e",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.http*"
                                        }
                                    ],
                                    "layers": {
                                        "c9a98c78-20b5-410f-a58a-f7630ae5c909": {
                                            "columns": [
                                                {
                                                    "columnId": "Destination IP",
                                                    "fieldName": "Destination IP",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Source IP",
                                                    "fieldName": "Source IP",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Method",
                                                    "fieldName": "Method",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "URI",
                                                    "fieldName": "URI",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Count",
                                                    "fieldName": "Count",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "6aca573bd91405e29061774c47708367fafd5165b53f364a28649651ed65671e",
                                            "query": {
                                                "esql": "FROM logs-corelight.http*\r\n| LIMIT 10000\r\n| WHERE (source.ip IS NOT NULL or destination.ip IS NOT NULL) and http.request.method IS NOT NULL and url.path IS NOT NULL\r\n| STATS values(source.ip), values(destination.ip), values(http.request.method), values(url.path), count() BY source.ip, destination.ip, http.request.method, url.path\r\n| RENAME `values(destination.ip)` AS `Destination IP`, `values(source.ip)` AS `Source IP`, `values(http.request.method)` AS Method, url.path AS URI, `count()` AS Count\r\n| SORT Count DESC\r\n| LIMIT 10\r\n| KEEP `Destination IP`, `Source IP`, Method, URI, Count"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "FROM logs-corelight.http*\r\n| LIMIT 10000\r\n| WHERE (source.ip IS NOT NULL or destination.ip IS NOT NULL) and http.request.method IS NOT NULL and url.path IS NOT NULL\r\n| STATS values(source.ip), values(destination.ip), values(http.request.method), values(url.path), count() BY source.ip, destination.ip, http.request.method, url.path\r\n| RENAME `values(destination.ip)` AS `Destination IP`, `values(source.ip)` AS `Source IP`, `values(http.request.method)` AS Method, url.path AS URI, `count()` AS Count\r\n| SORT Count DESC\r\n| LIMIT 10\r\n| KEEP `Destination IP`, `Source IP`, Method, URI, Count"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "Destination IP"
                                    },
                                    {
                                        "columnId": "Source IP"
                                    },
                                    {
                                        "columnId": "Method"
                                    },
                                    {
                                        "columnId": "URI"
                                    },
                                    {
                                        "columnId": "Count"
                                    }
                                ],
                                "layerId": "c9a98c78-20b5-410f-a58a-f7630ae5c909",
                                "layerType": "data"
                            }
                        },
                        "title": "Table Destination IP \u0026 Source IP \u0026 Method \u0026 URI \u0026 Count",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "description": "HTTP",
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 16,
                    "i": "595e562e-912f-4e65-a623-d8e03383f69f",
                    "w": 48,
                    "x": 0,
                    "y": 32
                },
                "panelIndex": "595e562e-912f-4e65-a623-d8e03383f69f",
                "title": "Top Destination IP, Method, \u0026 URI [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-52160215-9501-4345-b378-bf711f6760cb",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "52160215-9501-4345-b378-bf711f6760cb": {
                                            "columnOrder": [
                                                "859634d7-2407-4e51-882c-f254ec707584",
                                                "a9a47c12-3db2-480c-aebf-da12ce5e3eca"
                                            ],
                                            "columns": {
                                                "859634d7-2407-4e51-882c-f254ec707584": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Source Type",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "a9a47c12-3db2-480c-aebf-da12ce5e3eca",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "event.dataset"
                                                },
                                                "a9a47c12-3db2-480c-aebf-da12ce5e3eca": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Total",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "event.dataset",
                                        "index": "444f7ca5-079b-430f-83f9-02e142da61ea",
                                        "key": "event.dataset",
                                        "negate": true,
                                        "params": [
                                            "conn",
                                            "conn_long",
                                            "conn_red",
                                            "http",
                                            "asoc:nba:event"
                                        ],
                                        "type": "phrases",
                                        "value": [
                                            "conn",
                                            "conn_long",
                                            "conn_red",
                                            "http",
                                            "asoc:nba:event"
                                        ]
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "match_phrase": {
                                                        "event.dataset": "conn"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "event.dataset": "conn_long"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "event.dataset": "conn_red"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "event.dataset": "http"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "event.dataset": "asoc:nba:event"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "52160215-9501-4345-b378-bf711f6760cb",
                                        "layerType": "data",
                                        "legendDisplay": "show",
                                        "metrics": [
                                            "a9a47c12-3db2-480c-aebf-da12ce5e3eca"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "859634d7-2407-4e51-882c-f254ec707584"
                                        ],
                                        "truncateLegend": false
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "description": "Corelight Data Sets",
                    "enhancements": {}
                },
                "gridData": {
                    "h": 15,
                    "i": "a233d9ad-ed3b-43b6-a9d2-e09f5bed2909",
                    "w": 16,
                    "x": 0,
                    "y": 48
                },
                "panelIndex": "a233d9ad-ed3b-43b6-a9d2-e09f5bed2909",
                "title": "Corelight supporting data sources for source [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-0788e779-0872-44ba-9213-845a3c08314e",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "0788e779-0872-44ba-9213-845a3c08314e": {
                                            "columnOrder": [
                                                "e7fdf5cc-6e6a-46cd-8a12-3909efdab796",
                                                "bf8491a3-bf72-4e7b-af81-70eeceb30dfc"
                                            ],
                                            "columns": {
                                                "bf8491a3-bf72-4e7b-af81-70eeceb30dfc": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "e7fdf5cc-6e6a-46cd-8a12-3909efdab796": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "User Agent",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "bf8491a3-bf72-4e7b-af81-70eeceb30dfc",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "asc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "user_agent.original"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "event.dataset",
                                        "index": "e1d561aa-25f3-4fbb-ab01-4054b54d0c86",
                                        "key": "event.dataset",
                                        "negate": false,
                                        "params": [
                                            "http",
                                            "http_red",
                                            "http2"
                                        ],
                                        "type": "phrases",
                                        "value": [
                                            "http",
                                            "http_red",
                                            "http2"
                                        ]
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "match_phrase": {
                                                        "event.dataset": "http"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "event.dataset": "http_red"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "event.dataset": "http2"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.vendor",
                                        "index": "76b26419-9095-4bf6-be35-c6871285ffa5",
                                        "key": "observer.vendor",
                                        "negate": false,
                                        "params": {
                                            "query": "Corelight"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "observer.vendor": "Corelight"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "0788e779-0872-44ba-9213-845a3c08314e",
                                        "layerType": "data",
                                        "legendDisplay": "show",
                                        "legendSize": "small",
                                        "metrics": [
                                            "bf8491a3-bf72-4e7b-af81-70eeceb30dfc"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "e7fdf5cc-6e6a-46cd-8a12-3909efdab796"
                                        ],
                                        "truncateLegend": true
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "description": "HTTP",
                    "enhancements": {}
                },
                "gridData": {
                    "h": 15,
                    "i": "a8d539b0-630b-4bb1-81bf-cdab96ab15f4",
                    "w": 19,
                    "x": 16,
                    "y": 48
                },
                "panelIndex": "a8d539b0-630b-4bb1-81bf-cdab96ab15f4",
                "title": "Rare User Agents [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": "HTTP",
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-f11ee224-877f-44e5-a64e-e22f18d5ac56",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "f11ee224-877f-44e5-a64e-e22f18d5ac56": {
                                            "columnOrder": [
                                                "465056e4-e838-4666-92da-097d0b77c092",
                                                "7f11c325-9e9f-4952-9625-ace7fa04eb8f"
                                            ],
                                            "columns": {
                                                "465056e4-e838-4666-92da-097d0b77c092": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": true,
                                                    "label": "Destination Port",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        },
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "7f11c325-9e9f-4952-9625-ace7fa04eb8f",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 3
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "destination.port"
                                                },
                                                "7f11c325-9e9f-4952-9625-ace7fa04eb8f": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "event.dataset",
                                        "index": "a0e55d4a-d548-4d69-97f0-d43090275ba9",
                                        "key": "event.dataset",
                                        "negate": false,
                                        "params": [
                                            "conn",
                                            "conn_long",
                                            "conn_red"
                                        ],
                                        "type": "phrases"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "match_phrase": {
                                                        "event.dataset": "conn"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "event.dataset": "conn_long"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "event.dataset": "conn_red"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.vendor",
                                        "index": "5f695c0d-e064-4010-8391-56f57ab7ae44",
                                        "key": "observer.vendor",
                                        "negate": false,
                                        "params": {
                                            "query": "Corelight"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "observer.vendor": "Corelight"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "destination.port",
                                        "index": "4a02769b-f355-4b0d-bd04-e5fa08518bbd",
                                        "key": "destination.port",
                                        "negate": false,
                                        "params": [
                                            "80",
                                            "8080",
                                            "443"
                                        ],
                                        "type": "phrases"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "match_phrase": {
                                                        "destination.port": "80"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "destination.port": "8080"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "destination.port": "443"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "f11ee224-877f-44e5-a64e-e22f18d5ac56",
                                        "layerType": "data",
                                        "legendDisplay": "show",
                                        "metrics": [
                                            "7f11c325-9e9f-4952-9625-ace7fa04eb8f"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "465056e4-e838-4666-92da-097d0b77c092"
                                        ],
                                        "truncateLegend": false
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "description": "HTTP",
                    "enhancements": {}
                },
                "gridData": {
                    "h": 15,
                    "i": "9de567b6-f0f4-40be-a429-bec8357697d5",
                    "w": 13,
                    "x": 35,
                    "y": 48
                },
                "panelIndex": "9de567b6-f0f4-40be-a429-bec8357697d5",
                "title": "Web Ports Breakdown [Logs Corelight]",
                "type": "lens"
            }
        ],
        "timeRestore": false,
        "title": "[Logs Corelight] IP Interrogation",
        "version": 2
    },
    "coreMigrationVersion": "8.8.0",
    "created_at": "2025-01-29T12:29:11.476Z",
    "id": "corelight-3a4a279f-f238-47de-90ba-f643c5647fde",
    "managed": false,
    "references": [
        {
            "id": "logs-*",
            "name": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a233d9ad-ed3b-43b6-a9d2-e09f5bed2909:indexpattern-datasource-layer-52160215-9501-4345-b378-bf711f6760cb",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a8d539b0-630b-4bb1-81bf-cdab96ab15f4:indexpattern-datasource-layer-0788e779-0872-44ba-9213-845a3c08314e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "9de567b6-f0f4-40be-a429-bec8357697d5:indexpattern-datasource-layer-f11ee224-877f-44e5-a64e-e22f18d5ac56",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_283ff494-ed87-44c1-b0cf-9eb8fdce11c4:optionsListDataView",
            "type": "index-pattern"
        }
    ],
    "type": "dashboard",
    "typeMigrationVersion": "10.2.0",
    "updated_by": "u_mGBROF_q5bmFCATbLXAcCwKa0k8JvONAwSruelyKA5E_0"
}