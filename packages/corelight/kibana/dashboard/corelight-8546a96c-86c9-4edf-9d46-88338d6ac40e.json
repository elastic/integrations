{
    "attributes": {
        "controlGroupInput": {
            "chainingSystem": "HIERARCHICAL",
            "controlStyle": "oneLine",
            "ignoreParentSettingsJSON": {
                "ignoreFilters": false,
                "ignoreQuery": false,
                "ignoreTimerange": false,
                "ignoreValidations": false
            },
            "panelsJSON": {
                "597c5dc5-3e91-4307-8a43-32592d3367d0": {
                    "explicitInput": {
                        "dataViewId": "logs-*",
                        "fieldName": "observer.hostname",
                        "id": "597c5dc5-3e91-4307-8a43-32592d3367d0",
                        "searchTechnique": "prefix",
                        "selectedOptions": [],
                        "sort": {
                            "by": "_count",
                            "direction": "desc"
                        },
                        "title": "Sensor"
                    },
                    "grow": true,
                    "order": 0,
                    "type": "optionsListControl",
                    "width": "medium"
                }
            },
            "showApplySelections": false
        },
        "description": "",
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": {
                "filter": [],
                "query": {
                    "language": "kuery",
                    "query": ""
                }
            }
        },
        "optionsJSON": {
            "hidePanelTitles": false,
            "syncColors": false,
            "syncCursor": true,
            "syncTooltips": false,
            "useMargins": true
        },
        "panelsJSON": [
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "hidePanelTitles": false,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "id": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "**Navigation**\n\n**Corelight**\n\n- [Security Posture](#/dashboard/corelight-7c0946bc-acd0-4ec3-ab3b-8a92853f4a3b)\n- **Data Insights**\n  - **Name Resolution Insights**\n  - [Secure Channel Insights](#/dashboard/corelight-45197477-c13f-4e52-a5dd-fb4f53564963)\n  - [Remote Activity Insights](#/dashboard/corelight-f4864774-ed73-4b78-b861-5b8235ec12cf)\n- Security Workflows\n  - [Intel](#/dashboard/corelight-323b0f27-993e-4fee-ae6e-b5977d7cab11)\n  - [IP Interrogation](#/dashboard/corelight-3a4a279f-f238-47de-90ba-f643c5647fde)\n  - [Log Hunting](#/dashboard/corelight-ff07e65c-2703-4cbe-a45f-3881025352a3)\n  - [Notices](#/dashboard/corelight-f7da14f0-85db-48e8-a591-1f650af0f618)\n  - [RDP Inferences Overview](#/dashboard/corelight-2d4dc345-cbbe-4d7a-9203-5ab11c8cb5ba)\n  - [SSH Inferences Overview](#/dashboard/corelight-65a5fa91-06e4-459b-b4bb-998c85a6cf08)\n  - [Corelight Suricata IDS Alert Overview](#/dashboard/corelight-f1208ffe-d168-46d1-9531-24de523d1bfb)\n  - [VPN Insights](#/dashboard/corelight-023162b6-94da-4d8d-b1f6-de6192356cce)\n- Data Explorer\n  - [Connections](#/dashboard/corelight-eff0434c-1e27-4c02-959e-9f5d95488efb)\n  - [DNS](#/dashboard/corelight-58885f47-95e1-4242-a1ee-783de69ace17)\n  - [Files](#/dashboard/corelight-0cfc8a95-4979-4265-b9ad-91edf63f01a9)\n  - [HTTP](#/dashboard/corelight-8c5f15f7-7063-4228-be54-fb8c20b29caa)\n  - [Software](#/dashboard/corelight-40bbc19b-dd9c-4b43-a88a-e29fc8701902)\n  - [SSL and x509](#/dashboard/corelight-e4a93cfe-4b1f-44df-ab99-50c74f6f2203)\n\n[**Integrations Page**](/app/integrations/detail/corelight/overview)",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 29,
                    "i": "55f817d6-cbfd-4e16-9621-fc14df6a215b",
                    "w": 12,
                    "x": 0,
                    "y": 0
                },
                "panelIndex": "55f817d6-cbfd-4e16-9621-fc14df6a215b",
                "title": "Table of Contents",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "description": "",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "id": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## DNS Hygiene",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 5,
                    "i": "1d899748-4702-43fe-b613-1c193501840f",
                    "w": 36,
                    "x": 12,
                    "y": 0
                },
                "panelIndex": "1d899748-4702-43fe-b613-1c193501840f",
                "title": "DNS Hygiene [Logs Corelight]",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "30745a83f179da5f11b16656250be0a248d7293f796a233331383a8b71ff135a": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "30745a83f179da5f11b16656250be0a248d7293f796a233331383a8b71ff135a",
                                    "name": "logs-corelight.conn-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "30745a83f179da5f11b16656250be0a248d7293f796a233331383a8b71ff135a",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn-*"
                                        }
                                    ],
                                    "layers": {
                                        "3ebf3d0c-088a-4be6-acbf-002858ebb189": {
                                            "columns": [
                                                {
                                                    "columnId": "Responding DNS Servers",
                                                    "fieldName": "Responding DNS Servers",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "30745a83f179da5f11b16656250be0a248d7293f796a233331383a8b71ff135a",
                                            "query": {
                                                "esql": "from logs-corelight.conn-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"conn\" and observer.hostname is not null and network.protocol == \"dns\"\r\n| stats count(), count_distinct(source.ip), values(destination.geo.country_name) , values(conn.local_resp) by destination.ip\r\n| eval `values(destination.geo.country_name)` = case(`values(destination.geo.country_name)` is null, \"Unknown\",\r\n`values(destination.geo.country_name)`)\r\n| eval Internal = case(\r\n    `values(conn.local_resp)` == true, \"yes\", \"no\")\r\n| rename destination.ip as Destination, `count()` as `# of Queries`, `count_distinct(source.ip)` as `# of Unique Clients`, `values(destination.geo.country_name)` as Country\r\n| sort `# of Queries` DESC, `# of Unique Clients` ASC\r\n| keep Destination, `# of Queries`,`# of Unique Clients`,`Country`, Internal\r\n| stats count()\r\n| rename `count()` as `Responding DNS Servers`"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.conn-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"conn\" and observer.hostname is not null and network.protocol == \"dns\"\r\n| stats count(), count_distinct(source.ip), values(destination.geo.country_name) , values(conn.local_resp) by destination.ip\r\n| eval `values(destination.geo.country_name)` = case(`values(destination.geo.country_name)` is null, \"Unknown\",\r\n`values(destination.geo.country_name)`)\r\n| eval Internal = case(\r\n    `values(conn.local_resp)` == true, \"yes\", \"no\")\r\n| rename destination.ip as Destination, `count()` as `# of Queries`, `count_distinct(source.ip)` as `# of Unique Clients`, `values(destination.geo.country_name)` as Country\r\n| sort `# of Queries` DESC, `# of Unique Clients` ASC\r\n| keep Destination, `# of Queries`,`# of Unique Clients`,`Country`, Internal\r\n| stats count()\r\n| rename `count()` as `Responding DNS Servers`"
                            },
                            "visualization": {
                                "layerId": "3ebf3d0c-088a-4be6-acbf-002858ebb189",
                                "layerType": "data",
                                "metricAccessor": "Responding DNS Servers"
                            }
                        },
                        "title": "Metric",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "c4622aff-b737-42c1-bb80-e23e7c2c1497",
                    "w": 21,
                    "x": 12,
                    "y": 5
                },
                "panelIndex": "c4622aff-b737-42c1-bb80-e23e7c2c1497",
                "title": "DNS Servers actively responding to queries [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "id": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "DNS servers actively responding in the network are key to secure operations, translating domain names to IP addresses and directing traffic. It also logs the number of queries and unique clients interacting with the DNS servers, offering insights into possible rogue DNS servers and detecting patterns that may suggest data exfiltration attempts.",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "74d88c5b-bf5a-460a-94d3-36f9ab45665c",
                    "w": 15,
                    "x": 33,
                    "y": 5
                },
                "panelIndex": "74d88c5b-bf5a-460a-94d3-36f9ab45665c",
                "title": "",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "30745a83f179da5f11b16656250be0a248d7293f796a233331383a8b71ff135a": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "30745a83f179da5f11b16656250be0a248d7293f796a233331383a8b71ff135a",
                                    "name": "logs-corelight.conn-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "30745a83f179da5f11b16656250be0a248d7293f796a233331383a8b71ff135a",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn-*"
                                        }
                                    ],
                                    "layers": {
                                        "cbedb337-c405-4d63-9d4a-78dd92fea7cc": {
                                            "columns": [
                                                {
                                                    "columnId": "Destination IP",
                                                    "fieldName": "Destination IP",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Number of Queries",
                                                    "fieldName": "Number of Queries",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "Number of Unique Clients",
                                                    "fieldName": "Number of Unique Clients",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "Country",
                                                    "fieldName": "Country",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Internal",
                                                    "fieldName": "Internal",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "30745a83f179da5f11b16656250be0a248d7293f796a233331383a8b71ff135a",
                                            "query": {
                                                "esql": "from logs-corelight.conn-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"conn\" and observer.hostname is not null and network.protocol == \"dns\"\r\n| stats count(), count_distinct(source.ip), values(destination.geo.country_name) , values(conn.local_resp) by destination.ip\r\n| eval `values(destination.geo.country_name)` = case(`values(destination.geo.country_name)` is null, \"Unknown\",\r\n`values(destination.geo.country_name)`)\r\n| eval Internal = case(\r\n    `values(conn.local_resp)` == true, \"yes\", \"no\")\r\n| rename destination.ip as `Destination IP`, `count()` as `Number of Queries`, `count_distinct(source.ip)` as `Number of Unique Clients`, `values(destination.geo.country_name)` as Country\r\n| sort `Number of Queries` DESC, `Number of Unique Clients` ASC\r\n| keep `Destination IP`, `Number of Queries`,`Number of Unique Clients`,`Country`, Internal"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.conn-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"conn\" and observer.hostname is not null and network.protocol == \"dns\"\r\n| stats count(), count_distinct(source.ip), values(destination.geo.country_name) , values(conn.local_resp) by destination.ip\r\n| eval `values(destination.geo.country_name)` = case(`values(destination.geo.country_name)` is null, \"Unknown\",\r\n`values(destination.geo.country_name)`)\r\n| eval Internal = case(\r\n    `values(conn.local_resp)` == true, \"yes\", \"no\")\r\n| rename destination.ip as `Destination IP`, `count()` as `Number of Queries`, `count_distinct(source.ip)` as `Number of Unique Clients`, `values(destination.geo.country_name)` as Country\r\n| sort `Number of Queries` DESC, `Number of Unique Clients` ASC\r\n| keep `Destination IP`, `Number of Queries`,`Number of Unique Clients`,`Country`, Internal"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "Destination IP"
                                    },
                                    {
                                        "columnId": "Number of Queries"
                                    },
                                    {
                                        "columnId": "Number of Unique Clients"
                                    },
                                    {
                                        "columnId": "Country"
                                    },
                                    {
                                        "columnId": "Internal"
                                    }
                                ],
                                "layerId": "cbedb337-c405-4d63-9d4a-78dd92fea7cc",
                                "layerType": "data",
                                "paging": {
                                    "enabled": true,
                                    "size": 10
                                }
                            }
                        },
                        "title": "Table Destination IP \u0026 Number of Queries \u0026 Number of Unique Clients \u0026 Country \u0026 Internal",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 16,
                    "i": "5fd9db5e-4b67-4705-864f-9da458ae559c",
                    "w": 36,
                    "x": 12,
                    "y": 13
                },
                "panelIndex": "5fd9db5e-4b67-4705-864f-9da458ae559c",
                "title": "DNS Servers actively responding to queries [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a",
                                    "name": "logs-corelight.dns-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.dns-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.dns-*"
                                        }
                                    ],
                                    "layers": {
                                        "018938b7-4189-40e7-a4b9-4827a2e82073": {
                                            "columns": [
                                                {
                                                    "columnId": "NXDOMAIN Responses",
                                                    "fieldName": "NXDOMAIN Responses",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a",
                                            "query": {
                                                "esql": "from logs-corelight.dns-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"dns\" and observer.hostname is not null and dns.response_code == \"NXDOMAIN\"\r\n| stats count() by source.ip, destination.ip, dns.question.name, dns.flags.rejected\r\n| rename source.ip as Source, destination.ip as Responder, dns.question.name as Query, dns.flags.rejected as query_rejected, `count()` as Count\r\n|eval `Rejected?` = case(query_rejected == true, \"Yes\", \"No\")\r\n| keep Source, Responder, Query, `Rejected?`, Count\r\n| stats sum(Count)\r\n| rename `sum(Count)` as `NXDOMAIN Responses`"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.dns-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"dns\" and observer.hostname is not null and dns.response_code == \"NXDOMAIN\"\r\n| stats count() by source.ip, destination.ip, dns.question.name, dns.flags.rejected\r\n| rename source.ip as Source, destination.ip as Responder, dns.question.name as Query, dns.flags.rejected as query_rejected, `count()` as Count\r\n|eval `Rejected?` = case(query_rejected == true, \"Yes\", \"No\")\r\n| keep Source, Responder, Query, `Rejected?`, Count\r\n| stats sum(Count)\r\n| rename `sum(Count)` as `NXDOMAIN Responses`"
                            },
                            "visualization": {
                                "layerId": "018938b7-4189-40e7-a4b9-4827a2e82073",
                                "layerType": "data",
                                "metricAccessor": "NXDOMAIN Responses"
                            }
                        },
                        "title": "Metric",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "7ad0699b-c6f3-4d65-9eac-4b64bb2f2ac7",
                    "w": 9,
                    "x": 0,
                    "y": 29
                },
                "panelIndex": "7ad0699b-c6f3-4d65-9eac-4b64bb2f2ac7",
                "title": "NXDOMAIN Responses [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "High rates of DNS NXDOMAIN responses might suggest misconfigured domains, typographical errors in network requests, or malicious activities such as DNS reconnaissance. Close examination is advised to correct configurations or identify security incidents. Review DNS logs for patterns, validate domain configurations, and check endpoint security for signs of malware.",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "51e44b2d-b0f2-4594-9994-ef11c1d5c6fc",
                    "w": 15,
                    "x": 9,
                    "y": 29
                },
                "panelIndex": "51e44b2d-b0f2-4594-9994-ef11c1d5c6fc",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-c4e9e0a6-f825-4c30-aff3-e4bdbeed88f4",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-fce80aa0-379e-4ef0-92bc-44d99401530d",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "c4e9e0a6-f825-4c30-aff3-e4bdbeed88f4": {
                                            "columnOrder": [
                                                "caa40fd6-ef59-4f69-8206-e6a56d3415fc"
                                            ],
                                            "columns": {
                                                "caa40fd6-ef59-4f69-8206-e6a56d3415fc": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Unusual Qtypes",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "dns.question.type"
                                                }
                                            },
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        },
                                        "fce80aa0-379e-4ef0-92bc-44d99401530d": {
                                            "columnOrder": [
                                                "77c870d2-fb5e-4085-be69-ec02c9ab3638",
                                                "b246490e-7f57-4a6a-a0c2-a151024b8b6b"
                                            ],
                                            "columns": {
                                                "77c870d2-fb5e-4085-be69-ec02c9ab3638": {
                                                    "dataType": "date",
                                                    "isBucketed": true,
                                                    "label": "@timestamp",
                                                    "operationType": "date_histogram",
                                                    "params": {
                                                        "dropPartials": false,
                                                        "includeEmptyRows": true,
                                                        "interval": "auto"
                                                    },
                                                    "scale": "interval",
                                                    "sourceField": "@timestamp"
                                                },
                                                "b246490e-7f57-4a6a-a0c2-a151024b8b6b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Unusual Qtypes",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "dns.question.type"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "linkToLayers": [
                                                "c4e9e0a6-f825-4c30-aff3-e4bdbeed88f4"
                                            ],
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "d231056f-f69b-475d-8c67-3d4781691d7b",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "observer.vendor",
                                                    "index": "logs-*",
                                                    "key": "observer.vendor",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "Corelight"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "observer.vendor": "Corelight"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "event.dataset",
                                                    "index": "logs-*",
                                                    "key": "event.dataset",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "dns"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "event.dataset": "dns"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "observer.hostname",
                                                    "index": "logs-*",
                                                    "key": "observer.hostname",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "observer.hostname"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "dns.question.type",
                                                    "index": "logs-*",
                                                    "key": "dns.question.type",
                                                    "negate": false,
                                                    "params": [
                                                        "AXFR",
                                                        "IXFR",
                                                        "ANY",
                                                        "TXT"
                                                    ],
                                                    "type": "phrases",
                                                    "value": [
                                                        "AXFR",
                                                        "IXFR",
                                                        "ANY",
                                                        "TXT"
                                                    ]
                                                },
                                                "query": {
                                                    "bool": {
                                                        "minimum_should_match": 1,
                                                        "should": [
                                                            {
                                                                "match_phrase": {
                                                                    "dns.question.type": "AXFR"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.question.type": "IXFR"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.question.type": "ANY"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.question.type": "TXT"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "AND",
                                        "type": "combined"
                                    },
                                    "query": {}
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "color": "#FFFFFF",
                                "layerId": "c4e9e0a6-f825-4c30-aff3-e4bdbeed88f4",
                                "layerType": "data",
                                "metricAccessor": "caa40fd6-ef59-4f69-8206-e6a56d3415fc",
                                "showBar": false,
                                "trendlineLayerId": "fce80aa0-379e-4ef0-92bc-44d99401530d",
                                "trendlineLayerType": "metricTrendline",
                                "trendlineMetricAccessor": "b246490e-7f57-4a6a-a0c2-a151024b8b6b",
                                "trendlineTimeAccessor": "77c870d2-fb5e-4085-be69-ec02c9ab3638"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "c3d12a34-7130-4e0d-ad7e-32d744f883c8",
                    "w": 9,
                    "x": 24,
                    "y": 29
                },
                "panelIndex": "c3d12a34-7130-4e0d-ad7e-32d744f883c8",
                "title": "Unusual Qtypes [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "Unusual DNS query types can indicate misconfigurations, experimental features, or potential security threats like data exfiltration or tunneling. Analysts should scrutinize such queries for anomalies and address identified risks to safeguard network security.",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "4198f90d-1e35-43d3-8215-ee4bbcb43ef8",
                    "w": 15,
                    "x": 33,
                    "y": 29
                },
                "panelIndex": "4198f90d-1e35-43d3-8215-ee4bbcb43ef8",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a",
                                    "name": "logs-corelight.dns-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.dns-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.dns-*"
                                        }
                                    ],
                                    "layers": {
                                        "1954c25a-d1bc-490f-a98e-11935de92ce7": {
                                            "columns": [
                                                {
                                                    "columnId": "Source IP",
                                                    "fieldName": "Source IP",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Destination IP",
                                                    "fieldName": "Destination IP",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Query",
                                                    "fieldName": "Query",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Rejected?",
                                                    "fieldName": "Rejected?",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Count",
                                                    "fieldName": "Count",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a",
                                            "query": {
                                                "esql": "from logs-corelight.dns-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"dns\" and observer.hostname is not null and dns.response_code == \"NXDOMAIN\"\r\n| stats count() by source.ip, destination.ip, dns.question.name, dns.flags.rejected\r\n| rename source.ip as `Source IP`, destination.ip as `Destination IP`, dns.question.name as Query, dns.flags.rejected as query_rejected, `count()` as Count\r\n|eval `Rejected?` = case(query_rejected == true, \"Yes\", \"No\")\r\n| sort Count desc\r\n| keep `Source IP`, `Destination IP`, Query, `Rejected?`, Count"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.dns-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"dns\" and observer.hostname is not null and dns.response_code == \"NXDOMAIN\"\r\n| stats count() by source.ip, destination.ip, dns.question.name, dns.flags.rejected\r\n| rename source.ip as `Source IP`, destination.ip as `Destination IP`, dns.question.name as Query, dns.flags.rejected as query_rejected, `count()` as Count\r\n|eval `Rejected?` = case(query_rejected == true, \"Yes\", \"No\")\r\n| sort Count desc\r\n| keep `Source IP`, `Destination IP`, Query, `Rejected?`, Count"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "Source IP"
                                    },
                                    {
                                        "columnId": "Destination IP"
                                    },
                                    {
                                        "columnId": "Query"
                                    },
                                    {
                                        "columnId": "Rejected?"
                                    },
                                    {
                                        "columnId": "Count"
                                    }
                                ],
                                "layerId": "1954c25a-d1bc-490f-a98e-11935de92ce7",
                                "layerType": "data",
                                "paging": {
                                    "enabled": true,
                                    "size": 10
                                }
                            }
                        },
                        "title": "Table Source IP \u0026 Destination IP \u0026 Query \u0026 Rejected? \u0026 Count",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 16,
                    "i": "a419d7f8-5778-4ca5-9ff9-458c48780c63",
                    "w": 24,
                    "x": 0,
                    "y": 37
                },
                "panelIndex": "a419d7f8-5778-4ca5-9ff9-458c48780c63",
                "title": "Network Evidence for NXDOMAIN Responses [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-57e304c4-38a3-414e-ade3-7fde09dea5ea",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "57e304c4-38a3-414e-ade3-7fde09dea5ea": {
                                            "columnOrder": [
                                                "2baf2b55-3dec-4804-9479-778def74f831",
                                                "ec51ba7c-550f-421d-b8d4-80435d1a2393",
                                                "48be70d1-5a92-45f7-93fa-edffa0ae347c",
                                                "3754cf2d-a7ed-4929-a64a-bad0bb414306",
                                                "5aa24d03-8701-4413-8d61-337eaccebc62"
                                            ],
                                            "columns": {
                                                "2baf2b55-3dec-4804-9479-778def74f831": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Qtype",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "accuracyMode": false,
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderAgg": {
                                                            "dataType": "number",
                                                            "isBucketed": false,
                                                            "label": "Count of records",
                                                            "operationType": "count",
                                                            "params": {
                                                                "emptyAsNull": true
                                                            },
                                                            "scale": "ratio",
                                                            "sourceField": "___records___"
                                                        },
                                                        "orderBy": {
                                                            "type": "custom"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10000
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "dns.question.type"
                                                },
                                                "3754cf2d-a7ed-4929-a64a-bad0bb414306": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "filter": {
                                                        "language": "kuery",
                                                        "query": "\"dns.question.name\": *"
                                                    },
                                                    "isBucketed": false,
                                                    "label": "Query",
                                                    "operationType": "last_value",
                                                    "params": {
                                                        "sortField": "@timestamp"
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "dns.question.name"
                                                },
                                                "48be70d1-5a92-45f7-93fa-edffa0ae347c": {
                                                    "customLabel": true,
                                                    "dataType": "ip",
                                                    "filter": {
                                                        "language": "kuery",
                                                        "query": "\"source.ip\": *"
                                                    },
                                                    "isBucketed": false,
                                                    "label": "Source IP",
                                                    "operationType": "last_value",
                                                    "params": {
                                                        "sortField": "@timestamp"
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "source.ip"
                                                },
                                                "5aa24d03-8701-4413-8d61-337eaccebc62": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "ec51ba7c-550f-421d-b8d4-80435d1a2393": {
                                                    "customLabel": true,
                                                    "dataType": "ip",
                                                    "isBucketed": true,
                                                    "label": "Destination IP",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "5aa24d03-8701-4413-8d61-337eaccebc62",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10000
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "destination.ip"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "292f84a8-5325-419b-a0c5-16eb5bd6ff86",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "observer.vendor",
                                                    "index": "logs-*",
                                                    "key": "observer.vendor",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "Corelight"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "observer.vendor": "Corelight"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "event.dataset",
                                                    "index": "logs-*",
                                                    "key": "event.dataset",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "dns"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "event.dataset": "dns"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "observer.hostname",
                                                    "index": "logs-*",
                                                    "key": "observer.hostname",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "observer.hostname"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "dns.question.type",
                                                    "index": "logs-*",
                                                    "key": "dns.question.type",
                                                    "negate": false,
                                                    "params": [
                                                        "AXFR",
                                                        "IXFR",
                                                        "ANY",
                                                        "TXT"
                                                    ],
                                                    "type": "phrases",
                                                    "value": [
                                                        "AXFR",
                                                        "IXFR",
                                                        "ANY",
                                                        "TXT"
                                                    ]
                                                },
                                                "query": {
                                                    "bool": {
                                                        "minimum_should_match": 1,
                                                        "should": [
                                                            {
                                                                "match_phrase": {
                                                                    "dns.question.type": "AXFR"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.question.type": "IXFR"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.question.type": "ANY"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.question.type": "TXT"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "AND",
                                        "type": "combined"
                                    },
                                    "query": {}
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "2baf2b55-3dec-4804-9479-778def74f831",
                                        "hidden": false,
                                        "isMetric": false,
                                        "isTransposed": false,
                                        "width": 200.6
                                    },
                                    {
                                        "columnId": "3754cf2d-a7ed-4929-a64a-bad0bb414306",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "48be70d1-5a92-45f7-93fa-edffa0ae347c",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "alignment": "left",
                                        "columnId": "5aa24d03-8701-4413-8d61-337eaccebc62",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "ec51ba7c-550f-421d-b8d4-80435d1a2393",
                                        "hidden": false,
                                        "isMetric": false,
                                        "isTransposed": false
                                    }
                                ],
                                "headerRowHeight": "auto",
                                "layerId": "57e304c4-38a3-414e-ade3-7fde09dea5ea",
                                "layerType": "data",
                                "paging": {
                                    "enabled": true,
                                    "size": 10
                                },
                                "rowHeight": "auto"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {}
                },
                "gridData": {
                    "h": 16,
                    "i": "a7fe7917-bfed-40c7-b78c-d89131368db4",
                    "w": 24,
                    "x": 24,
                    "y": 37
                },
                "panelIndex": "a7fe7917-bfed-40c7-b78c-d89131368db4",
                "title": "Unusual Query Types found [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-727942dc-ec2c-489f-953b-dd5cdab0d17c",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "727942dc-ec2c-489f-953b-dd5cdab0d17c": {
                                            "columnOrder": [
                                                "ed474aed-58a9-47bf-8aa5-33753ddaca07"
                                            ],
                                            "columns": {
                                                "ed474aed-58a9-47bf-8aa5-33753ddaca07": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Failed DNS Queries",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "dns.response_code"
                                                }
                                            },
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*"
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "baebe57a-478c-46bd-b9a0-47c98ac5ee8b",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "observer.vendor",
                                                    "index": "logs-*",
                                                    "key": "observer.vendor",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "Corelight"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "observer.vendor": "Corelight"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "event.dataset",
                                                    "index": "logs-*",
                                                    "key": "event.dataset",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "dns"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "event.dataset": "dns"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "observer.hostname",
                                                    "index": "logs-*",
                                                    "key": "observer.hostname",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "observer.hostname"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "dns.response_code",
                                                    "index": "logs-*",
                                                    "key": "dns.response_code",
                                                    "negate": false,
                                                    "params": [
                                                        "SERVFAIL",
                                                        "REFUSED",
                                                        "FORMERR",
                                                        "NOTIMP",
                                                        "NOTAUTH"
                                                    ],
                                                    "type": "phrases",
                                                    "value": [
                                                        "SERVFAIL",
                                                        "REFUSED",
                                                        "FORMERR",
                                                        "NOTIMP",
                                                        "NOTAUTH"
                                                    ]
                                                },
                                                "query": {
                                                    "bool": {
                                                        "minimum_should_match": 1,
                                                        "should": [
                                                            {
                                                                "match_phrase": {
                                                                    "dns.response_code": "SERVFAIL"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.response_code": "REFUSED"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.response_code": "FORMERR"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.response_code": "NOTIMP"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.response_code": "NOTAUTH"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "AND",
                                        "type": "combined"
                                    },
                                    "query": {}
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "color": "#FFFFFF",
                                "layerId": "727942dc-ec2c-489f-953b-dd5cdab0d17c",
                                "layerType": "data",
                                "metricAccessor": "ed474aed-58a9-47bf-8aa5-33753ddaca07"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "7d2bfb7d-5b46-45af-9a08-1f7d423aa13a",
                    "w": 9,
                    "x": 0,
                    "y": 53
                },
                "panelIndex": "7d2bfb7d-5b46-45af-9a08-1f7d423aa13a",
                "title": "NXDOMAIN Responses [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "Failed DNS queries may point to misconfigurations, outdated systems, or security threats such as network infiltration or DNS poisoning. Analysts should investigate the sources and patterns of these failures to identify and remediate underlying causes, thereby ensuring network integrity and security.",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "69a868ad-16f7-4750-a2c3-3334a957b453",
                    "w": 15,
                    "x": 9,
                    "y": 53
                },
                "panelIndex": "69a868ad-16f7-4750-a2c3-3334a957b453",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a",
                                    "name": "logs-corelight.dns-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.dns-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.dns-*"
                                        }
                                    ],
                                    "layers": {
                                        "35fb5d46-f4f8-4272-ab64-39c9ee6092f6": {
                                            "columns": [
                                                {
                                                    "columnId": "Monitoring DNS Query Response Times \u003e 15ms",
                                                    "fieldName": "Monitoring DNS Query Response Times \u003e 15ms",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a",
                                            "query": {
                                                "esql": "from logs-corelight.dns-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"dns\" and observer.hostname is not null\r\n| stats avg_rtt = avg(dns.rtt) by dns.question.name,destination.ip\r\n| where avg_rtt \u003e 0.015\r\n| eval avg_rtt = to_string(round(avg_rtt*1000, 2))\r\n| rename dns.question.name as Query, destination.ip as Responder, avg_rtt as `Avg. Response Time (ms)`\r\n| stats count(Query) \r\n| rename `count(Query)` as `Monitoring DNS Query Response Times \u003e 15ms`"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.dns-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"dns\" and observer.hostname is not null\r\n| stats avg_rtt = avg(dns.rtt) by dns.question.name,destination.ip\r\n| where avg_rtt \u003e 0.015\r\n| eval avg_rtt = to_string(round(avg_rtt*1000, 2))\r\n| rename dns.question.name as Query, destination.ip as Responder, avg_rtt as `Avg. Response Time (ms)`\r\n| stats count(Query) \r\n| rename `count(Query)` as `Monitoring DNS Query Response Times \u003e 15ms`"
                            },
                            "visualization": {
                                "layerId": "35fb5d46-f4f8-4272-ab64-39c9ee6092f6",
                                "layerType": "data",
                                "metricAccessor": "Monitoring DNS Query Response Times \u003e 15ms"
                            }
                        },
                        "title": "Metric",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "c500aeac-2fbc-4c4e-88de-a6401716befd",
                    "w": 9,
                    "x": 24,
                    "y": 53
                },
                "panelIndex": "c500aeac-2fbc-4c4e-88de-a6401716befd",
                "title": "Monitoring DNS Query Response Times \u003e 15ms [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "Long DNS query response times may indicate network congestion, server performance issues, or potential security threats. Timely analysis is crucial for maintaining optimal network performance and security. Investigate extended response times by examining server configurations, network traffic, and potential external attacks.",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "e79912a9-d452-4e96-832d-fc6e7866de02",
                    "w": 15,
                    "x": 33,
                    "y": 53
                },
                "panelIndex": "e79912a9-d452-4e96-832d-fc6e7866de02",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-727942dc-ec2c-489f-953b-dd5cdab0d17c",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "727942dc-ec2c-489f-953b-dd5cdab0d17c": {
                                            "columnOrder": [
                                                "9f5bb817-f888-44e6-a08c-e16aa3818603",
                                                "5a1d6ef6-c325-468c-af82-72fa6b51a5d7",
                                                "79eb71be-2bbc-4710-97c6-6219b4716016",
                                                "4be8d5b0-dc64-4f9b-991c-251b7e70d1bb",
                                                "9a848fff-e882-4622-9c70-61255b537a53"
                                            ],
                                            "columns": {
                                                "4be8d5b0-dc64-4f9b-991c-251b7e70d1bb": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "filter": {
                                                        "language": "kuery",
                                                        "query": "\"dns.question.name\": *"
                                                    },
                                                    "isBucketed": false,
                                                    "label": "Query",
                                                    "operationType": "last_value",
                                                    "params": {
                                                        "sortField": "@timestamp"
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "dns.question.name"
                                                },
                                                "5a1d6ef6-c325-468c-af82-72fa6b51a5d7": {
                                                    "customLabel": true,
                                                    "dataType": "ip",
                                                    "filter": {
                                                        "language": "kuery",
                                                        "query": "\"source.ip\": *"
                                                    },
                                                    "isBucketed": false,
                                                    "label": "Source IP",
                                                    "operationType": "last_value",
                                                    "params": {
                                                        "sortField": "@timestamp"
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "source.ip"
                                                },
                                                "79eb71be-2bbc-4710-97c6-6219b4716016": {
                                                    "customLabel": true,
                                                    "dataType": "ip",
                                                    "filter": {
                                                        "language": "kuery",
                                                        "query": "\"destination.ip\": *"
                                                    },
                                                    "isBucketed": false,
                                                    "label": "Destination IP",
                                                    "operationType": "last_value",
                                                    "params": {
                                                        "sortField": "@timestamp"
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "destination.ip"
                                                },
                                                "9a848fff-e882-4622-9c70-61255b537a53": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "9f5bb817-f888-44e6-a08c-e16aa3818603": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Response Code",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderAgg": {
                                                            "dataType": "number",
                                                            "isBucketed": false,
                                                            "label": "Count of records",
                                                            "operationType": "count",
                                                            "params": {
                                                                "emptyAsNull": true
                                                            },
                                                            "scale": "ratio",
                                                            "sourceField": "___records___"
                                                        },
                                                        "orderBy": {
                                                            "type": "custom"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 10000
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "dns.response_code"
                                                }
                                            },
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*"
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "568d23b1-2259-41d0-96cb-29eda7008a47",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "observer.vendor",
                                                    "index": "logs-*",
                                                    "key": "observer.vendor",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "Corelight"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "observer.vendor": "Corelight"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "event.dataset",
                                                    "index": "logs-*",
                                                    "key": "event.dataset",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "dns"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "event.dataset": "dns"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "observer.hostname",
                                                    "index": "logs-*",
                                                    "key": "observer.hostname",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "observer.hostname"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "dns.response_code",
                                                    "index": "logs-*",
                                                    "key": "dns.response_code",
                                                    "negate": false,
                                                    "params": [
                                                        "SERVFAIL",
                                                        "REFUSED",
                                                        "FORMERR",
                                                        "NOTIMP",
                                                        "NOTAUTH"
                                                    ],
                                                    "type": "phrases",
                                                    "value": [
                                                        "SERVFAIL",
                                                        "REFUSED",
                                                        "FORMERR",
                                                        "NOTIMP",
                                                        "NOTAUTH"
                                                    ]
                                                },
                                                "query": {
                                                    "bool": {
                                                        "minimum_should_match": 1,
                                                        "should": [
                                                            {
                                                                "match_phrase": {
                                                                    "dns.response_code": "SERVFAIL"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.response_code": "REFUSED"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.response_code": "FORMERR"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.response_code": "NOTIMP"
                                                                }
                                                            },
                                                            {
                                                                "match_phrase": {
                                                                    "dns.response_code": "NOTAUTH"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "AND",
                                        "type": "combined"
                                    },
                                    "query": {}
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "5a1d6ef6-c325-468c-af82-72fa6b51a5d7",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "79eb71be-2bbc-4710-97c6-6219b4716016",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "4be8d5b0-dc64-4f9b-991c-251b7e70d1bb",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "9a848fff-e882-4622-9c70-61255b537a53",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "9f5bb817-f888-44e6-a08c-e16aa3818603",
                                        "isMetric": false,
                                        "isTransposed": false
                                    }
                                ],
                                "headerRowHeight": "auto",
                                "layerId": "727942dc-ec2c-489f-953b-dd5cdab0d17c",
                                "layerType": "data",
                                "paging": {
                                    "enabled": true,
                                    "size": 10
                                },
                                "rowHeight": "auto"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 16,
                    "i": "59ffbbf5-e70a-4d7d-8b0d-c7768b83b6c7",
                    "w": 24,
                    "x": 0,
                    "y": 61
                },
                "panelIndex": "59ffbbf5-e70a-4d7d-8b0d-c7768b83b6c7",
                "title": "Network Evidence for Failed DNS Queries [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a",
                                    "name": "logs-corelight.dns-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.dns-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.dns-*"
                                        }
                                    ],
                                    "layers": {
                                        "c0c77f56-7569-4747-b999-9c164462ef11": {
                                            "columns": [
                                                {
                                                    "columnId": "Query",
                                                    "fieldName": "Query",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Destination IP",
                                                    "fieldName": "Destination IP",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Avg. Response Time (ms)",
                                                    "fieldName": "Avg. Response Time (ms)",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "2822558581c97b9590f6300cb704338209e089678c681675277821265127a97a",
                                            "query": {
                                                "esql": "from logs-corelight.dns-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"dns\" and observer.hostname is not null\r\n| stats avg_rtt = avg(dns.rtt) by dns.question.name,destination.ip\r\n| where avg_rtt \u003e 0.015\r\n| eval avg_rtt = to_string(round(avg_rtt*1000, 2))\r\n| rename dns.question.name as Query, destination.ip as `Destination IP`, avg_rtt as `Avg. Response Time (ms)`\r\n| keep Query, `Destination IP`,`Avg. Response Time (ms)`"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.dns-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"dns\" and observer.hostname is not null\r\n| stats avg_rtt = avg(dns.rtt) by dns.question.name,destination.ip\r\n| where avg_rtt \u003e 0.015\r\n| eval avg_rtt = to_string(round(avg_rtt*1000, 2))\r\n| rename dns.question.name as Query, destination.ip as `Destination IP`, avg_rtt as `Avg. Response Time (ms)`\r\n| keep Query, `Destination IP`,`Avg. Response Time (ms)`"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "Query"
                                    },
                                    {
                                        "columnId": "Destination IP"
                                    },
                                    {
                                        "columnId": "Avg. Response Time (ms)"
                                    }
                                ],
                                "layerId": "c0c77f56-7569-4747-b999-9c164462ef11",
                                "layerType": "data",
                                "paging": {
                                    "enabled": true,
                                    "size": 10
                                }
                            }
                        },
                        "title": "Table Query \u0026 Destination IP \u0026 Avg. Response Time (ms)",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 16,
                    "i": "91479e99-d3f4-4b75-8622-2c1428d26beb",
                    "w": 24,
                    "x": 24,
                    "y": 61
                },
                "panelIndex": "91479e99-d3f4-4b75-8622-2c1428d26beb",
                "title": "Monitoring Query Types by AVG time [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-9f47d832-8719-4ec7-9561-e41bd686ab1d",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "9f47d832-8719-4ec7-9561-e41bd686ab1d": {
                                            "columnOrder": [
                                                "6dab638f-2018-4dfc-9347-e3c433f77eb6"
                                            ],
                                            "columns": {
                                                "6dab638f-2018-4dfc-9347-e3c433f77eb6": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "DNS Query Volume Over Time",
                                                    "operationType": "sum",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "bytes",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.bytes"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "93a71a88-d4bf-463f-87ef-b291ff153658",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "observer.vendor",
                                                    "index": "logs-*",
                                                    "key": "observer.vendor",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "Corelight"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "observer.vendor": "Corelight"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "event.dataset",
                                                    "index": "logs-*",
                                                    "key": "event.dataset",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "conn"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "event.dataset": "conn"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "observer.hostname",
                                                    "index": "logs-*",
                                                    "key": "observer.hostname",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "observer.hostname"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "network.protocol",
                                                    "index": "logs-*",
                                                    "key": "network.protocol",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "dns"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "network.protocol": "dns"
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "AND",
                                        "type": "combined"
                                    },
                                    "query": {}
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "color": "#FFFFFF",
                                "layerId": "9f47d832-8719-4ec7-9561-e41bd686ab1d",
                                "layerType": "data",
                                "metricAccessor": "6dab638f-2018-4dfc-9347-e3c433f77eb6"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "c387e630-592c-4b76-b9a4-4186cc9cddb8",
                    "w": 9,
                    "x": 0,
                    "y": 77
                },
                "panelIndex": "c387e630-592c-4b76-b9a4-4186cc9cddb8",
                "title": "DNS Query Volume Over Time [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "Monitor total DNS-related network traffic in MB/GB. Sudden spikes or unusual patterns could signal configuration errors, compromised devices making excessive queries, or potential data exfiltration attempts.",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "2b1667e8-6a7c-4aed-a897-34e44869f093",
                    "w": 15,
                    "x": 9,
                    "y": 77
                },
                "panelIndex": "2b1667e8-6a7c-4aed-a897-34e44869f093",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-92edaee0-ac50-487f-93a8-4fbe36f2ea1c",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "3bd035d5-676a-4c93-8123-c2e088c5aa69",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "92edaee0-ac50-487f-93a8-4fbe36f2ea1c": {
                                            "columnOrder": [
                                                "9895e8c8-37a8-4dbd-8747-eeba6d504a03",
                                                "03df8242-dd49-4d36-8d97-c09ad1cac1a6"
                                            ],
                                            "columns": {
                                                "03df8242-dd49-4d36-8d97-c09ad1cac1a6": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Monitoring Query Types by AVG time",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "9895e8c8-37a8-4dbd-8747-eeba6d504a03": {
                                                    "dataType": "date",
                                                    "isBucketed": true,
                                                    "label": "@timestamp",
                                                    "operationType": "date_histogram",
                                                    "params": {
                                                        "dropPartials": false,
                                                        "includeEmptyRows": true,
                                                        "interval": "h"
                                                    },
                                                    "scale": "interval",
                                                    "sourceField": "@timestamp"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "3bd035d5-676a-4c93-8123-c2e088c5aa69",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "observer.vendor",
                                                    "index": "logs-*",
                                                    "key": "observer.vendor",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "Corelight"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "observer.vendor": "Corelight"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "event.dataset",
                                                    "index": "logs-*",
                                                    "key": "event.dataset",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "dns"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "event.dataset": "dns"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "observer.hostname",
                                                    "index": "logs-*",
                                                    "key": "observer.hostname",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "observer.hostname"
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "AND",
                                        "type": "combined"
                                    },
                                    "query": {}
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "accessors": [
                                            "03df8242-dd49-4d36-8d97-c09ad1cac1a6"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "92edaee0-ac50-487f-93a8-4fbe36f2ea1c",
                                        "layerType": "data",
                                        "position": "top",
                                        "seriesType": "line",
                                        "showGridlines": false,
                                        "xAccessor": "9895e8c8-37a8-4dbd-8747-eeba6d504a03"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "line",
                                "title": "Empty XY chart",
                                "valueLabels": "hide"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 16,
                    "i": "07fc5f04-6a47-4808-9d47-8ea30554891d",
                    "w": 24,
                    "x": 0,
                    "y": 85
                },
                "panelIndex": "07fc5f04-6a47-4808-9d47-8ea30554891d",
                "title": "Monitoring Query Types by AVG time [Logs Corelight]",
                "type": "lens"
            }
        ],
        "refreshInterval": {
            "pause": true,
            "value": 60000
        },
        "timeFrom": "now-24h",
        "timeRestore": true,
        "timeTo": "now",
        "title": "[Logs Corelight] Name Resolution Insights",
        "version": 2
    },
    "coreMigrationVersion": "8.8.0",
    "created_at": "2025-02-06T07:20:16.569Z",
    "id": "corelight-8546a96c-86c9-4edf-9d46-88338d6ac40e",
    "managed": false,
    "references": [
        {
            "id": "logs-*",
            "name": "c3d12a34-7130-4e0d-ad7e-32d744f883c8:indexpattern-datasource-layer-c4e9e0a6-f825-4c30-aff3-e4bdbeed88f4",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c3d12a34-7130-4e0d-ad7e-32d744f883c8:indexpattern-datasource-layer-fce80aa0-379e-4ef0-92bc-44d99401530d",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a7fe7917-bfed-40c7-b78c-d89131368db4:indexpattern-datasource-layer-57e304c4-38a3-414e-ade3-7fde09dea5ea",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7d2bfb7d-5b46-45af-9a08-1f7d423aa13a:indexpattern-datasource-layer-727942dc-ec2c-489f-953b-dd5cdab0d17c",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "59ffbbf5-e70a-4d7d-8b0d-c7768b83b6c7:indexpattern-datasource-layer-727942dc-ec2c-489f-953b-dd5cdab0d17c",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c387e630-592c-4b76-b9a4-4186cc9cddb8:indexpattern-datasource-layer-9f47d832-8719-4ec7-9561-e41bd686ab1d",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "07fc5f04-6a47-4808-9d47-8ea30554891d:indexpattern-datasource-layer-92edaee0-ac50-487f-93a8-4fbe36f2ea1c",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "07fc5f04-6a47-4808-9d47-8ea30554891d:3bd035d5-676a-4c93-8123-c2e088c5aa69",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_597c5dc5-3e91-4307-8a43-32592d3367d0:optionsListDataView",
            "type": "index-pattern"
        }
    ],
    "type": "dashboard",
    "typeMigrationVersion": "10.2.0",
    "updated_by": "u_mGBROF_q5bmFCATbLXAcCwKa0k8JvONAwSruelyKA5E_0"
}