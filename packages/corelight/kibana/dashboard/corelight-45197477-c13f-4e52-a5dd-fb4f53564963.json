{
    "attributes": {
        "controlGroupInput": {
            "chainingSystem": "HIERARCHICAL",
            "controlStyle": "oneLine",
            "ignoreParentSettingsJSON": {
                "ignoreFilters": false,
                "ignoreQuery": false,
                "ignoreTimerange": false,
                "ignoreValidations": false
            },
            "panelsJSON": {
                "b7b4bc2e-98d1-453a-a412-a37228a386b1": {
                    "explicitInput": {
                        "enhancements": {},
                        "fieldName": "observer.hostname",
                        "grow": true,
                        "id": "b7b4bc2e-98d1-453a-a412-a37228a386b1",
                        "searchTechnique": "prefix",
                        "title": "Sensor",
                        "width": "medium"
                    },
                    "grow": false,
                    "order": 0,
                    "type": "optionsListControl",
                    "width": "small"
                }
            },
            "showApplySelections": false
        },
        "description": "",
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": {
                "filter": [],
                "query": {
                    "language": "kuery",
                    "query": ""
                }
            }
        },
        "optionsJSON": {
            "hidePanelTitles": false,
            "syncColors": false,
            "syncCursor": true,
            "syncTooltips": false,
            "useMargins": true
        },
        "panelsJSON": [
            {
                "embeddableConfig": {
                    "description": "",
                    "enhancements": {},
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "id": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "## Encrypted Traffic Notables\n\n",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 4,
                    "i": "be6ab3ce-1843-4a13-8caa-a2affb57113a",
                    "w": 48,
                    "x": 0,
                    "y": 0
                },
                "panelIndex": "be6ab3ce-1843-4a13-8caa-a2affb57113a",
                "title": "",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": false,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "id": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "**Navigation**\n\n**Corelight**\n\n- [Security Posture](#/dashboard/corelight-7c0946bc-acd0-4ec3-ab3b-8a92853f4a3b)\n- [Name Resolution Insights](#/dashboard/corelight-8546a96c-86c9-4edf-9d46-88338d6ac40e)\n- [**Secure Channel Insights (This Page)**](#/dashboard/corelight-45197477-c13f-4e52-a5dd-fb4f53564963)\n- [Remote Activity Insights](#/dashboard/corelight-f4864774-ed73-4b78-b861-5b8235ec12cf)\n\n[**Integrations Page**](/app/integrations/detail/corelight/overview)",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 23,
                    "i": "d1c18930-83ea-43cd-a011-143ae3f1028e",
                    "w": 10,
                    "x": 0,
                    "y": 4
                },
                "panelIndex": "d1c18930-83ea-43cd-a011-143ae3f1028e",
                "title": "Table of Contents",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865",
                                    "name": "logs-corelight.ssl-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.ssl-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.ssl-*"
                                        }
                                    ],
                                    "layers": {
                                        "d0fa3d75-c6e6-41ec-bd1d-eb6239626707": {
                                            "columns": [
                                                {
                                                    "columnId": "Self Signed Certs",
                                                    "fieldName": "Self Signed Certs",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865",
                                            "query": {
                                                "esql": "from logs-corelight.ssl-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"tls\" and observer.hostname is not null and ssl.\r\nvalidation_status == \"self signed certificate\"\r\n| stats values(destination.domain), values(ssl.validation_status), values(destination.ip) by destination.ip, destination.domain\r\n| rename `values(destination.domain)` as Subject, `values(destination.ip)` as Destination, `values(ssl.validation_status)` as Status\r\n| keep Subject, Destination, Status\r\n| stats count()\r\n| rename `count()` as `Self Signed Certs`\r\n| keep `Self Signed Certs`"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.ssl-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"tls\" and observer.hostname is not null and ssl.\r\nvalidation_status == \"self signed certificate\"\r\n| stats values(destination.domain), values(ssl.validation_status), values(destination.ip) by destination.ip, destination.domain\r\n| rename `values(destination.domain)` as Subject, `values(destination.ip)` as Destination, `values(ssl.validation_status)` as Status\r\n| keep Subject, Destination, Status\r\n| stats count()\r\n| rename `count()` as `Self Signed Certs`\r\n| keep `Self Signed Certs`"
                            },
                            "visualization": {
                                "layerId": "d0fa3d75-c6e6-41ec-bd1d-eb6239626707",
                                "layerType": "data",
                                "metricAccessor": "Self Signed Certs"
                            }
                        },
                        "title": "Metric",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "8757d800-b114-456b-8d1c-2737cae7c348",
                    "w": 8,
                    "x": 10,
                    "y": 4
                },
                "panelIndex": "8757d800-b114-456b-8d1c-2737cae7c348",
                "title": "Self Signed Certs [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "This dashboard panel identifies self-signed certificates in use within internal networks, highlighting a key security concern due to their lack of third-party validation. Addressing this issue by transitioning to certificates from trusted authorities enhances network security and trustworthiness.\n\n\n\n\n\n\n",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "a707d9d1-d18f-4ec0-bc87-16463858a8a0",
                    "w": 11,
                    "x": 18,
                    "y": 4
                },
                "panelIndex": "a707d9d1-d18f-4ec0-bc87-16463858a8a0",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865",
                                    "name": "logs-corelight.ssl-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.ssl-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.ssl-*"
                                        }
                                    ],
                                    "layers": {
                                        "3c6d5d2f-97d6-4797-8044-bddf4b247069": {
                                            "columns": [
                                                {
                                                    "columnId": "Less Secure Ciphers",
                                                    "fieldName": "Less Secure Ciphers",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865",
                                            "query": {
                                                "esql": "from logs-corelight.ssl-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"tls\" and observer.hostname is not null and tls.cipher is not null and (tls.cipher like \"*RC4*\" or tls.cipher like \"*DES*\" or tls.cipher like \"*3DES*\" or tls.cipher like \"*MD5*\" or tls.cipher like \"*NULL*\" or tls.cipher like \"*EXPORT*\")\r\n| stats count_distinct(tls.cipher)\r\n| rename `count_distinct(tls.cipher)` as `Less Secure Ciphers`\r\n| keep `Less Secure Ciphers`"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.ssl-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"tls\" and observer.hostname is not null and tls.cipher is not null and (tls.cipher like \"*RC4*\" or tls.cipher like \"*DES*\" or tls.cipher like \"*3DES*\" or tls.cipher like \"*MD5*\" or tls.cipher like \"*NULL*\" or tls.cipher like \"*EXPORT*\")\r\n| stats count_distinct(tls.cipher)\r\n| rename `count_distinct(tls.cipher)` as `Less Secure Ciphers`\r\n| keep `Less Secure Ciphers`"
                            },
                            "visualization": {
                                "layerId": "3c6d5d2f-97d6-4797-8044-bddf4b247069",
                                "layerType": "data",
                                "metricAccessor": "Less Secure Ciphers"
                            }
                        },
                        "title": "Metric",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "65cb107f-949a-4968-bf9f-fa438dca10ca",
                    "w": 8,
                    "x": 29,
                    "y": 4
                },
                "panelIndex": "65cb107f-949a-4968-bf9f-fa438dca10ca",
                "title": "Less Secure Ciphers [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "SSL/TLS sessions utilizing weak cipher suites (eg. RC4) are easily decrypted. This traffic may indicate the presence of old and/or unpatched resources on the network. It could also be the result of a successful downgrade attack.\n\n\n\n\n\n\n",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "440164d1-a9af-4da9-a128-dda24540db06",
                    "w": 11,
                    "x": 37,
                    "y": 4
                },
                "panelIndex": "440164d1-a9af-4da9-a128-dda24540db06",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865",
                                    "name": "logs-corelight.ssl-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.ssl-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.ssl-*"
                                        }
                                    ],
                                    "layers": {
                                        "d99d143b-808b-4f68-a2f8-7337d8bd51b6": {
                                            "columns": [
                                                {
                                                    "columnId": "Subject",
                                                    "fieldName": "Subject",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Destination",
                                                    "fieldName": "Destination",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Status",
                                                    "fieldName": "Status",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865",
                                            "query": {
                                                "esql": "from logs-corelight.ssl-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"tls\" and observer.hostname is not null and ssl.\r\nvalidation_status == \"self signed certificate\"\r\n| stats values(destination.domain), values(ssl.validation_status), values(destination.ip) by destination.ip, destination.domain\r\n| rename `values(destination.domain)` as Subject, `values(destination.ip)` as Destination, `values(ssl.validation_status)` as Status\r\n| keep Subject, Destination, Status"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.ssl-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"tls\" and observer.hostname is not null and ssl.\r\nvalidation_status == \"self signed certificate\"\r\n| stats values(destination.domain), values(ssl.validation_status), values(destination.ip) by destination.ip, destination.domain\r\n| rename `values(destination.domain)` as Subject, `values(destination.ip)` as Destination, `values(ssl.validation_status)` as Status\r\n| keep Subject, Destination, Status"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "Subject"
                                    },
                                    {
                                        "columnId": "Destination"
                                    },
                                    {
                                        "columnId": "Status"
                                    }
                                ],
                                "layerId": "d99d143b-808b-4f68-a2f8-7337d8bd51b6",
                                "layerType": "data"
                            }
                        },
                        "title": "Table Subject \u0026 Destination \u0026 Status",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 15,
                    "i": "f8937613-607b-40c2-9155-2afd6f5426a0",
                    "w": 19,
                    "x": 10,
                    "y": 12
                },
                "panelIndex": "f8937613-607b-40c2-9155-2afd6f5426a0",
                "title": "Network Evidence for Self Signed Internal Certificates [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865",
                                    "name": "logs-corelight.ssl-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.ssl-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.ssl-*"
                                        }
                                    ],
                                    "layers": {
                                        "2ab5c5ab-83af-436d-9031-40dd1d38020f": {
                                            "columns": [
                                                {
                                                    "columnId": "Cipher",
                                                    "fieldName": "Cipher",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "dest_ip",
                                                    "fieldName": "dest_ip",
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Unique_Conns",
                                                    "fieldName": "Unique_Conns",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "Count",
                                                    "fieldName": "Count",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "22ef31a921118149e9248d9055373ee05aa0a1357176fab08d84de81b8045865",
                                            "query": {
                                                "esql": "from logs-corelight.ssl-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"tls\" and observer.hostname is not null and tls.cipher is not null and (tls.cipher like \"*RC4*\" or tls.cipher like \"*DES*\" or tls.cipher like \"*3DES*\" or tls.cipher like \"*MD5*\" or tls.cipher like \"*NULL*\" or tls.cipher like \"*EXPORT*\")\r\n| stats values(destination.ip), count_distinct(event.id), count() by tls.cipher\r\n| eval mv_last(`values(destination.ip)`)\r\n| rename `mv_last(``values(destination.ip)``)` as dest_ip, `count_distinct(event.id)` as Unique_Conns , `count()` as Count, tls.cipher as Cipher\r\n| keep Cipher,dest_ip,Unique_Conns,Count\r\n| sort Unique_Conns desc, Count desc"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.ssl-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"tls\" and observer.hostname is not null and tls.cipher is not null and (tls.cipher like \"*RC4*\" or tls.cipher like \"*DES*\" or tls.cipher like \"*3DES*\" or tls.cipher like \"*MD5*\" or tls.cipher like \"*NULL*\" or tls.cipher like \"*EXPORT*\")\r\n| stats values(destination.ip), count_distinct(event.id), count() by tls.cipher\r\n| eval mv_last(`values(destination.ip)`)\r\n| rename `mv_last(``values(destination.ip)``)` as dest_ip, `count_distinct(event.id)` as Unique_Conns , `count()` as Count, tls.cipher as Cipher\r\n| keep Cipher,dest_ip,Unique_Conns,Count\r\n| sort Unique_Conns desc, Count desc"
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "None",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "Unique_Conns",
                                            "Count"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "2ab5c5ab-83af-436d-9031-40dd1d38020f",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "dest_ip",
                                        "xAccessor": "Cipher"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "Unique_Conns \u0026 Count of Cipher",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 15,
                    "i": "99c231d5-2d4b-43a7-964c-bc9b276f281f",
                    "w": 19,
                    "x": 29,
                    "y": 12
                },
                "panelIndex": "99c231d5-2d4b-43a7-964c-bc9b276f281f",
                "title": "Less Secure Ciphers seen in the period [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                    "name": "logs-corelight.various-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.various-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.various-*"
                                        }
                                    ],
                                    "layers": {
                                        "df0740ad-996f-4bfb-a1d3-84173736b167": {
                                            "columns": [
                                                {
                                                    "columnId": "Automated SSH Session Indicators",
                                                    "fieldName": "Automated SSH Session Indicators",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "query": {
                                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"PKA\", \"The client automatically auth'd using pubkey auth.  This inference applies to only the auth type that succeeded. Before it, publickey or password authentication attempts could have occurred.\",\r\n    ssh.inferences == \"KS\", \"Interactive session\",\r\n    ssh.inferences == \"AUTO\", \"The client was a script or automated utility and not driven by a user\",\r\n    ssh.inferences == \"CTS\", \"The client likely already had an entry in its known_hosts file for this server\"\r\n)\r\n| where Description is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as inference, `count()` as count\r\n| keep uid , src_ip, dest_ip, inference,count\r\n| stats count()\r\n| rename `count()` as `Automated SSH Session Indicators`"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"PKA\", \"The client automatically auth'd using pubkey auth.  This inference applies to only the auth type that succeeded. Before it, publickey or password authentication attempts could have occurred.\",\r\n    ssh.inferences == \"KS\", \"Interactive session\",\r\n    ssh.inferences == \"AUTO\", \"The client was a script or automated utility and not driven by a user\",\r\n    ssh.inferences == \"CTS\", \"The client likely already had an entry in its known_hosts file for this server\"\r\n)\r\n| where Description is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as inference, `count()` as count\r\n| keep uid , src_ip, dest_ip, inference,count\r\n| stats count()\r\n| rename `count()` as `Automated SSH Session Indicators`"
                            },
                            "visualization": {
                                "layerId": "df0740ad-996f-4bfb-a1d3-84173736b167",
                                "layerType": "data",
                                "metricAccessor": "Automated SSH Session Indicators"
                            }
                        },
                        "title": "Metric",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "8c30168d-8cae-44f0-a22d-fb606365a807",
                    "w": 10,
                    "x": 0,
                    "y": 27
                },
                "panelIndex": "8c30168d-8cae-44f0-a22d-fb606365a807",
                "title": "Automated SSH Session Indicators [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "Tracks automated SSH sessions to enhance security and operational efficiency, highlighting potential risks and compliance issues. It identifies anomalies and unauthorized activities, ensuring that automation tools are used securely and efficiently. This tool is crucial for SOC analysts to monitor for security breaches and optimize system management.\n\n\n\n\n",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "bfacac80-d825-40b6-8f49-a20da953b435",
                    "w": 14,
                    "x": 10,
                    "y": 27
                },
                "panelIndex": "bfacac80-d825-40b6-8f49-a20da953b435",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                    "name": "logs-corelight.various-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.various-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.various-*"
                                        }
                                    ],
                                    "layers": {
                                        "eb34cb23-bae6-46db-b726-cff1aac4fb05": {
                                            "columns": [
                                                {
                                                    "columnId": "Interactive Sessions and Keystrokes",
                                                    "fieldName": "Interactive Sessions and Keystrokes",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "query": {
                                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"AUTO\", \"The client is a script automated utility and not driven by a user\",\r\n    ssh.inferences == \"KS\", \"Interactive session\"\r\n)\r\n| where Description is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences , Description\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as inference, `count()` as count\r\n| keep uid , src_ip, dest_ip, inference, Description,count\r\n| stats count()\r\n| rename `count()` as `Interactive Sessions and Keystrokes`"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"AUTO\", \"The client is a script automated utility and not driven by a user\",\r\n    ssh.inferences == \"KS\", \"Interactive session\"\r\n)\r\n| where Description is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences , Description\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as inference, `count()` as count\r\n| keep uid , src_ip, dest_ip, inference, Description,count\r\n| stats count()\r\n| rename `count()` as `Interactive Sessions and Keystrokes`"
                            },
                            "visualization": {
                                "layerId": "eb34cb23-bae6-46db-b726-cff1aac4fb05",
                                "layerType": "data",
                                "metricAccessor": "Interactive Sessions and Keystrokes"
                            }
                        },
                        "title": "Metric",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "564e0a7a-25ae-417a-9103-d8e42ac71b83",
                    "w": 10,
                    "x": 24,
                    "y": 27
                },
                "panelIndex": "564e0a7a-25ae-417a-9103-d8e42ac71b83",
                "title": "Interactive Sessions and Keystrokes [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "Highlight interactive sessions (KS) and automated interactions (AUTO) to understand the nature of SSH traffic  manual vs. automated.\n\n\n\n",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "d005eb33-ff70-4e46-845d-3aca53d2dba9",
                    "w": 14,
                    "x": 34,
                    "y": 27
                },
                "panelIndex": "d005eb33-ff70-4e46-845d-3aca53d2dba9",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                    "name": "logs-corelight.various-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.various-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.various-*"
                                        }
                                    ],
                                    "layers": {
                                        "495f3c21-0b76-4c30-bd24-d10a8ec80019": {
                                            "columns": [
                                                {
                                                    "columnId": "uid",
                                                    "fieldName": "uid",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "src_ip",
                                                    "fieldName": "src_ip",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "dest_ip",
                                                    "fieldName": "dest_ip",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Inferences",
                                                    "fieldName": "Inferences",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Count",
                                                    "fieldName": "Count",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "query": {
                                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"PKA\", \"The client automatically auth'd using pubkey auth.  This inference applies to only the auth type that succeeded. Before it, publickey or password authentication attempts could have occurred.\",\r\n    ssh.inferences == \"KS\", \"Interactive session\",\r\n    ssh.inferences == \"AUTO\", \"The client was a script or automated utility and not driven by a user\",\r\n    ssh.inferences == \"CTS\", \"The client likely already had an entry in its known_hosts file for this server\"\r\n)\r\n| where Description is not null\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as Inferences, `count()` as Count\r\n| keep uid , src_ip, dest_ip, Inferences,Count,Description"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"PKA\", \"The client automatically auth'd using pubkey auth.  This inference applies to only the auth type that succeeded. Before it, publickey or password authentication attempts could have occurred.\",\r\n    ssh.inferences == \"KS\", \"Interactive session\",\r\n    ssh.inferences == \"AUTO\", \"The client was a script or automated utility and not driven by a user\",\r\n    ssh.inferences == \"CTS\", \"The client likely already had an entry in its known_hosts file for this server\"\r\n)\r\n| where Description is not null\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as Inferences, `count()` as Count\r\n| keep uid , src_ip, dest_ip, Inferences,Count,Description"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "uid"
                                    },
                                    {
                                        "columnId": "src_ip"
                                    },
                                    {
                                        "columnId": "dest_ip"
                                    },
                                    {
                                        "columnId": "Inferences"
                                    },
                                    {
                                        "columnId": "Count"
                                    }
                                ],
                                "layerId": "495f3c21-0b76-4c30-bd24-d10a8ec80019",
                                "layerType": "data"
                            }
                        },
                        "title": "Table uid \u0026 src_ip \u0026 dest_ip \u0026 Inferences \u0026 Count",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 15,
                    "i": "4d0c64ce-bfda-47a4-b1fc-107c5e518ea9",
                    "w": 24,
                    "x": 0,
                    "y": 35
                },
                "panelIndex": "4d0c64ce-bfda-47a4-b1fc-107c5e518ea9",
                "title": "SSH Session Inferences [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                    "name": "logs-corelight.various-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.various-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.various-*"
                                        }
                                    ],
                                    "layers": {
                                        "4fbc45bb-a55f-4cb2-ae08-7176a6b75e80": {
                                            "columns": [
                                                {
                                                    "columnId": "uid",
                                                    "fieldName": "uid",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "src_ip",
                                                    "fieldName": "src_ip",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "dest_ip",
                                                    "fieldName": "dest_ip",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Inference",
                                                    "fieldName": "Inference",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Description",
                                                    "fieldName": "Description",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "query": {
                                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"AUTO\", \"The client is a script automated utility and not driven by a user\",\r\n    ssh.inferences == \"KS\", \"Interactive session\"\r\n)\r\n| where Description is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences , Description\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as Inference, `count()` as Count\r\n| keep uid , src_ip, dest_ip, Inference, Description,Count"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"AUTO\", \"The client is a script automated utility and not driven by a user\",\r\n    ssh.inferences == \"KS\", \"Interactive session\"\r\n)\r\n| where Description is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences , Description\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as Inference, `count()` as Count\r\n| keep uid , src_ip, dest_ip, Inference, Description,Count"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "uid"
                                    },
                                    {
                                        "columnId": "src_ip"
                                    },
                                    {
                                        "columnId": "dest_ip"
                                    },
                                    {
                                        "columnId": "Inference"
                                    },
                                    {
                                        "columnId": "Description"
                                    }
                                ],
                                "layerId": "4fbc45bb-a55f-4cb2-ae08-7176a6b75e80",
                                "layerType": "data"
                            }
                        },
                        "title": "Table uid \u0026 src_ip \u0026 dest_ip \u0026 Inference \u0026 Description",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 15,
                    "i": "c9584765-ec26-4349-ac56-2334644105f0",
                    "w": 24,
                    "x": 24,
                    "y": 35
                },
                "panelIndex": "c9584765-ec26-4349-ac56-2334644105f0",
                "title": "Network Evidence for Interactive Sessions and Keystrokes - SSH Inferences [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                    "name": "logs-corelight.various-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.various-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.various-*"
                                        }
                                    ],
                                    "layers": {
                                        "2696ea14-6260-4e27-8d13-fef5178543ba": {
                                            "columns": [
                                                {
                                                    "columnId": "Possible File Uploaded",
                                                    "fieldName": "Possible File Uploaded",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "query": {
                                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"SFD\", \"This indicates a small file download.\",\r\n    ssh.inferences == \"LFD\", \"This indicates a non interactive session where a file was possibly downloaded.\",\r\n    ssh.inferences == \"SFU\", \"This indicates a small file upload.\",\r\n    ssh.inferences == \"LFU\", \"This indicates a non interactive session where a file was possibly uploaded.\"\r\n)\r\n| where Description is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences , Description\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as inference, `count()` as count\r\n| keep uid , src_ip, dest_ip, inference, Description,count\r\n| stats count()\r\n| rename `count()` as `Possible File Uploaded`"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"SFD\", \"This indicates a small file download.\",\r\n    ssh.inferences == \"LFD\", \"This indicates a non interactive session where a file was possibly downloaded.\",\r\n    ssh.inferences == \"SFU\", \"This indicates a small file upload.\",\r\n    ssh.inferences == \"LFU\", \"This indicates a non interactive session where a file was possibly uploaded.\"\r\n)\r\n| where Description is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences , Description\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as inference, `count()` as count\r\n| keep uid , src_ip, dest_ip, inference, Description,count\r\n| stats count()\r\n| rename `count()` as `Possible File Uploaded`"
                            },
                            "visualization": {
                                "layerId": "2696ea14-6260-4e27-8d13-fef5178543ba",
                                "layerType": "data",
                                "metricAccessor": "Possible File Uploaded"
                            }
                        },
                        "title": "Metric",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "e04c757d-27e9-4252-b2f8-3c887eaa3a12",
                    "w": 10,
                    "x": 0,
                    "y": 50
                },
                "panelIndex": "e04c757d-27e9-4252-b2f8-3c887eaa3a12",
                "title": "Possible File Uploaded [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "This use case tracks SSH file transfer activity (inferences SFD, LFD, SFU, LFU). It uncovers potential data exfiltration by attackers or the introduction of malicious files. Focus on file names, sizes, unusual source IPs, and sensitive destination systems.\n\n\n\n",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "985e815c-8bb0-4aa1-8b30-de0c8749a4b7",
                    "w": 14,
                    "x": 10,
                    "y": 50
                },
                "panelIndex": "985e815c-8bb0-4aa1-8b30-de0c8749a4b7",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                    "name": "logs-corelight.various-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.various-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.various-*"
                                        }
                                    ],
                                    "layers": {
                                        "d23d3981-4172-46d8-a72f-0041b2981f74": {
                                            "columns": [
                                                {
                                                    "columnId": "Potential Security Risks",
                                                    "fieldName": "Potential Security Risks",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "query": {
                                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null and ssh.inferences in ( \"SC\", \"SP\", \"SV\", \"SA\", \"AFR\", \"BAN\" )\r\n| stats count() by event.id,source.ip,destination.ip,ssh.inferences\r\n| stats count()\r\n| rename `count()` as `Potential Security Risks`\r\n| keep `Potential Security Risks`"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null and ssh.inferences in ( \"SC\", \"SP\", \"SV\", \"SA\", \"AFR\", \"BAN\" )\r\n| stats count() by event.id,source.ip,destination.ip,ssh.inferences\r\n| stats count()\r\n| rename `count()` as `Potential Security Risks`\r\n| keep `Potential Security Risks`"
                            },
                            "visualization": {
                                "layerId": "d23d3981-4172-46d8-a72f-0041b2981f74",
                                "layerType": "data",
                                "metricAccessor": "Potential Security Risks"
                            }
                        },
                        "title": "Metric",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "8cd93e89-3415-48b0-b4b6-78f955ab6495",
                    "w": 10,
                    "x": 24,
                    "y": 50
                },
                "panelIndex": "8cd93e89-3415-48b0-b4b6-78f955ab6495",
                "title": "Potential Security Risks [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "Monitors for signs of scanning (SC, SP, SV, SA), banner messages (BAN), and agent forwarding (AFR) for compliance and security risk identification.\n\n\n",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "726d6dbb-f327-4110-b7ae-8b78c2c10c38",
                    "w": 14,
                    "x": 34,
                    "y": 50
                },
                "panelIndex": "726d6dbb-f327-4110-b7ae-8b78c2c10c38",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                    "name": "logs-corelight.various-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.various-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.various-*"
                                        }
                                    ],
                                    "layers": {
                                        "7523aa3d-bf35-4d6b-b36e-d294e4375e0c": {
                                            "columns": [
                                                {
                                                    "columnId": "uid",
                                                    "fieldName": "uid",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "src_ip",
                                                    "fieldName": "src_ip",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "dest_ip",
                                                    "fieldName": "dest_ip",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Inference",
                                                    "fieldName": "Inference",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Description",
                                                    "fieldName": "Description",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "query": {
                                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"SFD\", \"This indicates a small file download.\",\r\n    ssh.inferences == \"LFD\", \"This indicates a non interactive session where a file was possibly downloaded.\",\r\n    ssh.inferences == \"SFU\", \"This indicates a small file upload.\",\r\n    ssh.inferences == \"LFU\", \"This indicates a non interactive session where a file was possibly uploaded.\"\r\n)\r\n| where Description is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences , Description\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as Inference, `count()` as Count\r\n| keep uid , src_ip, dest_ip, Inference, Description,Count"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"SFD\", \"This indicates a small file download.\",\r\n    ssh.inferences == \"LFD\", \"This indicates a non interactive session where a file was possibly downloaded.\",\r\n    ssh.inferences == \"SFU\", \"This indicates a small file upload.\",\r\n    ssh.inferences == \"LFU\", \"This indicates a non interactive session where a file was possibly uploaded.\"\r\n)\r\n| where Description is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences , Description\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as Inference, `count()` as Count\r\n| keep uid , src_ip, dest_ip, Inference, Description,Count"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "uid"
                                    },
                                    {
                                        "columnId": "src_ip"
                                    },
                                    {
                                        "columnId": "dest_ip"
                                    },
                                    {
                                        "columnId": "Inference"
                                    },
                                    {
                                        "columnId": "Description"
                                    }
                                ],
                                "layerId": "7523aa3d-bf35-4d6b-b36e-d294e4375e0c",
                                "layerType": "data"
                            }
                        },
                        "title": "Table uid \u0026 src_ip \u0026 dest_ip \u0026 Inference \u0026 Description",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 15,
                    "i": "dce1fa2b-fb4d-4922-b8b8-9ad9e93afd09",
                    "w": 24,
                    "x": 0,
                    "y": 58
                },
                "panelIndex": "dce1fa2b-fb4d-4922-b8b8-9ad9e93afd09",
                "title": "Possible File Transfer [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                    "name": "logs-corelight.various-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.various-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.various-*"
                                        }
                                    ],
                                    "layers": {
                                        "368cec63-5aa4-4e0e-948a-c72d88fffb30": {
                                            "columns": [
                                                {
                                                    "columnId": "uid",
                                                    "fieldName": "uid",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "src_ip",
                                                    "fieldName": "src_ip",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "dest_ip",
                                                    "fieldName": "dest_ip",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Count",
                                                    "fieldName": "Count",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                },
                                                {
                                                    "columnId": "Inferences",
                                                    "fieldName": "Inferences",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "query": {
                                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null and ssh.inferences in ( \"SC\", \"SP\", \"SV\", \"SA\", \"AFR\", \"BAN\" )\r\n| stats count() by event.id,source.ip,destination.ip,ssh.inferences\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip,`count()` as Count, ssh.inferences as Inferences\r\n| keep uid, src_ip,dest_ip,Count,Inferences"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null and ssh.inferences in ( \"SC\", \"SP\", \"SV\", \"SA\", \"AFR\", \"BAN\" )\r\n| stats count() by event.id,source.ip,destination.ip,ssh.inferences\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip,`count()` as Count, ssh.inferences as Inferences\r\n| keep uid, src_ip,dest_ip,Count,Inferences"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "uid"
                                    },
                                    {
                                        "columnId": "src_ip"
                                    },
                                    {
                                        "columnId": "dest_ip"
                                    },
                                    {
                                        "columnId": "Count"
                                    },
                                    {
                                        "columnId": "Inferences"
                                    }
                                ],
                                "layerId": "368cec63-5aa4-4e0e-948a-c72d88fffb30",
                                "layerType": "data"
                            }
                        },
                        "title": "Table uid \u0026 src_ip \u0026 dest_ip \u0026 Count \u0026 Inferences",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 15,
                    "i": "6b380f80-d573-49ce-951b-121efac754a0",
                    "w": 24,
                    "x": 24,
                    "y": 58
                },
                "panelIndex": "6b380f80-d573-49ce-951b-121efac754a0",
                "title": "SSH Inferences for Potential Security Risks [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                    "name": "logs-corelight.various-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.various-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.various-*"
                                        }
                                    ],
                                    "layers": {
                                        "8a1695cf-2393-4091-8b98-a6149628d4ca": {
                                            "columns": [
                                                {
                                                    "columnId": "Advanced Threat Indicators",
                                                    "fieldName": "Advanced Threat Indicators",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "query": {
                                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"ABP\", \"The client did not complete the SSH state machine for authentication and likely sent the server an exploit\",\r\n    ssh.inferences == \"RSP\", \"The client connected with a -R flag, which provisions the ports to be used for a Reverse Session to be set up at any point onwards. ssh -R 31337:localhost:22 user@192.168.20.33\",\r\n    ssh.inferences == \"RSI\", \"The Reverse session is inititated from the server back to the Client. This initiation can be done at any stage during the session. From the Server, the attacker would initiate the Reverse session by e.g.ssh victim@localhost -p 31337\",\r\n    ssh.inferences == \"RSIA\", \"The inititation of the Reverse session happened very early in the packet stream, indicating automation\",\r\n    ssh.inferences == \"RSL\", \"The Reverse tunnel login login has succeeded, the attacker now has shell on the victim's device\",\r\n    ssh.inferences == \"RSK\", \"Keystrokes are detected within the Reverse tunnel\"\r\n)\r\n| where Description is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as inference, `count()` as count\r\n| keep uid , src_ip, dest_ip, inference,count\r\n| stats count()\r\n| rename `count()` as `Advanced Threat Indicators`\r\n| keep `Advanced Threat Indicators`"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences \r\n| eval Description =case(\r\n    ssh.inferences == \"ABP\", \"The client did not complete the SSH state machine for authentication and likely sent the server an exploit\",\r\n    ssh.inferences == \"RSP\", \"The client connected with a -R flag, which provisions the ports to be used for a Reverse Session to be set up at any point onwards. ssh -R 31337:localhost:22 user@192.168.20.33\",\r\n    ssh.inferences == \"RSI\", \"The Reverse session is inititated from the server back to the Client. This initiation can be done at any stage during the session. From the Server, the attacker would initiate the Reverse session by e.g.ssh victim@localhost -p 31337\",\r\n    ssh.inferences == \"RSIA\", \"The inititation of the Reverse session happened very early in the packet stream, indicating automation\",\r\n    ssh.inferences == \"RSL\", \"The Reverse tunnel login login has succeeded, the attacker now has shell on the victim's device\",\r\n    ssh.inferences == \"RSK\", \"Keystrokes are detected within the Reverse tunnel\"\r\n)\r\n| where Description is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as inference, `count()` as count\r\n| keep uid , src_ip, dest_ip, inference,count\r\n| stats count()\r\n| rename `count()` as `Advanced Threat Indicators`\r\n| keep `Advanced Threat Indicators`"
                            },
                            "visualization": {
                                "layerId": "8a1695cf-2393-4091-8b98-a6149628d4ca",
                                "layerType": "data",
                                "metricAccessor": "Advanced Threat Indicators"
                            }
                        },
                        "title": "Metric",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {},
                    "hidePanelTitles": true
                },
                "gridData": {
                    "h": 8,
                    "i": "8c39dd0f-4379-4825-a794-6c28983302a8",
                    "w": 10,
                    "x": 0,
                    "y": 73
                },
                "panelIndex": "8c39dd0f-4379-4825-a794-6c28983302a8",
                "title": "Advanced Threat Indicators [Logs Corelight]",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": true,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "Helps to identify potential advanced threat indicators such as Client Authentication Bypass (ABP) and Reverse SSH tunneling activities (RSP, RSI, RSIA, RSL, RSK) for in-depth investigation.\n\n\n\n\n\n",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 8,
                    "i": "8c5339cd-4ba2-4f10-ab14-38bb533f35d6",
                    "w": 14,
                    "x": 10,
                    "y": 73
                },
                "panelIndex": "8c5339cd-4ba2-4f10-ab14-38bb533f35d6",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                    "name": "logs-corelight.various-*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.various-*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.various-*"
                                        }
                                    ],
                                    "layers": {
                                        "9f0a36b7-f323-48db-a4ec-0376e36aa6c0": {
                                            "columns": [
                                                {
                                                    "columnId": "uid",
                                                    "fieldName": "uid",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "src_ip",
                                                    "fieldName": "src_ip",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "dest_ip",
                                                    "fieldName": "dest_ip",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Inference",
                                                    "fieldName": "Inference",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Count",
                                                    "fieldName": "Count",
                                                    "inMetricDimension": true,
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "b2bcbb11fd7b30e2a9f2ee93a6a5ffd1f700ee82fff0bfc92dd439c707a35ebb",
                                            "query": {
                                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences\r\n| eval Description =case(\r\n    ssh.inferences == \"ABP\", \"The client did not complete the SSH state machine for authentication and likely sent the server an exploit\",\r\n    ssh.inferences == \"RSP\", \"The client connected with a -R flag, which provisions the ports to be used for a Reverse Session to be set up at any point onwards. ssh -R 31337:localhost:22 user@192.168.20.33\",\r\n    ssh.inferences == \"RSI\", \"The Reverse session is inititated from the server back to the Client. This initiation can be done at any stage during the session. From the Server, the attacker would initiate the Reverse session by e.g.ssh victim@localhost -p 31337\",\r\n    ssh.inferences == \"RSIA\", \"The inititation of the Reverse session happened very early in the packet stream, indicating automation\",\r\n    ssh.inferences == \"RSL\", \"The Reverse tunnel login login has succeeded, the attacker now has shell on the victim's device\",\r\n    ssh.inferences == \"RSK\", \"Keystrokes are detected within the Reverse tunnel\"\r\n)\r\n| where Description is not null\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as Inference, `count()` as Count\r\n| keep uid , src_ip, dest_ip, Inference,Count, Description"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "query": {
                                "esql": "from logs-corelight.various-*\r\n| limit 10000\r\n| where observer.vendor == \"Corelight\" and event.dataset == \"ssh\" and observer.hostname is not null\r\n| stats count() by event.id, source.ip, destination.ip, ssh.inferences\r\n| eval Description =case(\r\n    ssh.inferences == \"ABP\", \"The client did not complete the SSH state machine for authentication and likely sent the server an exploit\",\r\n    ssh.inferences == \"RSP\", \"The client connected with a -R flag, which provisions the ports to be used for a Reverse Session to be set up at any point onwards. ssh -R 31337:localhost:22 user@192.168.20.33\",\r\n    ssh.inferences == \"RSI\", \"The Reverse session is inititated from the server back to the Client. This initiation can be done at any stage during the session. From the Server, the attacker would initiate the Reverse session by e.g.ssh victim@localhost -p 31337\",\r\n    ssh.inferences == \"RSIA\", \"The inititation of the Reverse session happened very early in the packet stream, indicating automation\",\r\n    ssh.inferences == \"RSL\", \"The Reverse tunnel login login has succeeded, the attacker now has shell on the victim's device\",\r\n    ssh.inferences == \"RSK\", \"Keystrokes are detected within the Reverse tunnel\"\r\n)\r\n| where Description is not null\r\n| rename event.id as uid, source.ip as src_ip, destination.ip as dest_ip, ssh.inferences as Inference, `count()` as Count\r\n| keep uid , src_ip, dest_ip, Inference,Count, Description"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "uid"
                                    },
                                    {
                                        "columnId": "src_ip"
                                    },
                                    {
                                        "columnId": "dest_ip"
                                    },
                                    {
                                        "columnId": "Inference"
                                    },
                                    {
                                        "columnId": "Count"
                                    }
                                ],
                                "layerId": "9f0a36b7-f323-48db-a4ec-0376e36aa6c0",
                                "layerType": "data"
                            }
                        },
                        "title": "Table uid \u0026 src_ip \u0026 dest_ip \u0026 Inference \u0026 Count",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "disabledActions": [
                        "OPEN_FLYOUT_ADD_DRILLDOWN"
                    ],
                    "enhancements": {}
                },
                "gridData": {
                    "h": 15,
                    "i": "3512af68-12fa-4aa3-8721-1af3dfcf1052",
                    "w": 24,
                    "x": 0,
                    "y": 81
                },
                "panelIndex": "3512af68-12fa-4aa3-8721-1af3dfcf1052",
                "title": "SSH Advanced Threats Inferences [Logs Corelight]",
                "type": "lens"
            }
        ],
        "refreshInterval": {
            "pause": true,
            "value": 60000
        },
        "timeFrom": "now-24h",
        "timeRestore": true,
        "timeTo": "now",
        "title": "[Logs Corelight] Secure Channel Insights",
        "version": 2
    },
    "coreMigrationVersion": "8.8.0",
    "created_at": "2024-11-06T06:41:37.294Z",
    "id": "corelight-45197477-c13f-4e52-a5dd-fb4f53564963",
    "managed": false,
    "references": [
        {
            "id": "logs-*",
            "name": "controlGroup_b7b4bc2e-98d1-453a-a412-a37228a386b1:optionsListDataView",
            "type": "index-pattern"
        }
    ],
    "type": "dashboard",
    "typeMigrationVersion": "10.2.0"
}