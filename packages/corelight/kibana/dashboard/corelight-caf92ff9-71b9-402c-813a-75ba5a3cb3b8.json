{
    "attributes": {
        "controlGroupInput": {
            "chainingSystem": "HIERARCHICAL",
            "controlStyle": "oneLine",
            "ignoreParentSettingsJSON": {
                "ignoreFilters": false,
                "ignoreQuery": false,
                "ignoreTimerange": false,
                "ignoreValidations": false
            },
            "panelsJSON": {
                "063e2fd9-659e-4362-95f8-7057d21e631d": {
                    "explicitInput": {
                        "dataViewId": "logs-*",
                        "fieldName": "network.direction",
                        "searchTechnique": "prefix",
                        "selectedOptions": [],
                        "sort": {
                            "by": "_count",
                            "direction": "desc"
                        },
                        "title": "Direction"
                    },
                    "grow": true,
                    "order": 4,
                    "type": "optionsListControl",
                    "width": "medium"
                },
                "0a0b3611-3250-476d-b19c-953963299235": {
                    "explicitInput": {
                        "dataViewId": "logs-*",
                        "fieldName": "resp_inst.org_id",
                        "searchTechnique": "prefix",
                        "selectedOptions": [],
                        "sort": {
                            "by": "_count",
                            "direction": "desc"
                        },
                        "title": "Destination AWS Organization ID"
                    },
                    "grow": true,
                    "order": 6,
                    "type": "optionsListControl",
                    "width": "medium"
                },
                "146e6c58-7fe4-484c-a64c-359ec9a24ecc": {
                    "explicitInput": {
                        "dataViewId": "logs-*",
                        "exclude": false,
                        "existsSelected": false,
                        "fieldName": "source.ip",
                        "runPastTimeout": false,
                        "searchTechnique": "prefix",
                        "selectedOptions": [],
                        "singleSelect": false,
                        "sort": {
                            "by": "_count",
                            "direction": "desc"
                        },
                        "title": "Source IP"
                    },
                    "grow": true,
                    "order": 2,
                    "type": "optionsListControl",
                    "width": "medium"
                },
                "388044d3-36a5-45c8-a5bf-0d7fe1f20464": {
                    "explicitInput": {
                        "dataViewId": "logs-*",
                        "fieldName": "capture_metadata.vpc.vpc_id",
                        "searchTechnique": "prefix",
                        "selectedOptions": [],
                        "singleSelect": false,
                        "sort": {
                            "by": "_count",
                            "direction": "desc"
                        },
                        "title": "VPC ID"
                    },
                    "grow": true,
                    "order": 1,
                    "type": "optionsListControl",
                    "width": "medium"
                },
                "8e126021-859a-41c0-b84a-9a44551c1c05": {
                    "explicitInput": {
                        "dataViewId": "logs-*",
                        "fieldName": "orig_inst.org_id",
                        "searchTechnique": "prefix",
                        "selectedOptions": [],
                        "singleSelect": true,
                        "sort": {
                            "by": "_count",
                            "direction": "desc"
                        },
                        "title": "Source AWS Organization ID"
                    },
                    "grow": true,
                    "order": 5,
                    "type": "optionsListControl",
                    "width": "medium"
                },
                "c6d88a1f-5878-4db7-b89c-33ecb859e140": {
                    "explicitInput": {
                        "dataViewId": "logs-*",
                        "fieldName": "observer.hostname",
                        "searchTechnique": "prefix",
                        "selectedOptions": [],
                        "singleSelect": true,
                        "sort": {
                            "by": "_count",
                            "direction": "desc"
                        },
                        "title": "Corelight Sensor"
                    },
                    "grow": true,
                    "order": 0,
                    "type": "optionsListControl",
                    "width": "medium"
                },
                "fa4eaca2-46e1-45d4-a4a0-4ca99e7c21eb": {
                    "explicitInput": {
                        "dataViewId": "logs-*",
                        "fieldName": "destination.ip",
                        "searchTechnique": "prefix",
                        "selectedOptions": [],
                        "sort": {
                            "by": "_count",
                            "direction": "desc"
                        },
                        "title": "Destination IP"
                    },
                    "grow": true,
                    "order": 3,
                    "type": "optionsListControl",
                    "width": "medium"
                }
            },
            "showApplySelections": false
        },
        "description": "",
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": {
                "filter": [
                    {
                        "$state": {
                            "store": "appState"
                        },
                        "meta": {
                            "alias": null,
                            "disabled": false,
                            "field": "observer.vendor",
                            "indexRefName": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
                            "key": "observer.vendor",
                            "negate": false,
                            "params": {
                                "query": "Corelight"
                            },
                            "type": "phrase"
                        },
                        "query": {
                            "match_phrase": {
                                "observer.vendor": "Corelight"
                            }
                        }
                    }
                ],
                "query": {
                    "language": "kuery",
                    "query": ""
                }
            }
        },
        "optionsJSON": {
            "hidePanelTitles": false,
            "syncColors": false,
            "syncCursor": true,
            "syncTooltips": false,
            "useMargins": true
        },
        "panelsJSON": [
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-d0f1264a-3a68-434d-8e77-02466186f0e3",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "d0f1264a-3a68-434d-8e77-02466186f0e3": {
                                            "columnOrder": [
                                                "626ce7b1-3ef7-4964-8f53-1f6b429d47f3",
                                                "84ed0b33-79d9-4868-8a4b-925d1d8ea229"
                                            ],
                                            "columns": {
                                                "626ce7b1-3ef7-4964-8f53-1f6b429d47f3": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Source Country",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "84ed0b33-79d9-4868-8a4b-925d1d8ea229",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10000
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "source.geo.country_iso_code"
                                                },
                                                "84ed0b33-79d9-4868-8a4b-925d1d8ea229": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Session ID",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "event.id"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {}
                                },
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "logs-*",
                                            "timeField": "@timestamp",
                                            "title": "logs-*"
                                        }
                                    ],
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "logs-*",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "logs-*",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "logs-*",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "logs-*",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "logs-*",
                                        "key": "network.direction",
                                        "negate": false,
                                        "params": {
                                            "query": "inbound"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "network.direction": "inbound"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "logs-*",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layerId": "d0f1264a-3a68-434d-8e77-02466186f0e3",
                                "layerType": "data",
                                "regionAccessor": "626ce7b1-3ef7-4964-8f53-1f6b429d47f3",
                                "valueAccessor": "84ed0b33-79d9-4868-8a4b-925d1d8ea229"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsChoropleth"
                    },
                    "description": "Identifying inbound connections to your organization's AWS VPC",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "params": {
                                    "query": "inbound"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "network.direction": "inbound"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "79b479b3-ab96-4b3e-84b1-998dc63b634b",
                    "w": 29,
                    "x": 0,
                    "y": 75
                },
                "panelIndex": "79b479b3-ab96-4b3e-84b1-998dc63b634b",
                "title": "Inbound Connections by Source Country",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-d0f1264a-3a68-434d-8e77-02466186f0e3",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "d0f1264a-3a68-434d-8e77-02466186f0e3": {
                                            "columnOrder": [
                                                "626ce7b1-3ef7-4964-8f53-1f6b429d47f3",
                                                "84ed0b33-79d9-4868-8a4b-925d1d8ea229"
                                            ],
                                            "columns": {
                                                "626ce7b1-3ef7-4964-8f53-1f6b429d47f3": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Destination Country",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "84ed0b33-79d9-4868-8a4b-925d1d8ea229",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10000
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "destination.geo.country_iso_code"
                                                },
                                                "84ed0b33-79d9-4868-8a4b-925d1d8ea229": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Session ID",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "event.id"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "logs-*",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "logs-*",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "logs-*",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "logs-*",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "logs-*",
                                        "key": "network.direction",
                                        "negate": false,
                                        "params": {
                                            "query": "outbound"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "network.direction": "outbound"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "logs-*",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layerId": "d0f1264a-3a68-434d-8e77-02466186f0e3",
                                "layerType": "data",
                                "regionAccessor": "626ce7b1-3ef7-4964-8f53-1f6b429d47f3",
                                "valueAccessor": "84ed0b33-79d9-4868-8a4b-925d1d8ea229"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsChoropleth"
                    },
                    "description": "Identifying outbound connections from your organization's AWS VPC",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "params": {
                                    "query": "outbound"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "network.direction": "outbound"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "df56cedd-65fe-4fd6-95df-457dbe1f74d7",
                    "w": 29,
                    "x": 0,
                    "y": 89
                },
                "panelIndex": "df56cedd-65fe-4fd6-95df-457dbe1f74d7",
                "title": "Outbound Connections by Destination Country",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "7abc0ea4-73fb-4e9a-95db-e9e85873f982",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "75750924-a6c8-4d14-982e-078b2d29755e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "a432253f-07b7-4990-aa94-9993fcc76176",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "02a52305-2b97-4f2c-8c23-42e44bb158fc",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "d33b2a4f-e773-4ce4-80c4-49a505ef7bb8",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "91d1ca62-5bff-4e08-9239-89748529edf6",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "50c044bc-ae03-479b-bf7c-10ee6f6b62df",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX0",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX1",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX2"
                                            ],
                                            "columns": {
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Total Volume",
                                                    "operationType": "formula",
                                                    "params": {
                                                        "format": {
                                                            "id": "bytes",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        },
                                                        "formula": "sum(source.bytes) + sum(destination.bytes)",
                                                        "isFormulaBroken": false
                                                    },
                                                    "references": [
                                                        "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX2"
                                                    ],
                                                    "scale": "ratio"
                                                },
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX0": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Total Volume",
                                                    "operationType": "sum",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.bytes"
                                                },
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX1": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Total Volume",
                                                    "operationType": "sum",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "destination.bytes"
                                                },
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX2": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Total Volume",
                                                    "operationType": "math",
                                                    "params": {
                                                        "tinymathAst": {
                                                            "args": [
                                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX0",
                                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX1"
                                                            ],
                                                            "location": {
                                                                "max": 42,
                                                                "min": 0
                                                            },
                                                            "name": "add",
                                                            "text": "sum(source.bytes) + sum(destination.bytes)",
                                                            "type": "function"
                                                        }
                                                    },
                                                    "references": [
                                                        "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX0",
                                                        "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX1"
                                                    ],
                                                    "scale": "ratio"
                                                },
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Median of source.bytes",
                                                    "operationType": "median",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.bytes"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "7abc0ea4-73fb-4e9a-95db-e9e85873f982",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "75750924-a6c8-4d14-982e-078b2d29755e",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "a432253f-07b7-4990-aa94-9993fcc76176",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "02a52305-2b97-4f2c-8c23-42e44bb158fc",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "d33b2a4f-e773-4ce4-80c4-49a505ef7bb8",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "91d1ca62-5bff-4e08-9239-89748529edf6",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "50c044bc-ae03-479b-bf7c-10ee6f6b62df",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                "layerType": "data",
                                "metricAccessor": "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b",
                                "showBar": false
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 7,
                    "i": "5209ae73-e40d-42dc-a1a5-58d39c4eafe6",
                    "w": 9,
                    "x": 12,
                    "y": 0
                },
                "panelIndex": "5209ae73-e40d-42dc-a1a5-58d39c4eafe6",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "87c04943-fd51-4aee-96ca-bd6750742106",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "b5050370-9360-42d6-9a1c-1cfc659ce894",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "afdd6c0e-49e4-452a-addb-56c8c7b321fc",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "9c314438-6b71-47a5-9580-3a7ee9d802b5",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "0830b582-0ee7-4245-909a-78af8be04f2c",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "d03f8f9a-91c7-4fd8-9bb0-509f99b73ed2",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "50d72482-aba3-41a2-bfbe-a09b888fd44f",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b"
                                            ],
                                            "columns": {
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Total Connections",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "event.id"
                                                },
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Median of source.bytes",
                                                    "operationType": "median",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.bytes"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "87c04943-fd51-4aee-96ca-bd6750742106",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "b5050370-9360-42d6-9a1c-1cfc659ce894",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "afdd6c0e-49e4-452a-addb-56c8c7b321fc",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "9c314438-6b71-47a5-9580-3a7ee9d802b5",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "0830b582-0ee7-4245-909a-78af8be04f2c",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "d03f8f9a-91c7-4fd8-9bb0-509f99b73ed2",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "50d72482-aba3-41a2-bfbe-a09b888fd44f",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                "layerType": "data",
                                "metricAccessor": "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b",
                                "showBar": false,
                                "trendlineBreakdownByAccessor": null,
                                "trendlineLayerId": null,
                                "trendlineLayerType": null,
                                "trendlineMetricAccessor": null,
                                "trendlineTimeAccessor": null
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 7,
                    "i": "1a29cb63-2562-4091-a650-544075715729",
                    "w": 9,
                    "x": 21,
                    "y": 0
                },
                "panelIndex": "1a29cb63-2562-4091-a650-544075715729",
                "title": "",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "27d23ca9-3464-4832-8cfe-728a6a25a6fb",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "8363c330-2e95-4b70-9303-88b54ca36f17",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "a1d023e3-f3da-4b8c-94aa-76e6347d916e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "3510f2bb-17f6-4ad2-9179-c29acddfe03b",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "2f4e225e-244d-444c-bc09-be4303c98417",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "342c7c8d-4280-474d-abeb-401b037b0ddf",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "feeebf53-d61e-4362-b82a-6450d8312ebf",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b"
                                            ],
                                            "columns": {
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Unique Source IPs",
                                                    "operationType": "unique_count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.ip"
                                                },
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Median of source.bytes",
                                                    "operationType": "median",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.bytes"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "27d23ca9-3464-4832-8cfe-728a6a25a6fb",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "8363c330-2e95-4b70-9303-88b54ca36f17",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "a1d023e3-f3da-4b8c-94aa-76e6347d916e",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "3510f2bb-17f6-4ad2-9179-c29acddfe03b",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "2f4e225e-244d-444c-bc09-be4303c98417",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "342c7c8d-4280-474d-abeb-401b037b0ddf",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "feeebf53-d61e-4362-b82a-6450d8312ebf",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                "layerType": "data",
                                "metricAccessor": "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b",
                                "showBar": false,
                                "trendlineBreakdownByAccessor": null,
                                "trendlineLayerId": null,
                                "trendlineLayerType": null,
                                "trendlineMetricAccessor": null,
                                "trendlineTimeAccessor": null
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 7,
                    "i": "efea7128-c873-409b-aebe-a301fe01d895",
                    "w": 9,
                    "x": 30,
                    "y": 0
                },
                "panelIndex": "efea7128-c873-409b-aebe-a301fe01d895",
                "title": "",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "043828ff-1a11-4991-af7b-558b04c750d5",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "ac10368d-9930-4a89-ba90-5070529f990d",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "dcaa8554-ff5e-43d6-b648-96184d40749b",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "61c093c5-bb4c-4f1f-867e-3dbbdd6aaff4",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "ab565996-6195-4090-bad8-5da60194d85f",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "feeeddbd-53d8-46ce-9ffb-c70086a1a5a4",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "ff869537-1e64-41f0-a6f5-a21cd9dee237",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b"
                                            ],
                                            "columns": {
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "filter": null,
                                                    "isBucketed": false,
                                                    "label": "Unique Destination IPs",
                                                    "operationType": "unique_count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "compact": false,
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "reducedTimeRange": null,
                                                    "scale": "ratio",
                                                    "sourceField": "destination.ip",
                                                    "timeShift": null
                                                },
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Median of source.bytes",
                                                    "operationType": "median",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.bytes"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "043828ff-1a11-4991-af7b-558b04c750d5",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "ac10368d-9930-4a89-ba90-5070529f990d",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "dcaa8554-ff5e-43d6-b648-96184d40749b",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "61c093c5-bb4c-4f1f-867e-3dbbdd6aaff4",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "ab565996-6195-4090-bad8-5da60194d85f",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "feeeddbd-53d8-46ce-9ffb-c70086a1a5a4",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "ff869537-1e64-41f0-a6f5-a21cd9dee237",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                "layerType": "data",
                                "metricAccessor": "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b",
                                "showBar": false,
                                "trendlineBreakdownByAccessor": null,
                                "trendlineLayerId": null,
                                "trendlineLayerType": null,
                                "trendlineMetricAccessor": null,
                                "trendlineTimeAccessor": null
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 7,
                    "i": "a45cba37-e588-4e13-a501-7a890827d4a2",
                    "w": 9,
                    "x": 39,
                    "y": 0
                },
                "panelIndex": "a45cba37-e588-4e13-a501-7a890827d4a2",
                "title": "",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "0cc9f377-1ec1-4ba4-9caf-0e1de2fd35d4",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b"
                                            ],
                                            "columns": {
                                                "0cc9f377-1ec1-4ba4-9caf-0e1de2fd35d4": {
                                                    "dataType": "date",
                                                    "isBucketed": true,
                                                    "label": "@timestamp",
                                                    "operationType": "date_histogram",
                                                    "params": {
                                                        "dropPartials": false,
                                                        "includeEmptyRows": false,
                                                        "interval": "auto"
                                                    },
                                                    "scale": "interval",
                                                    "sourceField": "@timestamp"
                                                },
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "filter": null,
                                                    "isBucketed": false,
                                                    "label": "unique destinations",
                                                    "operationType": "unique_count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "reducedTimeRange": null,
                                                    "scale": "ratio",
                                                    "sourceField": "destination.ip",
                                                    "timeShift": null
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "logs-*",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "logs-*",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "logs-*",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "logs-*",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "logs-*",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "logs-*",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "logs-*",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                        "layerType": "data",
                                        "seriesType": "line",
                                        "xAccessor": "0cc9f377-1ec1-4ba4-9caf-0e1de2fd35d4"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "line",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 8,
                    "i": "8b17e388-b864-434f-9292-d42753c329c7",
                    "w": 9,
                    "x": 39,
                    "y": 7
                },
                "panelIndex": "8b17e388-b864-434f-9292-d42753c329c7",
                "title": "",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "a43c89ea-e1c3-4983-a096-fa60852bd5f7",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b"
                                            ],
                                            "columns": {
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "unique sources",
                                                    "operationType": "unique_count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.ip"
                                                },
                                                "a43c89ea-e1c3-4983-a096-fa60852bd5f7": {
                                                    "dataType": "date",
                                                    "isBucketed": true,
                                                    "label": "@timestamp",
                                                    "operationType": "date_histogram",
                                                    "params": {
                                                        "dropPartials": false,
                                                        "includeEmptyRows": false,
                                                        "interval": "auto"
                                                    },
                                                    "scale": "interval",
                                                    "sourceField": "@timestamp"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "logs-*",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "logs-*",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "logs-*",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "logs-*",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "logs-*",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "logs-*",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "logs-*",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                        "layerType": "data",
                                        "seriesType": "line",
                                        "xAccessor": "a43c89ea-e1c3-4983-a096-fa60852bd5f7"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "line",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 8,
                    "i": "baa08342-f7a7-4ead-bafe-57bf35e90837",
                    "w": 9,
                    "x": 30,
                    "y": 7
                },
                "panelIndex": "baa08342-f7a7-4ead-bafe-57bf35e90837",
                "title": "",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "42708bb5-f083-4a1b-b2de-2e6cb6878ce7",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "12490d5c-6f51-4a1e-91c4-a914eb7b497e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "a3006dcd-c8b9-48a4-a5cd-dde9e87c26eb",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "98d59e33-dc48-4559-b867-ca6830d47cc5",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "b58e858f-f4a3-496a-8d1a-5f635db5da99",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "701f265b-5d26-4ffd-a4c7-434b298a476b",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "f7333720-18de-470d-b3a2-60a009dd16c7",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "5fc0075b-101f-43c6-8de1-9fc81936e793",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b"
                                            ],
                                            "columns": {
                                                "5fc0075b-101f-43c6-8de1-9fc81936e793": {
                                                    "customLabel": false,
                                                    "dataType": "date",
                                                    "isBucketed": true,
                                                    "label": "@timestamp",
                                                    "operationType": "date_histogram",
                                                    "params": {
                                                        "dropPartials": false,
                                                        "includeEmptyRows": false,
                                                        "interval": "auto"
                                                    },
                                                    "scale": "interval",
                                                    "sourceField": "@timestamp"
                                                },
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "connections",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "event.id"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "42708bb5-f083-4a1b-b2de-2e6cb6878ce7",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "12490d5c-6f51-4a1e-91c4-a914eb7b497e",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "a3006dcd-c8b9-48a4-a5cd-dde9e87c26eb",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "98d59e33-dc48-4559-b867-ca6830d47cc5",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "b58e858f-f4a3-496a-8d1a-5f635db5da99",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "701f265b-5d26-4ffd-a4c7-434b298a476b",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "f7333720-18de-470d-b3a2-60a009dd16c7",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                        "layerType": "data",
                                        "seriesType": "line",
                                        "xAccessor": "5fc0075b-101f-43c6-8de1-9fc81936e793"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "line",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 8,
                    "i": "14ce901c-bd47-4c98-abb9-90c54727985e",
                    "w": 9,
                    "x": 21,
                    "y": 7
                },
                "panelIndex": "14ce901c-bd47-4c98-abb9-90c54727985e",
                "title": "",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-3b97646d-b562-43e7-8e91-2daac479a1cc",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "868264ad-1815-4c35-a4e2-b1cbdad0d327",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "0de0d2df-a20d-4d1b-b3c6-e651d40757f8",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "5b4dca52-96a0-4513-97a2-a176d8cef1e7",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "2518fdab-da72-4f8e-bcb2-80fc3e5f74a8",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "31473c95-9765-4b59-a017-2a5c3cc08905",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "eb1000ac-f1ab-4f7b-ac8c-96d6b08d710e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "8c61b00a-d3d8-4baa-88e2-016614d2da62",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "3b97646d-b562-43e7-8e91-2daac479a1cc": {
                                            "columnOrder": [
                                                "ea2c579a-2390-43e2-afeb-30a0918612a5",
                                                "2a3d9924-faf5-463d-aa14-fa7ae1ab8a71",
                                                "68da99e1-d3da-4289-af3d-df03ddb1622d",
                                                "70fe1b8c-7044-4cfc-9eb8-d20ac7cf8060",
                                                "f401e2c1-9227-4c88-af3f-5421129e79ba"
                                            ],
                                            "columns": {
                                                "2a3d9924-faf5-463d-aa14-fa7ae1ab8a71": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Transport",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderAgg": null,
                                                        "orderBy": {
                                                            "columnId": "f401e2c1-9227-4c88-af3f-5421129e79ba",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": null,
                                                        "size": 20
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "network.transport"
                                                },
                                                "68da99e1-d3da-4289-af3d-df03ddb1622d": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": true,
                                                    "label": "Destination Port",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "accuracyMode": true,
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "f401e2c1-9227-4c88-af3f-5421129e79ba",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 20
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "destination.port"
                                                },
                                                "70fe1b8c-7044-4cfc-9eb8-d20ac7cf8060": {
                                                    "customLabel": true,
                                                    "dataType": "ip",
                                                    "isBucketed": true,
                                                    "label": "Destination IP",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "accuracyMode": true,
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderAgg": null,
                                                        "orderBy": {
                                                            "columnId": "f401e2c1-9227-4c88-af3f-5421129e79ba",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": null,
                                                        "size": 20
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "destination.ip"
                                                },
                                                "ea2c579a-2390-43e2-afeb-30a0918612a5": {
                                                    "customLabel": true,
                                                    "dataType": "ip",
                                                    "isBucketed": true,
                                                    "label": "Source IP",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "accuracyMode": true,
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "f401e2c1-9227-4c88-af3f-5421129e79ba",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 20
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "source.ip"
                                                },
                                                "f401e2c1-9227-4c88-af3f-5421129e79ba": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Session ID",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": true,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "log.id.uid"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "868264ad-1815-4c35-a4e2-b1cbdad0d327",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "0de0d2df-a20d-4d1b-b3c6-e651d40757f8",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "5b4dca52-96a0-4513-97a2-a176d8cef1e7",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "2518fdab-da72-4f8e-bcb2-80fc3e5f74a8",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "31473c95-9765-4b59-a017-2a5c3cc08905",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "eb1000ac-f1ab-4f7b-ac8c-96d6b08d710e",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "8c61b00a-d3d8-4baa-88e2-016614d2da62",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "f401e2c1-9227-4c88-af3f-5421129e79ba",
                                        "hidden": true,
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "alignment": "center",
                                        "collapseFn": "",
                                        "colorMode": "none",
                                        "columnId": "ea2c579a-2390-43e2-afeb-30a0918612a5",
                                        "hidden": false,
                                        "isMetric": false,
                                        "isTransposed": false,
                                        "oneClickFilter": true
                                    },
                                    {
                                        "alignment": "center",
                                        "columnId": "2a3d9924-faf5-463d-aa14-fa7ae1ab8a71",
                                        "isMetric": false,
                                        "isTransposed": false,
                                        "oneClickFilter": true
                                    },
                                    {
                                        "alignment": "center",
                                        "columnId": "68da99e1-d3da-4289-af3d-df03ddb1622d",
                                        "isMetric": false,
                                        "isTransposed": false,
                                        "oneClickFilter": true
                                    },
                                    {
                                        "alignment": "center",
                                        "colorMapping": null,
                                        "colorMode": "none",
                                        "columnId": "70fe1b8c-7044-4cfc-9eb8-d20ac7cf8060",
                                        "isMetric": false,
                                        "isTransposed": false,
                                        "oneClickFilter": true,
                                        "palette": null
                                    }
                                ],
                                "layerId": "3b97646d-b562-43e7-8e91-2daac479a1cc",
                                "layerType": "data",
                                "sorting": {
                                    "columnId": "68da99e1-d3da-4289-af3d-df03ddb1622d",
                                    "direction": "asc"
                                }
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 16,
                    "i": "7ed0b783-ab6e-4cd1-baf5-38a722cb4c85",
                    "w": 24,
                    "x": 0,
                    "y": 47
                },
                "panelIndex": "7ed0b783-ab6e-4cd1-baf5-38a722cb4c85",
                "title": "Connections between Source IPs and Destination IPs",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-3b97646d-b562-43e7-8e91-2daac479a1cc",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "3b97646d-b562-43e7-8e91-2daac479a1cc": {
                                            "columnOrder": [
                                                "0a382df2-e479-41ed-afca-aed1b0a13533",
                                                "ce62cd98-81c5-4823-b86d-35a33275f301",
                                                "3a8ea73b-c145-4003-8516-a5dbb11421d5"
                                            ],
                                            "columns": {
                                                "0a382df2-e479-41ed-afca-aed1b0a13533": {
                                                    "customLabel": true,
                                                    "dataType": "ip",
                                                    "isBucketed": true,
                                                    "label": "Source IPs",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "accuracyMode": true,
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "3a8ea73b-c145-4003-8516-a5dbb11421d5",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 20
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "source.ip"
                                                },
                                                "3a8ea73b-c145-4003-8516-a5dbb11421d5": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Volume",
                                                    "operationType": "sum",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "bytes",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "network.ip_bytes"
                                                },
                                                "ce62cd98-81c5-4823-b86d-35a33275f301": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": true,
                                                    "label": "Destination Port",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "accuracyMode": true,
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "3a8ea73b-c145-4003-8516-a5dbb11421d5",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 20
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "destination.port"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "logs-*",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "logs-*",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "logs-*",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "logs-*",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "logs-*",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "logs-*",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "logs-*",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "alignment": "center",
                                        "columnId": "3a8ea73b-c145-4003-8516-a5dbb11421d5",
                                        "hidden": false,
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "alignment": "center",
                                        "collapseFn": "",
                                        "columnId": "0a382df2-e479-41ed-afca-aed1b0a13533",
                                        "isMetric": false,
                                        "isTransposed": false,
                                        "oneClickFilter": true
                                    },
                                    {
                                        "alignment": "center",
                                        "columnId": "ce62cd98-81c5-4823-b86d-35a33275f301",
                                        "isMetric": false,
                                        "isTransposed": false,
                                        "oneClickFilter": true
                                    }
                                ],
                                "layerId": "3b97646d-b562-43e7-8e91-2daac479a1cc",
                                "layerType": "data"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 16,
                    "i": "4ce9d8b9-a017-4958-85a9-3a4548b4e886",
                    "w": 24,
                    "x": 24,
                    "y": 47
                },
                "panelIndex": "4ce9d8b9-a017-4958-85a9-3a4548b4e886",
                "title": "Top 20 Largest Byte Transfers",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-3b97646d-b562-43e7-8e91-2daac479a1cc",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "3b97646d-b562-43e7-8e91-2daac479a1cc": {
                                            "columnOrder": [
                                                "51c78c74-4700-4d63-9ab4-b91fa0ef6ab7",
                                                "df8168db-beb1-4892-a623-fdb996933992"
                                            ],
                                            "columns": {
                                                "51c78c74-4700-4d63-9ab4-b91fa0ef6ab7": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Country",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "df8168db-beb1-4892-a623-fdb996933992",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 10000
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "source.geo.country_iso_code"
                                                },
                                                "df8168db-beb1-4892-a623-fdb996933992": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Connections",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "event.id"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "logs-*",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "logs-*",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "logs-*",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "logs-*",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "logs-*",
                                        "key": "network.direction",
                                        "negate": false,
                                        "params": {
                                            "query": "inbound"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "network.direction": "inbound"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "logs-*",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "df8168db-beb1-4892-a623-fdb996933992",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "alignment": "left",
                                        "columnId": "51c78c74-4700-4d63-9ab4-b91fa0ef6ab7",
                                        "isMetric": false,
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "3b97646d-b562-43e7-8e91-2daac479a1cc",
                                "layerType": "data"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "params": {
                                    "query": "inbound"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "network.direction": "inbound"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "f718c0a3-f5a5-479c-b545-7e911ab53f6c",
                    "w": 19,
                    "x": 29,
                    "y": 75
                },
                "panelIndex": "f718c0a3-f5a5-479c-b545-7e911ab53f6c",
                "title": "Inbound Connections by Source Country",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 15,
                            "markdown": "**VPC Insights derived from Cloud Enrichment Connection Logs**",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 2,
                    "i": "38700819-5361-4073-a100-a2839867356d",
                    "w": 48,
                    "x": 0,
                    "y": 103
                },
                "panelIndex": "38700819-5361-4073-a100-a2839867356d",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-88dc0543-fc61-42fb-8834-ee7a7ee1f0bc",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "88dc0543-fc61-42fb-8834-ee7a7ee1f0bc": {
                                            "columnOrder": [
                                                "938a66a7-cc4d-454d-a72e-9cd27b7b9e83",
                                                "96dda1b6-cfee-409d-a360-374f98f1954f"
                                            ],
                                            "columns": {
                                                "938a66a7-cc4d-454d-a72e-9cd27b7b9e83": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top 10 values of orig_inst.org_id",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "96dda1b6-cfee-409d-a360-374f98f1954f",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "orig_inst.org_id"
                                                },
                                                "96dda1b6-cfee-409d-a360-374f98f1954f": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "event.id",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "event.id"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {}
                                },
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "logs-*",
                                            "timeField": "@timestamp",
                                            "title": "logs-*"
                                        }
                                    ],
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "logs-*",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "logs-*",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "logs-*",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "orig_inst.* exists OR resp_inst.* exists",
                                        "disabled": false,
                                        "index": "logs-*",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "orig_inst.az",
                                                    "index": "logs-*",
                                                    "key": "orig_inst.az",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "orig_inst.az"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "orig_inst.id",
                                                    "index": "logs-*",
                                                    "key": "orig_inst.id",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "orig_inst.id"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "orig_inst.name",
                                                    "index": "logs-*",
                                                    "key": "orig_inst.name",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "orig_inst.name"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "orig_inst.org_id",
                                                    "index": "logs-*",
                                                    "key": "orig_inst.org_id",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "orig_inst.org_id"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "orig_inst.sg_ids",
                                                    "index": "logs-*",
                                                    "key": "orig_inst.sg_ids",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "orig_inst.sg_ids"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "orig_inst.vpc_id",
                                                    "index": "logs-*",
                                                    "key": "orig_inst.vpc_id",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "orig_inst.vpc_id"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "resp_inst.az",
                                                    "index": "logs-*",
                                                    "key": "resp_inst.az",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "resp_inst.az"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "resp_inst.id",
                                                    "index": "logs-*",
                                                    "key": "resp_inst.id",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "resp_inst.id"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "resp_inst.name",
                                                    "index": "logs-*",
                                                    "key": "resp_inst.name",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "resp_inst.name"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "resp_inst.org_id",
                                                    "index": "logs-*",
                                                    "key": "resp_inst.org_id",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "resp_inst.org_id"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "resp_inst.sg_ids",
                                                    "index": "logs-*",
                                                    "key": "resp_inst.sg_ids",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "resp_inst.sg_ids"
                                                    }
                                                }
                                            },
                                            {
                                                "$state": {
                                                    "store": "appState"
                                                },
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "resp_inst.vpc_id",
                                                    "index": "logs-*",
                                                    "key": "resp_inst.vpc_id",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "resp_inst.vpc_id"
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "OR",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "logs-*",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "logs-*",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "logs-*",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "88dc0543-fc61-42fb-8834-ee7a7ee1f0bc",
                                        "layerType": "data",
                                        "legendDisplay": "show",
                                        "metrics": [
                                            "96dda1b6-cfee-409d-a360-374f98f1954f"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "938a66a7-cc4d-454d-a72e-9cd27b7b9e83"
                                        ],
                                        "truncateLegend": false
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "description": "Top 10 Total Connections",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "orig_inst.* exists OR resp_inst.* exists",
                                "disabled": false,
                                "index": "logs-*",
                                "negate": false,
                                "params": [
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "orig_inst.az",
                                            "index": "logs-*",
                                            "key": "orig_inst.az",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "orig_inst.az"
                                            }
                                        }
                                    },
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "orig_inst.id",
                                            "index": "logs-*",
                                            "key": "orig_inst.id",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "orig_inst.id"
                                            }
                                        }
                                    },
                                    {
                                        "$state": {
                                            "store": "appState"
                                        },
                                        "meta": {
                                            "alias": null,
                                            "disabled": false,
                                            "field": "orig_inst.name",
                                            "index": "logs-*",
                                            "key": "orig_inst.name",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "orig_inst.name"
                                            }
                                        }
                                    },
                                    {
                                        "$state": {
                                            "store": "appState"
                                        },
                                        "meta": {
                                            "alias": null,
                                            "disabled": false,
                                            "field": "orig_inst.org_id",
                                            "index": "logs-*",
                                            "key": "orig_inst.org_id",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "orig_inst.org_id"
                                            }
                                        }
                                    },
                                    {
                                        "$state": {
                                            "store": "appState"
                                        },
                                        "meta": {
                                            "alias": null,
                                            "disabled": false,
                                            "field": "orig_inst.sg_ids",
                                            "index": "logs-*",
                                            "key": "orig_inst.sg_ids",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "orig_inst.sg_ids"
                                            }
                                        }
                                    },
                                    {
                                        "$state": {
                                            "store": "appState"
                                        },
                                        "meta": {
                                            "alias": null,
                                            "disabled": false,
                                            "field": "orig_inst.vpc_id",
                                            "index": "logs-*",
                                            "key": "orig_inst.vpc_id",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "orig_inst.vpc_id"
                                            }
                                        }
                                    },
                                    {
                                        "$state": {
                                            "store": "appState"
                                        },
                                        "meta": {
                                            "alias": null,
                                            "disabled": false,
                                            "field": "resp_inst.az",
                                            "index": "logs-*",
                                            "key": "resp_inst.az",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "resp_inst.az"
                                            }
                                        }
                                    },
                                    {
                                        "$state": {
                                            "store": "appState"
                                        },
                                        "meta": {
                                            "alias": null,
                                            "disabled": false,
                                            "field": "resp_inst.id",
                                            "index": "logs-*",
                                            "key": "resp_inst.id",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "resp_inst.id"
                                            }
                                        }
                                    },
                                    {
                                        "$state": {
                                            "store": "appState"
                                        },
                                        "meta": {
                                            "alias": null,
                                            "disabled": false,
                                            "field": "resp_inst.name",
                                            "index": "logs-*",
                                            "key": "resp_inst.name",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "resp_inst.name"
                                            }
                                        }
                                    },
                                    {
                                        "$state": {
                                            "store": "appState"
                                        },
                                        "meta": {
                                            "alias": null,
                                            "disabled": false,
                                            "field": "resp_inst.org_id",
                                            "index": "logs-*",
                                            "key": "resp_inst.org_id",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "resp_inst.org_id"
                                            }
                                        }
                                    },
                                    {
                                        "$state": {
                                            "store": "appState"
                                        },
                                        "meta": {
                                            "alias": null,
                                            "disabled": false,
                                            "field": "resp_inst.sg_ids",
                                            "index": "logs-*",
                                            "key": "resp_inst.sg_ids",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "resp_inst.sg_ids"
                                            }
                                        }
                                    },
                                    {
                                        "$state": {
                                            "store": "appState"
                                        },
                                        "meta": {
                                            "alias": null,
                                            "disabled": false,
                                            "field": "resp_inst.vpc_id",
                                            "index": "logs-*",
                                            "key": "resp_inst.vpc_id",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "resp_inst.vpc_id"
                                            }
                                        }
                                    }
                                ],
                                "relation": "OR",
                                "type": "combined"
                            },
                            "query": {}
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 12,
                    "i": "80916d77-d693-4588-b6cd-d967b0e4716d",
                    "w": 12,
                    "x": 23,
                    "y": 105
                },
                "panelIndex": "80916d77-d693-4588-b6cd-d967b0e4716d",
                "title": "Traffic By AWS Account",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                    "name": "logs-corelight.conn*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn*"
                                        }
                                    ],
                                    "layers": {
                                        "a153ad5c-2356-43ea-a375-6a24cc624bc1": {
                                            "columns": [
                                                {
                                                    "columnId": "status_text",
                                                    "customLabel": true,
                                                    "fieldName": "status_text",
                                                    "label": "Cloud Enrichment",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "query": {
                                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (\r\n    orig_inst.az IS NOT NULL\r\n    OR orig_inst.id IS NOT NULL\r\n    OR orig_inst.name IS NOT NULL\r\n    OR orig_inst.org_id IS NOT NULL\r\n    OR orig_inst.sg_ids IS NOT NULL\r\n    OR orig_inst.subnet_id IS NOT NULL\r\n    OR orig_inst.vpc_id IS NOT NULL\r\n    OR resp_inst.az IS NOT NULL\r\n    OR resp_inst.id IS NOT NULL\r\n    OR resp_inst.name IS NOT NULL\r\n    OR resp_inst.org_id IS NOT NULL\r\n    OR resp_inst.sg_ids IS NOT NULL\r\n    OR resp_inst.subnet_id IS NOT NULL\r\n    OR resp_inst.vpc_id IS NOT NULL\r\n  )\r\n| STATS count = COUNT(*)\r\n| EVAL status_text = CASE(count \u003e 0, \"Enriched Conn Logs are Present\", \"Enriched Conn Logs are not Present\")\r\n| EVAL status_code = CASE(count \u003e 0, 1, 0)\r\n| KEEP status_text, status_code\r\n"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (\r\n    orig_inst.az IS NOT NULL\r\n    OR orig_inst.id IS NOT NULL\r\n    OR orig_inst.name IS NOT NULL\r\n    OR orig_inst.org_id IS NOT NULL\r\n    OR orig_inst.sg_ids IS NOT NULL\r\n    OR orig_inst.subnet_id IS NOT NULL\r\n    OR orig_inst.vpc_id IS NOT NULL\r\n    OR resp_inst.az IS NOT NULL\r\n    OR resp_inst.id IS NOT NULL\r\n    OR resp_inst.name IS NOT NULL\r\n    OR resp_inst.org_id IS NOT NULL\r\n    OR resp_inst.sg_ids IS NOT NULL\r\n    OR resp_inst.subnet_id IS NOT NULL\r\n    OR resp_inst.vpc_id IS NOT NULL\r\n  )\r\n| STATS count = COUNT(*)\r\n| EVAL status_text = CASE(count \u003e 0, \"Enriched Conn Logs are Present\", \"Enriched Conn Logs are not Present\")\r\n| EVAL status_code = CASE(count \u003e 0, 1, 0)\r\n| KEEP status_text, status_code\r\n"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "status_text"
                                    }
                                ],
                                "layerId": "a153ad5c-2356-43ea-a375-6a24cc624bc1",
                                "layerType": "data"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "hidePanelTitles": true,
                    "query": {
                        "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (\r\n    orig_inst.az IS NOT NULL\r\n    OR orig_inst.id IS NOT NULL\r\n    OR orig_inst.name IS NOT NULL\r\n    OR orig_inst.org_id IS NOT NULL\r\n    OR orig_inst.sg_ids IS NOT NULL\r\n    OR orig_inst.subnet_id IS NOT NULL\r\n    OR orig_inst.vpc_id IS NOT NULL\r\n    OR resp_inst.az IS NOT NULL\r\n    OR resp_inst.id IS NOT NULL\r\n    OR resp_inst.name IS NOT NULL\r\n    OR resp_inst.org_id IS NOT NULL\r\n    OR resp_inst.sg_ids IS NOT NULL\r\n    OR resp_inst.subnet_id IS NOT NULL\r\n    OR resp_inst.vpc_id IS NOT NULL\r\n  )\r\n| STATS count = COUNT(*)\r\n| EVAL status_text = CASE(count \u003e 0, \"Enriched Conn Logs are Present\", \"Enriched Conn Logs are not Present\")\r\n| EVAL status_code = CASE(count \u003e 0, 1, 0)\r\n| KEEP status_text, status_code\r\n"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 8,
                    "i": "41d4aea2-803c-43ed-89ff-84f0c80a3a15",
                    "w": 9,
                    "x": 12,
                    "y": 7
                },
                "panelIndex": "41d4aea2-803c-43ed-89ff-84f0c80a3a15",
                "title": "Table status_text (copy)",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 16,
                            "markdown": "**IP Interrogation**\n\n\n",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 2,
                    "i": "718eb7ad-f5fb-487e-94e9-44254498102d",
                    "w": 48,
                    "x": 0,
                    "y": 117
                },
                "panelIndex": "718eb7ad-f5fb-487e-94e9-44254498102d",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-3b97646d-b562-43e7-8e91-2daac479a1cc",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "3b97646d-b562-43e7-8e91-2daac479a1cc": {
                                            "columnOrder": [
                                                "51c78c74-4700-4d63-9ab4-b91fa0ef6ab7",
                                                "df8168db-beb1-4892-a623-fdb996933992"
                                            ],
                                            "columns": {
                                                "51c78c74-4700-4d63-9ab4-b91fa0ef6ab7": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Country",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "df8168db-beb1-4892-a623-fdb996933992",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10000
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "destination.geo.country_iso_code"
                                                },
                                                "df8168db-beb1-4892-a623-fdb996933992": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Connections",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "event.id"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "logs-*",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "logs-*",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "logs-*",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "logs-*",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "logs-*",
                                        "key": "network.direction",
                                        "negate": false,
                                        "params": {
                                            "query": "outbound"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "network.direction": "outbound"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "logs-*",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "df8168db-beb1-4892-a623-fdb996933992",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "alignment": "left",
                                        "columnId": "51c78c74-4700-4d63-9ab4-b91fa0ef6ab7",
                                        "isMetric": false,
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "3b97646d-b562-43e7-8e91-2daac479a1cc",
                                "layerType": "data"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "params": {
                                    "query": "outbound"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "network.direction": "outbound"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "72beffe3-47db-4fe7-8fcd-9a8fdda46372",
                    "w": 19,
                    "x": 29,
                    "y": 89
                },
                "panelIndex": "72beffe3-47db-4fe7-8fcd-9a8fdda46372",
                "title": "Outbound Connections by Destination Country",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-1ebeef92-3327-45ac-b95c-b41ce1fa37c0",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "1ebeef92-3327-45ac-b95c-b41ce1fa37c0": {
                                            "columnOrder": [
                                                "c83072a4-a10a-4b58-8136-4301d8457c45",
                                                "65f70ce6-5678-4a12-8039-146336b501c3",
                                                "c1632b0c-cd0e-4574-8c27-4358e64510c5",
                                                "c1632b0c-cd0e-4574-8c27-4358e64510c5X1",
                                                "c1632b0c-cd0e-4574-8c27-4358e64510c5X0"
                                            ],
                                            "columns": {
                                                "65f70ce6-5678-4a12-8039-146336b501c3": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": true,
                                                    "label": "Bytes",
                                                    "operationType": "range",
                                                    "params": {
                                                        "format": {
                                                            "id": "bytes",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        },
                                                        "includeEmptyRows": false,
                                                        "maxBars": "auto",
                                                        "ranges": [
                                                            {
                                                                "from": 0,
                                                                "label": "",
                                                                "to": 1000
                                                            }
                                                        ],
                                                        "type": "histogram"
                                                    },
                                                    "scale": "interval",
                                                    "sourceField": "source.ip_bytes"
                                                },
                                                "c1632b0c-cd0e-4574-8c27-4358e64510c5": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Duration (ms)",
                                                    "operationType": "formula",
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0,
                                                                "suffix": "ms"
                                                            }
                                                        },
                                                        "formula": "last_value((event.duration))/1000000000",
                                                        "isFormulaBroken": false
                                                    },
                                                    "references": [
                                                        "c1632b0c-cd0e-4574-8c27-4358e64510c5X1"
                                                    ],
                                                    "scale": "ratio"
                                                },
                                                "c1632b0c-cd0e-4574-8c27-4358e64510c5X0": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "filter": {
                                                        "language": "kuery",
                                                        "query": "\"event.duration\": *"
                                                    },
                                                    "isBucketed": false,
                                                    "label": "Part of Duration (ms)",
                                                    "operationType": "last_value",
                                                    "params": {
                                                        "sortField": "@timestamp"
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "event.duration"
                                                },
                                                "c1632b0c-cd0e-4574-8c27-4358e64510c5X1": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Duration (ms)",
                                                    "operationType": "math",
                                                    "params": {
                                                        "tinymathAst": {
                                                            "args": [
                                                                "c1632b0c-cd0e-4574-8c27-4358e64510c5X0",
                                                                1000000000
                                                            ],
                                                            "location": {
                                                                "max": 39,
                                                                "min": 0
                                                            },
                                                            "name": "divide",
                                                            "text": "last_value((event.duration))/1000000000",
                                                            "type": "function"
                                                        }
                                                    },
                                                    "references": [
                                                        "c1632b0c-cd0e-4574-8c27-4358e64510c5X0"
                                                    ],
                                                    "scale": "ratio"
                                                },
                                                "c83072a4-a10a-4b58-8136-4301d8457c45": {
                                                    "customLabel": false,
                                                    "dataType": "ip",
                                                    "isBucketed": true,
                                                    "label": "Top 10 values of source.ip",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "fallback": true,
                                                            "type": "alphabetical"
                                                        },
                                                        "orderDirection": "asc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "source.ip"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "logs-*",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "logs-*",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "logs-*",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "logs-*",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "logs-*",
                                        "key": "network.direction",
                                        "negate": false,
                                        "params": {
                                            "query": "outbound"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "network.direction": "outbound"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "logs-*",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "Linear",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "c1632b0c-cd0e-4574-8c27-4358e64510c5"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "1ebeef92-3327-45ac-b95c-b41ce1fa37c0",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "splitAccessor": "c83072a4-a10a-4b58-8136-4301d8457c45",
                                        "xAccessor": "65f70ce6-5678-4a12-8039-146336b501c3"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "params": {
                                    "query": "outbound"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "network.direction": "outbound"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 12,
                    "i": "036c817f-fe91-4e8e-80b1-82ebc5aaec33",
                    "w": 48,
                    "x": 0,
                    "y": 63
                },
                "panelIndex": "036c817f-fe91-4e8e-80b1-82ebc5aaec33",
                "title": "Outbound Connection Outliers",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "345787b9-3b6f-41cd-a4ea-57f727c62393",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "cb420d7a-3fe9-469f-98f1-8dc76177f7e7",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "5d9949f0-3bcd-4722-bada-5a84d95715e8",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "b2d65697-fd28-45e6-9030-a47d571fccf8",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "ceda1951-cfe8-4346-a742-6be453dc6241",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "095c6744-8120-44d6-9f13-4bd5e22a4a1e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "f48a94d8-9f7a-4680-8153-c6abbd888bb5",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "462edab1-05e1-423c-a03e-7dc4e9cebc87",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b"
                                            ],
                                            "columns": {
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "filter": null,
                                                    "isBucketed": false,
                                                    "label": "Unique Destination IPs",
                                                    "operationType": "unique_count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "compact": false,
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "reducedTimeRange": null,
                                                    "scale": "ratio",
                                                    "sourceField": "destination.ip",
                                                    "timeShift": null
                                                },
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Median of source.bytes",
                                                    "operationType": "median",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.bytes"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "345787b9-3b6f-41cd-a4ea-57f727c62393",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "cb420d7a-3fe9-469f-98f1-8dc76177f7e7",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "5d9949f0-3bcd-4722-bada-5a84d95715e8",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "b2d65697-fd28-45e6-9030-a47d571fccf8",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "ceda1951-cfe8-4346-a742-6be453dc6241",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "095c6744-8120-44d6-9f13-4bd5e22a4a1e",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "f48a94d8-9f7a-4680-8153-c6abbd888bb5",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "source.ip",
                                                    "index": "logs-*",
                                                    "key": "source.ip",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "source.ip"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "destination.ip",
                                                    "index": "logs-*",
                                                    "key": "destination.ip",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "destination.ip"
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "OR",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "462edab1-05e1-423c-a03e-7dc4e9cebc87",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                "layerType": "data",
                                "metricAccessor": "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b",
                                "showBar": false,
                                "trendlineBreakdownByAccessor": null,
                                "trendlineLayerId": null,
                                "trendlineLayerType": null,
                                "trendlineMetricAccessor": null,
                                "trendlineTimeAccessor": null
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "index": "logs-*",
                                "negate": false,
                                "params": [
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "source.ip",
                                            "index": "logs-*",
                                            "key": "source.ip",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "source.ip"
                                            }
                                        }
                                    },
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "destination.ip",
                                            "index": "logs-*",
                                            "key": "destination.ip",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "destination.ip"
                                            }
                                        }
                                    }
                                ],
                                "relation": "OR",
                                "type": "combined"
                            },
                            "query": {}
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 4,
                    "i": "36ca0cd6-e98a-4045-987b-7a00bbc61b43",
                    "w": 9,
                    "x": 39,
                    "y": 119
                },
                "panelIndex": "36ca0cd6-e98a-4045-987b-7a00bbc61b43",
                "title": "",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "8e74e095-5ced-44b6-902b-44240715d2bd",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "dd6136f6-3230-4199-8b3a-db9559a76aea",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "e475d1bd-b75c-4c37-9e1a-972896226e01",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "b6a75d11-45bd-48c5-9d4b-2f55eca81905",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "d5f62c5d-d44c-450f-9bdb-45693f2ba8e9",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "d156a569-89cc-47d1-a84a-751a41baf8da",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "22fe7cc5-9b0e-4638-8e5f-4f032684d39a",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "0966a287-e4e1-4173-aea9-50b56cfa42e5",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b"
                                            ],
                                            "columns": {
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Unique Source IPs",
                                                    "operationType": "unique_count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.ip"
                                                },
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Median of source.bytes",
                                                    "operationType": "median",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.bytes"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "8e74e095-5ced-44b6-902b-44240715d2bd",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "dd6136f6-3230-4199-8b3a-db9559a76aea",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "e475d1bd-b75c-4c37-9e1a-972896226e01",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "b6a75d11-45bd-48c5-9d4b-2f55eca81905",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "d5f62c5d-d44c-450f-9bdb-45693f2ba8e9",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "d156a569-89cc-47d1-a84a-751a41baf8da",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "22fe7cc5-9b0e-4638-8e5f-4f032684d39a",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "source.ip",
                                                    "index": "logs-*",
                                                    "key": "source.ip",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "source.ip"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "destination.ip",
                                                    "index": "logs-*",
                                                    "key": "destination.ip",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "destination.ip"
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "OR",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "0966a287-e4e1-4173-aea9-50b56cfa42e5",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                "layerType": "data",
                                "metricAccessor": "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b",
                                "showBar": false,
                                "trendlineBreakdownByAccessor": null,
                                "trendlineLayerId": null,
                                "trendlineLayerType": null,
                                "trendlineMetricAccessor": null,
                                "trendlineTimeAccessor": null
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "index": "logs-*",
                                "negate": false,
                                "params": [
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "source.ip",
                                            "index": "logs-*",
                                            "key": "source.ip",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "source.ip"
                                            }
                                        }
                                    },
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "destination.ip",
                                            "index": "logs-*",
                                            "key": "destination.ip",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "destination.ip"
                                            }
                                        }
                                    }
                                ],
                                "relation": "OR",
                                "type": "combined"
                            },
                            "query": {}
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 4,
                    "i": "c5294d5e-0599-4559-b36c-dd0640353f8e",
                    "w": 9,
                    "x": 30,
                    "y": 119
                },
                "panelIndex": "c5294d5e-0599-4559-b36c-dd0640353f8e",
                "title": "",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "13cd083d-d650-4bfb-8d39-b1241a0d7ef0",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "1e4c9862-3936-4a19-81cb-be74d1eb8913",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "45f3185a-4414-4107-9878-9de7d78ff89b",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "2ce5c3a2-33d2-4cca-a301-c1721ea46c8d",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "bf988300-4133-43c7-8bb5-9b5af2e65a2e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "e487dc98-1b45-450b-96ae-1a328c1636a7",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "4fff2a29-0b13-48a6-9487-4d6585d090d4",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "390c942a-04e4-4b9d-95b8-70dbc10b1efb",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b"
                                            ],
                                            "columns": {
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Total Connections",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "event.id"
                                                },
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Median of source.bytes",
                                                    "operationType": "median",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.bytes"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "13cd083d-d650-4bfb-8d39-b1241a0d7ef0",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "1e4c9862-3936-4a19-81cb-be74d1eb8913",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "45f3185a-4414-4107-9878-9de7d78ff89b",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "2ce5c3a2-33d2-4cca-a301-c1721ea46c8d",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "bf988300-4133-43c7-8bb5-9b5af2e65a2e",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "e487dc98-1b45-450b-96ae-1a328c1636a7",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "4fff2a29-0b13-48a6-9487-4d6585d090d4",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "source.ip",
                                                    "index": "logs-*",
                                                    "key": "source.ip",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "source.ip"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "destination.ip",
                                                    "index": "logs-*",
                                                    "key": "destination.ip",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "destination.ip"
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "OR",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "390c942a-04e4-4b9d-95b8-70dbc10b1efb",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                "layerType": "data",
                                "metricAccessor": "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b",
                                "showBar": false,
                                "trendlineBreakdownByAccessor": null,
                                "trendlineLayerId": null,
                                "trendlineLayerType": null,
                                "trendlineMetricAccessor": null,
                                "trendlineTimeAccessor": null
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "index": "logs-*",
                                "negate": false,
                                "params": [
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "source.ip",
                                            "index": "logs-*",
                                            "key": "source.ip",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "source.ip"
                                            }
                                        }
                                    },
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "destination.ip",
                                            "index": "logs-*",
                                            "key": "destination.ip",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "destination.ip"
                                            }
                                        }
                                    }
                                ],
                                "relation": "OR",
                                "type": "combined"
                            },
                            "query": {}
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 4,
                    "i": "a5facc8b-3da7-4a63-91d4-b320ba68f988",
                    "w": 10,
                    "x": 20,
                    "y": 119
                },
                "panelIndex": "a5facc8b-3da7-4a63-91d4-b320ba68f988",
                "title": "",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "c47c49b9-4c99-4daa-8ec8-3719163ace63",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "847bfde0-ad15-457f-b399-f76712fe7c5e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "0dd94fa1-6c95-4a58-bd83-ecd1a89d1d31",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "e4e93b86-5ae3-446e-b1c1-3db207535477",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "fb2c1ac7-7857-449e-be4e-0fb6b5a4f6a2",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "3be6dadf-8a66-4b81-af7f-b73b5e4cb8b0",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "5d379087-e4e1-43fb-b1a7-bd94cdf6d253",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "6ee29176-f888-4111-97da-69792f0b0687",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX0",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX1",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX2"
                                            ],
                                            "columns": {
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Total Data Outbound",
                                                    "operationType": "formula",
                                                    "params": {
                                                        "format": {
                                                            "id": "bytes",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        },
                                                        "formula": "sum(source.ip_bytes) + sum(destination.ip_bytes)",
                                                        "isFormulaBroken": false
                                                    },
                                                    "references": [
                                                        "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX2"
                                                    ],
                                                    "scale": "ratio"
                                                },
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX0": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Total Data Outbound",
                                                    "operationType": "sum",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.ip_bytes"
                                                },
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX1": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Total Data Outbound",
                                                    "operationType": "sum",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "destination.ip_bytes"
                                                },
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX2": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Total Data Outbound",
                                                    "operationType": "math",
                                                    "params": {
                                                        "tinymathAst": {
                                                            "args": [
                                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX0",
                                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX1"
                                                            ],
                                                            "location": {
                                                                "max": 48,
                                                                "min": 0
                                                            },
                                                            "name": "add",
                                                            "text": "sum(source.ip_bytes) + sum(destination.ip_bytes)",
                                                            "type": "function"
                                                        }
                                                    },
                                                    "references": [
                                                        "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX0",
                                                        "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX1"
                                                    ],
                                                    "scale": "ratio"
                                                },
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Median of source.bytes",
                                                    "operationType": "median",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.bytes"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "c47c49b9-4c99-4daa-8ec8-3719163ace63",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "847bfde0-ad15-457f-b399-f76712fe7c5e",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "0dd94fa1-6c95-4a58-bd83-ecd1a89d1d31",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "e4e93b86-5ae3-446e-b1c1-3db207535477",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "fb2c1ac7-7857-449e-be4e-0fb6b5a4f6a2",
                                        "key": "network.direction",
                                        "negate": false,
                                        "params": {
                                            "query": "outbound"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "network.direction": "outbound"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "3be6dadf-8a66-4b81-af7f-b73b5e4cb8b0",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "5d379087-e4e1-43fb-b1a7-bd94cdf6d253",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "source.ip",
                                                    "index": "logs-*",
                                                    "key": "source.ip",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "source.ip"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "destination.ip",
                                                    "index": "logs-*",
                                                    "key": "destination.ip",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "destination.ip"
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "OR",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "6ee29176-f888-4111-97da-69792f0b0687",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                "layerType": "data",
                                "metricAccessor": "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b",
                                "showBar": false
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "params": {
                                    "query": "outbound"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "network.direction": "outbound"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "index": "logs-*",
                                "negate": false,
                                "params": [
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "source.ip",
                                            "index": "logs-*",
                                            "key": "source.ip",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "source.ip"
                                            }
                                        }
                                    },
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "destination.ip",
                                            "index": "logs-*",
                                            "key": "destination.ip",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "destination.ip"
                                            }
                                        }
                                    }
                                ],
                                "relation": "OR",
                                "type": "combined"
                            },
                            "query": {}
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "hidePanelTitles": true,
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 4,
                    "i": "69d1a02d-bedf-446e-b939-2720a6d25df7",
                    "w": 10,
                    "x": 10,
                    "y": 119
                },
                "panelIndex": "69d1a02d-bedf-446e-b939-2720a6d25df7",
                "title": "",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "81836f32-d6bb-4e2d-9ac0-9dea7fa2be23",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "a0f96a7c-e6e2-4105-902e-bce7bce04522",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "dfc1e2d1-a7d9-4c6a-b29a-e2ebc6ed1688",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "900cd464-a005-44ae-9981-965c2a057f94",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "bcb6bafa-8891-41ad-9876-a414c520482d",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "6007471b-9f19-4e48-b673-fe3c9f034ba2",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "ae4dca25-d609-4a87-9c76-79322f1d03a6",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "5d951a27-4e43-4df8-b5b1-129e4b3e0185",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX0",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX1",
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX2"
                                            ],
                                            "columns": {
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Total Data Inbound",
                                                    "operationType": "formula",
                                                    "params": {
                                                        "format": {
                                                            "id": "bytes",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        },
                                                        "formula": "sum(source.ip_bytes) + sum(destination.ip_bytes)",
                                                        "isFormulaBroken": false
                                                    },
                                                    "references": [
                                                        "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX2"
                                                    ],
                                                    "scale": "ratio"
                                                },
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX0": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Total Data Inbound",
                                                    "operationType": "sum",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.ip_bytes"
                                                },
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX1": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Total Data Inbound",
                                                    "operationType": "sum",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "destination.ip_bytes"
                                                },
                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX2": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Total Data Inbound",
                                                    "operationType": "math",
                                                    "params": {
                                                        "tinymathAst": {
                                                            "args": [
                                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX0",
                                                                "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX1"
                                                            ],
                                                            "location": {
                                                                "max": 48,
                                                                "min": 0
                                                            },
                                                            "name": "add",
                                                            "text": "sum(source.ip_bytes) + sum(destination.ip_bytes)",
                                                            "type": "function"
                                                        }
                                                    },
                                                    "references": [
                                                        "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX0",
                                                        "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2bX1"
                                                    ],
                                                    "scale": "ratio"
                                                },
                                                "b8fd7325-9871-4ac5-973b-5fef01d0c5b7": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Median of source.bytes",
                                                    "operationType": "median",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.bytes"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "81836f32-d6bb-4e2d-9ac0-9dea7fa2be23",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "a0f96a7c-e6e2-4105-902e-bce7bce04522",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "dfc1e2d1-a7d9-4c6a-b29a-e2ebc6ed1688",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "900cd464-a005-44ae-9981-965c2a057f94",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "bcb6bafa-8891-41ad-9876-a414c520482d",
                                        "key": "network.direction",
                                        "negate": false,
                                        "params": {
                                            "query": "inbound"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "network.direction": "inbound"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "6007471b-9f19-4e48-b673-fe3c9f034ba2",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "ae4dca25-d609-4a87-9c76-79322f1d03a6",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "source.ip",
                                                    "index": "logs-*",
                                                    "key": "source.ip",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "source.ip"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "destination.ip",
                                                    "index": "logs-*",
                                                    "key": "destination.ip",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "destination.ip"
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "OR",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "5d951a27-4e43-4df8-b5b1-129e4b3e0185",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                "layerType": "data",
                                "metricAccessor": "997fe5e3-4ebb-4e9c-8dbb-559fb6773c2b",
                                "showBar": false
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "params": {
                                    "query": "inbound"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "network.direction": "inbound"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "index": "logs-*",
                                "negate": false,
                                "params": [
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "source.ip",
                                            "index": "logs-*",
                                            "key": "source.ip",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "source.ip"
                                            }
                                        }
                                    },
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "destination.ip",
                                            "index": "logs-*",
                                            "key": "destination.ip",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "destination.ip"
                                            }
                                        }
                                    }
                                ],
                                "relation": "OR",
                                "type": "combined"
                            },
                            "query": {}
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "hidePanelTitles": true,
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 4,
                    "i": "8cbe01ee-9c43-4697-a1d9-72824a514695",
                    "w": 10,
                    "x": 0,
                    "y": 119
                },
                "panelIndex": "8cbe01ee-9c43-4697-a1d9-72824a514695",
                "title": "",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-3824d4a3-66bc-4771-8711-e4635817be2d",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "3824d4a3-66bc-4771-8711-e4635817be2d": {
                                            "columnOrder": [
                                                "70d06330-a6ec-4498-9d02-e66bd8360ded",
                                                "4a1b3add-df64-4fc8-a54f-661ed870831c"
                                            ],
                                            "columns": {
                                                "4a1b3add-df64-4fc8-a54f-661ed870831c": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Event ID",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "event.id"
                                                },
                                                "70d06330-a6ec-4498-9d02-e66bd8360ded": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top 10 values of capture_metadata.vpc.vpc_id",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "accuracyMode": true,
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "4a1b3add-df64-4fc8-a54f-661ed870831c",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "capture_metadata.vpc.vpc_id"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "logs-*",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "logs-*",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "logs-*",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "logs-*",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "logs-*",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "logs-*",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "logs-*",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "3824d4a3-66bc-4771-8711-e4635817be2d",
                                        "layerType": "data",
                                        "legendDisplay": "show",
                                        "metrics": [
                                            "4a1b3add-df64-4fc8-a54f-661ed870831c"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "70d06330-a6ec-4498-9d02-e66bd8360ded"
                                        ],
                                        "truncateLegend": false
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "134685aa-6965-4cf1-93df-d20f198bf90e",
                    "w": 16,
                    "x": 0,
                    "y": 123
                },
                "panelIndex": "134685aa-6965-4cf1-93df-d20f198bf90e",
                "title": "VPC IDs by Connection Count",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-3824d4a3-66bc-4771-8711-e4635817be2d",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "e684b4a3-7bd1-4315-82b6-41c3680a3dd8",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "6c8bf5c6-ed7b-488b-bdd5-2f0086649501",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "ca729847-b693-44a9-b80a-556ce72db5b8",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "641561f0-68b9-4867-8b08-568f4c01c694",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "f06df791-03e6-4c83-ac75-8048164b3ec3",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "f2a83b5a-d2d7-493f-8096-17d9225def88",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "bff0e575-58a9-4fd5-88ba-df68b412f6ee",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "3824d4a3-66bc-4771-8711-e4635817be2d": {
                                            "columnOrder": [
                                                "8c243ca4-7b37-4595-943d-2deff1fa490a",
                                                "4a1b3add-df64-4fc8-a54f-661ed870831c"
                                            ],
                                            "columns": {
                                                "4a1b3add-df64-4fc8-a54f-661ed870831c": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Event ID",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "event.id"
                                                },
                                                "8c243ca4-7b37-4595-943d-2deff1fa490a": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top 10 values of network.direction",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "accuracyMode": true,
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "4a1b3add-df64-4fc8-a54f-661ed870831c",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "network.direction"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "e684b4a3-7bd1-4315-82b6-41c3680a3dd8",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "6c8bf5c6-ed7b-488b-bdd5-2f0086649501",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "ca729847-b693-44a9-b80a-556ce72db5b8",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "641561f0-68b9-4867-8b08-568f4c01c694",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "f06df791-03e6-4c83-ac75-8048164b3ec3",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "f2a83b5a-d2d7-493f-8096-17d9225def88",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "bff0e575-58a9-4fd5-88ba-df68b412f6ee",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "3824d4a3-66bc-4771-8711-e4635817be2d",
                                        "layerType": "data",
                                        "legendDisplay": "show",
                                        "metrics": [
                                            "4a1b3add-df64-4fc8-a54f-661ed870831c"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "8c243ca4-7b37-4595-943d-2deff1fa490a"
                                        ],
                                        "truncateLegend": false
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "77031a9b-20b4-431e-abcf-308794da31b9",
                    "w": 16,
                    "x": 16,
                    "y": 123
                },
                "panelIndex": "77031a9b-20b4-431e-abcf-308794da31b9",
                "title": "Connections by Direction",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                    "name": "logs-corelight.conn*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn*"
                                        }
                                    ],
                                    "layers": {
                                        "a11821ce-bdf6-4d34-9789-8ebd41cd6c92": {
                                            "columns": [
                                                {
                                                    "columnId": "transport",
                                                    "customLabel": true,
                                                    "fieldName": "transport",
                                                    "label": "transport",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "count",
                                                    "customLabel": false,
                                                    "fieldName": "count",
                                                    "inMetricDimension": true,
                                                    "label": "count",
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    }
                                                }
                                            ],
                                            "index": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "query": {
                                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND observer.hostname IS NOT NULL\r\n  AND capture_metadata.vpc.vpc_id IS NOT NULL\r\n  AND (source.ip IS NOT NULL OR destination.ip IS NOT NULL)\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND network.direction == \"inbound\"\r\n| EVAL transport = concat(network.transport, \"/\", to_string(destination.port))\r\n| STATS count = count(*) BY transport\r\n| SORT count DESC, transport ASC\r\n| LIMIT 10\r\n| KEEP transport, count\r\n"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND observer.hostname IS NOT NULL\r\n  AND capture_metadata.vpc.vpc_id IS NOT NULL\r\n  AND (source.ip IS NOT NULL OR destination.ip IS NOT NULL)\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND network.direction == \"inbound\"\r\n| EVAL transport = concat(network.transport, \"/\", to_string(destination.port))\r\n| STATS count = count(*) BY transport\r\n| SORT count DESC, transport ASC\r\n| LIMIT 10\r\n| KEEP transport, count\r\n"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "a11821ce-bdf6-4d34-9789-8ebd41cd6c92",
                                        "layerType": "data",
                                        "legendDisplay": "show",
                                        "metrics": [
                                            "count"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "transport"
                                        ],
                                        "truncateLegend": false
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND observer.hostname IS NOT NULL\r\n  AND capture_metadata.vpc.vpc_id IS NOT NULL\r\n  AND (source.ip IS NOT NULL OR destination.ip IS NOT NULL)\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND network.direction == \"inbound\"\r\n| EVAL transport = concat(network.transport, \"/\", to_string(destination.port))\r\n| STATS count = count(*) BY transport\r\n| SORT count DESC, transport ASC\r\n| LIMIT 10\r\n| KEEP transport, count\r\n"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 16,
                    "i": "ddb15826-0173-4e6d-a5f0-d1964a3cbbe3",
                    "w": 24,
                    "x": 0,
                    "y": 137
                },
                "panelIndex": "ddb15826-0173-4e6d-a5f0-d1964a3cbbe3",
                "title": "Top Inbound Ports \u0026 Protocols",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-12fe920b-d233-480a-955b-7da85fa82e1a",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "826478ef-90b0-45dd-84bf-629eab7e9fc2",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "e2e9798c-1cdc-45e9-adf3-efa29b1d28ab",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "ab79b5a0-5ae0-4581-bd25-337b5c43efeb",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "12fe920b-d233-480a-955b-7da85fa82e1a": {
                                            "columnOrder": [
                                                "b8314169-e325-408c-86bf-83088ca843a6",
                                                "5a74f052-52e2-4f10-9e7f-c4def98f0e4b"
                                            ],
                                            "columns": {
                                                "5a74f052-52e2-4f10-9e7f-c4def98f0e4b": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count of records",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "b8314169-e325-408c-86bf-83088ca843a6": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top 10 values of event.dataset",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "accuracyMode": false,
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "5a74f052-52e2-4f10-9e7f-c4def98f0e4b",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "event.dataset"
                                                }
                                            },
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "826478ef-90b0-45dd-84bf-629eab7e9fc2",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "e2e9798c-1cdc-45e9-adf3-efa29b1d28ab",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "source.ip",
                                                    "index": "logs-*",
                                                    "key": "source.ip",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "source.ip"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "disabled": false,
                                                    "field": "destination.ip",
                                                    "index": "logs-*",
                                                    "key": "destination.ip",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "destination.ip"
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "OR",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "ab79b5a0-5ae0-4581-bd25-337b5c43efeb",
                                        "key": "query",
                                        "negate": true,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"wildcard\":{\"event.dataset\":\"ssl*\"}},{\"wildcard\":{\"event.dataset\":\"smtp*\"}},{\"wildcard\":{\"event.dataset\":\"http*\"}},{\"wildcard\":{\"event.dataset\":\"files*\"}},{\"wildcard\":{\"event.dataset\":\"dns*\"}},{\"wildcard\":{\"event.dataset\":\"conn*\"}},{\"wildcard\":{\"event.dataset\":\"tls*\"}}]}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "should": [
                                                {
                                                    "wildcard": {
                                                        "event.dataset": "ssl*"
                                                    }
                                                },
                                                {
                                                    "wildcard": {
                                                        "event.dataset": "smtp*"
                                                    }
                                                },
                                                {
                                                    "wildcard": {
                                                        "event.dataset": "http*"
                                                    }
                                                },
                                                {
                                                    "wildcard": {
                                                        "event.dataset": "files*"
                                                    }
                                                },
                                                {
                                                    "wildcard": {
                                                        "event.dataset": "dns*"
                                                    }
                                                },
                                                {
                                                    "wildcard": {
                                                        "event.dataset": "conn*"
                                                    }
                                                },
                                                {
                                                    "wildcard": {
                                                        "event.dataset": "tls*"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "12fe920b-d233-480a-955b-7da85fa82e1a",
                                        "layerType": "data",
                                        "legendDisplay": "show",
                                        "metrics": [
                                            "5a74f052-52e2-4f10-9e7f-c4def98f0e4b"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "b8314169-e325-408c-86bf-83088ca843a6"
                                        ],
                                        "truncateLegend": false
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "description": "Corelight supporting data sources for source\n\n\n\n\n\n\n",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "index": "logs-*",
                                "negate": false,
                                "params": [
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "source.ip",
                                            "index": "logs-*",
                                            "key": "source.ip",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "source.ip"
                                            }
                                        }
                                    },
                                    {
                                        "meta": {
                                            "disabled": false,
                                            "field": "destination.ip",
                                            "index": "logs-*",
                                            "key": "destination.ip",
                                            "negate": false,
                                            "type": "exists",
                                            "value": "exists"
                                        },
                                        "query": {
                                            "exists": {
                                                "field": "destination.ip"
                                            }
                                        }
                                    }
                                ],
                                "relation": "OR",
                                "type": "combined"
                            },
                            "query": {}
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": true,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"wildcard\":{\"event.dataset\":\"ssl*\"}},{\"wildcard\":{\"event.dataset\":\"smtp*\"}},{\"wildcard\":{\"event.dataset\":\"http*\"}},{\"wildcard\":{\"event.dataset\":\"files*\"}},{\"wildcard\":{\"event.dataset\":\"dns*\"}},{\"wildcard\":{\"event.dataset\":\"conn*\"}},{\"wildcard\":{\"event.dataset\":\"tls*\"}}]}}"
                            },
                            "query": {
                                "bool": {
                                    "should": [
                                        {
                                            "wildcard": {
                                                "event.dataset": "ssl*"
                                            }
                                        },
                                        {
                                            "wildcard": {
                                                "event.dataset": "smtp*"
                                            }
                                        },
                                        {
                                            "wildcard": {
                                                "event.dataset": "http*"
                                            }
                                        },
                                        {
                                            "wildcard": {
                                                "event.dataset": "files*"
                                            }
                                        },
                                        {
                                            "wildcard": {
                                                "event.dataset": "dns*"
                                            }
                                        },
                                        {
                                            "wildcard": {
                                                "event.dataset": "conn*"
                                            }
                                        },
                                        {
                                            "wildcard": {
                                                "event.dataset": "tls*"
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "b9c412cc-32e0-41af-ac43-ef053fdfac90",
                    "w": 16,
                    "x": 32,
                    "y": 123
                },
                "panelIndex": "b9c412cc-32e0-41af-ac43-ef053fdfac90",
                "title": "Corelight Data Sets",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "currentIndexPatternId": "logs-*",
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "7372f89e-1793-4cb4-9a2a-82d402b6be2e",
                                                "95140924-afab-4a89-aebb-278790114f95"
                                            ],
                                            "columns": {
                                                "7372f89e-1793-4cb4-9a2a-82d402b6be2e": {
                                                    "customLabel": true,
                                                    "dataType": "ip",
                                                    "isBucketed": true,
                                                    "label": "Destination IP",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "accuracyMode": true,
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "95140924-afab-4a89-aebb-278790114f95",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "destination.ip"
                                                },
                                                "95140924-afab-4a89-aebb-278790114f95": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Total Bytes Received",
                                                    "operationType": "sum",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "bytes",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "destination.ip_bytes"
                                                }
                                            },
                                            "incompleteColumns": {},
                                            "indexPatternId": "logs-*",
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "logs-*",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "logs-*",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "logs-*",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "logs-*",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "logs-*",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "logs-*",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "logs-*",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "95140924-afab-4a89-aebb-278790114f95",
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "7372f89e-1793-4cb4-9a2a-82d402b6be2e",
                                        "isMetric": false,
                                        "isTransposed": false,
                                        "oneClickFilter": true
                                    }
                                ],
                                "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                "layerType": "data"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 18,
                    "i": "4a87f0f8-8da9-4a20-a906-2622e0612bc9",
                    "w": 16,
                    "x": 16,
                    "y": 29
                },
                "panelIndex": "4a87f0f8-8da9-4a20-a906-2622e0612bc9",
                "title": "Top 10 Destination IPs with Most Received Data",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "47db230e-6727-4fee-af47-57c2c82042e7",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "c4141336-b711-404e-8cc7-a2bcdaaf97f9",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "5fa75508-d792-4c8b-b6a2-c95db499e799",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "92ff096d-3f16-4e6d-98d4-73e4326738a4",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "4d3ab7d8-6ee9-4b7e-b55b-90bb3629b67e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "157510b8-44b0-4d4c-8fe2-70e84084a9fd",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "d6533243-1174-49c2-a5e4-feed441d99ee",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "966bd70c-5e36-4868-a1de-a89f13e92014": {
                                            "columnOrder": [
                                                "7372f89e-1793-4cb4-9a2a-82d402b6be2e",
                                                "95140924-afab-4a89-aebb-278790114f95"
                                            ],
                                            "columns": {
                                                "7372f89e-1793-4cb4-9a2a-82d402b6be2e": {
                                                    "customLabel": true,
                                                    "dataType": "ip",
                                                    "isBucketed": true,
                                                    "label": "Source IP",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "accuracyMode": false,
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "95140924-afab-4a89-aebb-278790114f95",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "source.ip"
                                                },
                                                "95140924-afab-4a89-aebb-278790114f95": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Total Bytes Sent",
                                                    "operationType": "sum",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "bytes",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.ip_bytes"
                                                }
                                            },
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "47db230e-6727-4fee-af47-57c2c82042e7",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "c4141336-b711-404e-8cc7-a2bcdaaf97f9",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "5fa75508-d792-4c8b-b6a2-c95db499e799",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "92ff096d-3f16-4e6d-98d4-73e4326738a4",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "4d3ab7d8-6ee9-4b7e-b55b-90bb3629b67e",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "157510b8-44b0-4d4c-8fe2-70e84084a9fd",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "d6533243-1174-49c2-a5e4-feed441d99ee",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "95140924-afab-4a89-aebb-278790114f95",
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "7372f89e-1793-4cb4-9a2a-82d402b6be2e",
                                        "isMetric": false,
                                        "isTransposed": false,
                                        "oneClickFilter": true
                                    }
                                ],
                                "layerId": "966bd70c-5e36-4868-a1de-a89f13e92014",
                                "layerType": "data"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "logs-*",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "logs-*",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}],\"minimum_should_match\":1}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 18,
                    "i": "47dab784-a590-43b3-90bf-dd2005b61eb5",
                    "w": 16,
                    "x": 0,
                    "y": 29
                },
                "panelIndex": "47dab784-a590-43b3-90bf-dd2005b61eb5",
                "title": "Top 10 Source IPs with Most Sent Data",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                    "name": "logs-corelight.conn*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn*"
                                        }
                                    ],
                                    "layers": {
                                        "976a33f6-5255-4013-b849-d870481c2666": {
                                            "columns": [
                                                {
                                                    "columnId": "transport",
                                                    "customLabel": false,
                                                    "fieldName": "transport",
                                                    "label": "transport",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "event_count",
                                                    "customLabel": false,
                                                    "fieldName": "event_count",
                                                    "inMetricDimension": true,
                                                    "label": "event_count",
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    }
                                                }
                                            ],
                                            "index": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "query": {
                                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (network.transport != \"icmp\" OR (\r\n      network.transport == \"icmp\"\r\n      AND source.ip IS NOT NULL\r\n      AND (TO_STRING(source.ip) RLIKE \r\n      \".*:.*\")\r\n    ))\r\n  AND capture_metadata.vpc.vpc_id IS NOT NULL\r\n  AND network.direction IS NOT NULL\r\n\r\n| EVAL transport = concat(network.transport, \"/\", to_string(destination.port))\r\n\r\n| STATS event_count = count(*) BY transport\r\n\r\n| SORT event_count DESC\r\n| LIMIT 20\r\n\r\n| KEEP transport, event_count\r\n"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (network.transport != \"icmp\" OR (\r\n      network.transport == \"icmp\"\r\n      AND source.ip IS NOT NULL\r\n      AND (TO_STRING(source.ip) RLIKE \r\n      \".*:.*\")\r\n    ))\r\n  AND capture_metadata.vpc.vpc_id IS NOT NULL\r\n  AND network.direction IS NOT NULL\r\n\r\n| EVAL transport = concat(network.transport, \"/\", to_string(destination.port))\r\n\r\n| STATS event_count = count(*) BY transport\r\n\r\n| SORT event_count DESC\r\n| LIMIT 20\r\n\r\n| KEEP transport, event_count\r\n"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "976a33f6-5255-4013-b849-d870481c2666",
                                        "layerType": "data",
                                        "legendDisplay": "show",
                                        "metrics": [
                                            "event_count"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "transport"
                                        ],
                                        "truncateLegend": false
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (network.transport != \"icmp\" OR (\r\n      network.transport == \"icmp\"\r\n      AND source.ip IS NOT NULL\r\n      AND (TO_STRING(source.ip) RLIKE \r\n      \".*:.*\")\r\n    ))\r\n  AND capture_metadata.vpc.vpc_id IS NOT NULL\r\n  AND network.direction IS NOT NULL\r\n\r\n| EVAL transport = concat(network.transport, \"/\", to_string(destination.port))\r\n\r\n| STATS event_count = count(*) BY transport\r\n\r\n| SORT event_count DESC\r\n| LIMIT 20\r\n\r\n| KEEP transport, event_count\r\n"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 18,
                    "i": "10d22653-999e-4960-8c42-8271598816d1",
                    "w": 16,
                    "x": 32,
                    "y": 29
                },
                "panelIndex": "10d22653-999e-4960-8c42-8271598816d1",
                "title": "Top 20 Protocol and Port Distribution",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                    "name": "logs-corelight.conn*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn*"
                                        }
                                    ],
                                    "layers": {
                                        "c1f0461a-4114-409b-a305-3551e0650284": {
                                            "columns": [
                                                {
                                                    "columnId": "resp_inst.sg_ids",
                                                    "customLabel": true,
                                                    "fieldName": "resp_inst.sg_ids",
                                                    "label": "AWS Security Group",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "destination.port",
                                                    "customLabel": true,
                                                    "fieldName": "destination.port",
                                                    "inMetricDimension": true,
                                                    "label": "Destination Port",
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "Connections",
                                                    "customLabel": false,
                                                    "fieldName": "Connections",
                                                    "inMetricDimension": true,
                                                    "label": "Connections",
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    }
                                                }
                                            ],
                                            "index": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "query": {
                                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND network.direction == \"inbound\"\r\n  AND (\r\n    orig_inst.az IS NOT NULL\r\n    OR orig_inst.id IS NOT NULL\r\n    OR orig_inst.name IS NOT NULL\r\n    OR orig_inst.org_id IS NOT NULL\r\n    OR orig_inst.sg_ids IS NOT NULL\r\n    OR orig_inst.subnet_id IS NOT NULL\r\n    OR orig_inst.vpc_id IS NOT NULL\r\n    OR resp_inst.az IS NOT NULL\r\n    OR resp_inst.id IS NOT NULL\r\n    OR resp_inst.name IS NOT NULL\r\n    OR resp_inst.org_id IS NOT NULL\r\n    OR resp_inst.sg_ids IS NOT NULL\r\n    OR resp_inst.subnet_id IS NOT NULL\r\n    OR resp_inst.vpc_id IS NOT NULL\r\n  )\r\n| STATS Connections = COUNT(*) BY resp_inst.sg_ids, destination.port\r\n| SORT Connections DESC\r\n| KEEP  resp_inst.sg_ids , destination.port, Connections"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND network.direction == \"inbound\"\r\n  AND (\r\n    orig_inst.az IS NOT NULL\r\n    OR orig_inst.id IS NOT NULL\r\n    OR orig_inst.name IS NOT NULL\r\n    OR orig_inst.org_id IS NOT NULL\r\n    OR orig_inst.sg_ids IS NOT NULL\r\n    OR orig_inst.subnet_id IS NOT NULL\r\n    OR orig_inst.vpc_id IS NOT NULL\r\n    OR resp_inst.az IS NOT NULL\r\n    OR resp_inst.id IS NOT NULL\r\n    OR resp_inst.name IS NOT NULL\r\n    OR resp_inst.org_id IS NOT NULL\r\n    OR resp_inst.sg_ids IS NOT NULL\r\n    OR resp_inst.subnet_id IS NOT NULL\r\n    OR resp_inst.vpc_id IS NOT NULL\r\n  )\r\n| STATS Connections = COUNT(*) BY resp_inst.sg_ids, destination.port\r\n| SORT Connections DESC\r\n| KEEP  resp_inst.sg_ids , destination.port, Connections"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "resp_inst.sg_ids"
                                    },
                                    {
                                        "columnId": "destination.port"
                                    },
                                    {
                                        "columnId": "Connections"
                                    }
                                ],
                                "layerId": "c1f0461a-4114-409b-a305-3551e0650284",
                                "layerType": "data"
                            }
                        },
                        "title": "destination.port \u0026 Connections of resp_inst.sg_ids",
                        "visualizationType": "lnsDatatable"
                    },
                    "description": "External Source Inbound to Internal Responding Security Group",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND network.direction == \"inbound\"\r\n  AND (\r\n    orig_inst.az IS NOT NULL\r\n    OR orig_inst.id IS NOT NULL\r\n    OR orig_inst.name IS NOT NULL\r\n    OR orig_inst.org_id IS NOT NULL\r\n    OR orig_inst.sg_ids IS NOT NULL\r\n    OR orig_inst.subnet_id IS NOT NULL\r\n    OR orig_inst.vpc_id IS NOT NULL\r\n    OR resp_inst.az IS NOT NULL\r\n    OR resp_inst.id IS NOT NULL\r\n    OR resp_inst.name IS NOT NULL\r\n    OR resp_inst.org_id IS NOT NULL\r\n    OR resp_inst.sg_ids IS NOT NULL\r\n    OR resp_inst.subnet_id IS NOT NULL\r\n    OR resp_inst.vpc_id IS NOT NULL\r\n  )\r\n| STATS Connections = COUNT(*) BY resp_inst.sg_ids, destination.port\r\n| SORT Connections DESC\r\n| KEEP  resp_inst.sg_ids , destination.port, Connections"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 12,
                    "i": "cf9bcb34-6bed-4141-9029-bfcbccac99d5",
                    "w": 11,
                    "x": 0,
                    "y": 105
                },
                "panelIndex": "cf9bcb34-6bed-4141-9029-bfcbccac99d5",
                "title": "Inbound Traffic by Security Group",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                    "name": "logs-corelight.conn*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn*"
                                        }
                                    ],
                                    "layers": {
                                        "d3b4eb96-faae-4dc8-b52a-6dc6fb454dee": {
                                            "allColumns": [
                                                {
                                                    "columnId": "Connections",
                                                    "customLabel": false,
                                                    "fieldName": "Connections",
                                                    "inMetricDimension": true,
                                                    "label": "Connections",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Total_Bytes_Sent",
                                                    "customLabel": false,
                                                    "fieldName": "Total_Bytes_Sent",
                                                    "inMetricDimension": true,
                                                    "label": "Total_Bytes_Sent",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "f495fe7e-17a5-45ce-927c-a612a6cdc24c",
                                                    "fieldName": "resp_inst.az",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "8d82d30f-139c-4593-87db-6243853537f0",
                                                    "customLabel": true,
                                                    "fieldName": "orig_inst.az",
                                                    "label": "Originating Availability Zone",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "sourceParams": {},
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "orig_inst.az",
                                                    "fieldName": "orig_inst.az",
                                                    "label": "orig_inst.az",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "resp_inst.az",
                                                    "fieldName": "resp_inst.az",
                                                    "label": "resp_inst.az",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "columns": [
                                                {
                                                    "columnId": "8d82d30f-139c-4593-87db-6243853537f0",
                                                    "customLabel": true,
                                                    "fieldName": "orig_inst.az",
                                                    "label": "Originating Availability Zone",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "sourceParams": {},
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Connections",
                                                    "customLabel": false,
                                                    "fieldName": "Connections",
                                                    "inMetricDimension": true,
                                                    "label": "Connections",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "Total_Bytes_Sent",
                                                    "customLabel": true,
                                                    "fieldName": "Total_Bytes_Sent",
                                                    "inMetricDimension": true,
                                                    "label": "Total Bytes Sent",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "f495fe7e-17a5-45ce-927c-a612a6cdc24c",
                                                    "customLabel": true,
                                                    "fieldName": "resp_inst.az",
                                                    "label": "Responding Availability Zone",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "query": {
                                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND orig_inst.az IS NOT NULL\r\n  AND resp_inst.az IS NOT NULL\r\n  AND (\r\n    orig_inst.id IS NOT NULL\r\n    OR orig_inst.name IS NOT NULL\r\n    OR orig_inst.org_id IS NOT NULL\r\n    OR orig_inst.sg_ids IS NOT NULL\r\n    OR orig_inst.subnet_id IS NOT NULL\r\n    OR orig_inst.vpc_id IS NOT NULL\r\n    OR resp_inst.id IS NOT NULL\r\n    OR resp_inst.name IS NOT NULL\r\n    OR resp_inst.org_id IS NOT NULL\r\n    OR resp_inst.sg_ids IS NOT NULL\r\n    OR resp_inst.subnet_id IS NOT NULL\r\n    OR resp_inst.vpc_id IS NOT NULL\r\n  )\r\n| STATS\r\n    total_bytes_sent = SUM(source.ip_bytes),\r\n    conn_count = COUNT(event.id)\r\n  BY orig_inst.az, resp_inst.az\r\n| SORT total_bytes_sent DESC\r\n| LIMIT 20\r\n| EVAL Total_Bytes_Sent =\r\n    CASE(\r\n      total_bytes_sent \u003e= 1099511627776,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1099511627776.00, 2)), \" TB\"),\r\n      total_bytes_sent \u003e= 1073741824,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1073741824.00, 2)), \" GB\"),\r\n      total_bytes_sent \u003e= 1048576,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1048576.00, 2)), \" MB\"),\r\n      total_bytes_sent \u003e= 1024,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1024.00, 2)), \" KB\"),\r\n      TRUE,\r\n        CONCAT(TO_STRING(total_bytes_sent), \" B\")\r\n    )\r\n| EVAL Connections =\r\n    CASE(\r\n      conn_count \u003e= 1000000,\r\n        CONCAT(TO_STRING(ROUND(conn_count / 1000000, 2)), \"M\"),\r\n      conn_count \u003e= 1000,\r\n        CONCAT(TO_STRING(ROUND(conn_count / 1000, 1)), \"K\"),\r\n      TRUE,\r\n        TO_STRING(conn_count)\r\n    )\r\n| KEEP\r\n    orig_inst.az,\r\n    resp_inst.az,\r\n    Connections,\r\n    Total_Bytes_Sent\r\n"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND orig_inst.az IS NOT NULL\r\n  AND resp_inst.az IS NOT NULL\r\n  AND (\r\n    orig_inst.id IS NOT NULL\r\n    OR orig_inst.name IS NOT NULL\r\n    OR orig_inst.org_id IS NOT NULL\r\n    OR orig_inst.sg_ids IS NOT NULL\r\n    OR orig_inst.subnet_id IS NOT NULL\r\n    OR orig_inst.vpc_id IS NOT NULL\r\n    OR resp_inst.id IS NOT NULL\r\n    OR resp_inst.name IS NOT NULL\r\n    OR resp_inst.org_id IS NOT NULL\r\n    OR resp_inst.sg_ids IS NOT NULL\r\n    OR resp_inst.subnet_id IS NOT NULL\r\n    OR resp_inst.vpc_id IS NOT NULL\r\n  )\r\n| STATS\r\n    total_bytes_sent = SUM(source.ip_bytes),\r\n    conn_count = COUNT(event.id)\r\n  BY orig_inst.az, resp_inst.az\r\n| SORT total_bytes_sent DESC\r\n| LIMIT 20\r\n| EVAL Total_Bytes_Sent =\r\n    CASE(\r\n      total_bytes_sent \u003e= 1099511627776,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1099511627776.00, 2)), \" TB\"),\r\n      total_bytes_sent \u003e= 1073741824,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1073741824.00, 2)), \" GB\"),\r\n      total_bytes_sent \u003e= 1048576,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1048576.00, 2)), \" MB\"),\r\n      total_bytes_sent \u003e= 1024,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1024.00, 2)), \" KB\"),\r\n      TRUE,\r\n        CONCAT(TO_STRING(total_bytes_sent), \" B\")\r\n    )\r\n| EVAL Connections =\r\n    CASE(\r\n      conn_count \u003e= 1000000,\r\n        CONCAT(TO_STRING(ROUND(conn_count / 1000000, 2)), \"M\"),\r\n      conn_count \u003e= 1000,\r\n        CONCAT(TO_STRING(ROUND(conn_count / 1000, 1)), \"K\"),\r\n      TRUE,\r\n        TO_STRING(conn_count)\r\n    )\r\n| KEEP\r\n    orig_inst.az,\r\n    resp_inst.az,\r\n    Connections,\r\n    Total_Bytes_Sent\r\n"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "Connections",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "Total_Bytes_Sent"
                                    },
                                    {
                                        "columnId": "f495fe7e-17a5-45ce-927c-a612a6cdc24c",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "8d82d30f-139c-4593-87db-6243853537f0",
                                        "isMetric": true,
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "d3b4eb96-faae-4dc8-b52a-6dc6fb454dee",
                                "layerType": "data"
                            }
                        },
                        "title": "Table orig_inst.az \u0026 resp_inst.az \u0026 Connections \u0026 Total_Bytes_Sent",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND orig_inst.az IS NOT NULL\r\n  AND resp_inst.az IS NOT NULL\r\n  AND (\r\n    orig_inst.id IS NOT NULL\r\n    OR orig_inst.name IS NOT NULL\r\n    OR orig_inst.org_id IS NOT NULL\r\n    OR orig_inst.sg_ids IS NOT NULL\r\n    OR orig_inst.subnet_id IS NOT NULL\r\n    OR orig_inst.vpc_id IS NOT NULL\r\n    OR resp_inst.id IS NOT NULL\r\n    OR resp_inst.name IS NOT NULL\r\n    OR resp_inst.org_id IS NOT NULL\r\n    OR resp_inst.sg_ids IS NOT NULL\r\n    OR resp_inst.subnet_id IS NOT NULL\r\n    OR resp_inst.vpc_id IS NOT NULL\r\n  )\r\n| STATS\r\n    total_bytes_sent = SUM(source.ip_bytes),\r\n    conn_count = COUNT(event.id)\r\n  BY orig_inst.az, resp_inst.az\r\n| SORT total_bytes_sent DESC\r\n| LIMIT 20\r\n| EVAL Total_Bytes_Sent =\r\n    CASE(\r\n      total_bytes_sent \u003e= 1099511627776,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1099511627776.00, 2)), \" TB\"),\r\n      total_bytes_sent \u003e= 1073741824,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1073741824.00, 2)), \" GB\"),\r\n      total_bytes_sent \u003e= 1048576,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1048576.00, 2)), \" MB\"),\r\n      total_bytes_sent \u003e= 1024,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1024.00, 2)), \" KB\"),\r\n      TRUE,\r\n        CONCAT(TO_STRING(total_bytes_sent), \" B\")\r\n    )\r\n| EVAL Connections =\r\n    CASE(\r\n      conn_count \u003e= 1000000,\r\n        CONCAT(TO_STRING(ROUND(conn_count / 1000000, 2)), \"M\"),\r\n      conn_count \u003e= 1000,\r\n        CONCAT(TO_STRING(ROUND(conn_count / 1000, 1)), \"K\"),\r\n      TRUE,\r\n        TO_STRING(conn_count)\r\n    )\r\n| KEEP\r\n    orig_inst.az,\r\n    resp_inst.az,\r\n    Connections,\r\n    Total_Bytes_Sent\r\n"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 12,
                    "i": "d1392801-7d4c-488c-a52b-5410b0a30fdc",
                    "w": 12,
                    "x": 11,
                    "y": 105
                },
                "panelIndex": "d1392801-7d4c-488c-a52b-5410b0a30fdc",
                "title": "Lateral Traffic between Availability Zones",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                    "name": "logs-corelight.conn*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn*"
                                        }
                                    ],
                                    "layers": {
                                        "a4adf498-c57f-49e7-afc1-8d7c4e9a94e8": {
                                            "columns": [
                                                {
                                                    "columnId": "orig_inst.name",
                                                    "customLabel": true,
                                                    "fieldName": "orig_inst.name",
                                                    "inMetricDimension": true,
                                                    "label": "EC2 Instance Name",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "source.ip",
                                                    "customLabel": true,
                                                    "fieldName": "source.ip",
                                                    "inMetricDimension": true,
                                                    "label": "Source IP",
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "destination.ip",
                                                    "customLabel": true,
                                                    "fieldName": "destination.ip",
                                                    "inMetricDimension": true,
                                                    "label": "Destination IP",
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    }
                                                },
                                                {
                                                    "columnId": "Total_Data_Outbound",
                                                    "customLabel": true,
                                                    "fieldName": "Total_Data_Outbound",
                                                    "inMetricDimension": true,
                                                    "label": "Total Data Outbound",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                }
                                            ],
                                            "index": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "query": {
                                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND network.direction == \"outbound\"\r\n  AND (orig_inst.org_id IS NOT NULL OR resp_inst.org_id IS NOT NULL)\r\n  AND (orig_inst.name IS NOT NULL OR resp_inst.name IS NOT NULL)\r\n| STATS total_bytes = SUM(source.ip_bytes)\r\n  BY orig_inst.name, source.ip, destination.ip\r\n| SORT total_bytes DESC\r\n| EVAL Total_Data_Outbound =\r\n    CASE(\r\n      total_bytes \u003e= 1099511627776,\r\n        CONCAT(TO_STRING(ROUND(total_bytes / 1099511627776.0, 2)), \" TB\"),\r\n      total_bytes \u003e= 1073741824,\r\n        CONCAT(TO_STRING(ROUND(total_bytes / 1073741824.0, 2)), \" GB\"),\r\n      total_bytes \u003e= 1048576,\r\n        CONCAT(TO_STRING(ROUND(total_bytes / 1048576.0, 2)), \" MB\"),\r\n      total_bytes \u003e= 1024,\r\n        CONCAT(TO_STRING(ROUND(total_bytes / 1024.0, 2)), \" KB\"),\r\n      TRUE,\r\n        CONCAT(TO_STRING(total_bytes), \" B\")\r\n    )\r\n| KEEP\r\n    orig_inst.name,\r\n    source.ip,\r\n    destination.ip,\r\n    Total_Data_Outbound"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND network.direction == \"outbound\"\r\n  AND (orig_inst.org_id IS NOT NULL OR resp_inst.org_id IS NOT NULL)\r\n  AND (orig_inst.name IS NOT NULL OR resp_inst.name IS NOT NULL)\r\n| STATS total_bytes = SUM(source.ip_bytes)\r\n  BY orig_inst.name, source.ip, destination.ip\r\n| SORT total_bytes DESC\r\n| EVAL Total_Data_Outbound =\r\n    CASE(\r\n      total_bytes \u003e= 1099511627776,\r\n        CONCAT(TO_STRING(ROUND(total_bytes / 1099511627776.0, 2)), \" TB\"),\r\n      total_bytes \u003e= 1073741824,\r\n        CONCAT(TO_STRING(ROUND(total_bytes / 1073741824.0, 2)), \" GB\"),\r\n      total_bytes \u003e= 1048576,\r\n        CONCAT(TO_STRING(ROUND(total_bytes / 1048576.0, 2)), \" MB\"),\r\n      total_bytes \u003e= 1024,\r\n        CONCAT(TO_STRING(ROUND(total_bytes / 1024.0, 2)), \" KB\"),\r\n      TRUE,\r\n        CONCAT(TO_STRING(total_bytes), \" B\")\r\n    )\r\n| KEEP\r\n    orig_inst.name,\r\n    source.ip,\r\n    destination.ip,\r\n    Total_Data_Outbound"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "orig_inst.name"
                                    },
                                    {
                                        "columnId": "source.ip",
                                        "width": 115
                                    },
                                    {
                                        "columnId": "destination.ip",
                                        "width": 122
                                    },
                                    {
                                        "columnId": "Total_Data_Outbound"
                                    }
                                ],
                                "layerId": "a4adf498-c57f-49e7-afc1-8d7c4e9a94e8",
                                "layerType": "data",
                                "sorting": {
                                    "columnId": "Total_Data_Outbound",
                                    "direction": "asc"
                                }
                            }
                        },
                        "title": "Table orig_inst.name \u0026 source.ip \u0026 destination.ip \u0026 Total_Data_Outbound",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND network.direction == \"outbound\"\r\n  AND (orig_inst.org_id IS NOT NULL OR resp_inst.org_id IS NOT NULL)\r\n  AND (orig_inst.name IS NOT NULL OR resp_inst.name IS NOT NULL)\r\n| STATS total_bytes = SUM(source.ip_bytes)\r\n  BY orig_inst.name, source.ip, destination.ip\r\n| SORT total_bytes DESC\r\n| EVAL Total_Data_Outbound =\r\n    CASE(\r\n      total_bytes \u003e= 1099511627776,\r\n        CONCAT(TO_STRING(ROUND(total_bytes / 1099511627776.0, 2)), \" TB\"),\r\n      total_bytes \u003e= 1073741824,\r\n        CONCAT(TO_STRING(ROUND(total_bytes / 1073741824.0, 2)), \" GB\"),\r\n      total_bytes \u003e= 1048576,\r\n        CONCAT(TO_STRING(ROUND(total_bytes / 1048576.0, 2)), \" MB\"),\r\n      total_bytes \u003e= 1024,\r\n        CONCAT(TO_STRING(ROUND(total_bytes / 1024.0, 2)), \" KB\"),\r\n      TRUE,\r\n        CONCAT(TO_STRING(total_bytes), \" B\")\r\n    )\r\n| KEEP\r\n    orig_inst.name,\r\n    source.ip,\r\n    destination.ip,\r\n    Total_Data_Outbound"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 12,
                    "i": "d0bbbe9f-90ef-4875-9fd2-96b167eb84e2",
                    "w": 13,
                    "x": 35,
                    "y": 105
                },
                "panelIndex": "d0bbbe9f-90ef-4875-9fd2-96b167eb84e2",
                "title": "Outbound Traffic by EC2 Instance Names",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldFormats": {},
                                    "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                    "name": "logs-corelight.conn*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn*"
                                        }
                                    ],
                                    "layers": {
                                        "3e08a7c3-5af0-465b-bc3d-4076b482d3a0": {
                                            "columns": [
                                                {
                                                    "columnId": "transport",
                                                    "customLabel": false,
                                                    "fieldName": "transport",
                                                    "label": "transport",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "count",
                                                    "customLabel": false,
                                                    "fieldName": "count",
                                                    "inMetricDimension": true,
                                                    "label": "count",
                                                    "meta": {
                                                        "esType": "long",
                                                        "type": "number"
                                                    }
                                                }
                                            ],
                                            "index": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "query": {
                                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND observer.hostname IS NOT NULL\r\n  AND capture_metadata.vpc.vpc_id IS NOT NULL\r\n  AND (source.ip IS NOT NULL OR destination.ip IS NOT NULL)\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND network.direction == \"outbound\"\r\n| EVAL transport = concat(network.transport, \"/\", to_string(destination.port))\r\n| STATS count = count(*) BY transport\r\n| SORT count DESC, transport ASC\r\n| LIMIT 10\r\n| KEEP transport, count\r\n"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "needsRefresh": false,
                            "query": {
                                "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND observer.hostname IS NOT NULL\r\n  AND capture_metadata.vpc.vpc_id IS NOT NULL\r\n  AND (source.ip IS NOT NULL OR destination.ip IS NOT NULL)\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND network.direction == \"outbound\"\r\n| EVAL transport = concat(network.transport, \"/\", to_string(destination.port))\r\n| STATS count = count(*) BY transport\r\n| SORT count DESC, transport ASC\r\n| LIMIT 10\r\n| KEEP transport, count\r\n"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "3e08a7c3-5af0-465b-bc3d-4076b482d3a0",
                                        "layerType": "data",
                                        "legendDisplay": "show",
                                        "metrics": [
                                            "count"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "transport"
                                        ],
                                        "truncateLegend": false
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "Bar vertical stacked",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM logs-corelight.conn*\r\n| WHERE data_stream.dataset == \"corelight.conn\"\r\n  AND capture_source == \"vpcflow\"\r\n  AND observer.hostname IS NOT NULL\r\n  AND capture_metadata.vpc.vpc_id IS NOT NULL\r\n  AND (source.ip IS NOT NULL OR destination.ip IS NOT NULL)\r\n  AND (network.transport != \"icmp\" OR (\r\n    network.transport == \"icmp\"\r\n    AND source.ip IS NOT NULL\r\n    AND (TO_STRING(source.ip) RLIKE \r\n    \".*:.*\")\r\n  ))\r\n  AND network.direction == \"outbound\"\r\n| EVAL transport = concat(network.transport, \"/\", to_string(destination.port))\r\n| STATS count = count(*) BY transport\r\n| SORT count DESC, transport ASC\r\n| LIMIT 10\r\n| KEEP transport, count\r\n"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 16,
                    "i": "46a2e2a8-e48d-42e0-b948-bb262e552a46",
                    "w": 24,
                    "x": 24,
                    "y": 137
                },
                "panelIndex": "46a2e2a8-e48d-42e0-b948-bb262e552a46",
                "title": "Top Outbound Ports \u0026 Protocols",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "description": null,
                        "references": [],
                        "savedObjectId": null,
                        "state": {
                            "adHocDataViews": {
                                "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333": {
                                    "allowHidden": false,
                                    "allowNoIndex": false,
                                    "fieldAttrs": null,
                                    "fieldFormats": {},
                                    "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                    "name": "logs-corelight.conn*",
                                    "runtimeFieldMap": {},
                                    "sourceFilters": [],
                                    "timeFieldName": "@timestamp",
                                    "title": "logs-corelight.conn*",
                                    "type": "esql"
                                }
                            },
                            "datasourceStates": {
                                "textBased": {
                                    "indexPatternRefs": [
                                        {
                                            "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "timeField": "@timestamp",
                                            "title": "logs-corelight.conn*"
                                        }
                                    ],
                                    "layers": {
                                        "6e79cd9d-40c8-401e-be7d-6affca9c71fb": {
                                            "allColumns": [
                                                {
                                                    "columnId": "first_alert_time",
                                                    "customLabel": true,
                                                    "fieldName": "first_alert_time",
                                                    "inMetricDimension": true,
                                                    "label": "First Seen",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    },
                                                    "variable": null
                                                },
                                                {
                                                    "columnId": "last_alert_time",
                                                    "customLabel": true,
                                                    "fieldName": "last_alert_time",
                                                    "inMetricDimension": true,
                                                    "label": "Last Seen",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    },
                                                    "variable": null
                                                },
                                                {
                                                    "columnId": "vpc_id",
                                                    "customLabel": true,
                                                    "fieldName": "vpc_id",
                                                    "inMetricDimension": true,
                                                    "label": "AWS VPC ID",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    },
                                                    "variable": null
                                                },
                                                {
                                                    "columnId": "source.ip",
                                                    "customLabel": true,
                                                    "fieldName": "source.ip",
                                                    "inMetricDimension": true,
                                                    "label": "Source IP",
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    },
                                                    "variable": null
                                                },
                                                {
                                                    "columnId": "src_country",
                                                    "customLabel": false,
                                                    "fieldName": "src_country",
                                                    "inMetricDimension": true,
                                                    "label": "src_country",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    },
                                                    "variable": null
                                                }
                                            ],
                                            "columns": [
                                                {
                                                    "columnId": "first_alert_time",
                                                    "customLabel": true,
                                                    "fieldName": "first_alert_time",
                                                    "inMetricDimension": true,
                                                    "label": "First Seen",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    },
                                                    "variable": null
                                                },
                                                {
                                                    "columnId": "last_alert_time",
                                                    "customLabel": true,
                                                    "fieldName": "last_alert_time",
                                                    "inMetricDimension": true,
                                                    "label": "Last Seen",
                                                    "meta": {
                                                        "esType": "date",
                                                        "type": "date"
                                                    },
                                                    "variable": null
                                                },
                                                {
                                                    "columnId": "vpc_id",
                                                    "customLabel": true,
                                                    "fieldName": "vpc_id",
                                                    "inMetricDimension": true,
                                                    "label": "AWS VPC ID",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "type": "string"
                                                    },
                                                    "variable": null
                                                },
                                                {
                                                    "columnId": "source.ip",
                                                    "customLabel": true,
                                                    "fieldName": "source.ip",
                                                    "inMetricDimension": true,
                                                    "label": "Source IP",
                                                    "meta": {
                                                        "esType": "ip",
                                                        "type": "ip"
                                                    },
                                                    "variable": null
                                                },
                                                {
                                                    "columnId": "cd08afd5-d34a-4a19-bc4b-96fddc8e6ec6",
                                                    "customLabel": true,
                                                    "fieldName": "formatted_total_bytes_sent",
                                                    "label": "Bytes Sent",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "sourceParams": {},
                                                        "type": "string"
                                                    },
                                                    "variable": null
                                                },
                                                {
                                                    "columnId": "3440ed70-10d0-49ae-8e32-d06ed381862b",
                                                    "customLabel": true,
                                                    "fieldName": "direction",
                                                    "label": "Direction",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "sourceParams": {},
                                                        "type": "string"
                                                    },
                                                    "variable": null
                                                },
                                                {
                                                    "columnId": "d9b09e3f-b863-4f4d-80bd-a7f1fd89a9a8",
                                                    "customLabel": true,
                                                    "fieldName": "destination.ip",
                                                    "label": "Destination IP",
                                                    "meta": {
                                                        "esType": "ip",
                                                        "sourceParams": {},
                                                        "type": "ip"
                                                    },
                                                    "variable": null
                                                },
                                                {
                                                    "columnId": "2bd55e92-18e9-4355-ad3e-7f8288af3c9a",
                                                    "customLabel": true,
                                                    "fieldName": "transport",
                                                    "label": "Destination Port",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "sourceParams": {},
                                                        "type": "string"
                                                    },
                                                    "variable": null
                                                },
                                                {
                                                    "columnId": "86ad9694-4b94-466d-ac22-b789540f7933",
                                                    "customLabel": true,
                                                    "fieldName": "formatted_total_bytes_recv",
                                                    "label": "Bytes Received",
                                                    "meta": {
                                                        "esType": "keyword",
                                                        "sourceParams": {},
                                                        "type": "string"
                                                    }
                                                },
                                                {
                                                    "columnId": "72e4619c-aa12-45d0-bb61-958ded5356f6",
                                                    "customLabel": true,
                                                    "fieldName": "total_duration",
                                                    "label": "Total Duration",
                                                    "meta": {
                                                        "esType": "long",
                                                        "sourceParams": {},
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "duration",
                                                            "params": {
                                                                "decimals": 2,
                                                                "fromUnit": "nanoseconds",
                                                                "toUnit": "asSeconds"
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "columnId": "f91b507d-812f-4108-b5ad-37ffb820bdc2",
                                                    "customLabel": true,
                                                    "fieldName": "total_connections",
                                                    "label": "Total Connections",
                                                    "meta": {
                                                        "esType": "long",
                                                        "sourceParams": {},
                                                        "type": "number"
                                                    },
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    }
                                                }
                                            ],
                                            "index": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                            "query": {
                                                "esql": "FROM logs-corelight.conn*\r\n| WHERE\r\n    data_stream.dataset == \"corelight.conn\"\r\n    AND capture_source == \"vpcflow\"\r\n    AND (network.transport != \"icmp\" OR (\r\n      network.transport == \"icmp\"\r\n      AND source.ip IS NOT NULL\r\n      AND (TO_STRING(source.ip) RLIKE \r\n      \".*:.*\")\r\n    ))\r\n    AND source.ip IS NOT NULL\r\n    AND destination.ip IS NOT NULL\r\n    AND capture_metadata.vpc.vpc_id IS NOT NULL\r\n    AND network.direction IS NOT NULL\r\n\r\n| EVAL transport = CONCAT(network.transport, \"/\", TO_STRING(destination.port))\r\n\r\n| STATS\r\n    epoch_first_alert_time = MIN(@timestamp),\r\n    epoch_last_alert_time  = MAX(@timestamp),\r\n    total_duration         = SUM(event.duration),\r\n    total_bytes_sent       = SUM(source.ip_bytes),\r\n    total_bytes_recv       = SUM(destination.ip_bytes),\r\n    total_connections      = COUNT(event.id),\r\n    src_country            = VALUES(source.geo.country_iso_code),\r\n    dest_country           = VALUES(destination.geo.country_iso_code),\r\n    direction              = VALUES(network.direction),\r\n    vpc_id                 = VALUES(capture_metadata.vpc.vpc_id)\r\n  BY source.ip, destination.ip, transport\r\n\r\n| EVAL total_duration = total_duration / 1000\r\n\r\n| SORT total_connections DESC\r\n\r\n| EVAL formatted_total_bytes_sent =\r\n    CASE(\r\n      total_bytes_sent \u003e= 1099511627776,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1099511627776.0, 2)), \" TB\"),\r\n      total_bytes_sent \u003e= 1073741824,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1073741824.0, 2)), \" GB\"),\r\n      total_bytes_sent \u003e= 1048576,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1048576.0, 2)), \" MB\"),\r\n      total_bytes_sent \u003e= 1024,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1024.0, 2)), \" KB\"),\r\n      TRUE,\r\n        CONCAT(TO_STRING(total_bytes_sent), \" B\")\r\n    )\r\n\r\n| EVAL formatted_total_bytes_recv =\r\n    CASE(\r\n      total_bytes_recv \u003e= 1099511627776,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_recv / 1099511627776.0, 2)), \" TB\"),\r\n      total_bytes_recv \u003e= 1073741824,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_recv / 1073741824.0, 2)), \" GB\"),\r\n      total_bytes_recv \u003e= 1048576,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_recv / 1048576.0, 2)), \" MB\"),\r\n      total_bytes_recv \u003e= 1024,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_recv / 1024.0, 2)), \" KB\"),\r\n      TRUE,\r\n        CONCAT(TO_STRING(total_bytes_recv), \" B\")\r\n    )\r\n\r\n| EVAL\r\n    first_alert_time = TO_DATETIME(epoch_first_alert_time)\r\n\r\n| EVAL last_alert_time  = TO_DATETIME(epoch_last_alert_time)\r\n\r\n| KEEP\r\n    first_alert_time,\r\n    last_alert_time,\r\n    vpc_id,\r\n    source.ip,      \r\n    src_country,\r\n    formatted_total_bytes_sent,\r\n    direction,\r\n    destination.ip,\r\n    dest_country,\r\n    transport,\r\n    formatted_total_bytes_recv,\r\n    total_duration,\r\n    total_connections"
                                            },
                                            "timeField": "@timestamp"
                                        }
                                    }
                                }
                            },
                            "filters": [],
                            "internalReferences": [
                                {
                                    "id": "9ac500899338b2fcf45fd20d129c34e52b042f3ade63945dd675f42672450333",
                                    "name": "textBasedLanguages-datasource-layer-6e79cd9d-40c8-401e-be7d-6affca9c71fb",
                                    "type": "index-pattern"
                                }
                            ],
                            "query": {
                                "esql": "FROM logs-corelight.conn*\r\n| WHERE\r\n    data_stream.dataset == \"corelight.conn\"\r\n    AND capture_source == \"vpcflow\"\r\n    AND (network.transport != \"icmp\" OR (\r\n      network.transport == \"icmp\"\r\n      AND source.ip IS NOT NULL\r\n      AND (TO_STRING(source.ip) RLIKE \r\n      \".*:.*\")\r\n    ))\r\n    AND source.ip IS NOT NULL\r\n    AND destination.ip IS NOT NULL\r\n    AND capture_metadata.vpc.vpc_id IS NOT NULL\r\n    AND network.direction IS NOT NULL\r\n\r\n| EVAL transport = CONCAT(network.transport, \"/\", TO_STRING(destination.port))\r\n\r\n| STATS\r\n    epoch_first_alert_time = MIN(@timestamp),\r\n    epoch_last_alert_time  = MAX(@timestamp),\r\n    total_duration         = SUM(event.duration),\r\n    total_bytes_sent       = SUM(source.ip_bytes),\r\n    total_bytes_recv       = SUM(destination.ip_bytes),\r\n    total_connections      = COUNT(event.id),\r\n    src_country            = VALUES(source.geo.country_iso_code),\r\n    dest_country           = VALUES(destination.geo.country_iso_code),\r\n    direction              = VALUES(network.direction),\r\n    vpc_id                 = VALUES(capture_metadata.vpc.vpc_id)\r\n  BY source.ip, destination.ip, transport\r\n\r\n| EVAL total_duration = total_duration / 1000\r\n\r\n| SORT total_connections DESC\r\n\r\n| EVAL formatted_total_bytes_sent =\r\n    CASE(\r\n      total_bytes_sent \u003e= 1099511627776,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1099511627776.0, 2)), \" TB\"),\r\n      total_bytes_sent \u003e= 1073741824,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1073741824.0, 2)), \" GB\"),\r\n      total_bytes_sent \u003e= 1048576,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1048576.0, 2)), \" MB\"),\r\n      total_bytes_sent \u003e= 1024,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1024.0, 2)), \" KB\"),\r\n      TRUE,\r\n        CONCAT(TO_STRING(total_bytes_sent), \" B\")\r\n    )\r\n\r\n| EVAL formatted_total_bytes_recv =\r\n    CASE(\r\n      total_bytes_recv \u003e= 1099511627776,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_recv / 1099511627776.0, 2)), \" TB\"),\r\n      total_bytes_recv \u003e= 1073741824,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_recv / 1073741824.0, 2)), \" GB\"),\r\n      total_bytes_recv \u003e= 1048576,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_recv / 1048576.0, 2)), \" MB\"),\r\n      total_bytes_recv \u003e= 1024,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_recv / 1024.0, 2)), \" KB\"),\r\n      TRUE,\r\n        CONCAT(TO_STRING(total_bytes_recv), \" B\")\r\n    )\r\n\r\n| EVAL\r\n    first_alert_time = TO_DATETIME(epoch_first_alert_time)\r\n\r\n| EVAL last_alert_time  = TO_DATETIME(epoch_last_alert_time)\r\n\r\n| KEEP\r\n    first_alert_time,\r\n    last_alert_time,\r\n    vpc_id,\r\n    source.ip,      \r\n    src_country,\r\n    formatted_total_bytes_sent,\r\n    direction,\r\n    destination.ip,\r\n    dest_country,\r\n    transport,\r\n    formatted_total_bytes_recv,\r\n    total_duration,\r\n    total_connections"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "first_alert_time",
                                        "isTransposed": null,
                                        "width": 213.39231601731595
                                    },
                                    {
                                        "columnId": "last_alert_time",
                                        "isTransposed": null,
                                        "width": 241.0589826839827
                                    },
                                    {
                                        "columnId": "vpc_id",
                                        "isTransposed": null,
                                        "width": 199.89231601731603
                                    },
                                    {
                                        "columnId": "source.ip",
                                        "isTransposed": null,
                                        "width": 155.5589826839827
                                    },
                                    {
                                        "columnId": "cd08afd5-d34a-4a19-bc4b-96fddc8e6ec6",
                                        "isMetric": true,
                                        "isTransposed": false,
                                        "width": 135.95898268398267
                                    },
                                    {
                                        "columnId": "3440ed70-10d0-49ae-8e32-d06ed381862b",
                                        "isMetric": true,
                                        "isTransposed": false,
                                        "width": 105.62564935064935
                                    },
                                    {
                                        "columnId": "d9b09e3f-b863-4f4d-80bd-a7f1fd89a9a8",
                                        "isMetric": true,
                                        "isTransposed": false,
                                        "width": 127.91136363636363
                                    },
                                    {
                                        "columnId": "2bd55e92-18e9-4355-ad3e-7f8288af3c9a",
                                        "isMetric": true,
                                        "isTransposed": false,
                                        "width": 134.53636363636366
                                    },
                                    {
                                        "columnId": "86ad9694-4b94-466d-ac22-b789540f7933",
                                        "isMetric": true,
                                        "isTransposed": false,
                                        "width": 106.63636363636363
                                    },
                                    {
                                        "columnId": "72e4619c-aa12-45d0-bb61-958ded5356f6",
                                        "isMetric": true,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "f91b507d-812f-4108-b5ad-37ffb820bdc2",
                                        "isMetric": true,
                                        "isTransposed": false,
                                        "width": 108.53636363636363
                                    }
                                ],
                                "layerId": "6e79cd9d-40c8-401e-be7d-6affca9c71fb",
                                "layerType": "data",
                                "sorting": null
                            }
                        },
                        "title": "Table first_alert_time \u0026 last_alert_time \u0026 vpc_id \u0026 source.ip \u0026 src_country",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "description": "Top Connections/Services by Bytes Transferred",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "esql": "FROM logs-corelight.conn*\r\n| WHERE\r\n    data_stream.dataset == \"corelight.conn\"\r\n    AND capture_source == \"vpcflow\"\r\n    AND (network.transport != \"icmp\" OR (\r\n      network.transport == \"icmp\"\r\n      AND source.ip IS NOT NULL\r\n      AND (TO_STRING(source.ip) RLIKE \r\n      \".*:.*\")\r\n    ))\r\n    AND source.ip IS NOT NULL\r\n    AND destination.ip IS NOT NULL\r\n    AND capture_metadata.vpc.vpc_id IS NOT NULL\r\n    AND network.direction IS NOT NULL\r\n\r\n| EVAL transport = CONCAT(network.transport, \"/\", TO_STRING(destination.port))\r\n\r\n| STATS\r\n    epoch_first_alert_time = MIN(@timestamp),\r\n    epoch_last_alert_time  = MAX(@timestamp),\r\n    total_duration         = SUM(event.duration),\r\n    total_bytes_sent       = SUM(source.ip_bytes),\r\n    total_bytes_recv       = SUM(destination.ip_bytes),\r\n    total_connections      = COUNT(event.id),\r\n    src_country            = VALUES(source.geo.country_iso_code),\r\n    dest_country           = VALUES(destination.geo.country_iso_code),\r\n    direction              = VALUES(network.direction),\r\n    vpc_id                 = VALUES(capture_metadata.vpc.vpc_id)\r\n  BY source.ip, destination.ip, transport\r\n\r\n| EVAL total_duration = total_duration / 1000\r\n\r\n| SORT total_connections DESC\r\n\r\n| EVAL formatted_total_bytes_sent =\r\n    CASE(\r\n      total_bytes_sent \u003e= 1099511627776,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1099511627776.0, 2)), \" TB\"),\r\n      total_bytes_sent \u003e= 1073741824,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1073741824.0, 2)), \" GB\"),\r\n      total_bytes_sent \u003e= 1048576,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1048576.0, 2)), \" MB\"),\r\n      total_bytes_sent \u003e= 1024,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_sent / 1024.0, 2)), \" KB\"),\r\n      TRUE,\r\n        CONCAT(TO_STRING(total_bytes_sent), \" B\")\r\n    )\r\n\r\n| EVAL formatted_total_bytes_recv =\r\n    CASE(\r\n      total_bytes_recv \u003e= 1099511627776,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_recv / 1099511627776.0, 2)), \" TB\"),\r\n      total_bytes_recv \u003e= 1073741824,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_recv / 1073741824.0, 2)), \" GB\"),\r\n      total_bytes_recv \u003e= 1048576,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_recv / 1048576.0, 2)), \" MB\"),\r\n      total_bytes_recv \u003e= 1024,\r\n        CONCAT(TO_STRING(ROUND(total_bytes_recv / 1024.0, 2)), \" KB\"),\r\n      TRUE,\r\n        CONCAT(TO_STRING(total_bytes_recv), \" B\")\r\n    )\r\n\r\n| EVAL\r\n    first_alert_time = TO_DATETIME(epoch_first_alert_time)\r\n\r\n| EVAL last_alert_time  = TO_DATETIME(epoch_last_alert_time)\r\n\r\n| KEEP\r\n    first_alert_time,\r\n    last_alert_time,\r\n    vpc_id,\r\n    source.ip,      \r\n    src_country,\r\n    formatted_total_bytes_sent,\r\n    direction,\r\n    destination.ip,\r\n    dest_country,\r\n    transport,\r\n    formatted_total_bytes_recv,\r\n    total_duration,\r\n    total_connections"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 15,
                    "i": "94f5ebec-4159-43d4-83a0-112f408ea053",
                    "w": 48,
                    "x": 0,
                    "y": 153
                },
                "panelIndex": "94f5ebec-4159-43d4-83a0-112f408ea053",
                "title": "Connections",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "**Navigation**\n\n**Corelight**\n\n- [Security Posture](#/dashboard/corelight-7c0946bc-acd0-4ec3-ab3b-8a92853f4a3b)\n- Data Insights\n  - [Name Resolution Insights](#/dashboard/corelight-8546a96c-86c9-4edf-9d46-88338d6ac40e)\n  - [Secure Channel Insights](#/dashboard/corelight-45197477-c13f-4e52-a5dd-fb4f53564963)\n  - [Remote Activity Insights](#/dashboard/corelight-f4864774-ed73-4b78-b861-5b8235ec12cf)\n- **Security Workflows**\n  - [Intel](#/dashboard/corelight-323b0f27-993e-4fee-ae6e-b5977d7cab11)\n  - [IP Interrogation](#/dashboard/corelight-3a4a279f-f238-47de-90ba-f643c5647fde)\n  - [Log Hunting](#/dashboard/corelight-ff07e65c-2703-4cbe-a45f-3881025352a3)\n  - [Notices](#/dashboard/corelight-f7da14f0-85db-48e8-a591-1f650af0f618)\n  - [RDP Inferences Overview](#/dashboard/corelight-2d4dc345-cbbe-4d7a-9203-5ab11c8cb5ba)\n  - [SSH Inferences Overview](#/dashboard/corelight-65a5fa91-06e4-459b-b4bb-998c85a6cf08)\n  - [Corelight Suricata IDS Alert Overview](#/dashboard/corelight-f1208ffe-d168-46d1-9531-24de523d1bfb)\n  - [VPN Insights](#/dashboard/corelight-023162b6-94da-4d8d-b1f6-de6192356cce)\n- Data Explorer\n  - **AWS VPC Flow**\n  - [Connections](#/dashboard/corelight-eff0434c-1e27-4c02-959e-9f5d95488efb)\n  - [DNS](#/dashboard/corelight-58885f47-95e1-4242-a1ee-783de69ace17)\n  - [Files](#/dashboard/corelight-0cfc8a95-4979-4265-b9ad-91edf63f01a9)\n  - [HTTP](#/dashboard/corelight-8c5f15f7-7063-4228-be54-fb8c20b29caa)\n  - [Software](#/dashboard/corelight-40bbc19b-dd9c-4b43-a88a-e29fc8701902)\n  - [SSL and x509](#/dashboard/corelight-e4a93cfe-4b1f-44df-ab99-50c74f6f2203)\n\n[**Integrations Page**](/app/integrations/detail/corelight/overview)",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 29,
                    "i": "c0807db3-a439-4387-8d72-a16ce0a3e51f",
                    "w": 12,
                    "x": 0,
                    "y": 0
                },
                "panelIndex": "c0807db3-a439-4387-8d72-a16ce0a3e51f",
                "title": "Table of Contents",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-060774b8-2302-4c63-8ffc-ec1a25a6d935",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "c97c757c-8003-4419-9b60-41ee8f562ac5",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "6fc488ec-adaf-4e86-9e6c-4db1682cc97f",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "0972b470-093b-4e64-853b-ef1c577f1cf4",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "65474ab0-0cd1-4b2b-a954-8581793600d5",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "aa99acf7-0e1b-44cb-97a0-ff50d9666172",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "060774b8-2302-4c63-8ffc-ec1a25a6d935": {
                                            "columnOrder": [
                                                "1fb2dcff-32a8-4a5c-89ca-9889a2a4414b",
                                                "ec1534e3-bcb9-4409-98a0-a94cf498275b",
                                                "baa0328c-ba95-47b7-b91e-19637eb03797",
                                                "28a1517a-e06d-46dd-8b62-95296c83902e"
                                            ],
                                            "columns": {
                                                "1fb2dcff-32a8-4a5c-89ca-9889a2a4414b": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top 10 values of network.direction",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "accuracyMode": true,
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "28a1517a-e06d-46dd-8b62-95296c83902e",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "network.direction"
                                                },
                                                "28a1517a-e06d-46dd-8b62-95296c83902e": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "bytes in",
                                                    "operationType": "sum",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "bytes",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "destination.ip_bytes"
                                                },
                                                "baa0328c-ba95-47b7-b91e-19637eb03797": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": " bytes out",
                                                    "operationType": "sum",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "bytes",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "source.ip_bytes"
                                                },
                                                "ec1534e3-bcb9-4409-98a0-a94cf498275b": {
                                                    "dataType": "date",
                                                    "isBucketed": true,
                                                    "label": "@timestamp",
                                                    "operationType": "date_histogram",
                                                    "params": {
                                                        "dropPartials": false,
                                                        "includeEmptyRows": true,
                                                        "interval": "auto"
                                                    },
                                                    "scale": "interval",
                                                    "sourceField": "@timestamp"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "observer.hostname",
                                        "index": "c97c757c-8003-4419-9b60-41ee8f562ac5",
                                        "key": "observer.hostname",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "observer.hostname"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                        "disabled": false,
                                        "index": "6fc488ec-adaf-4e86-9e6c-4db1682cc97f",
                                        "key": "query",
                                        "negate": false,
                                        "type": "custom",
                                        "value": "{\"bool\":{\"minimum_should_match\":1,\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}]}}"
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "bool": {
                                                        "must_not": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "bool": {
                                                        "filter": [
                                                            {
                                                                "term": {
                                                                    "network.transport": "icmp"
                                                                }
                                                            },
                                                            {
                                                                "script": {
                                                                    "script": {
                                                                        "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_metadata.vpc.vpc_id",
                                        "index": "0972b470-093b-4e64-853b-ef1c577f1cf4",
                                        "key": "capture_metadata.vpc.vpc_id",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "capture_metadata.vpc.vpc_id"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "capture_source",
                                        "index": "65474ab0-0cd1-4b2b-a954-8581793600d5",
                                        "key": "capture_source",
                                        "negate": false,
                                        "params": {
                                            "query": "vpcflow"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "capture_source": "vpcflow"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "network.direction",
                                        "index": "aa99acf7-0e1b-44cb-97a0-ff50d9666172",
                                        "key": "network.direction",
                                        "negate": false,
                                        "type": "exists",
                                        "value": "exists"
                                    },
                                    "query": {
                                        "exists": {
                                            "field": "network.direction"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "_index",
                                        "index": "d6d8afe5-5dea-42fb-a0cf-c2ef3e9e242f",
                                        "key": "_index",
                                        "negate": false,
                                        "params": {
                                            "query": "logs-corelight.conn*"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "_index": "logs-corelight.conn*"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "e342d725-fb8a-4366-820d-9187e1625274",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "corelight.conn"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "corelight.conn"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "curveType": "CURVE_MONOTONE_X",
                                "fittingFunction": "Linear",
                                "layers": [
                                    {
                                        "accessors": [
                                            "baa0328c-ba95-47b7-b91e-19637eb03797",
                                            "28a1517a-e06d-46dd-8b62-95296c83902e"
                                        ],
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "eui_amsterdam_color_blind",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rule": {
                                                        "type": "other"
                                                    },
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "layerId": "060774b8-2302-4c63-8ffc-ec1a25a6d935",
                                        "layerType": "data",
                                        "position": "top",
                                        "seriesType": "area",
                                        "showGridlines": false,
                                        "splitAccessor": "1fb2dcff-32a8-4a5c-89ca-9889a2a4414b",
                                        "xAccessor": "ec1534e3-bcb9-4409-98a0-a94cf498275b"
                                    }
                                ],
                                "legend": {
                                    "isInside": false,
                                    "isVisible": true,
                                    "legendSize": "large",
                                    "position": "right",
                                    "shouldTruncate": false,
                                    "showSingleSeries": true
                                },
                                "preferredSeriesType": "area",
                                "title": "Empty XY chart",
                                "valueLabels": "hide"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "observer.hostname",
                                "index": "logs-*",
                                "key": "observer.hostname",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "observer.hostname"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": "NOT network.transport: icmp OR (network.transport: icmp AND source.ip: .*:.*)",
                                "disabled": false,
                                "index": "logs-*",
                                "key": "query",
                                "negate": false,
                                "type": "custom",
                                "value": "{\"bool\":{\"minimum_should_match\":1,\"should\":[{\"bool\":{\"must_not\":[{\"term\":{\"network.transport\":\"icmp\"}}]}},{\"bool\":{\"filter\":[{\"term\":{\"network.transport\":\"icmp\"}},{\"script\":{\"script\":{\"source\":\"doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')\"}}}]}}]}}"
                            },
                            "query": {
                                "bool": {
                                    "minimum_should_match": 1,
                                    "should": [
                                        {
                                            "bool": {
                                                "must_not": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "bool": {
                                                "filter": [
                                                    {
                                                        "term": {
                                                            "network.transport": "icmp"
                                                        }
                                                    },
                                                    {
                                                        "script": {
                                                            "script": {
                                                                "source": "doc['source.ip'].size() \u003e 0 \u0026\u0026 doc['source.ip'].value.toString().contains(':')"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_metadata.vpc.vpc_id",
                                "index": "logs-*",
                                "key": "capture_metadata.vpc.vpc_id",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "capture_metadata.vpc.vpc_id"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "capture_source",
                                "index": "logs-*",
                                "key": "capture_source",
                                "negate": false,
                                "params": {
                                    "query": "vpcflow"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "capture_source": "vpcflow"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "network.direction",
                                "index": "logs-*",
                                "key": "network.direction",
                                "negate": false,
                                "type": "exists",
                                "value": "exists"
                            },
                            "query": {
                                "exists": {
                                    "field": "network.direction"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "_index",
                                "index": "d6d8afe5-5dea-42fb-a0cf-c2ef3e9e242f",
                                "key": "_index",
                                "negate": false,
                                "params": {
                                    "query": "logs-corelight.conn*"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "_index": "logs-corelight.conn*"
                                }
                            }
                        },
                        {
                            "$state": {
                                "store": "appState"
                            },
                            "meta": {
                                "alias": null,
                                "disabled": false,
                                "field": "data_stream.dataset",
                                "index": "e342d725-fb8a-4366-820d-9187e1625274",
                                "key": "data_stream.dataset",
                                "negate": false,
                                "params": {
                                    "query": "corelight.conn"
                                },
                                "type": "phrase"
                            },
                            "query": {
                                "match_phrase": {
                                    "data_stream.dataset": "corelight.conn"
                                }
                            }
                        }
                    ],
                    "query": {
                        "language": "kuery",
                        "query": ""
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 14,
                    "i": "43c8751d-827f-4513-8d96-7aad933137ac",
                    "w": 36,
                    "x": 12,
                    "y": 15
                },
                "panelIndex": "43c8751d-827f-4513-8d96-7aad933137ac",
                "title": "Traffic by Direction and Bytes Transferred over Time",
                "type": "lens"
            }
        ],
        "timeRestore": false,
        "title": "[Logs Corelight] AWS VPC Flow ",
        "version": 3
    },
    "coreMigrationVersion": "8.8.0",
    "created_at": "2026-01-08T05:44:26.218Z",
    "id": "corelight-caf92ff9-71b9-402c-813a-75ba5a3cb3b8",
    "references": [
        {
            "id": "logs-*",
            "name": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "79b479b3-ab96-4b3e-84b1-998dc63b634b:indexpattern-datasource-layer-d0f1264a-3a68-434d-8e77-02466186f0e3",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "df56cedd-65fe-4fd6-95df-457dbe1f74d7:indexpattern-datasource-layer-d0f1264a-3a68-434d-8e77-02466186f0e3",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "5209ae73-e40d-42dc-a1a5-58d39c4eafe6:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "5209ae73-e40d-42dc-a1a5-58d39c4eafe6:7abc0ea4-73fb-4e9a-95db-e9e85873f982",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "5209ae73-e40d-42dc-a1a5-58d39c4eafe6:75750924-a6c8-4d14-982e-078b2d29755e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "5209ae73-e40d-42dc-a1a5-58d39c4eafe6:a432253f-07b7-4990-aa94-9993fcc76176",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "5209ae73-e40d-42dc-a1a5-58d39c4eafe6:02a52305-2b97-4f2c-8c23-42e44bb158fc",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "5209ae73-e40d-42dc-a1a5-58d39c4eafe6:d33b2a4f-e773-4ce4-80c4-49a505ef7bb8",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "5209ae73-e40d-42dc-a1a5-58d39c4eafe6:91d1ca62-5bff-4e08-9239-89748529edf6",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "5209ae73-e40d-42dc-a1a5-58d39c4eafe6:50c044bc-ae03-479b-bf7c-10ee6f6b62df",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "1a29cb63-2562-4091-a650-544075715729:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "1a29cb63-2562-4091-a650-544075715729:87c04943-fd51-4aee-96ca-bd6750742106",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "1a29cb63-2562-4091-a650-544075715729:b5050370-9360-42d6-9a1c-1cfc659ce894",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "1a29cb63-2562-4091-a650-544075715729:afdd6c0e-49e4-452a-addb-56c8c7b321fc",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "1a29cb63-2562-4091-a650-544075715729:9c314438-6b71-47a5-9580-3a7ee9d802b5",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "1a29cb63-2562-4091-a650-544075715729:0830b582-0ee7-4245-909a-78af8be04f2c",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "1a29cb63-2562-4091-a650-544075715729:d03f8f9a-91c7-4fd8-9bb0-509f99b73ed2",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "1a29cb63-2562-4091-a650-544075715729:50d72482-aba3-41a2-bfbe-a09b888fd44f",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "efea7128-c873-409b-aebe-a301fe01d895:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "efea7128-c873-409b-aebe-a301fe01d895:27d23ca9-3464-4832-8cfe-728a6a25a6fb",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "efea7128-c873-409b-aebe-a301fe01d895:8363c330-2e95-4b70-9303-88b54ca36f17",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "efea7128-c873-409b-aebe-a301fe01d895:a1d023e3-f3da-4b8c-94aa-76e6347d916e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "efea7128-c873-409b-aebe-a301fe01d895:3510f2bb-17f6-4ad2-9179-c29acddfe03b",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "efea7128-c873-409b-aebe-a301fe01d895:2f4e225e-244d-444c-bc09-be4303c98417",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "efea7128-c873-409b-aebe-a301fe01d895:342c7c8d-4280-474d-abeb-401b037b0ddf",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "efea7128-c873-409b-aebe-a301fe01d895:feeebf53-d61e-4362-b82a-6450d8312ebf",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a45cba37-e588-4e13-a501-7a890827d4a2:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a45cba37-e588-4e13-a501-7a890827d4a2:043828ff-1a11-4991-af7b-558b04c750d5",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a45cba37-e588-4e13-a501-7a890827d4a2:ac10368d-9930-4a89-ba90-5070529f990d",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a45cba37-e588-4e13-a501-7a890827d4a2:dcaa8554-ff5e-43d6-b648-96184d40749b",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a45cba37-e588-4e13-a501-7a890827d4a2:61c093c5-bb4c-4f1f-867e-3dbbdd6aaff4",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a45cba37-e588-4e13-a501-7a890827d4a2:ab565996-6195-4090-bad8-5da60194d85f",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a45cba37-e588-4e13-a501-7a890827d4a2:feeeddbd-53d8-46ce-9ffb-c70086a1a5a4",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a45cba37-e588-4e13-a501-7a890827d4a2:ff869537-1e64-41f0-a6f5-a21cd9dee237",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8b17e388-b864-434f-9292-d42753c329c7:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "baa08342-f7a7-4ead-bafe-57bf35e90837:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "14ce901c-bd47-4c98-abb9-90c54727985e:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "14ce901c-bd47-4c98-abb9-90c54727985e:42708bb5-f083-4a1b-b2de-2e6cb6878ce7",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "14ce901c-bd47-4c98-abb9-90c54727985e:12490d5c-6f51-4a1e-91c4-a914eb7b497e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "14ce901c-bd47-4c98-abb9-90c54727985e:a3006dcd-c8b9-48a4-a5cd-dde9e87c26eb",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "14ce901c-bd47-4c98-abb9-90c54727985e:98d59e33-dc48-4559-b867-ca6830d47cc5",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "14ce901c-bd47-4c98-abb9-90c54727985e:b58e858f-f4a3-496a-8d1a-5f635db5da99",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "14ce901c-bd47-4c98-abb9-90c54727985e:701f265b-5d26-4ffd-a4c7-434b298a476b",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "14ce901c-bd47-4c98-abb9-90c54727985e:f7333720-18de-470d-b3a2-60a009dd16c7",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7ed0b783-ab6e-4cd1-baf5-38a722cb4c85:indexpattern-datasource-layer-3b97646d-b562-43e7-8e91-2daac479a1cc",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7ed0b783-ab6e-4cd1-baf5-38a722cb4c85:868264ad-1815-4c35-a4e2-b1cbdad0d327",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7ed0b783-ab6e-4cd1-baf5-38a722cb4c85:0de0d2df-a20d-4d1b-b3c6-e651d40757f8",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7ed0b783-ab6e-4cd1-baf5-38a722cb4c85:5b4dca52-96a0-4513-97a2-a176d8cef1e7",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7ed0b783-ab6e-4cd1-baf5-38a722cb4c85:2518fdab-da72-4f8e-bcb2-80fc3e5f74a8",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7ed0b783-ab6e-4cd1-baf5-38a722cb4c85:31473c95-9765-4b59-a017-2a5c3cc08905",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7ed0b783-ab6e-4cd1-baf5-38a722cb4c85:eb1000ac-f1ab-4f7b-ac8c-96d6b08d710e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7ed0b783-ab6e-4cd1-baf5-38a722cb4c85:8c61b00a-d3d8-4baa-88e2-016614d2da62",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "4ce9d8b9-a017-4958-85a9-3a4548b4e886:indexpattern-datasource-layer-3b97646d-b562-43e7-8e91-2daac479a1cc",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "f718c0a3-f5a5-479c-b545-7e911ab53f6c:indexpattern-datasource-layer-3b97646d-b562-43e7-8e91-2daac479a1cc",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "80916d77-d693-4588-b6cd-d967b0e4716d:indexpattern-datasource-layer-88dc0543-fc61-42fb-8834-ee7a7ee1f0bc",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "72beffe3-47db-4fe7-8fcd-9a8fdda46372:indexpattern-datasource-layer-3b97646d-b562-43e7-8e91-2daac479a1cc",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "036c817f-fe91-4e8e-80b1-82ebc5aaec33:indexpattern-datasource-layer-1ebeef92-3327-45ac-b95c-b41ce1fa37c0",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "36ca0cd6-e98a-4045-987b-7a00bbc61b43:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "36ca0cd6-e98a-4045-987b-7a00bbc61b43:345787b9-3b6f-41cd-a4ea-57f727c62393",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "36ca0cd6-e98a-4045-987b-7a00bbc61b43:cb420d7a-3fe9-469f-98f1-8dc76177f7e7",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "36ca0cd6-e98a-4045-987b-7a00bbc61b43:5d9949f0-3bcd-4722-bada-5a84d95715e8",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "36ca0cd6-e98a-4045-987b-7a00bbc61b43:b2d65697-fd28-45e6-9030-a47d571fccf8",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "36ca0cd6-e98a-4045-987b-7a00bbc61b43:ceda1951-cfe8-4346-a742-6be453dc6241",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "36ca0cd6-e98a-4045-987b-7a00bbc61b43:095c6744-8120-44d6-9f13-4bd5e22a4a1e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "36ca0cd6-e98a-4045-987b-7a00bbc61b43:f48a94d8-9f7a-4680-8153-c6abbd888bb5",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "36ca0cd6-e98a-4045-987b-7a00bbc61b43:462edab1-05e1-423c-a03e-7dc4e9cebc87",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c5294d5e-0599-4559-b36c-dd0640353f8e:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c5294d5e-0599-4559-b36c-dd0640353f8e:8e74e095-5ced-44b6-902b-44240715d2bd",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c5294d5e-0599-4559-b36c-dd0640353f8e:dd6136f6-3230-4199-8b3a-db9559a76aea",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c5294d5e-0599-4559-b36c-dd0640353f8e:e475d1bd-b75c-4c37-9e1a-972896226e01",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c5294d5e-0599-4559-b36c-dd0640353f8e:b6a75d11-45bd-48c5-9d4b-2f55eca81905",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c5294d5e-0599-4559-b36c-dd0640353f8e:d5f62c5d-d44c-450f-9bdb-45693f2ba8e9",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c5294d5e-0599-4559-b36c-dd0640353f8e:d156a569-89cc-47d1-a84a-751a41baf8da",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c5294d5e-0599-4559-b36c-dd0640353f8e:22fe7cc5-9b0e-4638-8e5f-4f032684d39a",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "c5294d5e-0599-4559-b36c-dd0640353f8e:0966a287-e4e1-4173-aea9-50b56cfa42e5",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a5facc8b-3da7-4a63-91d4-b320ba68f988:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a5facc8b-3da7-4a63-91d4-b320ba68f988:13cd083d-d650-4bfb-8d39-b1241a0d7ef0",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a5facc8b-3da7-4a63-91d4-b320ba68f988:1e4c9862-3936-4a19-81cb-be74d1eb8913",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a5facc8b-3da7-4a63-91d4-b320ba68f988:45f3185a-4414-4107-9878-9de7d78ff89b",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a5facc8b-3da7-4a63-91d4-b320ba68f988:2ce5c3a2-33d2-4cca-a301-c1721ea46c8d",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a5facc8b-3da7-4a63-91d4-b320ba68f988:bf988300-4133-43c7-8bb5-9b5af2e65a2e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a5facc8b-3da7-4a63-91d4-b320ba68f988:e487dc98-1b45-450b-96ae-1a328c1636a7",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a5facc8b-3da7-4a63-91d4-b320ba68f988:4fff2a29-0b13-48a6-9487-4d6585d090d4",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a5facc8b-3da7-4a63-91d4-b320ba68f988:390c942a-04e4-4b9d-95b8-70dbc10b1efb",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "69d1a02d-bedf-446e-b939-2720a6d25df7:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "69d1a02d-bedf-446e-b939-2720a6d25df7:c47c49b9-4c99-4daa-8ec8-3719163ace63",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "69d1a02d-bedf-446e-b939-2720a6d25df7:847bfde0-ad15-457f-b399-f76712fe7c5e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "69d1a02d-bedf-446e-b939-2720a6d25df7:0dd94fa1-6c95-4a58-bd83-ecd1a89d1d31",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "69d1a02d-bedf-446e-b939-2720a6d25df7:e4e93b86-5ae3-446e-b1c1-3db207535477",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "69d1a02d-bedf-446e-b939-2720a6d25df7:fb2c1ac7-7857-449e-be4e-0fb6b5a4f6a2",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "69d1a02d-bedf-446e-b939-2720a6d25df7:3be6dadf-8a66-4b81-af7f-b73b5e4cb8b0",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "69d1a02d-bedf-446e-b939-2720a6d25df7:5d379087-e4e1-43fb-b1a7-bd94cdf6d253",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "69d1a02d-bedf-446e-b939-2720a6d25df7:6ee29176-f888-4111-97da-69792f0b0687",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8cbe01ee-9c43-4697-a1d9-72824a514695:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8cbe01ee-9c43-4697-a1d9-72824a514695:81836f32-d6bb-4e2d-9ac0-9dea7fa2be23",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8cbe01ee-9c43-4697-a1d9-72824a514695:a0f96a7c-e6e2-4105-902e-bce7bce04522",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8cbe01ee-9c43-4697-a1d9-72824a514695:dfc1e2d1-a7d9-4c6a-b29a-e2ebc6ed1688",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8cbe01ee-9c43-4697-a1d9-72824a514695:900cd464-a005-44ae-9981-965c2a057f94",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8cbe01ee-9c43-4697-a1d9-72824a514695:bcb6bafa-8891-41ad-9876-a414c520482d",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8cbe01ee-9c43-4697-a1d9-72824a514695:6007471b-9f19-4e48-b673-fe3c9f034ba2",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8cbe01ee-9c43-4697-a1d9-72824a514695:ae4dca25-d609-4a87-9c76-79322f1d03a6",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8cbe01ee-9c43-4697-a1d9-72824a514695:5d951a27-4e43-4df8-b5b1-129e4b3e0185",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "134685aa-6965-4cf1-93df-d20f198bf90e:indexpattern-datasource-layer-3824d4a3-66bc-4771-8711-e4635817be2d",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "77031a9b-20b4-431e-abcf-308794da31b9:indexpattern-datasource-layer-3824d4a3-66bc-4771-8711-e4635817be2d",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "77031a9b-20b4-431e-abcf-308794da31b9:e684b4a3-7bd1-4315-82b6-41c3680a3dd8",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "77031a9b-20b4-431e-abcf-308794da31b9:6c8bf5c6-ed7b-488b-bdd5-2f0086649501",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "77031a9b-20b4-431e-abcf-308794da31b9:ca729847-b693-44a9-b80a-556ce72db5b8",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "77031a9b-20b4-431e-abcf-308794da31b9:641561f0-68b9-4867-8b08-568f4c01c694",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "77031a9b-20b4-431e-abcf-308794da31b9:f06df791-03e6-4c83-ac75-8048164b3ec3",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "77031a9b-20b4-431e-abcf-308794da31b9:f2a83b5a-d2d7-493f-8096-17d9225def88",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "77031a9b-20b4-431e-abcf-308794da31b9:bff0e575-58a9-4fd5-88ba-df68b412f6ee",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "b9c412cc-32e0-41af-ac43-ef053fdfac90:indexpattern-datasource-layer-12fe920b-d233-480a-955b-7da85fa82e1a",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "b9c412cc-32e0-41af-ac43-ef053fdfac90:826478ef-90b0-45dd-84bf-629eab7e9fc2",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "b9c412cc-32e0-41af-ac43-ef053fdfac90:e2e9798c-1cdc-45e9-adf3-efa29b1d28ab",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "b9c412cc-32e0-41af-ac43-ef053fdfac90:ab79b5a0-5ae0-4581-bd25-337b5c43efeb",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "4a87f0f8-8da9-4a20-a906-2622e0612bc9:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "47dab784-a590-43b3-90bf-dd2005b61eb5:indexpattern-datasource-layer-966bd70c-5e36-4868-a1de-a89f13e92014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "47dab784-a590-43b3-90bf-dd2005b61eb5:47db230e-6727-4fee-af47-57c2c82042e7",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "47dab784-a590-43b3-90bf-dd2005b61eb5:c4141336-b711-404e-8cc7-a2bcdaaf97f9",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "47dab784-a590-43b3-90bf-dd2005b61eb5:5fa75508-d792-4c8b-b6a2-c95db499e799",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "47dab784-a590-43b3-90bf-dd2005b61eb5:92ff096d-3f16-4e6d-98d4-73e4326738a4",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "47dab784-a590-43b3-90bf-dd2005b61eb5:4d3ab7d8-6ee9-4b7e-b55b-90bb3629b67e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "47dab784-a590-43b3-90bf-dd2005b61eb5:157510b8-44b0-4d4c-8fe2-70e84084a9fd",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "47dab784-a590-43b3-90bf-dd2005b61eb5:d6533243-1174-49c2-a5e4-feed441d99ee",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "43c8751d-827f-4513-8d96-7aad933137ac:indexpattern-datasource-layer-060774b8-2302-4c63-8ffc-ec1a25a6d935",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "43c8751d-827f-4513-8d96-7aad933137ac:c97c757c-8003-4419-9b60-41ee8f562ac5",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "43c8751d-827f-4513-8d96-7aad933137ac:6fc488ec-adaf-4e86-9e6c-4db1682cc97f",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "43c8751d-827f-4513-8d96-7aad933137ac:0972b470-093b-4e64-853b-ef1c577f1cf4",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "43c8751d-827f-4513-8d96-7aad933137ac:65474ab0-0cd1-4b2b-a954-8581793600d5",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "43c8751d-827f-4513-8d96-7aad933137ac:aa99acf7-0e1b-44cb-97a0-ff50d9666172",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_c6d88a1f-5878-4db7-b89c-33ecb859e140:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_388044d3-36a5-45c8-a5bf-0d7fe1f20464:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_146e6c58-7fe4-484c-a64c-359ec9a24ecc:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_fa4eaca2-46e1-45d4-a4a0-4ca99e7c21eb:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_063e2fd9-659e-4362-95f8-7057d21e631d:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_8e126021-859a-41c0-b84a-9a44551c1c05:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_0a0b3611-3250-476d-b19c-953963299235:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
            "type": "index-pattern"
        }
    ],
    "type": "dashboard",
    "typeMigrationVersion": "10.2.0",
    "updated_by": "u_mGBROF_q5bmFCATbLXAcCwKa0k8JvONAwSruelyKA5E_0"
}