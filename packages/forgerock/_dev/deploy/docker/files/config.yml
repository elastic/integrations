rules:
  - path: /monitoring/logs
    methods: ["GET"]
    query_params:
      source: "am-access"
      beginTime: "{beginTime:.*}"
      endTime: "{endTime:.*}"
    # request_headers:
    #   x-api-key: "abcd"
    #   x-api-secret: "efgh"
    responses:
      - status_code: 200
        body: |-
          {"result":[{"payload":{"_id":"688b24d9-968e-4a20-b471-9bd78f1e46ec-79599","component":"Session","eventName":"AM-SESSION-IDLE_TIMED_OUT","level":"INFO","objectId":"688b24d9-968e-4a20-b471-9bd78f1e46ec-13901","operation":"DELETE","realm":"/","runAs":"","source":"audit","timestamp":"2022-11-06T18:16:43.813Z","topic":"activity","trackingIds":["688b24d9-968e-4a20-b471-9bd78f1e46ec-13901"],"transactionId":"688b24d9-968e-4a20-b471-9bd78f1e46ec-1","userId":"id=d7cd65bf-743c-4753-a78f-a20daae7e3bf,ou=user,ou=am-config"},"timestamp":"2022-11-06T18:16:43.814159262Z","type":"application/json","source":"am-activity"},{"payload":{"_id":"688b24d9-968e-4a20-b471-9bd78f1e46ec-79629","client":{"ip":"50.159.194.107"},"component":"Session","eventName":"AM-ACCESS-ATTEMPT","http":{"request":{"headers":{"accept":["application/json, text/javascript, */*; q=0.01"],"accept-api-version":["protocol=1.0,resource=2.0"],"content-type":["application/json"],"host":["openam-chico-poc.forgeblocks.com"],"origin":["https://openam-chico-poc.forgeblocks.com"],"user-agent":["Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36"],"x-forwarded-for":["50.159.194.107, 34.149.144.150, 10.168.0.49"],"x-forwarded-proto":["https"],"x-requested-with":["XMLHttpRequest"]},"method":"POST","path":"https://openam-chico-poc.forgeblocks.com/am/json/sessions","secure":true}},"level":"INFO","realm":"/","request":{"detail":{"action":"getSessionInfo"},"operation":"ACTION","protocol":"CREST"},"server":{"ip":"10.68.30.155","port":8080},"source":"audit","timestamp":"2022-11-06T18:16:47.924Z","topic":"access","transactionId":"1667758607922-8f520a691324f05031b6-32561/0"},"timestamp":"2022-11-06T18:16:47.939326Z","type":"application/json","source":"am-access"}],"resultCount":2,"pagedResultsCookie":null,"totalPagedResultsPolicy":"NONE","totalPagedResults":-1,"remainingPagedResults":-1}