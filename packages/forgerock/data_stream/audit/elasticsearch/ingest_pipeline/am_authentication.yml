---
description: Pipeline for ForgeRock authentication logs.
# ForgeRock AM Authentication Logs: https://backstage.forgerock.com/docs/am/7.2/security-guide/sec-maint-audit-ref.html#authentication-log-format
processors:
  - set: 
      field: event.category
      value: authentication
  - set:
      field: event.module
      copy_from: forgerock.component
      ignore_failure: true
  - set:
      field: event.action
      copy_from: forgerock.eventName
      ignore_failure: true
  - set:
      if: (ctx?.forgerock?.result != null && ["SUCCESSFUL"].contains(ctx.forgerock.result))
      field: event.outcome
      value: "success"
      ignore_failure: true
  - set:
      if: (ctx?.forgerock?.result == null || ["FAILED"].contains(ctx.forgerock.result))
      field: event.outcome
      value: "failure"
      ignore_failure: true
  - set:
      if: (ctx?.forgerock?.result && !["SUCCESSFUL", "FAILED"].contains(ctx.forgerock.result))
      field: event.outcome
      value: "unknown"
      ignore_failure: true
  - set:
      field: user.id
      copy_from: forgerock.userId
      ignore_failure: true