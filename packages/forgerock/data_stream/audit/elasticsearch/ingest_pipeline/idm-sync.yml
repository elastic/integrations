---
description: Pipeline for ForgeRock IDM config logs.
# ForgeRock IDM Configuration Logs: https://backstage.forgerock.com/docs/idm/7.2/audit-guide/config-event-prop.html
processors:
  - set: 
      field: user.id
      copy_from: forgerock.userId
      ignore_failure: true
  - set:
      if: ctx?.forgerock?.status == "SUCCESS"
      field: event.outcome
      value: "success"
      ignore_failure: true
  - set:
      if: ctx?.forgerock?.status == "FAIL"
      field: event.outcome
      value: "failure"
      ignore_failure: true

  - remove:
      if: ctx?.forgerock?.exception == null
      field: 
        - forgerock.exception
      ignore_failure: true
  - remove:
      if: ctx?.forgerock?.message == null
      field: 
        - forgerock.message
      ignore_failure: true
  - remove:
      if: ctx?.forgerock?.sourceObjectId == null
      field: 
        - forgerock.sourceObjectId
      ignore_failure: true
  - remove:
      if: ctx?.forgerock?.targetObjectId == null
      field: 
        - forgerock.targetObjectId
      ignore_failure: true
