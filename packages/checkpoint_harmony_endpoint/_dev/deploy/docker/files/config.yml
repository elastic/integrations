rules:
  - path: /auth/external
    methods: ["POST"]
    request_headers:
      Accept:
        - "application/json"
      Content-Type:
        - "application/json"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: '{"success":true,"data":{"token":"xxxx","csrf":"xxxx","expires":"Tue, 10 Sep 2024 09:11:32 GMT","expiresIn":1800}}'
  - path: /app/laas-logs-api/api/logs_query
    methods: ["POST"]
    request_headers:
      Accept:
        - "application/json"
      Content-Type:
        - "application/json"
      Authorization:
        - "Bearer xxxx"
    request_body: |
      {
        "filter": "product:\"Forensics\"",
        "limit": 10000,
        "pageLimit": 1000,
        "cloudService": "Harmony Endpoint",
        "timeframe": {
          "startTime": "2024-08-01T05:00:00Z",
          "endTime": "2024-09-10T05:00:00Z"
        }
      }
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: '{ "success": true, "data": { "taskId": "xxxx" } }'
  - path: /app/laas-logs-api/api/logs_query/xxxx
    methods: ["GET"]
    request_headers:
      Accept:
        - "application/json"
      Content-Type:
        - "application/json"
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: '{"success": true, "data": { "state": "Ready", "pageTokens": [ "xxxx" ] }}'
  - path: /app/laas-logs-api/api/logs_query/retrieve
    methods: ["POST"]
    request_headers:
      Accept:
        - "application/json"
      Content-Type:
        - "application/json"
      Authorization:
        - "Bearer xxxx"
    request_body: |
      {
        "taskId": "xxxx",
          "pageToken": "xxxx"
      }
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"success":true,"data":{"records":[{"confidence_level":"High","policy_date":"2024-09-02T06:23:25.0000000Z","severity":"Critical","time":"2024-09-03T08:53:12.000001Z","id":"a4640108-91b1-0f19-66d6-ceb500000000","orig":"164.100.1.8","sequencenum":1,"action":"Detect","product":"Forensics","domain":"SMC User","product_family":"Endpoint","type":"Log","description":"To exclude the file: On the Harmony Endpoint Management add this sha1 exclusion: 62f0bd56-b0e1235b-99940b34-916c19ec-fac8e80c Attack status: Dormant.","protection_type":"File Reputation","attack_status":"Dormant","client_name":"Check Point Endpoint Security Client","client_version":["88.50.0213"],"detected_by":"Endpoint File Reputation","event_type":"Forensics Case Analysis","file_md5":"1468c1908845ef238f7f196809946288","file_name":["malz5.zip"],"file_sha1":"62f0bd56b0e1235b99940b34916c19ecfac8e80c","file_size":12707198,"file_type":"zip","host_type":["Desktop"],"installed_products":"Full Disk Encryption; Media Encryption & Port Protection; Firewall; Compliance; Application Control; Anti-Malware; VPN; Anti-Bot; Forensics; Threat Emulation","malware_action":[" "],"os_name":["Microsoft Windows 10 Pro"],"os_version":["10.0-19045-SP0.0-SMP"],"packet_capture_unique_id":"0acd55a9-f241-4097-a699-6b7e41cd26af","policy_name":"Default Forensics settings","policy_number":3,"protection_name":"Gen.Rep.zip","remediated_files":"malz5.zip(Remediation disabled in policy)","resource":["c:\\users\\admin\\downloads\\malz5.zip"],"service_domain":"ep-demo","src":"10.35.38.102","src_machine_name":"DESKTOP-E2P4OL0","src_user_name":["admin"],"suspicious_events":"System Shutdown / Reboot: ; ","tenant_id":"3e15ed24-89ff-4986-a204-c425cee4ba48","user_sid":"S-1-5-21-3766288932-3295778425-2939962592-1001","packet_capture":"Packet Capture"}],"recordsCount":1,"nextPageToken":"NULL"}}
