- name: checkpoint_harmony_endpoint.antimalware
  type: group
  fields:
    - name: attack_status
      type: keyword
      description: Status of attack
    - name: detected_by
      type: keyword
      description: Component which detected Event
    - name: confidence_level
      type: keyword
      description: Confidence level
    - name: description
      type: text
      description: Details of the event
    - name: policy
      type: group
      fields:
        - name: date
          type: date
          description: Date of policy
        - name: name
          type: keyword
          description: Name of policy
        - name: number
          type: integer
          description: Version number of policy
    - name: protection_type
      type: keyword
      description: Source of detection - can be IOC when manually configured, or URL/IP/CMI Reputation
    - name: severity
      type: keyword
      description: Event severity
    - name: service_domain
      type: keyword
      description: Service Domain Name
    - name: packet_capture_unique_id
      type: keyword
      description: Unique Packet Capture ID
    - name: suspicious_events
      type: text
      description: Identified suspicious events
    - name: tenant_id
      type: keyword
      description: Tenant ID
    - name: malware
      type: group
      fields:
        - name: category
          type: keyword
          description: Malware category
    - name: client
      type: group
      fields:
        - name: name
          type: keyword
          description: Can be either Check Point Endpoint Security Client or Check Point Capsule Docs Client
        - name: version
          type: version
          description: Build version of Harmony Endpoint client installed on the computer
    - name: proxy_src_ip
      type: ip
      description: Address where traffic was sent
    - name: connectivity_state
      type: keyword
      description: Type of currently applied AM policy (Connected/Disconnected/Restricted)
    - name: action_details
      type: keyword
      description: Malware action details
    - name: packet_capture
      type: keyword
      description: Link to the PCAP traffic capture file with the recorded malicious connection.
    - name: product
      type: group
      fields:
        - name: name
          type: keyword
          description: Product Name
        - name: family
          type: keyword
          description: The product family the blade/product belongs to possible values (0 - Network, 1 - Endpoint, 2 - Access, 3 - Threat, 4 - Mobile)    
    - name: sequencenum
      type: integer
      description: Number added to order logs with the same Linux timestamp and origin (Security Gateway that generated these logs)
    - name: src
      type: ip
      description: Client source IP address
    - name: type
      type: keyword
      description: Log type
    - name: event_type
      type: keyword
      description: Name of the event  
    - name: installed_products
      type: keyword
      description: List of installed Endpoint Software Blades
    - name: orig
      type: ip
    - name: os_name
      type: keyword
      description: Name of the OS installed on the source endpoint computer
    - name: os_version
      type: keyword
      description: Build version of the OS installed on the source endpoint computer
    - name: duration
      type: long
      description: Scan duration
    - name: engine_version
      type: keyword
      description: Engine Version
    - name: integrity_av_invoke_type
      type: keyword
      description: Type of scan
    - name: Number_of_items
      type: group
      fields:
        - name: detected
          type: integer
          description: Number of detected items
        - name: scanned
          type: integer
          description: Number of scan items
        - name: treated
          type: integer
          description: Number of treated items
    - name: result
      type: keyword
      description: Update result
    - name: signature_version
      type: keyword
      description: signarure version
    - name: advanced_info
      type: text
      description: Internal field used for configuring exclusions
