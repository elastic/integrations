---
description: Convert Appgate Audit log to ECS format - renaming original fields to ECS versions
processors:
  - rename:
      target_field: host.id
      field: distinguished_name_device_id
      ignore_missing: true
  - rename:
      target_field: host.ip
      field: host_ip
      ignore_missing: true
  - set:
      if: '!(ctx.containsKey(''host_ip'')) && ctx.containsKey(''client_ip'')'
      field: host.ip
      value: '{{{client_ip}}}'
      ignore_failure: true
  - rename:
      target_field: client.port
      field: client_port
      ignore_missing: true
  - rename:
      target_field: network.packets
      field: packet_size
      ignore_missing: true
  - rename:
      target_field: network.protocol
      field: protocol
      ignore_missing: true
  - rename:
      target_field: rule.name
      field: rule_name
      ignore_missing: true
  - rename:
      target_field: source.ip
      field: source_ip
      ignore_missing: true
  - rename:
      target_field: source.port
      field: source_port
      ignore_missing: true
  - rename:
      target_field: organization.name
      field: distinguished_name_ou
      ignore_missing: true
  - rename:
      target_field: user.name
      field: username
      ignore_missing: true
  - rename:
      target_field: user.name
      field: distinguished_name_user
      ignore_missing: true
  - rename:
      target_field: client.ip
      field: client_ip
      ignore_missing: true
  - rename:
      target_field: related.ip
      field: device_claims.clientIPs
      ignore_missing: true
  - rename:
      target_field: client.geo
      field: geoip
      ignore_missing: true
  - rename:
      target_field: destination.ip
      field: destination_ip
      ignore_missing: true
  - rename:
      target_field: destination.port
      field: destination_port
      ignore_missing: true
  - rename:
      target_field: event.action
      field: event_type
      ignore_missing: true
  - rename:
      target_field: rule.category
      field: entity_type
      ignore_missing: true
  - rename:
      target_field: rule.action
      field: action
      ignore_missing: true
  - set:
      description: Combine date element fields
      field: event.created
      value: '{{{month}}} {{{day}}} {{{time}}}'
  - date:
      field: event.created
      formats:
        - MMM dd HH:mm:ss
      target_field: event.created
  - rename:
      target_field: event.process.name
      field: device_claims.running_processes
      ignore_missing: true
  - rename:
      target_field: host.hostname
      field: device_claims.os.hostname
      ignore_missing: true
  - rename:
      target_field: host.mac
      field: device_claims.macAddresses
      ignore_missing: true
  - rename:
      target_field: host.os.name
      field: device_claims.os.name
      ignore_missing: true
  - rename:
      target_field: host.os.type
      field: device_claims.os.type
      ignore_missing: true
  - rename:
      target_field: host.os.version
      field: device_claims.os.version
      ignore_missing: true
  - rename:
      target_field: host.architecture
      field: device_claims.os.platform
      ignore_missing: true
  - rename:
      target_field: host.name
      field: device_claims.os.hostname
      ignore_missing: true
  - rename:
      target_field: host.os.family
      field: device_claims.os.family
      ignore_missing: true
  - rename:
      target_field: source.ip
      field: system_claims.clientSrcIP
      ignore_missing: true