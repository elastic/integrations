---
description: Pipeline for parsing azure spring cloud logs.
processors:
  - script:
      source: "ctx['_index'] = ctx['_index'].replace('platformlogs', 'springcloudlogs')"
      ignore_failure: true
  - rename:
      field: azure.platformlogs
      target_field: azure.springcloudlogs
      ignore_missing: true
  - set:
      field: event.dataset
      value: azure.springcloudlogs
      ignore_failure: true
  - set:
      field: data_stream.dataset
      value: azure.springcloudlogs
      ignore_failure: true
  - drop:
      if: "ctx.azure.springcloudlogs.category != 'SystemLogs' && ctx.azure.springcloudlogs.category != 'ApplicationConsole'"
      ignore_failure: true
  - rename:
      field: azure.springcloudlogs.LogFormat
      target_field: azure.springcloudlogs.log_format
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.properties.InstanceName
      target_field: azure.springcloudlogs.properties.instance_name
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.properties.Log
      target_field: azure.springcloudlogs.properties.log
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.properties.ServiceName
      target_field: azure.springcloudlogs.properties.service_name
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.properties.Stream
      target_field: azure.springcloudlogs.properties.stream
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.properties.AppName
      target_field: azure.springcloudlogs.properties.app_name
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.properties.ServiceId
      target_field: azure.springcloudlogs.properties.service_id
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.properties.Type
      target_field: azure.springcloudlogs.properties.type
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.properties.Level
      target_field: azure.springcloudlogs.level
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.properties.Logger
      target_field: azure.springcloudlogs.properties.logger
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.properties.Stack
      target_field: azure.springcloudlogs.properties.stack
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.properties.Thread
      target_field: azure.springcloudlogs.properties.thread
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.level
      target_field: log.level
      ignore_missing: true
  - rename:
      field: azure.springcloudlogs.operationName
      target_field: azure.springcloudlogs.operation_name
      ignore_missing: true
  - convert:
      field: azure.springcloudlogs.operation_name
      target_field: event.action
      type: string
      ignore_missing: true
on_failure:
  - set:
      field: error.message
      value: '{{ _ingest.on_failure_message }}'
