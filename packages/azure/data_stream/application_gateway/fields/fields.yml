- name: azure.application_gateway
  type: group
  fields:
    - name: operation_name
      type: keyword
      description: |
        Operation name
    - name: action
      type: keyword
      description: |-
        Action taken on the request. Available values are:
        Blocked and Allowed (for custom rules)
        Matched (when a rule matches a part of the request)
        Detected and Blocked (these are both for mandatory rules, depending on if the WAF is in detection or prevention mode).
    - name: instance_id
      type: keyword
      description: |-
        Application Gateway instance for which firewall data is being generated. For a multiple-instance application gateway, there is one row per instance.
    - name: transaction_id
      type: keyword
      description: |-
        Unique ID for a given transaction which helps group multiple rule violations that occurred within the same request.
    - name: hostname
      type: keyword
      description: |-
        Hostname or IP address of the Application Gateway.
    - name: policy.id
      type: keyword
      description: |-
        Unique ID of the Firewall Policy associated with the Application Gateway, Listener, or Path.
    - name: policy.scope
      type: keyword
      description: |-
        The location of the policy - values can be "Global", "Listener", or "Location".
    - name: policy.scope_name
      type: keyword
      description: |-
        The name of the object where the policy is applied.
    - name: backend_pool_name
      type: keyword
      description: |-
        Name of the backend pool.
    - name: backend_setting_name
      type: keyword
      description: |-
        Name of the backend HTTP settings.
    - name: listener_name
      type: keyword
      description: |-
        Name of the listener that processed the request.
    - name: rule_name
      type: keyword
      description: |-
        Name of the rule that processed the request.
    - name: original_host
      type: keyword
      description: |-
        Original host header from the client request.
    - name: original_request_uri_with_args
      type: keyword
      description: |-
        Original request URI with query parameters.
    - name: ssl_enabled
      type: keyword
      description: |-
        Whether SSL/TLS was enabled (on/off).
    - name: ssl_client_verify
      type: keyword
      description: |-
        Result of the SSL client certificate verification.
    - name: ssl_client_certificate_fingerprint
      type: keyword
      description: |-
        Fingerprint of the client SSL certificate.
    - name: ssl_client_certificate_issuer_name
      type: keyword
      description: |-
        Issuer name of the client SSL certificate.
    - name: backend_ssl_protocol
      type: keyword
      description: |-
        SSL/TLS protocol used for backend connection.
    - name: backend_ssl_cipher
      type: keyword
      description: |-
        SSL/TLS cipher used for backend connection.
    - name: server_routed
      type: keyword
      description: |-
        Backend server (IP:port) that processed the request.
    - name: server_status
      type: keyword
      description: |-
        HTTP status code returned by the backend server.
    - name: server_response_latency
      type: float
      description: |-
        Time taken by the backend server to respond (in seconds).
    - name: server_connect_time
      type: float
      description: |-
        Time taken to establish connection to the backend server (in seconds).
    - name: server_header_time
      type: float
      description: |-
        Time taken to receive the response headers from the backend server (in seconds).
    - name: client_response_time
      type: float
      description: |-
        Time taken to send the response to the client (in seconds).
    - name: connection_serial_number
      type: long
      description: |-
        Serial number of the connection.
    - name: no_of_connection_requests
      type: long
      description: |-
        Number of requests on the connection.
    - name: error_info
      type: keyword
      description: |-
        Error information for the request.
    - name: content_type
      type: keyword
      description: |-
        Content-Type header from the request.
    - name: upstream_source_port
      type: keyword
      description: |-
        Source port used for the upstream connection.
