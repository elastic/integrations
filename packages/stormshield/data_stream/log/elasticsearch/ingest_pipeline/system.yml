---
description: Pipeline for Stormshield filterstat Logs.
# API Docs: https://documentation.stormshield.eu/SNS/v4/en/Content/Description_of_Audit_logs/Specific_fields-filterstat.htm
processors:
  - rename:
      target_field: stormshield.logtype
      field: ss.logtype

  - set:
      copy_from: "ss.user"
      field: user.name
      if: ctx.ss?.user != null

  - set:
      copy_from: "ss.src"
      field: "source.ip"
      if: ctx.ss?.src != null

  - set:
      copy_from: "ss.dst"
      field: "destination.ip"
      if: ctx.ss?.dst != null

  - set:
      field: source.address
      copy_from: "source.ip"
      if: ctx.source?.ip != null

  - set:
      field: destination.address
      copy_from: "destination.ip"
      if: ctx.destination?.ip != null

  - rename:
      field: ss
      target_field: stormshield.system
