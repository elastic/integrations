---
description: Pipeline for Stormshield filterstat Logs.
# API Docs: https://documentation.stormshield.eu/SNS/v4/en/Content/Description_of_Audit_logs/Specific_fields-filterstat.htm
processors:
  - rename:
      target_field: stormshield.logtype
      field: ss.logtype

  - rename:
      field: ss
      target_field: stormshield.vpn

  - rename:
      field: "stormshield.user"
      target_field: user.name
      if: ctx.stormshield?.user != null

  - rename:
      field: "stormshield.src"
      target_field: "source.ip"
      if: ctx.stormshield?.src != null

  - rename:
      field: "stormshield.domain"
      target_field: "user.domain"
      if: ctx.stormshield?.domain != null

  - set:
      field: source.address
      copy_from: "source.ip"
      if: ctx.source?.ip != null