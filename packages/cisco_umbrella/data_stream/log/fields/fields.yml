- name: cisco.umbrella
  type: group
  description: >
    Fields for Cisco Umbrella.

  fields:
    - name: action
      type: keyword
      description: >
        Whether the request was allowed or blocked.

    - name: identity
      type: keyword
      description: >
        The identity that made the request. An identity can be a high-level entity within your system (e.g a network) or very granular (e.g a single user)

    - name: identities
      type: keyword
      description: >
        An array of the different identities related to the event.

    - name: categories
      type: keyword
      description: >
        The security or content categories that the destination matches.

    - name: policy_identity_type
      type: keyword
      description: >
        The first identity type matched with this request. Available in version 3 and above.

    - name: identity_types
      type: keyword
      description: >
        The type of identity that made the request. For example, Roaming Computer or Network.

    - name: blocked_categories
      type: keyword
      description: >
        The categories that resulted in the destination being blocked. Available in version 4 and above.

    - name: content_type
      type: keyword
      description: >
        The type of web content, typically text/html.

    - name: sha_sha256
      type: keyword
      description: >
        Hex digest of the response content.

    - name: av_detections
      type: keyword
      description: >
        The detection name according to the antivirus engine used in file inspection.

    - name: puas
      type: keyword
      description: >
        A list of all potentially unwanted application (PUA) results for the proxied file as returned by the antivirus scanner.

    - name: amp_disposition
      type: keyword
      description: >
        The status of the files proxied and scanned by Cisco Advanced Malware Protection (AMP) as part of the Umbrella File Inspection feature; can be Clean, Malicious or Unknown.

    - name: amp_malware_name
      type: keyword
      description: >
        If Malicious, the name of the malware according to AMP.

    - name: amp_score
      type: keyword
      description: >
        The score of the malware from AMP. This field is not currently used and will be blank.

    - name: datacenter
      type: keyword
      description: >
        The name of the Umbrella Data Center that processed the user-generated traffic.

    - name: origin_id
      type: keyword
      description: >
        The unique identity of the network tunnel.

    - name: request_method
      type: keyword
      description: >
        The request method.

    - name: dlp_status
      type: keyword
      description: >
        If the request was Blocked for DLP.

    - name: certificate_errors
      type: keyword
      description: >
        Any certificate or protocol errors in the request.

    - name: file_name
      type: keyword
      description: >
        The name of the file.

    - name: ruleset_id
      type: keyword
      description: >
        The ID number assigned to the ruleset by Umbrella.

    - name: rule_id
      type: keyword
      description: >
        The ID number assigned to the rule by Umbrella.

    - name: destination_lists_id
      type: keyword
      description: >
        The ID number umbrella assigns to a destination list.

    - name: isolate_action
      type: keyword
      description: >
        The remote browser isolation state associated with the request.

    - name: file_action
      type: keyword
      description: >
        The action taken on a file in a remote browser isolation session.

    - name: warn_status
      type: keyword
      description: >
        The warn page state associated with the request.

    - name: audit.type
      type: keyword
      description: Where the change was made, such as settings or a policy.
    - name: audit.before
      type: keyword
      description: The policy or setting before the change was made.
    - name: audit.after
      type: keyword
      description: The policy or setting after the change was made.
