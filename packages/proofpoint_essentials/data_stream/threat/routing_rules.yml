- source_dataset: proofpoint_essentials.threat
  rules:
    - target_dataset: proofpoint_essentials.clicks_blocked
      if: ctx.proofpoint_essentials?.threat?.event_type == 'clicks_blocked'
      namespace:
        - "{{data_stream.namespace}}"
        - default
    - target_dataset: proofpoint_essentials.clicks_permitted
      if: ctx.proofpoint_essentials?.threat?.event_type == 'clicks_permitted'
      namespace:
        - "{{data_stream.namespace}}"
        - default
    - target_dataset: proofpoint_essentials.message_blocked
      if: ctx.proofpoint_essentials?.threat?.event_type == 'messages_blocked'
      namespace:
        - "{{data_stream.namespace}}"
        - default
    - target_dataset: proofpoint_essentials.message_delivered
      if: ctx.proofpoint_essentials?.threat?.event_type == 'messages_delivered'
      namespace:
        - "{{data_stream.namespace}}"
        - default
