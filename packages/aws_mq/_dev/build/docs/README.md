# Amazon MQ

## Overview

[Amazon MQ](https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/) is a fully managed message broker service that supports [Apache ActiveMQ](http://activemq.apache.org/) Classic and [RabbitMQ](https://www.rabbitmq.com/), making it easy to set up and operate message brokers in the cloud. It provides automated broker provisioning, maintenance, and scaling, allowing you to focus on building applications without managing the underlying infrastructure. With built-in security, reliability, and support for industry-standard messaging protocols, Amazon MQ enables seamless communication between distributed applications.

The Amazon MQ integration allows you to efficiently collect and monitor broker performance, queue activity, and message throughput by ingesting CloudWatch metrics into Elastic. This integration helps you gain deep insights into broker health, optimize message flow, and troubleshoot issues in real time.


**IMPORTANT: Extra AWS charges on API requests will be generated by this integration. Check [API Requests](https://www.elastic.co/docs/current/integrations/aws#aws-api-requests) for more details.**

## Compatibility

This integration presently supports Amazon MQ for [Apache ActiveMQ](http://activemq.apache.org/) and [RabbitMQ](https://www.rabbitmq.com/) metrics.

## Data streams

The Amazon MQ integration collects Apache ActiveMQ and RabbitMQ metrics. 


Data streams:
 - `activemq_metrics`: Collects broker metrics and destination (queue and topic) metrics.
 - `rabbitmq_metrics`: Collects broker, queue and node metrics.


## Requirements

You need Elasticsearch for storing and searching your data and Kibana for
visualizing and managing it. You can use our hosted Elasticsearch Service on
Elastic Cloud, which is recommended, or self-manage the Elastic Stack on your
own hardware.

Before using any Amazon MQ integration you will need:

* **AWS Credentials** to connect with your AWS account.
* **AWS Permissions** to make sure the user you're using to connect has
  permission to share the relevant data.

For more details about these requirements, check the [AWS
integration
documentation](https://docs.elastic.co/integrations/aws#requirements).

* Elastic Agent must be installed. For detailed guidance, follow these [instructions](https://www.elastic.co/guide/en/fleet/current/elastic-agent-installation.html).
* You can install only one Elastic Agent per host.
* Elastic Agent is required to stream data from the S3 bucket and ship the
  data to Elastic, where the events will then be processed through the
  integration's ingest pipelines.


## Metrics

### ActiveMQ metrics

Amazon MQ for ActiveMQ provides a range of broker and queue metrics that help monitor system performance, resource utilization, and message flow. These metrics can be used for various use cases, including:

- Tracking broker resource utilization, such as compute, memory, and storage.
- Monitoring message throughput and queue performance.
- Identifying connection patterns and active consumers for optimizing messaging workloads.

The following metrics are related to [Amazon MQ quotas](https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/amazon-mq-limits.html). You can disable their collection by turning off **Collect ActiveMQ quota metrics** under **Advanced Options**:

- AmqpMaximumConnections
- MqttMaximumConnections
- OpenwireMaximumConnections
- StompMaximumConnections
- WsMaximumConnections

{{event "activemq_metrics"}}
{{fields "activemq_metrics"}}


### RabbitMQ metrics

Amazon MQ for RabbitMQ offers a variety of broker and queue metrics to monitor system performance, resource utilization, and message flow. These metrics are essential for:

- Assessing broker resource usage, including CPU, memory, and storage.
- Tracking message rates and queue depths to ensure efficient message processing.
- Analyzing connection counts and consumer activity to optimize messaging workloads.

{{event "rabbitmq_metrics"}}
{{fields "rabbitmq_metrics"}}