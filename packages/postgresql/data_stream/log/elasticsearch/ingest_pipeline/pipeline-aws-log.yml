---
description: Pipeline for parsing PostgreSQL logs.
processors:
  - grok:
      field: raw_message
      ignore_missing: true
      patterns:
        - '(%{IPORHOST:source.ip}\(%{INT:source.port:int}\))?%{USERNAME:user.name}?@%{POSTGRESQL_DB_NAME:postgresql.log.database}?:(\[%{NUMBER:process.pid:long}\])?:%{WORD:log.level}: %{GREEDYDATA:message}'
      pattern_definitions:
        GREEDYDATA: |-
          (.|
          |	)*
        POSTGRESQL_DB_NAME: '[a-zA-Z0-9_]+[a-zA-Z0-9_\$]*'
