{
    "expected": [
        {
            "@timestamp": "2021-01-04T00:33:05.565Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "category": [
                    "database"
                ],
                "duration": 189000,
                "ingested": "2024-06-18T05:50:18.322369821Z",
                "kind": "event",
                "original": "2021-01-04 00:33:05.565 UTC,\"postgres\",\"postgres\",81,\"172.24.0.1:42798\",5ff26239.51,5,\"SET\",2021-01-04 00:32:57 UTC,3/0,0,LOG,00000,\"duration: 0.189 ms  statement: set log_temp_files = 0;\",,,,,,,,,\"psql\"",
                "timezone": "UTC",
                "type": [
                    "info"
                ]
            },
            "log": {
                "level": "LOG"
            },
            "message": "set log_temp_files = 0;",
            "postgresql": {
                "log": {
                    "application_name": "psql",
                    "client_addr": "172.24.0.1",
                    "client_port": 42798,
                    "command_tag": "SET",
                    "database": "postgres",
                    "query_step": "statement",
                    "session_id": "5ff26239.51",
                    "session_start_time": "2021-01-04T00:32:57.000Z",
                    "sql_state_code": "00000",
                    "timestamp": "2021-01-04 00:33:05.565 UTC",
                    "transaction_id": 0,
                    "virtual_transaction_id": "3/0"
                }
            },
            "process": {
                "pid": 81
            },
            "related": {
                "user": [
                    "postgres"
                ]
            },
            "tags": [
                "preserve_original_event"
            ],
            "user": {
                "name": "postgres"
            }
        },
        {
            "@timestamp": "2021-01-04T00:33:15.885Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "category": [
                    "database"
                ],
                "ingested": "2024-06-18T05:50:18.322398959Z",
                "kind": "event",
                "original": "2021-01-04 00:33:15.885 UTC,\"postgres\",\"postgres\",81,\"172.24.0.1:42798\",5ff26239.51,6,\"SELECT\",2021-01-04 00:32:57 UTC,3/81,0,LOG,00000,\"temporary file: path \"\"base/pgsql_tmp/pgsql_tmp81.3\"\", size 162381824\",,,,,,\"select * from generate_series(1, 3000) as t1(a), generate_series(1, 3000) as t2(a) order by 1 desc, 2;\",,,\"psql\"",
                "timezone": "UTC",
                "type": [
                    "info"
                ]
            },
            "log": {
                "level": "LOG"
            },
            "message": "temporary file: path \"base/pgsql_tmp/pgsql_tmp81.3\", size 162381824",
            "postgresql": {
                "log": {
                    "application_name": "psql",
                    "client_addr": "172.24.0.1",
                    "client_port": 42798,
                    "command_tag": "SELECT",
                    "database": "postgres",
                    "query": "select * from generate_series(1, 3000) as t1(a), generate_series(1, 3000) as t2(a) order by 1 desc, 2;",
                    "session_id": "5ff26239.51",
                    "session_start_time": "2021-01-04T00:32:57.000Z",
                    "sql_state_code": "00000",
                    "timestamp": "2021-01-04 00:33:15.885 UTC",
                    "transaction_id": 0,
                    "virtual_transaction_id": "3/81"
                }
            },
            "process": {
                "pid": 81
            },
            "related": {
                "user": [
                    "postgres"
                ]
            },
            "tags": [
                "preserve_original_event"
            ],
            "user": {
                "name": "postgres"
            }
        },
        {
            "@timestamp": "2021-01-04T00:33:15.885Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "category": [
                    "database"
                ],
                "ingested": "2024-06-18T05:50:18.322403918Z",
                "kind": "event",
                "original": "2021-01-04 00:33:15.885 UTC,\"postgres\",\"postgres\",81,\"172.24.0.1:42798\",5ff26239.51,7,\"SELECT\",2021-01-04 00:32:57 UTC,3/81,0,LOG,00000,\"temporary file: path \"\"base/pgsql_tmp/pgsql_tmp81.1\"\", size 42000\",,,,,,\"select * from generate_series(1, 3000) as t1(a), generate_series(1, 3000) as t2(a) order by 1 desc, 2;\",,,\"psql\"",
                "timezone": "UTC",
                "type": [
                    "info"
                ]
            },
            "log": {
                "level": "LOG"
            },
            "message": "temporary file: path \"base/pgsql_tmp/pgsql_tmp81.1\", size 42000",
            "postgresql": {
                "log": {
                    "application_name": "psql",
                    "client_addr": "172.24.0.1",
                    "client_port": 42798,
                    "command_tag": "SELECT",
                    "database": "postgres",
                    "query": "select * from generate_series(1, 3000) as t1(a), generate_series(1, 3000) as t2(a) order by 1 desc, 2;",
                    "session_id": "5ff26239.51",
                    "session_start_time": "2021-01-04T00:32:57.000Z",
                    "sql_state_code": "00000",
                    "timestamp": "2021-01-04 00:33:15.885 UTC",
                    "transaction_id": 0,
                    "virtual_transaction_id": "3/81"
                }
            },
            "process": {
                "pid": 81
            },
            "related": {
                "user": [
                    "postgres"
                ]
            },
            "tags": [
                "preserve_original_event"
            ],
            "user": {
                "name": "postgres"
            }
        },
        {
            "@timestamp": "2021-01-04T00:33:15.885Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "category": [
                    "database"
                ],
                "ingested": "2024-06-18T05:50:18.322408288Z",
                "kind": "event",
                "original": "2021-01-04 00:33:15.885 UTC,\"postgres\",\"postgres\",81,\"172.24.0.1:42798\",5ff26239.51,8,\"SELECT\",2021-01-04 00:32:57 UTC,3/81,0,LOG,00000,\"temporary file: path \"\"base/pgsql_tmp/pgsql_tmp81.2\"\", size 42000\",,,,,,\"select * from generate_series(1, 3000) as t1(a), generate_series(1, 3000) as t2(a) order by 1 desc, 2;\",,,\"psql\"",
                "timezone": "UTC",
                "type": [
                    "info"
                ]
            },
            "log": {
                "level": "LOG"
            },
            "message": "temporary file: path \"base/pgsql_tmp/pgsql_tmp81.2\", size 42000",
            "postgresql": {
                "log": {
                    "application_name": "psql",
                    "client_addr": "172.24.0.1",
                    "client_port": 42798,
                    "command_tag": "SELECT",
                    "database": "postgres",
                    "query": "select * from generate_series(1, 3000) as t1(a), generate_series(1, 3000) as t2(a) order by 1 desc, 2;",
                    "session_id": "5ff26239.51",
                    "session_start_time": "2021-01-04T00:32:57.000Z",
                    "sql_state_code": "00000",
                    "timestamp": "2021-01-04 00:33:15.885 UTC",
                    "transaction_id": 0,
                    "virtual_transaction_id": "3/81"
                }
            },
            "process": {
                "pid": 81
            },
            "related": {
                "user": [
                    "postgres"
                ]
            },
            "tags": [
                "preserve_original_event"
            ],
            "user": {
                "name": "postgres"
            }
        },
        {
            "@timestamp": "2021-01-04T00:33:15.885Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "category": [
                    "database"
                ],
                "duration": 6921284096,
                "ingested": "2024-06-18T05:50:18.322412193Z",
                "kind": "event",
                "original": "2021-01-04 00:33:15.885 UTC,\"postgres\",\"postgres\",81,\"172.24.0.1:42798\",5ff26239.51,9,\"SELECT\",2021-01-04 00:32:57 UTC,3/0,0,LOG,00000,\"duration: 6921.284 ms  statement: select * from generate_series(1, 3000) as t1(a), generate_series(1, 3000) as t2(a) order by 1 desc, 2;\",,,,,,,,,\"psql\"",
                "timezone": "UTC",
                "type": [
                    "info"
                ]
            },
            "log": {
                "level": "LOG"
            },
            "message": "select * from generate_series(1, 3000) as t1(a), generate_series(1, 3000) as t2(a) order by 1 desc, 2;",
            "postgresql": {
                "log": {
                    "application_name": "psql",
                    "client_addr": "172.24.0.1",
                    "client_port": 42798,
                    "command_tag": "SELECT",
                    "database": "postgres",
                    "query_step": "statement",
                    "session_id": "5ff26239.51",
                    "session_start_time": "2021-01-04T00:32:57.000Z",
                    "sql_state_code": "00000",
                    "timestamp": "2021-01-04 00:33:15.885 UTC",
                    "transaction_id": 0,
                    "virtual_transaction_id": "3/0"
                }
            },
            "process": {
                "pid": 81
            },
            "related": {
                "user": [
                    "postgres"
                ]
            },
            "tags": [
                "preserve_original_event"
            ],
            "user": {
                "name": "postgres"
            }
        }
    ]
}