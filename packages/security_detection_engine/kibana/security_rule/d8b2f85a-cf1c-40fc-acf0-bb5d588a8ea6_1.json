{
    "attributes": {
        "author": [
            "Elastic"
        ],
        "description": "Identifies known execution traces of the REMCOS Remote Access Trojan. Remcos RAT is used by attackers to perform actions on infected machines remotely.",
        "from": "now-9m",
        "index": [
            "endgame-*",
            "logs-endpoint.events.registry-*",
            "logs-endpoint.events.file-*",
            "logs-m365_defender.event-*",
            "logs-sentinel_one_cloud_funnel.*",
            "logs-system.security*",
            "logs-windows.sysmon_operational-*",
            "winlogbeat-*"
        ],
        "language": "eql",
        "license": "Elastic License v2",
        "name": "Potential REMCOS Trojan Execution",
        "note": "## Triage and analysis\n\n### Investigating Potential REMCOS Trojan Execution\n\nRemcos RAT is used by attackers to perform actions on infected machines remotely.\n\n### Possible investigation steps\n\n- Review the origin of the REMCOS file and the execution chain to identify the initial vector..\n- Examine if the process is set to persist in the affected system via scheduled task, Startup folder or Run key.\n- Check the network, files and child processes activity associated with the every suspicious process in the execution chain of REMCOS.\n- Correlate the event with other security alerts or logs from data sources like Elastic Defend or Microsoft Defender for Endpoint to gather additional context and identify any related malicious activities.\n\n### Response and remediation\n\n- Immediately isolate the affected system from the network to prevent further unauthorized access or lateral movement by the attacker.\n- Terminate any suspicious processes identified in the alert, such as PowerShell, cmd.exe, or other flagged executables, to halt any ongoing malicious activity.\n- Review and revoke any unauthorized user accounts or privileges that may have been created or modified using tools like net.exe or schtasks.exe.\n- Conduct a thorough scan of the affected system using endpoint protection tools to identify and remove any malware or unauthorized software installed by the attacker.\n- Restore the system from a known good backup if any critical system files or configurations have been altered or compromised.\n- Escalate the incident to the security operations center (SOC) or incident response team for further investigation and to determine if additional systems are affected.\n- Implement enhanced monitoring and logging for ScreenConnect and other remote access tools to detect similar activities in the future, ensuring that alerts are promptly reviewed and acted upon.",
        "query": "any where host.os.type == \"windows\" and\n(\n (event.category == \"file\" and event.type == \"deletion\" and file.path like \"C:\\\\Users\\\\*\\\\AppData\\\\Local\\\\Temp\\\\TH????.tmp\") or\n\n (event.category == \"file\" and file.path : \"?:\\\\Users\\\\*\\\\AppData\\\\Roaming\\\\remcos\\\\logs.dat\") or\n\n (event.category == \"registry\" and\n  registry.value : (\"Remcos\", \"Rmc-??????\", \"licence\") and\n  registry.path : (\n      \"*\\\\Windows\\\\CurrentVersion\\\\Run\\\\Remcos\",\n      \"*\\\\Windows\\\\CurrentVersion\\\\Run\\\\Rmc-??????\",\n      \"*\\\\SOFTWARE\\\\Remcos-*\\\\licence\",\n      \"*\\\\Software\\\\Rmc-??????\\\\licence\"\n  )\n )\n)\n",
        "references": [
            "https://any.run/malware-trends/remcos",
            "https://attack.mitre.org/software/S0332/",
            "https://www.elastic.co/security-labs/exploring-the-ref2731-intrusion-set"
        ],
        "related_integrations": [
            {
                "package": "endpoint",
                "version": "^9.0.0"
            },
            {
                "package": "windows",
                "version": "^3.0.0"
            },
            {
                "package": "sentinel_one_cloud_funnel",
                "version": "^1.9.0"
            },
            {
                "package": "m365_defender",
                "version": "^3.0.0"
            },
            {
                "package": "system",
                "version": "^2.0.0"
            }
        ],
        "required_fields": [
            {
                "ecs": true,
                "name": "event.category",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "event.type",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "file.path",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "host.os.type",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "registry.path",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "registry.value",
                "type": "keyword"
            }
        ],
        "risk_score": 73,
        "rule_id": "d8b2f85a-cf1c-40fc-acf0-bb5d588a8ea6",
        "severity": "high",
        "tags": [
            "Domain: Endpoint",
            "OS: Windows",
            "Use Case: Threat Detection",
            "Tactic: Command and Control",
            "Resources: Investigation Guide",
            "Data Source: Elastic Endgame",
            "Data Source: Elastic Defend",
            "Data Source: Sysmon",
            "Data Source: SentinelOne",
            "Data Source: Microsoft Defender for Endpoint",
            "Data Source: Windows Security Event Logs"
        ],
        "threat": [
            {
                "framework": "MITRE ATT&CK",
                "tactic": {
                    "id": "TA0011",
                    "name": "Command and Control",
                    "reference": "https://attack.mitre.org/tactics/TA0011/"
                },
                "technique": [
                    {
                        "id": "T1219",
                        "name": "Remote Access Tools",
                        "reference": "https://attack.mitre.org/techniques/T1219/"
                    }
                ]
            }
        ],
        "timestamp_override": "event.ingested",
        "type": "eql",
        "version": 1
    },
    "id": "d8b2f85a-cf1c-40fc-acf0-bb5d588a8ea6_1",
    "type": "security-rule"
}