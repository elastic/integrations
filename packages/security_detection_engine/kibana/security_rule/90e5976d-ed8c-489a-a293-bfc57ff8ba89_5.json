{
    "attributes": {
        "author": [
            "Elastic"
        ],
        "building_block_type": "default",
        "description": "This rule identifies Linux system information discovery via the \"getconf\" command. The \"getconf\" command is used to query system configuration variables and system limits. Adversaries may use this command to gather information about the system, such as the page size, maximum number of open files, and other system limits, to aid in further exploration and exploitation of the system.",
        "from": "now-119m",
        "history_window_start": "now-5d",
        "index": [
            "logs-endpoint.events.process*"
        ],
        "interval": "60m",
        "language": "kuery",
        "license": "Elastic License v2",
        "name": "Linux System Information Discovery via Getconf",
        "new_terms_fields": [
            "process.parent.executable"
        ],
        "query": "event.category:process and host.os.type:linux and event.type:start and event.action:exec and process.name:getconf and not (\n  process.parent.executable:(\n    \"/usr/bin/google_guest_agent_manager\" or \"/opt/commvault/Base64/cvlaunchd\" or /usr/local/manageengine/uems_agent/bin/*\n  ) or\n  process.working_directory:(\n    \"/opt/oracle/mgmt_agent/agent_inst/bin\" or \"/var/lib/oracle-cloud-agent/plugins/oci-managementagent/polaris\" or\n    \"/opt/commvault/Base/cvlaunchd\" or \"/opt/simpana\" or \"/opt/commvault\" or \"/opt/ITSPlatform/agentcore\" or\n    \"/u01/app/oracle/EMBase/agent_inst/sysman/emd\" or \"/opt/abacus/lib\"\n  ) or\n  process.parent.args:(\n    /opt/oracle/mgmt_agent/agent_inst/* or \"/opt/datadog-agent/bin/agent/agent\" or \"/usr/bin/byobu-status\" or\n    \"/usr/local/nagios/libexec/check_ssl_cert\" or \"/usr/lib64/nagios/plugins/cpanel/check_ssl_cert\"\n  ) or\n  process.parent.command_line:(\n    \"/bin/sh -s unix:cmd\" or \"ruby /usr/local/bundle/bin/bundle exec rackup\"\n  )\n)\n",
        "references": [
            "https://blog.exatrack.com/Perfctl-using-portainer-and-new-persistences/"
        ],
        "related_integrations": [
            {
                "package": "endpoint",
                "version": "^8.2.0"
            }
        ],
        "required_fields": [
            {
                "ecs": true,
                "name": "event.action",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "event.category",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "event.type",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "host.os.type",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "process.name",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "process.parent.args",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "process.parent.command_line",
                "type": "wildcard"
            },
            {
                "ecs": true,
                "name": "process.parent.executable",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "process.working_directory",
                "type": "keyword"
            }
        ],
        "risk_score": 21,
        "rule_id": "90e5976d-ed8c-489a-a293-bfc57ff8ba89",
        "severity": "low",
        "tags": [
            "Domain: Endpoint",
            "OS: Linux",
            "Use Case: Threat Detection",
            "Tactic: Discovery",
            "Rule Type: BBR",
            "Data Source: Elastic Defend"
        ],
        "threat": [
            {
                "framework": "MITRE ATT&CK",
                "tactic": {
                    "id": "TA0007",
                    "name": "Discovery",
                    "reference": "https://attack.mitre.org/tactics/TA0007/"
                },
                "technique": [
                    {
                        "id": "T1082",
                        "name": "System Information Discovery",
                        "reference": "https://attack.mitre.org/techniques/T1082/"
                    }
                ]
            }
        ],
        "timestamp_override": "event.ingested",
        "type": "new_terms",
        "version": 5
    },
    "id": "90e5976d-ed8c-489a-a293-bfc57ff8ba89_5",
    "type": "security-rule"
}