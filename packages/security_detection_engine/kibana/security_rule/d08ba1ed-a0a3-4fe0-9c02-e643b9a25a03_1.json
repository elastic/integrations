{
    "attributes": {
        "author": [
            "Elastic"
        ],
        "description": "This rule detects FortiGate administrator account creation from a source IP address not previously seen performing admin operations on the device. Threat actors exploiting CVE-2026-24858 (FG-IR-26-060) authenticate via FortiCloud SSO bypass and immediately create local administrator accounts for persistence, typically from infrastructure not associated with normal administrative activity.",
        "from": "now-9m",
        "history_window_start": "now-5d",
        "index": [
            "logs-fortinet_fortigate.*"
        ],
        "interval": "5m",
        "language": "kuery",
        "license": "Elastic License v2",
        "name": "FortiGate Administrator Account Creation from Unusual Source",
        "new_terms_fields": [
            "fortinet.firewall.ui"
        ],
        "note": "## Triage and analysis\n\n### Investigating FortiGate Administrator Account Creation from Unusual Source\n\nThis alert indicates that an administrator account was created on a FortiGate device from a source IP address that has not been observed performing configuration changes in the recent history window. This is a behavioral indicator of compromise, as threat actors exploiting SSO bypass vulnerabilities typically operate from infrastructure not previously associated with the device.\n\n### Possible investigation steps\n\n- Review `source.ip` to determine whether the IP address belongs to a known management network or authorized administrator location. Check against known threat infrastructure from The Constant Company LLC, BL Networks, and Kaopu Cloud HK Limited.\n- Examine `fortinet.firewall.cfgobj` for the name of the newly created account and `fortinet.firewall.cfgattr` for the access profile assigned (especially super_admin).\n- Check `source.user.name` to identify the account that performed the creation and verify whether it was recently created itself or accessed via SSO.\n- Look for other configuration changes from the same source IP, including firewall policy modifications, configuration exports, or VPN user creation.\n- Run `get system admin` on the affected FortiGate to list all current administrator accounts and compare against the authorized list.\n\n### False positive analysis\n\n- Authorized administrators connecting from a new location (VPN, travel, new office).\n- Initial device setup or migration where configuration changes come from temporary infrastructure.\n- Managed service providers performing authorized administration from rotating IP addresses.\n\n### Response and remediation\n\n- If unauthorized, immediately delete the newly created administrator account and audit the source account for compromise.\n- Block the source IP at the perimeter and check other FortiGate devices for activity from the same IP.\n- Restore configuration from a known-clean backup and rotate all credentials including LDAP/AD accounts connected to the device.\n- Upgrade FortiOS to a patched version and disable FortiCloud SSO if not required.",
        "query": "event.dataset: \"fortinet_fortigate.log\" and\n    event.code: \"0100044547\" and\n    fortinet.firewall.cfgpath: \"system.admin\" and\n    fortinet.firewall.action: \"Add\" and\n    fortinet.firewall.ui: (* and not \"\")\n",
        "references": [
            "https://www.fortiguard.com/psirt/FG-IR-26-060",
            "https://www.fortinet.com/blog/psirt-blogs/analysis-of-sso-abuse-on-fortios",
            "https://www.elastic.co/docs/reference/integrations/fortinet_fortigate",
            "https://www.cisa.gov/news-events/alerts/2026/01/28/fortinet-releases-guidance-address-ongoing-exploitation-authentication-bypass-vulnerability-cve-2026"
        ],
        "related_integrations": [
            {
                "package": "fortinet_fortigate",
                "version": "^1.0.0"
            }
        ],
        "required_fields": [
            {
                "ecs": true,
                "name": "event.code",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "event.dataset",
                "type": "keyword"
            },
            {
                "ecs": false,
                "name": "fortinet.firewall.action",
                "type": "keyword"
            },
            {
                "ecs": false,
                "name": "fortinet.firewall.cfgpath",
                "type": "keyword"
            },
            {
                "ecs": false,
                "name": "fortinet.firewall.ui",
                "type": "keyword"
            }
        ],
        "risk_score": 47,
        "rule_id": "d08ba1ed-a0a3-4fe0-9c02-e643b9a25a03",
        "severity": "medium",
        "tags": [
            "Use Case: Threat Detection",
            "Tactic: Persistence",
            "Resources: Investigation Guide",
            "Domain: Network",
            "Domain: Identity",
            "Data Source: Fortinet",
            "Data Source: Fortinet FortiGate"
        ],
        "threat": [
            {
                "framework": "MITRE ATT&CK",
                "tactic": {
                    "id": "TA0003",
                    "name": "Persistence",
                    "reference": "https://attack.mitre.org/tactics/TA0003/"
                },
                "technique": [
                    {
                        "id": "T1136",
                        "name": "Create Account",
                        "reference": "https://attack.mitre.org/techniques/T1136/",
                        "subtechnique": [
                            {
                                "id": "T1136.001",
                                "name": "Local Account",
                                "reference": "https://attack.mitre.org/techniques/T1136/001/"
                            }
                        ]
                    }
                ]
            }
        ],
        "timestamp_override": "event.ingested",
        "type": "new_terms",
        "version": 1
    },
    "id": "d08ba1ed-a0a3-4fe0-9c02-e643b9a25a03_1",
    "type": "security-rule"
}