{
    "attributes": {
        "author": [
            "Elastic"
        ],
        "description": "Generates a detection alert each time an Elastic Defend alert is received. Enabling this rule allows you to immediately begin investigating your Endpoint alerts.",
        "enabled": true,
        "exceptions_list": [
            {
                "id": "endpoint_list",
                "list_id": "endpoint_list",
                "namespace_type": "agnostic",
                "type": "endpoint"
            }
        ],
        "from": "now-10m",
        "index": [
            "logs-endpoint.alerts-*"
        ],
        "language": "kuery",
        "license": "Elastic License v2",
        "max_signals": 10000,
        "name": "Endpoint Security (Elastic Defend)",
        "query": "event.kind:alert and event.module:(endpoint and not endgame)\n",
        "related_integrations": [
            {
                "package": "endpoint",
                "version": "^8.2.0"
            }
        ],
        "required_fields": [
            {
                "ecs": true,
                "name": "event.kind",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "event.module",
                "type": "keyword"
            }
        ],
        "risk_score": 47,
        "risk_score_mapping": [
            {
                "field": "event.risk_score",
                "operator": "equals",
                "value": ""
            }
        ],
        "rule_id": "9a1a2dae-0b5f-4c3d-8305-a268d404c306",
        "rule_name_override": "message",
        "setup": "## Setup\n\n### Elastic Defend Alerts\nIf this rule is disabled, you will not receive alerts for Elastic Defend alerts. This rule is designed to capture all alerts generated by Elastic Defend. For more granular alerting, consider using additional prebuilt-rules that capture specific Elastic Defend alerts.\n\nIf this rule is enabled, along with the related rules listed below, you will receive duplicate alerts for the same events. To avoid this, it is recommended to disable this generic rule and enable the more specific rules that capture these alerts separately.\n\nRelated rules:\n- Behavior - Detected - Elastic Defend (UUID: 0f615fe4-eaa2-11ee-ae33-f661ea17fbce)\n- Behavior - Prevented - Elastic Defend (UUID: eb804972-ea34-11ee-a417-f661ea17fbce)\n- Malicious File - Detected - Elastic Defend (UUID: f2c3caa6-ea34-11ee-a417-f661ea17fbce)\n- Malicious File - Prevented - Elastic Defend (UUID: f87e6122-ea34-11ee-a417-f661ea17fbce)\n- Memory Threat - Detected - Elastic Defend (UUID: 017de1e4-ea35-11ee-a417-f661ea17fbce)\n- Memory Threat - Prevented - Elastic Defend (UUID: 06f3a26c-ea35-11ee-a417-f661ea17fbce)\n- Ransomware - Detected - Elastic Defend (UUID: 0c74cd7e-ea35-11ee-a417-f661ea17fbce)\n- Ransomware - Prevented - Elastic Defend (UUID: 10f3d520-ea35-11ee-a417-f661ea17fbce)\n\n### Additional notes\nThis rule is configured to generate more **Max alerts per run** than the default 1000 alerts per run set for all rules. This is to ensure that it captures as many alerts as possible.\n\n**IMPORTANT:** The rule's **Max alerts per run** setting can be superseded by the `xpack.alerting.rules.run.alerts.max` Kibana config setting, which determines the maximum alerts generated by _any_ rule in the Kibana alerting framework. For example, if `xpack.alerting.rules.run.alerts.max` is set to 1000, this rule will still generate no more than 1000 alerts even if its own **Max alerts per run** is set higher.\n\nTo make sure this rule can generate as many alerts as it's configured in its own **Max alerts per run** setting, increase the `xpack.alerting.rules.run.alerts.max` system setting accordingly.\n\n**NOTE:** Changing `xpack.alerting.rules.run.alerts.max` is not possible in Serverless projects.\n",
        "severity": "medium",
        "severity_mapping": [
            {
                "field": "event.severity",
                "operator": "equals",
                "severity": "low",
                "value": "21"
            },
            {
                "field": "event.severity",
                "operator": "equals",
                "severity": "medium",
                "value": "47"
            },
            {
                "field": "event.severity",
                "operator": "equals",
                "severity": "high",
                "value": "73"
            },
            {
                "field": "event.severity",
                "operator": "equals",
                "severity": "critical",
                "value": "99"
            }
        ],
        "tags": [
            "Data Source: Elastic Defend"
        ],
        "timestamp_override": "event.ingested",
        "type": "query",
        "version": 104
    },
    "id": "9a1a2dae-0b5f-4c3d-8305-a268d404c306_104",
    "type": "security-rule"
}