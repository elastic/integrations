{
    "attributes": {
        "author": [
            "Elastic"
        ],
        "description": "Identifies an unexpected file being modified by dns.exe, the process responsible for Windows DNS Server services, which may indicate activity related to remote code execution or other forms of exploitation.",
        "from": "now-9m",
        "history_window_start": "now-7d",
        "index": [
            "winlogbeat-*",
            "logs-endpoint.events.file-*",
            "logs-windows.sysmon_operational-*",
            "endgame-*"
        ],
        "language": "kuery",
        "license": "Elastic License v2",
        "name": "Unusual File Operation by dns.exe",
        "new_terms_fields": [
            "file.path",
            "host.id"
        ],
        "query": "event.category : \"file\" and host.os.type : \"windows\" and\n  event.type : (\"creation\" or \"deletion\" or \"change\") and process.name : \"dns.exe\" and\n  not file.extension : (\"old\" or \"temp\" or \"bak\" or \"dns\" or \"arpa\" or \"log\")\n",
        "references": [
            "https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/",
            "https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server/",
            "https://www.elastic.co/security-labs/detection-rules-for-sigred-vulnerability"
        ],
        "related_integrations": [
            {
                "package": "endpoint",
                "version": "^9.0.0"
            },
            {
                "package": "windows",
                "version": "^3.0.0"
            }
        ],
        "required_fields": [
            {
                "ecs": true,
                "name": "event.category",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "event.type",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "file.extension",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "host.os.type",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "process.name",
                "type": "keyword"
            }
        ],
        "risk_score": 47,
        "rule_id": "c7ce36c0-32ff-4f9a-bfc2-dcb242bf99f9",
        "severity": "medium",
        "tags": [
            "Domain: Endpoint",
            "OS: Windows",
            "Use Case: Threat Detection",
            "Tactic: Lateral Movement",
            "Data Source: Elastic Endgame",
            "Use Case: Vulnerability",
            "Data Source: Elastic Defend",
            "Data Source: Sysmon"
        ],
        "threat": [
            {
                "framework": "MITRE ATT&CK",
                "tactic": {
                    "id": "TA0008",
                    "name": "Lateral Movement",
                    "reference": "https://attack.mitre.org/tactics/TA0008/"
                },
                "technique": [
                    {
                        "id": "T1210",
                        "name": "Exploitation of Remote Services",
                        "reference": "https://attack.mitre.org/techniques/T1210/"
                    }
                ]
            }
        ],
        "timestamp_override": "event.ingested",
        "type": "new_terms",
        "version": 215
    },
    "id": "c7ce36c0-32ff-4f9a-bfc2-dcb242bf99f9_215",
    "type": "security-rule"
}