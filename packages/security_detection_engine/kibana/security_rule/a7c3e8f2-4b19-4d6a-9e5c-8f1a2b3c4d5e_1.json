{
    "attributes": {
        "author": [
            "Elastic"
        ],
        "description": "Detects suspicious child process execution from the OpenClaw, Moltbot, or Clawdbot AI coding agents running via Node.js. These tools can execute arbitrary shell commands through skills or prompt injection attacks. Malicious skills from public registries like ClawHub have been observed executing obfuscated download-and-execute commands targeting cryptocurrency wallets and credentials. This rule identifies shells, scripting interpreters, and common LOLBins spawned by these AI agents.",
        "from": "now-9m",
        "index": [
            "logs-endpoint.events.process-*"
        ],
        "language": "eql",
        "license": "Elastic License v2",
        "name": "Execution via OpenClaw Agent",
        "note": "## Triage and analysis\n\n### Investigating Execution via OpenClaw Agent\n\nOpenClaw (formerly Clawdbot, rebranded to Moltbot) is a personal AI coding assistant that can execute shell commands \nand scripts on behalf of users. Malicious actors have weaponized the skill ecosystem (ClawHub) to distribute skills \nthat execute download-and-execute commands, targeting cryptocurrency wallets and credentials.\n\n### Possible investigation steps\n\n- Verify if OpenClaw/Moltbot is an approved application in your organization.\n- Review the child process command line for indicators of malicious activity (encoded payloads, remote downloads, credential access).\n- Check the parent Node.js process command line to identify which OpenClaw component initiated the execution.\n- Examine recently installed skills from ClawHub for malicious or obfuscated code.\n- Correlate with network events to identify data exfiltration or C2 communication.\n- Review the user's AI conversation history for prompt injection attempts.\n\n### False positive analysis\n\n- Developers legitimately using OpenClaw/Moltbot for AI-assisted coding may trigger this rule when the AI executes build scripts, curl commands, or other legitimate automation.\n- If the tool is approved, consider tuning based on specific command patterns or adding exception lists.\n\n### Response and remediation\n\n- If the child process activity appears malicious, terminate the OpenClaw gateway and investigate the skill that initiated the command.\n- Review and remove any suspicious skills from the OpenClaw configuration.\n- If credentials may have been accessed, rotate affected secrets and API keys.\n- Block known typosquat domains (moltbot.you, clawbot.ai, clawdbot.you) at the network level.\n",
        "query": "process where event.type == \"start\" and\n  process.parent.name : (\"node\", \"node.exe\") and \n  process.parent.command_line : (\"*openclaw*\", \"*moltbot*\", \"*clawdbot*\") and\n   process.name : (\"bash\", \"sh\", \"zsh\", \"bash.exe\", \"cmd.exe\", \"powershell.exe\", \"curl.exe\", \"curl\", \"base64\", \"xattr\", \"osascript\", \"python*\", \"chmod\", \"certutil.exe\", \"rundll32.exe\")\n",
        "references": [
            "https://www.malwarebytes.com/blog/threat-intel/2026/01/clawdbots-rename-to-moltbot-sparks-impersonation-campaign",
            "https://www.tomshardware.com/tech-industry/cyber-security/malicious-moltbot-skill-targets-crypto-users-on-clawhub",
            "https://blogs.cisco.com/ai/personal-ai-agents-like-openclaw-are-a-security-nightmare",
            "https://blog.virustotal.com/2026/02/from-automation-to-infection-how.html"
        ],
        "related_integrations": [
            {
                "package": "endpoint",
                "version": "^9.0.0"
            }
        ],
        "required_fields": [
            {
                "ecs": true,
                "name": "event.type",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "process.name",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "process.parent.command_line",
                "type": "wildcard"
            },
            {
                "ecs": true,
                "name": "process.parent.name",
                "type": "keyword"
            }
        ],
        "risk_score": 47,
        "rule_id": "a7c3e8f2-4b19-4d6a-9e5c-8f1a2b3c4d5e",
        "severity": "medium",
        "tags": [
            "Domain: Endpoint",
            "Domain: LLM",
            "OS: Linux",
            "OS: macOS",
            "OS: Windows",
            "Use Case: Threat Detection",
            "Tactic: Execution",
            "Tactic: Command and Control",
            "Data Source: Elastic Defend",
            "Resources: Investigation Guide"
        ],
        "threat": [
            {
                "framework": "MITRE ATT&CK",
                "tactic": {
                    "id": "TA0002",
                    "name": "Execution",
                    "reference": "https://attack.mitre.org/tactics/TA0002/"
                },
                "technique": [
                    {
                        "id": "T1059",
                        "name": "Command and Scripting Interpreter",
                        "reference": "https://attack.mitre.org/techniques/T1059/",
                        "subtechnique": [
                            {
                                "id": "T1059.007",
                                "name": "JavaScript",
                                "reference": "https://attack.mitre.org/techniques/T1059/007/"
                            }
                        ]
                    }
                ]
            },
            {
                "framework": "MITRE ATT&CK",
                "tactic": {
                    "id": "TA0011",
                    "name": "Command and Control",
                    "reference": "https://attack.mitre.org/tactics/TA0011/"
                },
                "technique": [
                    {
                        "id": "T1071",
                        "name": "Application Layer Protocol",
                        "reference": "https://attack.mitre.org/techniques/T1071/",
                        "subtechnique": [
                            {
                                "id": "T1071.001",
                                "name": "Web Protocols",
                                "reference": "https://attack.mitre.org/techniques/T1071/001/"
                            }
                        ]
                    }
                ]
            }
        ],
        "timestamp_override": "event.ingested",
        "type": "eql",
        "version": 1
    },
    "id": "a7c3e8f2-4b19-4d6a-9e5c-8f1a2b3c4d5e_1",
    "type": "security-rule"
}