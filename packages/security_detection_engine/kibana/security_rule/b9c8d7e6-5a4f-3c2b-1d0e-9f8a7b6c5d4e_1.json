{
    "attributes": {
        "author": [
            "Elastic"
        ],
        "building_block_type": "default",
        "description": "This rule detects anomalous patterns in React Server Components (RSC) Flight protocol data streams that may indicate code injection or exploitation attempts. The Flight protocol is used by React and Next.js for server-client communication, and should never contain Node.js code execution primitives like child_process, fs module calls, or eval patterns. This building block rule casts a wider net to identify suspicious payloads that warrant further investigation.",
        "from": "now-119m",
        "index": [
            "logs-network_traffic.http*"
        ],
        "interval": "60m",
        "language": "eql",
        "license": "Elastic License v2",
        "name": "Anomalous React Server Components Flight Data Patterns",
        "query": "network where http.request.method == \"POST\" and http.response.status_code != 200 and\n(\n    // Node.js child_process module\n    (\n        http.request.body.content like~ \"*require('child_process')*\" or\n        http.request.body.content like~ \"*require(\\\"child_process\\\")*\" or\n        http.request.body.content like~ \"*child_process*\" and http.request.body.content like~ \"*.exec*\"\n    ) or\n    // Node.js synchronous execution methods\n    (\n        http.request.body.content like~ \"*.execSync(*\" or\n        http.request.body.content like~ \"*.spawnSync(*\" or\n        http.request.body.content like~ \"*.execFileSync(*\"\n    ) or\n    // Node.js file system operations - suspicious in RSC context\n    (\n        http.request.body.content like~ \"*require('fs')*\" or\n        http.request.body.content like~ \"*require(\\\"fs\\\")*\" or\n        http.request.body.content like~ \"*.readFileSync(*\" or\n        http.request.body.content like~ \"*.writeFileSync(*\" or\n        http.request.body.content like~ \"*.unlinkSync(*\"\n    ) or\n    // Process and module access patterns used in exploitation\n    (\n        http.request.body.content like~ \"*process.mainModule*\" or\n        http.request.body.content like~ \"*process.binding*\" or\n        http.request.body.content like~ \"*process.dlopen*\"\n    ) or\n    // JavaScript code execution primitives\n    (\n        http.request.body.content like~ \"*eval(*\" and http.request.body.content like~ \"*require*\" or\n        http.request.body.content like~ \"*Function(*\" and http.request.body.content like~ \"*return*\"\n    ) or\n    // Generic prototype pollution indicators\n    (\n        http.request.body.content like~ \"*prototype*\" and http.request.body.content like~ \"*constructor*\"\n    )\n)\n",
        "references": [
            "https://react.dev/reference/rsc/server-components",
            "https://github.com/facebook/react/blob/main/packages/react-server/src/ReactFlightServer.js",
            "https://www.wiz.io/blog/critical-vulnerability-in-react-cve-2025-55182",
            "https://slcyber.io/research-center/high-fidelity-detection-mechanism-for-rsc-next-js-rce-cve-2025-55182-cve-2025-66478/",
            "https://nextjs.org/docs/app/building-your-application/rendering/server-components",
            "https://tonyalicea.dev/blog/understanding-react-server-components/"
        ],
        "related_integrations": [
            {
                "package": "network_traffic",
                "version": "^1.33.0"
            }
        ],
        "required_fields": [
            {
                "ecs": true,
                "name": "http.request.body.content",
                "type": "wildcard"
            },
            {
                "ecs": true,
                "name": "http.request.method",
                "type": "keyword"
            },
            {
                "ecs": true,
                "name": "http.response.status_code",
                "type": "long"
            }
        ],
        "risk_score": 21,
        "rule_id": "b9c8d7e6-5a4f-3c2b-1d0e-9f8a7b6c5d4e",
        "severity": "low",
        "tags": [
            "Domain: Network",
            "Domain: Application",
            "Domain: Web",
            "Use Case: Threat Detection",
            "Tactic: Initial Access",
            "Tactic: Execution",
            "Data Source: Network Packet Capture",
            "Rule Type: BBR"
        ],
        "threat": [
            {
                "framework": "MITRE ATT&CK",
                "tactic": {
                    "id": "TA0001",
                    "name": "Initial Access",
                    "reference": "https://attack.mitre.org/tactics/TA0001/"
                },
                "technique": [
                    {
                        "id": "T1190",
                        "name": "Exploit Public-Facing Application",
                        "reference": "https://attack.mitre.org/techniques/T1190/"
                    }
                ]
            },
            {
                "framework": "MITRE ATT&CK",
                "tactic": {
                    "id": "TA0002",
                    "name": "Execution",
                    "reference": "https://attack.mitre.org/tactics/TA0002/"
                },
                "technique": [
                    {
                        "id": "T1059",
                        "name": "Command and Scripting Interpreter",
                        "reference": "https://attack.mitre.org/techniques/T1059/",
                        "subtechnique": [
                            {
                                "id": "T1059.007",
                                "name": "JavaScript",
                                "reference": "https://attack.mitre.org/techniques/T1059/007/"
                            }
                        ]
                    }
                ]
            }
        ],
        "timestamp_override": "event.ingested",
        "type": "eql",
        "version": 1
    },
    "id": "b9c8d7e6-5a4f-3c2b-1d0e-9f8a7b6c5d4e_1",
    "type": "security-rule"
}