[//]: # (This file is generated by an automated process. Do not edit this file directly.)
# Zeek Integration for Elastic

## Overview

The Zeek integration for Elastic collects logs from Zeek, a passive, open-source network traffic analyzer. This integration ingests the various logs Zeek produces about the network traffic it analyzes, enabling comprehensive network security monitoring and threat detection within the Elastic Stack.

By leveraging this integration, security analysts and network engineers can gain deep insights into network activity, identify suspicious behavior, and respond to threats more effectively.

### Compatibility

This integration has been developed against Zeek 2.6.1 but is expected to work with other versions. Zeek requires a Unix-like platform and currently supports Linux, FreeBSD, and macOS.

For this integration to work, Zeek logs must be configured to be in JSON format.

### How it works

This integration works by collecting logs directly from files generated by Zeek. Elastic Agent monitors specified log file paths, collects the log entries as they are written, and forwards them to your Elastic deployment for parsing, indexing, and analysis.

## What data does this integration collect?

The Zeek integration collects a wide variety of log types, providing granular visibility into different network protocols and activities. The collected log types include:

* **capture_loss**: Contains data on packet loss rates.
* **connection**: Details on TCP, UDP, and ICMP connections.
* **dce_rpc**: Information on Distributed Computing Environment/RPC traffic.
* **dhcp**: DHCP lease data.
* **dnp3**: DNP3 requests and replies for industrial control systems.
* **dns**: DNS activity.
* **dpd**: Dynamic protocol detection failures.
* **files**: File analysis results.
* **ftp**: FTP activity.
* **http**: HTTP requests and replies.
* **intel**: Intelligence data matches.
* **irc**: IRC commands and responses.
* **kerberos**: Kerberos authentication data.
* **known_certs**: Information about SSL/TLS certificates seen on the network.
* **known_hosts**: Records of new hosts observed on the network.
* **known_services**: Records of new services observed on the network.
* **modbus**: Modbus commands and responses.
* **mysql**: MySQL database protocol activity.
* **notice**: Zeek notices and alerts.
* **ntlm**: NT LAN Manager (NTLM) authentication data.
* **ntp**: NTP data.
* **ocsp**: Online Certificate Status Protocol (OCSP) data.
* **pe**: Portable Executable file analysis data.
* **radius**: RADIUS authentication attempts.
* **rdp**: RDP protocol data.
* **rfb**: Remote Framebuffer (RFB) protocol data for VNC.
* **signature**: Zeek signature matches.
* **sip**: SIP protocol data.
* **smb_cmd**: SMB commands.
* **smb_files**: SMB file data.
* **smb_mapping**: SMB tree mappings.
* **smtp**: SMTP transactions.
* **snmp**: SNMP messages.
* **socks**: SOCKS proxy requests.
* **software**: Details on applications operated by hosts on the network.
* **ssh**: SSH connection data.
* **ssl**: SSL/TLS handshake information.
* **stats**: Zeek operational statistics (memory, events, packets).
* **syslog**: Syslog messages captured by Zeek.
* **traceroute**: Traceroute detections.
* **tunnel**: Tunneling protocol events.
* **weird**: Unexpected or anomalous network activity.
* **x509**: X.509 certificate information.

### Supported use cases

Integrating Zeek with Elastic provides a powerful solution for network security monitoring. Key use cases include:
* **Threat Hunting**: Search and analyze detailed connection logs, file hashes, and protocol-specific data to proactively hunt for threats.
* **Incident Response**: Accelerate incident investigation with rich, contextual network data to understand the scope and impact of a security event.
* **Security Monitoring**: Use pre-built Kibana dashboards to monitor network traffic for anomalies, policy violations, and known attack patterns.
* **Network Visibility**: Gain deep insights into all network activity, including encrypted traffic (via SSL/TLS metadata), DNS requests, and file transfers across the network.

## What do I need to use this integration?

You will need a working Zeek installation that is actively monitoring network traffic.

## How do I deploy this integration?

### Agent-based deployment

Elastic Agent must be installed on the host where your Zeek logs are generated. For more details, check the Elastic Agent [installation instructions](docs-content://reference/fleet/install-elastic-agents.md). You can install only one Elastic Agent per host.

Elastic Agent will monitor the Zeek log files, collect new log entries, and ship them to your Elastic cluster, where they will be processed by the integration's ingest pipelines.

### Onboard / configure

#### 1. Configure Zeek for JSON Output

For the integration to correctly parse the logs, Zeek must be configured to output logs in JSON format. This can be done by enabling the `json-logs` policy.

Add the following line to your `local.zeek` configuration file (typically located at `/opt/zeek/share/zeek/site/local.zeek` or a similar path):

```
@load policy/tuning/json-logs.zeek
```

After adding this line, restart Zeek for the changes to take effect.

#### 2. Add the Zeek Integration in Kibana

1.  In Kibana, navigate to **Management > Integrations**.
2.  In the search bar, type **Zeek** and select the integration.
3.  Click **Add Zeek**.
4.  Configure the integration name and optionally add a description.
5.  Under **Settings**, specify the **Base Path** to your Zeek log files. The default paths are `/var/log/bro/current`, `/opt/zeek/logs/current`, and `/usr/local/var/spool/zeek`. Add the correct path for your environment if it differs.
6.  Click **Save and continue**.

This will enroll the Elastic Agent in a policy to collect Zeek logs from the specified paths.

### Validation

To validate that the integration is working, you can check the logs in Kibana:

1.  In Kibana, navigate to the **Discover** tab.
2.  Filter the data by `data_stream.dataset : "zeek.*"`.
3.  You should see incoming log data from your Zeek instance.
4.  You can also navigate to the pre-built dashboards. In the search bar, type **Zeek** and select a dashboard to see if it is populated with data.

## Troubleshooting

For help with Elastic ingest tools, check [Common problems](https://www.elastic.co/docs/troubleshoot/ingest/fleet/common-problems).

The most common issue with this integration is Zeek not being configured to output logs in JSON format. Please ensure you have followed the configuration steps correctly.

## Scaling

For more information on architectures that can be used for scaling this integration, check the [Ingest Architectures](https://www.elastic.co/docs/manage-data/ingest/ingest-reference-architectures) documentation.

In a high-volume environment, you may need to scale your Zeek deployment into a cluster. In this scenario, logs can be aggregated on a dedicated log collector host where the Elastic Agent is installed. This centralizes log collection and reduces the load on individual Zeek workers.

## Reference

### capture_loss

The `capture_loss` data stream collects the Zeek `capture_loss.log` file, which contains packet loss rate data.

{{fields "capture_loss"}}
{{event "capture_loss"}}

### connection

The `connection` data stream collects the Zeek `conn.log` file, which contains TCP/UDP/ICMP connection data.

{{fields "connection"}}
{{event "connection"}}

### dce_rpc

The `dce_rpc` data stream collects the Zeek `dce_rpc.log` file, which contains Distributed Computing Environment/RPC data.

{{fields "dce_rpc"}}
{{event "dce_rpc"}}

### dhcp

The `dhcp` data stream collects the Zeek `dhcp.log` file, which contains DHCP lease data.

{{fields "dhcp"}}
{{event "dhcp"}}

### dnp3

The `dnp3` data stream collects the Zeek `dnp3.log` file, which contains DNP3 requests and replies.

{{fields "dnp3"}}
{{event "dnp3"}}

### dns

The `dns` data stream collects the Zeek `dns.log` file, which contains DNS activity.

{{fields "dns"}}
{{event "dns"}}

### dpd

The `dpd` data stream collects the Zeek `dpd.log`, which contains dynamic protocol detection failures.

{{fields "dpd"}}
{{event "dpd"}}

### files

The `files` data stream collects the Zeek `files.log` file, which contains file analysis results.

{{fields "files"}}
{{event "files"}}

### ftp

The `ftp` data stream collects the Zeek `ftp.log` file, which contains FTP activity.

{{fields "ftp"}}
{{event "ftp"}}

### http

The `http` data stream collects the Zeek `http.log` file, which contains HTTP requests and replies.

{{fields "http"}}
{{event "http"}}

### intel

The `intel` data stream collects the Zeek `intel.log` file, which contains intelligence data matches.

{{fields "intel"}}
{{event "intel"}}

### irc

The `irc` data stream collects the Zeek `irc.log` file, which contains IRC commands and responses.

{{fields "irc"}}
{{event "irc"}}

### kerberos

The `kerberos` data stream collects the Zeek `kerberos.log` file, which contains Kerberos data.

{{fields "kerberos"}}
{{event "kerberos"}}

### known_certs

The `known_certs` data stream captures information about SSL/TLS certificates seen on the local network.

{{fields "known_certs"}}
{{event "known_certs"}}

### known_hosts

The `known_hosts` data stream records a timestamp and an IP address when Zeek observes a new system on the local network.

{{fields "known_hosts"}}
{{event "known_hosts"}}

### known_services

The `known_services` data stream records a timestamp, IP, port number, protocol, and service when Zeek observes a system offering a new service.

{{fields "known_services"}}
{{event "known_services"}}

### modbus

The `modbus` data stream collects the Zeek `modbus.log` file, which contains Modbus commands and responses.

{{fields "modbus"}}
{{event "modbus"}}

### mysql

The `mysql` data stream collects the Zeek `mysql.log` file, which contains MySQL data.

{{fields "mysql"}}
{{event "mysql"}}

### notice

The `notice` data stream collects the Zeek `notice.log` file, which contains Zeek notices.

{{fields "notice"}}
{{event "notice"}}

### ntlm

The `ntlm` data stream collects the Zeek `ntlm.log` file, which contains NT LAN Manager (NTLM) data.

{{fields "ntlm"}}
{{event "ntlm"}}

### ntp

The `ntp` data stream collects the Zeek `ntp.log` file, which contains NTP data.

{{fields "ntp"}}
{{event "ntp"}}

### ocsp

The `ocsp` data stream collects the Zeek `ocsp.log` file, which contains Online Certificate Status Protocol (OCSP) data.

{{fields "ocsp"}}
{{event "ocsp"}}

### pe

The `pe` data stream collects the Zeek `pe.log` file, which contains portable executable data.

{{fields "pe"}}
{{event "pe"}}

### radius

The `radius` data stream collects the Zeek `radius.log` file, which contains RADIUS authentication attempts.

{{fields "radius"}}
{{event "radius"}}

### rdp

The `rdp` data stream collects the Zeek `rdp.log` file, which contains RDP data.

{{fields "rdp"}}
{{event "rdp"}}

### rfb

The `rfb` data stream collects the Zeek `rfb.log` file, which contains Remote Framebuffer (RFB) data.

{{fields "rfb"}}
{{event "rfb"}}

### signature

The `signature` data stream collects the Zeek `signature.log` file, which contains Zeek signature matches.

{{fields "signature"}}
{{event "signature"}}

### sip

The `sip` data stream collects the Zeek `sip.log` file, which contains SIP data.

{{fields "sip"}}
{{event "sip"}}

### smb_cmd

The `smb_cmd` data stream collects the Zeek `smb_cmd.log` file, which contains SMB commands.

{{fields "smb_cmd"}}
{{event "smb_cmd"}}

### smb_files

The `smb_files` data stream collects the Zeek `smb_files.log` file, which contains SMB file data.

{{fields "smb_files"}}
{{event "smb_files"}}

### smb_mapping

The `smb_mapping` data stream collects the Zeek `smb_mapping.log` file, which contains SMB trees.

{{fields "smb_mapping"}}
{{event "smb_mapping"}}

### smtp

The `smtp` data stream collects the Zeek `smtp.log` file, which contains SMTP transactions.

{{fields "smtp"}}
{{event "smtp"}}

### snmp

The `snmp` data stream collects the Zeek `snmp.log` file, which contains SNMP messages.

{{fields "snmp"}}
{{event "snmp"}}

### socks

The `socks` data stream collects the Zeek `socks.log` file, which contains SOCKS proxy requests.

{{fields "socks"}}
{{event "socks"}}

### software

The `software` data stream collects details on applications operated by the hosts Zeek sees on the local network.

{{fields "software"}}
{{event "software"}}

### ssh

The `ssh` data stream collects the Zeek `ssh.log` file, which contains SSH connection data.

{{fields "ssh"}}
{{event "ssh"}}

### ssl

The `ssl` data stream collects the Zeek `ssl.log` file, which contains SSL/TLS handshake info.

{{fields "ssl"}}
{{event "ssl"}}

### stats

The `stats` data stream collects the Zeek `stats.log` file, which contains memory, event, packet, and lag statistics.

{{fields "stats"}}
{{event "stats"}}

### syslog

The `syslog` data stream collects the Zeek `syslog.log` file, which contains syslog messages.

{{fields "syslog"}}
{{event "syslog"}}

### traceroute

The `traceroute` data stream collects the Zeek `traceroute.log` file, which contains traceroute detections.

{{fields "traceroute"}}
{{event "traceroute"}}

### tunnel

The `tunnel` data stream collects the Zeek `tunnel.log` file, which contains tunneling protocol events.

{{fields "tunnel"}}
{{event "tunnel"}}

### weird

The `weird` data stream collects the Zeek `weird.log` file, which contains unexpected network-level activity.

{{fields "weird"}}
{{event "weird"}}

### x509

The `x509` data stream collects the Zeek `x509.log` file, which contains X.509 certificate info.

{{fields "x509"}}
{{event "x509"}}

### Inputs used
{{ inputDocs }}

### API usage
This integration does not use any external APIs.
