# BBOT integration

The Bighuge BLS OSINT Tool (BBOT) integration is intended for [BBOT](https://www.blacklanternsecurity.com/bbot/) installations, an Attack Surface Management (ASM) Open Source Inteligence (OSINT) Tool.

Once the BBOT scan is complete, the integration will ingest the results into Elastic.

This integration requires the external use of BBOT. You will have to download and run the tool apart from this integration. Once your scan is complete, this integration can ingest the results into Elastic using the BBOT `json` output module or the `http` output module aka. HTTP POST/webhooks.

As of version `1.1.2` of this integration, both BBOT `1.x` and `2.x` are supported. However all examples provided by the module documentation now assume use of BBOT `2.x`.

Note that BBOT `1.x` formats are currently being supported on a best-effort basis only and support will eventually be removed.

Please upgrade to BBOT `2.x` as soon as possible to ensure continuity of features and functionality.

To support the conflicting BBOT NDJSON event formats, the following occurs during ingest of BBOT `2.x` SCAN events:
1. The `bbot.data.scan` field, if received as an object, is renamed to `bbot.data.scan_config`
2. `bbot.data.scan` is set using the ID and name of the scan to replicate the field type and content generated by BBOT `1.x`

This tool is used to enhance your external knowledge of your environment. This is done through the integration of many tools into BBOT providing a overview of your attack surface. Here is [how it works](https://www.blacklanternsecurity.com/bbot/how_it_works/).

**Important Note**

You have to provide the following parameter in your BBOT scan to get your `output.json` formatted correctly.

`-c modules.json.siem_friendly=true`

Alternatively, if you are using the HTTP output modules:

`-c modules.http.siem_friendly=true`

It's recommended to at least filter out `HTTP_RESPONSE` and `RAW_TEXT` events from reaching the SIEM, as they may contain excessive field data that could be difficult to process.

Make sure the configuration option is default, or is similar to the following:

```
omit_event_types:
- HTTP_RESPONSE
- RAW_TEXT
```

**Example BBOT Scan**

If you use the integration to collect log files from disk, you can simply use the JSON output module.

`bbot -t example.com -p subdomain-enum -c modules.json.siem_friendly=true -om json`

If you use the integration to receive events via HTTP endpoint listener, you can use the HTTP output module.

`bbot -t example.com -p subdomain-enum --config modules.http.url=http://your.elastic.agent:8080/bbot/asm_intel modules.http.username=bbot modules.http.password=P@55w0rd modules.http.siem_friendly=true -om http`

You will have to configure the path for the output file within the integration settings. 

The output modules can also be configured as part of the bbot.yml or preset files.

```
config:
  modules:
    http:
      url: 'https://your.elastic.agent:8443'
      method: POST
      username: 'bbot'
      password: 'P@55w0rd'
      siem_friendly: true
    json:
      siem_friendly: true
```

**Example BBOT Path**

`/home/<user>/.bbot/scans/*/output.json`

BBOT Scanning [Documentation](https://www.blacklanternsecurity.com/bbot/Stable/scanning/).

## Data streams

This integration collects the following logs:

- **asm_intel** Made up of the findings found in the BBOT Scans.

## Requirements

Elastic Agent must be installed. For more details, check the Elastic Agent [installation instructions](docs-content://reference/fleet/install-elastic-agents.md).

## Enable the integration in Elastic

1. In Kibana navigate to **Management** > **Integrations**.
2. In the search bar, type **BBOT**.
3. Select the **BBOT** integration and add it.
5. Add all the required configuration parameters, including the path to the `ndjson` file.
6. Save the integration.

## Logs

### ASM Findings

{{event "asm_intel"}}

{{fields "asm_intel"}}
