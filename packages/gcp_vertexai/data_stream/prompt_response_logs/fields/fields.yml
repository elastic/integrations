- name: gcp.vertexai.prompt_response_logs
  type: group
  fields:
    - name: endpoint
      type: keyword
      description: The Vertex AI API endpoint URL used for the request.
    - name: deployed_model_id
      type: keyword
      description: The ID of the deployed model that processed the request.
    - name: logging_time
      type: date
      description: Timestamp when the AI interaction was logged.
    - name: request_id
      type: keyword
      description: Unique identifier for the AI request.
    - name: request_payload
      type: text
      description: Array of request payload strings containing user prompts and inputs.
    - name: response_payload
      type: text
      description: Array of response payload strings containing AI model outputs.
    - name: model
      type: keyword
      description: Name of the AI model used.
    - name: model_version
      type: keyword
      description: Version of the AI model used.
    - name: api_method
      type: keyword
      description: The API method called (e.g., generateContent, predict).
    - name: full_request
      type: group
      description: Complete request object containing all request details in JSON format.
      fields:
        - name: contents
          type: group
          description: Array of content objects containing user prompts and inputs.
          fields:
            - name: role
              type: keyword
              description: Role of the content sender (e.g., user, model, assistant).
            - name: parts
              type: group
              description: Array of content parts.
              fields:
                - name: text
                  type: text
                  description: Text content of the prompt or message.
        - name: generation_config
          type: group
          description: Configuration settings for content generation.
          fields:
            - name: max_output_tokens
              type: long
              description: Maximum number of output tokens to generate.
            - name: temperature
              type: float
              description: Temperature setting for response randomness (0.0 to 1.0).
        - name: model
          type: keyword
          description: Full model path including project, location, and model name.
        - name: endpoint
          type: keyword
          description: The Vertex AI API endpoint URL used for the request.
        - name: safety_settings
          type: group
          description: Array of safety settings for content filtering.
          fields:
            - name: threshold
              type: keyword
              description: Safety threshold level (e.g., BLOCK_ONLY_HIGH).
            - name: category
              type: keyword
              description: Safety category (e.g., HARM_CATEGORY_DANGEROUS_CONTENT).
        - name: system_instruction
          type: group
          description: System instruction configuration.
          fields:
            - name: parts
              type: group
              description: Array of system instruction parts.
              fields:
                - name: text
                  type: text
                  description: Text content of the system instruction.
    - name: full_response
      type: group
      description: Complete response object containing all response details in JSON format.
      fields:
        - name: candidates
          type: group
          description: Array of response candidates from the AI model.
          fields:
            - name: score
              type: float
              description: Score assigned to the candidate response.
            - name: avg_logprobs
              type: float
              description: Average log probabilities for the candidate.
            - name: finish_reason
              type: keyword
              description: Reason why the generation finished (e.g., STOP).
            - name: content
              type: group
              description: Content of the candidate response.
              fields:
                - name: role
                  type: keyword
                  description: Role of the response sender (e.g., model).
                - name: parts
                  type: group
                  description: Array of response content parts.
                  fields:
                    - name: text
                      type: text
                      description: Text content of the response.
            - name: safety_ratings
              type: group
              description: Array of safety ratings for the response.
              fields:
                - name: severity
                  type: keyword
                  description: Severity level of potential harm (e.g., HARM_SEVERITY_NEGLIGIBLE).
                - name: probability_score
                  type: float
                  description: Probability score for the safety rating.
                - name: probability
                  type: keyword
                  description: Probability level (e.g., NEGLIGIBLE).
                - name: category
                  type: keyword
                  description: Safety category (e.g., HARM_CATEGORY_HATE_SPEECH).
                - name: severity_score
                  type: float
                  description: Numerical severity score.
        - name: create_time
          type: date
          description: Timestamp when the response was created.
        - name: model_version
          type: keyword
          description: Version of the model that generated the response.
        - name: response_id
          type: keyword
          description: Unique identifier for the response.
        - name: usage_metadata
          type: group
          description: Metadata about token usage in the request and response.
          fields:
            - name: billable_prompt_usage
              type: group
              description: Billable usage information for the prompt.
              fields:
                - name: text_count
                  type: long
                  description: Count of text characters in billable prompt usage.
            - name: candidates_token_count
              type: long
              description: Total number of tokens in response candidates.
            - name: candidates_tokens_details
              type: group
              description: Detailed breakdown of candidate tokens.
              fields:
                - name: modality
                  type: keyword
                  description: Type of content modality (e.g., TEXT).
                - name: token_count
                  type: long
                  description: Number of tokens for this modality.
            - name: prompt_token_count
              type: long
              description: Total number of tokens in the prompt.
            - name: prompt_tokens_details
              type: group
              description: Detailed breakdown of prompt tokens.
              fields:
                - name: modality
                  type: keyword
                  description: Type of content modality (e.g., TEXT).
                - name: token_count
                  type: long
                  description: Number of tokens for this modality.
            - name: thoughts_token_count
              type: long
              description: Number of tokens used for internal thoughts/reasoning.
            - name: total_token_count
              type: long
              description: Total number of tokens used in the entire interaction.
            - name: traffic_type
              type: keyword
              description: Type of traffic (e.g., ON_DEMAND).
    - name: metadata
      type: group
      description: Additional metadata associated with the AI interaction.
      fields:
        - name: request_latency
          type: float
          description: Request latency in milliseconds.
