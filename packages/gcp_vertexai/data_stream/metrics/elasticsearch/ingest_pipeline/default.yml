---
description: Pipeline for parsing GCP Vertex AI metrics.
processors:
  - rename:
      field: gcp.metrics.publisher.online_serving.token_count.value
      target_field: gcp.vertexai.publisher.online_serving.token_count
      ignore_missing: true
  - rename:
      field: gcp.metrics.publisher.online_serving.model_invocation_count.value
      target_field: gcp.vertexai.publisher.online_serving.model_invocation_count
      ignore_missing: true
  - rename:
      field: gcp.metrics.publisher.online_serving.character_count.value
      target_field: gcp.vertexai.publisher.online_serving.character_count
      ignore_missing: true
  - rename:
      field: gcp.metrics.publisher.online_serving.model_invocation_latencies.value.histogram
      target_field: gcp.vertexai.publisher.online_serving.model_invocation_latencies
      ignore_missing: true
  - rename:
      field: gcp.metrics.publisher.online_serving.consumed_throughput.value
      target_field: gcp.vertexai.publisher.online_serving.consumed_throughput
      ignore_missing: true  
  - rename:
      field: gcp.metrics.publisher.online_serving.first_token_latencies.value.histogram
      target_field: gcp.vertexai.publisher.online_serving.first_token_latencies
      ignore_missing: true
  - rename:
      field: gcp.metrics.prediction.online.error_count.value
      target_field: gcp.vertexai.prediction.online.error_count
      ignore_missing: true
  - rename:
      field: gcp.metrics.prediction.online.response_count.value
      target_field: gcp.vertexai.prediction.online.response_count
      ignore_missing: true
  - rename:
      field: gcp.metrics.prediction.online.prediction_count.value
      target_field: gcp.vertexai.prediction.online.prediction_count
      ignore_missing: true
  - rename:
      field: gcp.metrics.prediction.online.cpu.utilization.value
      target_field: gcp.vertexai.prediction.online.cpu.utilization
      ignore_missing: true
  - rename:
      field: gcp.metrics.prediction.online.memory.bytes_used.value
      target_field: gcp.vertexai.prediction.online.memory.bytes_used
      ignore_missing: true
  - rename:
      field: gcp.metrics.prediction.online.network.received_bytes_count.value
      target_field: gcp.vertexai.prediction.online.network.received_bytes_count
      ignore_missing: true
  - rename:
      field: gcp.metrics.prediction.online.network.sent_bytes_count.value
      target_field: gcp.vertexai.prediction.online.network.sent_bytes_count
      ignore_missing: true
  - rename:
      field: gcp.metrics.prediction.online.replicas.value
      target_field: gcp.vertexai.prediction.online.replicas
      ignore_missing: true
  - rename:
      field: gcp.metrics.prediction.online.target_replicas.value
      target_field: gcp.vertexai.prediction.online.target_replicas
      ignore_missing: true
  - rename:
      field: gcp.metrics.prediction.online.prediction_latencies.value.histogram
      target_field: gcp.vertexai.prediction.online.prediction_latencies
      ignore_missing: true
  - remove:
      field:
        - gcp.metrics
      ignore_missing: true
on_failure:
  - set:
      field: event.kind
      value: pipeline_error
  - append:
      field: error.message
      value: '{{{ _ingest.on_failure_message }}}'
