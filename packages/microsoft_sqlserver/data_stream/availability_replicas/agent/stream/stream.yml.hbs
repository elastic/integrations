metricsets: ["query"]
# Specify hosts in the below format. TODO: hosts need to be updated to support multiple entries.
hosts: 
  - sqlserver://{{username}}:{{password}}@{{hosts}}
period: {{period}}
raw_data.enabled: true
merge_results: false
driver: "mssql"
sql_queries:
  - query: "SELECT
    @@servername AS server_name,
    ag.name,
    CONVERT(NVARCHAR(36), ag.group_id) AS group_id,
    ar.replica_server_name,
    ar.availability_mode_desc,
    ar.failover_mode_desc,
    ars.role_desc,
    ars.connected_state,
    ars.connected_state_desc,
    ars.operational_state,
    ars.operational_state_desc,
    ars.synchronization_health,
    ars.synchronization_health_desc
FROM sys.dm_hadr_availability_replica_states ars
JOIN sys.availability_replicas ar ON ars.replica_id = ar.replica_id
JOIN sys.availability_groups ag ON ar.group_id = ag.group_id;"
    response_format: table
{{#if processors}}
processors:
{{processors}}
{{/if}}
tags:
{{#if preserve_sql_queries}}
- preserve_sql_queries
{{/if}}