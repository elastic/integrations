- name: mssql.availability_groups
  type: group
  fields:
    - name: metrics
      type: group
      fields:
        - name: server_name
          type: keyword
          description: Name of the SQL Server instance collecting this data.
        - name: group_id
          type: keyword
          # Reason to add as a dimension field: to support multiple availability_groups
          dimension: true
          description: Unique identifier (GUID) of the availability group.
        - name: name
          type: keyword
          description: Name of the availability group. This is a user-specified name that must be unique within the Windows Server Failover Cluster (WSFC).
        - name: resource_id
          type: keyword
          description: Resource ID for the WSFC cluster resource.
        - name: resource_group_id
          type: keyword
          description: Resource Group ID for the WSFC cluster resource group of the availability group.
        - name: failure_condition_level
          type: long
          metric_type: gauge
          description: >-
            User-defined failure condition level under which an automatic failover must be triggered. The failure-condition levels (1-5) range from the least restrictive, level 1, to the most restrictive, level 5. A given condition level encompasses all of the less restrictive levels.
        - name: health_check_timeout
          type: long
          metric_type: gauge
          unit: ms
          description: >-
            Wait time (in milliseconds) for the sp_server_diagnostics system stored procedure to return server-health information, before the server instance is assumed to be slow or not responding. The default value is 30000 milliseconds (30 seconds).
        - name: automated_backup_preference
          type: long
          metric_type: gauge
          description: >-
            Preferred location for performing backups on the availability databases in this availability group. 0: Primary, 1: Secondary only, 2: Prefer Secondary (default), 3: Any Replica.
        - name: automated_backup_preference_desc
          type: keyword
          description: >-
            Description of automated_backup_preference: PRIMARY, SECONDARY_ONLY, SECONDARY, or NONE.
        - name: version
          type: long
          metric_type: counter
          description: The version of the availability group metadata stored in the Windows Failover Cluster. This version number is incremented when new features are added.
        - name: basic_features
          type: boolean
          description: Specifies whether this is a Basic availability group.
        - name: dtc_support
          type: boolean
          description: Specifies whether DTC support is enabled for this availability group.
        - name: db_failover
          type: boolean
          description: Specifies whether the availability group supports failover for database health conditions.
        - name: is_distributed
          type: boolean
          description: Specifies whether this is a distributed availability group.
        - name: cluster_type
          type: long
          metric_type: gauge
          description: >-
            Cluster type. 0: Windows Server failover cluster, 1: None, 2: External cluster (for example, Linux Pacemaker).
        - name: cluster_type_desc
          type: keyword
          description: Text description of cluster type.
        - name: required_synchronized_secondaries_to_commit
          type: long
          metric_type: gauge
          description: The number of secondary replicas that must be in a synchronized state for a commit to complete.
        - name: sequence_number
          type: long
          metric_type: counter
          description: Identifies the availability group configuration sequence. Incrementally increases every time the availability group primary replica updates the configuration of the group.
        - name: is_contained
          type: boolean
          description: >-
            Indicates if this is a big data cluster master instance configured for high-availability (1) or not (0).
    - name: query
      type: keyword
      description: The SQL queries executed.