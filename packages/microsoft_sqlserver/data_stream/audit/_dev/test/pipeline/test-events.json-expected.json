{
    "expected": [
        {
            "@timestamp": "2021-10-23T23:01:20.405Z",
            "agent": {
                "ephemeral_id": "64d8db00-4d07-452f-a9af-cd828d6b9d33",
                "hostname": "WinDev2108Eval",
                "id": "b53be7b1-9e86-49b0-ad0b-1464bceabc65",
                "name": "WinDev2108Eval",
                "type": "filebeat",
                "version": "7.15.1"
            },
            "data_stream": {
                "dataset": "microsoft_sqlserver.audit",
                "namespace": "default",
                "type": "logs"
            },
            "ecs": {
                "version": "8.6.0"
            },
            "elastic_agent": {
                "id": "b53be7b1-9e86-49b0-ad0b-1464bceabc65",
                "snapshot": false,
                "version": "7.15.1"
            },
            "event": {
                "action": "select",
                "agent_id_status": "verified",
                "category": [
                    "database"
                ],
                "code": "33205",
                "created": "2021-10-21T11:01:45.955Z",
                "dataset": "microsoft_sqlserver.audit",
                "duration": 0,
                "ingested": "2021-10-21T11:01:47Z",
                "kind": "event",
                "outcome": "success",
                "provider": "MSSQLSERVER$AUDIT",
                "type": [
                    "access"
                ]
            },
            "host": {
                "architecture": "x86_64",
                "hostname": "WinDev2108Eval",
                "id": "abe598f7-ff01-46dc-999b-d1751abbe398",
                "ip": [
                    "fe80::d567:3328:3f4c:113b",
                    "10.0.2.15",
                    "fe80::74fb:1698:31ac:f597",
                    "192.168.56.103"
                ],
                "mac": [
                    "08-00-27-DE-7B-66",
                    "08-00-27-6A-C1-FB"
                ],
                "name": "WinDev2108Eval",
                "os": {
                    "build": "19043.1288",
                    "family": "windows",
                    "kernel": "10.0.19041.1288 (WinBuild.160101.0800)",
                    "name": "Windows 10 Enterprise Evaluation",
                    "platform": "windows",
                    "type": "windows",
                    "version": "10.0"
                }
            },
            "log": {
                "level": "information"
            },
            "process": {
                "pid": 648,
                "thread": {
                    "id": 364
                }
            },
            "sqlserver": {
                "audit": {
                    "action_id": "SELECT",
                    "affected_rows": 0,
                    "application_name": "Microsoft SQL Server Management Studio - Query",
                    "audit_schema_version": "1",
                    "class_type": "TABLE",
                    "client_ip": "local machine",
                    "connection_id": "FBB762BA-B0C5-4D09-9349-4A408C909199",
                    "database_name": "TestDB",
                    "database_principal_id": "1",
                    "database_principal_name": "dbo",
                    "host_name": "WINDEV2108EVAL",
                    "is_column_permission": true,
                    "object_id": "885578193",
                    "object_name": "personal",
                    "permission_bitmask": "00000000000000000000000000000001",
                    "response_rows": 0,
                    "schema_name": "dbo",
                    "sequence_group_id": "8F6581B6-23C3-4800-AD85-A4780B5332BB",
                    "sequence_number": 1,
                    "server_instance_name": "WINDEV2108EVAL",
                    "server_principal_id": "259",
                    "session_id": "55",
                    "session_server_principal_name": "WINDEV2108EVAL\\User",
                    "statement": "SELECT * FROM dbo.personal",
                    "succeeded": true,
                    "target_database_principal_id": "0",
                    "target_server_principal_id": "0",
                    "transaction_id": "39562",
                    "user_defined_event_id": "0"
                }
            },
            "user": {
                "domain": "WINDEV2108EVAL",
                "id": "010500000000000515000000b7baa3e36a4480a90b1df1eae9030000",
                "name": "User"
            },
            "winlog": {
                "activity_id": "{3d5039f7-c692-0000-653a-503d92c6d701}",
                "api": "wineventlog",
                "channel": "Security",
                "computer_name": "WinDev2108Eval",
                "event_id": "33205",
                "keywords": [
                    "Audit Success",
                    "Classic"
                ],
                "provider_name": "MSSQLSERVER$AUDIT",
                "record_id": "17607",
                "user": {
                    "domain": "NT SERVICE",
                    "identifier": "S-1-5-80-3880718306-3832830129-1677859214-2598158968-1052248003",
                    "name": "MSSQLSERVER",
                    "type": "Well Known Group"
                }
            }
        },
        {
            "@timestamp": "2021-10-28T08:44:33.974Z",
            "agent": {
                "ephemeral_id": "0fa6e59e-1439-4bd3-910c-82b99d3f17cc",
                "hostname": "WinDev2108Eval",
                "id": "8b2d19ad-2ecf-40d9-ad3b-746991df9989",
                "name": "WinDev2108Eval",
                "type": "filebeat",
                "version": "7.15.1"
            },
            "data_stream": {
                "dataset": "microsoft_sqlserver.audit",
                "namespace": "default",
                "type": "logs"
            },
            "ecs": {
                "version": "8.6.0"
            },
            "elastic_agent": {
                "id": "8b2d19ad-2ecf-40d9-ad3b-746991df9989",
                "snapshot": false,
                "version": "7.15.1"
            },
            "event": {
                "action": "insert",
                "agent_id_status": "verified",
                "category": [
                    "database"
                ],
                "code": "33205",
                "created": "2021-10-28T08:44:35.844Z",
                "dataset": "microsoft_sqlserver.audit",
                "duration": 0,
                "ingested": "2021-10-28T08:44:36Z",
                "kind": "event",
                "original": "Audit event: audit_schema_version:1\nevent_time:2021-10-28 08:44:33.9741294\nsequence_number:1\naction_id:IN  \nsucceeded:true\nis_column_permission:false\nsession_id:52\nserver_principal_id:259\ndatabase_principal_id:1\ntarget_server_principal_id:0\ntarget_database_principal_id:0\nobject_id:581577110\nuser_defined_event_id:0\ntransaction_id:693425\nclass_type:U \nduration_milliseconds:0\nresponse_rows:0\naffected_rows:0\nclient_ip:local machine\npermission_bitmask:00000000000000000000000000000008\nsequence_group_id:D883B193-67E7-4A29-8E00-AD24C7FF3ABC\nsession_server_principal_name:WINDEV2108EVAL\\User\nserver_principal_name:WINDEV2108EVAL\\User\nserver_principal_sid:010500000000000515000000b7baa3e36a4480a90b1df1eae9030000\ndatabase_principal_name:dbo\ntarget_server_principal_name:\ntarget_server_principal_sid:\ntarget_database_principal_name:\nserver_instance_name:WINDEV2108EVAL\ndatabase_name:Auditable\nschema_name:dbo\nobject_name:Persons\nstatement:INSERT INTO dbo.Persons (PersonID, LastName, FirstName, Address, City)\nVALUES (102, 'G', 'Sai', 'Australia', 'Melbourne')\nadditional_information:\nuser_defined_information:\napplication_name:Microsoft SQL Server Management Studio - Query\nconnection_id:D3194377-1174-4BA9-BAFC-CDD5EC69C962\ndata_sensitivity_information:\nhost_name:WINDEV2108EVAL\n.",
                "outcome": "success",
                "provider": "MSSQLSERVER$AUDIT",
                "type": [
                    "info"
                ]
            },
            "host": {
                "architecture": "x86_64",
                "hostname": "WinDev2108Eval",
                "id": "abe598f7-ff01-46dc-999b-d1751abbe398",
                "ip": [
                    "fe80::d567:3328:3f4c:113b",
                    "10.0.2.15",
                    "fe80::74fb:1698:31ac:f597",
                    "192.168.56.103"
                ],
                "mac": [
                    "08-00-27-DE-7B-66",
                    "08-00-27-6A-C1-FB"
                ],
                "name": "WinDev2108Eval",
                "os": {
                    "build": "19043.1288",
                    "family": "windows",
                    "kernel": "10.0.19041.1288 (WinBuild.160101.0800)",
                    "name": "Windows 10 Enterprise Evaluation",
                    "platform": "windows",
                    "type": "windows",
                    "version": "10.0"
                }
            },
            "log": {
                "level": "information"
            },
            "process": {
                "pid": 648,
                "thread": {
                    "id": 2744
                }
            },
            "sqlserver": {
                "audit": {
                    "action_id": "INSERT",
                    "affected_rows": 0,
                    "application_name": "Microsoft SQL Server Management Studio - Query",
                    "audit_schema_version": "1",
                    "class_type": "TABLE",
                    "client_ip": "local machine",
                    "connection_id": "D3194377-1174-4BA9-BAFC-CDD5EC69C962",
                    "database_name": "Auditable",
                    "database_principal_id": "1",
                    "database_principal_name": "dbo",
                    "host_name": "WINDEV2108EVAL",
                    "is_column_permission": false,
                    "object_id": "581577110",
                    "object_name": "Persons",
                    "permission_bitmask": "00000000000000000000000000000008",
                    "response_rows": 0,
                    "schema_name": "dbo",
                    "sequence_group_id": "D883B193-67E7-4A29-8E00-AD24C7FF3ABC",
                    "sequence_number": 1,
                    "server_instance_name": "WINDEV2108EVAL",
                    "server_principal_id": "259",
                    "session_id": "52",
                    "session_server_principal_name": "WINDEV2108EVAL\\User",
                    "statement": "INSERT INTO dbo.Persons (PersonID, LastName, FirstName, Address, City)\nVALUES (102, 'G', 'Sai', 'Australia', 'Melbourne')",
                    "succeeded": true,
                    "target_database_principal_id": "0",
                    "target_server_principal_id": "0",
                    "transaction_id": "693425",
                    "user_defined_event_id": "0"
                }
            },
            "user": {
                "domain": "WINDEV2108EVAL",
                "id": "010500000000000515000000b7baa3e36a4480a90b1df1eae9030000",
                "name": "User"
            },
            "winlog": {
                "activity_id": "{855644c9-ca0a-0001-4945-56850acad701}",
                "api": "wineventlog",
                "channel": "Security",
                "computer_name": "WinDev2108Eval",
                "event_id": "33205",
                "keywords": [
                    "Audit Success",
                    "Classic"
                ],
                "provider_name": "MSSQLSERVER$AUDIT",
                "record_id": "26134",
                "user": {
                    "domain": "NT SERVICE",
                    "identifier": "S-1-5-80-3880718306-3832830129-1677859214-2598158968-1052248003",
                    "name": "MSSQLSERVER",
                    "type": "Well Known Group"
                }
            }
        },
        {
            "@timestamp": "2021-10-29T02:09:40.498Z",
            "agent": {
                "ephemeral_id": "968f4b33-dfd4-455e-af64-ef3d7c3e7daf",
                "hostname": "WinDev2108Eval",
                "id": "df0dd5ff-cce7-4861-b49f-fd70f0b207b6",
                "name": "WinDev2108Eval",
                "type": "filebeat",
                "version": "7.15.1"
            },
            "data_stream": {
                "dataset": "microsoft_sqlserver.audit",
                "namespace": "default",
                "type": "logs"
            },
            "ecs": {
                "version": "8.6.0"
            },
            "elastic_agent": {
                "id": "df0dd5ff-cce7-4861-b49f-fd70f0b207b6",
                "snapshot": false,
                "version": "7.15.1"
            },
            "event": {
                "action": "login-succeeded",
                "agent_id_status": "verified",
                "category": [
                    "database",
                    "session"
                ],
                "code": "33205",
                "created": "2021-10-29T02:09:41.540Z",
                "dataset": "microsoft_sqlserver.audit",
                "duration": 0,
                "ingested": "2021-10-29T02:09:42Z",
                "kind": "event",
                "outcome": "success",
                "provider": "MSSQLSERVER$AUDIT",
                "type": [
                    "info",
                    "start"
                ]
            },
            "host": {
                "architecture": "x86_64",
                "hostname": "WinDev2108Eval",
                "id": "abe598f7-ff01-46dc-999b-d1751abbe398",
                "ip": [
                    "fe80::d567:3328:3f4c:113b",
                    "10.0.2.15",
                    "fe80::74fb:1698:31ac:f597",
                    "192.168.56.103"
                ],
                "mac": [
                    "08-00-27-DE-7B-66",
                    "08-00-27-6A-C1-FB"
                ],
                "name": "WinDev2108Eval",
                "os": {
                    "build": "19043.1288",
                    "family": "windows",
                    "kernel": "10.0.19041.1288 (WinBuild.160101.0800)",
                    "name": "Windows 10 Enterprise Evaluation",
                    "platform": "windows",
                    "type": "windows",
                    "version": "10.0"
                }
            },
            "log": {
                "level": "information"
            },
            "process": {
                "pid": 656,
                "thread": {
                    "id": 1688
                }
            },
            "sqlserver": {
                "audit": {
                    "action_id": "LOGIN SUCCEEDED",
                    "affected_rows": 0,
                    "application_name": "SQLServerCEIP",
                    "audit_schema_version": "1",
                    "class_type": "LOGIN",
                    "client_ip": "local machine",
                    "connection_id": "FADD287E-2D7D-4D1C-9C51-6A9AA7AF461E",
                    "database_principal_id": "0",
                    "host_name": "WINDEV2108EVAL",
                    "is_column_permission": false,
                    "object_id": "0",
                    "permission_bitmask": "00000000000000000000000000000000",
                    "response_rows": 0,
                    "sequence_group_id": "DBDB0CF9-276D-4291-9A39-6FDA3895176C",
                    "sequence_number": 1,
                    "server_instance_name": "WINDEV2108EVAL",
                    "server_principal_id": "265",
                    "session_id": "64",
                    "session_server_principal_name": "NT Service\\SQLTELEMETRY",
                    "statement": "-- network protocol: LPC\nset quoted_identifier on\nset arithabort off\nset numeric_roundabort off\nset ansi_warnings on\nset ansi_padding on\nset ansi_nulls on\nset concat_null_yields_null on\nset cursor_close_on_commit off\nset implicit_transactions off\nset language us_english\nset dateformat mdy\nset datefirst 7\nset transaction isolation level read committed\n",
                    "succeeded": true,
                    "target_database_principal_id": "0",
                    "target_server_principal_id": "0",
                    "transaction_id": "0",
                    "user_defined_event_id": "0"
                }
            },
            "user": {
                "domain": "NT SERVICE",
                "id": "010600000000000550000000447a1a9ee0235381234a54aa9bd0549c4fcc0642",
                "name": "SQLTELEMETRY"
            },
            "winlog": {
                "activity_id": "{3622691f-ccfb-0000-9469-2236fbccd701}",
                "api": "wineventlog",
                "channel": "Security",
                "computer_name": "WinDev2108Eval",
                "event_id": "33205",
                "keywords": [
                    "Audit Success",
                    "Classic"
                ],
                "provider_name": "MSSQLSERVER$AUDIT",
                "record_id": "27810",
                "user": {
                    "domain": "NT SERVICE",
                    "identifier": "S-1-5-80-3880718306-3832830129-1677859214-2598158968-1052248003",
                    "name": "MSSQLSERVER",
                    "type": "Well Known Group"
                }
            }
        },
        {
            "@timestamp": "2021-10-29T04:54:20.589Z",
            "agent": {
                "ephemeral_id": "968f4b33-dfd4-455e-af64-ef3d7c3e7daf",
                "hostname": "WinDev2108Eval",
                "id": "df0dd5ff-cce7-4861-b49f-fd70f0b207b6",
                "name": "WinDev2108Eval",
                "type": "filebeat",
                "version": "7.15.1"
            },
            "data_stream": {
                "dataset": "microsoft_sqlserver.audit",
                "namespace": "default",
                "type": "logs"
            },
            "ecs": {
                "version": "8.6.0"
            },
            "elastic_agent": {
                "id": "df0dd5ff-cce7-4861-b49f-fd70f0b207b6",
                "snapshot": false,
                "version": "7.15.1"
            },
            "event": {
                "action": "login-failed",
                "agent_id_status": "verified",
                "category": [
                    "database",
                    "authentication"
                ],
                "code": "33205",
                "created": "2021-10-29T04:54:22.763Z",
                "dataset": "microsoft_sqlserver.audit",
                "duration": 0,
                "ingested": "2021-10-29T04:54:24Z",
                "kind": "event",
                "outcome": "failure",
                "provider": "MSSQLSERVER$AUDIT",
                "type": [
                    "error"
                ]
            },
            "host": {
                "architecture": "x86_64",
                "hostname": "WinDev2108Eval",
                "id": "abe598f7-ff01-46dc-999b-d1751abbe398",
                "ip": [
                    "fe80::d567:3328:3f4c:113b",
                    "10.0.2.15",
                    "fe80::74fb:1698:31ac:f597",
                    "192.168.56.103"
                ],
                "mac": [
                    "08-00-27-DE-7B-66",
                    "08-00-27-6A-C1-FB"
                ],
                "name": "WinDev2108Eval",
                "os": {
                    "build": "19043.1288",
                    "family": "windows",
                    "kernel": "10.0.19041.1288 (WinBuild.160101.0800)",
                    "name": "Windows 10 Enterprise Evaluation",
                    "platform": "windows",
                    "type": "windows",
                    "version": "10.0"
                }
            },
            "log": {
                "level": "information"
            },
            "process": {
                "pid": 656,
                "thread": {
                    "id": 708
                }
            },
            "sqlserver": {
                "audit": {
                    "action_id": "LOGIN FAILED",
                    "affected_rows": 0,
                    "application_name": "SQLCMD",
                    "audit_schema_version": "1",
                    "class_type": "LOGIN",
                    "client_ip": "local machine",
                    "connection_id": "5BB7AFC4-A4B5-46CF-B961-55426EAE3968",
                    "database_principal_id": "0",
                    "host_name": "WINDEV2108EVAL",
                    "is_column_permission": false,
                    "object_id": "0",
                    "permission_bitmask": "00000000000000000000000000000000",
                    "response_rows": 0,
                    "sequence_group_id": "04B96B8E-5013-4F30-9C51-CEEDC009CBAA",
                    "sequence_number": 1,
                    "server_instance_name": "WINDEV2108EVAL",
                    "server_principal_id": "0",
                    "session_id": "0",
                    "statement": "Login failed for user 'User'. Reason: Could not find a login matching the name provided. [CLIENT: \u003clocal machine\u003e]",
                    "succeeded": false,
                    "target_database_principal_id": "0",
                    "target_server_principal_id": "0",
                    "transaction_id": "0",
                    "user_defined_event_id": "0"
                }
            },
            "user": {
                "name": "User"
            },
            "winlog": {
                "activity_id": "{3622691f-ccfb-0000-9469-2236fbccd701}",
                "api": "wineventlog",
                "channel": "Security",
                "computer_name": "WinDev2108Eval",
                "event_id": "33205",
                "keywords": [
                    "Audit Failure",
                    "Classic"
                ],
                "provider_name": "MSSQLSERVER$AUDIT",
                "record_id": "28002",
                "user": {
                    "domain": "NT SERVICE",
                    "identifier": "S-1-5-80-3880718306-3832830129-1677859214-2598158968-1052248003",
                    "name": "MSSQLSERVER",
                    "type": "Well Known Group"
                }
            }
        }
    ]
}