{
    "attributes": {
        "controlGroupInput": {
            "chainingSystem": "HIERARCHICAL",
            "controlStyle": "oneLine",
            "ignoreParentSettingsJSON": "{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}",
            "panelsJSON": "{\"5779a7c6-acf5-4f7d-ac4c-caae9517d95e\":{\"type\":\"optionsListControl\",\"order\":0,\"grow\":true,\"width\":\"medium\",\"explicitInput\":{\"id\":\"5779a7c6-acf5-4f7d-ac4c-caae9517d95e\",\"fieldName\":\"event.provider\",\"title\":\"Service Source\",\"enhancements\":{}}},\"ec5d23b5-535c-483a-88ad-279762f3d5ca\":{\"type\":\"optionsListControl\",\"order\":1,\"grow\":true,\"width\":\"medium\",\"explicitInput\":{\"id\":\"ec5d23b5-535c-483a-88ad-279762f3d5ca\",\"fieldName\":\"m365_defender.alert.detection_source\",\"title\":\"Detection Source\",\"enhancements\":{},\"selectedOptions\":[]}},\"cef3df17-225a-4373-a231-caa594cd1bf4\":{\"type\":\"optionsListControl\",\"order\":2,\"grow\":true,\"width\":\"medium\",\"explicitInput\":{\"id\":\"cef3df17-225a-4373-a231-caa594cd1bf4\",\"fieldName\":\"m365_defender.alert.evidence.roles\",\"title\":\"Evidence Role\",\"enhancements\":{},\"selectedOptions\":[]}},\"23cace2f-34ed-4efa-bed4-ccdc7318dfb8\":{\"type\":\"rangeSliderControl\",\"order\":3,\"grow\":true,\"width\":\"medium\",\"explicitInput\":{\"id\":\"23cace2f-34ed-4efa-bed4-ccdc7318dfb8\",\"fieldName\":\"event.severity\",\"title\":\"event.severity\",\"enhancements\":{}}}}"
        },
        "description": "Overview of Microsoft 365 Defender Alerts",
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": {
                "filter": [],
                "query": {
                    "language": "kuery",
                    "query": ""
                }
            }
        },
        "optionsJSON": {
            "hidePanelTitles": false,
            "syncColors": false,
            "syncCursor": true,
            "syncTooltips": false,
            "useMargins": true
        },
        "panelsJSON": [
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": false,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "id": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "### Navigation\n\n#### M365 Defender\n\n#### EventHub Datastream  \n[Alert Events](#/dashboard/m365_defender-2690a440-7235-11ed-8657-c59f6ece834c)  \n[Device](#/dashboard/m365_defender-c0b796d0-720a-11ed-8657-c59f6ece834c)  \n[App \u0026 Identity](#/dashboard/m365_defender-d587df00-745f-11ed-8657-c59f6ece834c)  \n[Email](#/dashboard/m365_defender-3caf3c00-7456-11ed-8657-c59f6ece834c)  \n\n#### Graph API Datastream\n[Incident](#/dashboard/m365_defender-ac54d310-44ab-11ed-8375-0168a9970c06)  \n**[Alert](#/dashboard/m365_defender-d80d7840-4366-11ed-b1f2-e917f608bd03)**  \n\n#### Description\n\nThis dashboard showcases various alert metrics, including counts for new, in-progress, resolved, assigned, and unassigned alerts. It categorizes alerts by severity, category, determination, and service source. The display features top 10 email sender IPs with suspicious or malicious verdicts, leading detection sources, a timeline of alerts, a table highlighting top MITRE techniques, the top 10 compromised user accounts, the most attacked devices, and concludes with essential details of the alerts.\n\n",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 129,
                    "i": "5852497b-14e8-4c1e-a9ab-fc387a3ae672",
                    "w": 8,
                    "x": 0,
                    "y": 0
                },
                "panelIndex": "5852497b-14e8-4c1e-a9ab-fc387a3ae672",
                "title": "Table of Contents",
                "type": "visualization",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-6ddc53cd-2bbd-4616-837b-3fbe0712ca7e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "9f120d0d-531c-42be-b1ed-5dc4683d5b15",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "6ddc53cd-2bbd-4616-837b-3fbe0712ca7e": {
                                            "columnOrder": [
                                                "330da6b3-a0e3-41b9-8103-69b3381f1788",
                                                "6400adfe-4702-4f13-923f-f94d87aa0ced"
                                            ],
                                            "columns": {
                                                "330da6b3-a0e3-41b9-8103-69b3381f1788": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Filters",
                                                    "operationType": "filters",
                                                    "params": {
                                                        "filters": [
                                                            {
                                                                "input": {
                                                                    "language": "kuery",
                                                                    "query": ""
                                                                },
                                                                "label": "Total Alerts"
                                                            },
                                                            {
                                                                "input": {
                                                                    "language": "kuery",
                                                                    "query": "source.user.name : *"
                                                                },
                                                                "label": "Assigned Alerts"
                                                            },
                                                            {
                                                                "input": {
                                                                    "language": "kuery",
                                                                    "query": "not (source.user.name : *)"
                                                                },
                                                                "label": "Unassigned Alerts"
                                                            },
                                                            {
                                                                "input": {
                                                                    "language": "kuery",
                                                                    "query": "m365_defender.alert.status : \"new\" "
                                                                },
                                                                "label": "New Alerts"
                                                            },
                                                            {
                                                                "input": {
                                                                    "language": "kuery",
                                                                    "query": "m365_defender.alert.status : \"inProgress\" "
                                                                },
                                                                "label": "In Progress Alerts"
                                                            },
                                                            {
                                                                "input": {
                                                                    "language": "kuery",
                                                                    "query": "m365_defender.alert.status : \"resolved\" "
                                                                },
                                                                "label": "Resolved Alerts"
                                                            }
                                                        ]
                                                    },
                                                    "scale": "ordinal"
                                                },
                                                "6400adfe-4702-4f13-923f-f94d87aa0ced": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "9f120d0d-531c-42be-b1ed-5dc4683d5b15",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "breakdownByAccessor": "330da6b3-a0e3-41b9-8103-69b3381f1788",
                                "color": "#6092C0",
                                "layerId": "6ddc53cd-2bbd-4616-837b-3fbe0712ca7e",
                                "layerType": "data",
                                "metricAccessor": "6400adfe-4702-4f13-923f-f94d87aa0ced"
                            }
                        },
                        "title": "Alert Counts [Logs Microsoft 365 Defender] (converted)",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 8,
                    "i": "8ed4553a-d396-4ad7-b247-10e005d65086",
                    "w": 40,
                    "x": 8,
                    "y": 0
                },
                "panelIndex": "8ed4553a-d396-4ad7-b247-10e005d65086",
                "title": "Alert Counts [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-874da7c4-ebe5-4c5c-a302-094d287b81bb",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "a155689d-f319-4f42-831d-2097922e6b7c",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "874da7c4-ebe5-4c5c-a302-094d287b81bb": {
                                            "columnOrder": [
                                                "91075489-5815-4881-af42-d6e31205b1c5",
                                                "2d7b439a-58f9-400c-b89a-c5ef01f6d82b"
                                            ],
                                            "columns": {
                                                "2d7b439a-58f9-400c-b89a-c5ef01f6d82b": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "91075489-5815-4881-af42-d6e31205b1c5": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": true,
                                                    "label": "Severity",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "2d7b439a-58f9-400c-b89a-c5ef01f6d82b",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "event.severity"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "a155689d-f319-4f42-831d-2097922e6b7c",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "layerId": "874da7c4-ebe5-4c5c-a302-094d287b81bb",
                                        "layerType": "data",
                                        "legendDisplay": "show",
                                        "legendSize": "auto",
                                        "metrics": [
                                            "2d7b439a-58f9-400c-b89a-c5ef01f6d82b"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "91075489-5815-4881-af42-d6e31205b1c5"
                                        ],
                                        "truncateLegend": false
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 23,
                    "i": "00c0b388-64b8-49c8-9ccb-de8e58030b4d",
                    "w": 13,
                    "x": 8,
                    "y": 8
                },
                "panelIndex": "00c0b388-64b8-49c8-9ccb-de8e58030b4d",
                "title": "Alerts by Severity [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-2fa8c035-1708-4d32-88fc-b59af7751db4",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "db899305-b961-454c-8390-5d1d2395a3e2",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "2fa8c035-1708-4d32-88fc-b59af7751db4": {
                                            "columnOrder": [
                                                "ccf17a24-dc07-4800-983f-8c507665a6a0",
                                                "87199ce0-75a4-414f-860f-7c25177fb5b3"
                                            ],
                                            "columns": {
                                                "87199ce0-75a4-414f-860f-7c25177fb5b3": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "ccf17a24-dc07-4800-983f-8c507665a6a0": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Attack Kill-Chain Category",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "87199ce0-75a4-414f-860f-7c25177fb5b3",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "threat.tactic.name"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "db899305-b961-454c-8390-5d1d2395a3e2",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "accessors": [
                                            "87199ce0-75a4-414f-860f-7c25177fb5b3"
                                        ],
                                        "layerId": "2fa8c035-1708-4d32-88fc-b59af7751db4",
                                        "layerType": "data",
                                        "position": "top",
                                        "seriesType": "bar_stacked",
                                        "showGridlines": false,
                                        "xAccessor": "ccf17a24-dc07-4800-983f-8c507665a6a0"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "legendSize": "auto",
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "title": "Empty XY chart",
                                "valueLabels": "hide",
                                "yLeftExtent": {
                                    "mode": "full"
                                },
                                "yRightExtent": {
                                    "mode": "full"
                                }
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 23,
                    "i": "8e4019a0-6594-4eaf-9358-c343b72aba84",
                    "w": 13,
                    "x": 21,
                    "y": 8
                },
                "panelIndex": "8e4019a0-6594-4eaf-9358-c343b72aba84",
                "title": "Alerts by Category [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-45d80486-c9c8-4d28-bbcd-5d29072c9cb9",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "d3ac725d-8f46-4c0d-a938-280f91905f74",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "45d80486-c9c8-4d28-bbcd-5d29072c9cb9": {
                                            "columnOrder": [
                                                "fe4ba4cc-3a4f-4dbf-b79d-a3b6550f08b6",
                                                "4315d7e5-cdd4-48a1-b1b6-cfb3cfe25389"
                                            ],
                                            "columns": {
                                                "4315d7e5-cdd4-48a1-b1b6-cfb3cfe25389": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "fe4ba4cc-3a4f-4dbf-b79d-a3b6550f08b6": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Determination",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "4315d7e5-cdd4-48a1-b1b6-cfb3cfe25389",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "m365_defender.alert.determination"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "d3ac725d-8f46-4c0d-a938-280f91905f74",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "None",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "4315d7e5-cdd4-48a1-b1b6-cfb3cfe25389"
                                        ],
                                        "layerId": "45d80486-c9c8-4d28-bbcd-5d29072c9cb9",
                                        "layerType": "data",
                                        "seriesType": "bar_stacked",
                                        "xAccessor": "fe4ba4cc-3a4f-4dbf-b79d-a3b6550f08b6"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "legendSize": "auto",
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide",
                                "yLeftExtent": {
                                    "mode": "full"
                                },
                                "yRightExtent": {
                                    "mode": "full"
                                }
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 23,
                    "i": "1f836fdc-61f4-4cf4-a392-50276a2b77f1",
                    "w": 14,
                    "x": 34,
                    "y": 8
                },
                "panelIndex": "1f836fdc-61f4-4cf4-a392-50276a2b77f1",
                "title": "Alerts by Determination [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-bdba4af5-1396-46ec-ad04-59157e7697f9",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "f7a464e2-0eb1-4f4a-9d10-a16d8f69348c",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "bdba4af5-1396-46ec-ad04-59157e7697f9": {
                                            "columnOrder": [
                                                "a643f53b-fe39-4a6d-8916-e6eee4a3d30b",
                                                "cd1300db-e9d8-41c8-9407-0159ec6e9410"
                                            ],
                                            "columns": {
                                                "a643f53b-fe39-4a6d-8916-e6eee4a3d30b": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Service Source",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "cd1300db-e9d8-41c8-9407-0159ec6e9410",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "event.provider"
                                                },
                                                "cd1300db-e9d8-41c8-9407-0159ec6e9410": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "f7a464e2-0eb1-4f4a-9d10-a16d8f69348c",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "accessors": [
                                            "cd1300db-e9d8-41c8-9407-0159ec6e9410"
                                        ],
                                        "layerId": "bdba4af5-1396-46ec-ad04-59157e7697f9",
                                        "layerType": "data",
                                        "position": "top",
                                        "seriesType": "bar_stacked",
                                        "showGridlines": false,
                                        "xAccessor": "a643f53b-fe39-4a6d-8916-e6eee4a3d30b"
                                    }
                                ],
                                "legend": {
                                    "isVisible": false,
                                    "legendSize": "auto",
                                    "position": "right",
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "bar_stacked",
                                "title": "Empty XY chart",
                                "valueLabels": "hide",
                                "yLeftExtent": {
                                    "mode": "full"
                                },
                                "yRightExtent": {
                                    "mode": "full"
                                }
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 21,
                    "i": "b5b7f2a4-1d6e-4812-8724-5a771014c3ae",
                    "w": 13,
                    "x": 8,
                    "y": 31
                },
                "panelIndex": "b5b7f2a4-1d6e-4812-8724-5a771014c3ae",
                "title": "Alerts by Service Source [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-a0e68595-3ccc-4ff9-90fb-8087bc439020",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "39ecb368-ff15-47cd-a634-68075279a23e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "72677633-892f-44ca-afb3-567a4350bc30",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "a0e68595-3ccc-4ff9-90fb-8087bc439020": {
                                            "columnOrder": [
                                                "d8c5d781-6442-4a9f-b91b-8b7b29d8e73a",
                                                "2c72b146-36c7-4143-baba-517b19d159bc"
                                            ],
                                            "columns": {
                                                "2c72b146-36c7-4143-baba-517b19d159bc": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "d8c5d781-6442-4a9f-b91b-8b7b29d8e73a": {
                                                    "customLabel": true,
                                                    "dataType": "ip",
                                                    "isBucketed": true,
                                                    "label": "Email Sender IP",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "2c72b146-36c7-4143-baba-517b19d159bc",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "m365_defender.alert.evidence.sender_ip"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "39ecb368-ff15-47cd-a634-68075279a23e",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "m365_defender.alert.evidence.verdict",
                                                    "index": "logs-*",
                                                    "key": "m365_defender.alert.evidence.verdict",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "malicious"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "m365_defender.alert.evidence.verdict": "malicious"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "m365_defender.alert.evidence.verdict",
                                                    "index": "logs-*",
                                                    "key": "m365_defender.alert.evidence.verdict",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "suspicious"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "m365_defender.alert.evidence.verdict": "suspicious"
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "OR",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "72677633-892f-44ca-afb3-567a4350bc30",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "d8c5d781-6442-4a9f-b91b-8b7b29d8e73a",
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "2c72b146-36c7-4143-baba-517b19d159bc",
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "a0e68595-3ccc-4ff9-90fb-8087bc439020",
                                "layerType": "data",
                                "rowHeight": "single",
                                "rowHeightLines": 1
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 21,
                    "i": "6847c21e-2ec0-4af4-aa67-ec52b181b05e",
                    "w": 13,
                    "x": 21,
                    "y": 31
                },
                "panelIndex": "6847c21e-2ec0-4af4-aa67-ec52b181b05e",
                "title": "Top 10 Email Sender IP with Suspicious or Malicious Verdict [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-24cc5824-23e2-462f-b38f-4769ea95322a",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "25f2fb8c-9456-418f-aa6a-d5e4037d63c7",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "24cc5824-23e2-462f-b38f-4769ea95322a": {
                                            "columnOrder": [
                                                "901ba472-02eb-4500-9ead-77371aa87f8c",
                                                "4cccf049-88f6-486d-9cab-de68dd15ec01"
                                            ],
                                            "columns": {
                                                "4cccf049-88f6-486d-9cab-de68dd15ec01": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "901ba472-02eb-4500-9ead-77371aa87f8c": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Detection Source",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "4cccf049-88f6-486d-9cab-de68dd15ec01",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "m365_defender.alert.detection_source"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "25f2fb8c-9456-418f-aa6a-d5e4037d63c7",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "901ba472-02eb-4500-9ead-77371aa87f8c",
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "4cccf049-88f6-486d-9cab-de68dd15ec01",
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "24cc5824-23e2-462f-b38f-4769ea95322a",
                                "layerType": "data",
                                "rowHeight": "single",
                                "rowHeightLines": 1
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 21,
                    "i": "51f47e38-eed6-42b3-8096-a39b914909da",
                    "w": 14,
                    "x": 34,
                    "y": 31
                },
                "panelIndex": "51f47e38-eed6-42b3-8096-a39b914909da",
                "title": "Top 10 Detection Source that identified most of the Alerts [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-d2d7332c-5fbd-4acc-bef9-a1f2a2a6a25d",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "5b859903-4472-47cb-8798-06ff556b7753",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "d2d7332c-5fbd-4acc-bef9-a1f2a2a6a25d": {
                                            "columnOrder": [
                                                "f65e2e2e-1d06-4965-871e-0c559e325343",
                                                "26cd4cd0-0825-47aa-932b-e620a6329167"
                                            ],
                                            "columns": {
                                                "26cd4cd0-0825-47aa-932b-e620a6329167": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "f65e2e2e-1d06-4965-871e-0c559e325343": {
                                                    "customLabel": true,
                                                    "dataType": "date",
                                                    "isBucketed": true,
                                                    "label": "Timestamp",
                                                    "operationType": "date_histogram",
                                                    "params": {
                                                        "includeEmptyRows": true,
                                                        "interval": "auto"
                                                    },
                                                    "scale": "interval",
                                                    "sourceField": "@timestamp"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "5b859903-4472-47cb-8798-06ff556b7753",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "accessors": [
                                            "26cd4cd0-0825-47aa-932b-e620a6329167"
                                        ],
                                        "layerId": "d2d7332c-5fbd-4acc-bef9-a1f2a2a6a25d",
                                        "layerType": "data",
                                        "position": "top",
                                        "seriesType": "line",
                                        "showGridlines": false,
                                        "xAccessor": "f65e2e2e-1d06-4965-871e-0c559e325343"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "legendSize": "auto",
                                    "position": "right",
                                    "shouldTruncate": false,
                                    "showSingleSeries": false
                                },
                                "preferredSeriesType": "line",
                                "title": "Empty XY chart",
                                "valueLabels": "hide",
                                "yLeftExtent": {
                                    "mode": "full"
                                },
                                "yRightExtent": {
                                    "mode": "full"
                                }
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 15,
                    "i": "62846e2a-f412-4cf9-b8ea-b08bc7fbd613",
                    "w": 40,
                    "x": 8,
                    "y": 52
                },
                "panelIndex": "62846e2a-f412-4cf9-b8ea-b08bc7fbd613",
                "title": "Alerts Over Time [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-32a410b6-1ed8-4397-ab2e-151edec25e80",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "c9581305-ba3a-4ead-91b7-4535d99f4525",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "32a410b6-1ed8-4397-ab2e-151edec25e80": {
                                            "columnOrder": [
                                                "e278fc5e-3a46-416d-be86-884554b160dc",
                                                "9c52de5e-c802-4a77-8cb4-b60368976cd9",
                                                "43b50fb7-eed1-4a62-bd34-4922fa34c64e"
                                            ],
                                            "columns": {
                                                "43b50fb7-eed1-4a62-bd34-4922fa34c64e": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "9c52de5e-c802-4a77-8cb4-b60368976cd9": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": true,
                                                    "label": "Severity",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "43b50fb7-eed1-4a62-bd34-4922fa34c64e",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "event.severity"
                                                },
                                                "e278fc5e-3a46-416d-be86-884554b160dc": {
                                                    "customLabel": true,
                                                    "dataType": "date",
                                                    "isBucketed": true,
                                                    "label": "Timestamp",
                                                    "operationType": "date_histogram",
                                                    "params": {
                                                        "includeEmptyRows": true,
                                                        "interval": "auto"
                                                    },
                                                    "scale": "interval",
                                                    "sourceField": "@timestamp"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "c9581305-ba3a-4ead-91b7-4535d99f4525",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "None",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "43b50fb7-eed1-4a62-bd34-4922fa34c64e"
                                        ],
                                        "layerId": "32a410b6-1ed8-4397-ab2e-151edec25e80",
                                        "layerType": "data",
                                        "position": "top",
                                        "seriesType": "line",
                                        "showGridlines": false,
                                        "splitAccessor": "9c52de5e-c802-4a77-8cb4-b60368976cd9",
                                        "xAccessor": "e278fc5e-3a46-416d-be86-884554b160dc"
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "legendSize": "auto",
                                    "position": "right",
                                    "shouldTruncate": false
                                },
                                "preferredSeriesType": "line",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide",
                                "yLeftExtent": {
                                    "mode": "full"
                                },
                                "yRightExtent": {
                                    "mode": "full"
                                }
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 16,
                    "i": "efd3aa63-5879-4383-87e4-6276e38b3c01",
                    "w": 40,
                    "x": 8,
                    "y": 67
                },
                "panelIndex": "efd3aa63-5879-4383-87e4-6276e38b3c01",
                "title": "Severity Over Time [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-5b675bca-2096-430a-ac1e-6a435a5c3e34",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "236c3bc5-5f69-4d41-a5cd-c581f069e57e",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "5b675bca-2096-430a-ac1e-6a435a5c3e34": {
                                            "columnOrder": [
                                                "d04bf6a5-66f9-4899-a4d1-e2c4ec7d4b74",
                                                "f37bb823-c831-497e-8d7e-8c00acbc11ff"
                                            ],
                                            "columns": {
                                                "d04bf6a5-66f9-4899-a4d1-e2c4ec7d4b74": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Mitre Technique",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "f37bb823-c831-497e-8d7e-8c00acbc11ff",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "threat.technique.subtechnique.id"
                                                },
                                                "f37bb823-c831-497e-8d7e-8c00acbc11ff": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "236c3bc5-5f69-4d41-a5cd-c581f069e57e",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "f37bb823-c831-497e-8d7e-8c00acbc11ff",
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "d04bf6a5-66f9-4899-a4d1-e2c4ec7d4b74",
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "5b675bca-2096-430a-ac1e-6a435a5c3e34",
                                "layerType": "data",
                                "paging": {
                                    "enabled": true,
                                    "size": 10
                                }
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 14,
                    "i": "7317b469-4895-497a-a263-14b58eaec52f",
                    "w": 20,
                    "x": 8,
                    "y": 83
                },
                "panelIndex": "7317b469-4895-497a-a263-14b58eaec52f",
                "title": "Top Mitre Techniques [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-bf6ca0e6-4c26-4cff-b35c-a1a578a38d20",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "c17dcd3a-85d8-4d61-8d7d-a73bf33c9308",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "960f02f3-c9a1-41c3-89b5-e776d368c13f",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "bf6ca0e6-4c26-4cff-b35c-a1a578a38d20": {
                                            "columnOrder": [
                                                "7048d5d3-a8bc-4b71-8b79-e51c6adc0350",
                                                "471be050-ea96-4ce7-8cef-00ca90e6fbed"
                                            ],
                                            "columns": {
                                                "471be050-ea96-4ce7-8cef-00ca90e6fbed": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "7048d5d3-a8bc-4b71-8b79-e51c6adc0350": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "User Account",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "471be050-ea96-4ce7-8cef-00ca90e6fbed",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "m365_defender.alert.evidence.user_account.account_name"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "m365_defender.alert.evidence.roles",
                                        "index": "c17dcd3a-85d8-4d61-8d7d-a73bf33c9308",
                                        "key": "m365_defender.alert.evidence.roles",
                                        "negate": false,
                                        "params": {
                                            "query": "compromised"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "m365_defender.alert.evidence.roles": "compromised"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "960f02f3-c9a1-41c3-89b5-e776d368c13f",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "7048d5d3-a8bc-4b71-8b79-e51c6adc0350",
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "471be050-ea96-4ce7-8cef-00ca90e6fbed",
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "bf6ca0e6-4c26-4cff-b35c-a1a578a38d20",
                                "layerType": "data",
                                "rowHeight": "single",
                                "rowHeightLines": 1
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 14,
                    "i": "d8b78c44-5d93-4a70-9d3d-0386581082d1",
                    "w": 20,
                    "x": 28,
                    "y": 83
                },
                "panelIndex": "d8b78c44-5d93-4a70-9d3d-0386581082d1",
                "title": "Top 10 User Account with Compromised Role [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-3f509783-a68e-46a5-a9ea-6c51a0bcf036",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "2ad498dd-ec2d-4d0a-9b28-90ec26463540",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "81318fde-26d0-4216-bad5-1f971638821e",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "3f509783-a68e-46a5-a9ea-6c51a0bcf036": {
                                            "columnOrder": [
                                                "3f1e354e-7c22-434e-9a0d-22e8b81f63b5",
                                                "82a086d9-d047-4bc2-a791-c13d1f056f9c"
                                            ],
                                            "columns": {
                                                "3f1e354e-7c22-434e-9a0d-22e8b81f63b5": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Process Commands",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "82a086d9-d047-4bc2-a791-c13d1f056f9c",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "process.command_line"
                                                },
                                                "82a086d9-d047-4bc2-a791-c13d1f056f9c": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "2ad498dd-ec2d-4d0a-9b28-90ec26463540",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "m365_defender.alert.evidence.verdict",
                                                    "index": "logs-*",
                                                    "key": "m365_defender.alert.evidence.verdict",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "malicious"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "m365_defender.alert.evidence.verdict": "malicious"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "m365_defender.alert.evidence.verdict",
                                                    "index": "logs-*",
                                                    "key": "m365_defender.alert.evidence.verdict",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "suspicious"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "m365_defender.alert.evidence.verdict": "suspicious"
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "OR",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "81318fde-26d0-4216-bad5-1f971638821e",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "3f1e354e-7c22-434e-9a0d-22e8b81f63b5",
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "82a086d9-d047-4bc2-a791-c13d1f056f9c",
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "3f509783-a68e-46a5-a9ea-6c51a0bcf036",
                                "layerType": "data",
                                "rowHeight": "single",
                                "rowHeightLines": 1
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 17,
                    "i": "34673480-15c2-4f75-ae86-637bc6875e78",
                    "w": 20,
                    "x": 8,
                    "y": 97
                },
                "panelIndex": "34673480-15c2-4f75-ae86-637bc6875e78",
                "title": "Top 10 Process Commands with Suspicious or Malicious Verdict [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-6e6323ee-5d54-4720-85b5-f567b8ef9d21",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "5aaad6ed-4ad5-44ba-8d6f-2835812d4321",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "fd73d1c0-eb56-41d1-94b0-43976d0ba7d2",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "6e6323ee-5d54-4720-85b5-f567b8ef9d21": {
                                            "columnOrder": [
                                                "0f49f90e-0cbc-4ae0-b24d-0c82dc7c9d3b",
                                                "5dea6d18-051a-4715-9327-3d30bb020a87"
                                            ],
                                            "columns": {
                                                "0f49f90e-0cbc-4ae0-b24d-0c82dc7c9d3b": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Device ID",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "5dea6d18-051a-4715-9327-3d30bb020a87",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "host.id"
                                                },
                                                "5dea6d18-051a-4715-9327-3d30bb020a87": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "m365_defender.alert.evidence.roles",
                                        "index": "5aaad6ed-4ad5-44ba-8d6f-2835812d4321",
                                        "key": "m365_defender.alert.evidence.roles",
                                        "negate": false,
                                        "params": {
                                            "query": "attacked"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "m365_defender.alert.evidence.roles": "attacked"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "fd73d1c0-eb56-41d1-94b0-43976d0ba7d2",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.alert"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.alert"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "0f49f90e-0cbc-4ae0-b24d-0c82dc7c9d3b",
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "5dea6d18-051a-4715-9327-3d30bb020a87",
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "6e6323ee-5d54-4720-85b5-f567b8ef9d21",
                                "layerType": "data",
                                "rowHeight": "single",
                                "rowHeightLines": 1
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 17,
                    "i": "664a1613-6c7e-40cd-91b2-43ce6c451ddb",
                    "w": 20,
                    "x": 28,
                    "y": 97
                },
                "panelIndex": "664a1613-6c7e-40cd-91b2-43ce6c451ddb",
                "title": "Top 10 Most Attacked Device [Logs Microsoft 365 Defender]",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "enhancements": {}
                },
                "gridData": {
                    "h": 15,
                    "i": "b83be89c-7f77-406b-9028-1cfb0eb67e8d",
                    "w": 40,
                    "x": 8,
                    "y": 114
                },
                "panelIndex": "b83be89c-7f77-406b-9028-1cfb0eb67e8d",
                "panelRefName": "panel_b83be89c-7f77-406b-9028-1cfb0eb67e8d",
                "type": "search",
                "version": "8.7.1"
            }
        ],
        "timeRestore": false,
        "title": "[Logs Microsoft 365 Defender] Alert",
        "version": 1
    },
    "coreMigrationVersion": "8.7.1",
    "created_at": "2024-01-22T12:09:27.346Z",
    "id": "m365_defender-d80d7840-4366-11ed-b1f2-e917f608bd03",
    "migrationVersion": {
        "dashboard": "8.7.0"
    },
    "references": [
        {
            "id": "logs-*",
            "name": "8ed4553a-d396-4ad7-b247-10e005d65086:indexpattern-datasource-layer-6ddc53cd-2bbd-4616-837b-3fbe0712ca7e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8ed4553a-d396-4ad7-b247-10e005d65086:9f120d0d-531c-42be-b1ed-5dc4683d5b15",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "00c0b388-64b8-49c8-9ccb-de8e58030b4d:indexpattern-datasource-layer-874da7c4-ebe5-4c5c-a302-094d287b81bb",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "00c0b388-64b8-49c8-9ccb-de8e58030b4d:a155689d-f319-4f42-831d-2097922e6b7c",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8e4019a0-6594-4eaf-9358-c343b72aba84:indexpattern-datasource-layer-2fa8c035-1708-4d32-88fc-b59af7751db4",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8e4019a0-6594-4eaf-9358-c343b72aba84:db899305-b961-454c-8390-5d1d2395a3e2",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "1f836fdc-61f4-4cf4-a392-50276a2b77f1:indexpattern-datasource-layer-45d80486-c9c8-4d28-bbcd-5d29072c9cb9",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "1f836fdc-61f4-4cf4-a392-50276a2b77f1:d3ac725d-8f46-4c0d-a938-280f91905f74",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "b5b7f2a4-1d6e-4812-8724-5a771014c3ae:indexpattern-datasource-layer-bdba4af5-1396-46ec-ad04-59157e7697f9",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "b5b7f2a4-1d6e-4812-8724-5a771014c3ae:f7a464e2-0eb1-4f4a-9d10-a16d8f69348c",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "6847c21e-2ec0-4af4-aa67-ec52b181b05e:indexpattern-datasource-layer-a0e68595-3ccc-4ff9-90fb-8087bc439020",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "6847c21e-2ec0-4af4-aa67-ec52b181b05e:39ecb368-ff15-47cd-a634-68075279a23e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "6847c21e-2ec0-4af4-aa67-ec52b181b05e:72677633-892f-44ca-afb3-567a4350bc30",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "51f47e38-eed6-42b3-8096-a39b914909da:indexpattern-datasource-layer-24cc5824-23e2-462f-b38f-4769ea95322a",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "51f47e38-eed6-42b3-8096-a39b914909da:25f2fb8c-9456-418f-aa6a-d5e4037d63c7",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "62846e2a-f412-4cf9-b8ea-b08bc7fbd613:indexpattern-datasource-layer-d2d7332c-5fbd-4acc-bef9-a1f2a2a6a25d",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "62846e2a-f412-4cf9-b8ea-b08bc7fbd613:5b859903-4472-47cb-8798-06ff556b7753",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "efd3aa63-5879-4383-87e4-6276e38b3c01:indexpattern-datasource-layer-32a410b6-1ed8-4397-ab2e-151edec25e80",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "efd3aa63-5879-4383-87e4-6276e38b3c01:c9581305-ba3a-4ead-91b7-4535d99f4525",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7317b469-4895-497a-a263-14b58eaec52f:indexpattern-datasource-layer-5b675bca-2096-430a-ac1e-6a435a5c3e34",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7317b469-4895-497a-a263-14b58eaec52f:236c3bc5-5f69-4d41-a5cd-c581f069e57e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "d8b78c44-5d93-4a70-9d3d-0386581082d1:indexpattern-datasource-layer-bf6ca0e6-4c26-4cff-b35c-a1a578a38d20",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "d8b78c44-5d93-4a70-9d3d-0386581082d1:c17dcd3a-85d8-4d61-8d7d-a73bf33c9308",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "d8b78c44-5d93-4a70-9d3d-0386581082d1:960f02f3-c9a1-41c3-89b5-e776d368c13f",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "34673480-15c2-4f75-ae86-637bc6875e78:indexpattern-datasource-layer-3f509783-a68e-46a5-a9ea-6c51a0bcf036",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "34673480-15c2-4f75-ae86-637bc6875e78:2ad498dd-ec2d-4d0a-9b28-90ec26463540",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "34673480-15c2-4f75-ae86-637bc6875e78:81318fde-26d0-4216-bad5-1f971638821e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "664a1613-6c7e-40cd-91b2-43ce6c451ddb:indexpattern-datasource-layer-6e6323ee-5d54-4720-85b5-f567b8ef9d21",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "664a1613-6c7e-40cd-91b2-43ce6c451ddb:5aaad6ed-4ad5-44ba-8d6f-2835812d4321",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "664a1613-6c7e-40cd-91b2-43ce6c451ddb:fd73d1c0-eb56-41d1-94b0-43976d0ba7d2",
            "type": "index-pattern"
        },
        {
            "id": "m365_defender-989afc60-44a5-11ed-8375-0168a9970c06",
            "name": "b83be89c-7f77-406b-9028-1cfb0eb67e8d:panel_b83be89c-7f77-406b-9028-1cfb0eb67e8d",
            "type": "search"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_5779a7c6-acf5-4f7d-ac4c-caae9517d95e:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_ec5d23b5-535c-483a-88ad-279762f3d5ca:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_cef3df17-225a-4373-a231-caa594cd1bf4:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_23cace2f-34ed-4efa-bed4-ccdc7318dfb8:rangeSliderDataView",
            "type": "index-pattern"
        }
    ],
    "type": "dashboard"
}