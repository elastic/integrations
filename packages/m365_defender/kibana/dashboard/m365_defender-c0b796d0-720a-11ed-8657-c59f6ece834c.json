{
    "attributes": {
        "controlGroupInput": {
            "chainingSystem": "HIERARCHICAL",
            "controlStyle": "oneLine",
            "ignoreParentSettingsJSON": "{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}",
            "panelsJSON": "{\"007a099d-f3bc-4c46-a48e-629e06a614e4\":{\"type\":\"optionsListControl\",\"order\":0,\"grow\":true,\"width\":\"medium\",\"explicitInput\":{\"id\":\"007a099d-f3bc-4c46-a48e-629e06a614e4\",\"fieldName\":\"host.name\",\"title\":\"Hostname\",\"enhancements\":{}}},\"d441e8a1-87f4-46b1-8dff-bf9bb88762d3\":{\"type\":\"optionsListControl\",\"order\":1,\"grow\":true,\"width\":\"medium\",\"explicitInput\":{\"id\":\"d441e8a1-87f4-46b1-8dff-bf9bb88762d3\",\"fieldName\":\"m365_defender.event.category\",\"title\":\"Event Type\",\"enhancements\":{}}},\"6fa76f5f-16ed-4419-8b16-fe5581d21067\":{\"type\":\"optionsListControl\",\"order\":2,\"grow\":true,\"width\":\"medium\",\"explicitInput\":{\"id\":\"6fa76f5f-16ed-4419-8b16-fe5581d21067\",\"fieldName\":\"host.os.full\",\"title\":\"OS Platform\",\"enhancements\":{}}},\"175fd1a8-7429-4e56-853b-057b124121de\":{\"type\":\"optionsListControl\",\"order\":3,\"grow\":true,\"width\":\"medium\",\"explicitInput\":{\"id\":\"175fd1a8-7429-4e56-853b-057b124121de\",\"fieldName\":\"host.type\",\"title\":\"Device Type\",\"selectedOptions\":[],\"enhancements\":{}}}}"
        },
        "description": "Overview of Microsoft 365 Defender Device Events.",
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": {
                "filter": [],
                "query": {
                    "language": "kuery",
                    "query": ""
                }
            }
        },
        "optionsJSON": {
            "hidePanelTitles": false,
            "syncColors": false,
            "syncCursor": true,
            "syncTooltips": false,
            "useMargins": true
        },
        "panelsJSON": [
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": false,
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "id": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "### Navigation\n\n#### M365 Defender\n\n#### EventHub Datastream  \n[Alert Events](#/dashboard/m365_defender-2690a440-7235-11ed-8657-c59f6ece834c)  \n**[Device Events](#/dashboard/m365_defender-c0b796d0-720a-11ed-8657-c59f6ece834c)**  \n[App \u0026 Identity Events](#/dashboard/m365_defender-d587df00-745f-11ed-8657-c59f6ece834c)  \n[Email Events](#/dashboard/m365_defender-3caf3c00-7456-11ed-8657-c59f6ece834c)  \n\n#### Incident Datastream (Graph API)  \n\n[Incident Events](#/dashboard/m365_defender-ac54d310-44ab-11ed-8375-0168a9970c06)  \n[Log Events](#/dashboard/m365_defender-d80d7840-4366-11ed-b1f2-e917f608bd03)  \n\n#### Description\n\nThis dashboard visualizes Device type events according to the [Microsoft Documentation](https://learn.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-deviceevents-table?view=o365-worldwide).  \nThe data is collected from a configured Event Hub, using the M365 Defender Event datastream.\n\nThe supported event types are:\n- AdvancedHunting-DeviceEvents\n- AdvancedHunting-DeviceFileCertificateInfo\n- AdvancedHunting-DeviceFileEvents\n- AdvancedHunting-DeviceImageLoadEvents\n- AdvancedHunting-DeviceInfo\n- AdvancedHunting-DeviceLogonEvents\n- AdvancedHunting-DeviceNetworkEvents\n- AdvancedHunting-DeviceNetworkInfo\n- AdvancedHunting-DeviceProcessEvents\n- AdvancedHunting-DeviceRegistryEvents",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 82,
                    "i": "87171286-8e9b-4ee6-9669-02a89ac76bbc",
                    "w": 8,
                    "x": 0,
                    "y": 0
                },
                "panelIndex": "87171286-8e9b-4ee6-9669-02a89ac76bbc",
                "title": "Table of Contents",
                "type": "visualization",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "e7b0412d-2f44-423e-9b0a-897f2884c618",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "a0dd3daf-229c-4ea3-b328-cfc256bc6364",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "06ee28b9-429b-42e8-a83b-3a3f4eb16745": {
                                            "columnOrder": [
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36"
                                            ],
                                            "columns": {
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Unique Devices",
                                                    "operationType": "unique_count",
                                                    "scale": "ratio",
                                                    "sourceField": "host.id"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "m365_defender.event.category",
                                        "index": "e7b0412d-2f44-423e-9b0a-897f2884c618",
                                        "key": "m365_defender.event.category",
                                        "negate": false,
                                        "params": [
                                            "AdvancedHunting-DeviceEvents",
                                            "AdvancedHunting-DeviceFileCertificateInfo",
                                            "AdvancedHunting-DeviceFileEvents",
                                            "AdvancedHunting-DeviceImageLoadEvents",
                                            "AdvancedHunting-DeviceInfo",
                                            "AdvancedHunting-DeviceLogonEvents",
                                            "AdvancedHunting-DeviceNetworkEvents",
                                            "AdvancedHunting-DeviceNetworkInfo",
                                            "AdvancedHunting-DeviceProcessEvents",
                                            "AdvancedHunting-DeviceRegistryEvents"
                                        ],
                                        "type": "phrases",
                                        "value": [
                                            "AdvancedHunting-DeviceEvents",
                                            "AdvancedHunting-DeviceFileCertificateInfo",
                                            "AdvancedHunting-DeviceFileEvents",
                                            "AdvancedHunting-DeviceImageLoadEvents",
                                            "AdvancedHunting-DeviceInfo",
                                            "AdvancedHunting-DeviceLogonEvents",
                                            "AdvancedHunting-DeviceNetworkEvents",
                                            "AdvancedHunting-DeviceNetworkInfo",
                                            "AdvancedHunting-DeviceProcessEvents",
                                            "AdvancedHunting-DeviceRegistryEvents"
                                        ]
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceImageLoadEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceLogonEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceNetworkEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceNetworkInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceProcessEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceRegistryEvents"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "a0dd3daf-229c-4ea3-b328-cfc256bc6364",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "color": "#6092C0",
                                "layerId": "06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "layerType": "data",
                                "metricAccessor": "c26f4a59-33a0-48c9-8a07-9031a1053d36",
                                "subtitle": "Based on host.id"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 7,
                    "i": "eef7f556-05f9-4b08-bc1a-f87957c5919d",
                    "w": 5,
                    "x": 8,
                    "y": 0
                },
                "panelIndex": "eef7f556-05f9-4b08-bc1a-f87957c5919d",
                "title": "Unique Devices",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "bb4c45e4-7cbb-43a7-acea-e064d71d78dd",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "1e2f916a-dbc2-40ef-817c-2f44e1a7a014",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "06ee28b9-429b-42e8-a83b-3a3f4eb16745": {
                                            "columnOrder": [
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36"
                                            ],
                                            "columns": {
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Devices Not Onboarded",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "bb4c45e4-7cbb-43a7-acea-e064d71d78dd",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "1e2f916a-dbc2-40ef-817c-2f44e1a7a014",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "m365_defender.event.onboarding_status",
                                                    "index": "logs-*",
                                                    "key": "m365_defender.event.onboarding_status",
                                                    "negate": false,
                                                    "type": "exists",
                                                    "value": "exists"
                                                },
                                                "query": {
                                                    "exists": {
                                                        "field": "m365_defender.event.onboarding_status"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "m365_defender.event.onboarding_status",
                                                    "index": "logs-*",
                                                    "key": "m365_defender.event.onboarding_status",
                                                    "negate": true,
                                                    "params": {
                                                        "query": "Onboarded"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "m365_defender.event.onboarding_status": "Onboarded"
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "AND",
                                        "type": "combined"
                                    },
                                    "query": {}
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "color": "#6092C0",
                                "layerId": "06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "layerType": "data",
                                "metricAccessor": "c26f4a59-33a0-48c9-8a07-9031a1053d36",
                                "subtitle": ""
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 7,
                    "i": "d2da5421-b966-4fa6-9f0b-67cf5699fe07",
                    "w": 5,
                    "x": 13,
                    "y": 0
                },
                "panelIndex": "d2da5421-b966-4fa6-9f0b-67cf5699fe07",
                "title": "Devices Not Onboarded",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "28f49b0a-d5ff-4876-a5ae-407a013e33b2",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "fa186e74-e31b-46d0-b565-5aa2d8927af3",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "06ee28b9-429b-42e8-a83b-3a3f4eb16745": {
                                            "columnOrder": [
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36"
                                            ],
                                            "columns": {
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Devices Onboarded",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "28f49b0a-d5ff-4876-a5ae-407a013e33b2",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "m365_defender.event.onboarding_status",
                                        "index": "fa186e74-e31b-46d0-b565-5aa2d8927af3",
                                        "key": "m365_defender.event.onboarding_status",
                                        "negate": false,
                                        "params": {
                                            "query": "Onboarded"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "m365_defender.event.onboarding_status": "Onboarded"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "color": "#6092C0",
                                "layerId": "06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "layerType": "data",
                                "metricAccessor": "c26f4a59-33a0-48c9-8a07-9031a1053d36",
                                "subtitle": ""
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 7,
                    "i": "4cdcfcff-9592-43e6-abf5-cba2e4b82e1e",
                    "w": 5,
                    "x": 18,
                    "y": 0
                },
                "panelIndex": "4cdcfcff-9592-43e6-abf5-cba2e4b82e1e",
                "title": "Devices Onboarded",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "1c359492-1f19-4eaa-8168-b69c0280046e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "1898879e-99e7-472e-8eb0-1bcb24cd981e",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "06ee28b9-429b-42e8-a83b-3a3f4eb16745": {
                                            "columnOrder": [
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36"
                                            ],
                                            "columns": {
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "File Signed",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "1c359492-1f19-4eaa-8168-b69c0280046e",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "m365_defender.event.category",
                                                    "index": "logs-*",
                                                    "key": "m365_defender.event.category",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "file.code_signature.exists",
                                                    "index": "logs-*",
                                                    "key": "file.code_signature.exists",
                                                    "negate": false,
                                                    "params": {
                                                        "query": true
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "file.code_signature.exists": true
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "AND",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "1898879e-99e7-472e-8eb0-1bcb24cd981e",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "color": "#6092C0",
                                "layerId": "06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "layerType": "data",
                                "metricAccessor": "c26f4a59-33a0-48c9-8a07-9031a1053d36",
                                "subtitle": ""
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 7,
                    "i": "bdad135a-5476-4fa5-b9e2-49abeba859ab",
                    "w": 5,
                    "x": 23,
                    "y": 0
                },
                "panelIndex": "bdad135a-5476-4fa5-b9e2-49abeba859ab",
                "title": "Files Signed",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "8ea8e34b-c360-4515-8c9a-f74c86fe9d8b",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "48d451bc-c265-48c3-ba55-e5b1aa37638b",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "06ee28b9-429b-42e8-a83b-3a3f4eb16745": {
                                            "columnOrder": [
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36"
                                            ],
                                            "columns": {
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "File Unsigned",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "8ea8e34b-c360-4515-8c9a-f74c86fe9d8b",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "m365_defender.event.category",
                                                    "index": "logs-*",
                                                    "key": "m365_defender.event.category",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "file.code_signature.exists",
                                                    "index": "logs-*",
                                                    "key": "file.code_signature.exists",
                                                    "negate": false,
                                                    "params": {
                                                        "query": false
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "file.code_signature.exists": false
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "AND",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "48d451bc-c265-48c3-ba55-e5b1aa37638b",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "color": "#6092C0",
                                "layerId": "06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "layerType": "data",
                                "metricAccessor": "c26f4a59-33a0-48c9-8a07-9031a1053d36",
                                "subtitle": ""
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 7,
                    "i": "43d8b62e-e75c-4bd4-9803-6218cf8e4f28",
                    "w": 5,
                    "x": 28,
                    "y": 0
                },
                "panelIndex": "43d8b62e-e75c-4bd4-9803-6218cf8e4f28",
                "title": "Files Unsigned",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "26f2a7e3-8f13-40e5-bce2-4b2dd3f08dc4",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "17012638-69b0-481b-928e-50bc42099035",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "06ee28b9-429b-42e8-a83b-3a3f4eb16745": {
                                            "columnOrder": [
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36"
                                            ],
                                            "columns": {
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Certificates Trusted",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "26f2a7e3-8f13-40e5-bce2-4b2dd3f08dc4",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "m365_defender.event.category",
                                                    "index": "logs-*",
                                                    "key": "m365_defender.event.category",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "file.code_signature.trusted",
                                                    "index": "logs-*",
                                                    "key": "file.code_signature.trusted",
                                                    "negate": false,
                                                    "params": {
                                                        "query": true
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "file.code_signature.trusted": true
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "AND",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "17012638-69b0-481b-928e-50bc42099035",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "color": "#6092C0",
                                "layerId": "06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "layerType": "data",
                                "metricAccessor": "c26f4a59-33a0-48c9-8a07-9031a1053d36",
                                "subtitle": ""
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 7,
                    "i": "570f73ac-a3af-48ee-849c-1b64e737b002",
                    "w": 5,
                    "x": 33,
                    "y": 0
                },
                "panelIndex": "570f73ac-a3af-48ee-849c-1b64e737b002",
                "title": "Files Trusted",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "953d90f0-317e-4df8-a189-000736037076",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "4b2d8da6-d241-43ac-a9e0-4af12cbf58ff",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "06ee28b9-429b-42e8-a83b-3a3f4eb16745": {
                                            "columnOrder": [
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36"
                                            ],
                                            "columns": {
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Certificates Untrusted",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "index": "953d90f0-317e-4df8-a189-000736037076",
                                        "negate": false,
                                        "params": [
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "m365_defender.event.category",
                                                    "index": "logs-*",
                                                    "key": "m365_defender.event.category",
                                                    "negate": false,
                                                    "params": {
                                                        "query": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    }
                                                }
                                            },
                                            {
                                                "meta": {
                                                    "alias": null,
                                                    "disabled": false,
                                                    "field": "file.code_signature.trusted",
                                                    "index": "logs-*",
                                                    "key": "file.code_signature.trusted",
                                                    "negate": false,
                                                    "params": {
                                                        "query": false
                                                    },
                                                    "type": "phrase"
                                                },
                                                "query": {
                                                    "match_phrase": {
                                                        "file.code_signature.trusted": false
                                                    }
                                                }
                                            }
                                        ],
                                        "relation": "AND",
                                        "type": "combined"
                                    },
                                    "query": {}
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "4b2d8da6-d241-43ac-a9e0-4af12cbf58ff",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "color": "#6092C0",
                                "layerId": "06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "layerType": "data",
                                "metricAccessor": "c26f4a59-33a0-48c9-8a07-9031a1053d36",
                                "subtitle": ""
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 7,
                    "i": "69254ab7-fc20-4db8-952e-76e4f2ffa4e9",
                    "w": 5,
                    "x": 38,
                    "y": 0
                },
                "panelIndex": "69254ab7-fc20-4db8-952e-76e4f2ffa4e9",
                "title": "Files Untrusted",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "f2489da3-1ef2-46be-8809-45cd8fd6e08f",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "5b88ee69-8299-4ca0-8684-4eb31dc7eca7",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "06ee28b9-429b-42e8-a83b-3a3f4eb16745": {
                                            "columnOrder": [
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36"
                                            ],
                                            "columns": {
                                                "c26f4a59-33a0-48c9-8a07-9031a1053d36": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Unique Domains",
                                                    "operationType": "unique_count",
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 2
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "user.domain"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "m365_defender.event.category",
                                        "index": "f2489da3-1ef2-46be-8809-45cd8fd6e08f",
                                        "key": "m365_defender.event.category",
                                        "negate": false,
                                        "params": [
                                            "AdvancedHunting-DeviceEvents",
                                            "AdvancedHunting-DeviceFileCertificateInfo",
                                            "AdvancedHunting-DeviceFileEvents",
                                            "AdvancedHunting-DeviceImageLoadEvents",
                                            "AdvancedHunting-DeviceInfo",
                                            "AdvancedHunting-DeviceLogonEvents",
                                            "AdvancedHunting-DeviceNetworkEvents",
                                            "AdvancedHunting-DeviceNetworkInfo",
                                            "AdvancedHunting-DeviceProcessEvents",
                                            "AdvancedHunting-DeviceRegistryEvents"
                                        ],
                                        "type": "phrases",
                                        "value": [
                                            "AdvancedHunting-DeviceEvents",
                                            "AdvancedHunting-DeviceFileCertificateInfo",
                                            "AdvancedHunting-DeviceFileEvents",
                                            "AdvancedHunting-DeviceImageLoadEvents",
                                            "AdvancedHunting-DeviceInfo",
                                            "AdvancedHunting-DeviceLogonEvents",
                                            "AdvancedHunting-DeviceNetworkEvents",
                                            "AdvancedHunting-DeviceNetworkInfo",
                                            "AdvancedHunting-DeviceProcessEvents",
                                            "AdvancedHunting-DeviceRegistryEvents"
                                        ]
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceImageLoadEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceLogonEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceNetworkEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceNetworkInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceProcessEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceRegistryEvents"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "5b88ee69-8299-4ca0-8684-4eb31dc7eca7",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "color": "#6092C0",
                                "layerId": "06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "layerType": "data",
                                "metricAccessor": "c26f4a59-33a0-48c9-8a07-9031a1053d36",
                                "subtitle": "Based on user.domain"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 7,
                    "i": "0a439ec0-b0dd-41df-b1de-b761b68d6ffb",
                    "w": 5,
                    "x": 43,
                    "y": 0
                },
                "panelIndex": "0a439ec0-b0dd-41df-b1de-b761b68d6ffb",
                "title": "Unique Domains",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "2873ea87-14a2-4aa2-8031-3f5f778f28d1",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "70ce4539-c1d4-4b7f-b4f7-b1f460d0d699",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "06ee28b9-429b-42e8-a83b-3a3f4eb16745": {
                                            "columnOrder": [
                                                "437edb9b-5df4-44f3-9fc6-1d0052b3297d",
                                                "60a8e5dd-e24e-4494-b839-da383f2484f9"
                                            ],
                                            "columns": {
                                                "437edb9b-5df4-44f3-9fc6-1d0052b3297d": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Device Category",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "60a8e5dd-e24e-4494-b839-da383f2484f9",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "m365_defender.event.category"
                                                },
                                                "60a8e5dd-e24e-4494-b839-da383f2484f9": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": true,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "2873ea87-14a2-4aa2-8031-3f5f778f28d1",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "m365_defender.event.category",
                                        "index": "70ce4539-c1d4-4b7f-b4f7-b1f460d0d699",
                                        "key": "m365_defender.event.category",
                                        "negate": false,
                                        "params": [
                                            "AdvancedHunting-DeviceEvents",
                                            "AdvancedHunting-DeviceFileCertificateInfo",
                                            "AdvancedHunting-DeviceFileEvents",
                                            "AdvancedHunting-DeviceImageLoadEvents",
                                            "AdvancedHunting-DeviceInfo",
                                            "AdvancedHunting-DeviceLogonEvents",
                                            "AdvancedHunting-DeviceNetworkEvents",
                                            "AdvancedHunting-DeviceNetworkInfo",
                                            "AdvancedHunting-DeviceProcessEvents",
                                            "AdvancedHunting-DeviceRegistryEvents"
                                        ],
                                        "type": "phrases",
                                        "value": [
                                            "AdvancedHunting-DeviceEvents",
                                            "AdvancedHunting-DeviceFileCertificateInfo",
                                            "AdvancedHunting-DeviceFileEvents",
                                            "AdvancedHunting-DeviceImageLoadEvents",
                                            "AdvancedHunting-DeviceInfo",
                                            "AdvancedHunting-DeviceLogonEvents",
                                            "AdvancedHunting-DeviceNetworkEvents",
                                            "AdvancedHunting-DeviceNetworkInfo",
                                            "AdvancedHunting-DeviceProcessEvents",
                                            "AdvancedHunting-DeviceRegistryEvents"
                                        ]
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceImageLoadEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceLogonEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceNetworkEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceNetworkInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceProcessEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceRegistryEvents"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "None",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "60a8e5dd-e24e-4494-b839-da383f2484f9"
                                        ],
                                        "layerId": "06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                        "layerType": "data",
                                        "seriesType": "bar_horizontal",
                                        "xAccessor": "437edb9b-5df4-44f3-9fc6-1d0052b3297d",
                                        "yConfig": [
                                            {
                                                "color": "#54b399",
                                                "forAccessor": "60a8e5dd-e24e-4494-b839-da383f2484f9"
                                            }
                                        ]
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_horizontal",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 21,
                    "i": "7cd71879-68ac-454b-a135-c6bacac2d77f",
                    "w": 20,
                    "x": 8,
                    "y": 7
                },
                "panelIndex": "7cd71879-68ac-454b-a135-c6bacac2d77f",
                "title": "Distribution of Device Events by Category",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "54cb0ac8-edd5-4b99-b467-4a5c49b87e05",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "36724591-c980-454c-a773-fa1b2591b218",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "06ee28b9-429b-42e8-a83b-3a3f4eb16745": {
                                            "columnOrder": [
                                                "437edb9b-5df4-44f3-9fc6-1d0052b3297d",
                                                "60a8e5dd-e24e-4494-b839-da383f2484f9"
                                            ],
                                            "columns": {
                                                "437edb9b-5df4-44f3-9fc6-1d0052b3297d": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Protocol",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "60a8e5dd-e24e-4494-b839-da383f2484f9",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "network.protocol"
                                                },
                                                "60a8e5dd-e24e-4494-b839-da383f2484f9": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": true,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "54cb0ac8-edd5-4b99-b467-4a5c49b87e05",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "m365_defender.event.category",
                                        "index": "36724591-c980-454c-a773-fa1b2591b218",
                                        "key": "m365_defender.event.category",
                                        "negate": false,
                                        "params": [
                                            "AdvancedHunting-DeviceEvents",
                                            "AdvancedHunting-DeviceFileCertificateInfo",
                                            "AdvancedHunting-DeviceFileEvents",
                                            "AdvancedHunting-DeviceImageLoadEvents",
                                            "AdvancedHunting-DeviceInfo",
                                            "AdvancedHunting-DeviceLogonEvents",
                                            "AdvancedHunting-DeviceNetworkEvents",
                                            "AdvancedHunting-DeviceNetworkInfo",
                                            "AdvancedHunting-DeviceProcessEvents",
                                            "AdvancedHunting-DeviceRegistryEvents"
                                        ],
                                        "type": "phrases",
                                        "value": [
                                            "AdvancedHunting-DeviceEvents",
                                            "AdvancedHunting-DeviceFileCertificateInfo",
                                            "AdvancedHunting-DeviceFileEvents",
                                            "AdvancedHunting-DeviceImageLoadEvents",
                                            "AdvancedHunting-DeviceInfo",
                                            "AdvancedHunting-DeviceLogonEvents",
                                            "AdvancedHunting-DeviceNetworkEvents",
                                            "AdvancedHunting-DeviceNetworkInfo",
                                            "AdvancedHunting-DeviceProcessEvents",
                                            "AdvancedHunting-DeviceRegistryEvents"
                                        ]
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceImageLoadEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceLogonEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceNetworkEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceNetworkInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceProcessEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceRegistryEvents"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "None",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "60a8e5dd-e24e-4494-b839-da383f2484f9"
                                        ],
                                        "layerId": "06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                        "layerType": "data",
                                        "seriesType": "bar_horizontal",
                                        "xAccessor": "437edb9b-5df4-44f3-9fc6-1d0052b3297d",
                                        "yConfig": [
                                            {
                                                "color": "#54b399",
                                                "forAccessor": "60a8e5dd-e24e-4494-b839-da383f2484f9"
                                            }
                                        ]
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_horizontal",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 21,
                    "i": "12d3fd1a-bd2b-4612-84ba-aa2bb2060d78",
                    "w": 20,
                    "x": 28,
                    "y": 7
                },
                "panelIndex": "12d3fd1a-bd2b-4612-84ba-aa2bb2060d78",
                "title": "Distribution of Device Events by Protocol",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-f76bb73e-d4b6-4fa1-9329-2e9942dd9eb4",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "5fbe60d0-db91-4d90-8078-74267201081b",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "f76bb73e-d4b6-4fa1-9329-2e9942dd9eb4": {
                                            "columnOrder": [
                                                "848b4914-cfa6-41d7-9d50-bef5904481db",
                                                "85e428bc-ca74-4660-87e5-c1d916524038"
                                            ],
                                            "columns": {
                                                "848b4914-cfa6-41d7-9d50-bef5904481db": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Logon Type",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "85e428bc-ca74-4660-87e5-c1d916524038",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "m365_defender.event.logon.type"
                                                },
                                                "85e428bc-ca74-4660-87e5-c1d916524038": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "5fbe60d0-db91-4d90-8078-74267201081b",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "layerId": "f76bb73e-d4b6-4fa1-9329-2e9942dd9eb4",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "legendSize": "auto",
                                        "metrics": [
                                            "85e428bc-ca74-4660-87e5-c1d916524038"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "848b4914-cfa6-41d7-9d50-bef5904481db"
                                        ]
                                    }
                                ],
                                "palette": {
                                    "name": "default",
                                    "type": "palette"
                                },
                                "shape": "pie"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 18,
                    "i": "3a2f0c3d-bd6d-44e4-b6c3-25d7f55dd608",
                    "w": 20,
                    "x": 8,
                    "y": 28
                },
                "panelIndex": "3a2f0c3d-bd6d-44e4-b6c3-25d7f55dd608",
                "title": "Distribution of Device by Device Logon Type",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "40219299-d96a-4725-a046-807b4c1d3972",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "06ee28b9-429b-42e8-a83b-3a3f4eb16745": {
                                            "columnOrder": [
                                                "437edb9b-5df4-44f3-9fc6-1d0052b3297d",
                                                "6e332bea-d1ec-4479-84ec-b52332226a4f",
                                                "60a8e5dd-e24e-4494-b839-da383f2484f9"
                                            ],
                                            "columns": {
                                                "437edb9b-5df4-44f3-9fc6-1d0052b3297d": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Device Type",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "60a8e5dd-e24e-4494-b839-da383f2484f9",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "host.type"
                                                },
                                                "60a8e5dd-e24e-4494-b839-da383f2484f9": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": true,
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 0
                                                            }
                                                        }
                                                    },
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "6e332bea-d1ec-4479-84ec-b52332226a4f": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Observer Type",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "60a8e5dd-e24e-4494-b839-da383f2484f9",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 3
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "observer.type"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "40219299-d96a-4725-a046-807b4c1d3972",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "axisTitlesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "fittingFunction": "None",
                                "gridlinesVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "labelsOrientation": {
                                    "x": 0,
                                    "yLeft": 0,
                                    "yRight": 0
                                },
                                "layers": [
                                    {
                                        "accessors": [
                                            "60a8e5dd-e24e-4494-b839-da383f2484f9"
                                        ],
                                        "layerId": "06ee28b9-429b-42e8-a83b-3a3f4eb16745",
                                        "layerType": "data",
                                        "palette": {
                                            "name": "default",
                                            "type": "palette"
                                        },
                                        "seriesType": "bar_horizontal",
                                        "splitAccessor": "6e332bea-d1ec-4479-84ec-b52332226a4f",
                                        "xAccessor": "437edb9b-5df4-44f3-9fc6-1d0052b3297d",
                                        "yConfig": [
                                            {
                                                "color": "#54b399",
                                                "forAccessor": "60a8e5dd-e24e-4494-b839-da383f2484f9"
                                            }
                                        ]
                                    }
                                ],
                                "legend": {
                                    "isVisible": true,
                                    "position": "right"
                                },
                                "preferredSeriesType": "bar_horizontal",
                                "tickLabelsVisibilitySettings": {
                                    "x": true,
                                    "yLeft": true,
                                    "yRight": true
                                },
                                "valueLabels": "hide"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsXY"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 18,
                    "i": "de11f567-5bec-4717-a49c-98f6e34250e5",
                    "w": 20,
                    "x": 28,
                    "y": 28
                },
                "panelIndex": "de11f567-5bec-4717-a49c-98f6e34250e5",
                "title": "Distribution of Device Type by Device Category",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-673b5af9-08a7-4b42-83e5-627b2f1bfa6e",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "742728c6-cc98-4204-a3fa-65dda2935e22",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "673b5af9-08a7-4b42-83e5-627b2f1bfa6e": {
                                            "columnOrder": [
                                                "72c3d801-754e-4172-9bc6-10f51ab34110",
                                                "4d3ff440-84a4-4118-95bb-b5da7d406f3f"
                                            ],
                                            "columns": {
                                                "4d3ff440-84a4-4118-95bb-b5da7d406f3f": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "72c3d801-754e-4172-9bc6-10f51ab34110": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Certificate Issuer",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "4d3ff440-84a4-4118-95bb-b5da7d406f3f",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "m365_defender.event.issuer"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "742728c6-cc98-4204-a3fa-65dda2935e22",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "72c3d801-754e-4172-9bc6-10f51ab34110",
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "4d3ff440-84a4-4118-95bb-b5da7d406f3f",
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "673b5af9-08a7-4b42-83e5-627b2f1bfa6e",
                                "layerType": "data",
                                "rowHeight": "single",
                                "rowHeightLines": 1
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 15,
                    "i": "9c2c457e-9421-42e0-a162-011ea5beea7e",
                    "w": 20,
                    "x": 8,
                    "y": 46
                },
                "panelIndex": "9c2c457e-9421-42e0-a162-011ea5beea7e",
                "title": "Top 10 Certificate Issuer",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-75887628-a5d8-46fc-83f2-7f2341d66647",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "4c5dba88-1d1d-499d-999e-c8ee3078cbac",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "75887628-a5d8-46fc-83f2-7f2341d66647": {
                                            "columnOrder": [
                                                "7c9827d1-c527-4553-a520-eeda632e2ebb",
                                                "22456f06-a0fb-40e4-9849-c68f0d7eb120"
                                            ],
                                            "columns": {
                                                "22456f06-a0fb-40e4-9849-c68f0d7eb120": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "7c9827d1-c527-4553-a520-eeda632e2ebb": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Failure Reason",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "22456f06-a0fb-40e4-9849-c68f0d7eb120",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": false,
                                                        "size": 10
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "m365_defender.event.failure_reason"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "4c5dba88-1d1d-499d-999e-c8ee3078cbac",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "7c9827d1-c527-4553-a520-eeda632e2ebb",
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "22456f06-a0fb-40e4-9849-c68f0d7eb120",
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "75887628-a5d8-46fc-83f2-7f2341d66647",
                                "layerType": "data",
                                "rowHeight": "single",
                                "rowHeightLines": 1
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 15,
                    "i": "8dead8f3-eb81-4f31-80f3-6f839fd1e949",
                    "w": 20,
                    "x": 28,
                    "y": 46
                },
                "panelIndex": "8dead8f3-eb81-4f31-80f3-6f839fd1e949",
                "title": "Top 10 Failure Reason for Action Failed",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [
                            {
                                "id": "logs-*",
                                "name": "indexpattern-datasource-layer-8a8196f6-a696-4337-9a13-bbf9f8c796d5",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "99208529-678d-4c03-a45f-4d0848f8afb4",
                                "type": "index-pattern"
                            },
                            {
                                "id": "logs-*",
                                "name": "49888360-e306-4d83-9a96-a9941c1082b2",
                                "type": "index-pattern"
                            }
                        ],
                        "state": {
                            "adHocDataViews": {},
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "8a8196f6-a696-4337-9a13-bbf9f8c796d5": {
                                            "columnOrder": [
                                                "0cbc25e1-515c-4691-bca0-2fcf599c4744",
                                                "04877ea1-36c6-49ea-8150-dc864c4f1041"
                                            ],
                                            "columns": {
                                                "04877ea1-36c6-49ea-8150-dc864c4f1041": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count",
                                                    "operationType": "count",
                                                    "scale": "ratio",
                                                    "sourceField": "___records___"
                                                },
                                                "0cbc25e1-515c-4691-bca0-2fcf599c4744": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "OS Platform",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "04877ea1-36c6-49ea-8150-dc864c4f1041",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 5
                                                    },
                                                    "scale": "ordinal",
                                                    "sourceField": "host.os.platform"
                                                }
                                            },
                                            "incompleteColumns": {}
                                        }
                                    }
                                }
                            },
                            "filters": [
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "data_stream.dataset",
                                        "index": "99208529-678d-4c03-a45f-4d0848f8afb4",
                                        "key": "data_stream.dataset",
                                        "negate": false,
                                        "params": {
                                            "query": "m365_defender.event"
                                        },
                                        "type": "phrase"
                                    },
                                    "query": {
                                        "match_phrase": {
                                            "data_stream.dataset": "m365_defender.event"
                                        }
                                    }
                                },
                                {
                                    "$state": {
                                        "store": "appState"
                                    },
                                    "meta": {
                                        "alias": null,
                                        "disabled": false,
                                        "field": "m365_defender.event.category",
                                        "index": "49888360-e306-4d83-9a96-a9941c1082b2",
                                        "key": "m365_defender.event.category",
                                        "negate": false,
                                        "params": [
                                            "AdvancedHunting-DeviceEvents",
                                            "AdvancedHunting-DeviceFileCertificateInfo",
                                            "AdvancedHunting-DeviceFileEvents",
                                            "AdvancedHunting-DeviceImageLoadEvents",
                                            "AdvancedHunting-DeviceInfo",
                                            "AdvancedHunting-DeviceLogonEvents",
                                            "AdvancedHunting-DeviceNetworkEvents",
                                            "AdvancedHunting-DeviceNetworkInfo",
                                            "AdvancedHunting-DeviceProcessEvents",
                                            "AdvancedHunting-DeviceRegistryEvents"
                                        ],
                                        "type": "phrases",
                                        "value": [
                                            "AdvancedHunting-DeviceEvents",
                                            "AdvancedHunting-DeviceFileCertificateInfo",
                                            "AdvancedHunting-DeviceFileEvents",
                                            "AdvancedHunting-DeviceImageLoadEvents",
                                            "AdvancedHunting-DeviceInfo",
                                            "AdvancedHunting-DeviceLogonEvents",
                                            "AdvancedHunting-DeviceNetworkEvents",
                                            "AdvancedHunting-DeviceNetworkInfo",
                                            "AdvancedHunting-DeviceProcessEvents",
                                            "AdvancedHunting-DeviceRegistryEvents"
                                        ]
                                    },
                                    "query": {
                                        "bool": {
                                            "minimum_should_match": 1,
                                            "should": [
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileCertificateInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceFileEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceImageLoadEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceLogonEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceNetworkEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceNetworkInfo"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceProcessEvents"
                                                    }
                                                },
                                                {
                                                    "match_phrase": {
                                                        "m365_defender.event.category": "AdvancedHunting-DeviceRegistryEvents"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            "internalReferences": [],
                            "query": {
                                "language": "kuery",
                                "query": ""
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "layerId": "8a8196f6-a696-4337-9a13-bbf9f8c796d5",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "legendSize": "auto",
                                        "metrics": [
                                            "04877ea1-36c6-49ea-8150-dc864c4f1041"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "0cbc25e1-515c-4691-bca0-2fcf599c4744"
                                        ]
                                    }
                                ],
                                "shape": "pie"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 21,
                    "i": "a9117849-31e0-4fb5-8750-3545eb3cb61c",
                    "w": 17,
                    "x": 8,
                    "y": 61
                },
                "panelIndex": "a9117849-31e0-4fb5-8750-3545eb3cb61c",
                "title": "Distribution of Device Events by OS Platform",
                "type": "lens",
                "version": "8.7.1"
            },
            {
                "embeddableConfig": {
                    "enhancements": {},
                    "hidePanelTitles": false
                },
                "gridData": {
                    "h": 21,
                    "i": "74765bd4-91fc-4fc6-940b-86d66ba812ef",
                    "w": 23,
                    "x": 25,
                    "y": 61
                },
                "panelIndex": "74765bd4-91fc-4fc6-940b-86d66ba812ef",
                "panelRefName": "panel_74765bd4-91fc-4fc6-940b-86d66ba812ef",
                "title": "Endpoint Status",
                "type": "search",
                "version": "8.7.1"
            }
        ],
        "timeRestore": false,
        "title": "[Logs Microsoft 365 Defender] Device Events",
        "version": 1
    },
    "coreMigrationVersion": "8.7.1",
    "created_at": "2023-09-04T09:13:50.534Z",
    "id": "m365_defender-c0b796d0-720a-11ed-8657-c59f6ece834c",
    "migrationVersion": {
        "dashboard": "8.7.0"
    },
    "references": [
        {
            "id": "logs-*",
            "name": "eef7f556-05f9-4b08-bc1a-f87957c5919d:indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "eef7f556-05f9-4b08-bc1a-f87957c5919d:e7b0412d-2f44-423e-9b0a-897f2884c618",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "eef7f556-05f9-4b08-bc1a-f87957c5919d:a0dd3daf-229c-4ea3-b328-cfc256bc6364",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "d2da5421-b966-4fa6-9f0b-67cf5699fe07:indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "d2da5421-b966-4fa6-9f0b-67cf5699fe07:bb4c45e4-7cbb-43a7-acea-e064d71d78dd",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "d2da5421-b966-4fa6-9f0b-67cf5699fe07:1e2f916a-dbc2-40ef-817c-2f44e1a7a014",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "4cdcfcff-9592-43e6-abf5-cba2e4b82e1e:indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "4cdcfcff-9592-43e6-abf5-cba2e4b82e1e:28f49b0a-d5ff-4876-a5ae-407a013e33b2",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "4cdcfcff-9592-43e6-abf5-cba2e4b82e1e:fa186e74-e31b-46d0-b565-5aa2d8927af3",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "bdad135a-5476-4fa5-b9e2-49abeba859ab:indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "bdad135a-5476-4fa5-b9e2-49abeba859ab:1c359492-1f19-4eaa-8168-b69c0280046e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "bdad135a-5476-4fa5-b9e2-49abeba859ab:1898879e-99e7-472e-8eb0-1bcb24cd981e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "43d8b62e-e75c-4bd4-9803-6218cf8e4f28:indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "43d8b62e-e75c-4bd4-9803-6218cf8e4f28:8ea8e34b-c360-4515-8c9a-f74c86fe9d8b",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "43d8b62e-e75c-4bd4-9803-6218cf8e4f28:48d451bc-c265-48c3-ba55-e5b1aa37638b",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "570f73ac-a3af-48ee-849c-1b64e737b002:indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "570f73ac-a3af-48ee-849c-1b64e737b002:26f2a7e3-8f13-40e5-bce2-4b2dd3f08dc4",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "570f73ac-a3af-48ee-849c-1b64e737b002:17012638-69b0-481b-928e-50bc42099035",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "69254ab7-fc20-4db8-952e-76e4f2ffa4e9:indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "69254ab7-fc20-4db8-952e-76e4f2ffa4e9:953d90f0-317e-4df8-a189-000736037076",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "69254ab7-fc20-4db8-952e-76e4f2ffa4e9:4b2d8da6-d241-43ac-a9e0-4af12cbf58ff",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "0a439ec0-b0dd-41df-b1de-b761b68d6ffb:indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "0a439ec0-b0dd-41df-b1de-b761b68d6ffb:f2489da3-1ef2-46be-8809-45cd8fd6e08f",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "0a439ec0-b0dd-41df-b1de-b761b68d6ffb:5b88ee69-8299-4ca0-8684-4eb31dc7eca7",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7cd71879-68ac-454b-a135-c6bacac2d77f:indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7cd71879-68ac-454b-a135-c6bacac2d77f:2873ea87-14a2-4aa2-8031-3f5f778f28d1",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "7cd71879-68ac-454b-a135-c6bacac2d77f:70ce4539-c1d4-4b7f-b4f7-b1f460d0d699",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "12d3fd1a-bd2b-4612-84ba-aa2bb2060d78:indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "12d3fd1a-bd2b-4612-84ba-aa2bb2060d78:54cb0ac8-edd5-4b99-b467-4a5c49b87e05",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "12d3fd1a-bd2b-4612-84ba-aa2bb2060d78:36724591-c980-454c-a773-fa1b2591b218",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "3a2f0c3d-bd6d-44e4-b6c3-25d7f55dd608:indexpattern-datasource-layer-f76bb73e-d4b6-4fa1-9329-2e9942dd9eb4",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "3a2f0c3d-bd6d-44e4-b6c3-25d7f55dd608:5fbe60d0-db91-4d90-8078-74267201081b",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "de11f567-5bec-4717-a49c-98f6e34250e5:indexpattern-datasource-layer-06ee28b9-429b-42e8-a83b-3a3f4eb16745",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "de11f567-5bec-4717-a49c-98f6e34250e5:40219299-d96a-4725-a046-807b4c1d3972",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "9c2c457e-9421-42e0-a162-011ea5beea7e:indexpattern-datasource-layer-673b5af9-08a7-4b42-83e5-627b2f1bfa6e",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "9c2c457e-9421-42e0-a162-011ea5beea7e:742728c6-cc98-4204-a3fa-65dda2935e22",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8dead8f3-eb81-4f31-80f3-6f839fd1e949:indexpattern-datasource-layer-75887628-a5d8-46fc-83f2-7f2341d66647",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "8dead8f3-eb81-4f31-80f3-6f839fd1e949:4c5dba88-1d1d-499d-999e-c8ee3078cbac",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a9117849-31e0-4fb5-8750-3545eb3cb61c:indexpattern-datasource-layer-8a8196f6-a696-4337-9a13-bbf9f8c796d5",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a9117849-31e0-4fb5-8750-3545eb3cb61c:99208529-678d-4c03-a45f-4d0848f8afb4",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "a9117849-31e0-4fb5-8750-3545eb3cb61c:49888360-e306-4d83-9a96-a9941c1082b2",
            "type": "index-pattern"
        },
        {
            "id": "m365_defender-64a31410-722c-11ed-8657-c59f6ece834c",
            "name": "74765bd4-91fc-4fc6-940b-86d66ba812ef:panel_74765bd4-91fc-4fc6-940b-86d66ba812ef",
            "type": "search"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_007a099d-f3bc-4c46-a48e-629e06a614e4:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_d441e8a1-87f4-46b1-8dff-bf9bb88762d3:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_6fa76f5f-16ed-4419-8b16-fe5581d21067:optionsListDataView",
            "type": "index-pattern"
        },
        {
            "id": "logs-*",
            "name": "controlGroup_175fd1a8-7429-4e56-853b-057b124121de:optionsListDataView",
            "type": "index-pattern"
        }
    ],
    "type": "dashboard"
}