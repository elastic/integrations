rules:
  - path: /tenant_id/oauth2/v2.0/token
    methods: [POST]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"token_type":"Bearer","expires_in":3599,"ext_expires_in":3599,"access_token":"xxxx"}
  - path: /api/vulnerabilities/machinesVulnerabilities
    methods: ['GET']
    query_params:
      $top: 10000
      $skip: 0
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
        body: |
          {{ minify_json `
            {
              "@odata.context": "https://api.securitycenter.microsoft.com/api/$metadata#Collection(microsoft.windowsDefenderATP.api.PublicAssetVulnerabilityDto)",
              "@odata.count": 5,
              "value": [
                {
                  "id": "94819846155826828d1603b913c67fe336d81295-_-CVE-2025-3074-_-microsoft-_-edge_chromium-based-_-134.0.3124.72-_-",
                  "cveId": "CVE-2025-3074",
                  "machineId": "94819846155826828d1603b913c67fe336d81295",
                  "fixingKbId": null,
                  "productName": "edge_chromium-based",
                  "productVendor": "microsoft",
                  "productVersion": "134.0.3124.72",
                  "severity": "Medium"
                },
                {
                  "id": "c473dc518718ab3d14ced2bd0870665a533070e0-_-CVE-2025-3074-_-microsoft-_-edge_chromium-based-_-133.0.3065.92-_-",
                  "cveId": "CVE-2025-3074",
                  "machineId": "c473dc518718ab3d14ced2bd0870665a533070e0",
                  "fixingKbId": null,
                  "productName": "edge_chromium-based",
                  "productVendor": "microsoft",
                  "productVersion": "133.0.3065.92",
                  "severity": "Medium"
                },
                {
                  "id": "c4ca2eb56d52f0a9378d3265541ba02403b76d67-_-CVE-2025-3073-_-microsoft-_-edge_chromium-based-_-133.0.3065.92-_-",
                  "cveId": "CVE-2025-3073",
                  "machineId": "c4ca2eb56d52f0a9378d3265541ba02403b76d67",
                  "fixingKbId": null,
                  "productName": "edge_chromium-based",
                  "productVendor": "microsoft",
                  "productVersion": "133.0.3065.92",
                  "severity": "Medium"
                },
                {
                  "id": "c4ca2eb56d52f0a9378d3265541ba02403b76d67-_-CVE-2025-3073-_-google-_-chrome-_-134.0.6998.118-_-",
                  "cveId": "CVE-2025-3073",
                  "machineId": "c4ca2eb56d52f0a9378d3265541ba02403b76d67",
                  "fixingKbId": null,
                  "productName": "chrome",
                  "productVendor": "google",
                  "productVersion": "134.0.6998.118",
                  "severity": "Medium"
                },
                {
                  "id": "6825811b97340ed50d858e6285c7a7878248ca75-_-CVE-2025-26635-_-microsoft-_-windows_10-_-10.0.19045.5011-_-5055518",
                  "cveId": "CVE-2025-26635",
                  "machineId": "6825811b97340ed50d858e6285c7a7878248ca75",
                  "fixingKbId": "5055518",
                  "productName": "windows_10",
                  "productVendor": "microsoft",
                  "productVersion": "10.0.19045.5011",
                  "severity": "Medium"
                }
              ]
            }            
          `}}
  - path: /api/machines
    methods: ['GET']
    query_params:
      $top: 10000
      $skip: 0
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
        body: |
          {{ minify_json `
            {
              "@odata.context": "https://api.securitycenter.microsoft.com/api/$metadata#Machines",
              "value": [
                {
                  "id": "94819846155826828d1603b913c67fe336d81295",
                  "mergedIntoMachineId": null,
                  "isPotentialDuplication": false,
                  "isExcluded": false,
                  "exclusionReason": null,
                  "computerDnsName": "bdp3449-ub20-2-4a4f31e2-46ea-4c26-ad89-f09ad1d5fe01",
                  "firstSeen": "2025-01-08T13:05:05.3483549Z",
                  "lastSeen": "2025-01-08T13:15:03.694371Z",
                  "osPlatform": "Ubuntu",
                  "osVersion": null,
                  "osProcessor": "x64",
                  "version": "20.4",
                  "lastIpAddress": "175.16.199.0",
                  "lastExternalIpAddress": "1.128.0.0",
                  "agentVersion": "30.124092.2.0",
                  "osBuild": 6,
                  "healthStatus": "Inactive",
                  "deviceValue": "Normal",
                  "rbacGroupId": 0,
                  "rbacGroupName": null,
                  "riskScore": "None",
                  "exposureLevel": "Low",
                  "isAadJoined": false,
                  "aadDeviceId": null,
                  "machineTags": ["test tag"],
                  "onboardingStatus": "Onboarded",
                  "osArchitecture": "64-bit",
                  "managedBy": "MicrosoftDefenderForEndpoint",
                  "managedByStatus": "Success",
                  "ipAddresses": [
                    {
                      "ipAddress": "216.160.83.56",
                      "macAddress": "000C2910F1DA",
                      "type": "Other",
                      "operationalStatus": "Up"
                    }
                  ],
                  "vmMetadata": null
                },
                {
                  "id": "c473dc518718ab3d14ced2bd0870665a533070e0",
                  "mergedIntoMachineId": null,
                  "isPotentialDuplication": false,
                  "isExcluded": false,
                  "exclusionReason": null,
                  "computerDnsName": "bdp3449-ub20-2-a415f17e-ce8d-4ce2-a8b4-83b674e7017e",
                  "firstSeen": "2025-01-09T20:29:06.2413437Z",
                  "lastSeen": "2025-01-09T20:57:23.4538904Z",
                  "osPlatform": "Ubuntu",
                  "osVersion": null,
                  "osProcessor": "x64",
                  "version": "20.4",
                  "lastIpAddress": "81.2.69.142",
                  "lastExternalIpAddress": "81.2.69.144",
                  "agentVersion": "30.124092.2.0",
                  "osBuild": 6,
                  "healthStatus": "Inactive",
                  "deviceValue": "Normal",
                  "rbacGroupId": 0,
                  "rbacGroupName": null,
                  "riskScore": "None",
                  "exposureLevel": "Low",
                  "isAadJoined": false,
                  "aadDeviceId": null,
                  "machineTags": [],
                  "onboardingStatus": "Onboarded",
                  "osArchitecture": "64-bit",
                  "managedBy": "MicrosoftDefenderForEndpoint",
                  "managedByStatus": "Success",
                  "ipAddresses": [
                    {
                      "ipAddress": "81.2.69.192",
                      "macAddress": "000C2910F1DA",
                      "type": "Other",
                      "operationalStatus": "Up"
                    },
                    {
                      "ipAddress": "2a02:cf40::",
                      "macAddress": "000C2910F1DA",
                      "type": "Other",
                      "operationalStatus": "Up"
                    }
                  ],
                  "vmMetadata": null
                },
                {
                  "id": "c4ca2eb56d52f0a9378d3265541ba02403b76d67",
                  "mergedIntoMachineId": null,
                  "isPotentialDuplication": false,
                  "isExcluded": false,
                  "exclusionReason": null,
                  "computerDnsName": "bdp3449-ub20-2-1602ff76-ed7f-4c94-b550-2f727b4782d4",
                  "firstSeen": "2025-01-09T14:01:35.8022227Z",
                  "lastSeen": "2025-01-09T14:22:34.8819165Z",
                  "osPlatform": "Ubuntu",
                  "osVersion": null,
                  "osProcessor": "x64",
                  "version": "20.4",
                  "lastIpAddress": "81.2.69.192",
                  "lastExternalIpAddress": "89.160.20.112",
                  "agentVersion": "30.124092.2.0",
                  "osBuild": 6,
                  "healthStatus": "Inactive",
                  "deviceValue": "Normal",
                  "rbacGroupId": 0,
                  "rbacGroupName": null,
                  "riskScore": "None",
                  "exposureLevel": "Low",
                  "isAadJoined": false,
                  "aadDeviceId": null,
                  "machineTags": [],
                  "onboardingStatus": "Onboarded",
                  "osArchitecture": "64-bit",
                  "managedBy": "MicrosoftDefenderForEndpoint",
                  "managedByStatus": "Success",
                  "ipAddresses": [
                    {
                      "ipAddress": "81.2.69.192",
                      "macAddress": "000C2910F1DA",
                      "type": "Other",
                      "operationalStatus": "Up"
                    },
                    {
                      "ipAddress": "2a02:cf40::",
                      "macAddress": "000C2910F1DA",
                      "type": "Other",
                      "operationalStatus": "Up"
                    }
                  ],
                  "vmMetadata": null
                },
                {
                  "id": "6825811b97340ed50d858e6285c7a7878248ca75",
                  "mergedIntoMachineId": null,
                  "isPotentialDuplication": false,
                  "isExcluded": false,
                  "exclusionReason": null,
                  "computerDnsName": "bdp3449-ub20-2-ab4d04af-68dc-4fee-9c16-6545265b3276",
                  "firstSeen": "2025-01-09T06:29:21.587607Z",
                  "lastSeen": "2025-01-09T06:56:38.3119183Z",
                  "osPlatform": "Ubuntu",
                  "osVersion": null,
                  "osProcessor": "x64",
                  "version": "20.4",
                  "lastIpAddress": "81.2.69.192",
                  "lastExternalIpAddress": "89.160.20.112",
                  "agentVersion": "30.124092.2.0",
                  "osBuild": 6,
                  "healthStatus": "Inactive",
                  "deviceValue": "Normal",
                  "rbacGroupId": 0,
                  "rbacGroupName": null,
                  "riskScore": "Medium",
                  "exposureLevel": "Low",
                  "isAadJoined": false,
                  "aadDeviceId": null,
                  "machineTags": ["test"],
                  "onboardingStatus": "Onboarded",
                  "osArchitecture": "64-bit",
                  "managedBy": "MicrosoftDefenderForEndpoint",
                  "managedByStatus": "Success",
                  "ipAddresses": [
                    {
                      "ipAddress": "81.2.69.192",
                      "macAddress": "000C2910F1DA",
                      "type": "Other",
                      "operationalStatus": "Up"
                    }
                  ],
                  "vmMetadata": null
                },
                {
                  "id": "08a037be5ffcf0e85c0817a202a95e86dbb65124",
                  "mergedIntoMachineId": null,
                  "isPotentialDuplication": false,
                  "isExcluded": false,
                  "exclusionReason": null,
                  "computerDnsName": "bdp3449-ub20-2-3a95cdb2-c6ea-4761-b24e-02b71889b8bb",
                  "firstSeen": "2025-01-09T07:29:19.0754397Z",
                  "lastSeen": "2025-01-09T07:54:33.335749Z",
                  "osPlatform": "Ubuntu",
                  "osVersion": null,
                  "osProcessor": "x64",
                  "version": "20.4",
                  "lastIpAddress": "67.43.156.0",
                  "lastExternalIpAddress": "175.16.199.0",
                  "agentVersion": "30.124092.2.0",
                  "osBuild": 6,
                  "healthStatus": "Inactive",
                  "deviceValue": "Normal",
                  "rbacGroupId": 0,
                  "rbacGroupName": null,
                  "riskScore": "High",
                  "exposureLevel": "Low",
                  "isAadJoined": false,
                  "aadDeviceId": null,
                  "machineTags": [],
                  "onboardingStatus": "Onboarded",
                  "osArchitecture": "64-bit",
                  "managedBy": "MicrosoftDefenderForEndpoint",
                  "managedByStatus": "Success",
                  "ipAddresses": [
                    {
                      "ipAddress": "67.43.156.0",
                      "macAddress": "000C2910F1DA",
                      "type": "Other",
                      "operationalStatus": "Up"
                    }
                  ],
                  "vmMetadata": null
                }
              ]
            }
          `}}
  - path: /api/vulnerabilities
    methods: ['GET']
    query_params:
      $top: 2
      $skip: 0
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
        body: | 
          {{ minify_json `
            {
              "@odata.context": "https://api.securitycenter.microsoft.com/api/$metadata#Vulnerabilities",
              "@odata.count": 2,
              "value": [
                {
                  "id": "CVE-2025-3074",
                  "name": "CVE-2025-3074",
                  "description": "Summary: An inappropriate implementation in the Downloads feature of Google Chrome versions prior to 135.0.7049.52 could allow a remote attacker to perform UI spoofing via a crafted HTML page. This vulnerability, classified with a low severity by Chromium, may also enable bypassing security restrictions when a victim visits a specially crafted website. Impact: Exploitation of this vulnerability could lead to UI spoofing or bypassing security restrictions, potentially compromising user trust and security. AdditionalInformation: This vulnerability is associated with Google Chrome and has implications for Microsoft Edge (Chromium-based) due to shared code ingestion. Refer to Google Chrome Releases for further details. Remediation: Apply the latest patches and updates provided by the respective vendors. [Generated by AI]",
                  "severity": "Medium",
                  "cvssV3": 6.5,
                  "cvssVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C",
                  "exposedMachines": 2,
                  "publishedOn": "2025-04-01T00:00:00Z",
                  "updatedOn": "2025-04-08T00:00:00Z",
                  "firstDetected": "2025-04-01T19:52:39Z",
                  "patchFirstAvailable": null,
                  "publicExploit": false,
                  "exploitVerified": false,
                  "exploitInKit": false,
                  "exploitTypes": [],
                  "exploitUris": [],
                  "cveSupportability": "Supported",
                  "tags": ["test"],
                  "epss": 0.00111
                },
                {
                  "id": "CVE-2025-3073",
                  "name": "CVE-2025-3073",
                  "description": "Summary: An inappropriate implementation in the Autofill feature of Google Chrome versions prior to 135.0.7049.52 allows a remote attacker to perform UI spoofing by convincing a user to interact with a crafted HTML page. This vulnerability is categorized with a Chromium security severity rating of Low. Impact: Exploitation of this vulnerability could enable an attacker to bypass security restrictions, potentially leading to unauthorized actions or data exposure. AdditionalInformation: This vulnerability is also relevant to Microsoft Edge (Chromium-based), as it ingests Chromium. Refer to Google Chrome Releases for further details. Remediation: Apply the latest patches and updates provided by the respective vendors. [Generated by AI]",
                  "severity": "Medium",
                  "cvssV3": 6.5,
                  "cvssVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N/E:U/RL:O/RC:C",
                  "exposedMachines": 1,
                  "publishedOn": "2025-04-01T00:00:00Z",
                  "updatedOn": "2025-04-08T00:00:00Z",
                  "firstDetected": "2025-04-01T19:52:39Z",
                  "patchFirstAvailable": null,
                  "publicExploit": false,
                  "exploitVerified": false,
                  "exploitInKit": false,
                  "exploitTypes": [],
                  "exploitUris": [],
                  "cveSupportability": "Supported",
                  "tags": ["test"],
                  "epss": 0.00111
                }
              ]
            }
          `}}
  - path: /api/vulnerabilities
    methods: ['GET']
    query_params:
      $top: 2
      $skip: 2
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
        body: | 
          {{ minify_json `
            {
              "@odata.context": "https://api.securitycenter.microsoft.com/api/$metadata#Vulnerabilities",
              "@odata.count": 2,
              "value": [
                {
                  "id": "CVE-2025-26635",
                  "name": "CVE-2025-26635",
                  "description": "Summary: A vulnerability in Windows Hellos authentication mechanism permits an authorized attacker to bypass its security feature remotely over a network. Impact: Exploitation of this vulnerability could allow unauthorized access to systems, potentially leading to data breaches or further network compromise. Remediation: Apply the latest patches and updates provided by the respective vendors. [Generated by AI]",
                  "severity": "Medium",
                  "cvssV3": 6.5,
                  "cvssVector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N/E:U/RL:O/RC:C",
                  "exposedMachines": 1,
                  "publishedOn": "2025-04-08T07:00:00Z",
                  "updatedOn": "2025-04-09T20:03:01.577Z",
                  "firstDetected": "2025-04-08T18:00:48Z",
                  "patchFirstAvailable": null,
                  "publicExploit": false,
                  "exploitVerified": false,
                  "exploitInKit": false,
                  "exploitTypes": [],
                  "exploitUris": [],
                  "cveSupportability": "Supported",
                  "tags": [],
                  "epss": 0.00052
                },
                {
                  "id": "CVE-2025-3437",
                  "name": "CVE-2025-3437",
                  "description": "Summary: The Motors – Car Dealership &amp; Classified Listings Plugin for WordPress contains a vulnerability in its ajax_actions.php file, where several functions lack proper capability checks. This flaw exists in all versions up to and including 1.4.66, allowing authenticated attackers with Subscriber-level access or higher to perform unauthorized data modifications. Impact: Exploitation of this vulnerability could lead to unauthorized changes to the plugins setup, potentially compromising the integrity of the affected WordPress site. Remediation: Upgrade to a version of Stylemixthemes Motors - Car Dealer, Classifieds &amp; Listing later than 1.4.66. [Generated by AI]",
                  "severity": "Medium",
                  "cvssV3": 4.3,
                  "cvssVector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N",
                  "exposedMachines": 0,
                  "publishedOn": "2025-04-08T10:15:19.413Z",
                  "updatedOn": "2025-04-08T18:13:53.347Z",
                  "firstDetected": null,
                  "patchFirstAvailable": null,
                  "publicExploit": false,
                  "exploitVerified": false,
                  "exploitInKit": false,
                  "exploitTypes": [],
                  "exploitUris": [],
                  "cveSupportability": "NotSupported",
                  "tags": [],
                  "epss": 0.00025
                }
              ]
            }
          `}}
  - path: /api/vulnerabilities
    methods: ['GET']
    query_params:
      $top: 2
      $skip: 4
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
        body: | 
          {{ minify_json `
            {
              "@odata.context": "https://api.securitycenter.microsoft.com/api/$metadata#Vulnerabilities",
              "@odata.count": 0,
              "value": []
            }
          `}}
  