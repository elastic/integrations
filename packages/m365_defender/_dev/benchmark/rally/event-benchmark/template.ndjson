{{- $Tenant := generate "Tenant" }}
{{- $category := generate "category" }}
{{- $operationName := generate "operationName" }}
{{- $propertiesTimestamp := generate "properties.Timestamp" | date "2006-01-02T15:04:05.000000Z" }}
{{- $propertiesTargetdevicename := generate "properties.TargetDeviceName" }}
{{- $propertiesDestinationipaddress := generate "properties.DestinationIPAddress" }}
{{- $propertiesDestinationport := generate "properties.DestinationPort" }}
{{- $propertiesDevicename := generate "properties.DeviceName" }}
{{- $propertiesIpaddress := generate "properties.IPAddress" }}
{{- $propertiesOsplatform := generate "properties.OSPlatform" }}
{{- $propertiesDevicetype := generate "properties.DeviceType" }}
{{- $propertiesProtocol := generate "properties.Protocol" }}
{{- $propertiesAccountdomain := generate "properties.AccountDomain" }}
{{- $propertiesAccountsid := generate "properties.AccountSid" }}
{{- $propertiesAccountname := generate "properties.AccountName" }}
{{- $propertiesAccountdisplayname := generate "properties.AccountDisplayName" }}
{{- $propertiesAccountobjectid := generate "properties.AccountObjectId" }}
{{- $propertiesAccountupn := generate "properties.AccountUpn" }}
{{- $propertiesActiontype := generate "properties.ActionType" }}
{{- $propertiesAdditionalfields := generate "properties.AdditionalFields" }}
{{- $propertiesApplication := generate "properties.Application" }}
{{- $propertiesDestinationdevicename := generate "properties.DestinationDeviceName" }}
{{- $propertiesFailurereason := generate "properties.FailureReason" }}
{{- $propertiesIsp := generate "properties.Isp" }}
{{- $propertiesLocation := generate "properties.Location" }}
{{- $propertiesLogontype := generate "properties.LogonType" }}
{{- $propertiesPort := generate "properties.Port" }}
{{- $propertiesReportid := generate "properties.ReportId" }}
{{- $propertiesTargetaccountdisplayname := generate "properties.TargetAccountDisplayName" }}
{{- $propertiesIsadminoperation := generate "properties.IsAdminOperation" }}
{{- $propertiesQuery := generate "properties.Query" }}
{{- $propertiesQuerytarget := generate "properties.QueryTarget" }}
{{- $propertiesQuerytype := generate "properties.QueryType" }}
{{- $propertiesTargetaccountupn := generate "properties.TargetAccountUpn" }}
{{- $propertiesIsp := generate "properties.ISP" }}
{{- $propertiesAccountid := generate "properties.AccountId" }}
{{- $propertiesAccounttype := generate "properties.AccountType" }}
{{- $propertiesActivityobjects := generate "properties.ActivityObjects" }}
{{- $propertiesActivitytype := generate "properties.ActivityType" }}
{{- $propertiesAppinstanceid := generate "properties.AppInstanceId" }}
{{- $propertiesApplicationid := generate "properties.ApplicationId" }}
{{- $propertiesCity := generate "properties.City" }}
{{- $propertiesCountrycode := generate "properties.CountryCode" }}
{{- $propertiesIpcategory := generate "properties.IPCategory" }}
{{- $propertiesIptags := generate "properties.IPTags" }}
{{- $propertiesIsanonymousproxy := generate "properties.IsAnonymousProxy" }}
{{- $propertiesIsexternaluser := generate "properties.IsExternalUser" }}
{{- $propertiesIsimpersonated := generate "properties.IsImpersonated" }}
{{- $propertiesObjectid := generate "properties.ObjectId" }}
{{- $propertiesObjectname := generate "properties.ObjectName" }}
{{- $propertiesObjecttype := generate "properties.ObjectType" }}
{{- $propertiesRaweventdataChatthreadid := generate "properties.RawEventData.ChatThreadId" }}
{{- $propertiesRaweventdataCommunicationtype := generate "properties.RawEventData.CommunicationType" }}
{{- $propertiesRaweventdataCreationtime := generate "properties.RawEventData.CreationTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $propertiesRaweventdataExtraproperties := generate "properties.RawEventData.ExtraProperties" }}
{{- $propertiesRaweventdataId := generate "properties.RawEventData.Id" }}
{{- $propertiesRaweventdataItemname := generate "properties.RawEventData.ItemName" }}
{{- $propertiesRaweventdataMessageid := generate "properties.RawEventData.MessageId" }}
{{- $propertiesRaweventdataMessageversion := generate "properties.RawEventData.MessageVersion" }}
{{- $propertiesRaweventdataMessagevisibilitytime := generate "properties.RawEventData.MessageVisibilityTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $propertiesRaweventdataOperation := generate "properties.RawEventData.Operation" }}
{{- $propertiesRaweventdataOrganizationid := generate "properties.RawEventData.OrganizationId" }}
{{- $propertiesRaweventdataParticipantinfoHasforeigntenantusers := generate "properties.RawEventData.ParticipantInfo.HasForeignTenantUsers" }}
{{- $propertiesRaweventdataParticipantinfoHasguestusers := generate "properties.RawEventData.ParticipantInfo.HasGuestUsers" }}
{{- $propertiesRaweventdataParticipantinfoHasotherguestusers := generate "properties.RawEventData.ParticipantInfo.HasOtherGuestUsers" }}
{{- $propertiesRaweventdataParticipantinfoHasunauthenticatedusers := generate "properties.RawEventData.ParticipantInfo.HasUnauthenticatedUsers" }}
{{- $propertiesRaweventdataParticipantinfoParticipatingdomains := generate "properties.RawEventData.ParticipantInfo.ParticipatingDomains" }}
{{- $propertiesRaweventdataParticipantinfoParticipatingsipdomains := generate "properties.RawEventData.ParticipantInfo.ParticipatingSIPDomains" }}
{{- $propertiesRaweventdataParticipantinfoParticipatingtenantids := generate "properties.RawEventData.ParticipantInfo.ParticipatingTenantIds" }}
{{- $propertiesRaweventdataRecordtype := generate "properties.RawEventData.RecordType" }}
{{- $propertiesRaweventdataResourcetenantid := generate "properties.RawEventData.ResourceTenantId" }}
{{- $propertiesRaweventdataUserid := generate "properties.RawEventData.UserId" }}
{{- $propertiesRaweventdataUserkey := generate "properties.RawEventData.UserKey" }}
{{- $propertiesRaweventdataUsertype := generate "properties.RawEventData.UserType" }}
{{- $propertiesRaweventdataVersion := generate "properties.RawEventData.Version" }}
{{- $propertiesRaweventdataWorkload := generate "properties.RawEventData.Workload" }}
{{- $propertiesUseragent := generate "properties.UserAgent" }}
{{- $propertiesUseragenttags := generate "properties.UserAgentTags" }}
{{- $propertiesAddress := generate "properties.Address" }}
{{- $propertiesBlastradius := generate "properties.BlastRadius" }}
{{- $propertiesChangesource := generate "properties.ChangeSource" }}
{{- $propertiesCloudsid := generate "properties.CloudSid" }}
{{- $propertiesCompanyname := generate "properties.CompanyName" }}
{{- $propertiesCountry := generate "properties.Country" }}
{{- $propertiesCreateddatetime := generate "properties.CreatedDateTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $propertiesCriticalitylevel := generate "properties.CriticalityLevel" }}
{{- $propertiesDeleteddatetime := generate "properties.DeletedDateTime" }}
{{- $propertiesDepartment := generate "properties.Department" }}
{{- $propertiesDistinguishedname := generate "properties.DistinguishedName" }}
{{- $propertiesEmailaddress := generate "properties.EmailAddress" }}
{{- $propertiesEmployeeid := generate "properties.EmployeeId" }}
{{- $propertiesGivenname := generate "properties.GivenName" }}
{{- $propertiesIsaccountenabled := generate "properties.IsAccountEnabled" }}
{{- $propertiesJobtitle := generate "properties.JobTitle" }}
{{- $propertiesManager := generate "properties.Manager" }}
{{- $propertiesOnpremsid := generate "properties.OnPremSid" }}
{{- $propertiesOthermailaddresses := generate "properties.OtherMailAddresses" }}
{{- $propertiesPhone := generate "properties.Phone" }}
{{- $propertiesRisklevel := generate "properties.RiskLevel" }}
{{- $propertiesRiskleveldetails := generate "properties.RiskLevelDetails" }}
{{- $propertiesSipproxyaddress := generate "properties.SipProxyAddress" }}
{{- $propertiesSourceprovider := generate "properties.SourceProvider" }}
{{- $propertiesState := generate "properties.State" }}
{{- $propertiesSurname := generate "properties.Surname" }}
{{- $propertiesTags := generate "properties.Tags" }}
{{- $propertiesType := generate "properties.Type" }}
{{- $propertiesAuditsource := generate "properties.AuditSource" }}
{{- $propertiesLastseenforuser := generate "properties.LastSeenForUser" }}
{{- $propertiesOauthappid := generate "properties.OAuthAppId" }}
{{- $propertiesSessiondata := generate "properties.SessionData" }}
{{- $propertiesUncommonforuser := generate "properties.UncommonForUser" }}
{{- $propertiesAlertid := generate "properties.AlertId" }}
{{- $propertiesDeviceid := generate "properties.DeviceId" }}
{{- $propertiesEmailsubject := generate "properties.EmailSubject" }}
{{- $propertiesEntitytype := generate "properties.EntityType" }}
{{- $propertiesEvidencedirection := generate "properties.EvidenceDirection" }}
{{- $propertiesEvidencerole := generate "properties.EvidenceRole" }}
{{- $propertiesFilename := generate "properties.FileName" }}
{{- $propertiesFilesize := generate "properties.FileSize" }}
{{- $propertiesFolderpath := generate "properties.FolderPath" }}
{{- $propertiesLocalip := generate "properties.LocalIP" }}
{{- $propertiesMachinegroup := generate "properties.MachineGroup" }}
{{- $propertiesNetworkmessageid := generate "properties.NetworkMessageId" }}
{{- $propertiesOauthapplicationid := generate "properties.OAuthApplicationId" }}
{{- $propertiesProcesscommandline := generate "properties.ProcessCommandLine" }}
{{- $propertiesRegistrykey := generate "properties.RegistryKey" }}
{{- $propertiesRegistryvaluedata := generate "properties.RegistryValueData" }}
{{- $propertiesRegistryvaluename := generate "properties.RegistryValueName" }}
{{- $propertiesRemoteip := generate "properties.RemoteIP" }}
{{- $propertiesRemoteurl := generate "properties.RemoteUrl" }}
{{- $propertiesSha1 := generate "properties.SHA1" }}
{{- $propertiesSha256 := generate "properties.SHA256" }}
{{- $propertiesServicesource := generate "properties.ServiceSource" }}
{{- $propertiesThreatfamily := generate "properties.ThreatFamily" }}
{{- $propertiesAttacktechniques := generate "properties.AttackTechniques" }}
{{- $propertiesCategory := generate "properties.Category" }}
{{- $propertiesDetectionsource := generate "properties.DetectionSource" }}
{{- $propertiesSeverity := generate "properties.Severity" }}
{{- $propertiesTitle := generate "properties.Title" }}
{{- $propertiesAppguardcontainerid := generate "properties.AppGuardContainerId" }}
{{- $propertiesCreatedprocesssessionid := generate "properties.CreatedProcessSessionId" }}
{{- $propertiesInitiatingprocessaccountdomain := generate "properties.InitiatingProcessAccountDomain" }}
{{- $propertiesInitiatingprocessaccountname := generate "properties.InitiatingProcessAccountName" }}
{{- $propertiesInitiatingprocessaccountobjectid := generate "properties.InitiatingProcessAccountObjectId" }}
{{- $propertiesInitiatingprocessaccountsid := generate "properties.InitiatingProcessAccountSid" }}
{{- $propertiesInitiatingprocessaccountupn := generate "properties.InitiatingProcessAccountUpn" }}
{{- $propertiesInitiatingprocesscommandline := generate "properties.InitiatingProcessCommandLine" }}
{{- $propertiesInitiatingprocesscreationtime := generate "properties.InitiatingProcessCreationTime" }}
{{- $propertiesInitiatingprocessfilename := generate "properties.InitiatingProcessFileName" }}
{{- $propertiesInitiatingprocessfilesize := generate "properties.InitiatingProcessFileSize" }}
{{- $propertiesInitiatingprocessfolderpath := generate "properties.InitiatingProcessFolderPath" }}
{{- $propertiesInitiatingprocessid := generate "properties.InitiatingProcessId" }}
{{- $propertiesInitiatingprocessintegritylevel := generate "properties.InitiatingProcessIntegrityLevel" }}
{{- $propertiesInitiatingprocesslogonid := generate "properties.InitiatingProcessLogonId" }}
{{- $propertiesInitiatingprocessmd5 := generate "properties.InitiatingProcessMD5" }}
{{- $propertiesInitiatingprocessparentcreationtime := generate "properties.InitiatingProcessParentCreationTime" }}
{{- $propertiesInitiatingprocessparentfilename := generate "properties.InitiatingProcessParentFileName" }}
{{- $propertiesInitiatingprocessparentid := generate "properties.InitiatingProcessParentId" }}
{{- $propertiesInitiatingprocessremotesessiondevicename := generate "properties.InitiatingProcessRemoteSessionDeviceName" }}
{{- $propertiesInitiatingprocessremotesessionip := generate "properties.InitiatingProcessRemoteSessionIP" }}
{{- $propertiesInitiatingprocesssha1 := generate "properties.InitiatingProcessSHA1" }}
{{- $propertiesInitiatingprocesssha256 := generate "properties.InitiatingProcessSHA256" }}
{{- $propertiesInitiatingprocesssessionid := generate "properties.InitiatingProcessSessionId" }}
{{- $propertiesInitiatingprocesssignaturestatus := generate "properties.InitiatingProcessSignatureStatus" }}
{{- $propertiesInitiatingprocesssignertype := generate "properties.InitiatingProcessSignerType" }}
{{- $propertiesInitiatingprocesstokenelevation := generate "properties.InitiatingProcessTokenElevation" }}
{{- $propertiesInitiatingprocessversioninfocompanyname := generate "properties.InitiatingProcessVersionInfoCompanyName" }}
{{- $propertiesInitiatingprocessversioninfofiledescription := generate "properties.InitiatingProcessVersionInfoFileDescription" }}
{{- $propertiesInitiatingprocessversioninfointernalfilename := generate "properties.InitiatingProcessVersionInfoInternalFileName" }}
{{- $propertiesInitiatingprocessversioninfooriginalfilename := generate "properties.InitiatingProcessVersionInfoOriginalFileName" }}
{{- $propertiesInitiatingprocessversioninfoproductname := generate "properties.InitiatingProcessVersionInfoProductName" }}
{{- $propertiesInitiatingprocessversioninfoproductversion := generate "properties.InitiatingProcessVersionInfoProductVersion" }}
{{- $propertiesIsinitiatingprocessremotesession := generate "properties.IsInitiatingProcessRemoteSession" }}
{{- $propertiesIsprocessremotesession := generate "properties.IsProcessRemoteSession" }}
{{- $propertiesLogonid := generate "properties.LogonId" }}
{{- $propertiesMd5 := generate "properties.MD5" }}
{{- $propertiesProcesscreationtime := generate "properties.ProcessCreationTime" }}
{{- $propertiesProcessid := generate "properties.ProcessId" }}
{{- $propertiesProcessintegritylevel := generate "properties.ProcessIntegrityLevel" }}
{{- $propertiesProcessremotesessiondevicename := generate "properties.ProcessRemoteSessionDeviceName" }}
{{- $propertiesProcessremotesessionip := generate "properties.ProcessRemoteSessionIP" }}
{{- $propertiesProcesstokenelevation := generate "properties.ProcessTokenElevation" }}
{{- $propertiesProcessversioninfocompanyname := generate "properties.ProcessVersionInfoCompanyName" }}
{{- $propertiesProcessversioninfofiledescription := generate "properties.ProcessVersionInfoFileDescription" }}
{{- $propertiesProcessversioninfointernalfilename := generate "properties.ProcessVersionInfoInternalFileName" }}
{{- $propertiesProcessversioninfooriginalfilename := generate "properties.ProcessVersionInfoOriginalFileName" }}
{{- $propertiesProcessversioninfoproductname := generate "properties.ProcessVersionInfoProductName" }}
{{- $propertiesProcessversioninfoproductversion := generate "properties.ProcessVersionInfoProductVersion" }}
{{- $propertiesFileoriginip := generate "properties.FileOriginIP" }}
{{- $propertiesFileoriginurl := generate "properties.FileOriginUrl" }}
{{- $propertiesLocalport := generate "properties.LocalPort" }}
{{- $propertiesRemotedevicename := generate "properties.RemoteDeviceName" }}
{{- $propertiesRemoteport := generate "properties.RemotePort" }}
{{- $propertiesCertificatecountersignaturetime := generate "properties.CertificateCountersignatureTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $propertiesCertificatecreationtime := generate "properties.CertificateCreationTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $propertiesCertificateexpirationtime := generate "properties.CertificateExpirationTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $propertiesCertificateserialnumber := generate "properties.CertificateSerialNumber" }}
{{- $propertiesCrldistributionpointurls := generate "properties.CrlDistributionPointUrls" }}
{{- $propertiesIsrootsignermicrosoft := generate "properties.IsRootSignerMicrosoft" }}
{{- $propertiesIssigned := generate "properties.IsSigned" }}
{{- $propertiesIstrusted := generate "properties.IsTrusted" }}
{{- $propertiesIssuer := generate "properties.Issuer" }}
{{- $propertiesIssuerhash := generate "properties.IssuerHash" }}
{{- $propertiesSignaturetype := generate "properties.SignatureType" }}
{{- $propertiesSigner := generate "properties.Signer" }}
{{- $propertiesSignerhash := generate "properties.SignerHash" }}
{{- $propertiesFileoriginreferrerurl := generate "properties.FileOriginReferrerUrl" }}
{{- $propertiesIsazureinfoprotectionapplied := generate "properties.IsAzureInfoProtectionApplied" }}
{{- $propertiesPreviousfilename := generate "properties.PreviousFileName" }}
{{- $propertiesPreviousfolderpath := generate "properties.PreviousFolderPath" }}
{{- $propertiesRequestaccountdomain := generate "properties.RequestAccountDomain" }}
{{- $propertiesRequestaccountname := generate "properties.RequestAccountName" }}
{{- $propertiesRequestaccountsid := generate "properties.RequestAccountSid" }}
{{- $propertiesRequestprotocol := generate "properties.RequestProtocol" }}
{{- $propertiesRequestsourceip := generate "properties.RequestSourceIP" }}
{{- $propertiesRequestsourceport := generate "properties.RequestSourcePort" }}
{{- $propertiesSensitivitylabel := generate "properties.SensitivityLabel" }}
{{- $propertiesSensitivitysublabel := generate "properties.SensitivitySubLabel" }}
{{- $propertiesSharename := generate "properties.ShareName" }}
{{- $propertiesAaddeviceid := generate "properties.AadDeviceId" }}
{{- $propertiesAssetvalue := generate "properties.AssetValue" }}
{{- $propertiesIsinternetfacing := generate "properties.IsInternetFacing" }}
{{- $propertiesDevicemanualtags := generate "properties.DeviceManualTags" }}
{{- $propertiesDevicedynamictags := generate "properties.DeviceDynamicTags" }}
{{- $propertiesExposurelevel := generate "properties.ExposureLevel" }}
{{- $propertiesSensorhealthstate := generate "properties.SensorHealthState" }}
{{- $propertiesExclusionreason := generate "properties.ExclusionReason" }}
{{- $propertiesIsexcluded := generate "properties.IsExcluded" }}
{{- $propertiesClientversion := generate "properties.ClientVersion" }}
{{- $propertiesDevicecategory := generate "properties.DeviceCategory" }}
{{- $propertiesDevicesubtype := generate "properties.DeviceSubtype" }}
{{- $propertiesIsazureadjoined := generate "properties.IsAzureADJoined" }}
{{- $propertiesJointype := generate "properties.JoinType" }}
{{- $propertiesLoggedonusers := generate "properties.LoggedOnUsers" }}
{{- $propertiesMergeddeviceids := generate "properties.MergedDeviceIds" }}
{{- $propertiesMergedtodeviceid := generate "properties.MergedToDeviceId" }}
{{- $propertiesModel := generate "properties.Model" }}
{{- $propertiesOsarchitecture := generate "properties.OSArchitecture" }}
{{- $propertiesOsbuild := generate "properties.OSBuild" }}
{{- $propertiesOsdistribution := generate "properties.OSDistribution" }}
{{- $propertiesOsversion := generate "properties.OSVersion" }}
{{- $propertiesOsversioninfo := generate "properties.OSVersionInfo" }}
{{- $propertiesOnboardingstatus := generate "properties.OnboardingStatus" }}
{{- $propertiesPublicip := generate "properties.PublicIP" }}
{{- $propertiesRegistrydevicetag := generate "properties.RegistryDeviceTag" }}
{{- $propertiesVendor := generate "properties.Vendor" }}
{{- $propertiesIslocaladmin := generate "properties.IsLocalAdmin" }}
{{- $propertiesRemoteiptype := generate "properties.RemoteIPType" }}
{{- $propertiesLocaliptype := generate "properties.LocalIPType" }}
{{- $propertiesConnectednetworks := generate "properties.ConnectedNetworks" }}
{{- $propertiesDefaultgateways := generate "properties.DefaultGateways" }}
{{- $propertiesDnsaddresses := generate "properties.DnsAddresses" }}
{{- $propertiesIpaddresses := generate "properties.IPAddresses" }}
{{- $propertiesIpv4dhcp := generate "properties.IPv4Dhcp" }}
{{- $propertiesIpv6dhcp := generate "properties.IPv6Dhcp" }}
{{- $propertiesMacaddress := generate "properties.MacAddress" }}
{{- $propertiesNetworkadaptername := generate "properties.NetworkAdapterName" }}
{{- $propertiesNetworkadapterstatus := generate "properties.NetworkAdapterStatus" }}
{{- $propertiesNetworkadaptertype := generate "properties.NetworkAdapterType" }}
{{- $propertiesNetworkadaptervendor := generate "properties.NetworkAdapterVendor" }}
{{- $propertiesTunneltype := generate "properties.TunnelType" }}
{{- $propertiesPreviousregistrykey := generate "properties.PreviousRegistryKey" }}
{{- $propertiesPreviousregistryvaluedata := generate "properties.PreviousRegistryValueData" }}
{{- $propertiesPreviousregistryvaluename := generate "properties.PreviousRegistryValueName" }}
{{- $propertiesRegistryvaluetype := generate "properties.RegistryValueType" }}
{{- $propertiesDetectionmethods := generate "properties.DetectionMethods" }}
{{- $propertiesFiletype := generate "properties.FileType" }}
{{- $propertiesRecipientemailaddress := generate "properties.RecipientEmailAddress" }}
{{- $propertiesRecipientobjectid := generate "properties.RecipientObjectId" }}
{{- $propertiesSenderdisplayname := generate "properties.SenderDisplayName" }}
{{- $propertiesSenderfromaddress := generate "properties.SenderFromAddress" }}
{{- $propertiesSenderobjectid := generate "properties.SenderObjectId" }}
{{- $propertiesThreatnames := generate "properties.ThreatNames" }}
{{- $propertiesThreattypes := generate "properties.ThreatTypes" }}
{{- $propertiesAttachmentcount := generate "properties.AttachmentCount" }}
{{- $propertiesAuthenticationdetails := generate "properties.AuthenticationDetails" }}
{{- $propertiesConfidencelevel := generate "properties.ConfidenceLevel" }}
{{- $propertiesConnectors := generate "properties.Connectors" }}
{{- $propertiesDeliveryaction := generate "properties.DeliveryAction" }}
{{- $propertiesDeliverylocation := generate "properties.DeliveryLocation" }}
{{- $propertiesEmailaction := generate "properties.EmailAction" }}
{{- $propertiesEmailactionpolicy := generate "properties.EmailActionPolicy" }}
{{- $propertiesEmailactionpolicyguid := generate "properties.EmailActionPolicyGuid" }}
{{- $propertiesEmailclusterid := generate "properties.EmailClusterId" }}
{{- $propertiesEmaildirection := generate "properties.EmailDirection" }}
{{- $propertiesEmaillanguage := generate "properties.EmailLanguage" }}
{{- $propertiesInternetmessageid := generate "properties.InternetMessageId" }}
{{- $propertiesOrglevelaction := generate "properties.OrgLevelAction" }}
{{- $propertiesOrglevelpolicy := generate "properties.OrgLevelPolicy" }}
{{- $propertiesSenderfromdomain := generate "properties.SenderFromDomain" }}
{{- $propertiesSenderipv4 := generate "properties.SenderIPv4" }}
{{- $propertiesSenderipv6 := generate "properties.SenderIPv6" }}
{{- $propertiesSendermailfromaddress := generate "properties.SenderMailFromAddress" }}
{{- $propertiesSendermailfromdomain := generate "properties.SenderMailFromDomain" }}
{{- $propertiesSubject := generate "properties.Subject" }}
{{- $propertiesUrlcount := generate "properties.UrlCount" }}
{{- $propertiesUserlevelaction := generate "properties.UserLevelAction" }}
{{- $propertiesUserlevelpolicy := generate "properties.UserLevelPolicy" }}
{{- $propertiesUrl := generate "properties.Url" }}
{{- $propertiesUrldomain := generate "properties.UrlDomain" }}
{{- $propertiesUrllocation := generate "properties.UrlLocation" }}
{{- $propertiesActionresult := generate "properties.ActionResult" }}
{{- $propertiesActiontrigger := generate "properties.ActionTrigger" }}
{{- $propertiesAction := generate "properties.Action" }}
{{- $propertiesIsclickedthrough := generate "properties.IsClickedThrough" }}
{{- $propertiesUrlchain := generate "properties.UrlChain" }}
{{- $propertiesWorkload := generate "properties.Workload" }}
{{- $tenantId := generate "tenantId" }}
{{- $time := generate "time" | date "2006-01-02T15:04:05.000000Z" }}
{{- $_TimeReceivedBySvc := generate "_TimeReceivedBySvc" | date "2006-01-02T15:04:05.000000Z" }}
{{- /*
{
  "Tenant": "{{$Tenant}}",
  "category": "{{$category}}",
  "operationName": "{{$operationName}}",
  "properties": {
    "Timestamp": "{{$propertiesTimestamp}}",
    "TargetDeviceName": "{{$propertiesTargetdevicename}}",
    "DestinationIPAddress": "{{$propertiesDestinationipaddress}}",
    "DestinationPort": "{{$propertiesDestinationport}}",
    "DeviceName": "{{$propertiesDevicename}}",
    "IPAddress": "{{$propertiesIpaddress}}",
    "OSPlatform": "{{$propertiesOsplatform}}",
    "DeviceType": "{{$propertiesDevicetype}}",
    "Protocol": "{{$propertiesProtocol}}",
    "AccountDomain": "{{$propertiesAccountdomain}}",
    "AccountSid": "{{$propertiesAccountsid}}",
    "AccountName": "{{$propertiesAccountname}}",
    "AccountDisplayName": "{{$propertiesAccountdisplayname}}",
    "AccountObjectId": "{{$propertiesAccountobjectid}}",
    "AccountUpn": "{{$propertiesAccountupn}}",
    "ActionType": "{{$propertiesActiontype}}",
    "AdditionalFields": "{{$propertiesAdditionalfields}}",
    "Application": "{{$propertiesApplication}}",
    "DestinationDeviceName": "{{$propertiesDestinationdevicename}}",
    "FailureReason": "{{$propertiesFailurereason}}",
    "Isp": "{{$propertiesIsp}}",
    "Location": "{{$propertiesLocation}}",
    "LogonType": "{{$propertiesLogontype}}",
    "Port": "{{$propertiesPort}}",
    "ReportId": "{{$propertiesReportid}}",
    "TargetAccountDisplayName": "{{$propertiesTargetaccountdisplayname}}",
    "IsAdminOperation": "{{$propertiesIsadminoperation}}",
    "Query": "{{$propertiesQuery}}",
    "QueryTarget": "{{$propertiesQuerytarget}}",
    "QueryType": "{{$propertiesQuerytype}}",
    "TargetAccountUpn": "{{$propertiesTargetaccountupn}}",
    "ISP": "{{$propertiesIsp}}",
    "AccountId": "{{$propertiesAccountid}}",
    "AccountType": "{{$propertiesAccounttype}}",
    "ActivityObjects": "{{$propertiesActivityobjects}}",
    "ActivityType": "{{$propertiesActivitytype}}",
    "AppInstanceId": "{{$propertiesAppinstanceid}}",
    "ApplicationId": "{{$propertiesApplicationid}}",
    "City": "{{$propertiesCity}}",
    "CountryCode": "{{$propertiesCountrycode}}",
    "IPCategory": "{{$propertiesIpcategory}}",
    "IPTags": "{{$propertiesIptags}}",
    "IsAnonymousProxy": "{{$propertiesIsanonymousproxy}}",
    "IsExternalUser": "{{$propertiesIsexternaluser}}",
    "IsImpersonated": "{{$propertiesIsimpersonated}}",
    "ObjectId": "{{$propertiesObjectid}}",
    "ObjectName": "{{$propertiesObjectname}}",
    "ObjectType": "{{$propertiesObjecttype}}",
    "RawEventData": {
      "ChatThreadId": "{{$propertiesRaweventdataChatthreadid}}",
      "CommunicationType": "{{$propertiesRaweventdataCommunicationtype}}",
      "CreationTime": "{{$propertiesRaweventdataCreationtime}}",
      "ExtraProperties": "{{$propertiesRaweventdataExtraproperties}}",
      "Id": "{{$propertiesRaweventdataId}}",
      "ItemName": "{{$propertiesRaweventdataItemname}}",
      "MessageId": "{{$propertiesRaweventdataMessageid}}",
      "MessageVersion": "{{$propertiesRaweventdataMessageversion}}",
      "MessageVisibilityTime": "{{$propertiesRaweventdataMessagevisibilitytime}}",
      "Operation": "{{$propertiesRaweventdataOperation}}",
      "OrganizationId": "{{$propertiesRaweventdataOrganizationid}}",
      "ParticipantInfo": {
        "HasForeignTenantUsers": "{{$propertiesRaweventdataParticipantinfoHasforeigntenantusers}}",
        "HasGuestUsers": "{{$propertiesRaweventdataParticipantinfoHasguestusers}}",
        "HasOtherGuestUsers": "{{$propertiesRaweventdataParticipantinfoHasotherguestusers}}",
        "HasUnauthenticatedUsers": "{{$propertiesRaweventdataParticipantinfoHasunauthenticatedusers}}",
        "ParticipatingDomains": "{{$propertiesRaweventdataParticipantinfoParticipatingdomains}}",
        "ParticipatingSIPDomains": "{{$propertiesRaweventdataParticipantinfoParticipatingsipdomains}}",
        "ParticipatingTenantIds": "{{$propertiesRaweventdataParticipantinfoParticipatingtenantids}}"
      },
      "RecordType": "{{$propertiesRaweventdataRecordtype}}",
      "ResourceTenantId": "{{$propertiesRaweventdataResourcetenantid}}",
      "UserId": "{{$propertiesRaweventdataUserid}}",
      "UserKey": "{{$propertiesRaweventdataUserkey}}",
      "UserType": "{{$propertiesRaweventdataUsertype}}",
      "Version": "{{$propertiesRaweventdataVersion}}",
      "Workload": "{{$propertiesRaweventdataWorkload}}"
    },
    "UserAgent": "{{$propertiesUseragent}}",
    "UserAgentTags": "{{$propertiesUseragenttags}}",
    "Address": "{{$propertiesAddress}}",
    "BlastRadius": "{{$propertiesBlastradius}}",
    "ChangeSource": "{{$propertiesChangesource}}",
    "CloudSid": "{{$propertiesCloudsid}}",
    "CompanyName": "{{$propertiesCompanyname}}",
    "Country": "{{$propertiesCountry}}",
    "CreatedDateTime": "{{$propertiesCreateddatetime}}",
    "CriticalityLevel": "{{$propertiesCriticalitylevel}}",
    "DeletedDateTime": "{{$propertiesDeleteddatetime}}",
    "Department": "{{$propertiesDepartment}}",
    "DistinguishedName": "{{$propertiesDistinguishedname}}",
    "EmailAddress": "{{$propertiesEmailaddress}}",
    "EmployeeId": "{{$propertiesEmployeeid}}",
    "GivenName": "{{$propertiesGivenname}}",
    "IsAccountEnabled": "{{$propertiesIsaccountenabled}}",
    "JobTitle": "{{$propertiesJobtitle}}",
    "Manager": "{{$propertiesManager}}",
    "OnPremSid": "{{$propertiesOnpremsid}}",
    "OtherMailAddresses": "{{$propertiesOthermailaddresses}}",
    "Phone": "{{$propertiesPhone}}",
    "RiskLevel": "{{$propertiesRisklevel}}",
    "RiskLevelDetails": "{{$propertiesRiskleveldetails}}",
    "SipProxyAddress": "{{$propertiesSipproxyaddress}}",
    "SourceProvider": "{{$propertiesSourceprovider}}",
    "State": "{{$propertiesState}}",
    "Surname": "{{$propertiesSurname}}",
    "Tags": "{{$propertiesTags}}",
    "Type": "{{$propertiesType}}",
    "AuditSource": "{{$propertiesAuditsource}}",
    "LastSeenForUser": "{{$propertiesLastseenforuser}}",
    "OAuthAppId": "{{$propertiesOauthappid}}",
    "SessionData": "{{$propertiesSessiondata}}",
    "UncommonForUser": "{{$propertiesUncommonforuser}}",
    "AlertId": "{{$propertiesAlertid}}",
    "DeviceId": "{{$propertiesDeviceid}}",
    "EmailSubject": "{{$propertiesEmailsubject}}",
    "EntityType": "{{$propertiesEntitytype}}",
    "EvidenceDirection": "{{$propertiesEvidencedirection}}",
    "EvidenceRole": "{{$propertiesEvidencerole}}",
    "FileName": "{{$propertiesFilename}}",
    "FileSize": "{{$propertiesFilesize}}",
    "FolderPath": "{{$propertiesFolderpath}}",
    "LocalIP": "{{$propertiesLocalip}}",
    "MachineGroup": "{{$propertiesMachinegroup}}",
    "NetworkMessageId": "{{$propertiesNetworkmessageid}}",
    "OAuthApplicationId": "{{$propertiesOauthapplicationid}}",
    "ProcessCommandLine": "{{$propertiesProcesscommandline}}",
    "RegistryKey": "{{$propertiesRegistrykey}}",
    "RegistryValueData": "{{$propertiesRegistryvaluedata}}",
    "RegistryValueName": "{{$propertiesRegistryvaluename}}",
    "RemoteIP": "{{$propertiesRemoteip}}",
    "RemoteUrl": "{{$propertiesRemoteurl}}",
    "SHA1": "{{$propertiesSha1}}",
    "SHA256": "{{$propertiesSha256}}",
    "ServiceSource": "{{$propertiesServicesource}}",
    "ThreatFamily": "{{$propertiesThreatfamily}}",
    "AttackTechniques": "{{$propertiesAttacktechniques}}",
    "Category": "{{$propertiesCategory}}",
    "DetectionSource": "{{$propertiesDetectionsource}}",
    "Severity": "{{$propertiesSeverity}}",
    "Title": "{{$propertiesTitle}}",
    "AppGuardContainerId": "{{$propertiesAppguardcontainerid}}",
    "CreatedProcessSessionId": "{{$propertiesCreatedprocesssessionid}}",
    "InitiatingProcessAccountDomain": "{{$propertiesInitiatingprocessaccountdomain}}",
    "InitiatingProcessAccountName": "{{$propertiesInitiatingprocessaccountname}}",
    "InitiatingProcessAccountObjectId": "{{$propertiesInitiatingprocessaccountobjectid}}",
    "InitiatingProcessAccountSid": "{{$propertiesInitiatingprocessaccountsid}}",
    "InitiatingProcessAccountUpn": "{{$propertiesInitiatingprocessaccountupn}}",
    "InitiatingProcessCommandLine": "{{$propertiesInitiatingprocesscommandline}}",
    "InitiatingProcessCreationTime": "{{$propertiesInitiatingprocesscreationtime}}",
    "InitiatingProcessFileName": "{{$propertiesInitiatingprocessfilename}}",
    "InitiatingProcessFileSize": "{{$propertiesInitiatingprocessfilesize}}",
    "InitiatingProcessFolderPath": "{{$propertiesInitiatingprocessfolderpath}}",
    "InitiatingProcessId": "{{$propertiesInitiatingprocessid}}",
    "InitiatingProcessIntegrityLevel": "{{$propertiesInitiatingprocessintegritylevel}}",
    "InitiatingProcessLogonId": "{{$propertiesInitiatingprocesslogonid}}",
    "InitiatingProcessMD5": "{{$propertiesInitiatingprocessmd5}}",
    "InitiatingProcessParentCreationTime": "{{$propertiesInitiatingprocessparentcreationtime}}",
    "InitiatingProcessParentFileName": "{{$propertiesInitiatingprocessparentfilename}}",
    "InitiatingProcessParentId": "{{$propertiesInitiatingprocessparentid}}",
    "InitiatingProcessRemoteSessionDeviceName": "{{$propertiesInitiatingprocessremotesessiondevicename}}",
    "InitiatingProcessRemoteSessionIP": "{{$propertiesInitiatingprocessremotesessionip}}",
    "InitiatingProcessSHA1": "{{$propertiesInitiatingprocesssha1}}",
    "InitiatingProcessSHA256": "{{$propertiesInitiatingprocesssha256}}",
    "InitiatingProcessSessionId": "{{$propertiesInitiatingprocesssessionid}}",
    "InitiatingProcessSignatureStatus": "{{$propertiesInitiatingprocesssignaturestatus}}",
    "InitiatingProcessSignerType": "{{$propertiesInitiatingprocesssignertype}}",
    "InitiatingProcessTokenElevation": "{{$propertiesInitiatingprocesstokenelevation}}",
    "InitiatingProcessVersionInfoCompanyName": "{{$propertiesInitiatingprocessversioninfocompanyname}}",
    "InitiatingProcessVersionInfoFileDescription": "{{$propertiesInitiatingprocessversioninfofiledescription}}",
    "InitiatingProcessVersionInfoInternalFileName": "{{$propertiesInitiatingprocessversioninfointernalfilename}}",
    "InitiatingProcessVersionInfoOriginalFileName": "{{$propertiesInitiatingprocessversioninfooriginalfilename}}",
    "InitiatingProcessVersionInfoProductName": "{{$propertiesInitiatingprocessversioninfoproductname}}",
    "InitiatingProcessVersionInfoProductVersion": "{{$propertiesInitiatingprocessversioninfoproductversion}}",
    "IsInitiatingProcessRemoteSession": "{{$propertiesIsinitiatingprocessremotesession}}",
    "IsProcessRemoteSession": "{{$propertiesIsprocessremotesession}}",
    "LogonId": "{{$propertiesLogonid}}",
    "MD5": "{{$propertiesMd5}}",
    "ProcessCreationTime": "{{$propertiesProcesscreationtime}}",
    "ProcessId": "{{$propertiesProcessid}}",
    "ProcessIntegrityLevel": "{{$propertiesProcessintegritylevel}}",
    "ProcessRemoteSessionDeviceName": "{{$propertiesProcessremotesessiondevicename}}",
    "ProcessRemoteSessionIP": "{{$propertiesProcessremotesessionip}}",
    "ProcessTokenElevation": "{{$propertiesProcesstokenelevation}}",
    "ProcessVersionInfoCompanyName": "{{$propertiesProcessversioninfocompanyname}}",
    "ProcessVersionInfoFileDescription": "{{$propertiesProcessversioninfofiledescription}}",
    "ProcessVersionInfoInternalFileName": "{{$propertiesProcessversioninfointernalfilename}}",
    "ProcessVersionInfoOriginalFileName": "{{$propertiesProcessversioninfooriginalfilename}}",
    "ProcessVersionInfoProductName": "{{$propertiesProcessversioninfoproductname}}",
    "ProcessVersionInfoProductVersion": "{{$propertiesProcessversioninfoproductversion}}",
    "FileOriginIP": "{{$propertiesFileoriginip}}",
    "FileOriginUrl": "{{$propertiesFileoriginurl}}",
    "LocalPort": "{{$propertiesLocalport}}",
    "RemoteDeviceName": "{{$propertiesRemotedevicename}}",
    "RemotePort": "{{$propertiesRemoteport}}",
    "CertificateCountersignatureTime": "{{$propertiesCertificatecountersignaturetime}}",
    "CertificateCreationTime": "{{$propertiesCertificatecreationtime}}",
    "CertificateExpirationTime": "{{$propertiesCertificateexpirationtime}}",
    "CertificateSerialNumber": "{{$propertiesCertificateserialnumber}}",
    "CrlDistributionPointUrls": "{{$propertiesCrldistributionpointurls}}",
    "IsRootSignerMicrosoft": "{{$propertiesIsrootsignermicrosoft}}",
    "IsSigned": "{{$propertiesIssigned}}",
    "IsTrusted": "{{$propertiesIstrusted}}",
    "Issuer": "{{$propertiesIssuer}}",
    "IssuerHash": "{{$propertiesIssuerhash}}",
    "SignatureType": "{{$propertiesSignaturetype}}",
    "Signer": "{{$propertiesSigner}}",
    "SignerHash": "{{$propertiesSignerhash}}",
    "FileOriginReferrerUrl": "{{$propertiesFileoriginreferrerurl}}",
    "IsAzureInfoProtectionApplied": "{{$propertiesIsazureinfoprotectionapplied}}",
    "PreviousFileName": "{{$propertiesPreviousfilename}}",
    "PreviousFolderPath": "{{$propertiesPreviousfolderpath}}",
    "RequestAccountDomain": "{{$propertiesRequestaccountdomain}}",
    "RequestAccountName": "{{$propertiesRequestaccountname}}",
    "RequestAccountSid": "{{$propertiesRequestaccountsid}}",
    "RequestProtocol": "{{$propertiesRequestprotocol}}",
    "RequestSourceIP": "{{$propertiesRequestsourceip}}",
    "RequestSourcePort": "{{$propertiesRequestsourceport}}",
    "SensitivityLabel": "{{$propertiesSensitivitylabel}}",
    "SensitivitySubLabel": "{{$propertiesSensitivitysublabel}}",
    "ShareName": "{{$propertiesSharename}}",
    "AadDeviceId": "{{$propertiesAaddeviceid}}",
    "AssetValue": "{{$propertiesAssetvalue}}",
    "IsInternetFacing": "{{$propertiesIsinternetfacing}}",
    "DeviceManualTags": "{{$propertiesDevicemanualtags}}",
    "DeviceDynamicTags": "{{$propertiesDevicedynamictags}}",
    "ExposureLevel": "{{$propertiesExposurelevel}}",
    "SensorHealthState": "{{$propertiesSensorhealthstate}}",
    "ExclusionReason": "{{$propertiesExclusionreason}}",
    "IsExcluded": "{{$propertiesIsexcluded}}",
    "ClientVersion": "{{$propertiesClientversion}}",
    "DeviceCategory": "{{$propertiesDevicecategory}}",
    "DeviceSubtype": "{{$propertiesDevicesubtype}}",
    "IsAzureADJoined": "{{$propertiesIsazureadjoined}}",
    "JoinType": "{{$propertiesJointype}}",
    "LoggedOnUsers": "{{$propertiesLoggedonusers}}",
    "MergedDeviceIds": "{{$propertiesMergeddeviceids}}",
    "MergedToDeviceId": "{{$propertiesMergedtodeviceid}}",
    "Model": "{{$propertiesModel}}",
    "OSArchitecture": "{{$propertiesOsarchitecture}}",
    "OSBuild": "{{$propertiesOsbuild}}",
    "OSDistribution": "{{$propertiesOsdistribution}}",
    "OSVersion": "{{$propertiesOsversion}}",
    "OSVersionInfo": "{{$propertiesOsversioninfo}}",
    "OnboardingStatus": "{{$propertiesOnboardingstatus}}",
    "PublicIP": "{{$propertiesPublicip}}",
    "RegistryDeviceTag": "{{$propertiesRegistrydevicetag}}",
    "Vendor": "{{$propertiesVendor}}",
    "IsLocalAdmin": "{{$propertiesIslocaladmin}}",
    "RemoteIPType": "{{$propertiesRemoteiptype}}",
    "LocalIPType": "{{$propertiesLocaliptype}}",
    "ConnectedNetworks": "{{$propertiesConnectednetworks}}",
    "DefaultGateways": "{{$propertiesDefaultgateways}}",
    "DnsAddresses": "{{$propertiesDnsaddresses}}",
    "IPAddresses": "{{$propertiesIpaddresses}}",
    "IPv4Dhcp": "{{$propertiesIpv4dhcp}}",
    "IPv6Dhcp": "{{$propertiesIpv6dhcp}}",
    "MacAddress": "{{$propertiesMacaddress}}",
    "NetworkAdapterName": "{{$propertiesNetworkadaptername}}",
    "NetworkAdapterStatus": "{{$propertiesNetworkadapterstatus}}",
    "NetworkAdapterType": "{{$propertiesNetworkadaptertype}}",
    "NetworkAdapterVendor": "{{$propertiesNetworkadaptervendor}}",
    "TunnelType": "{{$propertiesTunneltype}}",
    "PreviousRegistryKey": "{{$propertiesPreviousregistrykey}}",
    "PreviousRegistryValueData": "{{$propertiesPreviousregistryvaluedata}}",
    "PreviousRegistryValueName": "{{$propertiesPreviousregistryvaluename}}",
    "RegistryValueType": "{{$propertiesRegistryvaluetype}}",
    "DetectionMethods": "{{$propertiesDetectionmethods}}",
    "FileType": "{{$propertiesFiletype}}",
    "RecipientEmailAddress": "{{$propertiesRecipientemailaddress}}",
    "RecipientObjectId": "{{$propertiesRecipientobjectid}}",
    "SenderDisplayName": "{{$propertiesSenderdisplayname}}",
    "SenderFromAddress": "{{$propertiesSenderfromaddress}}",
    "SenderObjectId": "{{$propertiesSenderobjectid}}",
    "ThreatNames": "{{$propertiesThreatnames}}",
    "ThreatTypes": "{{$propertiesThreattypes}}",
    "AttachmentCount": "{{$propertiesAttachmentcount}}",
    "AuthenticationDetails": "{{$propertiesAuthenticationdetails}}",
    "ConfidenceLevel": "{{$propertiesConfidencelevel}}",
    "Connectors": "{{$propertiesConnectors}}",
    "DeliveryAction": "{{$propertiesDeliveryaction}}",
    "DeliveryLocation": "{{$propertiesDeliverylocation}}",
    "EmailAction": "{{$propertiesEmailaction}}",
    "EmailActionPolicy": "{{$propertiesEmailactionpolicy}}",
    "EmailActionPolicyGuid": "{{$propertiesEmailactionpolicyguid}}",
    "EmailClusterId": "{{$propertiesEmailclusterid}}",
    "EmailDirection": "{{$propertiesEmaildirection}}",
    "EmailLanguage": "{{$propertiesEmaillanguage}}",
    "InternetMessageId": "{{$propertiesInternetmessageid}}",
    "OrgLevelAction": "{{$propertiesOrglevelaction}}",
    "OrgLevelPolicy": "{{$propertiesOrglevelpolicy}}",
    "SenderFromDomain": "{{$propertiesSenderfromdomain}}",
    "SenderIPv4": "{{$propertiesSenderipv4}}",
    "SenderIPv6": "{{$propertiesSenderipv6}}",
    "SenderMailFromAddress": "{{$propertiesSendermailfromaddress}}",
    "SenderMailFromDomain": "{{$propertiesSendermailfromdomain}}",
    "Subject": "{{$propertiesSubject}}",
    "UrlCount": "{{$propertiesUrlcount}}",
    "UserLevelAction": "{{$propertiesUserlevelaction}}",
    "UserLevelPolicy": "{{$propertiesUserlevelpolicy}}",
    "Url": "{{$propertiesUrl}}",
    "UrlDomain": "{{$propertiesUrldomain}}",
    "UrlLocation": "{{$propertiesUrllocation}}",
    "ActionResult": "{{$propertiesActionresult}}",
    "ActionTrigger": "{{$propertiesActiontrigger}}",
    "Action": "{{$propertiesAction}}",
    "IsClickedThrough": "{{$propertiesIsclickedthrough}}",
    "UrlChain": "{{$propertiesUrlchain}}",
    "Workload": "{{$propertiesWorkload}}"
  },
  "tenantId": "{{$tenantId}}",
  "time": "{{$time}}",
  "_TimeReceivedBySvc": "{{$_TimeReceivedBySvc}}"
}
*/ -}}
{
    "agent": {
        "ephemeral_id": "cdaaaabb-be7e-432f-816b-bda019fd7c15",
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.18.0"
    },
    "data_stream": {
        "dataset": "m365_defender.event",
        "namespace": "93724",
        "type": "logs"
    },
    "elastic_agent": {
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "snapshot": false,
        "version": "8.18.0"
    },
    "message": "{\"Tenant\":\"{{$Tenant}}\",\"category\":\"{{$category}}\",\"operationName\":\"{{$operationName}}\",\"properties\":{\"Timestamp\":\"{{$propertiesTimestamp}}\",\"TargetDeviceName\":\"{{$propertiesTargetdevicename}}\",\"DestinationIPAddress\":\"{{$propertiesDestinationipaddress}}\",\"DestinationPort\":\"{{$propertiesDestinationport}}\",\"DeviceName\":\"{{$propertiesDevicename}}\",\"IPAddress\":\"{{$propertiesIpaddress}}\",\"OSPlatform\":\"{{$propertiesOsplatform}}\",\"DeviceType\":\"{{$propertiesDevicetype}}\",\"Protocol\":\"{{$propertiesProtocol}}\",\"AccountDomain\":\"{{$propertiesAccountdomain}}\",\"AccountSid\":\"{{$propertiesAccountsid}}\",\"AccountName\":\"{{$propertiesAccountname}}\",\"AccountDisplayName\":\"{{$propertiesAccountdisplayname}}\",\"AccountObjectId\":\"{{$propertiesAccountobjectid}}\",\"AccountUpn\":\"{{$propertiesAccountupn}}\",\"ActionType\":\"{{$propertiesActiontype}}\",\"AdditionalFields\":\"{{$propertiesAdditionalfields}}\",\"Application\":\"{{$propertiesApplication}}\",\"DestinationDeviceName\":\"{{$propertiesDestinationdevicename}}\",\"FailureReason\":\"{{$propertiesFailurereason}}\",\"Isp\":\"{{$propertiesIsp}}\",\"Location\":\"{{$propertiesLocation}}\",\"LogonType\":\"{{$propertiesLogontype}}\",\"Port\":\"{{$propertiesPort}}\",\"ReportId\":\"{{$propertiesReportid}}\",\"TargetAccountDisplayName\":\"{{$propertiesTargetaccountdisplayname}}\",\"IsAdminOperation\":\"{{$propertiesIsadminoperation}}\",\"Query\":\"{{$propertiesQuery}}\",\"QueryTarget\":\"{{$propertiesQuerytarget}}\",\"QueryType\":\"{{$propertiesQuerytype}}\",\"TargetAccountUpn\":\"{{$propertiesTargetaccountupn}}\",\"ISP\":\"{{$propertiesIsp}}\",\"AccountId\":\"{{$propertiesAccountid}}\",\"AccountType\":\"{{$propertiesAccounttype}}\",\"ActivityObjects\":\"{{$propertiesActivityobjects}}\",\"ActivityType\":\"{{$propertiesActivitytype}}\",\"AppInstanceId\":\"{{$propertiesAppinstanceid}}\",\"ApplicationId\":\"{{$propertiesApplicationid}}\",\"City\":\"{{$propertiesCity}}\",\"CountryCode\":\"{{$propertiesCountrycode}}\",\"IPCategory\":\"{{$propertiesIpcategory}}\",\"IPTags\":\"{{$propertiesIptags}}\",\"IsAnonymousProxy\":\"{{$propertiesIsanonymousproxy}}\",\"IsExternalUser\":\"{{$propertiesIsexternaluser}}\",\"IsImpersonated\":\"{{$propertiesIsimpersonated}}\",\"ObjectId\":\"{{$propertiesObjectid}}\",\"ObjectName\":\"{{$propertiesObjectname}}\",\"ObjectType\":\"{{$propertiesObjecttype}}\",\"RawEventData\":{\"ChatThreadId\":\"{{$propertiesRaweventdataChatthreadid}}\",\"CommunicationType\":\"{{$propertiesRaweventdataCommunicationtype}}\",\"CreationTime\":\"{{$propertiesRaweventdataCreationtime}}\",\"ExtraProperties\":\"{{$propertiesRaweventdataExtraproperties}}\",\"Id\":\"{{$propertiesRaweventdataId}}\",\"ItemName\":\"{{$propertiesRaweventdataItemname}}\",\"MessageId\":\"{{$propertiesRaweventdataMessageid}}\",\"MessageVersion\":\"{{$propertiesRaweventdataMessageversion}}\",\"MessageVisibilityTime\":\"{{$propertiesRaweventdataMessagevisibilitytime}}\",\"Operation\":\"{{$propertiesRaweventdataOperation}}\",\"OrganizationId\":\"{{$propertiesRaweventdataOrganizationid}}\",\"ParticipantInfo\":{\"HasForeignTenantUsers\":\"{{$propertiesRaweventdataParticipantinfoHasforeigntenantusers}}\",\"HasGuestUsers\":\"{{$propertiesRaweventdataParticipantinfoHasguestusers}}\",\"HasOtherGuestUsers\":\"{{$propertiesRaweventdataParticipantinfoHasotherguestusers}}\",\"HasUnauthenticatedUsers\":\"{{$propertiesRaweventdataParticipantinfoHasunauthenticatedusers}}\",\"ParticipatingDomains\":\"{{$propertiesRaweventdataParticipantinfoParticipatingdomains}}\",\"ParticipatingSIPDomains\":\"{{$propertiesRaweventdataParticipantinfoParticipatingsipdomains}}\",\"ParticipatingTenantIds\":\"{{$propertiesRaweventdataParticipantinfoParticipatingtenantids}}\"},\"RecordType\":\"{{$propertiesRaweventdataRecordtype}}\",\"ResourceTenantId\":\"{{$propertiesRaweventdataResourcetenantid}}\",\"UserId\":\"{{$propertiesRaweventdataUserid}}\",\"UserKey\":\"{{$propertiesRaweventdataUserkey}}\",\"UserType\":\"{{$propertiesRaweventdataUsertype}}\",\"Version\":\"{{$propertiesRaweventdataVersion}}\",\"Workload\":\"{{$propertiesRaweventdataWorkload}}\"},\"UserAgent\":\"{{$propertiesUseragent}}\",\"UserAgentTags\":\"{{$propertiesUseragenttags}}\",\"Address\":\"{{$propertiesAddress}}\",\"BlastRadius\":\"{{$propertiesBlastradius}}\",\"ChangeSource\":\"{{$propertiesChangesource}}\",\"CloudSid\":\"{{$propertiesCloudsid}}\",\"CompanyName\":\"{{$propertiesCompanyname}}\",\"Country\":\"{{$propertiesCountry}}\",\"CreatedDateTime\":\"{{$propertiesCreateddatetime}}\",\"CriticalityLevel\":\"{{$propertiesCriticalitylevel}}\",\"DeletedDateTime\":\"{{$propertiesDeleteddatetime}}\",\"Department\":\"{{$propertiesDepartment}}\",\"DistinguishedName\":\"{{$propertiesDistinguishedname}}\",\"EmailAddress\":\"{{$propertiesEmailaddress}}\",\"EmployeeId\":\"{{$propertiesEmployeeid}}\",\"GivenName\":\"{{$propertiesGivenname}}\",\"IsAccountEnabled\":\"{{$propertiesIsaccountenabled}}\",\"JobTitle\":\"{{$propertiesJobtitle}}\",\"Manager\":\"{{$propertiesManager}}\",\"OnPremSid\":\"{{$propertiesOnpremsid}}\",\"OtherMailAddresses\":\"{{$propertiesOthermailaddresses}}\",\"Phone\":\"{{$propertiesPhone}}\",\"RiskLevel\":\"{{$propertiesRisklevel}}\",\"RiskLevelDetails\":\"{{$propertiesRiskleveldetails}}\",\"SipProxyAddress\":\"{{$propertiesSipproxyaddress}}\",\"SourceProvider\":\"{{$propertiesSourceprovider}}\",\"State\":\"{{$propertiesState}}\",\"Surname\":\"{{$propertiesSurname}}\",\"Tags\":\"{{$propertiesTags}}\",\"Type\":\"{{$propertiesType}}\",\"AuditSource\":\"{{$propertiesAuditsource}}\",\"LastSeenForUser\":\"{{$propertiesLastseenforuser}}\",\"OAuthAppId\":\"{{$propertiesOauthappid}}\",\"SessionData\":\"{{$propertiesSessiondata}}\",\"UncommonForUser\":\"{{$propertiesUncommonforuser}}\",\"AlertId\":\"{{$propertiesAlertid}}\",\"DeviceId\":\"{{$propertiesDeviceid}}\",\"EmailSubject\":\"{{$propertiesEmailsubject}}\",\"EntityType\":\"{{$propertiesEntitytype}}\",\"EvidenceDirection\":\"{{$propertiesEvidencedirection}}\",\"EvidenceRole\":\"{{$propertiesEvidencerole}}\",\"FileName\":\"{{$propertiesFilename}}\",\"FileSize\":\"{{$propertiesFilesize}}\",\"FolderPath\":\"{{$propertiesFolderpath}}\",\"LocalIP\":\"{{$propertiesLocalip}}\",\"MachineGroup\":\"{{$propertiesMachinegroup}}\",\"NetworkMessageId\":\"{{$propertiesNetworkmessageid}}\",\"OAuthApplicationId\":\"{{$propertiesOauthapplicationid}}\",\"ProcessCommandLine\":\"{{$propertiesProcesscommandline}}\",\"RegistryKey\":\"{{$propertiesRegistrykey}}\",\"RegistryValueData\":\"{{$propertiesRegistryvaluedata}}\",\"RegistryValueName\":\"{{$propertiesRegistryvaluename}}\",\"RemoteIP\":\"{{$propertiesRemoteip}}\",\"RemoteUrl\":\"{{$propertiesRemoteurl}}\",\"SHA1\":\"{{$propertiesSha1}}\",\"SHA256\":\"{{$propertiesSha256}}\",\"ServiceSource\":\"{{$propertiesServicesource}}\",\"ThreatFamily\":\"{{$propertiesThreatfamily}}\",\"AttackTechniques\":\"{{$propertiesAttacktechniques}}\",\"Category\":\"{{$propertiesCategory}}\",\"DetectionSource\":\"{{$propertiesDetectionsource}}\",\"Severity\":\"{{$propertiesSeverity}}\",\"Title\":\"{{$propertiesTitle}}\",\"AppGuardContainerId\":\"{{$propertiesAppguardcontainerid}}\",\"CreatedProcessSessionId\":\"{{$propertiesCreatedprocesssessionid}}\",\"InitiatingProcessAccountDomain\":\"{{$propertiesInitiatingprocessaccountdomain}}\",\"InitiatingProcessAccountName\":\"{{$propertiesInitiatingprocessaccountname}}\",\"InitiatingProcessAccountObjectId\":\"{{$propertiesInitiatingprocessaccountobjectid}}\",\"InitiatingProcessAccountSid\":\"{{$propertiesInitiatingprocessaccountsid}}\",\"InitiatingProcessAccountUpn\":\"{{$propertiesInitiatingprocessaccountupn}}\",\"InitiatingProcessCommandLine\":\"{{$propertiesInitiatingprocesscommandline}}\",\"InitiatingProcessCreationTime\":\"{{$propertiesInitiatingprocesscreationtime}}\",\"InitiatingProcessFileName\":\"{{$propertiesInitiatingprocessfilename}}\",\"InitiatingProcessFileSize\":\"{{$propertiesInitiatingprocessfilesize}}\",\"InitiatingProcessFolderPath\":\"{{$propertiesInitiatingprocessfolderpath}}\",\"InitiatingProcessId\":\"{{$propertiesInitiatingprocessid}}\",\"InitiatingProcessIntegrityLevel\":\"{{$propertiesInitiatingprocessintegritylevel}}\",\"InitiatingProcessLogonId\":\"{{$propertiesInitiatingprocesslogonid}}\",\"InitiatingProcessMD5\":\"{{$propertiesInitiatingprocessmd5}}\",\"InitiatingProcessParentCreationTime\":\"{{$propertiesInitiatingprocessparentcreationtime}}\",\"InitiatingProcessParentFileName\":\"{{$propertiesInitiatingprocessparentfilename}}\",\"InitiatingProcessParentId\":\"{{$propertiesInitiatingprocessparentid}}\",\"InitiatingProcessRemoteSessionDeviceName\":\"{{$propertiesInitiatingprocessremotesessiondevicename}}\",\"InitiatingProcessRemoteSessionIP\":\"{{$propertiesInitiatingprocessremotesessionip}}\",\"InitiatingProcessSHA1\":\"{{$propertiesInitiatingprocesssha1}}\",\"InitiatingProcessSHA256\":\"{{$propertiesInitiatingprocesssha256}}\",\"InitiatingProcessSessionId\":\"{{$propertiesInitiatingprocesssessionid}}\",\"InitiatingProcessSignatureStatus\":\"{{$propertiesInitiatingprocesssignaturestatus}}\",\"InitiatingProcessSignerType\":\"{{$propertiesInitiatingprocesssignertype}}\",\"InitiatingProcessTokenElevation\":\"{{$propertiesInitiatingprocesstokenelevation}}\",\"InitiatingProcessVersionInfoCompanyName\":\"{{$propertiesInitiatingprocessversioninfocompanyname}}\",\"InitiatingProcessVersionInfoFileDescription\":\"{{$propertiesInitiatingprocessversioninfofiledescription}}\",\"InitiatingProcessVersionInfoInternalFileName\":\"{{$propertiesInitiatingprocessversioninfointernalfilename}}\",\"InitiatingProcessVersionInfoOriginalFileName\":\"{{$propertiesInitiatingprocessversioninfooriginalfilename}}\",\"InitiatingProcessVersionInfoProductName\":\"{{$propertiesInitiatingprocessversioninfoproductname}}\",\"InitiatingProcessVersionInfoProductVersion\":\"{{$propertiesInitiatingprocessversioninfoproductversion}}\",\"IsInitiatingProcessRemoteSession\":\"{{$propertiesIsinitiatingprocessremotesession}}\",\"IsProcessRemoteSession\":\"{{$propertiesIsprocessremotesession}}\",\"LogonId\":\"{{$propertiesLogonid}}\",\"MD5\":\"{{$propertiesMd5}}\",\"ProcessCreationTime\":\"{{$propertiesProcesscreationtime}}\",\"ProcessId\":\"{{$propertiesProcessid}}\",\"ProcessIntegrityLevel\":\"{{$propertiesProcessintegritylevel}}\",\"ProcessRemoteSessionDeviceName\":\"{{$propertiesProcessremotesessiondevicename}}\",\"ProcessRemoteSessionIP\":\"{{$propertiesProcessremotesessionip}}\",\"ProcessTokenElevation\":\"{{$propertiesProcesstokenelevation}}\",\"ProcessVersionInfoCompanyName\":\"{{$propertiesProcessversioninfocompanyname}}\",\"ProcessVersionInfoFileDescription\":\"{{$propertiesProcessversioninfofiledescription}}\",\"ProcessVersionInfoInternalFileName\":\"{{$propertiesProcessversioninfointernalfilename}}\",\"ProcessVersionInfoOriginalFileName\":\"{{$propertiesProcessversioninfooriginalfilename}}\",\"ProcessVersionInfoProductName\":\"{{$propertiesProcessversioninfoproductname}}\",\"ProcessVersionInfoProductVersion\":\"{{$propertiesProcessversioninfoproductversion}}\",\"FileOriginIP\":\"{{$propertiesFileoriginip}}\",\"FileOriginUrl\":\"{{$propertiesFileoriginurl}}\",\"LocalPort\":\"{{$propertiesLocalport}}\",\"RemoteDeviceName\":\"{{$propertiesRemotedevicename}}\",\"RemotePort\":\"{{$propertiesRemoteport}}\",\"CertificateCountersignatureTime\":\"{{$propertiesCertificatecountersignaturetime}}\",\"CertificateCreationTime\":\"{{$propertiesCertificatecreationtime}}\",\"CertificateExpirationTime\":\"{{$propertiesCertificateexpirationtime}}\",\"CertificateSerialNumber\":\"{{$propertiesCertificateserialnumber}}\",\"CrlDistributionPointUrls\":\"{{$propertiesCrldistributionpointurls}}\",\"IsRootSignerMicrosoft\":\"{{$propertiesIsrootsignermicrosoft}}\",\"IsSigned\":\"{{$propertiesIssigned}}\",\"IsTrusted\":\"{{$propertiesIstrusted}}\",\"Issuer\":\"{{$propertiesIssuer}}\",\"IssuerHash\":\"{{$propertiesIssuerhash}}\",\"SignatureType\":\"{{$propertiesSignaturetype}}\",\"Signer\":\"{{$propertiesSigner}}\",\"SignerHash\":\"{{$propertiesSignerhash}}\",\"FileOriginReferrerUrl\":\"{{$propertiesFileoriginreferrerurl}}\",\"IsAzureInfoProtectionApplied\":\"{{$propertiesIsazureinfoprotectionapplied}}\",\"PreviousFileName\":\"{{$propertiesPreviousfilename}}\",\"PreviousFolderPath\":\"{{$propertiesPreviousfolderpath}}\",\"RequestAccountDomain\":\"{{$propertiesRequestaccountdomain}}\",\"RequestAccountName\":\"{{$propertiesRequestaccountname}}\",\"RequestAccountSid\":\"{{$propertiesRequestaccountsid}}\",\"RequestProtocol\":\"{{$propertiesRequestprotocol}}\",\"RequestSourceIP\":\"{{$propertiesRequestsourceip}}\",\"RequestSourcePort\":\"{{$propertiesRequestsourceport}}\",\"SensitivityLabel\":\"{{$propertiesSensitivitylabel}}\",\"SensitivitySubLabel\":\"{{$propertiesSensitivitysublabel}}\",\"ShareName\":\"{{$propertiesSharename}}\",\"AadDeviceId\":\"{{$propertiesAaddeviceid}}\",\"AssetValue\":\"{{$propertiesAssetvalue}}\",\"IsInternetFacing\":\"{{$propertiesIsinternetfacing}}\",\"DeviceManualTags\":\"{{$propertiesDevicemanualtags}}\",\"DeviceDynamicTags\":\"{{$propertiesDevicedynamictags}}\",\"ExposureLevel\":\"{{$propertiesExposurelevel}}\",\"SensorHealthState\":\"{{$propertiesSensorhealthstate}}\",\"ExclusionReason\":\"{{$propertiesExclusionreason}}\",\"IsExcluded\":\"{{$propertiesIsexcluded}}\",\"ClientVersion\":\"{{$propertiesClientversion}}\",\"DeviceCategory\":\"{{$propertiesDevicecategory}}\",\"DeviceSubtype\":\"{{$propertiesDevicesubtype}}\",\"IsAzureADJoined\":\"{{$propertiesIsazureadjoined}}\",\"JoinType\":\"{{$propertiesJointype}}\",\"LoggedOnUsers\":\"{{$propertiesLoggedonusers}}\",\"MergedDeviceIds\":\"{{$propertiesMergeddeviceids}}\",\"MergedToDeviceId\":\"{{$propertiesMergedtodeviceid}}\",\"Model\":\"{{$propertiesModel}}\",\"OSArchitecture\":\"{{$propertiesOsarchitecture}}\",\"OSBuild\":\"{{$propertiesOsbuild}}\",\"OSDistribution\":\"{{$propertiesOsdistribution}}\",\"OSVersion\":\"{{$propertiesOsversion}}\",\"OSVersionInfo\":\"{{$propertiesOsversioninfo}}\",\"OnboardingStatus\":\"{{$propertiesOnboardingstatus}}\",\"PublicIP\":\"{{$propertiesPublicip}}\",\"RegistryDeviceTag\":\"{{$propertiesRegistrydevicetag}}\",\"Vendor\":\"{{$propertiesVendor}}\",\"IsLocalAdmin\":\"{{$propertiesIslocaladmin}}\",\"RemoteIPType\":\"{{$propertiesRemoteiptype}}\",\"LocalIPType\":\"{{$propertiesLocaliptype}}\",\"ConnectedNetworks\":\"{{$propertiesConnectednetworks}}\",\"DefaultGateways\":\"{{$propertiesDefaultgateways}}\",\"DnsAddresses\":\"{{$propertiesDnsaddresses}}\",\"IPAddresses\":\"{{$propertiesIpaddresses}}\",\"IPv4Dhcp\":\"{{$propertiesIpv4dhcp}}\",\"IPv6Dhcp\":\"{{$propertiesIpv6dhcp}}\",\"MacAddress\":\"{{$propertiesMacaddress}}\",\"NetworkAdapterName\":\"{{$propertiesNetworkadaptername}}\",\"NetworkAdapterStatus\":\"{{$propertiesNetworkadapterstatus}}\",\"NetworkAdapterType\":\"{{$propertiesNetworkadaptertype}}\",\"NetworkAdapterVendor\":\"{{$propertiesNetworkadaptervendor}}\",\"TunnelType\":\"{{$propertiesTunneltype}}\",\"PreviousRegistryKey\":\"{{$propertiesPreviousregistrykey}}\",\"PreviousRegistryValueData\":\"{{$propertiesPreviousregistryvaluedata}}\",\"PreviousRegistryValueName\":\"{{$propertiesPreviousregistryvaluename}}\",\"RegistryValueType\":\"{{$propertiesRegistryvaluetype}}\",\"DetectionMethods\":\"{{$propertiesDetectionmethods}}\",\"FileType\":\"{{$propertiesFiletype}}\",\"RecipientEmailAddress\":\"{{$propertiesRecipientemailaddress}}\",\"RecipientObjectId\":\"{{$propertiesRecipientobjectid}}\",\"SenderDisplayName\":\"{{$propertiesSenderdisplayname}}\",\"SenderFromAddress\":\"{{$propertiesSenderfromaddress}}\",\"SenderObjectId\":\"{{$propertiesSenderobjectid}}\",\"ThreatNames\":\"{{$propertiesThreatnames}}\",\"ThreatTypes\":\"{{$propertiesThreattypes}}\",\"AttachmentCount\":\"{{$propertiesAttachmentcount}}\",\"AuthenticationDetails\":\"{{$propertiesAuthenticationdetails}}\",\"ConfidenceLevel\":\"{{$propertiesConfidencelevel}}\",\"Connectors\":\"{{$propertiesConnectors}}\",\"DeliveryAction\":\"{{$propertiesDeliveryaction}}\",\"DeliveryLocation\":\"{{$propertiesDeliverylocation}}\",\"EmailAction\":\"{{$propertiesEmailaction}}\",\"EmailActionPolicy\":\"{{$propertiesEmailactionpolicy}}\",\"EmailActionPolicyGuid\":\"{{$propertiesEmailactionpolicyguid}}\",\"EmailClusterId\":\"{{$propertiesEmailclusterid}}\",\"EmailDirection\":\"{{$propertiesEmaildirection}}\",\"EmailLanguage\":\"{{$propertiesEmaillanguage}}\",\"InternetMessageId\":\"{{$propertiesInternetmessageid}}\",\"OrgLevelAction\":\"{{$propertiesOrglevelaction}}\",\"OrgLevelPolicy\":\"{{$propertiesOrglevelpolicy}}\",\"SenderFromDomain\":\"{{$propertiesSenderfromdomain}}\",\"SenderIPv4\":\"{{$propertiesSenderipv4}}\",\"SenderIPv6\":\"{{$propertiesSenderipv6}}\",\"SenderMailFromAddress\":\"{{$propertiesSendermailfromaddress}}\",\"SenderMailFromDomain\":\"{{$propertiesSendermailfromdomain}}\",\"Subject\":\"{{$propertiesSubject}}\",\"UrlCount\":\"{{$propertiesUrlcount}}\",\"UserLevelAction\":\"{{$propertiesUserlevelaction}}\",\"UserLevelPolicy\":\"{{$propertiesUserlevelpolicy}}\",\"Url\":\"{{$propertiesUrl}}\",\"UrlDomain\":\"{{$propertiesUrldomain}}\",\"UrlLocation\":\"{{$propertiesUrllocation}}\",\"ActionResult\":\"{{$propertiesActionresult}}\",\"ActionTrigger\":\"{{$propertiesActiontrigger}}\",\"Action\":\"{{$propertiesAction}}\",\"IsClickedThrough\":\"{{$propertiesIsclickedthrough}}\",\"UrlChain\":\"{{$propertiesUrlchain}}\",\"Workload\":\"{{$propertiesWorkload}}\"},\"tenantId\":\"{{$tenantId}}\",\"time\":\"{{$time}}\",\"_TimeReceivedBySvc\":\"{{$_TimeReceivedBySvc}}\"}",
    "event": {
        "dataset": "m365_defender.event"
    },
    "input": {
        "type": "azure-eventhub"
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "m365_defender-event"
    ]
}
