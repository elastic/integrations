{{- $id := generate "id" }}
{{- $incidentWebUrl := generate "incidentWebUrl" }}
{{- $redirectIncidentId := generate "redirectIncidentId" }}
{{- $tenantId := generate "tenantId" }}
{{- $displayName := generate "displayName" }}
{{- $createdDateTime := generate "createdDateTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $lastUpdateDateTime := generate "lastUpdateDateTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $assignedTo := generate "assignedTo" }}
{{- $classification := generate "classification" }}
{{- $determination := generate "determination" }}
{{- $status := generate "status" }}
{{- $severity := generate "severity" }}
{{- $tags := generate "tags" }}
{{- $comments := generate "comments" }}
{{- $alertsId := generate "alerts.id" }}
{{- $alertsProvideralertid := generate "alerts.providerAlertId" }}
{{- $alertsIncidentid := generate "alerts.incidentId" }}
{{- $alertsStatus := generate "alerts.status" }}
{{- $alertsSeverity := generate "alerts.severity" }}
{{- $alertsClassification := generate "alerts.classification" }}
{{- $alertsDetermination := generate "alerts.determination" }}
{{- $alertsServicesource := generate "alerts.serviceSource" }}
{{- $alertsDetectionsource := generate "alerts.detectionSource" }}
{{- $alertsDetectorid := generate "alerts.detectorId" }}
{{- $alertsTenantid := generate "alerts.tenantId" }}
{{- $alertsTitle := generate "alerts.title" }}
{{- $alertsDescription := generate "alerts.description" }}
{{- $alertsRecommendedactions := generate "alerts.recommendedActions" }}
{{- $alertsCategory := generate "alerts.category" }}
{{- $alertsAssignedto := generate "alerts.assignedTo" }}
{{- $alertsAlertweburl := generate "alerts.alertWebUrl" }}
{{- $alertsIncidentweburl := generate "alerts.incidentWebUrl" }}
{{- $alertsActordisplayname := generate "alerts.actorDisplayName" }}
{{- $alertsThreatdisplayname := generate "alerts.threatDisplayName" }}
{{- $alertsThreatfamilyname := generate "alerts.threatFamilyName" }}
{{- $alertsMitretechniques := generate "alerts.mitreTechniques" }}
{{- $alertsCreateddatetime := generate "alerts.createdDateTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $alertsLastupdatedatetime := generate "alerts.lastUpdateDateTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $alertsResolveddatetime := generate "alerts.resolvedDateTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $alertsFirstactivitydatetime := generate "alerts.firstActivityDateTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $alertsLastactivitydatetime := generate "alerts.lastActivityDateTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $alertsComments := generate "alerts.comments" }}
{{- $alertsEvidenceAppid := generate "alerts.evidence.appId" }}
{{- $alertsEvidenceCreateddatetime := generate "alerts.evidence.createdDateTime" | date "2006-01-02T15:04:05.000000Z" }}
{{- $alertsEvidenceDisplayname := generate "alerts.evidence.displayName" }}
{{- $alertsEvidenceInstanceid := generate "alerts.evidence.instanceId" }}
{{- $alertsEvidenceInstancename := generate "alerts.evidence.instanceName" }}
{{- $alertsEvidenceRemediationstatus := generate "alerts.evidence.remediationStatus" }}
{{- $alertsEvidenceRemediationstatusdetails := generate "alerts.evidence.remediationStatusDetails" }}
{{- $alertsEvidenceRoles := generate "alerts.evidence.roles" }}
{{- $alertsEvidenceSaasappid := generate "alerts.evidence.saasAppId" }}
{{- $alertsEvidenceTags := generate "alerts.evidence.tags" }}
{{- $alertsEvidenceVerdict := generate "alerts.evidence.verdict" }}
{{- $customTags := generate "customTags" }}
{{- /*
{
  "id": "{{$id}}",
  "incidentWebUrl": "{{$incidentWebUrl}}",
  "redirectIncidentId": "{{$redirectIncidentId}}",
  "tenantId": "{{$tenantId}}",
  "displayName": "{{$displayName}}",
  "createdDateTime": "{{$createdDateTime}}",
  "lastUpdateDateTime": "{{$lastUpdateDateTime}}",
  "assignedTo": "{{$assignedTo}}",
  "classification": "{{$classification}}",
  "determination": "{{$determination}}",
  "status": "{{$status}}",
  "severity": "{{$severity}}",
  "tags": [ "{{$tags}}" ],
  "comments": [ "{{$comments}}" ],
  "alerts": {
    "id": "{{$alertsId}}",
    "providerAlertId": "{{$alertsProvideralertid}}",
    "incidentId": "{{$alertsIncidentid}}",
    "status": "{{$alertsStatus}}",
    "severity": "{{$alertsSeverity}}",
    "classification": "{{$alertsClassification}}",
    "determination": "{{$alertsDetermination}}",
    "serviceSource": "{{$alertsServicesource}}",
    "detectionSource": "{{$alertsDetectionsource}}",
    "detectorId": "{{$alertsDetectorid}}",
    "tenantId": "{{$alertsTenantid}}",
    "title": "{{$alertsTitle}}",
    "description": "{{$alertsDescription}}",
    "recommendedActions": "{{$alertsRecommendedactions}}",
    "category": "{{$alertsCategory}}",
    "assignedTo": "{{$alertsAssignedto}}",
    "alertWebUrl": "{{$alertsAlertweburl}}",
    "incidentWebUrl": "{{$alertsIncidentweburl}}",
    "actorDisplayName": "{{$alertsActordisplayname}}",
    "threatDisplayName": "{{$alertsThreatdisplayname}}",
    "threatFamilyName": "{{$alertsThreatfamilyname}}",
    "mitreTechniques": [ "{{$alertsMitretechniques}}" ],
    "createdDateTime": "{{$alertsCreateddatetime}}",
    "lastUpdateDateTime": "{{$alertsLastupdatedatetime}}",
    "resolvedDateTime": "{{$alertsResolveddatetime}}",
    "firstActivityDateTime": "{{$alertsFirstactivitydatetime}}",
    "lastActivityDateTime": "{{$alertsLastactivitydatetime}}",
    "comments": [ "{{$alertsComments}}" ],
    "evidence": [
      {
        "appId": "{{$alertsEvidenceAppid}}",
        "createdDateTime": "{{$alertsEvidenceCreateddatetime}}",
        "displayName": "{{$alertsEvidenceDisplayname}}",
        "instanceId": "{{$alertsEvidenceInstanceid}}",
        "instanceName": "{{$alertsEvidenceInstancename}}",
        "remediationStatus": "{{$alertsEvidenceRemediationstatus}}",
        "remediationStatusDetails": "{{$alertsEvidenceRemediationstatusdetails}}",
        "roles": [ "{{$alertsEvidenceRoles}}" ],
        "saasAppId": "{{$alertsEvidenceSaasappid}}",
        "tags": [ "{{$alertsEvidenceTags}}" ],
        "verdict": "{{$alertsEvidenceVerdict}}"
      }
    ]
  },
  "customTags": [ "{{$customTags}}" ]
}
*/ -}}
{
    "agent": {
        "ephemeral_id": "cdaaaabb-be7e-432f-816b-bda019fd7c15",
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.18.0"
    },
    "data_stream": {
        "dataset": "m365_defender.incident",
        "namespace": "93724",
        "type": "logs"
    },
    "elastic_agent": {
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "snapshot": false,
        "version": "8.18.0"
    },
    "message": "{\"id\":\"{{$id}}\",\"incidentWebUrl\":\"{{$incidentWebUrl}}\",\"redirectIncidentId\":\"{{$redirectIncidentId}}\",\"tenantId\":\"{{$tenantId}}\",\"displayName\":\"{{$displayName}}\",\"createdDateTime\":\"{{$createdDateTime}}\",\"lastUpdateDateTime\":\"{{$lastUpdateDateTime}}\",\"assignedTo\":\"{{$assignedTo}}\",\"classification\":\"{{$classification}}\",\"determination\":\"{{$determination}}\",\"status\":\"{{$status}}\",\"severity\":\"{{$severity}}\",\"tags\":[\"{{$tags}}\"],\"comments\":[\"{{$comments}}\"],\"alerts\":{\"id\":\"{{$alertsId}}\",\"providerAlertId\":\"{{$alertsProvideralertid}}\",\"incidentId\":\"{{$alertsIncidentid}}\",\"status\":\"{{$alertsStatus}}\",\"severity\":\"{{$alertsSeverity}}\",\"classification\":\"{{$alertsClassification}}\",\"determination\":\"{{$alertsDetermination}}\",\"serviceSource\":\"{{$alertsServicesource}}\",\"detectionSource\":\"{{$alertsDetectionsource}}\",\"detectorId\":\"{{$alertsDetectorid}}\",\"tenantId\":\"{{$alertsTenantid}}\",\"title\":\"{{$alertsTitle}}\",\"description\":\"{{$alertsDescription}}\",\"recommendedActions\":\"{{$alertsRecommendedactions}}\",\"category\":\"{{$alertsCategory}}\",\"assignedTo\":\"{{$alertsAssignedto}}\",\"alertWebUrl\":\"{{$alertsAlertweburl}}\",\"incidentWebUrl\":\"{{$alertsIncidentweburl}}\",\"actorDisplayName\":\"{{$alertsActordisplayname}}\",\"threatDisplayName\":\"{{$alertsThreatdisplayname}}\",\"threatFamilyName\":\"{{$alertsThreatfamilyname}}\",\"mitreTechniques\":[\"{{$alertsMitretechniques}}\"],\"createdDateTime\":\"{{$alertsCreateddatetime}}\",\"lastUpdateDateTime\":\"{{$alertsLastupdatedatetime}}\",\"resolvedDateTime\":\"{{$alertsResolveddatetime}}\",\"firstActivityDateTime\":\"{{$alertsFirstactivitydatetime}}\",\"lastActivityDateTime\":\"{{$alertsLastactivitydatetime}}\",\"comments\":[\"{{$alertsComments}}\"],\"evidence\":[{\"appId\":\"{{$alertsEvidenceAppid}}\",\"createdDateTime\":\"{{$alertsEvidenceCreateddatetime}}\",\"displayName\":\"{{$alertsEvidenceDisplayname}}\",\"instanceId\":\"{{$alertsEvidenceInstanceid}}\",\"instanceName\":\"{{$alertsEvidenceInstancename}}\",\"remediationStatus\":\"{{$alertsEvidenceRemediationstatus}}\",\"remediationStatusDetails\":\"{{$alertsEvidenceRemediationstatusdetails}}\",\"roles\":[\"{{$alertsEvidenceRoles}}\"],\"saasAppId\":\"{{$alertsEvidenceSaasappid}}\",\"tags\":[\"{{$alertsEvidenceTags}}\"],\"verdict\":\"{{$alertsEvidenceVerdict}}\"}]},\"customTags\":[\"{{$customTags}}\"]}",
    "event": {
        "dataset": "m365_defender.incident"
    },
    "input": {
        "type": "httpjson"
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "m365_defender-incident"
    ]
}
