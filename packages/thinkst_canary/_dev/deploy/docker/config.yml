rules:
  - path: /api/v1/incidents/all
    methods: [GET]
    query_params:
      auth_token: letmein
      incidents_since: 1
      cursor: null
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "cursor": {
              "next": "MTE6MTA6MTQ0OjE6MjowOjI6NQ==",
              "next_link": "https://EXAMPLE.canary.tools/api/v1/incidents/all?cursor=MTE6MTA6MTQ0OjE6MjowOjI6NQ%3D%3D&auth_token=<auth_token>",
              "prev": null,
              "prev_link": null
            },
            "feed": "All Incidents",
            "incidents": [
              {
                "description": {
                  "acknowledged": "False",
                  "created": "1586249623",
                  "created_std": "2020-04-07 08:53:43 UTC+0000",
                  "description": "Canarytoken triggered",
                  "dst_host": "81.2.69.144",
                  "dst_port": "80",
                  "events": [
                    {
                      "canarytoken": "<token_code>",
                      "dst_port": 80,
                      "event_name": "",
                      "headers": {
                        "Accept": "*/*",
                        "Accept-Encoding": "gzip, deflate",
                        "Connection": "close",
                        "User-Agent": ""
                      },
                      "src_host": "",
                      "timestamp": 1586249623,
                      "timestamp_std": "2020-04-07 08:53:43 UTC+0000",
                      "type": "aws-id"
                    }
                  ],
                  "events_count": "1",
                  "local_time": "2020-04-07 08:53:43 (UTC)",
                  "logtype": "17012",
                  "memo": "Example Memo",
                  "name": "N/A",
                  "node_id": "<node_id>",
                  "notified": "False",
                  "src_host": "216.160.83.56",
                  "src_port": "0"
                },
                "hash_id": "<hash_id>",
                "id": "<incident_key>",
                "summary": "Canarytoken triggered",
                "updated": "Tue, 07 Apr 2020 08:53:43 GMT",
                "updated_id": 10,
                "updated_std": "2020-04-07 08:53:43 UTC+0000",
                "updated_time": "1586249623"
              }
            ],
            "max_updated_id": 10,
            "result": "success",
            "updated": "Tue, 07 Apr 2020 08:53:43 GMT",
            "updated_std": "2020-04-07 08:53:43 UTC+0000",
            "updated_timestamp": 1586249623
          }
  - path: /api/v1/incidents/all
    methods: [GET]
    query_params:
      auth_token: letmein
      cursor: "MTE6MTA6MTQ0OjE6MjowOjI6NQ=="
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "cursor": {
              "next": null,
              "next_link": null,
              "prev": null,
              "prev_link": null
            },
            "feed": "All Incidents",
            "incidents": [
              {
                "description": {
                  "acknowledged": "False",
                  "created": "1586253623",
                  "created_std": "2020-04-07 10:00:23 UTC+0000",
                  "description": "Canarytoken triggered",
                  "dst_host": "5.6.7.8",
                  "dst_port": "80",
                  "events": [
                    {
                      "canarytoken": "<token_code>",
                      "dst_port": 80,
                      "event_name": "",
                      "headers": {
                        "Accept": "*/*",
                        "Accept-Encoding": "gzip, deflate",
                        "Connection": "close",
                        "User-Agent": ""
                      },
                      "src_host": "",
                      "timestamp": 1586253623,
                      "timestamp_std": "2020-04-07 10:00:23 UTC+0000",
                      "type": "aws-id"
                    }
                  ],
                  "events_count": "1",
                  "local_time": "2020-04-07 10:00:23 (UTC)",
                  "logtype": "17012",
                  "memo": "Example Memo",
                  "name": "N/A",
                  "node_id": "<node_id>",
                  "notified": "False",
                  "src_host": "8.7.6.5",
                  "src_port": "0"
                },
                "hash_id": "<hash_id>",
                "id": "<incident_key>",
                "summary": "Canarytoken triggered",
                "updated": "Tue, 07 Apr 2020 10:00:23 GMT",
                "updated_id": 11,
                "updated_std": "2020-04-07 10:00:23 UTC+0000",
                "updated_time": "1586253623"
              }
            ],
            "max_updated_id": 11,
            "result": "success",
            "updated": "Tue, 07 Apr 2020 10:00:23 GMT",
            "updated_std": "2020-04-07 10:00:23 UTC+0000",
            "updated_timestamp": 1586253623
          }
  - path: /api/v1/incidents/all
    methods: [GET]
    query_params:
      auth_token: letmein
      incidents_since: 11
      cursor: null
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "cursor": {
              "next": null,
              "next_link": null,
              "prev": null,
              "prev_link": null
            },
            "feed": "All Incidents",
            "incidents": null,
            "result": "success",
            "updated": "Tue, 07 Apr 2020 10:17:03 GMT",
            "updated_std": "2020-04-07 10:17:03 UTC+0000",
            "updated_timestamp": 1586254623
          }

  - path: /api/v1/audit_trail/fetch
    methods: [GET]
    query_params:
      auth_token: letmein
      cursor: null
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
              "audit_trail": [
                  {
                      "action_type": "user_login",
                      "additional_information": null,
                      "flock_id": null,
                      "id": 73,
                      "message": "User admin@company.com logged in",
                      "timestamp": "2020-04-03 12:56:42 UTC+0000",
                      "user": "admin@company.com",
                      "user_browser_agent": "<browser_agent_string>",
                      "user_browser_language": "en-US,en;q=0.9",
                      "user_ip": "81.2.69.144"
                  },
                  {
                      "action_type": "user_login",
                      "additional_information": null,
                      "flock_id": null,
                      "id": 72,
                      "message": "User admin@company.com logged in",
                      "timestamp": "2020-04-03 09:53:59 UTC+0000",
                      "user": "admin@company.com",
                      "user_browser_agent": "<browser_agent_string>",
                      "user_browser_language": "en-US,en;q=0.9",
                      "user_ip": "81.2.69.144"
                  },
                  {
                      "action_type": "user_login",
                      "additional_information": null,
                      "flock_id": null,
                      "id": 71,
                      "message": "User admin@company.com logged in",
                      "timestamp": "2020-04-02 13:40:05 UTC+0000",
                      "user": "admin@company.com",
                      "user_browser_agent": "<browser_agent_string>",
                      "user_browser_language": "en-US,en;q=0.9",
                      "user_ip": "81.2.69.144"
                  },
                  {
                      "action_type": "device_schedule_reboot",
                      "additional_information": null,
                      "flock_id": "flock:default",
                      "id": 70,
                      "message": "User 'API Token' scheduled the device <device_id> to be rebooted",
                      "timestamp": "2020-04-02 13:14:49 UTC+0000",
                      "user": "admin@company.com",
                      "user_browser_agent": "<browser_agent_string>",
                      "user_browser_language": "",
                      "user_ip": "81.2.69.144"
                  },
                  {
                      "action_type": "device_schedule_reboot",
                      "additional_information": null,
                      "flock_id": "flock:default",
                      "id": 69,
                      "message": "User 'API Token' scheduled the device <device_id> to be rebooted",
                      "timestamp": "2020-04-02 13:11:27 UTC+0000",
                      "user": "admin@company.com",
                      "user_browser_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36",
                      "user_browser_language": "",
                      "user_ip": "81.2.69.144"
                  }
              ],
              "cursor": {
                  "next": "MDo2OTo1OjM6MjoxNQ==",
                  "prev": null
              },
              "page_count": 15,
              "page_number": 1,
              "result": "success"
          }
  - path: /api/v1/audit_trail/fetch
    methods: [GET]
    query_params:
      auth_token: letmein
      cursor: "MDo2OTo1OjM6MjoxNQ=="
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
              "audit_trail": [
                  {
                      "action_type": "user_login",
                      "additional_information": null,
                      "flock_id": null,
                      "id": 78,
                      "message": "User admin@company.com logged in",
                      "timestamp": "2020-04-03 17:56:42 UTC+0000",
                      "user": "admin@company.com",
                      "user_browser_agent": "<browser_agent_string>",
                      "user_browser_language": "en-US,en;q=0.9",
                      "user_ip": "81.2.69.144"
                  },
                  {
                      "action_type": "user_login",
                      "additional_information": null,
                      "flock_id": null,
                      "id": 77,
                      "message": "User admin@company.com logged in",
                      "timestamp": "2020-04-03 14:53:59 UTC+0000",
                      "user": "admin@company.com",
                      "user_browser_agent": "<browser_agent_string>",
                      "user_browser_language": "en-US,en;q=0.9",
                      "user_ip": "81.2.69.144"
                  },
                  {
                      "action_type": "user_login",
                      "additional_information": null,
                      "flock_id": null,
                      "id": 76,
                      "message": "User admin@company.com logged in",
                      "timestamp": "2020-04-02 18:40:05 UTC+0000",
                      "user": "admin@company.com",
                      "user_browser_agent": "<browser_agent_string>",
                      "user_browser_language": "en-US,en;q=0.9",
                      "user_ip": "81.2.69.144"
                  },
                  {
                      "action_type": "device_schedule_reboot",
                      "additional_information": null,
                      "flock_id": "flock:default",
                      "id": 75,
                      "message": "User 'API Token' scheduled the device <device_id> to be rebooted",
                      "timestamp": "2020-04-02 18:14:49 UTC+0000",
                      "user": "admin@company.com",
                      "user_browser_agent": "<browser_agent_string>",
                      "user_browser_language": "",
                      "user_ip": "81.2.69.144"
                  },
                  {
                      "action_type": "device_schedule_reboot",
                      "additional_information": null,
                      "flock_id": "flock:default",
                      "id": 74,
                      "message": "User 'API Token' scheduled the device <device_id> to be rebooted",
                      "timestamp": "2020-04-02 18:11:27 UTC+0000",
                      "user": "admin@company.com",
                      "user_browser_agent": "<browser_agent_string>",
                      "user_browser_language": "",
                      "user_ip": "81.2.69.144"
                  }
              ],
              "cursor": {
                  "next": null,
                  "prev": null
              },
              "page_count": 15,
              "page_number": 2,
              "result": "success"
          }
  # - path: /api/v1/audit_trail/fetch
  #   methods: [GET]
  #   query_params:
  #     auth_token: letmein
  #     incidents_since: 11
  #     cursor: null
  #   responses:
  #     - status_code: 200
  #       headers:
  #         Content-Type:
  #           - "application/json"
  #       body: |-
  #         {
  #             "audit_trail": null,
  #             "cursor": {
  #                 "next": null,
  #                 "prev": null
  #             },
  #             "page_count": 0,
  #             "page_number": 0,
  #             "result": "success"
  #         }
