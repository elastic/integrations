receivers:
  kubeletstats:
    endpoint: {{endpoint}}
    collection_interval: {{collection_interval}}
    initial_delay: {{initial_delay}}
    auth_type: {{auth_type}}
{{#if context}}
    context: {{context}}
{{/if}}
{{#if ca_file}}
    ca_file: {{ca_file}}
{{/if}}
{{#if cert_file}}
    cert_file: {{cert_file}}
{{/if}}
{{#if key_file}}
    key_file: {{key_file}}
{{/if}}
{{#if insecure_skip_verify}}
    insecure_skip_verify: {{insecure_skip_verify}}
{{/if}}
{{#if metric_groups}}
    metric_groups:
{{#each metric_groups}}
      - {{this}}
{{/each}}
{{/if}}
{{#if extra_metadata_labels}}
    extra_metadata_labels:
{{#each extra_metadata_labels}}
      - {{this}}
{{/each}}
{{/if}}
{{#if node}}
    node: {{node}}
{{/if}}
{{#if k8s_api_config_auth_type}}
    k8s_api_config:
      auth_type: {{k8s_api_config_auth_type}}
{{#if k8s_api_config_ca_file}}
      ca_file: {{k8s_api_config_ca_file}}
{{/if}}
{{#if k8s_api_config_cert_file}}
      cert_file: {{k8s_api_config_cert_file}}
{{/if}}
{{#if k8s_api_config_key_file}}
      key_file: {{k8s_api_config_key_file}}
{{/if}}
{{#if k8s_api_config_insecure_skip_verify}}
      insecure_skip_verify: {{k8s_api_config_insecure_skip_verify}}
{{/if}}
{{/if}}
{{#if collect_all_network_interfaces_pod}}{{#if collect_all_network_interfaces_node}}
    collect_all_network_interfaces:
      pod: {{collect_all_network_interfaces_pod}}
      node: {{collect_all_network_interfaces_node}}
{{else}}
    collect_all_network_interfaces:
      pod: {{collect_all_network_interfaces_pod}}
{{/if}}{{else}}{{#if collect_all_network_interfaces_node}}
    collect_all_network_interfaces:
      node: {{collect_all_network_interfaces_node}}
{{/if}}{{/if}}
{{#if metrics_container_cpu_node_utilization}}
    metrics:
      k8s.container.cpu.node.utilization:
        enabled: true
{{#if metrics_pod_cpu_node_utilization}}
      k8s.pod.cpu.node.utilization:
        enabled: true
{{/if}}
{{#if metrics_container_memory_node_utilization}}
      k8s.container.memory.node.utilization:
        enabled: true
{{/if}}
{{#if metrics_pod_memory_node_utilization}}
      k8s.pod.memory.node.utilization:
        enabled: true
{{/if}}
{{else}}{{#if metrics_pod_cpu_node_utilization}}
    metrics:
      k8s.pod.cpu.node.utilization:
        enabled: true
{{#if metrics_container_memory_node_utilization}}
      k8s.container.memory.node.utilization:
        enabled: true
{{/if}}
{{#if metrics_pod_memory_node_utilization}}
      k8s.pod.memory.node.utilization:
        enabled: true
{{/if}}
{{else}}{{#if metrics_container_memory_node_utilization}}
    metrics:
      k8s.container.memory.node.utilization:
        enabled: true
{{#if metrics_pod_memory_node_utilization}}
      k8s.pod.memory.node.utilization:
        enabled: true
{{/if}}
{{else}}{{#if metrics_pod_memory_node_utilization}}
    metrics:
      k8s.pod.memory.node.utilization:
        enabled: true
{{/if}}{{/if}}{{/if}}{{/if}}
processors:
  resourcedetection/system:
    detectors: ["system"]
service:
  pipelines:
    metrics:
      receivers: [kubeletstats]
      processors: [resourcedetection/system]
