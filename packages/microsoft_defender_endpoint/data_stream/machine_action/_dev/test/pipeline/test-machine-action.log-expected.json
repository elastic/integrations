{
    "expected": [
        {
            "@timestamp": "2024-11-25T12:59:37.553Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "Unisolate",
                "category": [
                    "network"
                ],
                "created": "2024-11-25T12:59:35.891Z",
                "id": "034e1b7b-1234-5678-abcd-abcdef7b1219",
                "kind": "event",
                "original": "{\"id\":\"034e1b7b-1234-5678-abcd-abcdef7b1219\",\"type\":\"Unisolate\",\"title\":null,\"requestor\":\"user1@example.com\",\"requestorComment\":\"Isolation release\",\"status\":\"Succeeded\",\"machineId\":\"de693d7abcdefabcdefabcdef01f40b5bf2da1d8\",\"computerDnsName\":\"c-lab-24\",\"creationDateTimeUtc\":\"2024-11-25T12:59:35.8912364Z\",\"lastUpdateDateTimeUtc\":\"2024-11-25T12:59:37.5532423Z\",\"cancellationRequestor\":null,\"cancellationComment\":null,\"cancellationDateTimeUtc\":null,\"errorHResult\":0,\"scope\":null,\"externalId\":null,\"requestSource\":\"Portal\",\"relatedFileInfo\":null,\"commands\":[],\"troubleshootInfo\":null}",
                "outcome": "success",
                "type": [
                    "start"
                ]
            },
            "host": {
                "hostname": "c-lab-24",
                "id": "de693d7abcdefabcdefabcdef01f40b5bf2da1d8",
                "name": "c-lab-24"
            },
            "microsoft_defender_endpoint": {
                "machine_action": {
                    "computer_dns_name": "c-lab-24",
                    "creation_date_time_utc": "2024-11-25T12:59:35.891Z",
                    "error_h_result": 0,
                    "id": "034e1b7b-1234-5678-abcd-abcdef7b1219",
                    "last_update_date_time_utc": "2024-11-25T12:59:37.553Z",
                    "machine_id": "de693d7abcdefabcdefabcdef01f40b5bf2da1d8",
                    "request_source": "Portal",
                    "requestor": "user1@example.com",
                    "requestor_comment": "Isolation release",
                    "status": "Succeeded",
                    "type": "Unisolate"
                }
            },
            "observer": {
                "product": "Defender for Endpoint",
                "vendor": "Microsoft"
            },
            "related": {
                "hosts": [
                    "c-lab-24",
                    "de693d7abcdefabcdefabcdef01f40b5bf2da1d8"
                ],
                "user": [
                    "user1",
                    "user1@example.com"
                ]
            },
            "tags": [
                "preserve_duplicate_custom_fields"
            ],
            "user": {
                "domain": "example.com",
                "email": "user1@example.com",
                "name": "user1"
            }
        },
        {
            "@timestamp": "2024-11-22T12:48:56.768Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "RunAntiVirusScan",
                "created": "2024-11-22T12:48:33.993Z",
                "id": "d72456af-1234-5678-abcd-abcdef87fdee",
                "kind": "event",
                "original": "{\"id\":\"d72456af-1234-5678-abcd-abcdef87fdee\",\"type\":\"RunAntiVirusScan\",\"title\":null,\"requestor\":\"testuser@example.com\",\"requestorComment\":\"Quick Scan\",\"status\":\"Succeeded\",\"machineId\":\"de693d7fbdabcdefabcdefcfc9cf40b5bf2da1d8\",\"computerDnsName\":\"c-lab-24\",\"creationDateTimeUtc\":\"2024-11-22T12:48:33.9936591Z\",\"lastUpdateDateTimeUtc\":\"2024-11-22T12:48:56.7684808Z\",\"cancellationRequestor\":null,\"cancellationComment\":null,\"cancellationDateTimeUtc\":null,\"errorHResult\":0,\"scope\":\"Quick\",\"externalId\":null,\"requestSource\":\"Portal\",\"relatedFileInfo\":null,\"commands\":[],\"troubleshootInfo\":null}",
                "outcome": "success",
                "type": [
                    "info"
                ]
            },
            "host": {
                "hostname": "c-lab-24",
                "id": "de693d7fbdabcdefabcdefcfc9cf40b5bf2da1d8",
                "name": "c-lab-24"
            },
            "microsoft_defender_endpoint": {
                "machine_action": {
                    "computer_dns_name": "c-lab-24",
                    "creation_date_time_utc": "2024-11-22T12:48:33.993Z",
                    "error_h_result": 0,
                    "id": "d72456af-1234-5678-abcd-abcdef87fdee",
                    "last_update_date_time_utc": "2024-11-22T12:48:56.768Z",
                    "machine_id": "de693d7fbdabcdefabcdefcfc9cf40b5bf2da1d8",
                    "request_source": "Portal",
                    "requestor": "testuser@example.com",
                    "requestor_comment": "Quick Scan",
                    "scope": "Quick",
                    "status": "Succeeded",
                    "type": "RunAntiVirusScan"
                }
            },
            "observer": {
                "product": "Defender for Endpoint",
                "vendor": "Microsoft"
            },
            "related": {
                "hosts": [
                    "c-lab-24",
                    "de693d7fbdabcdefabcdefcfc9cf40b5bf2da1d8"
                ],
                "user": [
                    "testuser",
                    "testuser@example.com"
                ]
            },
            "tags": [
                "preserve_duplicate_custom_fields"
            ],
            "user": {
                "domain": "example.com",
                "email": "testuser@example.com",
                "name": "testuser"
            }
        },
        {
            "@timestamp": "2025-03-27T08:25:59.909Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "RestrictCodeExecution",
                "category": [
                    "package"
                ],
                "created": "2025-03-24T08:11:54.039Z",
                "id": "01f7d891-1234-5678-abcd-abcdefa2edf3",
                "kind": "event",
                "original": "{\"id\":\"01f7d891-1234-5678-abcd-abcdefa2edf3\",\"type\":\"RestrictCodeExecution\",\"title\":null,\"requestor\":\"alice@example.com\",\"requestorComment\":\"Found suspicious process are running on the machine hence restricting app execution\",\"status\":\"TimeOut\",\"machineId\":\"dc909e4a81d1abcdefabcdef9bebe6f8ec7d3506\",\"computerDnsName\":\"assettag-eid\",\"creationDateTimeUtc\":\"2025-03-24T08:11:54.0392813Z\",\"lastUpdateDateTimeUtc\":\"2025-03-27T08:25:59.9095244Z\",\"cancellationRequestor\":null,\"cancellationComment\":null,\"cancellationDateTimeUtc\":null,\"errorHResult\":-2145844840,\"scope\":null,\"externalId\":null,\"requestSource\":\"PublicApi\",\"relatedFileInfo\":null,\"commands\":[],\"troubleshootInfo\":null}",
                "type": [
                    "access"
                ]
            },
            "host": {
                "hostname": "assettag-eid",
                "id": "dc909e4a81d1abcdefabcdef9bebe6f8ec7d3506",
                "name": "assettag-eid"
            },
            "microsoft_defender_endpoint": {
                "machine_action": {
                    "computer_dns_name": "assettag-eid",
                    "creation_date_time_utc": "2025-03-24T08:11:54.039Z",
                    "error_h_result": -2145844840,
                    "id": "01f7d891-1234-5678-abcd-abcdefa2edf3",
                    "last_update_date_time_utc": "2025-03-27T08:25:59.909Z",
                    "machine_id": "dc909e4a81d1abcdefabcdef9bebe6f8ec7d3506",
                    "request_source": "PublicApi",
                    "requestor": "alice@example.com",
                    "requestor_comment": "Found suspicious process are running on the machine hence restricting app execution",
                    "status": "TimeOut",
                    "type": "RestrictCodeExecution"
                }
            },
            "observer": {
                "product": "Defender for Endpoint",
                "vendor": "Microsoft"
            },
            "related": {
                "hosts": [
                    "assettag-eid",
                    "dc909e4a81d1abcdefabcdef9bebe6f8ec7d3506"
                ],
                "user": [
                    "alice",
                    "alice@example.com"
                ]
            },
            "tags": [
                "preserve_duplicate_custom_fields"
            ],
            "user": {
                "domain": "example.com",
                "email": "alice@example.com",
                "name": "alice"
            }
        },
        {
            "@timestamp": "2025-04-06T10:34:03.689Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "StopAndQuarantineFile",
                "category": [
                    "file"
                ],
                "created": "2025-04-03T10:20:00.154Z",
                "id": "4887e3fb-c5a0-46b5-1234-a26823cdcbba",
                "kind": "event",
                "original": "{\"id\":\"4887e3fb-c5a0-46b5-1234-a26823cdcbba\",\"type\":\"StopAndQuarantineFile\",\"title\":null,\"requestor\":\"admin@example.com\",\"requestorComment\":\"Quarantine Malicious File\",\"status\":\"TimeOut\",\"machineId\":\"dc909e4a81d1bfabcdefabcdefebe6f8ec7d3506\",\"computerDnsName\":\"assettag-eid\",\"creationDateTimeUtc\":\"2025-04-03T10:20:00.154974Z\",\"lastUpdateDateTimeUtc\":\"2025-04-06T10:34:03.6898318Z\",\"cancellationRequestor\":null,\"cancellationComment\":null,\"cancellationDateTimeUtc\":null,\"errorHResult\":-2145844840,\"scope\":null,\"externalId\":null,\"requestSource\":\"PublicApi\",\"relatedFileInfo\":{\"fileIdentifier\":\"aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d\",\"fileIdentifierType\":\"Sha1\"},\"commands\":[],\"troubleshootInfo\":null}",
                "type": [
                    "deletion"
                ]
            },
            "file": {
                "hash": {
                    "sha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d"
                }
            },
            "host": {
                "hostname": "assettag-eid",
                "id": "dc909e4a81d1bfabcdefabcdefebe6f8ec7d3506",
                "name": "assettag-eid"
            },
            "microsoft_defender_endpoint": {
                "machine_action": {
                    "computer_dns_name": "assettag-eid",
                    "creation_date_time_utc": "2025-04-03T10:20:00.154Z",
                    "error_h_result": -2145844840,
                    "id": "4887e3fb-c5a0-46b5-1234-a26823cdcbba",
                    "last_update_date_time_utc": "2025-04-06T10:34:03.689Z",
                    "machine_id": "dc909e4a81d1bfabcdefabcdefebe6f8ec7d3506",
                    "related_file_info": {
                        "file_identifier": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                        "file_identifier_type": "Sha1"
                    },
                    "request_source": "PublicApi",
                    "requestor": "admin@example.com",
                    "requestor_comment": "Quarantine Malicious File",
                    "status": "TimeOut",
                    "type": "StopAndQuarantineFile"
                }
            },
            "observer": {
                "product": "Defender for Endpoint",
                "vendor": "Microsoft"
            },
            "related": {
                "hash": [
                    "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d"
                ],
                "hosts": [
                    "assettag-eid",
                    "dc909e4a81d1bfabcdefabcdefebe6f8ec7d3506"
                ],
                "user": [
                    "admin",
                    "admin@example.com"
                ]
            },
            "tags": [
                "preserve_duplicate_custom_fields"
            ],
            "user": {
                "domain": "example.com",
                "email": "admin@example.com",
                "name": "admin"
            }
        },
        {
            "@timestamp": "2025-03-26T07:25:33.933Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "Isolate",
                "category": [
                    "network"
                ],
                "created": "2025-03-25T10:36:47.296Z",
                "id": "2a800b14-1234-5678-abe4-abcdef42d881",
                "kind": "event",
                "original": "{\"id\":\"2a800b14-1234-5678-abe4-abcdef42d881\",\"type\":\"Isolate\",\"title\":null,\"requestor\":\"admin@example.com\",\"requestorComment\":\"Isolating a device to prevent access to the external network\",\"status\":\"Cancelled\",\"machineId\":\"dc909e4a81d1bfa3abcdefabcdefe6f8ec7d3506\",\"computerDnsName\":\"labtest-eid\",\"creationDateTimeUtc\":\"2025-03-25T10:36:47.2968211Z\",\"lastUpdateDateTimeUtc\":\"2025-03-26T07:25:33.9337697Z\",\"cancellationRequestor\":\"e062d1f9-2398-1234-a024-12345673a25a\",\"cancellationComment\":\"Machine action was canceled by automation\",\"cancellationDateTimeUtc\":\"2025-03-26T07:25:33.9337696Z\",\"errorHResult\":-2147467260,\"scope\":\"Full\",\"externalId\":null,\"requestSource\":\"PublicApi\",\"relatedFileInfo\":null,\"commands\":[],\"troubleshootInfo\":null}",
                "type": [
                    "end"
                ]
            },
            "host": {
                "hostname": "labtest-eid",
                "id": "dc909e4a81d1bfa3abcdefabcdefe6f8ec7d3506",
                "name": "labtest-eid"
            },
            "microsoft_defender_endpoint": {
                "machine_action": {
                    "cancellation_comment": "Machine action was canceled by automation",
                    "cancellation_date_time_utc": "2025-03-26T07:25:33.933Z",
                    "cancellation_requestor": "e062d1f9-2398-1234-a024-12345673a25a",
                    "computer_dns_name": "labtest-eid",
                    "creation_date_time_utc": "2025-03-25T10:36:47.296Z",
                    "error_h_result": -2147467260,
                    "id": "2a800b14-1234-5678-abe4-abcdef42d881",
                    "last_update_date_time_utc": "2025-03-26T07:25:33.933Z",
                    "machine_id": "dc909e4a81d1bfa3abcdefabcdefe6f8ec7d3506",
                    "request_source": "PublicApi",
                    "requestor": "admin@example.com",
                    "requestor_comment": "Isolating a device to prevent access to the external network",
                    "scope": "Full",
                    "status": "Cancelled",
                    "type": "Isolate"
                }
            },
            "observer": {
                "product": "Defender for Endpoint",
                "vendor": "Microsoft"
            },
            "related": {
                "hosts": [
                    "labtest-eid",
                    "dc909e4a81d1bfa3abcdefabcdefe6f8ec7d3506"
                ],
                "user": [
                    "e062d1f9-2398-1234-a024-12345673a25a",
                    "admin",
                    "admin@example.com"
                ]
            },
            "tags": [
                "preserve_duplicate_custom_fields"
            ],
            "user": {
                "domain": "example.com",
                "email": "admin@example.com",
                "name": "admin"
            }
        }
    ]
}
