- name: microsoft_defender_endpoint
  type: group
  fields:
    - name: vulnerability
      type: group
      fields:
        - name: affected_machine
          type: group
          fields:
            - name: aad_device_id
              type: keyword
              description: Microsoft Entra Device ID (when machine is Microsoft Entra joined).
            - name: agent_version
              type: keyword
            - name: computer_dns_name
              type: keyword
              description: Machine fully qualified name.
            - name: device_value
              type: keyword
              description: 'The value of the device. Possible values are: Normal, Low, and High.'
            - name: exclusion_reason
              type: keyword
            - name: exposure_level
              type: keyword
              description: 'Exposure level as evaluated by Microsoft Defender for Endpoint. Possible values are: None, Low, Medium, and High.'
            - name: first_seen
              type: date
              description: First date and time where the machine was observed by Microsoft Defender for Endpoint.
            - name: fixing_kb_id
              type: keyword
            - name: health_status
              type: keyword
              description: 'machine health status. Possible values are: Active, Inactive, ImpairedCommunication, NoSensorData, NoSensorDataImpairedCommunication, and Unknown.'
            - name: id
              type: keyword
            - name: ip_addresses
              type: group
              fields:
                - name: ip_address
                  type: ip
                - name: mac_address
                  type: keyword
                - name: operational_status
                  type: keyword
                - name: type
                  type: keyword
            - name: is_aad_joined
              type: boolean
            - name: is_excluded
              type: boolean
            - name: is_potential_duplication
              type: boolean
            - name: last_external_ip_address
              type: ip
              description: Last IP through which the machine accessed the internet.
            - name: last_ip_address
              type: ip
              description: Last IP on local NIC on the machine.
            - name: last_seen
              type: date
              description: 'Time and date of the last received full device report. A device typically sends a full report every 24 hours. NOTE: This property doesn''t correspond to the last seen value in the UI. It pertains to the last device update.'
            - name: machine_id
              type: keyword
              description: Machine identity.
            - name: machine_tags
              type: keyword
              description: Set of machine tags.
            - name: managed_by
              type: keyword
            - name: managed_by_status
              type: keyword
            - name: merged_into_machine_id
              type: keyword
            - name: onboarding_status
              type: keyword
              description: 'Status of machine onboarding. Possible values are: onboarded, CanBeOnboarded, Unsupported, and InsufficientInfo.'
            - name: os_architecture
              type: keyword
              description: 'Operating system architecture. Possible values are: 32-bit, 64-bit. Use this property instead of osProcessor.'
            - name: os_build
              type: long
              description: Operating system build number.
            - name: os_platform
              type: keyword
              description: Operating system platform.
            - name: os_processor
              type: keyword
              description: Operating system processor. Use osArchitecture property instead.
            - name: os_version
              type: keyword
            - name: product_name
              type: keyword
            - name: product_vendor
              type: keyword
            - name: product_version
              type: keyword
            - name: rbac_group_id
              type: keyword
              description: Machine group ID.
            - name: rbac_group_name
              type: keyword
              description: Machine group Name.
            - name: risk_score
              type: keyword
              description: 'Risk score as evaluated by Microsoft Defender for Endpoint. Possible values are: None, Informational, Low, Medium, and High.'
            - name: severity
              type: keyword
            - name: version
              type: keyword
              description: Operating system version.
            - name: vmMetadata
              type: group
              fields:
                - name: cloud_provider
                  type: keyword
                - name: resource_id
                  type: keyword
                - name: subscription_id
                  type: keyword
                - name: vm_id
                  type: keyword
        - name: cve_supportability
          type: keyword
          description: 'Possible values are: Supported, Not Supported, or SupportedInPremium.'
        - name: cvss_v3
          type: double
          description: CVSS v3 score.
        - name: cvss_vector
          type: keyword
          description: A compressed textual representation that reflects the values used to derive the score.
        - name: description
          type: keyword
          description: Vulnerability description.
        - name: epss
          type: double
          description: Represents the probability that a vulnerability will be exploited. This probability is expressed as a number between 0 and 1 (0%-100%) according to the EPSS model.
        - name: exploit_in_kit
          type: boolean
          description: Exploit is part of an exploit kit.
        - name: exploit_types
          type: keyword
          description: 'Exploit affect. Possible values are: Local privilege escalation, Denial of service, or Local.'
        - name: exploit_uris
          type: keyword
          description: Exploit source URLs.
        - name: exploit_verified
          type: boolean
          description: Exploit is verified to work.
        - name: exposed_machines
          type: long
          description: Number of exposed devices.
        - name: first_detected
          type: date
        - name: id
          type: keyword
          description: Vulnerability ID.
        - name: impact
          type: keyword
        - name: name
          type: keyword
          description: Vulnerability title.
        - name: patch_first_available
          type: date
        - name: public_exploit
          type: boolean
          description: Public exploit exists.
        - name: published_on
          type: date
          description: Date when vulnerability was published.
        - name: remediation
          type: keyword
        - name: severity
          type: keyword
          description: 'Vulnerability Severity. Possible values are: Low, Medium, High, or Critical.'
        - name: tags
          type: keyword
        - name: updated_on
          type: date
          description: Date when vulnerability was updated.
