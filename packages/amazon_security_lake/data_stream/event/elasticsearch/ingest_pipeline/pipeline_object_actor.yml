---
description: Pipeline for processing Actor object.
# Actor object docs: https://schema.ocsf.io/1.1.0/objects/actor?extensions=
processors:
  - set:
      field: container.id
      tag: set_container_id
      copy_from: ocsf.actor.process.container.uid
      ignore_empty_value: true
  - script:
      description: Set value for container.image.hash.all.
      if: ctx.ocsf?.actor?.process?.container?.hash?.value != null
      tag: script_container_image_hash_all
      lang: painless
      params:
        MD5: md5
        SHA-1: sha1
        SHA-256: sha256
        SHA-512: sha512
        CTPH: ssdeep
        TLSH: tlsh
      source: |-
        if (params.get(ctx.ocsf.actor.process.container.hash.algorithm) == null) {
          return;
        }
        if (ctx.container == null) {
          ctx.container = new HashMap();
        }
        if (ctx.container.image == null) {
          ctx.container.image = new HashMap();
        }
        if (ctx.container.image.hash == null) {
          ctx.container.image.hash = new HashMap();
        }
        def list = new ArrayList();
        def value = params.get(ctx.ocsf.actor.process.container.hash.algorithm) + ':' + ctx.ocsf.actor.process.container.hash.value;
        list.add(value);
        ctx.container.image.hash.all = list;
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - append:
      field: related.hash
      tag: append_actor_process_container_hash_value_into_related_hash
      value: '{{{ocsf.actor.process.container.hash.value}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.container?.hash?.value != null
  - set:
      field: container.image.name
      tag: set_container_image_name
      copy_from: ocsf.actor.process.container.image.name
      ignore_empty_value: true
  - append:
      field: container.image.tag
      tag: append_actor_process_container_image_tag_into_container_image_tag
      value: '{{{ocsf.actor.process.container.image.tag}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.container?.image?.tag != null
  - set:
      field: container.labels
      tag: set_container_labels
      copy_from: ocsf.actor.process.container.image.labels
      ignore_empty_value: true
  - set:
      field: orchestrator.type
      tag: set_orchestrator_type
      copy_from: ocsf.actor.process.container.orchestrator
      ignore_empty_value: true
  - set:
      field: container.name
      tag: set_container_name
      copy_from: ocsf.actor.process.container.name
      ignore_empty_value: true
  - set:
      field: container.runtime
      tag: set_container_runtime
      copy_from: ocsf.actor.process.container.runtime
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.file.accessed_time_dt
      target_field: ocsf.actor.process.file.accessed_time_dt
      tag: date_actor_process_file_accessed_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.file?.accessed_time_dt != null && ctx.ocsf.actor.process.file.accessed_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.file.accessed_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: file.accessed
      tag: set_file_accessed_from_actor_process_file_accessed_time_dt
      copy_from: ocsf.actor.process.file.accessed_time_dt
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.file.accessed_time
      target_field: ocsf.actor.process.file.accessed_time
      tag: date_actor_process_file_accessed_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.file?.accessed_time != null && ctx.ocsf.actor.process.file.accessed_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.file.accessed_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: file.accessed
      tag: set_file_accessed_from_actor_process_file_accessed_time
      copy_from: ocsf.actor.process.file.accessed_time
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.file.created_time_dt
      target_field: ocsf.actor.process.file.created_time_dt
      tag: date_actor_process_file_created_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.file?.created_time_dt != null && ctx.ocsf.actor.process.file.created_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.file.created_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: file.created
      tag: set_file_created_actor_process_file_created_time_dt
      copy_from: ocsf.actor.process.file.created_time_dt
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.file.created_time
      target_field: ocsf.actor.process.file.created_time
      tag: date_actor_process_file_created_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.file?.created_time != null && ctx.ocsf.actor.process.file.created_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.file.created_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: file.created
      tag: set_file_created_actor_process_file_created_time
      copy_from: ocsf.actor.process.file.created_time
      ignore_empty_value: true
  - set:
      field: file.directory
      tag: set_file_directory
      copy_from: ocsf.actor.process.file.parent_folder
      ignore_empty_value: true
  - script:
      description: Set value for file.hash.*.
      if: ctx.ocsf?.actor?.process?.file?.hashes != null
      tag: script_file_hash_*
      lang: painless
      params:
        MD5: md5
        SHA-1: sha1
        SHA-256: sha256
        SHA-512: sha512
        CTPH: ssdeep
        TLSH: tlsh
      source: |-
        if (ctx.file == null) {
          ctx.file = new HashMap();
        }
        if (ctx.file.hash == null) {
          ctx.file.hash = new HashMap();
        }
        Map map = new HashMap();
        def hashes = ctx.ocsf.actor.process.file.get('hashes');
        for (def hash: hashes) {
          def hashAlgorithm = params.get(hash.get('algorithm'));
          if (hashAlgorithm == null) {
            continue;
          }
          if (map.containsKey(hashAlgorithm)) {
            map[hashAlgorithm].add(hash.get('value'));
          } else {
            Set set = new HashSet();
            set.add(hash.get('value'));
            map.put(hashAlgorithm, set);
          }
        }
        ctx.file.hash = map;
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: ocsf.actor.process.file.hashes
      if: ctx.ocsf?.actor?.process?.file?.hashes instanceof List
      ignore_failure: true
      processor:
        append:
          field: related.hash
          tag: append_actor_process_file_hashes_value_into_related_hash
          value: '{{{_ingest._value.value}}}'
          allow_duplicates: false
  - set:
      field: file.inode
      tag: set_file_inode
      copy_from: ocsf.actor.process.file.uid
      ignore_empty_value: true
  - set:
      field: file.mime_type
      tag: set_file_mime_type
      copy_from: ocsf.actor.process.file.mime_type
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.file.modified_time_dt
      target_field: ocsf.actor.process.file.modified_time_dt
      tag: date_actor_process_file_modified_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.file?.modified_time_dt != null && ctx.ocsf.actor.process.file.modified_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.file.modified_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: file.mtime
      tag: set_file_mtime_from_actor_process_file_modified_time_dt
      copy_from: ocsf.actor.process.file.modified_time_dt
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.file.modified_time
      target_field: ocsf.actor.process.file.modified_time
      tag: date_actor_process_file_modified_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.file?.modified_time != null && ctx.ocsf.actor.process.file.modified_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.file.modified_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: file.mtime
      tag: set_file_mtime_from_actor_process_file_modified_time
      copy_from: ocsf.actor.process.file.modified_time
      ignore_empty_value: true
  - set:
      field: file.name
      tag: set_file_name
      copy_from: ocsf.actor.process.file.name
      ignore_empty_value: true
  - set:
      field: file.owner
      tag: set_file_owner
      copy_from: ocsf.actor.process.file.owner.name
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_actor_process_file_owner_name_into_related_user
      value: '{{{ocsf.actor.process.file.owner.name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.owner?.name != null
  - set:
      field: file.path
      tag: set_file_path
      copy_from: ocsf.actor.process.file.path
      ignore_empty_value: true
  - convert:
      field: ocsf.actor.process.file.size
      tag: convert_actor_process_file_size_to_long
      type: long
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.file.size
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: file.size
      tag: set_file_size
      copy_from: ocsf.actor.process.file.size
      ignore_empty_value: true
  - set:
      field: file.type
      tag: set_file_type
      copy_from: ocsf.actor.process.file.type
      ignore_empty_value: true
  - set:
      field: file.uid
      tag: set_file_uid
      copy_from: ocsf.actor.process.file.owner.uid
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_actor_process_file_owner_uid_into_related_user
      value: '{{{ocsf.actor.process.file.owner.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.owner?.uid != null
  - set:
      field: file.x509.issuer.distinguished_name
      tag: set_file_x509_issuer_distinguished_name
      copy_from: ocsf.actor.process.file.signature.certificate.issuer
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.file.signature.certificate.expiration_time_dt
      target_field: ocsf.actor.process.file.signature.certificate.expiration_time_dt
      tag: date_actor_process_file_signature_certificate_expiration_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.file?.signature?.certificate?.expiration_time_dt != null && ctx.ocsf.actor.process.file.signature.certificate.expiration_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.file.signature.certificate.expiration_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: file.x509.not_after
      tag: set_file_x509_not_after_from_actor_process_file_signature_certificate_expiration_time_dt
      copy_from: ocsf.actor.process.file.signature.certificate.expiration_time_dt
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.file.signature.certificate.expiration_time
      target_field: ocsf.actor.process.file.signature.certificate.expiration_time
      tag: date_actor_process_file_signature_certificate_expiration_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.file?.signature?.certificate?.expiration_time != null && ctx.ocsf.actor.process.file.signature.certificate.expiration_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.file.signature.certificate.expiration_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: file.x509.not_after
      tag: set_file_x509_not_after_from_actor_process_file_signature_certificate_expiration_time
      copy_from: ocsf.actor.process.file.signature.certificate.expiration_time
      ignore_empty_value: true
  - set:
      field: file.x509.serial_number
      tag: set_file_x509_serial_number
      copy_from: ocsf.actor.process.file.signature.certificate.serial_number
      ignore_empty_value: true
  - set:
      field: file.x509.subject.distinguished_name
      tag: set_file_x509_subject_distinguished_name
      copy_from: ocsf.actor.process.file.signature.certificate.subject
      ignore_empty_value: true
  - set:
      field: file.x509.version_number
      tag: set_file_x509_version_number
      copy_from: ocsf.actor.process.file.signature.certificate.version
      ignore_empty_value: true
  - set:
      field: process.command_line
      tag: set_process_command_line
      copy_from: ocsf.actor.process.cmd_line
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.terminated_time_dt
      target_field: ocsf.actor.process.terminated_time_dt
      tag: date_actor_process_terminated_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.terminated_time_dt != null && ctx.ocsf.actor.process.terminated_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.terminated_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.end
      tag: set_process_end_from_actor_process_terminated_time_dt
      copy_from: ocsf.actor.process.terminated_time_dt
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.terminated_time
      target_field: ocsf.actor.process.terminated_time
      tag: date_actor_process_terminated_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.terminated_time != null && ctx.ocsf.actor.process.terminated_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.terminated_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.end
      tag: set_process_end_from_actor_process_terminated_time
      copy_from: ocsf.actor.process.terminated_time
      ignore_empty_value: true
  - convert:
      field: ocsf.actor.process.egid
      tag: convert_actor_process_egid_to_string
      type: string
      ignore_missing: true
  - append:
      field: process.group.id
      tag: append_process_group_id_from_actor_process_egid
      value: '{{{ocsf.actor.process.egid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.egid != null
  - append:
      field: process.group.id
      tag: append_process_group_id_from_actor_process_group_uid
      value: '{{{ocsf.actor.process.group.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.group?.uid != null
  - set:
      field: process.group.name
      tag: set_process_group_name
      copy_from: ocsf.actor.process.group.name
      ignore_empty_value: true
  - set:
      field: process.name
      tag: set_process_name
      copy_from: ocsf.actor.process.name
      ignore_empty_value: true
  - convert:
      field: ocsf.actor.process.pid
      tag: convert_actor_process_pid_to_long
      type: long
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.pid
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.pid
      tag: set_process_pid
      copy_from: ocsf.actor.process.pid
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.created_time_dt
      target_field: ocsf.actor.process.created_time_dt
      tag: date_actor_process_created_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.created_time_dt != null && ctx.ocsf.actor.process.created_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.created_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.start
      tag: set_process_start_from_actor_process_created_time_dt
      copy_from: ocsf.actor.process.created_time_dt
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.created_time
      target_field: ocsf.actor.process.created_time
      tag: date_actor_process_created_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.created_time != null && ctx.ocsf.actor.process.created_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.created_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.start
      tag: set_process_start_from_actor_process_created_time
      copy_from: ocsf.actor.process.created_time
      ignore_empty_value: true
  - convert:
      field: ocsf.actor.process.tid
      tag: convert_actor_process_tid_to_long
      type: long
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.tid
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.thread.id
      tag: set_process_thread_id
      copy_from: ocsf.actor.process.tid
      ignore_empty_value: true
  - set:
      field: process.entity_id
      tag: set_process_entity_id
      copy_from: ocsf.actor.process.uid
      ignore_empty_value: true
  - set:
      field: process.user.domain
      tag: set_process_user_domain
      copy_from: ocsf.actor.process.user.domain
      ignore_empty_value: true
  - set:
      field: process.user.email
      tag: set_process_user_email
      copy_from: ocsf.actor.process.user.email_addr
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_actor_process_user_email_addr_into_related_user
      value: '{{{ocsf.actor.process.user.email_addr}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.user?.email_addr != null
  - set:
      field: process.user.full_name
      tag: set_process_user_full_name
      copy_from: ocsf.actor.process.user.full_name
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_actor_process_user_full_name_into_related_user
      value: '{{{ocsf.actor.process.user.full_name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.user?.full_name != null
  - foreach:
      field: ocsf.actor.process.user.groups
      if: ctx.ocsf?.actor?.process?.user?.groups instanceof List
      ignore_failure: true
      processor:
        append:
          field: process.user.group.id
          tag: append_process_user_group_id
          value: '{{{_ingest._value.uid}}}'
          allow_duplicates: false
  - foreach:
      field: ocsf.actor.process.user.groups
      if: ctx.ocsf?.actor?.process?.user?.groups instanceof List
      ignore_failure: true
      processor:
        append:
          field: process.user.group.name
          tag: append_process_user_group_name
          value: '{{{_ingest._value.name}}}'
          allow_duplicates: false
  - convert:
      field: ocsf.actor.process.euid
      tag: convert_actor_process_euid_to_string
      type: string
      ignore_missing: true
  - append:
      field: process.user.id
      tag: append_process_user_id_from_actor_process_euid
      value: '{{{ocsf.actor.process.euid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.euid != null
  - append:
      field: related.user
      tag: append_actor_process_euid_into_related_user
      value: '{{{ocsf.actor.process.euid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.euid != null
  - append:
      field: process.user.id
      tag: append_process_user_id_from_actor_process_uid
      value: '{{{ocsf.actor.process.user.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.user?.uid != null
  - append:
      field: related.user
      tag: append_actor_process_uid_into_related_user
      value: '{{{ocsf.actor.process.user.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.user?.uid != null
  - set:
      field: process.user.name
      tag: set_process_user_name
      copy_from: ocsf.actor.process.user.name
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_actor_process_user_name_into_related_user
      value: '{{{ocsf.actor.process.user.name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.user?.name != null
  - set:
      field: user.domain
      tag: set_user_domain
      copy_from: ocsf.actor.user.domain
      ignore_empty_value: true
  - set:
      field: user.email
      tag: set_user_email
      copy_from: ocsf.actor.user.email_addr
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_actor_user_email_addr_into_related_user
      value: '{{{ocsf.actor.user.email_addr}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.user?.email_addr != null
  - set:
      field: user.full_name
      tag: set_user_full_name
      copy_from: ocsf.actor.user.full_name
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_actor_user_full_name_into_related_user
      value: '{{{ocsf.actor.user.full_name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.user?.full_name != null
  - foreach:
      field: ocsf.actor.user.groups
      if: ctx.ocsf?.actor?.user?.groups instanceof List
      ignore_failure: true
      processor:
        append:
          field: user.group.id
          tag: append_user_group_id
          value: '{{{_ingest._value.uid}}}'
          allow_duplicates: false
  - foreach:
      field: ocsf.actor.user.groups
      if: ctx.ocsf?.actor?.user?.groups instanceof List
      ignore_failure: true
      processor:
        append:
          field: user.group.name
          tag: append_user_group_name
          value: '{{{_ingest._value.name}}}'
          allow_duplicates: false
  - set:
      field: user.id
      tag: set_user_id
      copy_from: ocsf.actor.user.uid
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_actor_user_uid_into_related_user
      value: '{{{ocsf.actor.user.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.user?.uid != null
  - set:
      field: user.name
      tag: set_user_name
      copy_from: ocsf.actor.user.name
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_actor_user_name_into_related_user
      value: '{{{ocsf.actor.user.name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.user?.name != null
  - convert:
      field: ocsf.actor.process.container.hash.algorithm_id
      tag: convert_actor_process_container_hash_algorithm_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.auid
      tag: convert_actor_process_auid_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.container.size
      tag: convert_actor_process_container_size_to_long
      type: long
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.container.size
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.file.accessor.account.type_id
      tag: convert_actor_process_file_accessor_account_type_id_to_string
      type: string
      ignore_missing: true
  - append:
      field: related.user
      tag: append_actor_process_file_accessor_uid_alt_into_related_user
      value: '{{{ocsf.actor.process.file.accessor.uid_alt}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.accessor?.uid_alt != null
  - append:
      field: related.user
      tag: append_actor_process_file_accessor_email_addr_into_related_user
      value: '{{{ocsf.actor.process.file.accessor.email_addr}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.accessor?.email_addr != null
  - append:
      field: related.user
      tag: append_actor_process_file_accessor_full_name_into_related_user
      value: '{{{ocsf.actor.process.file.accessor.full_name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.accessor?.full_name != null
  - append:
      field: related.user
      tag: append_actor_process_file_accessor_name_into_related_user
      value: '{{{ocsf.actor.process.file.accessor.name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.accessor?.name != null
  - append:
      field: related.user
      tag: append_actor_process_file_accessor_uid_into_related_user
      value: '{{{ocsf.actor.process.file.accessor.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.accessor?.uid != null
  - convert:
      field: ocsf.actor.process.file.accessor.type_id
      tag: convert_actor_process_file_accessor_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.file.attributes
      tag: convert_actor_process_file_attributes_to_long
      type: long
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.file.attributes
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.file.confidentiality_id
      tag: convert_actor_process_file_confidentiality_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.file.creator.account.type_id
      tag: convert_actor_process_file_creator_account_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.file.creator.type_id
      tag: convert_actor_process_file_creator_type_id_to_string
      type: string
      ignore_missing: true
  - foreach:
      field: ocsf.actor.process.file.signature.certificate.fingerprints
      if: ctx.ocsf?.actor?.process?.file?.signature?.certificate?.fingerprints instanceof List
      ignore_failure: true
      processor:
        convert:
          field: _ingest._value.algorithm_id
          tag: convert_actor_process_file_signature_certificate_fingerprints_algorithm_id_to_string
          type: string
          ignore_missing: true
  - foreach:
      field: ocsf.actor.process.file.signature.certificate.fingerprints
      if: ctx.ocsf?.actor?.process?.file?.signature?.certificate?.fingerprints instanceof List
      ignore_failure: true
      processor:
        append:
          field: related.hash
          tag: append_actor_process_file_signature_certificate_fingerprints_value_into_related_hash
          value: '{{{_ingest._value.value}}}'
          allow_duplicates: false
  - convert:
      field: ocsf.actor.process.file.signature.algorithm_id
      tag: convert_actor_process_file_signature_algorithm_id_to_string
      type: string
      ignore_missing: true
  - append:
      field: related.hash
      tag: append_actor_process_file_signature_value_into_related_hash
      value: '{{{ocsf.actor.process.file.signature.value}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.signature?.value != null
  - date:
      field: ocsf.actor.process.file.signature.certificate.created_time_dt
      target_field: ocsf.actor.process.file.signature.certificate.created_time_dt
      tag: date_actor_process_file_signature_certificate_created_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.file?.signature?.certificate?.created_time_dt != null && ctx.ocsf.actor.process.file.signature.certificate.created_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.file.signature.certificate.created_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.file.signature.certificate.created_time
      target_field: ocsf.actor.process.file.signature.certificate.created_time
      tag: date_actor_process_file_signature_certificate_created_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.file?.signature?.certificate?.created_time != null && ctx.ocsf.actor.process.file.signature.certificate.created_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.file.signature.certificate.created_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.file.signature.created_time_dt
      target_field: ocsf.actor.process.file.signature.created_time_dt
      tag: date_actor_process_file_signature_created_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.file?.signature?.created_time_dt != null && ctx.ocsf.actor.process.file.signature.created_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.file.signature.created_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.file.signature.created_time
      target_field: ocsf.actor.process.file.signature.created_time
      tag: date_actor_process_file_signature_created_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.file?.signature?.created_time != null && ctx.ocsf.actor.process.file.signature.created_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.file.signature.created_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.file.signature.digest.algorithm_id
      tag: convert_actor_process_file_signature_digest_algorithm_id_to_string
      type: string
      ignore_missing: true
  - append:
      field: related.hash
      tag: append_actor_process_file_signature_digest_value_into_related_hash
      value: '{{{ocsf.actor.process.file.signature.digest.value}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.signature?.digest?.value != null
  - foreach:
      field: ocsf.actor.process.file.hashes
      if: ctx.ocsf?.actor?.process?.file?.hashes instanceof List
      ignore_failure: true
      processor:
        convert:
          field: _ingest._value.algorithm_id
          tag: convert_actor_process_file_hashes_algorithm_id_to_string
          type: string
          ignore_missing: true
  - convert:
      field: ocsf.actor.process.file.modifier.account.type_id
      tag: convert_actor_process_file_modifier_account_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.file.modifier.type_id
      tag: convert_actor_process_file_modifier_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.file.owner.account.type_id
      tag: convert_actor_process_file_owner_account_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.file.owner.type_id
      tag: convert_actor_process_file_owner_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.file.is_system
      tag: convert_actor_process_file_is_system_to_boolean
      type: boolean
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.file.is_system
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.file.type_id
      tag: convert_actor_process_file_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.integrity_id
      tag: convert_actor_process_integrity_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.namespace_pid
      tag: convert_actor_process_namespace_pid_to_long
      type: long
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.namespace_pid
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - script:
      description: Stringify the parent_process object if its depth_limit is greater than 20.
      if: ctx.ocsf?.actor?.process?.parent_process != null
      tag: script_actor_process_parent_process_stringify
      lang: painless
      source: |-
        def process = ctx.ocsf.actor.process.parent_process;
        def count = 0;
        while (true) {
          if (process != null && process.parent_process != null) {
            count += 1;
            process = process.parent_process;
          } else {
            break;
          }
        }
        if (count >= 15) {
          ctx.ocsf.actor.process.parent_process.put("parent_process_keyword", ctx.ocsf.actor.process.parent_process.parent_process.toString());
          ctx.ocsf.actor.process.parent_process.remove("parent_process");
        }
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - append:
      field: related.hash
      tag: append_actor_process_parent_process_container_hash_value_into_related_hash
      value: '{{{ocsf.actor.process.parent_process.container.hash.value}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.container?.hash?.value != null
  - date:
      field: ocsf.actor.process.parent_process.file.accessed_time_dt
      target_field: ocsf.actor.process.parent_process.file.accessed_time_dt
      tag: date_actor_process_parent_process_file_accessed_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.accessed_time_dt != null && ctx.ocsf.actor.process.parent_process.file.accessed_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.accessed_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.parent_process.file.accessed_time
      target_field: ocsf.actor.process.parent_process.file.accessed_time
      tag: date_actor_process_parent_process_file_accessed_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.accessed_time != null && ctx.ocsf.actor.process.parent_process.file.accessed_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.accessed_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.parent_process.file.created_time_dt
      target_field: ocsf.actor.process.parent_process.file.created_time_dt
      tag: date_actor_process_parent_process_file_created_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.created_time_dt != null && ctx.ocsf.actor.process.parent_process.file.created_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.created_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.parent_process.file.created_time
      target_field: ocsf.actor.process.parent_process.file.created_time
      tag: date_actor_process_parent_process_file_created_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.created_time != null && ctx.ocsf.actor.process.parent_process.file.created_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.created_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - foreach:
      field: ocsf.actor.process.parent_process.file.hashes
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.hashes instanceof List
      ignore_failure: true
      processor:
        append:
          field: related.hash
          tag: append_actor_process_parent_process_file_hashes_value_into_related_hash
          value: '{{{_ingest._value.value}}}'
          allow_duplicates: false
  - date:
      field: ocsf.actor.process.parent_process.file.modified_time_dt
      target_field: ocsf.actor.process.parent_process.file.modified_time_dt
      tag: date_actor_process_parent_process_file_modified_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.modified_time_dt != null && ctx.ocsf.actor.process.parent_process.file.modified_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.modified_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.parent_process.file.modified_time
      target_field: ocsf.actor.process.parent_process.file.modified_time
      tag: date_actor_process_parent_process_file_modified_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.modified_time != null && ctx.ocsf.actor.process.parent_process.file.modified_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.modified_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_owner_name_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.owner.name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.owner?.name != null
  - convert:
      field: ocsf.actor.process.parent_process.file.size
      tag: convert_actor_process_parent_process_file_size_to_long
      type: long
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.size
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_owner_uid_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.owner.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.owner?.uid != null
  - date:
      field: ocsf.actor.process.parent_process.file.signature.certificate.expiration_time_dt
      target_field: ocsf.actor.process.parent_process.file.signature.certificate.expiration_time_dt
      tag: date_actor_process_parent_process_file_signature_certificate_expiration_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.signature?.certificate?.expiration_time_dt != null && ctx.ocsf.actor.process.parent_process.file.signature.certificate.expiration_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.signature.certificate.expiration_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.parent_process.file.signature.certificate.expiration_time
      target_field: ocsf.actor.process.parent_process.file.signature.certificate.expiration_time
      tag: date_actor_process_parent_process_file_signature_certificate_expiration_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.signature?.certificate?.expiration_time != null && ctx.ocsf.actor.process.parent_process.file.signature.certificate.expiration_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.signature.certificate.expiration_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.parent.command_line
      tag: set_process_parent_command_line
      copy_from: ocsf.actor.process.parent_process.cmd_line
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.parent_process.terminated_time_dt
      target_field: ocsf.actor.process.parent_process.terminated_time_dt
      tag: date_actor_process_parent_process_terminated_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.parent_process?.terminated_time_dt != null && ctx.ocsf.actor.process.parent_process.terminated_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.terminated_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.parent.end
      tag: set_process_parent_end_from_actor_process_parent_process_terminated_time_dt
      copy_from: ocsf.actor.process.parent_process.terminated_time_dt
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.parent_process.terminated_time
      target_field: ocsf.actor.process.parent_process.terminated_time
      tag: date_actor_process_parent_process_terminated_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.parent_process?.terminated_time != null && ctx.ocsf.actor.process.parent_process.terminated_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.terminated_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.parent.end
      tag: set_process_parent_process_end_from_actor_process_terminated_time
      copy_from: ocsf.actor.process.parent_process.terminated_time
      ignore_empty_value: true
  - convert:
      field: ocsf.actor.process.parent_process.egid
      tag: convert_actor_process_parent_process_egid_to_string
      type: string
      ignore_missing: true
  - append:
      field: process.parent.group.id
      tag: append_process_parent_group_id_from_actor_process_parent_process_egid
      value: '{{{ocsf.actor.process.parent_process.egid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.egid != null
  - append:
      field: process.parent.group.id
      tag: append_process_parent_group_id_from_actor_process_parent_process_group_uid
      value: '{{{ocsf.actor.process.parent_process.group.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.group?.uid != null
  - set:
      field: process.parent.group.name
      tag: set_process_parent_group_name
      copy_from: ocsf.actor.process.parent_process.group.name
      ignore_empty_value: true
  - set:
      field: process.parent.name
      tag: set_process_parent_name
      copy_from: ocsf.actor.process.parent_process.name
      ignore_empty_value: true
  - convert:
      field: ocsf.actor.process.parent_process.pid
      tag: convert_actor_process_parent_process_pid_to_long
      type: long
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.pid
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.parent.pid
      tag: set_process_parent_pid
      copy_from: ocsf.actor.process.parent_process.pid
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.parent_process.created_time_dt
      target_field: ocsf.actor.process.parent_process.created_time_dt
      tag: date_actor_process_parent_process_created_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.parent_process?.created_time_dt != null && ctx.ocsf.actor.process.parent_process.created_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.created_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.parent.start
      tag: set_process_parent_start_from_actor_process_parent_process_created_time_dt
      copy_from: ocsf.actor.process.parent_process.created_time_dt
      ignore_empty_value: true
  - date:
      field: ocsf.actor.process.parent_process.created_time
      target_field: ocsf.actor.process.parent_process.created_time
      tag: date_actor_process_parent_process_created_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.parent_process?.created_time != null && ctx.ocsf.actor.process.parent_process.created_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.created_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.parent.start
      tag: set_process_parent_process_start_from_actor_process_created_time
      copy_from: ocsf.actor.process.parent_process.created_time
      ignore_empty_value: true
  - convert:
      field: ocsf.actor.process.parent_process.tid
      tag: convert_actor_process_parent_process_tid_to_long
      type: long
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.tid
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: process.parent.thread.id
      tag: set_process_parent_thread_id
      copy_from: ocsf.actor.process.parent_process.tid
      ignore_empty_value: true
  - set:
      field: process.parent.entity_id
      tag: set_process_parent_entity_id
      copy_from: ocsf.actor.process.parent_process.uid
      ignore_empty_value: true
  - set:
      field: process.parent.user.domain
      tag: set_process_parent_user_domain
      copy_from: ocsf.actor.process.parent_process.user.domain
      ignore_empty_value: true
  - set:
      field: process.parent.user.email
      tag: set_process_parent_user_email
      copy_from: ocsf.actor.process.parent_process.user.email_addr
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_actor_process_parent_process_user_email_addr_into_related_user
      value: '{{{ocsf.actor.process.parent_process.user.email_addr}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.user?.email_addr != null
  - set:
      field: process.parent.user.full_name
      tag: set_process_parent_user_full_name
      copy_from: ocsf.actor.process.parent_process.user.full_name
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_actor_process_parent_process_user_full_name_into_related_user
      value: '{{{ocsf.actor.process.parent_process.user.full_name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.user?.full_name != null
  - foreach:
      field: ocsf.actor.process.parent_process.user.groups
      if: ctx.ocsf?.actor?.process?.parent_process?.user?.groups instanceof List
      ignore_failure: true
      processor:
        append:
          field: process.parent.user.group.id
          tag: append_process_parent_user_group_id
          value: '{{{_ingest._value.uid}}}'
          allow_duplicates: false
  - foreach:
      field: ocsf.actor.process.parent_process.user.groups
      if: ctx.ocsf?.actor?.process?.parent_process?.user?.groups instanceof List
      ignore_failure: true
      processor:
        append:
          field: process.parent.user.group.name
          tag: append_process_parent_user_group_name
          value: '{{{_ingest._value.name}}}'
          allow_duplicates: false
  - convert:
      field: ocsf.actor.process.parent_process.euid
      tag: convert_actor_process_parent_process_euid_to_string
      type: string
      ignore_missing: true
  - append:
      field: process.parent.user.id
      tag: append_process_parent_user_id_from_actor_process_parent_process_euid
      value: '{{{ocsf.actor.process.parent_process.euid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.euid != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_euid_into_related_user
      value: '{{{ocsf.actor.process.parent_process.euid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.euid != null
  - append:
      field: process.parent.user.id
      tag: append_process_parent_user_id_from_actor_process_parent_process_uid
      value: '{{{ocsf.actor.process.parent_process.user.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.user?.uid != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_uid_into_related_user
      value: '{{{ocsf.actor.process.parent_process.user.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.user?.uid != null
  - set:
      field: process.parent.user.name
      tag: set_process_parnt_user_name
      copy_from: ocsf.actor.process.parent_process.user.name
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_actor_process_parent_process_user_name_into_related_user
      value: '{{{ocsf.actor.process.parent_process.user.name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.user?.name != null
  - convert:
      field: ocsf.actor.process.parent_process.container.hash.algorithm_id
      tag: convert_actor_process_parent_process_container_hash_algorithm_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.auid
      tag: convert_actor_process_parent_process_auid_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.container.size
      tag: convert_actor_process_parent_process_container_size_to_long
      type: long
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.container.size
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.parent_process.file.accessor.account.type_id
      tag: convert_actor_process_parent_process_file_accessor_account_type_id_to_string
      type: string
      ignore_missing: true
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_accessor_uid_alt_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.accessor.uid_alt}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.accessor?.uid_alt != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_accessor_email_addr_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.accessor.email_addr}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.accessor?.email_addr != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_accessor_full_name_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.accessor.full_name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.accessor?.full_name != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_accessor_name_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.accessor.name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.accessor?.name != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_accessor_uid_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.accessor.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.accessor?.uid != null
  - convert:
      field: ocsf.actor.process.parent_process.file.accessor.type_id
      tag: convert_actor_process_parent_process_file_accessor_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.file.attributes
      tag: convert_actor_process_parent_process_file_attributes_to_long
      type: long
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.attributes
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.parent_process.file.confidentiality_id
      tag: convert_actor_process_parent_process_file_confidentiality_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.file.creator.account.type_id
      tag: convert_actor_process_parent_process_file_creator_account_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.file.creator.type_id
      tag: convert_actor_process_parent_process_file_creator_type_id_to_string
      type: string
      ignore_missing: true
  - foreach:
      field: ocsf.actor.process.parent_process.file.signature.certificate.fingerprints
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.signature?.certificate?.fingerprints instanceof List
      ignore_failure: true
      processor:
        convert:
          field: _ingest._value.algorithm_id
          tag: convert_actor_process_parent_process_file_signature_certificate_fingerprints_algorithm_id_to_string
          type: string
          ignore_missing: true
  - foreach:
      field: ocsf.actor.process.parent_process.file.signature.certificate.fingerprints
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.signature?.certificate?.fingerprints instanceof List
      ignore_failure: true
      processor:
        append:
          field: related.hash
          tag: append_actor_process_parent_process_file_signature_certificate_fingerprints_value_into_related_hash
          value: '{{{_ingest._value.value}}}'
          allow_duplicates: false
  - convert:
      field: ocsf.actor.process.parent_process.file.signature.algorithm_id
      tag: convert_actor_process_parent_process_file_signature_algorithm_id_to_string
      type: string
      ignore_missing: true
  - append:
      field: related.hash
      tag: append_actor_process_parent_process_file_signature_value_into_related_hash
      value: '{{{ocsf.actor.process.parent_process.file.signature.value}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.signature?.value != null
  - date:
      field: ocsf.actor.process.parent_process.file.signature.certificate.created_time_dt
      target_field: ocsf.actor.process.parent_process.file.signature.certificate.created_time_dt
      tag: date_actor_process_parent_process_file_signature_certificate_created_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.signature?.certificate?.created_time_dt != null && ctx.ocsf.actor.process.parent_process.file.signature.certificate.created_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.signature.certificate.created_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.parent_process.file.signature.certificate.created_time
      target_field: ocsf.actor.process.parent_process.file.signature.certificate.created_time
      tag: date_actor_process_parent_process_file_signature_certificate_created_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.signature?.certificate?.created_time != null && ctx.ocsf.actor.process.parent_process.file.signature.certificate.created_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.signature.certificate.created_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.parent_process.file.signature.created_time_dt
      target_field: ocsf.actor.process.parent_process.file.signature.created_time_dt
      tag: date_actor_process_parent_process_file_signature_created_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.signature?.created_time_dt != null && ctx.ocsf.actor.process.parent_process.file.signature.created_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.signature.created_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.parent_process.file.signature.created_time
      target_field: ocsf.actor.process.parent_process.file.signature.created_time
      tag: date_actor_process_parent_process_file_signature_created_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.signature?.created_time != null && ctx.ocsf.actor.process.parent_process.file.signature.created_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.signature.created_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.parent_process.file.signature.digest.algorithm_id
      tag: convert_actor_process_parent_process_file_signature_digest_algorithm_id_to_string
      type: string
      ignore_missing: true
  - append:
      field: related.hash
      tag: append_actor_process_parent_process_file_signature_digest_value_into_related_hash
      value: '{{{ocsf.actor.process.parent_process.file.signature.digest.value}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.signature?.digest?.value != null
  - foreach:
      field: ocsf.actor.process.parent_process.file.hashes
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.hashes instanceof List
      ignore_failure: true
      processor:
        convert:
          field: _ingest._value.algorithm_id
          tag: convert_actor_process_parent_process_file_hashes_algorithm_id_to_string
          type: string
          ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.file.modifier.account.type_id
      tag: convert_actor_process_parent_process_file_modifier_account_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.file.modifier.type_id
      tag: convert_actor_process_parent_process_file_modifier_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.file.owner.account.type_id
      tag: convert_actor_process_parent_process_file_owner_account_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.file.owner.type_id
      tag: convert_actor_process_parent_process_file_owner_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.file.is_system
      tag: convert_actor_process_parent_process_file_is_system_to_boolean
      type: boolean
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.file.is_system
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.parent_process.file.type_id
      tag: convert_actor_process_parent_process_file_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.integrity_id
      tag: convert_actor_process_parent_process_integrity_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.namespace_pid
      tag: convert_actor_process_parent_process_namespace_pid_to_long
      type: long
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.namespace_pid
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.parent_process.session.created_time_dt
      target_field: ocsf.actor.process.parent_process.session.created_time_dt
      tag: date_actor_process_parent_process_session_created_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.parent_process?.session?.created_time_dt != null && ctx.ocsf.actor.process.parent_process.session.created_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.session.created_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.parent_process.session.created_time
      target_field: ocsf.actor.process.parent_process.session.created_time
      tag: date_actor_process_parent_process_session_created_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.parent_process?.session?.created_time != null && ctx.ocsf.actor.process.parent_process.session.created_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.session.created_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.parent_process.session.expiration_time_dt
      target_field: ocsf.actor.process.parent_process.session.expiration_time_dt
      tag: date_actor_process_parent_process_session_expiration_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.parent_process?.session?.expiration_time_dt != null && ctx.ocsf.actor.process.parent_process.session.expiration_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.session.expiration_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.parent_process.session.expiration_time
      target_field: ocsf.actor.process.parent_process.session.expiration_time
      tag: date_actor_process_parent_process_session_expiration_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.parent_process?.session?.expiration_time != null && ctx.ocsf.actor.process.parent_process.session.expiration_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.session.expiration_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.parent_process.session.mfa
      tag: convert_actor_process_parent_process_session_mfa_to_boolean
      type: boolean
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.session.mfa
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.parent_process.session.is_remote
      tag: convert_actor_process_parent_process_session_is_remote_to_boolean
      type: boolean
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.parent_process.session.is_remote
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.parent_process.user.account.type_id
      tag: convert_actor_process_parent_process_user_account_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.parent_process.user.type_id
      tag: convert_actor_process_parent_process_user_type_id_to_string
      type: string
      ignore_missing: true
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_creator_uid_alt_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.creator.uid_alt}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.creator?.uid_alt != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_creator_email_addr_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.creator.email_addr}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.creator?.email_addr != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_creator_full_name_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.creator.full_name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.creator?.full_name != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_creator_name_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.creator.name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.creator?.name != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_creator_uid_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.creator.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.creator?.uid != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_modifier_uid_alt_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.modifier.uid_alt}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.modifier?.uid_alt != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_modifier_email_addr_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.modifier.email_addr}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.modifier?.email_addr != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_modifier_full_name_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.modifier.full_name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.modifier?.full_name != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_modifier_name_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.modifier.name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.modifier?.name != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_modifier_uid_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.modifier.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.modifier?.uid != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_owner_uid_alt_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.owner.uid_alt}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.owner?.uid_alt != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_owner_email_addr_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.owner.email_addr}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.owner?.email_addr != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_file_owner_full_name_into_related_user
      value: '{{{ocsf.actor.process.parent_process.file.owner.full_name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.file?.owner?.full_name != null
  - append:
      field: related.user
      tag: append_actor_process_parent_process_user_uid_alt_into_related_user
      value: '{{{ocsf.actor.process.parent_process.user.uid_alt}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.parent_process?.user?.uid_alt != null
  - date:
      field: ocsf.actor.process.session.created_time_dt
      target_field: ocsf.actor.process.session.created_time_dt
      tag: date_actor_process_session_created_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.session?.created_time_dt != null && ctx.ocsf.actor.process.session.created_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.session.created_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.session.created_time
      target_field: ocsf.actor.process.session.created_time
      tag: date_actor_process_session_created_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.session?.created_time != null && ctx.ocsf.actor.process.session.created_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.session.created_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.session.expiration_time_dt
      target_field: ocsf.actor.process.session.expiration_time_dt
      tag: date_actor_process_session_expiration_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.process?.session?.expiration_time_dt != null && ctx.ocsf.actor.process.session.expiration_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.session.expiration_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.process.session.expiration_time
      target_field: ocsf.actor.process.session.expiration_time
      tag: date_actor_process_session_expiration_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.process?.session?.expiration_time != null && ctx.ocsf.actor.process.session.expiration_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.process.session.expiration_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.session.mfa
      tag: convert_actor_process_session_mfa_to_boolean
      type: boolean
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.session.mfa
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.session.is_remote
      tag: convert_actor_process_session_is_remote_to_boolean
      type: boolean
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.process.session.is_remote
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.process.user.account.type_id
      tag: convert_actor_process_user_account_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.process.user.type_id
      tag: convert_actor_process_user_type_id_to_string
      type: string
      ignore_missing: true
  - date:
      field: ocsf.actor.session.created_time_dt
      target_field: ocsf.actor.session.created_time_dt
      tag: date_actor_session_created_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.session?.created_time_dt != null && ctx.ocsf.actor.session.created_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.session.created_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.session.created_time
      target_field: ocsf.actor.session.created_time
      tag: date_actor_session_created_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.session?.created_time != null && ctx.ocsf.actor.session.created_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.session.created_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.session.expiration_time_dt
      target_field: ocsf.actor.session.expiration_time_dt
      tag: date_actor_session_expiration_time_dt
      formats:
        - ISO8601
      if: ctx.ocsf?.actor?.session?.expiration_time_dt != null && ctx.ocsf.actor.session.expiration_time_dt != ''
      on_failure:
        - remove:
            field: ocsf.actor.session.expiration_time_dt
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - date:
      field: ocsf.actor.session.expiration_time
      target_field: ocsf.actor.session.expiration_time
      tag: date_actor_session_expiration_time
      formats:
        - UNIX_MS
      if: ctx.ocsf?.actor?.session?.expiration_time != null && ctx.ocsf.actor.session.expiration_time != ''
      on_failure:
        - remove:
            field: ocsf.actor.session.expiration_time
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.session.mfa
      tag: convert_actor_session_mfa_to_boolean
      type: boolean
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.session.mfa
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.session.is_remote
      tag: convert_actor_session_is_remote_to_boolean
      type: boolean
      ignore_missing: true
      on_failure:
        - remove:
            field: ocsf.actor.session.is_remote
            ignore_missing: true
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - convert:
      field: ocsf.actor.user.account.type_id
      tag: convert_actor_user_account_type_id_to_string
      type: string
      ignore_missing: true
  - convert:
      field: ocsf.actor.user.type_id
      tag: convert_actor_user_type_id_to_string
      type: string
      ignore_missing: true
  - append:
      field: related.user
      tag: append_actor_process_file_creator_uid_alt_into_related_user
      value: '{{{ocsf.actor.process.file.creator.uid_alt}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.creator?.uid_alt != null
  - append:
      field: related.user
      tag: append_actor_process_file_creator_email_addr_into_related_user
      value: '{{{ocsf.actor.process.file.creator.email_addr}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.creator?.email_addr != null
  - append:
      field: related.user
      tag: append_actor_process_file_creator_full_name_into_related_user
      value: '{{{ocsf.actor.process.file.creator.full_name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.creator?.full_name != null
  - append:
      field: related.user
      tag: append_actor_process_file_creator_name_into_related_user
      value: '{{{ocsf.actor.process.file.creator.name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.creator?.name != null
  - append:
      field: related.user
      tag: append_actor_process_file_creator_uid_into_related_user
      value: '{{{ocsf.actor.process.file.creator.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.creator?.uid != null
  - append:
      field: related.user
      tag: append_actor_process_file_modifier_uid_alt_into_related_user
      value: '{{{ocsf.actor.process.file.modifier.uid_alt}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.modifier?.uid_alt != null
  - append:
      field: related.user
      tag: append_actor_process_file_modifier_email_addr_into_related_user
      value: '{{{ocsf.actor.process.file.modifier.email_addr}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.modifier?.email_addr != null
  - append:
      field: related.user
      tag: append_actor_process_file_modifier_full_name_into_related_user
      value: '{{{ocsf.actor.process.file.modifier.full_name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.modifier?.full_name != null
  - append:
      field: related.user
      tag: append_actor_process_file_modifier_name_into_related_user
      value: '{{{ocsf.actor.process.file.modifier.name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.modifier?.name != null
  - append:
      field: related.user
      tag: append_actor_process_file_modifier_uid_into_related_user
      value: '{{{ocsf.actor.process.file.modifier.uid}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.modifier?.uid != null
  - append:
      field: related.user
      tag: append_actor_process_file_owner_uid_alt_into_related_user
      value: '{{{ocsf.actor.process.file.owner.uid_alt}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.owner?.uid_alt != null
  - append:
      field: related.user
      tag: append_actor_process_file_owner_email_addr_into_related_user
      value: '{{{ocsf.actor.process.file.owner.email_addr}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.owner?.email_addr != null
  - append:
      field: related.user
      tag: append_actor_process_file_owner_full_name_into_related_user
      value: '{{{ocsf.actor.process.file.owner.full_name}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.file?.owner?.full_name != null
  - append:
      field: related.user
      tag: append_actor_process_user_uid_alt_into_related_user
      value: '{{{ocsf.actor.process.user.uid_alt}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.process?.user?.uid_alt != null
  - append:
      field: related.user
      tag: append_actor_user_uid_alt_into_related_user
      value: '{{{ocsf.actor.user.uid_alt}}}'
      allow_duplicates: false
      if: ctx.ocsf?.actor?.user?.uid_alt != null
on_failure:
  - append:
      field: error.message
      value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: event.kind
      value: pipeline_error
