- name: linux.ksm
  type: group
  fields:
    - name: stats
      type: group
      description: >
        KSM statistics

      fields:
        - name: pages_shared
          type: long
          metric_type: gauge
          description: >
            Shared pages in use.

        - name: pages_sharing
          type: long
          metric_type: gauge
          description: >
            Sites sharing pages.

        - name: pages_unshared
          type: long
          metric_type: gauge
          description: >
            Unique pages.

        - name: pages_volatile
          type: long
          metric_type: gauge
          description: >
            Pages changing too fast to be shared.

        - name: full_scans
          type: long
          metric_type: counter
          description: >
            Number of times mergable pages have been scanned.

        - name: stable_node_chains
          type: long
          metric_type: gauge
          description: >
            Pages that have reached max_page_sharing.

        - name: stable_node_dups
          type: long
          metric_type: gauge
          description: >
            Number of duplicated KSM pages.
