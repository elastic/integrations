- name: linux.conntrack
  type: group
  fields:
    - name: summary
      type: group
      description: >
        summary of nf_conntrack statistics, summed across CPU cores

      fields:
        - name: drop
          type: long
          metric_type: counter
          description: >
            packets dropped due to conntrack failure

        - name: early_drop
          type: long
          metric_type: counter
          description: >
            conntrack entries dropped to make room for new ones

        - name: entries
          type: long
          metric_type: gauge
          description: >
            entries in the conntrack table

        - name: found
          type: long
          metric_type: counter
          description: >
            successfully searched entries

        - name: ignore
          type: long
          metric_type: counter
          description: >
            packets seen already connected to a conntrack entry

        - name: insert_failed
          type: long
          metric_type: counter
          description: "Number of entries where list insert failed \n"
        - name: invalid
          type: long
          metric_type: counter
          description: >
            packets seen that cannot be tracked

        - name: search_restart
          type: long
          metric_type: counter
          description: >
            table lookups which had to be restarted due to table resizes

