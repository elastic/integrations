config_version: "2"
interval: 30s

{{#if username}}
auth.basic:
  user: {{username}}
  password: {{password}}
{{/if}}

request:
  method: "GET"
  url: {{hosts.[0]}}/_nodes/stats/ingest?filter_path=nodes.*.ingest
  # timeout:

response:
  split:
    type: map
    target: body.nodes
    key_field: node_id
    split:
      type: map
      target: body.ingest.pipelines
      keep_parent: true
      key_field: pipeline_id
