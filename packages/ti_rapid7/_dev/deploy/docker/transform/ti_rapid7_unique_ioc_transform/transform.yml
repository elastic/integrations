source:
  index:
    - logs-*
  query:
    bool:
      should:
        - match_phrase:
            data_stream.dataset: ti_rapid7.ioc
      minimum_should_match: 1
dest:
  index: rapid7-unique-iocs
  pipeline: 0.1.0-ti_rapid7-unique-ioc-transform-pipeline
frequency: 30m
sync:
  time:
    field: 'event.ingested'
    delay: 60s
latest:
  unique_key:
    - rapid7.ioc.value
  sort: '@timestamp'
description: This transform creates index to maintain unique values of IOCs.
