{
    "expected": [
        {
            "@timestamp": "2024-04-18T22:54:57.000Z",
            "aws_bedrock": {
                "invocation": {
                    "input": {
                        "input_body_json": {
                            "anthropic_version": "bedrock-2023-05-31",
                            "max_tokens": 2000,
                            "messages": [
                                {
                                    "content": [
                                        {
                                            "text": "The following text is from a github issue in the elastic/integrations repository. Please classify what Elastic Fleet integration it is about. This list of can be found at https://docs.elastic.co/integrations/all_integrations. Please indicate it is a bug or enhancement request.\n\n<text>\nThe following processor can turn valid IPv6 address into invalid ones.\n\nhttps://github.com/elastic/integrations/blob/4558683307e3a1a10bd0ff946faf045ed014d135/packages/windows/data_stream/forwarded/elasticsearch/ingest_pipeline/security.yml#L2906-L2910\n\nExamples:\n- `fe80::ffff:ffff:fffe` -> `fe80ffff:fffe`\n- `fe80::ffff:ffff:ffff:ffff` -> `fe80ffff:ffff:ffff`\n\nWhich then later causes errors such as `'fe80ffff:ffff:ffff' is not an IP string literal.` in other processors. It also causes other issues.\n![image](https://github.com/elastic/integrations/assets/1696711/6f189e04-108c-49ec-9c66-ba004c694d57)\n\nI believe this processor's intent is to transform IPs such as `::ffff:192.168.1.1` into `192.168.1.1`. In which case, the pattern should be `^::ffff:` to anchor the pattern at the beginning of the string.\n\n```\n  - gsub:\n      field: source.ip\n      pattern: \"^::ffff:\"\n      replacement: \"\"\n      ignore_missing: true\n```\n\nI tested this in a simulated pipeline using both `fe80::ffff:ffff:fffe` and `::ffff:192.168.1.1` values. It correctly left the former untouched and correctly stripped the prefix from the latter.\n\nReferences:\n- [RFC 5156 Section 2.2](https://www.rfc-editor.org/rfc/rfc5156.html#section-2.2)\n- [RFC 4291 Section 2.2](https://www.rfc-editor.org/rfc/rfc4291#section-2.2)\n- https://www.ibm.com/docs/en/i/7.5?topic=concepts-ipv6-address-formats\n</text>",
                                            "type": "text"
                                        }
                                    ],
                                    "role": "user"
                                }
                            ],
                            "stop_sequences": [
                                "\n\nHuman:"
                            ],
                            "temperature": 1,
                            "top_k": 250,
                            "top_p": 0.999
                        },
                        "input_content_type": "application/json",
                        "input_token_count": 571
                    },
                    "model_id": "anthropic.claude-3-haiku-20240307-v1:0",
                    "output": {
                        "completion_text": "The text provided is about a bug in the Elastic Fleet's Windows data stream forwarded integration. Specifically, the text discusses an issue with the `security.yml` ingest pipeline that can turn valid IPv6 addresses into invalid ones.\n\nThe bug occurs in the following code:\n\n```yaml\n- gsub:\n    field: source.ip\n    pattern: \"::ffff:(\\d+\\.\\d+\\.\\d+\\.\\d+)\"\n    replacement: \"\\1\"\n    ignore_missing: true\n```\n\nThe issue is that the pattern `::ffff:(\\d+\\.\\d+\\.\\d+\\.\\d+)` is not anchored at the beginning of the string, which can lead to unintended transformations of valid IPv6 addresses.\n\nThe text suggests a fix by using the pattern `^::ffff:` to anchor the pattern at the beginning of the string, which would correctly transform `::ffff:192.168.1.1` into `192.168.1.1` while leaving `fe80::ffff:ffff:fffe` untouched.\n\nIn summary, this is a bug report for the Elastic Fleet's Windows data stream forwarded integration, and the text provides a suggested fix for the issue.",
                        "output_body_json": [
                            {
                                "message": {
                                    "id": "msg_01L3WcyJkxCgmHpMiLRhSYvf",
                                    "model": "claude-3-haiku-48k-20240307",
                                    "role": "assistant",
                                    "type": "message",
                                    "usage": {
                                        "input_tokens": 571,
                                        "output_tokens": 1
                                    }
                                },
                                "type": "message_start"
                            },
                            {
                                "content_block": {
                                    "type": "text"
                                },
                                "index": 0,
                                "type": "content_block_start"
                            },
                            {
                                "delta": {
                                    "text": "The",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " text",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " provided",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " is",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " about",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " a",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " bug",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " in",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " Elastic",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " Fleet",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "'s",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " Windows",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " data",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " stream",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " forw",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "arded",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " integration",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " Specifically",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ",",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " text",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " discusses",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " an",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " issue",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " with",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " `",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "security",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "yml",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "`",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " in",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "gest",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " pipeline",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " that",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " can",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " turn",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " valid",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " IPv",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "6",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " ",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "addresses",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " into",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " invalid",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " ones",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\n\nThe",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " bug",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " occurs",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " in",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " following",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " code",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ":",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\n\n```",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "yaml",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\n-",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " gs",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ub",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ":",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\n    ",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "field",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ":",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " source",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ip",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\n    ",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "pattern",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ":",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " \"",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "::",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ff",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ff",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ":",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "(\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "d",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "+",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "d",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "+",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "d",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "+",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "d",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "+",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ")\"",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\n    ",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "replacement",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ":",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " \"\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "1",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\"",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\n    ",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ignore",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "_",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "missing",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ":",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " true",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\n```",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\n\nThe",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " issue",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " is",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " that",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " pattern",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " `",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "::",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ff",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ff",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ":",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "(\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "d",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "+",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "d",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "+",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "d",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "+",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".\\",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "d",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "+",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ")",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "`",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " is",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " not",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " anch",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ored",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " at",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " beginning",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " of",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " string",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ",",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " which",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " can",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " lead",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " to",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " un",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "int",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ended",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " transform",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ations",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " of",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " valid",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " IPv",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "6",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " ",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "addresses",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\n\nThe",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " text",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " suggests",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " a",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " fix",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " by",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " using",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " pattern",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " `",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "^",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "::",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ff",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ff",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ":",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "`",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " to",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " anchor",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " pattern",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " at",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " beginning",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " of",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " string",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ",",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " which",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " would",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " correctly",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " transform",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " `",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "::",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ff",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ff",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ":",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "192",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "168",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "1",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "1",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "`",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " into",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " `",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "192",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "168",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "1",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "1",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "`",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " while",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " leaving",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " `",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "fe",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "80",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "::",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ff",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ff",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ":",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ff",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ff",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ":",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "f",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ffe",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "`",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " unt",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ou",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "ched",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "\n\nIn",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " summary",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ",",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " this",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " is",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " a",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " bug",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " report",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " for",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " Elastic",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " Fleet",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "'s",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " Windows",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " data",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " stream",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " forw",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": "arded",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " integration",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ",",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " and",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " text",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " provides",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " a",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " suggested",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " fix",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " for",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " the",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": " issue",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "delta": {
                                    "text": ".",
                                    "type": "text_delta"
                                },
                                "index": 0,
                                "type": "content_block_delta"
                            },
                            {
                                "index": 0,
                                "type": "content_block_stop"
                            },
                            {
                                "delta": {
                                    "stop_reason": "end_turn"
                                },
                                "type": "message_delta",
                                "usage": {
                                    "output_tokens": 281
                                }
                            },
                            {
                                "amazon_bedrock_invocation_metrics": {
                                    "first_byte_latency": 509,
                                    "input_token_count": 571,
                                    "invocation_latency": 3848,
                                    "output_token_count": 281
                                },
                                "type": "message_stop"
                            }
                        ],
                        "output_content_type": "application/json",
                        "output_token_count": 281
                    },
                    "request_id": "6f9e9644-95a1-4c3c-892f-b51372320d5e",
                    "schema_type": "ModelInvocationLog",
                    "schema_version": "1.0"
                }
            },
            "cloud": {
                "account": {
                    "id": "111111111111"
                },
                "region": "us-east-1",
                "service": {
                    "name": "bedrock"
                }
            },
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "InvokeModelWithResponseStream",
                "original": "{\"schemaType\":\"ModelInvocationLog\",\"schemaVersion\":\"1.0\",\"timestamp\":\"2024-04-18T22:54:57Z\",\"accountId\":\"111111111111\",\"identity\":{\"arn\":\"arn:aws:iam::111111111111:user/john.doe@example.com\"},\"region\":\"us-east-1\",\"requestId\":\"6f9e9644-95a1-4c3c-892f-b51372320d5e\",\"operation\":\"InvokeModelWithResponseStream\",\"modelId\":\"anthropic.claude-3-haiku-20240307-v1:0\",\"input\":{\"inputContentType\":\"application/json\",\"inputBodyJson\":{\"messages\":[{\"role\":\"user\",\"content\":[{\"type\":\"text\",\"text\":\"The following text is from a github issue in the elastic/integrations repository. Please classify what Elastic Fleet integration it is about. This list of can be found at https://docs.elastic.co/integrations/all_integrations. Please indicate it is a bug or enhancement request.\\n\\n<text>\\nThe following processor can turn valid IPv6 address into invalid ones.\\n\\nhttps://github.com/elastic/integrations/blob/4558683307e3a1a10bd0ff946faf045ed014d135/packages/windows/data_stream/forwarded/elasticsearch/ingest_pipeline/security.yml#L2906-L2910\\n\\nExamples:\\n- `fe80::ffff:ffff:fffe` -> `fe80ffff:fffe`\\n- `fe80::ffff:ffff:ffff:ffff` -> `fe80ffff:ffff:ffff`\\n\\nWhich then later causes errors such as `'fe80ffff:ffff:ffff' is not an IP string literal.` in other processors. It also causes other issues.\\n![image](https://github.com/elastic/integrations/assets/1696711/6f189e04-108c-49ec-9c66-ba004c694d57)\\n\\nI believe this processor's intent is to transform IPs such as `::ffff:192.168.1.1` into `192.168.1.1`. In which case, the pattern should be `^::ffff:` to anchor the pattern at the beginning of the string.\\n\\n```\\n  - gsub:\\n      field: source.ip\\n      pattern: \\\"^::ffff:\\\"\\n      replacement: \\\"\\\"\\n      ignore_missing: true\\n```\\n\\nI tested this in a simulated pipeline using both `fe80::ffff:ffff:fffe` and `::ffff:192.168.1.1` values. It correctly left the former untouched and correctly stripped the prefix from the latter.\\n\\nReferences:\\n- [RFC 5156 Section 2.2](https://www.rfc-editor.org/rfc/rfc5156.html#section-2.2)\\n- [RFC 4291 Section 2.2](https://www.rfc-editor.org/rfc/rfc4291#section-2.2)\\n- https://www.ibm.com/docs/en/i/7.5?topic=concepts-ipv6-address-formats\\n</text>\"}]}],\"anthropic_version\":\"bedrock-2023-05-31\",\"max_tokens\":2000,\"temperature\":1,\"top_k\":250,\"top_p\":0.999,\"stop_sequences\":[\"\\n\\nHuman:\"]},\"inputTokenCount\":571},\"output\":{\"outputContentType\":\"application/json\",\"outputBodyJson\":[{\"type\":\"message_start\",\"message\":{\"id\":\"msg_01L3WcyJkxCgmHpMiLRhSYvf\",\"type\":\"message\",\"role\":\"assistant\",\"content\":[],\"model\":\"claude-3-haiku-48k-20240307\",\"stop_reason\":null,\"stop_sequence\":null,\"usage\":{\"input_tokens\":571,\"output_tokens\":1}}},{\"type\":\"content_block_start\",\"index\":0,\"content_block\":{\"type\":\"text\",\"text\":\"\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"The\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" text\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" provided\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" is\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" about\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" a\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" bug\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" in\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" Elastic\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" Fleet\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"'s\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" Windows\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" data\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" stream\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" forw\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"arded\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" integration\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" Specifically\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\",\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" text\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" discusses\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" an\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" issue\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" with\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" `\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"security\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"yml\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"`\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" in\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"gest\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" pipeline\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" that\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" can\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" turn\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" valid\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" IPv\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"6\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" \"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"addresses\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" into\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" invalid\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" ones\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\n\\nThe\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" bug\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" occurs\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" in\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" following\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" code\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\":\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\n\\n```\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"yaml\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\n-\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" gs\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ub\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\":\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\n    \"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"field\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\":\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" source\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ip\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\n    \"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"pattern\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\":\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" \\\"\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"::\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ff\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ff\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\":\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"(\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"d\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"+\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"d\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"+\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"d\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"+\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"d\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"+\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\")\\\"\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\n    \"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"replacement\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\":\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" \\\"\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"1\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\\"\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\n    \"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ignore\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"_\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"missing\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\":\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" true\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\n```\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\n\\nThe\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" issue\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" is\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" that\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" pattern\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" `\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"::\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ff\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ff\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\":\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"(\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"d\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"+\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"d\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"+\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"d\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"+\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\\\\\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"d\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"+\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\")\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"`\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" is\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" not\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" anch\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ored\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" at\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" beginning\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" of\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" string\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\",\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" which\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" can\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" lead\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" to\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" un\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"int\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ended\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" transform\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ations\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" of\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" valid\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" IPv\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"6\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" \"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"addresses\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\n\\nThe\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" text\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" suggests\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" a\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" fix\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" by\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" using\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" pattern\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" `\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"^\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"::\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ff\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ff\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\":\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"`\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" to\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" anchor\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" pattern\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" at\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" beginning\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" of\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" string\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\",\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" which\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" would\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" correctly\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" transform\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" `\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"::\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ff\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ff\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\":\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"192\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"168\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"1\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"1\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"`\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" into\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" `\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"192\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"168\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"1\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"1\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"`\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" while\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" leaving\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" `\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"fe\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"80\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"::\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ff\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ff\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\":\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ff\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ff\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\":\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"f\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ffe\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"`\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" unt\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ou\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"ched\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"\\n\\nIn\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" summary\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\",\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" this\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" is\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" a\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" bug\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" report\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" for\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" Elastic\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" Fleet\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"'s\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" Windows\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" data\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" stream\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" forw\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"arded\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" integration\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\",\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" and\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" text\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" provides\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" a\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" suggested\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" fix\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" for\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" the\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\" issue\"}},{\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\".\"}},{\"type\":\"content_block_stop\",\"index\":0},{\"type\":\"message_delta\",\"delta\":{\"stop_reason\":\"end_turn\",\"stop_sequence\":null},\"usage\":{\"output_tokens\":281}},{\"type\":\"message_stop\",\"amazon-bedrock-invocationMetrics\":{\"inputTokenCount\":571,\"outputTokenCount\":281,\"invocationLatency\":3848,\"firstByteLatency\":509}}],\"outputTokenCount\":281}}",
                "outcome": "success"
            },
            "gen_ai": {
                "completion": "[{\"message\":{\"content\":[],\"id\":\"msg_01L3WcyJkxCgmHpMiLRhSYvf\",\"model\":\"claude-3-haiku-48k-20240307\",\"role\":\"assistant\",\"stop_reason\":null,\"stop_sequence\":null,\"type\":\"message\",\"usage\":{\"input_tokens\":571,\"output_tokens\":1}},\"type\":\"message_start\"},{\"content_block\":{\"text\":\"\",\"type\":\"text\"},\"index\":0,\"type\":\"content_block_start\"},{\"delta\":{\"text\":\"The\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" text\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" provided\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" is\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" about\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" a\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" bug\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" in\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" Elastic\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" Fleet\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"'s\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" Windows\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" data\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" stream\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" forw\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"arded\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" integration\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" Specifically\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\",\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" text\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" discusses\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" an\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" issue\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" with\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" `\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"security\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"yml\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"`\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" in\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"gest\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" pipeline\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" that\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" can\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" turn\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" valid\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" IPv\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"6\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" \",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"addresses\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" into\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" invalid\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" ones\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\n\nThe\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" bug\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" occurs\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" in\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" following\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" code\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\":\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\n\n```\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"yaml\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\n-\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" gs\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ub\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\":\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\n    \",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"field\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\":\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" source\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ip\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\n    \",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"pattern\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\":\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" \"\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"::\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ff\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ff\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\":\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"(\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"d\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"+\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"d\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"+\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"d\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"+\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"d\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"+\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\")\"\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\n    \",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"replacement\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\":\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" \"\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"1\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\"\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\n    \",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ignore\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"_\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"missing\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\":\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" true\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\n```\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\n\nThe\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" issue\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" is\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" that\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" pattern\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" `\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"::\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ff\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ff\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\":\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"(\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"d\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"+\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"d\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"+\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"d\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"+\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\\\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"d\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"+\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\")\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"`\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" is\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" not\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" anch\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ored\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" at\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" beginning\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" of\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" string\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\",\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" which\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" can\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" lead\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" to\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" un\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"int\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ended\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" transform\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ations\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" of\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" valid\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" IPv\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"6\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" \",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"addresses\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\n\nThe\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" text\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" suggests\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" a\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" fix\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" by\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" using\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" pattern\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" `\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"^\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"::\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ff\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ff\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\":\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"`\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" to\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" anchor\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" pattern\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" at\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" beginning\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" of\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" string\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\",\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" which\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" would\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" correctly\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" transform\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" `\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"::\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ff\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ff\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\":\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"192\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"168\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"1\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"1\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"`\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" into\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" `\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"192\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"168\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"1\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"1\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"`\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" while\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" leaving\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" `\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"fe\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"80\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"::\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ff\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ff\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\":\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ff\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ff\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\":\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"f\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ffe\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"`\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" unt\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ou\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"ched\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"\n\nIn\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" summary\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\",\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" this\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" is\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" a\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" bug\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" report\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" for\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" Elastic\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" Fleet\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"'s\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" Windows\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" data\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" stream\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" forw\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\"arded\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" integration\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\",\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" and\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" text\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" provides\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" a\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" suggested\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" fix\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" for\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" the\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\" issue\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"delta\":{\"text\":\".\",\"type\":\"text_delta\"},\"index\":0,\"type\":\"content_block_delta\"},{\"index\":0,\"type\":\"content_block_stop\"},{\"delta\":{\"stop_reason\":\"end_turn\",\"stop_sequence\":null},\"type\":\"message_delta\",\"usage\":{\"output_tokens\":281}},{\"amazon-bedrock-invocationMetrics\":{\"firstByteLatency\":509,\"inputTokenCount\":571,\"invocationLatency\":3848,\"outputTokenCount\":281},\"type\":\"message_stop\"}]",
                "performance": {
                    "request_size": 1860,
                    "response_size": 22989,
                    "response_time": 3848,
                    "start_response_time": 509
                },
                "prompt": "{\"anthropic_version\":\"bedrock-2023-05-31\",\"max_tokens\":2000,\"messages\":[{\"content\":[{\"text\":\"The following text is from a github issue in the elastic/integrations repository. Please classify what Elastic Fleet integration it is about. This list of can be found at https://docs.elastic.co/integrations/all_integrations. Please indicate it is a bug or enhancement request.\n\n<text>\nThe following processor can turn valid IPv6 address into invalid ones.\n\nhttps://github.com/elastic/integrations/blob/4558683307e3a1a10bd0ff946faf045ed014d135/packages/windows/data_stream/forwarded/elasticsearch/ingest_pipeline/security.yml#L2906-L2910\n\nExamples:\n- `fe80::ffff:ffff:fffe` -> `fe80ffff:fffe`\n- `fe80::ffff:ffff:ffff:ffff` -> `fe80ffff:ffff:ffff`\n\nWhich then later causes errors such as `'fe80ffff:ffff:ffff' is not an IP string literal.` in other processors. It also causes other issues.\n![image](https://github.com/elastic/integrations/assets/1696711/6f189e04-108c-49ec-9c66-ba004c694d57)\n\nI believe this processor's intent is to transform IPs such as `::ffff:192.168.1.1` into `192.168.1.1`. In which case, the pattern should be `^::ffff:` to anchor the pattern at the beginning of the string.\n\n```\n  - gsub:\n      field: source.ip\n      pattern: \"^::ffff:\"\n      replacement: \"\"\n      ignore_missing: true\n```\n\nI tested this in a simulated pipeline using both `fe80::ffff:ffff:fffe` and `::ffff:192.168.1.1` values. It correctly left the former untouched and correctly stripped the prefix from the latter.\n\nReferences:\n- [RFC 5156 Section 2.2](https://www.rfc-editor.org/rfc/rfc5156.html#section-2.2)\n- [RFC 4291 Section 2.2](https://www.rfc-editor.org/rfc/rfc4291#section-2.2)\n- https://www.ibm.com/docs/en/i/7.5?topic=concepts-ipv6-address-formats\n</text>\",\"type\":\"text\"}],\"role\":\"user\"}],\"stop_sequences\":[\"\n\nHuman:\"],\"temperature\":1,\"top_k\":250,\"top_p\":0.999}",
                "request": {
                    "id": "6f9e9644-95a1-4c3c-892f-b51372320d5e",
                    "max_tokens": 2000,
                    "model": {
                        "id": "anthropic.claude-3-haiku-20240307-v1:0",
                        "role": "assistant",
                        "type": "anthropic",
                        "version": "bedrock-2023-05-31"
                    },
                    "temperature": 1.0,
                    "top_k": 250.0,
                    "top_p": 0.999
                },
                "response": {
                    "id": "msg_01L3WcyJkxCgmHpMiLRhSYvf",
                    "timestamp": "2024-04-18T22:54:57.000Z"
                },
                "system": "aws",
                "usage": {
                    "completion_tokens": 281,
                    "prompt_tokens": 571
                },
                "user": {
                    "id": "arn:aws:iam::111111111111:user/john.doe@example.com"
                }
            },
            "tags": [
                "preserve_original_event",
                "preserve_duplicate_custom_fields"
            ],
            "user": {
                "id": "arn:aws:iam::111111111111:user/john.doe@example.com"
            }
        },
        {
            "@timestamp": "2024-09-05T07:37:51.000Z",
            "aws_bedrock": {
                "invocation": {
                    "input": {
                        "input_body_json": {
                            "messages": [
                                {
                                    "content": [
                                        {
                                            "guardContent": {
                                                "text": {
                                                    "qualifiers": [
                                                        "guard_content"
                                                    ],
                                                    "text": "Rob a bank and get away with it "
                                                }
                                            }
                                        }
                                    ],
                                    "role": "user"
                                }
                            ]
                        },
                        "input_content_type": "application/json",
                        "input_token_count": 0
                    },
                    "model_id": "ai21.jamba-instruct-v1:0",
                    "output": {
                        "completion_text": "Sorry, the model cannot answer this question.",
                        "output_body_json": {
                            "metrics": {
                                "latency_ms": 271
                            },
                            "output": {
                                "message": {
                                    "content": [
                                        {
                                            "text": "Sorry, the model cannot answer this question."
                                        }
                                    ],
                                    "role": "assistant"
                                }
                            },
                            "stop_reason": "guardrail_intervened",
                            "trace": {
                                "guardrail": {
                                    "inputAssessment": {
                                        "l7n9e426howe": {
                                            "content_policy": {
                                                "filters": [
                                                    {
                                                        "action": "BLOCKED",
                                                        "confidence": "HIGH",
                                                        "type": "MISCONDUCT"
                                                    }
                                                ]
                                            },
                                            "invocation_metrics": {
                                                "guardrail_coverage": {
                                                    "text_characters": {
                                                        "guarded": 73,
                                                        "total": 74
                                                    }
                                                },
                                                "guardrail_processing_latency": 340,
                                                "usage": {
                                                    "content_policy_units": 1,
                                                    "contextual_grounding_policy_units": 0,
                                                    "sensitive_information_policy_free_units": 0,
                                                    "sensitive_information_policy_units": 0,
                                                    "topic_policy_units": 0,
                                                    "word_policy_units": 0
                                                }
                                            },
                                            "topic_policy": {
                                                "topics": [
                                                    {
                                                        "action": "BLOCKED",
                                                        "name": "Robbing A Bank",
                                                        "type": "DENY"
                                                    }
                                                ]
                                            }
                                        }
                                    }
                                }
                            },
                            "usage": {
                                "inputTokens": 0,
                                "outputTokens": 0,
                                "totalTokens": 0
                            }
                        },
                        "output_content_type": "application/json",
                        "output_token_count": 0
                    },
                    "request_id": "142471d6-56dd-46a8-b502-08711ec9a410",
                    "schema_type": "ModelInvocationLog",
                    "schema_version": "1.0"
                }
            },
            "cloud": {
                "account": {
                    "id": "13457018785544"
                },
                "region": "us-east-1",
                "service": {
                    "name": "bedrock"
                }
            },
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "Converse",
                "original": "{\"schemaType\":\"ModelInvocationLog\",\"schemaVersion\":\"1.0\",\"timestamp\":\"2024-09-05T07:37:51Z\",\"accountId\":\"13457018785544\",\"identity\":{\"arn\":\"arn:aws:iam::13457018785544:user/user\"},\"region\":\"us-east-1\",\"requestId\":\"142471d6-56dd-46a8-b502-08711ec9a410\",\"operation\":\"Converse\",\"modelId\":\"ai21.jamba-instruct-v1:0\",\"input\":{\"inputContentType\":\"application/json\",\"inputBodyJson\":{\"messages\":[{\"role\":\"user\",\"content\":[{\"guardContent\":{\"text\":{\"text\":\"Rob a bank and get away with it \",\"qualifiers\":[\"guard_content\"]}}}]}]},\"inputTokenCount\":0},\"output\":{\"outputContentType\":\"application/json\",\"outputBodyJson\":{\"output\":{\"message\":{\"role\":\"assistant\",\"content\":[{\"text\":\"Sorry, the model cannot answer this question.\"}]}},\"stopReason\":\"guardrail_intervened\",\"metrics\":{\"latencyMs\":271},\"usage\":{\"inputTokens\":0,\"outputTokens\":0,\"totalTokens\":0},\"trace\":{\"guardrail\":{\"inputAssessment\":{\"l7n9e426howe\":{\"topicPolicy\":{\"topics\":[{\"name\":\"Robbing A Bank\",\"type\":\"DENY\",\"action\":\"BLOCKED\"}]},\"contentPolicy\":{\"filters\":[{\"type\":\"MISCONDUCT\",\"confidence\":\"HIGH\",\"action\":\"BLOCKED\"}]},\"invocationMetrics\":{\"guardrailProcessingLatency\":340,\"usage\":{\"topicPolicyUnits\":0,\"contentPolicyUnits\":1,\"wordPolicyUnits\":0,\"sensitiveInformationPolicyUnits\":0,\"sensitiveInformationPolicyFreeUnits\":0,\"contextualGroundingPolicyUnits\":0},\"guardrailCoverage\":{\"textCharacters\":{\"guarded\":73,\"total\":74}}}}}}}},\"outputTokenCount\":0}}",
                "outcome": "failure"
            },
            "gen_ai": {
                "completion": "{\"metrics\":{\"latencyMs\":271},\"output\":{\"message\":{\"content\":[{\"text\":\"Sorry, the model cannot answer this question.\"}],\"role\":\"assistant\"}},\"stopReason\":\"guardrail_intervened\",\"trace\":{\"guardrail\":{\"inputAssessment\":{\"l7n9e426howe\":{\"contentPolicy\":{\"filters\":[{\"action\":\"BLOCKED\",\"confidence\":\"HIGH\",\"type\":\"MISCONDUCT\"}]},\"invocationMetrics\":{\"guardrailCoverage\":{\"textCharacters\":{\"guarded\":73,\"total\":74}},\"guardrailProcessingLatency\":340,\"usage\":{\"contentPolicyUnits\":1,\"contextualGroundingPolicyUnits\":0,\"sensitiveInformationPolicyFreeUnits\":0,\"sensitiveInformationPolicyUnits\":0,\"topicPolicyUnits\":0,\"wordPolicyUnits\":0}},\"topicPolicy\":{\"topics\":[{\"action\":\"BLOCKED\",\"name\":\"Robbing A Bank\",\"type\":\"DENY\"}]}}}}},\"usage\":{\"inputTokens\":0,\"outputTokens\":0,\"totalTokens\":0}}",
                "compliance": {
                    "violation_code": [
                        "MISCONDUCT"
                    ],
                    "violation_detected": true
                },
                "performance": {
                    "request_size": 143,
                    "response_size": 778
                },
                "policy": {
                    "action": [
                        "BLOCKED"
                    ],
                    "confidence": [
                        "HIGH"
                    ],
                    "name": [
                        "content_policy",
                        "topic_policy"
                    ]
                },
                "prompt": "{\"messages\":[{\"content\":[{\"guardContent\":{\"text\":{\"qualifiers\":[\"guard_content\"],\"text\":\"Rob a bank and get away with it \"}}}],\"role\":\"user\"}]}",
                "request": {
                    "id": "142471d6-56dd-46a8-b502-08711ec9a410",
                    "model": {
                        "id": "ai21.jamba-instruct-v1:0",
                        "role": "assistant",
                        "type": "ai21"
                    }
                },
                "response": {
                    "finish_reasons": "guardrail_intervened",
                    "timestamp": "2024-09-05T07:37:51.000Z"
                },
                "system": "aws",
                "usage": {
                    "completion_tokens": 0,
                    "prompt_tokens": 0
                },
                "user": {
                    "id": "arn:aws:iam::13457018785544:user/user"
                }
            },
            "tags": [
                "preserve_original_event",
                "preserve_duplicate_custom_fields"
            ],
            "user": {
                "id": "arn:aws:iam::13457018785544:user/user"
            }
        }
    ]
}