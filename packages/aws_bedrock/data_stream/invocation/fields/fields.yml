- name: aws_bedrock.invocation
  type: group
  fields:
    - name: input.inputBodyJson
      type: flattened
    - name: input.inputBodyJson_massive_hash
      type: keyword
    - name: input.inputContentType
      type: keyword
    - name: input.inputTokenCount
      type: long
      description: TODO
    - name: modelId
      type: keyword
    - name: output.outputBodyJson
      type: flattened
    - name: output.outputContentType
      type: keyword
    - name: output.outputTokenCount
      type: long
    - name: requestId
      type: keyword
    - name: schemaType
      type: keyword
    - name: schemaVersion
      type: keyword
    - name: artifacts
      type: keyword
    - name: error
      type: keyword
    - name: errorCode
      type: keyword
    - name: imageGenerationConfig.cfgScale
      type: double
    - name: imageGenerationConfig.height
      type: long
    - name: imageGenerationConfig.numberOfImages
      type: long
    - name: imageGenerationConfig.quality
      type: keyword
    - name: imageGenerationConfig.seed
      type: long
    - name: imageGenerationConfig.width
      type: long
    - name: imageVariationParams.images
      type: keyword
    - name: imageVariationParams.text
      type: keyword
    - name: images
      type: keyword
    - name: input.inputBodyS3Path
      type: keyword
    - name: output.outputBodyS3Path
      type: keyword
    - name: result
      type: keyword
    - name: taskType
      type: keyword
- name: llm.request.content
  type: text
  description: The full text of the user's request to the LLM.
- name: llm.request.token_count
  type: integer
  description: Number of tokens in the user's request.
- name: llm.response.content
  type: text
  description: The full text of the LLM's response.
- name: llm.response.token_count
  type: integer
  description: Number of tokens in the LLM's response.
- name: llm.request.id
  type: keyword
  description: Unique identifier for the LLM request.
- name: llm.response.id
  type: keyword
  description: Unique identifier for the LLM response.
- name: llm.request.timestamp
  type: date
  description: Timestamp when the request was made.
- name: llm.response.timestamp
  type: date
  description: Timestamp when the response was received.
- name: llm.model.name
  type: keyword
  description: Name of the LLM model used to generate the response.
- name: llm.model.version
  type: keyword
  description: Version of the LLM model used to generate the response.
- name: llm.model.id
  type: keyword
  description: Unique identifier for the LLM model.
- name: llm.model.role
  type: keyword
  description: Role of the LLM model in the interaction.
- name: llm.model.type
  type: keyword
  description: Type of LLM model.
- name: llm.model.description
  type: keyword
  description: Description of the LLM model.
- name: llm.model.parameters
  type: keyword
  description: Parameters used to confirm the LLM model.
- name: llm.text.readability_score
  type: float
  description: Measures the readability level of the text.
- name: llm.text.complexity_score
  type: float
  description: Evaluates the complexity of the text.
- name: llm.text.similarity_score
  type: float
  description: Measures the similarity between the prompt and response.
- name: llm.security.regex_pattern_count
  type: integer
  description: Counts occurrences of strings matching user-defined regex patterns.
- name: llm.security.jailbreak_score
  type: float
  description: Measures similarity to known jailbreak attempts.
- name: llm.security.prompt_injection_score
  type: float
  description: Measures similarity to known prompt injection attacks.
- name: llm.security.hallucination_consistency
  type: float
  description: Consistency check between multiple responses.
- name: llm.security.refusal_score
  type: float
  description: Measures similarity to known LLM refusal responses.
- name: llm.sentiment.score
  type: float
  description: Sentiment analysis score.
- name: llm.sentiment.toxicity_score
  type: float
  description: Toxicity analysis score.
- name: llm.security.risk_score
  type: float
  description: Numerical score indicating the potential risk associated with the response.
- name: llm.security.threat_type
  type: keyword
  description: Type of threat detected in the LLM interaction.
- name: llm.security.threat_detected
  type: boolean
  description: Whether a security threat was detected.
- name: llm.security.threat_category
  type: keyword
  description: Category of the detected security threat.
- name: llm.security.threat_description
  type: text
  description: Description of the detected security threat.
- name: llm.security.threat_action
  type: keyword
  description: Recommended action to mitigate the detected security threat.
- name: llm.security.threat_source
  type: keyword
  description: Source of the detected security threat.
- name: llm.security.threat_signature
  type: keyword
  description: Signature of the detected security threat.
- name: llm.response.compliance.violation
  type: keyword
  description: Compliance violation code identified in the interaction.
- name: llm.response.filter.triggerer
  type: keyword
  description: Filters triggered during the processing of the response.
- name: llm.request.filter.triggerer
  type: keyword
  description: Filters triggered during the processing of the request.
- name: llm.security.yara.matches
  type: nested
  description: Stores results from YARA scans including rule matches and categories.
- name: llm.owasp.id
  type: keyword
  description: Identifier for the OWASP risk addressed.
- name: llm.owasp.description
  type: text
  description: Description of the OWASP risk triggered.
- name: llm.analysis.tool_names
  type: keyword
  description: Name of the security or analysis tools used.
- name: llm.analysis.function
  type: keyword
  description: Name of the security or analysis function used.
- name: llm.analysis.findings
  type: nested
  description: Detailed findings from security tools.
- name: llm.analysis.action_recommended
  type: keyword
  description: Recommended actions based on the analysis.
- name: llm.content.inappropriate
  type: boolean
  description: Whether the content was flagged as inappropriate or sensitive.
- name: llm.content.categories
  type: keyword
  description: Categories of content identified as sensitive or requiring moderation.
- name: llm.performance.response_time
  type: long
  description: Time taken by the LLM to generate a response in milliseconds.
- name: llm.performance.request_size
  type: long
  description: Size of the request payload in bytes.
- name: llm.performance.response_size
  type: long
  description: Size of the response payload in bytes.
