{{#if project_id}}
project_id: {{project_id}}
{{/if}}
{{#if service_account_key}}
auth.credentials_json.account_key: {{service_account_key}}
{{/if}}
{{#if service_account_file}}
auth.credentials_file.path: {{service_account_file}}
{{/if}}
{{#if number_of_workers}}
max_workers: {{number_of_workers}}
{{/if}}
{{#if poll}}
poll: {{poll}}
{{/if}}
{{#if poll_interval}}
poll_interval: {{poll_interval}}
{{/if}}
{{#if bucket_timeout}}
bucket_timeout: {{bucket_timeout}}
{{/if}}
{{#if buckets}}
buckets:
{{buckets}}
{{/if}}
{{#if file_selectors}}
file_selectors:
{{file_selectors}}
{{/if}}
{{#if timestamp_epoch}}
timestamp_epoch: {{timestamp_epoch}}
{{/if}}
{{#if tags}}
tags:
{{#if preserve_original_event}}
  - preserve_original_event
{{/if}}
{{#if preserve_duplicate_custom_fields}}
  - preserve_duplicate_custom_fields
{{/if}}
{{#each tags as |tag|}}
  - {{tag}}
{{/each}}
{{/if}}
{{#contains "forwarded" tags}}
publisher_pipeline.disable_host: true
{{/contains}}
fields_under_root: true
fields:
  _conf:
    reroute:
{{#if reroute_command_script}}
      - command_script
{{/if}}
{{#if reroute_cross_process}}
      - cross_process
{{/if}}
{{#if reroute_dns}}
      - dns
{{/if}}
{{#if reroute_file}}
      - file
{{/if}}
{{#if reroute_indicators}}
      - indicators
{{/if}}
{{#if reroute_logins}}
      - logins
{{/if}}
{{#if reroute_module}}
      - module
{{/if}}
{{#if reroute_ip}}
      - ip
{{/if}}
{{#if reroute_process}}
      - process
{{/if}}
{{#if reroute_registry}}
      - registry
{{/if}}
{{#if reroute_scheduled_task}}
      - scheduled_task
{{/if}}
{{#if reroute_threat_intelligence_indicators}}
      - threat_intelligence_indicators
{{/if}}
{{#if reroute_url}}
      - url
{{/if}}
{{#if processors}}
processors:
{{processors}}
{{/if}}
