{{#if collect_s3_logs}}

{{#if bucket_arn}}
bucket_arn: {{bucket_arn}}
{{/if}}
{{#if number_of_workers}}
number_of_workers: {{number_of_workers}}
{{/if}}
{{#if interval}}
bucket_list_interval: {{interval}}
{{/if}}
{{#if bucket_list_prefix}}
bucket_list_prefix: {{bucket_list_prefix}}
{{/if}}

{{else}}

{{#if queue_url}}
queue_url: {{queue_url}}
{{/if}}
{{#if visibility_timeout}}
visibility_timeout: {{visibility_timeout}}
{{/if}}
{{#if api_timeout}}
api_timeout: {{api_timeout}}
{{/if}}
{{#if max_number_of_messages}}
max_number_of_messages: {{max_number_of_messages}}
{{/if}}
{{#if file_selectors}}
file_selectors:
{{file_selectors}}
{{/if}}

{{/if}}

{{#if access_key_id}}
access_key_id: {{access_key_id}}
{{/if}}
{{#if secret_access_key}}
secret_access_key: {{secret_access_key}}
{{/if}}
{{#if session_token}}
session_token: {{session_token}}
{{/if}}
{{#if shared_credential_file}}
shared_credential_file: {{shared_credential_file}}
{{/if}}
{{#if credential_profile_name}}
credential_profile_name: {{credential_profile_name}}
{{/if}}
{{#if role_arn}}
role_arn: {{role_arn}}
{{/if}}
{{#if fips_enabled}}
fips_enabled: {{fips_enabled}}
{{/if}}
{{#if proxy_url}}
proxy_url: {{proxy_url}}
{{/if}}
{{#if ssl}}
ssl: {{ssl}}
{{/if}}
tags:
{{#if collect_s3_logs}}
  - collect_s3_logs
{{else}}
  - collect_sqs_logs
{{/if}}
{{#if preserve_original_event}}
  - preserve_original_event
{{/if}}
{{#if preserve_duplicate_custom_fields}}
  - preserve_duplicate_custom_fields
{{/if}}
{{#each tags as |tag|}}
  - {{tag}}
{{/each}}
{{#contains "forwarded" tags}}
publisher_pipeline.disable_host: true
{{/contains}}
fields_under_root: true
fields:
  _conf:
    reroute:
{{#if reroute_command_script}}
      - command_script
{{/if}}
{{#if reroute_cross_process}}
      - cross_process
{{/if}}
{{#if reroute_dns}}
      - dns
{{/if}}
{{#if reroute_file}}
      - file
{{/if}}
{{#if reroute_indicators}}
      - indicators
{{/if}}
{{#if reroute_logins}}
      - logins
{{/if}}
{{#if reroute_module}}
      - module
{{/if}}
{{#if reroute_ip}}
      - ip
{{/if}}
{{#if reroute_process}}
      - process
{{/if}}
{{#if reroute_registry}}
      - registry
{{/if}}
{{#if reroute_scheduled_task}}
      - scheduled_task
{{/if}}
{{#if reroute_threat_intelligence_indicators}}
      - threat_intelligence_indicators
{{/if}}
{{#if reroute_url}}
      - url
{{/if}}
{{#if processors}}
processors:
{{processors}}
{{/if}}
