rules:
  - path: /tenant_id/oauth2/v2.0/token
    methods: [POST]
    query_params:
      grant_type: client_credentials
    request_headers:
      Content-Type:
        - "application/x-www-form-urlencoded"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Ilg1ZVhrN","token_type": "Bearer","not_before": 1549647431,"expires_in": 3600}
  - path: /v1.0/security/alerts
    methods: [GET]
    request_headers:
      Authorization:
        - "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Ilg1ZVhrN"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"value":[{"id":"4aa44691837176a9860fc1a45311cbbfd738e2b998d25c6a3b12ca92f1069c12","azureTenantId":"3a6c8551-d1fd-496f-b460-579f97fa62a2","azureSubscriptionId":null,"riskScore":null,"tags":[],"activityGroupName":null,"assignedTo":null,"category":"UnfamiliarLocation","closedDateTime":null,"comments":[],"confidence":null,"createdDateTime":"2023-01-11T23:57:49.6697451Z","description":"Sign-in with properties we have not seen recently for the given user","detectionIds":[],"eventDateTime":"2023-01-11T23:57:53.498346Z","feedback":null,"incidentIds":[],"lastEventDateTime":null,"lastModifiedDateTime":"2023-01-11T23:59:28.9104971Z","recommendedActions":[],"severity":"high","sourceMaterials":[],"status":"resolved","title":"Unfamiliar sign-in properties","vendorInformation":{"provider":"IPC","providerVersion":null,"subProvider":null,"vendor":"Microsoft"},"alertDetections":[],"cloudAppStates":[],"fileStates":[],"hostStates":[],"historyStates":[],"investigationSecurityStates":[],"malwareStates":[],"messageSecurityStates":[],"networkConnections":[],"processes":[],"registryKeyStates":[],"securityResources":[],"triggers":[],"userStates":[{"aadUserId":"056adb89-87b7-47fc-b875-98cecfa53147","accountName":null,"domainName":null,"emailRole":"unknown","isVpn":null,"logonDateTime":"2023-01-11T23:57:53.498346Z","logonId":null,"logonIp":"112.134.141.153","logonLocation":"Colombo, Kolamba, LK","logonType":null,"onPremisesSecurityIdentifier":null,"riskScore":null,"userAccountType":null,"userPrincipalName":null}],"uriClickSecurityStates":[],"vulnerabilityStates":[]},{"id":"4bafb31d5c524fb55810d4e77483252cef7175d402abe8d4843f9ba76367aba0","azureTenantId":"3a6c8551-d1fd-496f-b460-579f97fa62a2","azureSubscriptionId":null,"riskScore":null,"tags":[],"activityGroupName":null,"assignedTo":null,"category":"UnfamiliarLocation","closedDateTime":null,"comments":[],"confidence":null,"createdDateTime":"2023-01-12T04:09:31.680986Z","description":"Sign-in with properties we have not seen recently for the given user","detectionIds":[],"eventDateTime":"2023-01-12T04:09:31.680986Z","feedback":null,"incidentIds":[],"lastEventDateTime":null,"lastModifiedDateTime":"2023-01-12T04:11:40.8254189Z","recommendedActions":[],"severity":"low","sourceMaterials":[],"status":"resolved","title":"Unfamiliar sign-in properties","vendorInformation":{"provider":"IPC","providerVersion":null,"subProvider":null,"vendor":"Microsoft"},"alertDetections":[],"cloudAppStates":[],"fileStates":[],"hostStates":[],"historyStates":[],"investigationSecurityStates":[],"malwareStates":[],"messageSecurityStates":[],"networkConnections":[],"processes":[],"registryKeyStates":[],"securityResources":[],"triggers":[],"userStates":[{"aadUserId":"056adb89-87b7-47fc-b875-98cecfa53147","accountName":null,"domainName":null,"emailRole":"unknown","isVpn":null,"logonDateTime":"2023-01-12T04:09:31.680986Z","logonId":null,"logonIp":"167.179.163.0","logonLocation":"Holland Park West, Queensland, AU","logonType":null,"onPremisesSecurityIdentifier":null,"riskScore":null,"userAccountType":null,"userPrincipalName":null}],"uriClickSecurityStates":[],"vulnerabilityStates":[]}]}
