
rules:
  - path: /v1/login
    methods: ['POST']
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |
          {{ minify_json `
          {
            "jwt": "xxxx",
            "refreshToken": "yyyy",
            "expiresIn": 86400,
            "expires": "Fri, 22 Aug 2026 09:23:07 GMT"
          }
          `}}
  - path: /v1/classifications
    methods: ['GET']
    query_params:
      limit: 2
      offset: 0
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 0,
            "total": 5,
            "results": [
              {
                "uid": "01980ae3-3870-7f54-86b8-81aac1416d93",
                "name": "ABA Routing Number",
                "sensitivity": "Internal",
                "sensitivityDisplayName": "Internal",
                "defaultSensitivity": "Internal",
                "defaultSensitivityDisplayName": "Internal",
                "context": {
                  "role": null,
                  "tokenization": "Plain",
                  "geoLocations": [],
                  "synthetic": false,
                  "dataSubjectAge": "None",
                  "businessContext": [],
                  "identified": false,
                  "identifiability": "PossiblyIdentifiable"
                },
                "classificationGroup": "Financial",
                "dataCategory": "Financial",
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "learned": false,
                "classificationLevel": "Element",
                "dataClassName": "ABA Routing Number",
                "classificationName": "ABA Routing Number"
              },
              {
                "uid": "0197c65d-de90-760b-bb83-3f9e0afab315",
                "name": "Account Balance",
                "sensitivity": "VerySensitive",
                "sensitivityDisplayName": "Restricted",
                "defaultSensitivity": "VerySensitive",
                "defaultSensitivityDisplayName": "Restricted",
                "context": {
                  "role": null,
                  "tokenization": "Plain",
                  "geoLocations": [],
                  "synthetic": false,
                  "dataSubjectAge": "None",
                  "businessContext": [],
                  "identified": true,
                  "identifiability": "PossiblyIdentifiable"
                },
                "classificationGroup": "Financial",
                "dataCategory": "Financial",
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "learned": false,
                "classificationLevel": "Element",
                "dataClassName": "Account Balance",
                "classificationName": "Account Balance"
              }
            ]
          }
          `}}
  - path: /v1/classifications
    methods: ['GET']
    query_params:
      limit: 2
      offset: 2
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 2,
            "total": 5,
            "results": [
              {
                "uid": "0197c404-426a-71c2-9762-1260fa8ebdaa",
                "name": "Account Number",
                "sensitivity": "NotSensitive",
                "sensitivityDisplayName": "Public",
                "defaultSensitivity": "NotSensitive",
                "defaultSensitivityDisplayName": "Public",
                "context": {
                  "role": null,
                  "tokenization": "Plain",
                  "geoLocations": [],
                  "synthetic": false,
                  "dataSubjectAge": "None",
                  "businessContext": [],
                  "identified": false,
                  "identifiability": "PossiblyIdentifiable"
                },
                "classificationGroup": "Business & IP",
                "dataCategory": "Business & IP",
                "collections": [
                  "Learned"
                ],
                "customCollections": [],
                "frameworks": [],
                "learned": true,
                "classificationLevel": "Element",
                "dataClassName": "Account Number",
                "classificationName": "Account Number"
              },
              {
                "uid": "0197c403-c3a5-7a94-8319-b9278a68b89d",
                "name": "Address",
                "sensitivity": "Internal",
                "sensitivityDisplayName": "Internal",
                "defaultSensitivity": "Internal",
                "defaultSensitivityDisplayName": "Internal",
                "context": {
                  "role": null,
                  "tokenization": "Plain",
                  "geoLocations": [],
                  "synthetic": false,
                  "dataSubjectAge": "None",
                  "businessContext": [],
                  "identified": false,
                  "identifiability": "PossiblyIdentifiable"
                },
                "classificationGroup": "Personal",
                "dataCategory": "Personal",
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "learned": false,
                "classificationLevel": "Element",
                "dataClassName": "Address",
                "classificationName": "Address"
              }
            ]
          }
          `}}
  - path: /v1/classifications
    methods: ['GET']
    query_params:
      limit: 2
      offset: 4
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 4,
            "total": 5,
            "results": [
              {
                "uid": "0197c65d-e19a-7f41-8f5f-67497c1a6c43",
                "name": "Address",
                "sensitivity": "Sensitive",
                "sensitivityDisplayName": "Confidential",
                "defaultSensitivity": "Sensitive",
                "defaultSensitivityDisplayName": "Confidential",
                "context": {
                  "role": null,
                  "tokenization": "Plain",
                  "geoLocations": [
                    "Texas"
                  ],
                  "synthetic": false,
                  "dataSubjectAge": "None",
                  "businessContext": [],
                  "identified": true,
                  "identifiability": "PossiblyIdentifiable"
                },
                "classificationGroup": "Personal",
                "dataCategory": "Personal",
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "learned": false,
                "classificationLevel": "Element",
                "dataClassName": "Address",
                "classificationName": "Address Texas"
              }
            ]
          }
          `}}
  - path: /v3/issues
    methods: ['GET']
    query_params:
      limit: 2
      offset: 0
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 0,
            "total": 5,
            "results": [
              {
                "uid": "mock-uid-12345",
                "cloudProviderTags": [
                  {
                    "key": "providerTag",
                    "value": "mock-tag"
                  }
                ],
                "resolution": "Accept risk",
                "resolutionNote": "the issue was closed in version X.Y.Z",
                "name": "Credit card number in plain text",
                "severity": "Critical",
                "createdDate": "2025-07-02T09:32:02.787Z",
                "updatedDate": "2025-07-25T04:09:41.965Z",
                "status": "Open",
                "riskStatus": "Unmitigated",
                "datastoreName": "Mock User/OneDrive",
                "datastoreUid": "mock-datastore-uid-001",
                "provider": "Microsoft365",
                "infrastructure": "OneDrive",
                "engine": "one-drive",
                "regions": [
                  "Americas"
                ],
                "risk": {
                  "policyUid": "mock-policy-uid-001",
                  "useCases": [
                    "DataSprawl",
                    "DataEncryption"
                  ],
                  "frameworks": [
                    "PCI DSS",
                    "PHIPA",
                    "PIPEDA",
                    "Cyera Security Basics"
                  ],
                  "description": "According to PCI DSS section 3.4 if PAN storage is unavoidable, the data must be rendered unreadable wherever it is stored. Acceptable methods include hashing, truncation, tokenization, or strong encryption."
                },
                "data": {
                  "recordsAtRisk": 999,
                  "affectedRecords": 999,
                  "objectsAtRisk": 5,
                  "dataClassesUids": [
                    "mock-dataclass-uid-001",
                    "mock-dataclass-uid-002",
                    "mock-dataclass-uid-003"
                  ]
                },
                "account": {
                  "name": "MockAccount",
                  "inPlatformIdentifier": "mock-platform-id-001"
                },
                "classificationGroups": [
                  "Personal",
                  "Financial",
                  "Health",
                  "Business & IP",
                  "IT & Security"
                ],
                "datastoreCloudProviderTags": [
                  {
                    "key": "key1",
                    "value": "mock-value"
                  }
                ],
                "datastoreUserTags": [
                  {
                    "uid": "mock-user-uid",
                    "key": "env",
                    "value": "mock-env"
                  }
                ],
                "owner": "mockuser@example.com",
                "datastoreOwners": [
                  {
                    "datastoreOwnerUid": "mock-datastore-owner-001",
                    "email": "mockowner@example.com",
                    "ownerType": "application-owner",
                    "sources": [
                      "SaaSOwner"
                    ]
                  },
                  {
                    "datastoreOwnerUid": "mock-datastore-owner-001",
                    "email": "mockowner@example.com",
                    "ownerType": null,
                    "sources": [
                      "SaaSOwner"
                    ]
                  }
                ],
                "remediationAdvice": "- Evaluate the need for storing credit card data. If unnecessary, delete it.\n- Encrypt sensitive data.\n- Use masking or tokenization where applicable.",
                "policyUid": "mock-policy-uid-001",
                "itsmTickets": [
                  {
                    "uid": "mock-ticket-001",
                    "vendorTicketId": "JIRA-MOCK-123",
                    "vendorLink": "https://mockcompany.atlassian.net/browse/JIRA-MOCK-123",
                    "vendorStatus": "In Progress"
                  }
                ]
              },
              {
                "uid": "0198abcd-1234-5678-9abc-def012345678",
                "name": "Credit card number in plain text",
                "severity": "Critical",
                "createdDate": "2025-07-10T08:20:45.123Z",
                "updatedDate": "2025-07-22T11:45:30.987Z",
                "status": "Open",
                "riskStatus": "Unmitigated",
                "datastoreName": "mock-database-prod-xyz",
                "datastoreUid": "0198dbcd-4321-8765-9def-abcdef987654",
                "provider": "AWS",
                "infrastructure": "rds-mysql",
                "engine": "mysql",
                "regions": [
                  "us-east-1"
                ],
                "risk": {
                  "policyUid": "0198c2ec-55ef-77ab-cc12-778899aabbcc",
                  "useCases": [
                    "DataSprawl",
                    "DataRetention"
                  ],
                  "frameworks": [
                    "PCI DSS",
                    "SOC 2",
                    "ISO 27001"
                  ],
                  "description": "According to PCI DSS section 3.4 if PAN storage is unavoidable, the data must be rendered unreadable wherever it is stored. The PCI-DSS explicitly enumerates the acceptable methods for rendering this data unreadable. These methods include - strong one-way hash functions of the entire PAN, truncation, index token with securely stored pads, strong cryptography."
                },
                "data": {
                  "recordsAtRisk": 2500,
                  "affectedRecords": 2500,
                  "objectsAtRisk": 3,
                  "dataClassesUids": [
                    "0198c3ba-1234-5678-9abc-def098765432"
                  ]
                },
                "account": {
                  "name": "AWS Account - Finance",
                  "inPlatformIdentifier": "a1b2c3d4-5678-90ab-cdef-1234567890ab"
                },
                "classificationGroups": [
                  "Financial",
                  "IT & Security"
                ],
                "datastoreCloudProviderTags": [
                  {
                    "key": "BusinessUnit",
                    "value": "Finance"
                  },
                  {
                    "key": "CostCenter",
                    "value": "99887"
                  },
                  {
                    "key": "Department",
                    "value": "CloudOps"
                  },
                  {
                    "key": "Environment",
                    "value": "Prod"
                  },
                  {
                    "key": "Project",
                    "value": "Everest"
                  }
                ],
                "datastoreUserTags": [
                  {
                    "key": "owner",
                    "value": "TeamX"
                  }
                ],
                "owner": "owner@mockmail.com",
                "datastoreOwners": [
                  {
                    "datastoreOwnerUid": "0198efgh-6789-1234-abcd-ef9876543210",
                    "email": "datastore.owner@mockmail.com",
                    "ownerType": "application-owner",
                    "sources": [
                      "IAM"
                    ]
                  }
                ],
                "remediationAdvice": "- Evaluate the need for storing credit card data in the current location. If it is not necessary, promptly delete the information to reduce the risk of unauthorized access.\n- Encrypt the data using strong encryption algorithms.\n- Choose either masking or tokenization as a method for securely displaying or storing credit card numbers.",
                "policyUid": "0198c2ec-55ef-77ab-cc12-778899aabbcc",
                "itsmTickets": [
                  {
                    "uid": "abc12345-6789-def0-1234-56789abcdef0",
                    "vendorTicketId": "SNOW-98765",
                    "vendorLink": "https://company.service-now.com/nav_to.do?uri=incident.do?sys_id=12345",
                    "vendorStatus": "Open"
                  }
                ]
              }
            ]
          }
          `}}
  - path: /v3/issues
    methods: ['GET']
    query_params:
      limit: 2
      offset: 2
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 2,
            "total": 5,
            "results": [
              {
                "uid": "0197e038-8222-78cb-94ff-3a4f92c67ad1",
                "name": "Passport Numbers stored in plain text",
                "severity": "Medium",
                "createdDate": "2025-06-18T10:24:47.392Z",
                "updatedDate": "2025-07-25T09:12:19.654Z",
                "status": "Open",
                "riskStatus": "Unmitigated",
                "datastoreName": "travel-insurance-db-euwest",
                "datastoreUid": "0197c315-99f4-7a2e-b16c-872314c2f0ce",
                "provider": "AWS",
                "infrastructure": "aws-rds-instance",
                "engine": "mysql",
                "regions": [
                  "eu-west-1"
                ],
                "risk": {
                  "policyUid": "0197c2ec-22ff-71b3-b120-11fc908ab543",
                  "useCases": [
                    "DataSprawl",
                    "DataRetention"
                  ],
                  "frameworks": [
                    "GDPR",
                    "ISO 27001",
                    "SOC 2",
                    "Security Basics"
                  ],
                  "description": "Passport numbers are classified as sensitive identifiers under privacy frameworks like GDPR and ISO 27001. Storing them in plain text without encryption or access restrictions introduces privacy risks, potential identity theft exposure, and regulatory non-compliance. Organizations are required to implement data protection controls including encryption, masking, or tokenization."
                },
                "data": {
                  "recordsAtRisk": 520,
                  "affectedRecords": 520,
                  "objectsAtRisk": 3,
                  "dataClassesUids": [
                    "0197c3ba-09aa-76ac-8d89-12bc6731a4b1"
                  ]
                },
                "account": {
                  "name": "AWS Account - Travel Services",
                  "inPlatformIdentifier": "a612edc9-89db-47f9-b85f-13ba73a92c42"
                },
                "classificationGroups": [
                  "Personal",
                  "Business & IP"
                ],
                "datastoreCloudProviderTags": [
                  {
                    "key": "BusinessUnit",
                    "value": "Travel"
                  },
                  {
                    "key": "CostCenter",
                    "value": "44219"
                  },
                  {
                    "key": "Department",
                    "value": "Engineering"
                  },
                  {
                    "key": "Environment",
                    "value": "QA"
                  },
                  {
                    "key": "Project",
                    "value": "Voyager"
                  }
                ],
                "datastoreUserTags": [],
                "owner": null,
                "datastoreOwners": [
                  {
                    "datastoreOwnerUid": "0197c31f-09bb-72de-8110-7bf4ecd8e61f",
                    "email": "jdoe@travelcorp.com",
                    "ownerType": null,
                    "sources": [
                      "CloudTrail"
                    ]
                  }
                ],
                "remediationAdvice": "- **Evaluate necessity**: Remove passport number storage unless strictly required.\n- **Encrypt**: Use AES-256 or stronger encryption at rest and TLS 1.2+ for data in transit.\n- **Mask/Tokenize**: Consider tokenization or masking when displaying data.\n- **Access Control**: Restrict access using least privilege.\n- **Retention Policy**: Define and enforce data retention timelines for passport data.",
                "policyUid": "0197c2ec-22ff-71b3-b120-11fc908ab543",
                "itsmTickets": []
              },
              {
                "uid": "0198e038-8222-78cb-94ff-3a4f92uu7ad1",
                "name": "Passport Numbers stored in plain text",
                "severity": "Medium",
                "createdDate": "2025-06-18T10:24:47.392Z",
                "updatedDate": "2025-07-25T09:12:19.654Z",
                "status": "Open",
                "riskStatus": "Unmitigated",
                "datastoreName": "travel-insurance-db-euwest",
                "datastoreUid": "0197c315-99f4-7a2e-b16c-872314c2f0ce",
                "provider": "AWS",
                "infrastructure": "aws-rds-instance",
                "engine": "mysql",
                "regions": [
                  "eu-west-1"
                ],
                "risk": {
                  "policyUid": "0197c2ec-22ff-71b3-b120-11fc908ab543",
                  "useCases": [
                    "DataSprawl",
                    "DataRetention"
                  ],
                  "frameworks": [
                    "GDPR",
                    "ISO 27001",
                    "SOC 2",
                    "Security Basics"
                  ],
                  "description": "Passport numbers are classified as sensitive identifiers under privacy frameworks like GDPR and ISO 27001. Storing them in plain text without encryption or access restrictions introduces privacy risks, potential identity theft exposure, and regulatory non-compliance. Organizations are required to implement data protection controls including encryption, masking, or tokenization."
                },
                "data": {
                  "recordsAtRisk": 520,
                  "affectedRecords": 520,
                  "objectsAtRisk": 3,
                  "dataClassesUids": [
                    "0197c3ba-09aa-76ac-8d89-12bc6731a4b1"
                  ]
                },
                "account": {
                  "name": "AWS Account - Travel Services",
                  "inPlatformIdentifier": "a612edc9-89db-47f9-b85f-13ba73a92c42"
                },
                "classificationGroups": [
                  "Personal",
                  "Business & IP"
                ],
                "datastoreCloudProviderTags": [
                  {
                    "key": "BusinessUnit",
                    "value": "Travel"
                  },
                  {
                    "key": "CostCenter",
                    "value": "44219"
                  },
                  {
                    "key": "Department",
                    "value": "Engineering"
                  },
                  {
                    "key": "Environment",
                    "value": "QA"
                  },
                  {
                    "key": "Project",
                    "value": "Voyager"
                  }
                ],
                "datastoreUserTags": [],
                "owner": null,
                "datastoreOwners": [
                  {
                    "datastoreOwnerUid": "0197c31f-09bb-72de-8110-7bf4ecd8e61f",
                    "email": "jdoe@travelcorp.com",
                    "ownerType": null,
                    "sources": [
                      "CloudTrail"
                    ]
                  }
                ],
                "remediationAdvice": "- **Evaluate necessity**: Remove passport number storage unless strictly required.\n- **Encrypt**: Use AES-256 or stronger encryption at rest and TLS 1.2+ for data in transit.\n- **Mask/Tokenize**: Consider tokenization or masking when displaying data.\n- **Access Control**: Restrict access using least privilege.\n- **Retention Policy**: Define and enforce data retention timelines for passport data.",
                "policyUid": "0197c2ec-22ff-71b3-b120-11fc908ab543",
                "itsmTickets": []
              }
            ]
          }
          `}}
  - path: /v3/issues
    methods: ['GET']
    query_params:
      limit: 2
      offset: 4
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 4,
            "total": 5,
            "results": [
              {
                "uid": "0198a123-9c77-73de-bb21-fd9e4b88aa67",
                "name": "Driver’s License Number in plain text",
                "severity": "High",
                "createdDate": "2025-08-01T09:12:43.521Z",
                "updatedDate": "2025-08-15T12:48:22.114Z",
                "status": "Open",
                "riskStatus": "Unmitigated",
                "datastoreName": "apollo-insurance-mysql-db-eastus/sql-instance",
                "datastoreUid": "0198a245-67dd-71aa-9b92-7b33c4af7c9f",
                "provider": "AWS",
                "infrastructure": "rds-mysql",
                "engine": "mysql",
                "regions": [
                  "us-east-1"
                ],
                "risk": {
                  "policyUid": "0198a2ec-17bd-7f1e-baf4-198a76455df1",
                  "useCases": [
                    "DataSprawl",
                    "DataProtection"
                  ],
                  "frameworks": [
                    "CCPA",
                    "GDPR",
                    "Cyera Security Basics"
                  ],
                  "description": "Driver’s License Numbers are classified as sensitive identifiers under privacy regulations such as **CCPA** and **GDPR**. Storing them in plain text increases exposure to identity theft risks. Proper safeguards like encryption, tokenization, and strict access controls are required to ensure compliance."
                },
                "data": {
                  "recordsAtRisk": 745,
                  "affectedRecords": 745,
                  "objectsAtRisk": 3,
                  "dataClassesUids": [
                    "0198a39a-03de-71be-8d28-27a5709a34c8",
                    "0198a3be-81de-75d3-8fc1-36f72dab858a"
                  ]
                },
                "account": {
                  "name": "AWS Prod Account",
                  "inPlatformIdentifier": "d826ccc5-dfaa-48b5-92ef-11dc45a2db99"
                },
                "classificationGroups": [
                  "Personal",
                  "Identity",
                  "Business & IP"
                ],
                "datastoreCloudProviderTags": [
                  {
                    "key": "BusinessUnit",
                    "value": "Insurance"
                  },
                  {
                    "key": "CostCenter",
                    "value": "44219"
                  },
                  {
                    "key": "Department",
                    "value": "Risk"
                  },
                  {
                    "key": "Environment",
                    "value": "Prod"
                  },
                  {
                    "key": "Project",
                    "value": "ApolloSecure"
                  }
                ],
                "datastoreUserTags": [],
                "owner": null,
                "datastoreOwners": [
                  {
                    "datastoreOwnerUid": "0198a31f-01fd-72da-9d1c-49ae5dd8e3d0",
                    "email": "jsmith@apollo-secure.com",
                    "ownerType": null,
                    "sources": [
                      "IAMLogs"
                    ]
                  }
                ],
                "remediationAdvice": "- **Assess necessity**: Verify if storing Driver’s License numbers in this datastore is mandatory. If not, securely delete the records.\n- **Apply encryption**: Protect the data at rest and in transit using AES-256 or equivalent.\n- **Restrict access**: Implement role-based access control to ensure only authorized personnel can access the sensitive data.\n- **Audit and monitor**: Enable detailed logging for all queries accessing this data and regularly review for anomalies.",
                "policyUid": "0198a2ec-17bd-7f1e-baf4-198a76455df1",
                "itsmTickets": []
              }
            ]
          }
          `}}
  - path: /v1/events
    methods: ['GET']
    query_params:
      limit: 2
      offset: 0
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 0,
            "total": 5,
            "results": [
              {
                "uid": "e5f3f372-xxxx-4304-9c88-16efcd582125",
                "type": "DisablePolicyEvent",
                "date": "2025-07-31T22:50:28.888Z",
                "user": "joey.example@google.io",
                "policy": {
                  "uid": "019862ad-xxxx-75f4-9ccd-de236d0d4d80",
                  "name": "Files missing [*sensitivity_label*] sensitivity label",
                  "useCases": [
                    "MislabeledData"
                  ]
                }
              },
              {
                "uid": "mock-uid-1001",
                "type": "IssueStatusChangedToClosedEvent",
                "date": "2025-07-29T18:17:18.035Z",
                "account": {
                  "name": "MockAccount",
                  "uid": "mock-account-uid-001"
                },
                "affectedDataClassAppearances": [
                  {
                    "recordsCount": {
                      "dataClass": {
                        "classificationName": "Mock Classification A",
                        "uid": "mock-dc-001"
                      },
                      "recordsCount": 164
                    }
                  },
                  {
                    "recordsCount": {
                      "dataClass": {
                        "classificationName": "Mock Classification B",
                        "uid": "mock-dc-002"
                      },
                      "recordsCount": 170
                    }
                  },
                  {
                    "recordsCount": {
                      "dataClass": {
                        "classificationName": "Mock Classification C",
                        "uid": "mock-dc-003"
                      },
                      "recordsCount": 81
                    }
                  }
                ],
                "policy": {
                  "name": "Mock Policy - Missing Label"
                },
                "issue": {
                  "uid": "mock-issue-uid-001",
                  "riskStatus": "Mitigated",
                  "resolution": "BySystem"
                }
              }
            ]
          }
          `}}
  - path: /v1/events
    methods: ['GET']
    query_params:
      limit: 2
      offset: 2
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 2,
            "total": 5,
            "results": [
              {
                "account": {
                  "name": "stark-industries",
                  "platform": "Azure",
                  "uid": "acc-0197fa56"
                },
                "affectedDataClassAppearances": [
                  {
                    "recordsCount": {
                      "recordsCount": 12500,
                      "dataClass": {
                        "classificationName": "Credit Card Number",
                        "uid": "dc-001"
                      }
                    }
                  },
                  {
                    "recordsCount": {
                      "recordsCount": 4300,
                      "dataClass": {
                        "classificationName": "US Social Security Number",
                        "uid": "dc-002"
                      }
                    }
                  }
                ],
                "affectedObjectsCount": 6,
                "affectedObjectsDiff": 2,
                "affectedRecordsDiff": 310,
                "automaticScanning": {},
                "changedClassificationUid": "cls-xyz789",
                "classificationName": "Sensitive PII",
                "classifications": [
                  {
                    "classificationName": "Financial Data",
                    "uid": "cls-fin-001"
                  }
                ],
                "cloudProvider": "Azure",
                "datastoreUserTags": [
                  "finance",
                  "customer-data"
                ],
                "datastore": {
                  "dataOwner": "Finance Dept",
                  "infrastructure": "Azure SQL",
                  "name": "stark-db-prod",
                  "recordsAtHighRisk": 5000,
                  "uid": "ds-12345",
                  "userTags": [
                    "restricted",
                    "prod"
                  ],
                  "vpcId": "vpc-0f12c34d"
                },
                "date": "2025-08-28T10:15:00Z",
                "deploymentName": "stark-prod-deployment",
                "domainName": "stark-industries.com",
                "expectedM365SensitivityLabelAssignmentsCount": 12,
                "failedM365SensitivityLabelAssignmentsCount": 2,
                "frequency": "daily",
                "inPlatformIdentifier": "sqlserver-01",
                "isDomainTrusted": true,
                "isReportDeleted": false,
                "isReportExpired": false,
                "issueName": "PII exposure in production datastore",
                "issueUid": "issue-0197-xyzt",
                "issue": {
                  "policy": {
                    "name": "PII Protection Policy",
                    "uid": "pol-7890",
                    "useCases": [
                      "Data Privacy",
                      "Compliance"
                    ]
                  },
                  "resolution": "Mitigated",
                  "resolutionNote": "Records encrypted, access restricted.",
                  "riskStatus": "Mitigated",
                  "uid": "issue-abc-123"
                },
                "issues": [
                  {
                    "policy": {
                      "name": "Access Control Policy",
                      "uid": "pol-8910",
                      "useCases": [
                        "Security",
                        "Access Control"
                      ]
                    },
                    "resolution": "In Progress",
                    "resolutionNote": "Pending approval from admin.",
                    "riskStatus": "Partially Mitigated",
                    "uid": "issue-003"
                  }
                ],
                "m365AssignedSensitivityLabelName": "Confidential - Finance",
                "originalSensitivity": "Low",
                "originalSensitivityDisplayName": "Low Sensitivity",
                "policy": {
                  "name": "Confidential Data Handling Policy",
                  "uid": "pol-9988",
                  "useCases": [
                    "Confidentiality",
                    "Access Restriction"
                  ]
                },
                "projectName": "Finance Data Governance",
                "projectUid": "proj-1122",
                "recipients": [
                  "compliance@stark-industries.com",
                  "security@stark-industries.com"
                ],
                "reportFileName": "report-2025-08-28.pdf",
                "reportInstanceUid": "rep-inst-0197",
                "reportJobUid": "rep-job-0197",
                "reportName": "Daily Sensitive Data Report",
                "reportType": "FILES",
                "sku": "premium-enterprise",
                "sourceClassifications": [
                  {
                    "classificationName": "Internal Only",
                    "uid": "cls-int-001"
                  }
                ],
                "subscriptionUid": "sub-7890",
                "successfulM365SensitivityLabelAssignmentsCount": 10,
                "targetClassifications": [
                  {
                    "classificationName": "Highly Confidential",
                    "uid": "cls-hc-001"
                  }
                ],
                "targetSensitivity": "High",
                "targetSensitivityDisplayName": "High Sensitivity",
                "type": "scanEvent",
                "uid": "log-0197-test-xyz",
                "user": "jdoe@stark-industries.com",
                "vendorLink": "https://portal.azure.com/stark-db-prod",
                "vendorStatus": "Open",
                "vendorTicketId": "AZ-INC-45321"
              },
              {
                "uid": "mock-uid-2001",
                "type": "M365SensitivityLabelRemediationFinishedEvent",
                "date": "2025-07-29T17:41:51.058Z",
                "account": {
                  "name": "MockAccount",
                  "uid": "mock-account-uid-002"
                },
                "m365AssignedSensitivityLabelName": "Mock Sensitivity Label",
                "affectedDataClassAppearances": [
                  {
                    "recordsCount": {
                      "dataClass": {
                        "classificationName": "Mock Classification A",
                        "uid": "mock-dc-010"
                      },
                      "recordsCount": 81
                    }
                  }
                ],
                "policy": {
                  "name": "Mock Policy - Missing Label"
                },
                "issue": {
                  "uid": "mock-issue-uid-002",
                  "riskStatus": "RemediationInProgress"
                },
                "expectedM365SensitivityLabelAssignmentsCount": 1,
                "successfulM365SensitivityLabelAssignmentsCount": 1,
                "failedM365SensitivityLabelAssignmentsCount": 0
              }
            ]
          }
          `}}
  - path: /v1/events
    methods: ['GET']
    query_params:
      limit: 2
      offset: 4
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 4,
            "total": 5,
            "results": [
              {
                "account": {
                  "name": "wayne-enterprises",
                  "platform": "AWS",
                  "uid": "acc-0298af12"
                },
                "affectedDataClassAppearances": [
                  {
                    "recordsCount": {
                      "recordsCount": 8900,
                      "dataClass": {
                        "classificationName": "Bank Account Number",
                        "uid": "dc-101"
                      }
                    }
                  },
                  {
                    "recordsCount": {
                      "recordsCount": 2700,
                      "dataClass": {
                        "classificationName": "Passport Number",
                        "uid": "dc-102"
                      }
                    }
                  }
                ],
                "affectedObjectsCount": 4,
                "affectedObjectsDiff": 1,
                "affectedRecordsDiff": 200,
                "automaticScanning": {},
                "changedClassificationUid": "cls-aws789",
                "classificationName": "Financial Identifiers",
                "classifications": [
                  {
                    "classificationName": "PII",
                    "uid": "cls-pii-002"
                  }
                ],
                "cloudProvider": "Snowflake",
                "datastoreUserTags": [
                  "us-data"
                ],
                "datastore": {
                  "dataOwner": "Risk Team",
                  "infrastructure": "Okta",
                  "name": "cane-db-finance",
                  "recordsAtHighRisk": 90,
                  "uid": "ds-33998",
                  "userTags": [
                    "prod"
                  ],
                  "vpcId": "vpc-0987"
                },
                "date": "2025-08-30T13:37:00Z",
                "deploymentName": "finance-prod-deployment",
                "domainName": "wayne-enterprises.com",
                "expectedM365SensitivityLabelAssignmentsCount": 15,
                "failedM365SensitivityLabelAssignmentsCount": 3,
                "frequency": "daily",
                "inPlatformIdentifier": "rds-finance-01",
                "isDomainTrusted": true,
                "isReportDeleted": false,
                "isReportExpired": false,
                "issueName": "Bank account numbers exposed in production",
                "issueUid": "issue-0298-abc",
                "issue": {
                  "policy": {
                    "name": "Financial Data Protection",
                    "uid": "pol-1200",
                    "useCases": [
                      "Compliance"
                    ]
                  },
                  "resolution": "Open",
                  "resolutionNote": "",
                  "riskStatus": "Mitigated",
                  "uid": "issue-0200-fin"
                },
                "m365AssignedSensitivityLabelName": "Highly Confidential",
                "originalSensitivity": "Medium",
                "originalSensitivityDisplayName": "Medium Sensitivity",
                "policy": {
                  "name": "Confidential Data Handling Policy",
                  "uid": "pol-9989",
                  "useCases": [
                    "Confidentiality"
                  ]
                },
                "projectName": "Financial Risk Audit",
                "projectUid": "proj-2233",
                "recipients": [
                  "compliance@wayne-enterprises.com",
                  "security@wayne-enterprises.com"
                ],
                "reportFileName": "report-2025-08-30.pdf",
                "reportInstanceUid": "rep-inst-0298",
                "reportJobUid": "rep-job-0298",
                "reportName": "Daily Finance Sensitive Data Report",
                "reportType": "FILES",
                "sku": "enterprise",
                "sourceClassifications": [
                  {
                    "classificationName": "Internal Only",
                    "uid": "cls-int-002"
                  }
                ],
                "subscriptionUid": "sub-1200",
                "successfulM365SensitivityLabelAssignmentsCount": 12,
                "targetClassifications": [
                  {
                    "classificationName": "Restricted Financial",
                    "uid": "cls-hc-002"
                  }
                ],
                "targetSensitivity": "Medium",
                "targetSensitivityDisplayName": "High Sensitivity",
                "type": "scanEvent",
                "uid": "log10255-test-wpo",
                "user": "bruce.wayne@wayne-enterprises.com",
                "vendorLink": "https://console.aws.amazon.com/rds/home",
                "vendorStatus": "Open",
                "vendorTicketId": "AWS-INC-88321"
              }
            ]
          }
          `}}
  - path: /v2/datastores
    methods: ['GET']
    query_params:
      limit: 2
      createdDate: "{createdDate:20.*}"
      offset: 0
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 0,
            "total": 5,
            "results": [
              {
                "name": "examplecorp/SharedDocs",
                "discoveredDate": "2025-08-28T12:45:39.214Z",
                "provider": "example365",
                "uid": "0198d512-7aa3-4f1b-96db-7c29c3efbb21",
                "type": "M365_DRIVE",
                "dataType": "Unstructured",
                "infrastructure": "OneDrive",
                "engine": "mockpoint-library",
                "cloudProviderUrl": "https://examplecorp.mockpoint.com/sites/global/Shared%20Documents",
                "scanningState": "Scanned",
                "ghost": false,
                "regions": [
                  "Europe"
                ],
                "vpc": null,
                "owner": "sharedocs@examplecorp.onexample.com",
                "userId": "45ab67c2-9f18-4a01-b41a-02dc91d8b765",
                "sensitivity": "NotSensitive",
                "sensitivityDisplayName": "Public",
                "recordCountBySensitivity": {
                  "VerySensitive": 0,
                  "Sensitive": 0,
                  "Internal": 0,
                  "NotSensitive": 0,
                  "Unclassified": 0
                },
                "account": {
                  "name": "examplecorp",
                  "inPlatformIdentifier": "ab92c1de-1f44-48a7-9e13-8d0f229af017"
                },
                "classificationGroups": [],
                "issues": {
                  "open": 0,
                  "closed": 0,
                  "inProgress": 0
                },
                "cloudProviderTags": [],
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "classificationLevel": "Element",
                "learned": false,
                "userTags": [],
                "encrypted": true,
                "sslEnforced": "Unknown",
                "logging": "Enabled",
                "publicAccessibilityState": "Not Public",
                "createdDate": "2025-07-05T09:23:11.000Z",
                "lastDataRefresh": "2025-09-01T14:19:28.876Z",
                "driveId": "b!TqmZHvfLOP89dzuy6FiNAdDfLtxSeZdPoYBhL-Pr4g7JM7PVjTohFQ9x7azLpWxq",
                "datastoreSizeInGiB": 12,
                "projectIds": [],
                "rdsEndpoint": null,
                "datastoreOwners": [
                  {
                    "email": "compliance@examplecorp.onexample.com",
                    "ownerType": "Backup",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "0198d523-b2f6-493c-9a13-f8cd37bc9e44",
                    "datastoreUid": "0198d512-7aa3-4f1b-96db-7c29c3efbb21"
                  }
                ],
                "autoScan": true,
                "siteName": "Global Shared",
                "siteId": "examplecorp.mockpoint.com,26fa8499-35dd-44b7-bc1a-94b7e92e6d73,f9dcb114-34ad-41b0-99d4-07e22a8d0a61"
              },
              {
                "name": "TeamX/Documents",
                "discoveredDate": "2025-06-30T23:12:53.928Z",
                "provider": "example365",
                "uid": "0197abcd-1234-5678-90ab-dc221b36194d",
                "type": "M365_DRIVE",
                "dataType": "Unstructured",
                "infrastructure": "OneDrive",
                "engine": "mockpoint-library",
                "cloudProviderUrl": "https://mocktenant.mockpoint.com/sites/teamx/Shared%20Documents",
                "scanningState": "Unmonitored",
                "ghost": false,
                "regions": [
                  "Americas"
                ],
                "vpc": null,
                "owner": "teamx_owner@mocktenant.onexample.com",
                "userId": "12345678-9abc-def0-1234-56789abcdef0",
                "sensitivity": "Unclassified",
                "sensitivityDisplayName": "Unclassified",
                "recordCountBySensitivity": {
                  "VerySensitive": 0,
                  "Sensitive": 0,
                  "Internal": 0,
                  "NotSensitive": 0,
                  "Unclassified": 0
                },
                "account": {
                  "name": "MockAccount",
                  "inPlatformIdentifier": "abcd1234-5678-90ab-cdef-1234567890ab"
                },
                "classificationGroups": [],
                "issues": {
                  "open": 0,
                  "closed": 0,
                  "inProgress": 0
                },
                "cloudProviderTags": [],
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "classificationLevel": "Element",
                "learned": false,
                "userTags": [],
                "encrypted": true,
                "sslEnforced": "Unknown",
                "logging": "Enabled",
                "publicAccessibilityState": "Not Public",
                "createdDate": "2025-05-12T05:06:50.000Z",
                "driveId": "b!abcdEFGH1234ijkl5678mnop9qrstuvwxYZ",
                "datastoreSizeInGiB": 0,
                "projectIds": [],
                "rdsEndpoint": null,
                "datastoreOwners": [
                  {
                    "email": "teamx_owner@mocktenant.onexample.com",
                    "ownerType": "",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "abcd1234-ef56-7890-abcd-ef1234567890",
                    "datastoreUid": "0197abcd-1234-5678-90ab-dc221b36194d"
                  },
                  {
                    "email": "teamx_owner@mocktenant.onexample.com",
                    "ownerType": "",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "1234abcd-5678-90ef-abcd-0987654321ef",
                    "datastoreUid": "0197abcd-1234-5678-90ab-dc221b36194d"
                  }
                ],
                "autoScan": false,
                "siteName": "TeamX",
                "siteId": "mocktenant.mockpoint.com,abcd1234-5678-90ab-cdef-112233445566,99887766-5544-3322-1100-aabbccddeeff"
              }
            ]
          }
          `}}
  - path: /v2/datastores
    methods: ['GET']
    query_params:
      limit: 2
      createdDate: "{createdDate:20.*}"
      offset: 2
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 2,
            "total": 5,
            "results": [
              {
                "name": "examplecorp/SharedDocs",
                "discoveredDate": "2025-08-28T12:45:39.214Z",
                "provider": "example365",
                "uid": "0198d512-xxxx-4f1b-96db-7c29c3efbb21",
                "type": "M365_DRIVE",
                "dataType": "Unstructured",
                "infrastructure": "OneDrive",
                "engine": "mockpoint-library",
                "cloudProviderUrl": "https://examplecorp.mockpoint.com/sites/global/Shared%20Documents",
                "scanningState": "Scanned",
                "ghost": false,
                "regions": [
                  "Europe"
                ],
                "vpc": null,
                "owner": "sharedocs@examplecorp.onexample.com",
                "userId": "45ab67c2-9f18-4a01-b41a-02dc91d8b765",
                "sensitivity": "NotSensitive",
                "sensitivityDisplayName": "Public",
                "recordCountBySensitivity": {
                  "VerySensitive": 0,
                  "Sensitive": 0,
                  "Internal": 0,
                  "NotSensitive": 0,
                  "Unclassified": 0
                },
                "account": {
                  "name": "examplecorp",
                  "inPlatformIdentifier": "ab92c1de-1f44-48a7-9e13-8d0f229af017"
                },
                "classificationGroups": [],
                "issues": {
                  "open": 0,
                  "closed": 0,
                  "inProgress": 0
                },
                "cloudProviderTags": [],
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "classificationLevel": "Element",
                "learned": false,
                "userTags": [],
                "encrypted": true,
                "sslEnforced": "Unknown",
                "logging": "Enabled",
                "publicAccessibilityState": "Not Public",
                "createdDate": "2025-07-05T09:23:11.000Z",
                "lastDataRefresh": "2025-09-01T14:19:28.876Z",
                "driveId": "b!TqmZHvfLOP89dzuy6FiNAdDfLtxSeZdPoYBhL-Pr4g7JM7PVjTohFQ9x7azLpWxq",
                "datastoreSizeInGiB": 12,
                "projectIds": [],
                "rdsEndpoint": null,
                "datastoreOwners": [
                  {
                    "email": "compliance@examplecorp.onexample.com",
                    "ownerType": "Backup",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "0198d523-b2f6-493c-9a13-f8cd37bc9e44",
                    "datastoreUid": "0198d512-7aa3-4f1b-96db-7c29c3efbb21"
                  }
                ],
                "autoScan": true,
                "siteName": "Global Shared",
                "siteId": "examplecorp.mockpoint.com,26fa8499-35dd-44b7-bc1a-94b7e92e6d73,f9dcb114-34ad-41b0-99d4-07e22a8d0a61"
              },
              {
                "name": "TeamX/Documents",
                "discoveredDate": "2025-06-30T23:12:53.928Z",
                "provider": "example365",
                "uid": "0197abcd-1234-5678-yyyy-dc221b36194d",
                "type": "M365_DRIVE",
                "dataType": "Unstructured",
                "infrastructure": "OneDrive",
                "engine": "mockpoint-library",
                "cloudProviderUrl": "https://mocktenant.mockpoint.com/sites/teamx/Shared%20Documents",
                "scanningState": "Unmonitored",
                "ghost": false,
                "regions": [
                  "Americas"
                ],
                "vpc": null,
                "owner": "teamx_owner@mocktenant.onexample.com",
                "userId": "12345678-9abc-def0-1234-56789abcdef0",
                "sensitivity": "Unclassified",
                "sensitivityDisplayName": "Unclassified",
                "recordCountBySensitivity": {
                  "VerySensitive": 0,
                  "Sensitive": 0,
                  "Internal": 0,
                  "NotSensitive": 0,
                  "Unclassified": 0
                },
                "account": {
                  "name": "MockAccount",
                  "inPlatformIdentifier": "abcd1234-5678-90ab-cdef-1234567890ab"
                },
                "classificationGroups": [],
                "issues": {
                  "open": 0,
                  "closed": 0,
                  "inProgress": 0
                },
                "cloudProviderTags": [],
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "classificationLevel": "Element",
                "learned": false,
                "userTags": [],
                "encrypted": true,
                "sslEnforced": "Unknown",
                "logging": "Enabled",
                "publicAccessibilityState": "Not Public",
                "createdDate": "2025-05-12T05:06:50.000Z",
                "driveId": "b!abcdEFGH1234ijkl5678mnop9qrstuvwxYZ",
                "datastoreSizeInGiB": 0,
                "projectIds": [],
                "rdsEndpoint": null,
                "datastoreOwners": [
                  {
                    "email": "teamx_owner@mocktenant.onexample.com",
                    "ownerType": "",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "abcd1234-ef56-7890-abcd-ef1234567890",
                    "datastoreUid": "0197abcd-1234-5678-90ab-dc221b36194d"
                  },
                  {
                    "email": "teamx_owner@mocktenant.onexample.com",
                    "ownerType": "",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "1234abcd-5678-90ef-abcd-0987654321ef",
                    "datastoreUid": "0197abcd-1234-5678-90ab-dc221b36194d"
                  }
                ],
                "autoScan": false,
                "siteName": "TeamX",
                "siteId": "mocktenant.mockpoint.com,abcd1234-5678-90ab-cdef-112233445566,99887766-5544-3322-1100-aabbccddeeff"
              }
            ]
          }
          `}}
  - path: /v2/datastores
    methods: ['GET']
    query_params:
      limit: 2
      createdDate: "{createdDate:20.*}"
      offset: 4
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 4,
            "total": 5,
            "results": [
              {
                "name": "TeamX/Documents",
                "discoveredDate": "2025-06-30T23:12:53.928Z",
                "provider": "example365",
                "uid": "0197abc9-1234-5678-yyyy-dc221b36194d",
                "type": "M365_DRIVE",
                "dataType": "Unstructured",
                "infrastructure": "OneDrive",
                "engine": "mockpoint-library",
                "cloudProviderUrl": "https://mocktenant.mockpoint.com/sites/teamx/Shared%20Documents",
                "scanningState": "Unmonitored",
                "ghost": false,
                "regions": [
                  "Americas"
                ],
                "vpc": null,
                "owner": "teamx_owner@mocktenant.onexample.com",
                "userId": "12345678-9abc-def0-1234-56789abcdef0",
                "sensitivity": "Unclassified",
                "sensitivityDisplayName": "Unclassified",
                "recordCountBySensitivity": {
                  "VerySensitive": 0,
                  "Sensitive": 0,
                  "Internal": 0,
                  "NotSensitive": 0,
                  "Unclassified": 0
                },
                "account": {
                  "name": "MockAccount",
                  "inPlatformIdentifier": "abcd1234-5678-90ab-cdef-1234567890ab"
                },
                "classificationGroups": [],
                "issues": {
                  "open": 0,
                  "closed": 0,
                  "inProgress": 0
                },
                "cloudProviderTags": [],
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "classificationLevel": "Element",
                "learned": false,
                "userTags": [],
                "encrypted": true,
                "sslEnforced": "Unknown",
                "logging": "Enabled",
                "publicAccessibilityState": "Not Public",
                "createdDate": "2025-05-12T05:06:50.000Z",
                "driveId": "b!abcdEFGH1234ijkl5678mnop9qrstuvwxYZ",
                "datastoreSizeInGiB": 0,
                "projectIds": [],
                "rdsEndpoint": null,
                "datastoreOwners": [
                  {
                    "email": "teamx_owner@mocktenant.onexample.com",
                    "ownerType": "",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "abcd1234-ef56-7890-abcd-ef1234567890",
                    "datastoreUid": "0197abcd-1234-5678-90ab-dc221b36194d"
                  },
                  {
                    "email": "teamx_owner@mocktenant.onexample.com",
                    "ownerType": "",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "1234abcd-5678-90ef-abcd-0987654321ef",
                    "datastoreUid": "0197abcd-1234-5678-90ab-dc221b36194d"
                  }
                ],
                "autoScan": false,
                "siteName": "TeamX",
                "siteId": "mocktenant.mockpoint.com,abcd1234-5678-90ab-cdef-112233445566,99887766-5544-3322-1100-aabbccddeeff"
              }
            ]
          }
          `}}
  - path: /v2/datastores
    methods: ['GET']
    query_params:
      limit: 2
      lastModifiedTimeGte: "{lastModifiedTimeGte:20.*}"
      offset: 0
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 0,
            "total": 5,
            "results": [
              {
                "name": "examplecorp/SharedDocs",
                "discoveredDate": "2025-08-28T12:45:39.214Z",
                "provider": "example365",
                "uid": "0198d512-ffff-4f1b-96db-7c29c3efbb21",
                "type": "M365_DRIVE",
                "dataType": "Unstructured",
                "infrastructure": "OneDrive",
                "engine": "mockpoint-library",
                "cloudProviderUrl": "https://examplecorp.mockpoint.com/sites/global/Shared%20Documents",
                "scanningState": "Scanned",
                "ghost": false,
                "regions": [
                  "Europe"
                ],
                "vpc": null,
                "owner": "sharedocs@examplecorp.onexample.com",
                "userId": "45ab67c2-9f18-4a01-b41a-02dc91d8b765",
                "sensitivity": "NotSensitive",
                "sensitivityDisplayName": "Public",
                "recordCountBySensitivity": {
                  "VerySensitive": 0,
                  "Sensitive": 0,
                  "Internal": 0,
                  "NotSensitive": 0,
                  "Unclassified": 0
                },
                "account": {
                  "name": "examplecorp",
                  "inPlatformIdentifier": "ab92c1de-1f44-48a7-9e13-8d0f229af017"
                },
                "classificationGroups": [],
                "issues": {
                  "open": 0,
                  "closed": 0,
                  "inProgress": 0
                },
                "cloudProviderTags": [],
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "classificationLevel": "Element",
                "learned": false,
                "userTags": [],
                "encrypted": true,
                "sslEnforced": "Unknown",
                "logging": "Enabled",
                "publicAccessibilityState": "Not Public",
                "createdDate": "2025-07-05T09:23:11.000Z",
                "lastModifiedTime": "2025-06-12T22:11:31.343Z",
                "lastDataRefresh": "2025-09-01T14:19:28.876Z",
                "driveId": "b!TqmZHvfLOP89dzuy6FiNAdDfLtxSeZdPoYBhL-Pr4g7JM7PVjTohFQ9x7azLpWxq",
                "datastoreSizeInGiB": 12,
                "projectIds": [],
                "rdsEndpoint": null,
                "datastoreOwners": [
                  {
                    "email": "compliance@examplecorp.onexample.com",
                    "ownerType": "Backup",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "0198d523-b2f6-493c-9a13-f8cd37bc9e44",
                    "datastoreUid": "0198d512-7aa3-4f1b-96db-7c29c3efbb21"
                  }
                ],
                "autoScan": true,
                "siteName": "Global Shared",
                "siteId": "examplecorp.mockpoint.com,26fa8499-35dd-44b7-bc1a-94b7e92e6d73,f9dcb114-34ad-41b0-99d4-07e22a8d0a61"
              },
              {
                "name": "TeamX/Documents",
                "discoveredDate": "2025-06-30T23:12:53.928Z",
                "provider": "example365",
                "uid": "0197abcd-1234-eeee-90ab-dc221b36194d",
                "type": "M365_DRIVE",
                "dataType": "Unstructured",
                "infrastructure": "OneDrive",
                "engine": "mockpoint-library",
                "cloudProviderUrl": "https://mocktenant.mockpoint.com/sites/teamx/Shared%20Documents",
                "scanningState": "Unmonitored",
                "ghost": false,
                "regions": [
                  "Americas"
                ],
                "vpc": null,
                "owner": "teamx_owner@mocktenant.onexample.com",
                "userId": "12345678-9abc-def0-1234-56789abcdef0",
                "sensitivity": "Unclassified",
                "sensitivityDisplayName": "Unclassified",
                "recordCountBySensitivity": {
                  "VerySensitive": 0,
                  "Sensitive": 0,
                  "Internal": 0,
                  "NotSensitive": 0,
                  "Unclassified": 0
                },
                "account": {
                  "name": "MockAccount",
                  "inPlatformIdentifier": "abcd1234-5678-90ab-cdef-1234567890ab"
                },
                "classificationGroups": [],
                "issues": {
                  "open": 0,
                  "closed": 0,
                  "inProgress": 0
                },
                "cloudProviderTags": [],
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "classificationLevel": "Element",
                "learned": false,
                "userTags": [],
                "encrypted": true,
                "sslEnforced": "Unknown",
                "logging": "Enabled",
                "publicAccessibilityState": "Not Public",
                "createdDate": "2025-05-12T05:06:50.000Z",
                "lastModifiedTime": "2025-06-12T22:11:31.343Z",
                "driveId": "b!abcdEFGH1234ijkl5678mnop9qrstuvwxYZ",
                "datastoreSizeInGiB": 0,
                "projectIds": [],
                "rdsEndpoint": null,
                "datastoreOwners": [
                  {
                    "email": "teamx_owner@mocktenant.onexample.com",
                    "ownerType": "",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "abcd1234-ef56-7890-abcd-ef1234567890",
                    "datastoreUid": "0197abcd-1234-5678-90ab-dc221b36194d"
                  },
                  {
                    "email": "teamx_owner@mocktenant.onexample.com",
                    "ownerType": "",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "1234abcd-5678-90ef-abcd-0987654321ef",
                    "datastoreUid": "0197abcd-1234-5678-90ab-dc221b36194d"
                  }
                ],
                "autoScan": false,
                "siteName": "TeamX",
                "siteId": "mocktenant.mockpoint.com,abcd1234-5678-90ab-cdef-112233445566,99887766-5544-3322-1100-aabbccddeeff"
              }
            ]
          }
          `}}
  - path: /v2/datastores
    methods: ['GET']
    query_params:
      limit: 2
      lastModifiedTimeGte: "{lastModifiedTimeGte:20.*}"
      offset: 2
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 2,
            "total": 5,
            "results": [
              {
                "name": "examplecorp/SharedDocs",
                "discoveredDate": "2025-08-28T12:45:39.214Z",
                "provider": "example365",
                "uid": "0198d512-ffff-pppp-96db-7c29c3efbb21",
                "type": "M365_DRIVE",
                "dataType": "Unstructured",
                "infrastructure": "OneDrive",
                "engine": "mockpoint-library",
                "cloudProviderUrl": "https://examplecorp.mockpoint.com/sites/global/Shared%20Documents",
                "scanningState": "Scanned",
                "ghost": false,
                "regions": [
                  "Europe"
                ],
                "vpc": null,
                "owner": "sharedocs@examplecorp.onexample.com",
                "userId": "45ab67c2-9f18-4a01-b41a-02dc91d8b765",
                "sensitivity": "NotSensitive",
                "sensitivityDisplayName": "Public",
                "recordCountBySensitivity": {
                  "VerySensitive": 0,
                  "Sensitive": 0,
                  "Internal": 0,
                  "NotSensitive": 0,
                  "Unclassified": 0
                },
                "account": {
                  "name": "examplecorp",
                  "inPlatformIdentifier": "ab92c1de-1f44-48a7-9e13-8d0f229af017"
                },
                "classificationGroups": [],
                "issues": {
                  "open": 0,
                  "closed": 0,
                  "inProgress": 0
                },
                "cloudProviderTags": [],
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "classificationLevel": "Element",
                "learned": false,
                "userTags": [],
                "encrypted": true,
                "sslEnforced": "Unknown",
                "logging": "Enabled",
                "publicAccessibilityState": "Not Public",
                "createdDate": "2025-07-05T09:23:11.000Z",
                "lastModifiedTime": "2025-07-12T22:11:31.343Z",
                "lastDataRefresh": "2025-09-01T14:19:28.876Z",
                "driveId": "b!TqmZHvfLOP89dzuy6FiNAdDfLtxSeZdPoYBhL-Pr4g7JM7PVjTohFQ9x7azLpWxq",
                "datastoreSizeInGiB": 12,
                "projectIds": [],
                "rdsEndpoint": null,
                "datastoreOwners": [
                  {
                    "email": "compliance@examplecorp.onexample.com",
                    "ownerType": "Backup",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "0198d523-b2f6-493c-9a13-f8cd37bc9e44",
                    "datastoreUid": "0198d512-7aa3-4f1b-96db-7c29c3efbb21"
                  }
                ],
                "autoScan": true,
                "siteName": "Global Shared",
                "siteId": "examplecorp.mockpoint.com,26fa8499-35dd-44b7-bc1a-94b7e92e6d73,f9dcb114-34ad-41b0-99d4-07e22a8d0a61"
              },
              {
                "name": "TeamX/Documents",
                "discoveredDate": "2025-06-30T23:12:53.928Z",
                "provider": "example365",
                "uid": "0197xvdf-1234-eeee-90ab-dc221b36194d",
                "type": "M365_DRIVE",
                "dataType": "Unstructured",
                "infrastructure": "OneDrive",
                "engine": "mockpoint-library",
                "cloudProviderUrl": "https://mocktenant.mockpoint.com/sites/teamx/Shared%20Documents",
                "scanningState": "Unmonitored",
                "ghost": false,
                "regions": [
                  "Americas"
                ],
                "vpc": null,
                "owner": "teamx_owner@mocktenant.onexample.com",
                "userId": "12345678-9abc-def0-1234-56789abcdef0",
                "sensitivity": "Unclassified",
                "sensitivityDisplayName": "Unclassified",
                "recordCountBySensitivity": {
                  "VerySensitive": 0,
                  "Sensitive": 0,
                  "Internal": 0,
                  "NotSensitive": 0,
                  "Unclassified": 0
                },
                "account": {
                  "name": "MockAccount",
                  "inPlatformIdentifier": "abcd1234-5678-90ab-cdef-1234567890ab"
                },
                "classificationGroups": [],
                "issues": {
                  "open": 0,
                  "closed": 0,
                  "inProgress": 0
                },
                "cloudProviderTags": [],
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "classificationLevel": "Element",
                "learned": false,
                "userTags": [],
                "encrypted": true,
                "sslEnforced": "Unknown",
                "logging": "Enabled",
                "publicAccessibilityState": "Not Public",
                "createdDate": "2025-05-12T05:06:50.000Z",
                "lastModifiedTime": "2025-06-12T22:11:31.343Z",
                "driveId": "b!abcdEFGH1234ijkl5678mnop9qrstuvwxYZ",
                "datastoreSizeInGiB": 0,
                "projectIds": [],
                "rdsEndpoint": null,
                "datastoreOwners": [
                  {
                    "email": "teamx_owner@mocktenant.onexample.com",
                    "ownerType": "",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "abcd1234-ef56-7890-abcd-ef1234567890",
                    "datastoreUid": "0197abcd-1234-5678-90ab-dc221b36194d"
                  },
                  {
                    "email": "teamx_owner@mocktenant.onexample.com",
                    "ownerType": "",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "1234abcd-5678-90ef-abcd-0987654321ef",
                    "datastoreUid": "0197abcd-1234-5678-90ab-dc221b36194d"
                  }
                ],
                "autoScan": false,
                "siteName": "TeamX",
                "siteId": "mocktenant.mockpoint.com,abcd1234-5678-90ab-cdef-112233445566,99887766-5544-3322-1100-aabbccddeeff"
              }
            ]
          }
          `}}
  - path: /v2/datastores
    methods: ['GET']
    query_params:
      limit: 2
      lastModifiedTimeGte: "{lastModifiedTimeGte:20.*}"
      offset: 4
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 4,
            "total": 5,
            "results": [
              {
                "name": "TeamX/Documents",
                "discoveredDate": "2025-06-30T23:12:53.928Z",
                "provider": "example365",
                "uid": "0197abcd-polo-eeee-90ab-dc221b36194d",
                "type": "M365_DRIVE",
                "dataType": "Unstructured",
                "infrastructure": "OneDrive",
                "engine": "mockpoint-library",
                "cloudProviderUrl": "https://mocktenant.mockpoint.com/sites/teamx/Shared%20Documents",
                "scanningState": "Unmonitored",
                "ghost": false,
                "regions": [
                  "Americas"
                ],
                "vpc": null,
                "owner": "teamx_owner@mocktenant.onexample.com",
                "userId": "12345678-9abc-def0-1234-56789abcdef0",
                "sensitivity": "Unclassified",
                "sensitivityDisplayName": "Unclassified",
                "recordCountBySensitivity": {
                  "VerySensitive": 0,
                  "Sensitive": 0,
                  "Internal": 0,
                  "NotSensitive": 0,
                  "Unclassified": 0
                },
                "account": {
                  "name": "MockAccount",
                  "inPlatformIdentifier": "abcd1234-5678-90ab-cdef-1234567890ab"
                },
                "classificationGroups": [],
                "issues": {
                  "open": 0,
                  "closed": 0,
                  "inProgress": 0
                },
                "cloudProviderTags": [],
                "collections": [],
                "customCollections": [],
                "frameworks": [],
                "classificationLevel": "Element",
                "learned": false,
                "userTags": [],
                "encrypted": true,
                "sslEnforced": "Unknown",
                "logging": "Enabled",
                "publicAccessibilityState": "Not Public",
                "createdDate": "2025-05-12T05:06:50.000Z",
                "lastModifiedTime": "2025-06-12T22:11:31.343Z",
                "driveId": "b!abcdEFGH1234ijkl5678mnop9qrstuvwxYZ",
                "datastoreSizeInGiB": 0,
                "projectIds": [],
                "rdsEndpoint": null,
                "datastoreOwners": [
                  {
                    "email": "teamx_owner@mocktenant.onexample.com",
                    "ownerType": "",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "abcd1234-ef56-7890-abcd-ef1234567890",
                    "datastoreUid": "0197abcd-1234-5678-90ab-dc221b36194d"
                  },
                  {
                    "email": "teamx_owner@mocktenant.onexample.com",
                    "ownerType": "",
                    "source": "SaaSOwner",
                    "datastoreOwnerUid": "1234abcd-5678-90ef-abcd-0987654321ef",
                    "datastoreUid": "0197abcd-1234-5678-90ab-dc221b36194d"
                  }
                ],
                "autoScan": false,
                "siteName": "TeamX",
                "siteId": "mocktenant.mockpoint.com,abcd1234-5678-90ab-cdef-112233445566,99887766-5544-3322-1100-aabbccddeeff"
              }
            ]
          }
          `}}