rules:
  - path: /v1/login
    methods: ['POST']
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |
          {{ minify_json `
          {
            "jwt": "xxxx",
            "refreshToken": "yyyy",
            "expiresIn": 86400,
            "expires": "Fri, 22 Aug 2025 09:23:07 GMT"
          }
          `}}
  - path: /v3/issues
    methods: ['GET']
    query_params:
      limit: 2
      offset: 0
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 0,
            "total": 5,
            "results": [
              {
                "uid": "mock-uid-12345",
                "cloudProviderTags": [
                  {
                    "key": "providerTag",
                    "value": "mock-tag"
                  }
                ],
                "resolution": "Accept risk",
                "resolutionNote": "the issue was closed in version X.Y.Z",
                "name": "Credit card number in plain text",
                "severity": "Critical",
                "createdDate": "2025-07-02T09:32:02.787Z",
                "updatedDate": "2025-07-25T04:09:41.965Z",
                "status": "Open",
                "riskStatus": "Unmitigated",
                "datastoreName": "Mock User/OneDrive",
                "datastoreUid": "mock-datastore-uid-001",
                "provider": "Microsoft365",
                "infrastructure": "OneDrive",
                "engine": "one-drive",
                "regions": [
                  "Americas"
                ],
                "risk": {
                  "policyUid": "mock-policy-uid-001",
                  "useCases": [
                    "DataSprawl",
                    "DataEncryption"
                  ],
                  "frameworks": [
                    "PCI DSS",
                    "PHIPA",
                    "PIPEDA",
                    "Cyera Security Basics"
                  ],
                  "description": "According to PCI DSS section 3.4 if PAN storage is unavoidable, the data must be rendered unreadable wherever it is stored. Acceptable methods include hashing, truncation, tokenization, or strong encryption."
                },
                "data": {
                  "recordsAtRisk": 999,
                  "affectedRecords": 999,
                  "objectsAtRisk": 5,
                  "dataClassesUids": [
                    "mock-dataclass-uid-001",
                    "mock-dataclass-uid-002",
                    "mock-dataclass-uid-003"
                  ]
                },
                "account": {
                  "name": "MockAccount",
                  "inPlatformIdentifier": "mock-platform-id-001"
                },
                "classificationGroups": [
                  "Personal",
                  "Financial",
                  "Health",
                  "Business & IP",
                  "IT & Security"
                ],
                "datastoreCloudProviderTags": [
                  {
                    "key": "key1",
                    "value": "mock-value"
                  }
                ],
                "datastoreUserTags": [
                  {
                    "uid": "mock-user-uid",
                    "key": "env",
                    "value": "mock-env"
                  }
                ],
                "owner": "mockuser@example.com",
                "datastoreOwners": [
                  {
                    "datastoreOwnerUid": "mock-datastore-owner-001",
                    "email": "mockowner@example.com",
                    "ownerType": "application-owner",
                    "sources": [
                      "SaaSOwner"
                    ]
                  },
                  {
                    "datastoreOwnerUid": "mock-datastore-owner-001",
                    "email": "mockowner@example.com",
                    "ownerType": null,
                    "sources": [
                      "SaaSOwner"
                    ]
                  }
                ],
                "remediationAdvice": "- Evaluate the need for storing credit card data. If unnecessary, delete it.\n- Encrypt sensitive data.\n- Use masking or tokenization where applicable.",
                "policyUid": "mock-policy-uid-001",
                "itsmTickets": [
                  {
                    "uid": "mock-ticket-001",
                    "vendorTicketId": "JIRA-MOCK-123",
                    "vendorLink": "https://mockcompany.atlassian.net/browse/JIRA-MOCK-123",
                    "vendorStatus": "In Progress"
                  }
                ]
              },
              {
                "uid": "0198abcd-1234-5678-9abc-def012345678",
                "name": "Credit card number in plain text",
                "severity": "Critical",
                "createdDate": "2025-07-10T08:20:45.123Z",
                "updatedDate": "2025-07-22T11:45:30.987Z",
                "status": "Open",
                "riskStatus": "Unmitigated",
                "datastoreName": "mock-database-prod-xyz",
                "datastoreUid": "0198dbcd-4321-8765-9def-abcdef987654",
                "provider": "AWS",
                "infrastructure": "rds-mysql",
                "engine": "mysql",
                "regions": [
                  "us-east-1"
                ],
                "risk": {
                  "policyUid": "0198c2ec-55ef-77ab-cc12-778899aabbcc",
                  "useCases": [
                    "DataSprawl",
                    "DataRetention"
                  ],
                  "frameworks": [
                    "PCI DSS",
                    "SOC 2",
                    "ISO 27001"
                  ],
                  "description": "According to PCI DSS section 3.4 if PAN storage is unavoidable, the data must be rendered unreadable wherever it is stored. The PCI-DSS explicitly enumerates the acceptable methods for rendering this data unreadable. These methods include - strong one-way hash functions of the entire PAN, truncation, index token with securely stored pads, strong cryptography."
                },
                "data": {
                  "recordsAtRisk": 2500,
                  "affectedRecords": 2500,
                  "objectsAtRisk": 3,
                  "dataClassesUids": [
                    "0198c3ba-1234-5678-9abc-def098765432"
                  ]
                },
                "account": {
                  "name": "AWS Account - Finance",
                  "inPlatformIdentifier": "a1b2c3d4-5678-90ab-cdef-1234567890ab"
                },
                "classificationGroups": [
                  "Financial",
                  "IT & Security"
                ],
                "datastoreCloudProviderTags": [
                  {
                    "key": "BusinessUnit",
                    "value": "Finance"
                  },
                  {
                    "key": "CostCenter",
                    "value": "99887"
                  },
                  {
                    "key": "Department",
                    "value": "CloudOps"
                  },
                  {
                    "key": "Environment",
                    "value": "Prod"
                  },
                  {
                    "key": "Project",
                    "value": "Everest"
                  }
                ],
                "datastoreUserTags": [
                  {
                    "key": "owner",
                    "value": "TeamX"
                  }
                ],
                "owner": "owner@mockmail.com",
                "datastoreOwners": [
                  {
                    "datastoreOwnerUid": "0198efgh-6789-1234-abcd-ef9876543210",
                    "email": "datastore.owner@mockmail.com",
                    "ownerType": "application-owner",
                    "sources": [
                      "IAM"
                    ]
                  }
                ],
                "remediationAdvice": "- Evaluate the need for storing credit card data in the current location. If it is not necessary, promptly delete the information to reduce the risk of unauthorized access.\n- Encrypt the data using strong encryption algorithms.\n- Choose either masking or tokenization as a method for securely displaying or storing credit card numbers.",
                "policyUid": "0198c2ec-55ef-77ab-cc12-778899aabbcc",
                "itsmTickets": [
                  {
                    "uid": "abc12345-6789-def0-1234-56789abcdef0",
                    "vendorTicketId": "SNOW-98765",
                    "vendorLink": "https://company.service-now.com/nav_to.do?uri=incident.do?sys_id=12345",
                    "vendorStatus": "Open"
                  }
                ]
              }
            ]
          }
          `}}
  - path: /v3/issues
    methods: ['GET']
    query_params:
      limit: 2
      offset: 2
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 2,
            "total": 5,
            "results": [
              {
                "uid": "0197e038-8222-78cb-94ff-3a4f92c67ad1",
                "name": "Passport Numbers stored in plain text",
                "severity": "Medium",
                "createdDate": "2025-06-18T10:24:47.392Z",
                "updatedDate": "2025-07-25T09:12:19.654Z",
                "status": "Open",
                "riskStatus": "Unmitigated",
                "datastoreName": "travel-insurance-db-euwest",
                "datastoreUid": "0197c315-99f4-7a2e-b16c-872314c2f0ce",
                "provider": "AWS",
                "infrastructure": "aws-rds-instance",
                "engine": "mysql",
                "regions": [
                  "eu-west-1"
                ],
                "risk": {
                  "policyUid": "0197c2ec-22ff-71b3-b120-11fc908ab543",
                  "useCases": [
                    "DataSprawl",
                    "DataRetention"
                  ],
                  "frameworks": [
                    "GDPR",
                    "ISO 27001",
                    "SOC 2",
                    "Security Basics"
                  ],
                  "description": "Passport numbers are classified as sensitive identifiers under privacy frameworks like GDPR and ISO 27001. Storing them in plain text without encryption or access restrictions introduces privacy risks, potential identity theft exposure, and regulatory non-compliance. Organizations are required to implement data protection controls including encryption, masking, or tokenization."
                },
                "data": {
                  "recordsAtRisk": 520,
                  "affectedRecords": 520,
                  "objectsAtRisk": 3,
                  "dataClassesUids": [
                    "0197c3ba-09aa-76ac-8d89-12bc6731a4b1"
                  ]
                },
                "account": {
                  "name": "AWS Account - Travel Services",
                  "inPlatformIdentifier": "a612edc9-89db-47f9-b85f-13ba73a92c42"
                },
                "classificationGroups": [
                  "Personal",
                  "Business & IP"
                ],
                "datastoreCloudProviderTags": [
                  {
                    "key": "BusinessUnit",
                    "value": "Travel"
                  },
                  {
                    "key": "CostCenter",
                    "value": "44219"
                  },
                  {
                    "key": "Department",
                    "value": "Engineering"
                  },
                  {
                    "key": "Environment",
                    "value": "QA"
                  },
                  {
                    "key": "Project",
                    "value": "Voyager"
                  }
                ],
                "datastoreUserTags": [],
                "owner": null,
                "datastoreOwners": [
                  {
                    "datastoreOwnerUid": "0197c31f-09bb-72de-8110-7bf4ecd8e61f",
                    "email": "jdoe@travelcorp.com",
                    "ownerType": null,
                    "sources": [
                      "CloudTrail"
                    ]
                  }
                ],
                "remediationAdvice": "- **Evaluate necessity**: Remove passport number storage unless strictly required.\n- **Encrypt**: Use AES-256 or stronger encryption at rest and TLS 1.2+ for data in transit.\n- **Mask/Tokenize**: Consider tokenization or masking when displaying data.\n- **Access Control**: Restrict access using least privilege.\n- **Retention Policy**: Define and enforce data retention timelines for passport data.",
                "policyUid": "0197c2ec-22ff-71b3-b120-11fc908ab543",
                "itsmTickets": []
              },
              {
                "uid": "0198e038-8222-78cb-94ff-3a4f92uu7ad1",
                "name": "Passport Numbers stored in plain text",
                "severity": "Medium",
                "createdDate": "2025-06-18T10:24:47.392Z",
                "updatedDate": "2025-07-25T09:12:19.654Z",
                "status": "Open",
                "riskStatus": "Unmitigated",
                "datastoreName": "travel-insurance-db-euwest",
                "datastoreUid": "0197c315-99f4-7a2e-b16c-872314c2f0ce",
                "provider": "AWS",
                "infrastructure": "aws-rds-instance",
                "engine": "mysql",
                "regions": [
                  "eu-west-1"
                ],
                "risk": {
                  "policyUid": "0197c2ec-22ff-71b3-b120-11fc908ab543",
                  "useCases": [
                    "DataSprawl",
                    "DataRetention"
                  ],
                  "frameworks": [
                    "GDPR",
                    "ISO 27001",
                    "SOC 2",
                    "Security Basics"
                  ],
                  "description": "Passport numbers are classified as sensitive identifiers under privacy frameworks like GDPR and ISO 27001. Storing them in plain text without encryption or access restrictions introduces privacy risks, potential identity theft exposure, and regulatory non-compliance. Organizations are required to implement data protection controls including encryption, masking, or tokenization."
                },
                "data": {
                  "recordsAtRisk": 520,
                  "affectedRecords": 520,
                  "objectsAtRisk": 3,
                  "dataClassesUids": [
                    "0197c3ba-09aa-76ac-8d89-12bc6731a4b1"
                  ]
                },
                "account": {
                  "name": "AWS Account - Travel Services",
                  "inPlatformIdentifier": "a612edc9-89db-47f9-b85f-13ba73a92c42"
                },
                "classificationGroups": [
                  "Personal",
                  "Business & IP"
                ],
                "datastoreCloudProviderTags": [
                  {
                    "key": "BusinessUnit",
                    "value": "Travel"
                  },
                  {
                    "key": "CostCenter",
                    "value": "44219"
                  },
                  {
                    "key": "Department",
                    "value": "Engineering"
                  },
                  {
                    "key": "Environment",
                    "value": "QA"
                  },
                  {
                    "key": "Project",
                    "value": "Voyager"
                  }
                ],
                "datastoreUserTags": [],
                "owner": null,
                "datastoreOwners": [
                  {
                    "datastoreOwnerUid": "0197c31f-09bb-72de-8110-7bf4ecd8e61f",
                    "email": "jdoe@travelcorp.com",
                    "ownerType": null,
                    "sources": [
                      "CloudTrail"
                    ]
                  }
                ],
                "remediationAdvice": "- **Evaluate necessity**: Remove passport number storage unless strictly required.\n- **Encrypt**: Use AES-256 or stronger encryption at rest and TLS 1.2+ for data in transit.\n- **Mask/Tokenize**: Consider tokenization or masking when displaying data.\n- **Access Control**: Restrict access using least privilege.\n- **Retention Policy**: Define and enforce data retention timelines for passport data.",
                "policyUid": "0197c2ec-22ff-71b3-b120-11fc908ab543",
                "itsmTickets": []
              }
            ]
          }
          `}}
  - path: /v3/issues
    methods: ['GET']
    query_params:
      limit: 2
      offset: 4
    request_headers:
      Authorization:
        - 'Bearer xxxx'
    responses:
      - status_code: 200
        body: |
          {{ minify_json `
          {
            "limit": 2,
            "offset": 4,
            "total": 5,
            "results": [
              {
                "uid": "0198a123-9c77-73de-bb21-fd9e4b88aa67",
                "name": "Driver’s License Number in plain text",
                "severity": "High",
                "createdDate": "2025-08-01T09:12:43.521Z",
                "updatedDate": "2025-08-15T12:48:22.114Z",
                "status": "Open",
                "riskStatus": "Unmitigated",
                "datastoreName": "apollo-insurance-mysql-db-eastus/sql-instance",
                "datastoreUid": "0198a245-67dd-71aa-9b92-7b33c4af7c9f",
                "provider": "AWS",
                "infrastructure": "rds-mysql",
                "engine": "mysql",
                "regions": [
                  "us-east-1"
                ],
                "risk": {
                  "policyUid": "0198a2ec-17bd-7f1e-baf4-198a76455df1",
                  "useCases": [
                    "DataSprawl",
                    "DataProtection"
                  ],
                  "frameworks": [
                    "CCPA",
                    "GDPR",
                    "Cyera Security Basics"
                  ],
                  "description": "Driver’s License Numbers are classified as sensitive identifiers under privacy regulations such as **CCPA** and **GDPR**. Storing them in plain text increases exposure to identity theft risks. Proper safeguards like encryption, tokenization, and strict access controls are required to ensure compliance."
                },
                "data": {
                  "recordsAtRisk": 745,
                  "affectedRecords": 745,
                  "objectsAtRisk": 3,
                  "dataClassesUids": [
                    "0198a39a-03de-71be-8d28-27a5709a34c8",
                    "0198a3be-81de-75d3-8fc1-36f72dab858a"
                  ]
                },
                "account": {
                  "name": "AWS Prod Account",
                  "inPlatformIdentifier": "d826ccc5-dfaa-48b5-92ef-11dc45a2db99"
                },
                "classificationGroups": [
                  "Personal",
                  "Identity",
                  "Business & IP"
                ],
                "datastoreCloudProviderTags": [
                  {
                    "key": "BusinessUnit",
                    "value": "Insurance"
                  },
                  {
                    "key": "CostCenter",
                    "value": "44219"
                  },
                  {
                    "key": "Department",
                    "value": "Risk"
                  },
                  {
                    "key": "Environment",
                    "value": "Prod"
                  },
                  {
                    "key": "Project",
                    "value": "ApolloSecure"
                  }
                ],
                "datastoreUserTags": [],
                "owner": null,
                "datastoreOwners": [
                  {
                    "datastoreOwnerUid": "0198a31f-01fd-72da-9d1c-49ae5dd8e3d0",
                    "email": "jsmith@apollo-secure.com",
                    "ownerType": null,
                    "sources": [
                      "IAMLogs"
                    ]
                  }
                ],
                "remediationAdvice": "- **Assess necessity**: Verify if storing Driver’s License numbers in this datastore is mandatory. If not, securely delete the records.\n- **Apply encryption**: Protect the data at rest and in transit using AES-256 or equivalent.\n- **Restrict access**: Implement role-based access control to ensure only authorized personnel can access the sensitive data.\n- **Audit and monitor**: Enable detailed logging for all queries accessing this data and regularly review for anomalies.",
                "policyUid": "0198a2ec-17bd-7f1e-baf4-198a76455df1",
                "itsmTickets": []
              }
            ]
          }
          `}}
