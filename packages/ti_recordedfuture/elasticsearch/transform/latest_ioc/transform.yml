# Use of "*" to use any namespace defined.
source:
  index:
    - "logs-ti_recordedfuture.threat-*"
# The version suffix on destination index must be explicitly set.
# NOTE: During version change, ensure through some mechanism old destination index automatically purges so queries on wild card such as logs-*_latest-* doesn't result in duplicates
dest:
  index: "logs-ti_recordedfuture_latest.threat-1.0.0"
latest:
  unique_key:
    - event.dataset
    - threat.indicator.type
    - recordedfuture.name
  sort: "@timestamp"
description: Latest Recorded Future IoC data
frequency: 30s
sync:
  time:
    field: event.ingested
    delay: 60s
retention_policy:
  time:
    field: event.ingested
    # After internal discussion, 24 hours is a valid default retention period for Recorded Future.
    max_age: 24h
_meta:
  managed: true
  # Bump this version to delete, reinstall, and restart the transform during package.
  fleet_transform_version: 0.1.0
