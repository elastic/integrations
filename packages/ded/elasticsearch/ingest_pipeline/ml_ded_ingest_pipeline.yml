---
description: Pipeline for the Data Exfiltration Detection Integration transform.
processors:
  - script:
      description: Casts the value of the field `avg_source_bytes` to a long and assigns it to `source.bytes`.
      lang: painless
      source: |
        if (ctx.avg_source_bytes != null) {
            ctx['source']['bytes'] = (long)(ctx.avg_source_bytes);
        }
on_failure:
  - set:
      field: event.kind
      value: pipeline_error
  - append:
      field: error.message
      value: '{{{ _ingest.on_failure_message }}}'