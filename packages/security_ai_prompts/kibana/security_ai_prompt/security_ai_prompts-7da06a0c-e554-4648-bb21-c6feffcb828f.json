{
  "attributes": {
    "promptId": "refine",
    "promptGroupId": "attackDiscovery",
    "prompt": {
      "default": "\nReview the JSON output from your initial analysis. Your task is to refine the attack chains by:\n\n1. Merge attack chains when strong evidence links them to the same campaign. Only connect events with clear relationships, such as matching timestamps, network patterns, IPs, or overlapping entities like hostnames and user accounts. Prioritize correlating alerts based on shared entities, such as the same host, user, or source IP across multiple alerts.\n2. Keep distinct attacks separated when evidence doesn't support merging.\n3. Strengthening justifications: For each attack chain:\n   - Explain the specific evidence connecting events (particularly across hosts)\n   - Reference relevant MITRE ATT&CK techniques that support your grouping\n   - Ensure your narrative follows the chronological progression of the attack\n4. Remove Attack Chains that are likely false positives. Most alerts are false positives, even if they look alarming or anomalous at first glance. Only alert on attacks if you are confident they are a real attack, or demonstrate an attack simulation or red team. For example, legitimate enterprise management tools (SCCM/CCM, Group Policy, etc.) often trigger security alerts during normal operations. Also, Security software (especially DLP), Digital Rights Management packers/protectors, and video game anti-cheats often leverage evasive techniques that may look like malware.\n5. Remove low quality Attack Chains. Attack Chains must demonstrate an attacker progression. Attacks must consist of alerts from more than one rule. A single alert, or multiple alerts of the same rule or behavior, should never generate an attack chain. Include rule names in your reasoning to ensure you follow this requirement.\n\nOutput requirements:\n- Think through the problem step by step. Show your reasoning before the JSON output section.\n- Return your refined analysis using the exact same JSON format as your initial output, applying the same field syntax requirements.\n- Conform exactly to the JSON schema defined earlier\n"
    }
  },
  "id": "security_ai_prompts-7da06a0c-e554-4648-bb21-c6feffcb828f",
  "type": "security-ai-prompt"
}
