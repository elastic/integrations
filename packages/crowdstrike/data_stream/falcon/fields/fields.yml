- name: crowdstrike.metadata
  title: Metadata fields
  type: group
  fields:
    - name: eventType
      type: keyword
      description: |
        DetectionSummaryEvent, FirewallMatchEvent, IncidentSummaryEvent, RemoteResponseSessionStartEvent, RemoteResponseSessionEndEvent, AuthActivityAuditEvent, or UserActivityAuditEvent
    - name: offset
      type: integer
      description: |
        Offset number that tracks the location of the event in stream. This is used to identify unique detection events.
    - name: customerIDString
      type: keyword
      description: |
        Customer identifier
    - name: version
      type: keyword
      description: |
        Schema version
- name: crowdstrike.event
  title: Event fields
  type: group
  fields:
    - name: IncidentType
      type: keyword
      description: |
        Incident Type
    - name: ComputerName
      type: keyword
      description: |
        Name of the computer where the detection occurred.
    - name: DetectName
      type: keyword
      description: |
        Name of the detection.
    - name: SeverityName
      type: keyword
      description: |
        Severity score text.
    - name: SHA1String
      type: keyword
      description: |
        SHA1 sum of the executable associated with the detection.
    - name: SHA256String
      type: keyword
      description: |
        SHA256 sum of the executable associated with the detection.
    - name: MD5String
      type: keyword
      description: |
        MD5 sum of the executable associated with the detection.
    - name: MachineDomain
      type: keyword
      description: |
        Domain for the machine associated with the detection.
    - name: HostGroups
      type: keyword
      description: |
        Array of related Host Group IDs.
    - name: SensorId
      type: keyword
      description: |
        Unique ID associated with the Falcon sensor.
    - name: DetectId
      type: keyword
      description: |
        Unique ID associated with the detection.
    - name: LocalIP
      type: keyword
      description: |
        IP address of the host associated with the detection.
    - name: MACAddress
      type: keyword
      description: |
        MAC address of the host associated with the detection.
    - name: Objective
      type: keyword
      description: |
        Method of detection.
    - name: PatternDispositionValue
      type: integer
      description: |
        Unique ID associated with action taken.
    - name: PatternDispositionFlags
      type: group
      description: |
        Flags indicating actions taken.
      fields:
        - name: Detect
          type: boolean
        - name: InddetMask
          type: boolean
        - name: Indicator
          type: boolean
        - name: KillParent
          type: boolean
        - name: KillProcess
          type: boolean
        - name: KillSubProcess
          type: boolean
        - name: OperationBlocked
          type: boolean
        - name: PolicyDisabled
          type: boolean
        - name: ProcessBlocked
          type: boolean
        - name: QuarantineFile
          type: boolean
        - name: QuarantineMachine
          type: boolean
        - name: Rooting
          type: boolean
        - name: SensorOnly
          type: boolean
        - name: BootupSafeguardEnabled
          type: boolean
        - name: CriticalProcessDisabled
          type: boolean
        - name: FsOperationBlocked
          type: boolean
        - name: RegistryOperationBlocked
          type: boolean
        - name: BlockingUnsupportedOrDisabled
          type: boolean
        - name: HandleOperationDowngraded
          type: boolean
        - name: KillActionFailed
          type: boolean
        - name: SuspendParent
          type: boolean
        - name: SuspendProcess
          type: boolean
    - name: State
      type: keyword
      description: |
        Whether the incident summary is open and ongoing or closed.
    - name: AssociatedFile
      type: keyword
      description: |
        The file associated with the triggering indicator.
    - name: PatternId
      type: keyword
      description: |
        The numerical ID of the pattern associated with the action taken on the detection.
    - name: FineScore
      type: float
      description: |
        The highest incident score reached as of the time the event was sent.
    - name: UserId
      type: keyword
      description: |
        Email address or user ID associated with the event.
    - name: OperationName
      type: keyword
      description: |
        Event subtype.
    - name: OARuleInstanceID
      type: keyword
      description: |
        Numerical ID of the custom IOA rule under a given CID.
    - name: IOARuleInstanceVersion
      type: long
      description: |
        Version number of the InstanceID that triggered.
    - name: IOARuleName
      type: keyword
      description: |
        Name given to the custom IOA rule that triggered.
    - name: Success
      type: boolean
      description: |
        Indicator of whether or not this event was successful.
    - name: AuditKeyValues
      type: nested
      description: |
        Fields that were changed in this event.
    - name: LMHostIDs
      type: nested
      description: |
        Array of host IDs seen to have experienced lateral movement because of the incident.
    - name: NetworkAccesses
      type: nested
      description: |
        Detected Network traffic done by a process.
    - name: ScanResults
      type: nested
      description: |
        Array of scan results.
    - name: DnsRequests
      type: nested
      description: |
        Detected DNS requests done by a process.
    - name: DocumentsAccessed
      type: nested
      description: |
        Detected documents accessed by a process.
    - name: ExecutablesWritten
      type: nested
      description: |
        Detected executables written to disk by a process.
    - name: Attributes
      type: flattened
      description: |
        JSON objects containing additional information about the event.
    - name: SessionId
      type: keyword
      description: |
        Session ID of the remote response session.
    - name: LateralMovement
      type: long
      description: |
        Lateral movement field for incident.
    - name: GrandparentImageFileName
      type: keyword
      description: |
        Path to the grandparent process.
    - name: GrandparentCommandLine
      type: keyword
      description: |
        Grandparent process command line arguments.
    - name: IOCType
      type: keyword
      description: |
        CrowdStrike type for indicator of compromise.
    - name: IOCValue
      type: keyword
      description: |
        CrowdStrike value for indicator of compromise.
    - name: ServiceName
      type: keyword
      description: |
        Description of which related service was involved in the event.
    - name: ParentImageFileName
      type: keyword
      description: |
        The parent image file name involved.
    - name: CustomerId
      type: keyword
      description: |
        Customer identifier.
    - name: DeviceId
      type: keyword
      description: |
        Device on which the event occurred.
    - name: Ipv
      type: keyword
      description: |
        Protocol for network request.
    - name: EventType
      type: keyword
      description: |
        CrowdStrike provided event type.
    - name: ICMPCode
      type: keyword
      description: |
        RFC2780 ICMP Code field.
    - name: ICMPType
      type: keyword
      description: |
        RFC2780 ICMP Type field.
    - name: RuleAction
      type: keyword
      description: |
        Firewall rule action.
    - name: MatchCount
      type: long
      description: |
        Number of firewall rule matches.
    - name: MatchCountSinceLastReport
      type: long
      description: |
        Number of firewall rule matches since the last report.
    - name: Timestamp
      type: date
      description: |
        Firewall rule triggered timestamp.
    - name: Flags.Audit
      type: boolean
      description: |
        CrowdStrike audit flag.
    - name: Flags.Log
      type: boolean
      description: |
        CrowdStrike log flag.
    - name: Flags.Monitor
      type: boolean
      description: |
        CrowdStrike monitor flag.
    - name: Protocol
      type: keyword
      description: |
        CrowdStrike provided protocol.
    - name: NetworkProfile
      type: keyword
      description: |
        CrowdStrike network profile.
    - name: PolicyName
      type: keyword
      description: |
        CrowdStrike policy name.
    - name: PolicyID
      type: keyword
      description: |
        CrowdStrike policy id.
    - name: Status
      type: keyword
      description: |
        CrowdStrike status.
    - name: TreeID
      type: keyword
      description: |
        CrowdStrike tree id.
    - name: Commands
      type: keyword
      description: |
        Commands run in a remote session.
