{{- $_timestamp := generate "timestamp" }}
{{- $agent_id := generate "agent_id" }}
{{- $aggregate_id := generate "aggregate_id" }}
{{- $alleged_filetype := generate "alleged_filetype" }}
{{- $access_type := generate "network_accesses.access_type" }}
{{- $connection_direction := generate "network_accesses.connection_direction" }}
{{- $isIPV6 := generate "network_accesses.isIPV6" }}
{{- $local_address := generate "network_accesses.local_address" }}
{{- $local_port := generate "network_accesses.local_port" }}
{{- $protocol := generate "network_accesses.protocol" }}
{{- $remote_address := generate "network_accesses.remote_address" }}
{{- $remote_port := generate "network_accesses.remote_port" }}
{{- $cid := generate "cid" }}
{{- $cmdline := generate "cmdline" }}
{{- $comment := generate "comment" }}
{{- $falcon_user_id := generate "comments.falcon_user_id" }}
{{- $timestamp := generate "comments.timestamp" | date "2006-01-02T15:04:05.000000000Z" }}
{{- $value := generate "comments.value" }}
{{- $composite_id := generate "composite_id" }}
{{- $confidence := generate "confidence" }}
{{- $control_graph_id := generate "control_graph_id" }}
{{- $created_timestamp := generate "created_timestamp" | date "2006-01-02T15:04:05.000000000Z" }}
{{- $description := generate "description" }}
{{- $last_seen := generate "device.last_seen" | date "2006-01-02T15:04:05.00Z" }}
{{- $agent_load_flags := generate "device.agent_load_flags" }}
{{- $agent_local_time := generate "device.agent_local_time" | date "2006-01-02T15:04:05.000Z" }}
{{- $agent_version := generate "device.agent_version" }}
{{- $bios_manufacturer := generate "device.bios_manufacturer" }}
{{- $bios_version := generate "device.bios_version" }}
{{- $cid := generate "device.cid" }}
{{- $device_id := generate "device.device_id" }}
{{- $external_ip := generate "device.external_ip" }}
{{- $external_ipv6 := generate "device.external_ipv6" }}
{{- $first_seen := generate "device.first_seen" | date "2006-01-02T15:04:05.000Z" }}
{{- $groups := generate "device.groups" }}
{{- $active_directory_dn_display := generate "device.hostinfo.active_directory_dn_display" }}
{{- $domain := generate "device.hostinfo.domain" }}
{{- $host_hidden_status := generate "device.host_hidden_status" }}
{{- $instance_id := generate "device.instance_id" }}
{{- $local_ip := generate "device.local_ip" }}
{{- $local_ipv6 := generate "device.local_ipv6" }}
{{- $mac_address := generate "device.mac_address" }}
{{- $machine_domain := generate "device.machine_domain" }}
{{- $major_version := generate "device.major_version" }}
{{- $minor_version := generate "device.minor_version" }}
{{- $modified_timestamp := generate "device.modified_timestamp" | date "2006-01-02T15:04:05.00Z" }}
{{- $os_version := generate "device.os_version" }}
{{- $ou := generate "device.ou" }}
{{- $platform_id := generate "device.platform_id" }}
{{- $platform_name := generate "device.platform_name" }}
{{- $pod_id := generate "device.pod_id" }}
{{- $pod_labels := generate "device.pod_labels" }}
{{- $pod_name := generate "device.pod_name" }}
{{- $pod_namespace := generate "device.pod_namespace" }}
{{- $pod_service_account_name := generate "device.pod_service_account_name" }}
{{- $product_type := generate "device.product_type" }}
{{- $product_type_desc := generate "device.product_type_desc" }}
{{- $service_provider := generate "device.service_provider" }}
{{- $service_provider_account_id := generate "device.service_provider_account_id" }}
{{- $site_name := generate "device.site_name" }}
{{- $system_manufacturer := generate "device.system_manufacturer" }}
{{- $system_product_name := generate "device.system_product_name" }}
{{- $tags := generate "device.tags" }}
{{- $display_name := generate "display_name" }}
{{- $falcon_host_link := generate "falcon_host_link" }}
{{- $filename := generate "filename" }}
{{- $filepath := generate "filepath" }}
{{- $hostname := generate "hostname" }}
{{- $id := generate "id" }}
{{- $ioc_source := generate "ioc_source" }}
{{- $ioc_type := generate "ioc_type" }}
{{- $ioc_value := generate "ioc_value" }}
{{- $md5 := generate "md5" }}
{{- $objective := generate "objective" }}
{{- $parent_process_id := generate "parent_process_id" }}
{{- $pattern_id := generate "pattern_id" }}
{{- $process_end_time := generate "process_end_time" }}
{{- $process_id := generate "process_id" }}
{{- $process_start_time := generate "process_start_time" }}
{{- $product := generate "product" }}
{{- $scenario := generate "scenario" }}
{{- $severity := generate "severity" }}
{{- $severity_name := generate "severity_name" }}
{{- $sha256 := generate "sha256" }}
{{- $show_in_ui := generate "show_in_ui" }}
{{- $status := generate "status" }}
{{- $tactic := generate "tactic" }}
{{- $tactic_id := generate "tactic_id" }}
{{- $technique := generate "technique" }}
{{- $technique_id := generate "technique_id" }}
{{- $timestamp := generate "timestamp" | date "2006-01-02T15:04:05.000Z" }}
{{- $tree_id := generate "tree_id" }}
{{- $tree_root := generate "tree_root" }}
{{- $triggering_process_graph_id := generate "triggering_process_graph_id" }}
{{- $type := generate "type" }}
{{- $updated_timestamp := generate "updated_timestamp" | date "2006-01-02T15:04:05.000000000Z" }}
{{- $username := generate "username" }}
{{- $user_id := generate "user_id" }}
{{- /*
{
  "agent_id": "{{ $agent_id }}",
  "aggregate_id": "{{ $aggregate_id }}",
  "alleged_filetype": "{{ $alleged_filetype }}",
  "cid": "{{ $cid }}",
  "cmdline": "{{ $cmdline }}",
  "comment": "{{ $comment }}",
  "comments": [
    {
      "falcon_user_id": "{{ $falcon_user_id }}@mail.com",
      "timestamp": "{{ $timestamp }}",
      "value": "{{ $value }}"
    }
  ],
  "composite_id": "{{ $composite_id }}",
  "confidence": {{ $confidence }},
  "control_graph_id": "{{ $control_graph_id }}",
  "created_timestamp": "{{ $created_timestamp }}",
  "description": "{{ $description }}",
  "device": {
    "agent_version": "x.xx.xxxxx.x",
    "agent_load_flags": "{{ $agent_load_flags }}",
    "agent_local_time": "{{ $agent_local_time }}",
    "bios_manufacturer": "{{ $bios_manufacturer }}",
    "bios_version": "{{ $bios_version }}",
    "cid": "{{ $cid }}",
    "device_id": "{{ $device_id }}",
    "external_ip": "{{ $external_ip }}",
    "external_ipv6": "{{ $external_ipv6 }}",
    "first_seen": "{{ $first_seen }}",
    "groups": "{{ $groups }}",
    "hostinfo": {
      "active_directory_dn_display": "{{ $active_directory_dn_display }}",
      "domain": "{{ $domain }}"
    },
    "hostname": "{{ $hostname }}",
    "host_hidden_status": "{{ $host_hidden_status }}",
    "last_seen": "{{ $last_seen }}",
    "instance_id": "{{ $instance_id }}",
    "local_ip": "{{ $local_ip }}",
    "local_ipv6": "{{ $local_ipv6 }}",
    "mac_address": "{{ $mac_address }}",
    "machine_domain": "{{ $machine_domain }}",
    "major_version": "{{ $major_version }}",
    "minor_version": "{{ $minor_version }}",
    "modified_timestamp": "{{ $modified_timestamp }}",
    "os_version": "{{ $os_version }}",
    "ou": [
      "{{ $ou }}"
    ],
    "platform_id": "{{ $platform_id }}",
    "platform_name": "{{ $platform_name }}",
    "pod_id": "{{ $pod_id }}",
    "pod_labels": [
      "{{ $pod_labels }}"
    ],
    "pod_name": "{{ $pod_name }}",
    "pod_namespace": "{{ $pod_namespace }}",
    "pod_service_account_name": "{{ $pod_service_account_name }}",
    "product_type": "{{ $product_type }}",
    "product_type_desc": "{{ $product_type_desc }}",
    "service_provider": "{{ $service_provider }}",
    "service_provider_account_id": "{{ $service_provider_account_id }}",
    "site_name": "{{ $site_name }}",
    "status": "{{ $status }}",
    "system_manufacturer": "{{ $system_manufacturer }}",
    "system_product_name": "{{ $system_product_name }}",
    "tags": [
      "{{ $tags }}"
    ]
  },
  "display_name": "{{ $display_name }}",
  "falcon_host_link": "https://falcon.crowdstrike.com/activity-v2/detections/{{ $falcon_host_link }}",
  "filename": "{{ $filename }}.{{ $alleged_filetype }}",
  "filepath": "\\\\{{ $filepath }}\\\\{{ $filename }}.{{ $alleged_filetype }}",
  "id": "{{ $id }}",
  "ioc_source": "{{ $ioc_source }}",
  "ioc_type": "{{ $ioc_type }}",
  "ioc_value": "{{ $ioc_value }}",
  "md5": "{{ $md5 }}",
  "mitre_attack": {
    "pattern_id": {{ $pattern_id }},
    "tactic_id": "{{ $tactic_id }}",
    "technique_id": "{{ $technique_id }}",
    "tactic": "{{ $tactic }}",
    "technique": "{{ $technique }}"
  },
  "name": "{{ $username }} on {{ $hostname }}",
  "network_accesses": [
    {
      "access_type": "{{ $access_type }}",
      "connection_direction": "{{ $connection_direction }}",
      "isIPV6": "{{ $isIPV6 }}",
      "local_address": "{{ $local_address }}",
      "local_port": "{{ $local_port }}",
      "protocol": "{{ $protocol }}",
      "remote_address": "{{ $remote_address }}",
      "remote_port": "{{ $remote_port }}"
    }
  ],
  "objective": "{{ $objective }}",
  "parent_process_id": "{{ $parent_process_id }}",
  "pattern_id": {{ $pattern_id }},
  "platform": "{{ $platform_name }}",
  "process_end_time": "{{ $process_end_time }}",
  "process_id": "{{ $process_id }}",
  "process_start_time": "{{ $process_start_time }}",
  "product": "{{ $product }}",
  "scenario": "{{ $scenario }}",
  "severity": {{ $severity }},
  "severity_name": "{{ $severity_name }}",
  "sha256": "{{ $sha256 }}",
  "show_in_ui": {{ $show_in_ui }},
  "status": "{{ $status }}",
  "tactic": "{{ $tactic }}",
  "tactic_id": "{{ $tactic_id }}",
  "technique": "{{ $technique }}",
  "technique_id": "{{ $technique_id }}",
  "timestamp": "{{ $timestamp }}",
  "tree_id": "{{ $tree_id }}",
  "tree_root": "{{ $tree_root }}",
  "triggering_process_graph_id": "{{ $triggering_process_graph_id }}",
  "type": "{{ $type }}",
  "updated_timestamp": "{{ $updated_timestamp }}",
  "user_id": "{{ $user_id }}"
}
*/ -}}
{
    "@timestamp": "{{ $_timestamp.Format "2006-01-02T15:04:05.999999Z07:00" }}",
    "agent": {
        "ephemeral_id": "cdaaaabb-be7e-432f-816b-bda019fd7c15",
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.18.0"
    },
    "data_stream": {
        "dataset": "crowdstrike.alert",
        "namespace": "93724",
        "type": "logs"
    },
    "elastic_agent": {
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "snapshot": false,
        "version": "8.18.0"
    },
    "message": "{\"agent_id\":\"{{ $agent_id }}\",\"aggregate_id\":\"{{ $aggregate_id }}\",\"alleged_filetype\":\"{{ $alleged_filetype }}\",\"cid\":\"{{ $cid }}\",\"cmdline\":\"{{ $cmdline }}\",\"comment\":\"{{ $comment }}\",\"comments\":[{\"falcon_user_id\":\"{{ $falcon_user_id }}@mail.com\",\"timestamp\":\"{{ $timestamp }}\",\"value\":\"{{ $value }}\"}],\"composite_id\":\"{{ $composite_id }}\",\"confidence\":{{ $confidence }},\"control_graph_id\":\"{{ $control_graph_id }}\",\"created_timestamp\":\"{{ $created_timestamp }}\",\"description\":\"{{ $description }}\",\"device\":{\"agent_version\":\"x.xx.xxxxx.x\",\"agent_load_flags\":\"{{ $agent_load_flags }}\",\"agent_local_time\":\"{{ $agent_local_time }}\",\"bios_manufacturer\":\"{{ $bios_manufacturer }}\",\"bios_version\":\"{{ $bios_version }}\",\"cid\":\"{{ $cid }}\",\"device_id\":\"{{ $device_id }}\",\"external_ip\":\"{{ $external_ip }}\",\"external_ipv6\":\"{{ $external_ipv6 }}\",\"first_seen\":\"{{ $first_seen }}\",\"groups\":\"{{ $groups }}\",\"hostinfo\":{\"active_directory_dn_display\":\"{{ $active_directory_dn_display }}\",\"domain\":\"{{ $domain }}\"},\"hostname\":\"{{ $hostname }}\",\"host_hidden_status\":\"{{ $host_hidden_status }}\",\"last_seen\":\"{{ $last_seen }}\",\"instance_id\":\"{{ $instance_id }}\",\"local_ip\":\"{{ $local_ip }}\",\"local_ipv6\":\"{{ $local_ipv6 }}\",\"mac_address\":\"{{ $mac_address }}\",\"machine_domain\":\"{{ $machine_domain }}\",\"major_version\":\"{{ $major_version }}\",\"minor_version\":\"{{ $minor_version }}\",\"modified_timestamp\":\"{{ $modified_timestamp }}\",\"os_version\":\"{{ $os_version }}\",\"ou\":[\"{{ $ou }}\"],\"platform_id\":\"{{ $platform_id }}\",\"platform_name\":\"{{ $platform_name }}\",\"pod_id\":\"{{ $pod_id }}\",\"pod_labels\":[\"{{ $pod_labels }}\"],\"pod_name\":\"{{ $pod_name }}\",\"pod_namespace\":\"{{ $pod_namespace }}\",\"pod_service_account_name\":\"{{ $pod_service_account_name }}\",\"product_type\":\"{{ $product_type }}\",\"product_type_desc\":\"{{ $product_type_desc }}\",\"service_provider\":\"{{ $service_provider }}\",\"service_provider_account_id\":\"{{ $service_provider_account_id }}\",\"site_name\":\"{{ $site_name }}\",\"status\":\"{{ $status }}\",\"system_manufacturer\":\"{{ $system_manufacturer }}\",\"system_product_name\":\"{{ $system_product_name }}\",\"tags\":[\"{{ $tags }}\"]},\"display_name\":\"{{ $display_name }}\",\"falcon_host_link\":\"https://falcon.crowdstrike.com/activity-v2/detections/{{ $falcon_host_link }}\",\"filename\":\"{{ $filename }}.{{ $alleged_filetype }}\",\"filepath\":\"\\\\{{ $filepath }}\\\\{{ $filename }}.{{ $alleged_filetype }}\",\"id\":\"{{ $id }}\",\"ioc_source\":\"{{ $ioc_source }}\",\"ioc_type\":\"{{ $ioc_type }}\",\"ioc_value\":\"{{ $ioc_value }}\",\"md5\":\"{{ $md5 }}\",\"mitre_attack\":{\"pattern_id\":{{ $pattern_id }},\"tactic_id\":\"{{ $tactic_id }}\",\"technique_id\":\"{{ $technique_id }}\",\"tactic\":\"{{ $tactic }}\",\"technique\":\"{{ $technique }}\"},\"name\":\"{{ $username }} on {{ $hostname }}\",\"network_accesses\":[{\"access_type\":\"{{ $access_type }}\",\"connection_direction\":\"{{ $connection_direction }}\",\"isIPV6\":\"{{ $isIPV6 }}\",\"local_address\":\"{{ $local_address }}\",\"local_port\":\"{{ $local_port }}\",\"protocol\":\"{{ $protocol }}\",\"remote_address\":\"{{ $remote_address }}\",\"remote_port\":\"{{ $remote_port }}\"}],\"objective\":\"{{ $objective }}\",\"parent_process_id\":\"{{ $parent_process_id }}\",\"pattern_id\":{{ $pattern_id }},\"platform\":\"{{ $platform_name }}\",\"process_end_time\":\"{{ $process_end_time }}\",\"process_id\":\"{{ $process_id }}\",\"process_start_time\":\"{{ $process_start_time }}\",\"product\":\"{{ $product }}\",\"scenario\":\"{{ $scenario }}\",\"severity\":{{ $severity }},\"severity_name\":\"{{ $severity_name }}\",\"sha256\":\"{{ $sha256 }}\",\"show_in_ui\":{{ $show_in_ui }},\"status\":\"{{ $status }}\",\"tactic\":\"{{ $tactic }}\",\"tactic_id\":\"{{ $tactic_id }}\",\"technique\":\"{{ $technique }}\",\"technique_id\":\"{{ $technique_id }}\",\"timestamp\":\"{{ $timestamp }}\",\"tree_id\":\"{{ $tree_id }}\",\"tree_root\":\"{{ $tree_root }}\",\"triggering_process_graph_id\":\"{{ $triggering_process_graph_id }}\",\"type\":\"{{ $type }}\",\"updated_timestamp\":\"{{ $updated_timestamp }}\",\"user_id\":\"{{ $user_id }}\"}",
    "event": {
        "dataset": "crowdstrike.alert"
    },
    "input": {
        "type": "cel"
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "crowdstrike-alert"
    ]
}
