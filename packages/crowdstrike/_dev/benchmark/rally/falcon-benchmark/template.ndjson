{{- $AgentId := generate "AgentId" }}
{{- $AggregateId := generate "AggregateId" }}
{{- $CommandLine := generate "CommandLine" }}
{{- $CompositeId := generate "CompositeId" }}
{{- $DataDomains := generate "DataDomains" }}
{{- $Description := generate "Description" }}
{{- $FalconHostLink := generate "FalconHostLink" }}
{{- $FileName := generate "FileName" }}
{{- $FilePath := generate "FilePath" }}
{{- $GrandParentCommandLine := generate "GrandParentCommandLine" }}
{{- $GrandParentImageFileName := generate "GrandParentImageFileName" }}
{{- $GrandParentImageFilePath := generate "GrandParentImageFilePath" }}
{{- $HostGroups := generate "HostGroups" }}
{{- $Hostname := generate "Hostname" }}
{{- $LocalIP := generate "LocalIP" }}
{{- $LocalIPv6 := generate "LocalIPv6" }}
{{- $LogonDomain := generate "LogonDomain" }}
{{- $MACAddress := generate "MACAddress" }}
{{- $MD5String := generate "MD5String" }}
{{- $Name := generate "Name" }}
{{- $AccessType := generate "NetworkAccesses.AccessType" }}
{{- $ConnectionDirection := generate "NetworkAccesses.ConnectionDirection" }}
{{- $IsIPV6 := generate "NetworkAccesses.IsIPV6" }}
{{- $LocalAddress := generate "NetworkAccesses.LocalAddress" }}
{{- $LocalPort := generate "NetworkAccesses.LocalPort" }}
{{- $Protocol := generate "NetworkAccesses.Protocol" }}
{{- $RemoteAddress := generate "NetworkAccesses.RemoteAddress" }}
{{- $RemotePort := generate "NetworkAccesses.RemotePort" }}
{{- $Objective := generate "Objective" }}
{{- $ParentCommandLine := generate "ParentCommandLine" }}
{{- $ParentImageFileName := generate "ParentImageFileName" }}
{{- $ParentImageFilePath := generate "ParentImageFilePath" }}
{{- $ParentProcessId := generate "ParentProcessId" }}
{{- $PatternDispositionDescription := generate "PatternDispositionDescription" }}
{{- $BlockingUnsupportedOrDisabled := generate "PatternDispositionFlags.BlockingUnsupportedOrDisabled" }}
{{- $BootupSafeguardEnabled := generate "PatternDispositionFlags.BootupSafeguardEnabled" }}
{{- $ContainmentFileSystem := generate "PatternDispositionFlags.ContainmentFileSystem" }}
{{- $CriticalProcessDisabled := generate "PatternDispositionFlags.CriticalProcessDisabled" }}
{{- $Detect := generate "PatternDispositionFlags.Detect" }}
{{- $FsOperationBlocked := generate "PatternDispositionFlags.FsOperationBlocked" }}
{{- $HandleOperationDowngraded := generate "PatternDispositionFlags.HandleOperationDowngraded" }}
{{- $InddetMask := generate "PatternDispositionFlags.InddetMask" }}
{{- $Indicator := generate "PatternDispositionFlags.Indicator" }}
{{- $KillActionFailed := generate "PatternDispositionFlags.KillActionFailed" }}
{{- $KillParent := generate "PatternDispositionFlags.KillParent" }}
{{- $KillProcess := generate "PatternDispositionFlags.KillProcess" }}
{{- $KillSubProcess := generate "PatternDispositionFlags.KillSubProcess" }}
{{- $OperationBlocked := generate "PatternDispositionFlags.OperationBlocked" }}
{{- $PolicyDisabled := generate "PatternDispositionFlags.PolicyDisabled" }}
{{- $ProcessBlocked := generate "PatternDispositionFlags.ProcessBlocked" }}
{{- $QuarantineFile := generate "PatternDispositionFlags.QuarantineFile" }}
{{- $QuarantineMachine := generate "PatternDispositionFlags.QuarantineMachine" }}
{{- $RegistryOperationBlocked := generate "PatternDispositionFlags.RegistryOperationBlocked" }}
{{- $Rooting := generate "PatternDispositionFlags.Rooting" }}
{{- $SensorOnly := generate "PatternDispositionFlags.SensorOnly" }}
{{- $SuspendParent := generate "PatternDispositionFlags.SuspendParent" }}
{{- $SuspendProcess := generate "PatternDispositionFlags.SuspendProcess" }}
{{- $PatternDispositionValue := generate "PatternDispositionValue" }}
{{- $PatternId := generate "PatternId" }}
{{- $PlatformId := generate "PlatformId" }}
{{- $PlatformName := generate "PlatformName" }}
{{- $ProcessEndTime := generate "ProcessEndTime" }}
{{- $ProcessId := generate "ProcessId" }}
{{- $ProcessStartTime := generate "ProcessStartTime" }}
{{- $ReferrerUrl := generate "ReferrerUrl" }}
{{- $SHA1String := generate "SHA1String" }}
{{- $SHA256String := generate "SHA256String" }}
{{- $Severity := generate "Severity" }}
{{- $DetectionSeverity := generate "DetectionSeverity" }}
{{- $SeverityName := generate "SeverityName" }}
{{- $SourceProducts := generate "SourceProducts" }}
{{- $SourceVendors := generate "SourceVendors" }}
{{- $Tactic := generate "Tactic" }}
{{- $Technique := generate "Technique" }}
{{- $Type := generate "Type" }}
{{- $UserName := generate "UserName" }}
{{- $ComputerName := generate "ComputerName" }}
{{- $DetectName := generate "DetectName" }}
{{- $DetectDescription := generate "DetectDescription" }}
{{- $MachineDomain := generate "MachineDomain" }}
{{- $SensorId := generate "SensorId" }}
{{- $IOCType := generate "IOCType" }}
{{- $IOCValue := generate "IOCValue" }}
{{- $DetectId := generate "DetectId" }}
{{- $GrandparentImageFileName := generate "GrandparentImageFileName" }}
{{- $GrandparentCommandLine := generate "GrandparentCommandLine" }}
{{- $AssociatedFile := generate "AssociatedFile" }}
{{- $DeviceId := generate "DeviceId" }}
{{- $CustomerId := generate "CustomerId" }}
{{- $Ipv := generate "Ipv" }}
{{- $EventType := generate "EventType" }}
{{- $Audit := generate "Flags.Audit" }}
{{- $Log := generate "Flags.Log" }}
{{- $Monitor := generate "Flags.Monitor" }}
{{- $HostName := generate "HostName" }}
{{- $ICMPCode := generate "ICMPCode" }}
{{- $ICMPType := generate "ICMPType" }}
{{- $ImageFileName := generate "ImageFileName" }}
{{- $MatchCount := generate "MatchCount" }}
{{- $MatchCountSinceLastReport := generate "MatchCountSinceLastReport" }}
{{- $NetworkProfile := generate "NetworkProfile" }}
{{- $PID := generate "PID" }}
{{- $PolicyName := generate "PolicyName" }}
{{- $PolicyID := generate "PolicyID" }}
{{- $Protocol := generate "Protocol" }}
{{- $RuleAction := generate "RuleAction" }}
{{- $RuleDescription := generate "RuleDescription" }}
{{- $RuleFamilyID := generate "RuleFamilyID" }}
{{- $RuleGroupName := generate "RuleGroupName" }}
{{- $RuleName := generate "RuleName" }}
{{- $RuleId := generate "RuleId" }}
{{- $Status := generate "Status" }}
{{- $TreeID := generate "TreeID" }}
{{- $SourceAccountDomain := generate "SourceAccountDomain" }}
{{- $SourceAccountName := generate "SourceAccountName" }}
{{- $SourceAccountObjectSid := generate "SourceAccountObjectSid" }}
{{- $SourceEndpointAccountObjectGuid := generate "SourceEndpointAccountObjectGuid" }}
{{- $SourceEndpointAccountObjectSid := generate "SourceEndpointAccountObjectSid" }}
{{- $SourceEndpointHostName := generate "SourceEndpointHostName" }}
{{- $SourceEndpointIpAddress := generate "SourceEndpointIpAddress" }}
{{- $SourceEndpointSensorId := generate "SourceEndpointSensorId" }}
{{- $ActivityId := generate "ActivityId" }}
{{- $IncidentType := generate "IncidentType" }}
{{- $IdpIncidentType := generate "IdpIncidentType" }}
{{- $IncidentDescription := generate "IncidentDescription" }}
{{- $IdentityProtectionIncidentId := generate "IdentityProtectionIncidentId" }}
{{- $EndpointName := generate "EndpointName" }}
{{- $EndpointIp := generate "EndpointIp" }}
{{- $Category := generate "Category" }}
{{- $NumbersOfAlerts := generate "NumbersOfAlerts" }}
{{- $NumberOfCompromisedEntities := generate "NumberOfCompromisedEntities" }}
{{- $State := generate "State" }}
{{- $IncidentState := generate "IncidentState" }}
{{- $UserId := generate "UserId" }}
{{- $UserIp := generate "UserIp" }}
{{- $OperationName := generate "OperationName" }}
{{- $ServiceName := generate "ServiceName" }}
{{- $Success := generate "Success" }}
{{- $Key := generate "AuditKeyValues.Key" }}
{{- $ValueString := generate "AuditKeyValues.ValueString" }}
{{- $actor_cid := generate "Attributes.actor_cid" }}
{{- $actor_user := generate "Attributes.actor_user" }}
{{- $actor_user_uuid := generate "Attributes.actor_user_uuid" }}
{{- $app_id := generate "Attributes.app_id" }}
{{- $saml_assertion := generate "Attributes.saml_assertion" }}
{{- $target_user := generate "Attributes.target_user" }}
{{- $trace_id := generate "Attributes.trace_id" }}
{{- $detection_id := generate "Attributes.detection_id" }}
{{- $UserUUID := generate "UserUUID" }}
{{- $UserID := generate "UserID" }}
{{- $ExecutionID := generate "ExecutionID" }}
{{- $ReportID := generate "ReportID" }}
{{- $ReportName := generate "ReportName" }}
{{- $ReportType := generate "ReportType" }}
{{- $ReportFileReference := generate "ReportFileReference" }}
{{- $StatusMessage := generate "StatusMessage" }}
{{- $ExecutionStart := generate "ExecutionMetadata.ExecutionStart" }}
{{- $ExecutionDuration := generate "ExecutionMetadata.ExecutionDuration" }}
{{- $ReportFileName := generate "ExecutionMetadata.ReportFileName" }}
{{- $ResultCount := generate "ExecutionMetadata.ResultCount" }}
{{- $ResultID := generate "ExecutionMetadata.ResultID" }}
{{- $SearchWindowStart := generate "ExecutionMetadata.SearchWindowStart" }}
{{- $SearchWindowEnd := generate "ExecutionMetadata.SearchWindowEnd" }}
{{- $SessionId := generate "SessionId" }}
{{- $HostnameField := generate "HostnameField" }}
{{- $AgentIdString := generate "AgentIdString" }}
{{- $FineScore := generate "FineScore" }}
{{- $LateralMovement := generate "LateralMovement" }}
{{- $IncidentID := generate "IncidentID" }}
{{- $HostID := generate "HostID" }}
{{- $LMHostIDs := generate "LMHostIDs" }}
{{- $AccountId := generate "AccountId" }}
{{- $PolicyId := generate "PolicyId" }}
{{- $PolicyStatement := generate "PolicyStatement" }}
{{- $CloudProvider := generate "CloudProvider" }}
{{- $CloudService := generate "CloudService" }}
{{- $EventAction := generate "EventAction" }}
{{- $EventSource := generate "EventSource" }}
{{- $UserSourceIp := generate "UserSourceIp" }}
{{- $Region := generate "Region" }}
{{- $ResourceId := generate "ResourceId" }}
{{- $ResourceIdType := generate "ResourceIdType" }}
{{- $ResourceName := generate "ResourceName" }}
{{- $ResourceCreateTime := generate "ResourceCreateTime" }}
{{- $CloudPlatform := generate "CloudPlatform" }}
{{- $Disposition := generate "Disposition" }}
{{- $ResourceUrl := generate "ResourceUrl" }}
{{- $Finding := generate "Finding" }}
{{- $Key := generate "Tags.Key" }}
{{- $ValueString := generate "Tags.ValueString" }}
{{- $ReportUrl := generate "ReportUrl" }}
{{- $MobileDetectionId := generate "MobileDetectionId" }}
{{- $TacticId := generate "TacticId" }}
{{- $TechniqueId := generate "TechniqueId" }}
{{- $AppIdentifier := generate "MobileAppsDetails.AppIdentifier" }}
{{- $AndroidAppLabel := generate "MobileAppsDetails.AndroidAppLabel" }}
{{- $DexFileHashes := generate "MobileAppsDetails.DexFileHashes" }}
{{- $ImageFileName := generate "MobileAppsDetails.ImageFileName" }}
{{- $AppInstallerInformation := generate "MobileAppsDetails.AppInstallerInformation" }}
{{- $IsBeingDebugged := generate "MobileAppsDetails.IsBeingDebugged" }}
{{- $AndroidAppVersionName := generate "MobileAppsDetails.AndroidAppVersionName" }}
{{- $IsContainerized := generate "MobileAppsDetails.IsContainerized" }}
{{- $NotificationId := generate "NotificationId" }}
{{- $Highlights := generate "Highlights" }}
{{- $RuleTopic := generate "RuleTopic" }}
{{- $RulePriority := generate "RulePriority" }}
{{- $ItemId := generate "ItemId" }}
{{- $ItemType := generate "ItemType" }}
{{- $Author := generate "Author" }}
{{- $IPv4Addresses := generate "IPv4Addresses" }}
{{- $HostNames := generate "HostNames" }}
{{- $TacticIds := generate "TacticIds" }}
{{- $Tactics := generate "Tactics" }}
{{- $TechniqueIds := generate "TechniqueIds" }}
{{- $Techniques := generate "Techniques" }}
{{- $XdrType := generate "XdrType" }}
{{- $metadata_eventType := generate "metadata.eventType" }}
{{- $metadata_customerIDString := generate "metadata.customerIDString" }}
{{- $metadata_offset := generate "metadata.offset" }}
{{- $timestamp := generate "timestamp" }}

{{- /*
{
  "metadata": {
    "customerIDString": "{{ $metadata_customerIDString }}",
    "offset": {{ $metadata_offset }},
    "eventType": "{{ $metadata_eventType }}",
    "eventCreationTime": 1686845212400,
    "version": "1.0"
  },
  "event": {
  {{- if eq $metadata_eventType "EppDetectionSummaryEvent" }}
    "AgentId": "{{ $AgentId }}",
    "AggregateId": "{{ $AggregateId }}",
    "CommandLine": "C:\\\\Windows\\\\{{ $CommandLine }}",
    "CompositeId": "{{ $CompositeId }}",
    "DataDomains": "{{ $DataDomains }}",
    "Description": "{{ $Description }}",
    "FalconHostLink": "https://falcon.crowdstrike.com/activity-v2/detections/{{ $FalconHostLink }}?_cid=xxxxxxx",
    "FileName": "{{ $FileName }}",
    "FilePath": "{{ $FilePath }}\\\\{{ $FileName }}",
    "FilesAccessed": [
      {
        "FileName": "{{ $FileName }}",
        "FilePath": "{{ $FilePath }}\\\\{{ $FileName }}",
        "Timestamp": 1751371830
      }
    ],
    "FilesWritten": [
      {
        "FileName": "{{ $FileName }}",
        "FilePath": "{{ $FilePath }}\\\\{{ $FileName }}",
        "Timestamp": 1751371830
      }
    ],
    "GrandParentCommandLine": "C:\\\\Windows\\\\{{ $GrandParentCommandLine }}",
    "GrandParentImageFileName": "{{ $GrandParentImageFileName }}",
    "GrandParentImageFilePath": "{{ $GrandParentImageFilePath }}\\\\{{ $GrandParentImageFileName }}",
    "HostGroups": "{{ $HostGroups }}",
    "Hostname": "{{ $Hostname }}",
    "LocalIP": "{{ $LocalIP }}",
    "LocalIPv6": "{{ $LocalIPv6 }}",
    "LogonDomain": "{{ $LogonDomain }}",
    "MACAddress": "{{ $MACAddress }}",
    "MD5String": "{{ $MD5String }}",
    "Name": "{{ $Name }}",
    "NetworkAccesses": [
      {
        "AccessTimestamp": 1751371565,
        "AccessType": {{ $AccessType }},
        "ConnectionDirection": {{ $ConnectionDirection }},
        "IsIPV6": {{ $IsIPV6 }},
        "LocalAddress": "{{ $LocalAddress }}",
        "LocalPort": {{ $LocalPort }},
        "Protocol": "{{ $Protocol }}",
        "RemoteAddress": "{{ $RemoteAddress }}",
        "RemotePort": {{ $RemotePort }}
      }
    ],
    "Objective": "{{ $Objective }}",
    "ParentCommandLine": "C:\\\\Windows\\\\{{ $ParentCommandLine }}\\\\{{ $ParentImageFileName }}",
    "ParentImageFileName": "{{ $ParentImageFileName }}",
    "ParentImageFilePath": "{{ $ParentImageFilePath }}\\\\{{ $ParentImageFileName }}",
    "ParentProcessId": {{ $ParentProcessId }},
    "PatternDispositionDescription": "{{ $PatternDispositionDescription }}",
    "PatternDispositionFlags": {
      "BlockingUnsupportedOrDisabled": {{ $BlockingUnsupportedOrDisabled }},
      "BootupSafeguardEnabled": {{ $BootupSafeguardEnabled }},
      "ContainmentFileSystem": {{ $ContainmentFileSystem }},
      "CriticalProcessDisabled": {{ $CriticalProcessDisabled }},
      "Detect": {{ $Detect }},
      "FsOperationBlocked": {{ $FsOperationBlocked }},
      "HandleOperationDowngraded": {{ $HandleOperationDowngraded }},
      "InddetMask": {{ $InddetMask }},
      "Indicator": {{ $Indicator }},
      "KillActionFailed": {{ $KillActionFailed }},
      "KillParent": {{ $KillParent }},
      "KillProcess": {{ $KillProcess }},
      "KillSubProcess": {{ $KillSubProcess }},
      "OperationBlocked": {{ $OperationBlocked }},
      "PolicyDisabled": {{ $PolicyDisabled }},
      "ProcessBlocked": {{ $ProcessBlocked }},
      "QuarantineFile": {{ $QuarantineFile }},
      "QuarantineMachine": {{ $QuarantineMachine }},
      "RegistryOperationBlocked": {{ $RegistryOperationBlocked }},
      "Rooting": {{ $Rooting }},
      "SensorOnly": {{ $SensorOnly }},
      "SuspendParent": {{ $SuspendParent }},
      "SuspendProcess": {{ $SuspendProcess }}
    },
    "PatternDispositionValue": {{ $PatternDispositionValue }},
    "PatternId": {{ $PatternId }},
    "PlatformId": "{{ $PlatformId }}",
    "PlatformName": "{{ $PlatformName }}",
    "ProcessEndTime": {{ $ProcessEndTime }},
    "ProcessId": {{ $ProcessId }},
    "ProcessStartTime": {{ $ProcessStartTime }},
    "ReferrerUrl": "{{ $ReferrerUrl }}",
    "SHA1String": "{{ $SHA1String }}",
    "SHA256String": "{{ $SHA256String }}",
    "Severity": {{ $Severity }},
    "SeverityName": "{{ $SeverityName }}",
    "SourceProducts": "{{ $SourceProducts }}",
    "SourceVendors": "{{ $SourceVendors }}",
    "Tactic": "{{ $Tactic }}",
    "Technique": "{{ $Technique }}",
    "Type": "{{ $Type }}",
    "UserName": "{{ $UserName }}"
  {{- else if eq $metadata_eventType "DetectionSummaryEvent" }}
    "ProcessStartTime": {{ $ProcessStartTime }},
    "ProcessEndTime": {{ $ProcessEndTime }},
    "ProcessId": {{ $ProcessId }},
    "ParentProcessId": {{ $ParentProcessId }},
    "ComputerName": "{{ $ComputerName }}",
    "UserName": "{{ $UserName }}",
    "DetectName": "{{ $DetectName }}",
    "DetectDescription": "{{ $DetectDescription }}",
    "Severity": {{ $DetectionSeverity }},
    "SeverityName": "{{ $SeverityName }}",
    "FileName": "{{ $FileName }}",
    "FilePath": "{{ $FilePath }}\\\\{{ $FileName }}",
    "CommandLine": "C:\\\\Windows\\\\{{ $CommandLine }}",
    "SHA256String": "{{ $SHA256String }}",
    "MD5String": "{{ $MD5String }}",
    "SHA1String": "{{ $SHA1String }}",
    "MachineDomain": "{{ $MachineDomain }}",
    "NetworkAccesses": [
      {
        "AccessType": {{ $AccessType }},
        "AccessTimestamp": 1751371565,
        "Protocol": "{{ $Protocol }}",
        "LocalAddress": "{{ $LocalAddress }}",
        "LocalPort": {{ $LocalPort }},
        "RemoteAddress": "{{ $RemoteAddress }}",
        "RemotePort": {{ $RemotePort }},
        "ConnectionDirection": {{ $ConnectionDirection }},
        "IsIPV6": {{ $IsIPV6 }}
      }
    ],
    "FalconHostLink": "https://falcon.crowdstrike.com/activity-v2/detections/{{ $FalconHostLink }}?_cid=xxxxxxx",
    "SensorId": "{{ $SensorId }}",
    "IOCType": "{{ $IOCType }}",
    "IOCValue": "{{ $IOCValue }}",
    "DetectId": "{{ $DetectId }}",
    "LocalIP": "{{ $LocalIP }}",
    "MACAddress": "{{ $MACAddress }}",
    "Tactic": "{{ $Tactic }}",
    "Technique": "{{ $Technique }}",
    "Objective": "{{ $Objective }}",
    "PatternDispositionDescription": "{{ $PatternDispositionDescription }}",
    "PatternDispositionValue": {{ $PatternDispositionValue }},
    "PatternDispositionFlags": {
      "Indicator": {{ $Indicator }},
      "Detect": {{ $Detect }},
      "InddetMask": {{ $InddetMask }},
      "SensorOnly": {{ $SensorOnly }},
      "Rooting": {{ $Rooting }},
      "KillProcess": {{ $KillProcess }},
      "KillSubProcess": {{ $KillSubProcess }},
      "QuarantineMachine": {{ $QuarantineMachine }},
      "QuarantineFile": {{ $QuarantineFile }},
      "PolicyDisabled": {{ $PolicyDisabled }},
      "KillParent": {{ $KillParent }},
      "OperationBlocked": {{ $OperationBlocked }},
      "ProcessBlocked": {{ $ProcessBlocked }},
      "RegistryOperationBlocked": {{ $RegistryOperationBlocked }},
      "CriticalProcessDisabled": {{ $CriticalProcessDisabled }},
      "BootupSafeguardEnabled": {{ $BootupSafeguardEnabled }},
      "FsOperationBlocked": {{ $FsOperationBlocked }},
      "HandleOperationDowngraded": {{ $HandleOperationDowngraded }},
      "KillActionFailed": {{ $KillActionFailed }},
      "BlockingUnsupportedOrDisabled": {{ $BlockingUnsupportedOrDisabled }},
      "SuspendProcess": {{ $SuspendProcess }},
      "SuspendParent": {{ $SuspendParent }}
    },
    "ParentImageFileName": "{{ $ParentImageFileName }}",
    "ParentCommandLine": "{{ $ParentCommandLine }}",
    "GrandparentImageFileName": "{{ $GrandparentImageFileName }}",
    "GrandparentCommandLine": "{{ $GrandparentCommandLine }}",
    "HostGroups": "{{ $HostGroups }}",
    "AssociatedFile": "{{ $AssociatedFile }}",
    "PatternId": {{ $PatternId }}
  {{- else if eq $metadata_eventType "FirewallMatchEvent" }}
    "DeviceId": "{{ $DeviceId }}",
    "CustomerId": "{{ $CustomerId }}",
    "Ipv": "{{ $Ipv }}",
    "CommandLine": "{{ $CommandLine }}",
    "ConnectionDirection": "{{ $ConnectionDirection }}",
    "EventType": "{{ $EventType }}",
    "Flags": {
      "Audit": {{ $Audit }},
      "Log": {{ $Log }},
      "Monitor": {{ $Monitor }}
    },
    "HostName": "{{ $HostName }}",
    "ICMPCode": "{{ $ICMPCode }}",
    "ICMPType": "{{ $ICMPType }}",
    "ImageFileName": "{{ $ImageFileName }}",
    "LocalAddress": "{{ $LocalAddress }}",
    "LocalPort": "{{ $LocalPort }}",
    "MatchCount": {{ $MatchCount }},
    "MatchCountSinceLastReport": {{ $MatchCountSinceLastReport }},
    "NetworkProfile": "{{ $NetworkProfile }}",
    "PID": "{{ $PID }}",
    "PolicyName": "{{ $PolicyName }}",
    "PolicyID": "{{ $PolicyID }}",
    "Protocol": "{{ $Protocol }}",
    "RemoteAddress": "{{ $RemoteAddress }}",
    "RemotePort": "{{ $RemotePort }}",
    "RuleAction": "{{ $RuleAction }}",
    "RuleDescription": "{{ $RuleDescription }}",
    "RuleFamilyID": "{{ $RuleFamilyID }}",
    "RuleGroupName": "{{ $RuleGroupName }}",
    "RuleName": "{{ $RuleName }}",
    "RuleId": "{{ $RuleId }}",
    "Status": "{{ $Status }}",
    "Timestamp": 1751371830,
    "TreeID": "{{ $TreeID }}"
  {{- else if eq $metadata_eventType "IdpDetectionSummaryEvent" }}
    "ContextTimeStamp": 133984620360000000,
    "CompositeId": "{{ $CompositeId }}",
    "DetectId": "{{ $DetectId }}",
    "DetectName": "{{ $DetectName }}",
    "DetectDescription": "{{ $DetectDescription }}",
    "FalconHostLink": "https://falcon.crowdstrike.com/activity-v2/detections/{{ $FalconHostLink }}?_cid=xxxxxxx",
    "StartTime": 133984620360000000,
    "EndTime": 133984620360000000,
    "Severity": {{ $Severity }},
    "SeverityName": "{{ $SeverityName }}",
    "Tactic": "{{ $Tactic }}",
    "Technique": "{{ $Technique }}",
    "Objective": "{{ $Objective }}",
    "SourceAccountDomain": "{{ $SourceAccountDomain }}",
    "SourceAccountName": "{{ $SourceAccountName }}",
    "SourceAccountObjectSid": "{{ $SourceAccountObjectSid }}",
    "SourceEndpointAccountObjectGuid": "{{ $SourceEndpointAccountObjectGuid }}",
    "SourceEndpointAccountObjectSid": "{{ $SourceEndpointAccountObjectSid }}",
    "SourceEndpointHostName": "{{ $SourceEndpointHostName }}",
    "SourceEndpointIpAddress": "{{ $SourceEndpointIpAddress }}",
    "SourceEndpointSensorId": "{{ $SourceEndpointSensorId }}",
    "PrecedingActivityTimeStamp": 133984620360000000,
    "MostRecentActivityTimeStamp": 133984620360000000,
    "ActivityId": "{{ $ActivityId }}",
    "PatternId": {{ $PatternId }}
  {{- else if eq $metadata_eventType "IdentityProtectionEvent" }}
    "IncidentType": "{{ $IdpIncidentType }}",
    "IncidentDescription": "{{ $IncidentDescription }}",
    "Severity": {{ $Severity }},
    "SeverityName": "{{ $SeverityName }}",
    "StartTime": 1686891836383,
    "EndTime": 1686891836383,
    "IdentityProtectionIncidentId": "{{ $IdentityProtectionIncidentId }}",
    "UserName": "{{ $UserName }}",
    "EndpointName": "{{ $EndpointName }}",
    "EndpointIp": "{{ $EndpointIp }}",
    "Category": "{{ $Category }}",
    "NumbersOfAlerts": {{ $NumbersOfAlerts }},
    "NumberOfCompromisedEntities": {{ $NumberOfCompromisedEntities }},
    "State": "{{ $State }}",
    "FalconHostLink": "https://falcon.crowdstrike.com/activity-v2/detections/{{ $FalconHostLink }}?_cid=xxxxxxx"
  {{- else if eq $metadata_eventType "AuthActivityAuditEvent" }}
    "UserId": "{{ $UserId }}",
    "UserIp": "{{ $UserIp }}",
    "OperationName": "{{ $OperationName }}",
    "ServiceName": "{{ $ServiceName }}",
    "Success": {{ $Success }},
    "UTCTimestamp": 1686849556,
    "AuditKeyValues": [
      {
        "Key": "{{ $Key }}",
        "ValueString": "{{ $ValueString }}"
      }
    ],
    "Attributes": {
      "actor_cid": "{{ $actor_cid }}",
      "actor_user": "{{ $actor_user }}",
      "actor_user_uuid": "{{ $actor_user_uuid }}",
      "app_id": "{{ $app_id }}",
      "saml_assertion": "{{ $saml_assertion }}",
      "target_user": "{{ $target_user }}",
      "trace_id": "{{ $trace_id }}"
    }
  {{- else if eq $metadata_eventType "UserActivityAuditEvent" }}
    "UserId": "{{ $UserId }}",
    "UserIp": "{{ $UserIp }}",
    "OperationName": "{{ $OperationName }}",
    "ServiceName": "{{ $ServiceName }}",
    "AuditKeyValues": [
      {
        "Key": "{{ $Key }}",
        "ValueString": "{{ $ValueString }}"
      }
    ],
    "UTCTimestamp": 1686849556,
    "Attributes": {
      "detection_id": "{{ $detection_id }}"
    }
  {{- else if eq $metadata_eventType "ScheduledReportNotificationEvent" }}
    "UserUUID": "{{ $UserUUID }}",
    "UserID": "{{ $UserID }}",
    "ExecutionID": "{{ $ExecutionID }}",
    "ReportID": "{{ $ReportID }}",
    "ReportName": "{{ $ReportName }}",
    "ReportType": "{{ $ReportType }}",
    "ReportFileReference": "{{ $ReportFileReference }}",
    "Status": "{{ $Status }}",
    "StatusMessage": "{{ $StatusMessage }}",
    "ExecutionMetadata": {
      "ExecutionStart": {{ $ExecutionStart }},
      "ExecutionDuration": {{ $ExecutionDuration }},
      "ReportFileName": "{{ $ReportFileName }}",
      "ResultCount": {{ $ResultCount }},
      "ResultID": "{{ $ResultID }}",
      "SearchWindowStart": {{ $SearchWindowStart }},
      "SearchWindowEnd": {{ $SearchWindowEnd }}
    }
  {{- else if eq $metadata_eventType "RemoteResponseSessionStartEvent" }}
    "SessionId": "{{ $SessionId }}",
    "HostnameField": "{{ $HostnameField }}",
    "UserName": "{{ $UserName }}",
    "StartTimestamp": 1582830734,
    "AgentIdString": "{{ $AgentIdString }}"
  {{- else if eq $metadata_eventType "IncidentSummaryEvent" }}
    "IncidentStartTime": 1685844891,
    "IncidentEndTime": 1685844891,
    "FalconHostLink": "{{ $FalconHostLink }}",
    "State": "{{ $IncidentState }}",
    "FineScore": {{ $FineScore }},
    "LateralMovement": {{ $LateralMovement }},
    "IncidentType": {{ $IncidentType }},
    "IncidentID": "{{ $IncidentID }}",
    "HostID": "{{ $HostID }}",
    "LMHostIDs": [
      "{{ $LMHostIDs }}"
    ],
    "UserId": "{{ $UserId }}"
  {{- else if eq $metadata_eventType "CSPMIOAStreamingEvent" }}
    "AccountId": "{{ $AccountId }}",
    "PolicyId": {{ $PolicyId }},
    "PolicyStatement": "{{ $PolicyStatement }}",
    "CloudProvider": "{{ $CloudProvider }}",
    "CloudService": "{{ $CloudService }}",
    "Severity": {{ $Severity }},
    "SeverityName": "{{ $SeverityName }}",
    "EventAction": "{{ $EventAction }}",
    "EventSource": "{{ $EventSource }}",
    "EventCreatedTimestamp": 1663011160,
    "UserId": "{{ $UserId }}",
    "UserName": "{{ $UserName }}",
    "UserSourceIp": "{{ $UserSourceIp }}",
    "Tactic": "{{ $Tactic }}",
    "Technique": "{{ $Technique }}"
  {{- else if eq $metadata_eventType "CSPMSearchStreamingEvent" }}
    "AccountId": "{{ $AccountId }}",
    "Region": "{{ $Region }}",
    "ResourceId": "{{ $ResourceId }}",
    "ResourceIdType": "{{ $ResourceIdType }}",
    "ResourceName": "{{ $ResourceName }}",
    "ResourceCreateTime": 0,
    "PolicyStatement": "{{ $PolicyStatement }}",
    "PolicyId": {{ $PolicyId }},
    "Severity": {{ $Severity }},
    "SeverityName": "{{ $SeverityName }}",
    "CloudPlatform": "{{ $CloudPlatform }}",
    "CloudService": "{{ $CloudService }}",
    "Disposition": "{{ $Disposition }}",
    "ResourceUrl": "{{ $ResourceUrl }}",
    "Finding": "{{ $Finding }}",
    "Tags": [
      {
        "Key": "{{ $Key }}",
        "ValueString": "{{ $ValueString }}"
      }
    ],
    "ReportUrl": "{{ $ReportUrl }}",
    "Timestamp": 1751371830
  {{- else if eq $metadata_eventType "MobileDetectionSummaryEvent" }}
    "SensorId": "{{ $SensorId }}",
    "MobileDetectionId": {{ $MobileDetectionId }},
    "ComputerName": "{{ $ComputerName }}",
    "UserName": "{{ $UserName }}",
    "ContextTimeStamp": 1649061056,
    "DetectId": "{{ $DetectId }}",
    "DetectName": "{{ $DetectName }}",
    "DetectDescription": "{{ $DetectDescription }}",
    "Tactic": "{{ $Tactic }}",
    "TacticId": "{{ $TacticId }}",
    "Technique": "{{ $Technique }}",
    "TechniqueId": "{{ $TechniqueId }}",
    "Objective": "{{ $Objective }}",
    "Severity": {{ $Severity }},
    "FalconHostLink": "https://falcon.crowdstrike.com/activity-v2/detections/{{ $FalconHostLink }}?_cid=xxxxxxx",
    "MobileAppsDetails": [
      {
        "AppIdentifier": "{{ $AppIdentifier }}",
        "AndroidAppLabel": "{{ $AndroidAppLabel }}",
        "DexFileHashes": "{{ $DexFileHashes }}",
        "ImageFileName": "{{ $ImageFileName }}",
        "AppInstallerInformation": "{{ $AppInstallerInformation }}",
        "IsBeingDebugged": {{ $IsBeingDebugged }},
        "AndroidAppVersionName": "{{ $AndroidAppVersionName }}",
        "IsContainerized": {{ $IsContainerized }}
      }
    ]
  {{- else if eq $metadata_eventType "ReconNotificationSummaryEvent" }}
    "NotificationId": "{{ $NotificationId }}",
    "Highlights": [
      "{{ $Highlights }}"
    ],
    "MatchedTimestamp": 1686889114000,
    "RuleId": "{{ $RuleId }}",
    "RuleName": "{{ $RuleName }}",
    "RuleTopic": "{{ $RuleTopic }}",
    "RulePriority": "{{ $RulePriority }}",
    "ItemId": "{{ $ItemId }}",
    "ItemType": "{{ $ItemType }}",
    "ItemPostedTimestamp": 1686889114000
  {{- else if eq $metadata_eventType "XdrDetectionSummaryEvent" }}
    "Author": "{{ $Author }}",
    "DataDomains": "{{ $DataDomains }}",
    "Description": "{{ $Description }}",
    "DetectId": "{{ $DetectId }}",
    "EndTimeEpoch": 1643317697728000000,
    "IPv4Addresses": "{{ $IPv4Addresses }}",
    "HostNames": "{{ $HostNames }}",
    "Name": "{{ $Name }}",
    "PatternId": {{ $PatternId }},
    "Severity": {{ $Severity }},
    "SourceProducts": "{{ $SourceProducts }}",
    "SourceVendors": "{{ $SourceVendors }}",
    "StartTimeEpoch": 1643317697728000000,
    "TacticIds": "{{ $TacticIds }}",
    "Tactics": "{{ $Tactics }}",
    "TechniqueIds": "{{ $TechniqueIds }}",
    "Techniques": "{{ $Techniques }}",
    "XdrType": "{{ $XdrType }}"
  {{end}}
  }
}
*/ -}}
{
    "@timestamp": "{{ $timestamp.Format "2006-01-02T15:04:05.999999Z07:00" }}",
    "agent": {
        "ephemeral_id": "cdaaaabb-be7e-432f-816b-bda019fd7c15",
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.18.0"
    },
    "data_stream": {
        "dataset": "crowdstrike.falcon",
        "namespace": "93724",
        "type": "logs"
    },
    "elastic_agent": {
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "snapshot": false,
        "version": "8.18.0"
    },
    "message": "{\"metadata\":{\"customerIDString\":\"{{ $metadata_customerIDString }}\",\"offset\":{{ $metadata_offset }},\"eventType\":\"{{ $metadata_eventType }}\",\"eventCreationTime\":1686845212400,\"version\":\"1.0\"},\"event\":{ {{- if eq $metadata_eventType "EppDetectionSummaryEvent" }}\"AgentId\":\"{{ $AgentId }}\",\"AggregateId\":\"{{ $AggregateId }}\",\"CommandLine\":\"C:\\\\Windows\\\\{{ $CommandLine }}\",\"CompositeId\":\"{{ $CompositeId }}\",\"DataDomains\":\"{{ $DataDomains }}\",\"Description\":\"{{ $Description }}\",\"FalconHostLink\":\"https://falcon.crowdstrike.com/activity-v2/detections/{{ $FalconHostLink }}?_cid=xxxxxxx\",\"FileName\":\"{{ $FileName }}\",\"FilePath\":\"{{ $FilePath }}\\\\{{ $FileName }}\",\"FilesAccessed\":[{\"FileName\":\"{{ $FileName }}\",\"FilePath\":\"{{ $FilePath }}\\\\{{ $FileName }}\",\"Timestamp\":1751371830}],\"FilesWritten\":[{\"FileName\":\"{{ $FileName }}\",\"FilePath\":\"{{ $FilePath }}\\\\{{ $FileName }}\",\"Timestamp\":1751371830}],\"GrandParentCommandLine\":\"C:\\\\Windows\\\\{{ $GrandParentCommandLine }}\",\"GrandParentImageFileName\":\"{{ $GrandParentImageFileName }}\",\"GrandParentImageFilePath\":\"{{ $GrandParentImageFilePath }}\\\\{{ $GrandParentImageFileName }}\",\"HostGroups\":\"{{ $HostGroups }}\",\"Hostname\":\"{{ $Hostname }}\",\"LocalIP\":\"{{ $LocalIP }}\",\"LocalIPv6\":\"{{ $LocalIPv6 }}\",\"LogonDomain\":\"{{ $LogonDomain }}\",\"MACAddress\":\"{{ $MACAddress }}\",\"MD5String\":\"{{ $MD5String }}\",\"Name\":\"{{ $Name }}\",\"NetworkAccesses\":[{\"AccessTimestamp\":1751371565,\"AccessType\":{{ $AccessType }},\"ConnectionDirection\":{{ $ConnectionDirection }},\"IsIPV6\":{{ $IsIPV6 }},\"LocalAddress\":\"{{ $LocalAddress }}\",\"LocalPort\":{{ $LocalPort }},\"Protocol\":\"{{ $Protocol }}\",\"RemoteAddress\":\"{{ $RemoteAddress }}\",\"RemotePort\":{{ $RemotePort }}}],\"Objective\":\"{{ $Objective }}\",\"ParentCommandLine\":\"C:\\\\Windows\\\\{{ $ParentCommandLine }}\\\\{{ $ParentImageFileName }}\",\"ParentImageFileName\":\"{{ $ParentImageFileName }}\",\"ParentImageFilePath\":\"{{ $ParentImageFilePath }}\\\\{{ $ParentImageFileName }}\",\"ParentProcessId\":{{ $ParentProcessId }},\"PatternDispositionDescription\":\"{{ $PatternDispositionDescription }}\",\"PatternDispositionFlags\":{\"BlockingUnsupportedOrDisabled\":{{ $BlockingUnsupportedOrDisabled }},\"BootupSafeguardEnabled\":{{ $BootupSafeguardEnabled }},\"ContainmentFileSystem\":{{ $ContainmentFileSystem }},\"CriticalProcessDisabled\":{{ $CriticalProcessDisabled }},\"Detect\":{{ $Detect }},\"FsOperationBlocked\":{{ $FsOperationBlocked }},\"HandleOperationDowngraded\":{{ $HandleOperationDowngraded }},\"InddetMask\":{{ $InddetMask }},\"Indicator\":{{ $Indicator }},\"KillActionFailed\":{{ $KillActionFailed }},\"KillParent\":{{ $KillParent }},\"KillProcess\":{{ $KillProcess }},\"KillSubProcess\":{{ $KillSubProcess }},\"OperationBlocked\":{{ $OperationBlocked }},\"PolicyDisabled\":{{ $PolicyDisabled }},\"ProcessBlocked\":{{ $ProcessBlocked }},\"QuarantineFile\":{{ $QuarantineFile }},\"QuarantineMachine\":{{ $QuarantineMachine }},\"RegistryOperationBlocked\":{{ $RegistryOperationBlocked }},\"Rooting\":{{ $Rooting }},\"SensorOnly\":{{ $SensorOnly }},\"SuspendParent\":{{ $SuspendParent }},\"SuspendProcess\":{{ $SuspendProcess }}},\"PatternDispositionValue\":{{ $PatternDispositionValue }},\"PatternId\":{{ $PatternId }},\"PlatformId\":\"{{ $PlatformId }}\",\"PlatformName\":\"{{ $PlatformName }}\",\"ProcessEndTime\":{{ $ProcessEndTime }},\"ProcessId\":{{ $ProcessId }},\"ProcessStartTime\":{{ $ProcessStartTime }},\"ReferrerUrl\":\"{{ $ReferrerUrl }}\",\"SHA1String\":\"{{ $SHA1String }}\",\"SHA256String\":\"{{ $SHA256String }}\",\"Severity\":{{ $Severity }},\"SeverityName\":\"{{ $SeverityName }}\",\"SourceProducts\":\"{{ $SourceProducts }}\",\"SourceVendors\":\"{{ $SourceVendors }}\",\"Tactic\":\"{{ $Tactic }}\",\"Technique\":\"{{ $Technique }}\",\"Type\":\"{{ $Type }}\",\"UserName\":\"{{ $UserName }}\"{{- else if eq $metadata_eventType "DetectionSummaryEvent" }}\"ProcessStartTime\":{{ $ProcessStartTime }},\"ProcessEndTime\":{{ $ProcessEndTime }},\"ProcessId\":{{ $ProcessId }},\"ParentProcessId\":{{ $ParentProcessId }},\"ComputerName\":\"{{ $ComputerName }}\",\"UserName\":\"{{ $UserName }}\",\"DetectName\":\"{{ $DetectName }}\",\"DetectDescription\":\"{{ $DetectDescription }}\",\"Severity\":{{ $DetectionSeverity }},\"SeverityName\":\"{{ $SeverityName }}\",\"FileName\":\"{{ $FileName }}\",\"FilePath\":\"{{ $FilePath }}\\\\{{ $FileName }}\",\"CommandLine\":\"C:\\\\Windows\\\\{{ $CommandLine }}\",\"SHA256String\":\"{{ $SHA256String }}\",\"MD5String\":\"{{ $MD5String }}\",\"SHA1String\":\"{{ $SHA1String }}\",\"MachineDomain\":\"{{ $MachineDomain }}\",\"NetworkAccesses\":[{\"AccessType\":{{ $AccessType }},\"AccessTimestamp\":1751371565,\"Protocol\":\"{{ $Protocol }}\",\"LocalAddress\":\"{{ $LocalAddress }}\",\"LocalPort\":{{ $LocalPort }},\"RemoteAddress\":\"{{ $RemoteAddress }}\",\"RemotePort\":{{ $RemotePort }},\"ConnectionDirection\":{{ $ConnectionDirection }},\"IsIPV6\":{{ $IsIPV6 }}}],\"FalconHostLink\":\"https://falcon.crowdstrike.com/activity-v2/detections/{{ $FalconHostLink }}?_cid=xxxxxxx\",\"SensorId\":\"{{ $SensorId }}\",\"IOCType\":\"{{ $IOCType }}\",\"IOCValue\":\"{{ $IOCValue }}\",\"DetectId\":\"{{ $DetectId }}\",\"LocalIP\":\"{{ $LocalIP }}\",\"MACAddress\":\"{{ $MACAddress }}\",\"Tactic\":\"{{ $Tactic }}\",\"Technique\":\"{{ $Technique }}\",\"Objective\":\"{{ $Objective }}\",\"PatternDispositionDescription\":\"{{ $PatternDispositionDescription }}\",\"PatternDispositionValue\":{{ $PatternDispositionValue }},\"PatternDispositionFlags\":{\"Indicator\":{{ $Indicator }},\"Detect\":{{ $Detect }},\"InddetMask\":{{ $InddetMask }},\"SensorOnly\":{{ $SensorOnly }},\"Rooting\":{{ $Rooting }},\"KillProcess\":{{ $KillProcess }},\"KillSubProcess\":{{ $KillSubProcess }},\"QuarantineMachine\":{{ $QuarantineMachine }},\"QuarantineFile\":{{ $QuarantineFile }},\"PolicyDisabled\":{{ $PolicyDisabled }},\"KillParent\":{{ $KillParent }},\"OperationBlocked\":{{ $OperationBlocked }},\"ProcessBlocked\":{{ $ProcessBlocked }},\"RegistryOperationBlocked\":{{ $RegistryOperationBlocked }},\"CriticalProcessDisabled\":{{ $CriticalProcessDisabled }},\"BootupSafeguardEnabled\":{{ $BootupSafeguardEnabled }},\"FsOperationBlocked\":{{ $FsOperationBlocked }},\"HandleOperationDowngraded\":{{ $HandleOperationDowngraded }},\"KillActionFailed\":{{ $KillActionFailed }},\"BlockingUnsupportedOrDisabled\":{{ $BlockingUnsupportedOrDisabled }},\"SuspendProcess\":{{ $SuspendProcess }},\"SuspendParent\":{{ $SuspendParent }}},\"ParentImageFileName\":\"{{ $ParentImageFileName }}\",\"ParentCommandLine\":\"{{ $ParentCommandLine }}\",\"GrandparentImageFileName\":\"{{ $GrandparentImageFileName }}\",\"GrandparentCommandLine\":\"{{ $GrandparentCommandLine }}\",\"HostGroups\":\"{{ $HostGroups }}\",\"AssociatedFile\":\"{{ $AssociatedFile }}\",\"PatternId\":{{ $PatternId }}{{- else if eq $metadata_eventType "FirewallMatchEvent" }}\"DeviceId\":\"{{ $DeviceId }}\",\"CustomerId\":\"{{ $CustomerId }}\",\"Ipv\":\"{{ $Ipv }}\",\"CommandLine\":\"{{ $CommandLine }}\",\"ConnectionDirection\":\"{{ $ConnectionDirection }}\",\"EventType\":\"{{ $EventType }}\",\"Flags\":{\"Audit\":{{ $Audit }},\"Log\":{{ $Log }},\"Monitor\":{{ $Monitor }}},\"HostName\":\"{{ $HostName }}\",\"ICMPCode\":\"{{ $ICMPCode }}\",\"ICMPType\":\"{{ $ICMPType }}\",\"ImageFileName\":\"{{ $ImageFileName }}\",\"LocalAddress\":\"{{ $LocalAddress }}\",\"LocalPort\":\"{{ $LocalPort }}\",\"MatchCount\":{{ $MatchCount }},\"MatchCountSinceLastReport\":{{ $MatchCountSinceLastReport }},\"NetworkProfile\":\"{{ $NetworkProfile }}\",\"PID\":\"{{ $PID }}\",\"PolicyName\":\"{{ $PolicyName }}\",\"PolicyID\":\"{{ $PolicyID }}\",\"Protocol\":\"{{ $Protocol }}\",\"RemoteAddress\":\"{{ $RemoteAddress }}\",\"RemotePort\":\"{{ $RemotePort }}\",\"RuleAction\":\"{{ $RuleAction }}\",\"RuleDescription\":\"{{ $RuleDescription }}\",\"RuleFamilyID\":\"{{ $RuleFamilyID }}\",\"RuleGroupName\":\"{{ $RuleGroupName }}\",\"RuleName\":\"{{ $RuleName }}\",\"RuleId\":\"{{ $RuleId }}\",\"Status\":\"{{ $Status }}\",\"Timestamp\":1751371830,\"TreeID\":\"{{ $TreeID }}\"{{- else if eq $metadata_eventType "IdpDetectionSummaryEvent" }}\"ContextTimeStamp\":133984620360000000,\"CompositeId\":\"{{ $CompositeId }}\",\"DetectId\":\"{{ $DetectId }}\",\"DetectName\":\"{{ $DetectName }}\",\"DetectDescription\":\"{{ $DetectDescription }}\",\"FalconHostLink\":\"https://falcon.crowdstrike.com/activity-v2/detections/{{ $FalconHostLink }}?_cid=xxxxxxx\",\"StartTime\":133984620360000000,\"EndTime\":133984620360000000,\"Severity\":{{ $Severity }},\"SeverityName\":\"{{ $SeverityName }}\",\"Tactic\":\"{{ $Tactic }}\",\"Technique\":\"{{ $Technique }}\",\"Objective\":\"{{ $Objective }}\",\"SourceAccountDomain\":\"{{ $SourceAccountDomain }}\",\"SourceAccountName\":\"{{ $SourceAccountName }}\",\"SourceAccountObjectSid\":\"{{ $SourceAccountObjectSid }}\",\"SourceEndpointAccountObjectGuid\":\"{{ $SourceEndpointAccountObjectGuid }}\",\"SourceEndpointAccountObjectSid\":\"{{ $SourceEndpointAccountObjectSid }}\",\"SourceEndpointHostName\":\"{{ $SourceEndpointHostName }}\",\"SourceEndpointIpAddress\":\"{{ $SourceEndpointIpAddress }}\",\"SourceEndpointSensorId\":\"{{ $SourceEndpointSensorId }}\",\"PrecedingActivityTimeStamp\":133984620360000000,\"MostRecentActivityTimeStamp\":133984620360000000,\"ActivityId\":\"{{ $ActivityId }}\",\"PatternId\":{{ $PatternId }}{{- else if eq $metadata_eventType "IdentityProtectionEvent" }}\"IncidentType\":\"{{ $IdpIncidentType }}\",\"IncidentDescription\":\"{{ $IncidentDescription }}\",\"Severity\":{{ $Severity }},\"SeverityName\":\"{{ $SeverityName }}\",\"StartTime\":1686891836383,\"EndTime\":1686891836383,\"IdentityProtectionIncidentId\":\"{{ $IdentityProtectionIncidentId }}\",\"UserName\":\"{{ $UserName }}\",\"EndpointName\":\"{{ $EndpointName }}\",\"EndpointIp\":\"{{ $EndpointIp }}\",\"Category\":\"{{ $Category }}\",\"NumbersOfAlerts\":{{ $NumbersOfAlerts }},\"NumberOfCompromisedEntities\":{{ $NumberOfCompromisedEntities }},\"State\":\"{{ $State }}\",\"FalconHostLink\":\"https://falcon.crowdstrike.com/activity-v2/detections/{{ $FalconHostLink }}?_cid=xxxxxxx\"{{- else if eq $metadata_eventType "AuthActivityAuditEvent" }}\"UserId\":\"{{ $UserId }}\",\"UserIp\":\"{{ $UserIp }}\",\"OperationName\":\"{{ $OperationName }}\",\"ServiceName\":\"{{ $ServiceName }}\",\"Success\":{{ $Success }},\"UTCTimestamp\":1686849556,\"AuditKeyValues\":[{\"Key\":\"{{ $Key }}\",\"ValueString\":\"{{ $ValueString }}\"}],\"Attributes\":{\"actor_cid\":\"{{ $actor_cid }}\",\"actor_user\":\"{{ $actor_user }}\",\"actor_user_uuid\":\"{{ $actor_user_uuid }}\",\"app_id\":\"{{ $app_id }}\",\"saml_assertion\":\"{{ $saml_assertion }}\",\"target_user\":\"{{ $target_user }}\",\"trace_id\":\"{{ $trace_id }}\"}{{- else if eq $metadata_eventType "UserActivityAuditEvent" }}\"UserId\":\"{{ $UserId }}\",\"UserIp\":\"{{ $UserIp }}\",\"OperationName\":\"{{ $OperationName }}\",\"ServiceName\":\"{{ $ServiceName }}\",\"AuditKeyValues\":[{\"Key\":\"{{ $Key }}\",\"ValueString\":\"{{ $ValueString }}\"}],\"UTCTimestamp\":1686849556,\"Attributes\":{\"detection_id\":\"{{ $detection_id }}\"}{{- else if eq $metadata_eventType "ScheduledReportNotificationEvent" }}\"UserUUID\":\"{{ $UserUUID }}\",\"UserID\":\"{{ $UserID }}\",\"ExecutionID\":\"{{ $ExecutionID }}\",\"ReportID\":\"{{ $ReportID }}\",\"ReportName\":\"{{ $ReportName }}\",\"ReportType\":\"{{ $ReportType }}\",\"ReportFileReference\":\"{{ $ReportFileReference }}\",\"Status\":\"{{ $Status }}\",\"StatusMessage\":\"{{ $StatusMessage }}\",\"ExecutionMetadata\":{\"ExecutionStart\":{{ $ExecutionStart }},\"ExecutionDuration\":{{ $ExecutionDuration }},\"ReportFileName\":\"{{ $ReportFileName }}\",\"ResultCount\":{{ $ResultCount }},\"ResultID\":\"{{ $ResultID }}\",\"SearchWindowStart\":{{ $SearchWindowStart }},\"SearchWindowEnd\":{{ $SearchWindowEnd }}}{{- else if eq $metadata_eventType "RemoteResponseSessionStartEvent" }}\"SessionId\":\"{{ $SessionId }}\",\"HostnameField\":\"{{ $HostnameField }}\",\"UserName\":\"{{ $UserName }}\",\"StartTimestamp\":1582830734,\"AgentIdString\":\"{{ $AgentIdString }}\"{{- else if eq $metadata_eventType "IncidentSummaryEvent" }}\"IncidentStartTime\":1685844891,\"IncidentEndTime\":1685844891,\"FalconHostLink\":\"{{ $FalconHostLink }}\",\"State\":\"{{ $IncidentState }}\",\"FineScore\":{{ $FineScore }},\"LateralMovement\":{{ $LateralMovement }},\"IncidentType\":{{ $IncidentType }},\"IncidentID\":\"{{ $IncidentID }}\",\"HostID\":\"{{ $HostID }}\",\"LMHostIDs\":[\"{{ $LMHostIDs }}\"],\"UserId\":\"{{ $UserId }}\"{{- else if eq $metadata_eventType "CSPMIOAStreamingEvent" }}\"AccountId\":\"{{ $AccountId }}\",\"PolicyId\":{{ $PolicyId }},\"PolicyStatement\":\"{{ $PolicyStatement }}\",\"CloudProvider\":\"{{ $CloudProvider }}\",\"CloudService\":\"{{ $CloudService }}\",\"Severity\":{{ $Severity }},\"SeverityName\":\"{{ $SeverityName }}\",\"EventAction\":\"{{ $EventAction }}\",\"EventSource\":\"{{ $EventSource }}\",\"EventCreatedTimestamp\":1663011160,\"UserId\":\"{{ $UserId }}\",\"UserName\":\"{{ $UserName }}\",\"UserSourceIp\":\"{{ $UserSourceIp }}\",\"Tactic\":\"{{ $Tactic }}\",\"Technique\":\"{{ $Technique }}\"{{- else if eq $metadata_eventType "CSPMSearchStreamingEvent" }}\"AccountId\":\"{{ $AccountId }}\",\"Region\":\"{{ $Region }}\",\"ResourceId\":\"{{ $ResourceId }}\",\"ResourceIdType\":\"{{ $ResourceIdType }}\",\"ResourceName\":\"{{ $ResourceName }}\",\"ResourceCreateTime\":0,\"PolicyStatement\":\"{{ $PolicyStatement }}\",\"PolicyId\":{{ $PolicyId }},\"Severity\":{{ $Severity }},\"SeverityName\":\"{{ $SeverityName }}\",\"CloudPlatform\":\"{{ $CloudPlatform }}\",\"CloudService\":\"{{ $CloudService }}\",\"Disposition\":\"{{ $Disposition }}\",\"ResourceUrl\":\"{{ $ResourceUrl }}\",\"Finding\":\"{{ $Finding }}\",\"Tags\":[{\"Key\":\"{{ $Key }}\",\"ValueString\":\"{{ $ValueString }}\"}],\"ReportUrl\":\"{{ $ReportUrl }}\",\"Timestamp\":1751371830{{- else if eq $metadata_eventType "MobileDetectionSummaryEvent" }}\"SensorId\":\"{{ $SensorId }}\",\"MobileDetectionId\":{{ $MobileDetectionId }},\"ComputerName\":\"{{ $ComputerName }}\",\"UserName\":\"{{ $UserName }}\",\"ContextTimeStamp\":1649061056,\"DetectId\":\"{{ $DetectId }}\",\"DetectName\":\"{{ $DetectName }}\",\"DetectDescription\":\"{{ $DetectDescription }}\",\"Tactic\":\"{{ $Tactic }}\",\"TacticId\":\"{{ $TacticId }}\",\"Technique\":\"{{ $Technique }}\",\"TechniqueId\":\"{{ $TechniqueId }}\",\"Objective\":\"{{ $Objective }}\",\"Severity\":{{ $Severity }},\"FalconHostLink\":\"https://falcon.crowdstrike.com/activity-v2/detections/{{ $FalconHostLink }}?_cid=xxxxxxx\",\"MobileAppsDetails\":[{\"AppIdentifier\":\"{{ $AppIdentifier }}\",\"AndroidAppLabel\":\"{{ $AndroidAppLabel }}\",\"DexFileHashes\":\"{{ $DexFileHashes }}\",\"ImageFileName\":\"{{ $ImageFileName }}\",\"AppInstallerInformation\":\"{{ $AppInstallerInformation }}\",\"IsBeingDebugged\":{{ $IsBeingDebugged }},\"AndroidAppVersionName\":\"{{ $AndroidAppVersionName }}\",\"IsContainerized\":{{ $IsContainerized }}}]{{- else if eq $metadata_eventType "ReconNotificationSummaryEvent" }}\"NotificationId\":\"{{ $NotificationId }}\",\"Highlights\":[\"{{ $Highlights }}\"],\"MatchedTimestamp\":1686889114000,\"RuleId\":\"{{ $RuleId }}\",\"RuleName\":\"{{ $RuleName }}\",\"RuleTopic\":\"{{ $RuleTopic }}\",\"RulePriority\":\"{{ $RulePriority }}\",\"ItemId\":\"{{ $ItemId }}\",\"ItemType\":\"{{ $ItemType }}\",\"ItemPostedTimestamp\":1686889114000{{- else if eq $metadata_eventType "XdrDetectionSummaryEvent" }}\"Author\":\"{{ $Author }}\",\"DataDomains\":\"{{ $DataDomains }}\",\"Description\":\"{{ $Description }}\",\"DetectId\":\"{{ $DetectId }}\",\"EndTimeEpoch\":1643317697728000000,\"IPv4Addresses\":\"{{ $IPv4Addresses }}\",\"HostNames\":\"{{ $HostNames }}\",\"Name\":\"{{ $Name }}\",\"PatternId\":{{ $PatternId }},\"Severity\":{{ $Severity }},\"SourceProducts\":\"{{ $SourceProducts }}\",\"SourceVendors\":\"{{ $SourceVendors }}\",\"StartTimeEpoch\":1643317697728000000,\"TacticIds\":\"{{ $TacticIds }}\",\"Tactics\":\"{{ $Tactics }}\",\"TechniqueIds\":\"{{ $TechniqueIds }}\",\"Techniques\":\"{{ $Techniques }}\",\"XdrType\":\"{{ $XdrType }}\"{{end}}}}",
    "event": {
        "dataset": "crowdstrike.falcon"
    },
    "input": {
        "type": "streaming"
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "crowdstrike-falcon"
    ]
}
