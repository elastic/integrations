{{- $device_id := generate "device_id" }}
{{- $cid := generate "cid" }}
{{- $agent_load_flags := generate "agent_load_flags" }}
{{- $agent_local_time := generate "agent_local_time" | date "2006-01-02T15:04:05.000Z" }}
{{- $bios_manufacturer := generate "bios_manufacturer" }}
{{- $bios_version := generate "bios_version" }}
{{- $build_number := generate "build_number" }}
{{- $config_id_base := generate "config_id_base" }}
{{- $config_id_build := generate "config_id_build" }}
{{- $config_id_platform := generate "config_id_platform" }}
{{- $cpu_signature := generate "cpu_signature" }}
{{- $cpu_vendor := generate "cpu_vendor" }}
{{- $external_ip := generate "external_ip" }}
{{- $mac_address := generate "mac_address" }}
{{- $hostname := generate "hostname" }}
{{- $filesystem_containment_status := generate "filesystem_containment_status" }}
{{- $first_seen := generate "first_seen" | date "2006-01-02T15:04:05.00Z" }}
{{- $last_login_timestamp := generate "last_login_timestamp" | date "2006-01-02T15:04:05.00Z" }}
{{- $last_login_user := generate "last_login_user" }}
{{- $last_login_user_sid := generate "last_login_user_sid" }}
{{- $last_seen := generate "last_seen" | date "2006-01-02T15:04:05.00Z" }}
{{- $local_ip := generate "local_ip" }}
{{- $machine_domain := generate "machine_domain" }}
{{- $major_version := generate "major_version" }}
{{- $minor_version := generate "minor_version" }}
{{- $os_version := generate "os_version" }}
{{- $os_build := generate "os_build" }}
{{- $platform_id := generate "platform_id" }}
{{- $platform_name := generate "platform_name" }}
{{- $policy_type := generate "policies.policy_type" }}
{{- $policy_id := generate "policies.policy_id" }}
{{- $applied := generate "policies.applied" }}
{{- $settings_hash := generate "policies.settings_hash" }}
{{- $assigned_date := generate "policies.assigned_date" | date "2006-01-02T15:04:05.000000000Z" }}
{{- $applied_date := generate "policies.applied_date" | date "2006-01-02T15:04:05.000000000Z" }}
{{- $reduced_functionality_mode := generate "reduced_functionality_mode" }}
{{- $rtr_state := generate "rtr_state" }}
{{- $ou := generate "ou" }}
{{- $groups := generate "groups" }}
{{- $group_hash := generate "group_hash" }}
{{- $product_type := generate "product_type" }}
{{- $product_type_desc := generate "product_type_desc" }}
{{- $provision_status := generate "provision_status" }}
{{- $serial_number := generate "serial_number" }}
{{- $service_pack_minor := generate "service_pack_minor" }}
{{- $pointer_size := generate "pointer_size" }}
{{- $status := generate "status" }}
{{- $system_manufacturer := generate "system_manufacturer" }}
{{- $system_product_name := generate "system_product_name" }}
{{- $tags := generate "tags" }}
{{- $modified_timestamp := generate "modified_timestamp" | date "2006-01-02T15:04:05.00Z" }}
{{- $version := generate "meta.version" }}
{{- $version_string := generate "meta.version_string" }}
{{- $os_product_name := generate "os_product_name" }}
{{- $chassis_type := generate "chassis_type" }}
{{- $chassis_type_desc := generate "chassis_type_desc" }}
{{- $last_reboot := generate "last_reboot" | date "2006-01-02T15:04:05.00Z" }}
{{- $connection_ip := generate "connection_ip" }}
{{- $default_gateway_ip := generate "default_gateway_ip" }}
{{- $timestamp := generate "timestamp" }}
{{- /*
{
  "device_id": "{{ $device_id }}",
  "cid": "{{ $cid }}",
  "agent_load_flags": "{{ $agent_load_flags }}",
  "agent_local_time": "{{ $agent_local_time }}",
  "agent_version": "7.22.19406.0",
  "bios_manufacturer": "{{ $bios_manufacturer }}",
  "bios_version": "{{ $bios_version }}",
  "build_number": "{{ $build_number }}",
  "config_id_base": "{{ $config_id_base }}",
  "config_id_build": "{{ $config_id_build }}",
  "config_id_platform": "{{ $config_id_platform }}",
  "cpu_signature": "{{ $cpu_signature }}",
  "cpu_vendor": "{{ $cpu_vendor }}",
  "external_ip": "{{ $external_ip }}",
  "mac_address": "{{ $mac_address }}",
  "hostname": "{{ $hostname }}",
  "filesystem_containment_status": "{{ $filesystem_containment_status }}",
  "first_seen": "{{ $first_seen }}",
  "last_login_timestamp": "{{ $last_login_timestamp }}",
  "last_login_user": "{{ $last_login_user }}",
  "last_login_user_sid": "{{ $last_login_user_sid }}",
  "last_seen": "{{ $last_seen }}",
  "local_ip": "{{ $local_ip }}",
  "machine_domain": "{{ $machine_domain }}",
  "major_version": "{{ $major_version }}",
  "minor_version": "{{ $minor_version }}",
  "os_version": "{{ $os_version }}",
  "os_build": "{{ $os_build }}",
  "platform_id": "{{ $platform_id }}",
  "platform_name": "{{ $platform_name }}",
  "policies": [
    {
      "policy_type": "{{ $policy_type }}",
      "policy_id": "{{ $policy_id }}",
      "applied": {{ $applied }},
      "settings_hash": "{{ $settings_hash }}",
      "assigned_date": "{{ $assigned_date }}",
      "applied_date": "{{ $applied_date }}"
    }
  ],
  "reduced_functionality_mode": "{{ $reduced_functionality_mode }}",
  "rtr_state": "{{ $rtr_state }}",
  "device_policies": {
    "prevention": {
      "policy_type": "prevention",
      "policy_id": "{{ $policy_id }}",
      "applied": {{ $applied }},
      "settings_hash": "{{ $settings_hash }}",
      "assigned_date": "{{ $assigned_date }}",
      "applied_date": "{{ $applied_date }}"
    },
    "sensor_update": {
      "policy_type": "sensor_update",
      "policy_id": "{{ $policy_id }}",
      "applied": {{ $applied }},
      "settings_hash": "{{ $settings_hash }}",
      "assigned_date": "{{ $assigned_date }}",
      "applied_date": "{{ $applied_date }}"
    },
    "device_control": {
      "policy_type": "device_control",
      "policy_id": "{{ $policy_id }}",
      "applied": {{ $applied }},
      "settings_hash": "{{ $settings_hash }}",
      "assigned_date": "{{ $assigned_date }}",
      "applied_date": "{{ $applied_date }}"
    },
    "global_config": {
      "policy_type": "global_config",
      "policy_id": "{{ $policy_id }}",
      "applied": {{ $applied }},
      "settings_hash": "{{ $settings_hash }}",
      "assigned_date": "{{ $assigned_date }}",
      "applied_date": "{{ $applied_date }}"
    }
  },
  "ou": [
    "{{ $ou }}"
  ],
  "groups": [
    "{{ $groups }}"
  ],
  "group_hash": "{{ $group_hash }}",
  "product_type": "{{ $product_type }}",
  "product_type_desc": "{{ $product_type_desc }}",
  "provision_status": "{{ $provision_status }}",
  "serial_number": "{{ $serial_number }}",
  "service_pack_minor": "{{ $service_pack_minor }}",
  "pointer_size": "{{ $pointer_size }}",
  "status": "{{ $status }}",
  "system_manufacturer": "{{ $system_manufacturer }}",
  "system_product_name": "{{ $system_product_name }}",
  "tags": [
    "{{ $tags }}"
  ],
  "modified_timestamp": "{{ $modified_timestamp }}",
  "meta": {
    "version": "{{ $version }}",
    "version_string": "{{ $version_string }}"
  },
  "kernel_version": "10.0.14393.693",
  "os_product_name": "{{ $os_product_name }}",
  "chassis_type": "{{ $chassis_type }}",
  "chassis_type_desc": "{{ $chassis_type_desc }}",
  "last_reboot": "{{ $last_reboot }}",
  "connection_ip": "{{ $connection_ip }}",
  "default_gateway_ip": "{{ $default_gateway_ip }}",
  "connection_mac_address": "{{ $mac_address }}"
}
*/ -}}
{
    "@timestamp": "{{ $timestamp.Format "2006-01-02T15:04:05.999999Z07:00" }}",
    "agent": {
        "ephemeral_id": "cdaaaabb-be7e-432f-816b-bda019fd7c15",
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.18.0"
    },
    "data_stream": {
        "dataset": "crowdstrike.host",
        "namespace": "93724",
        "type": "logs"
    },
    "elastic_agent": {
        "id": "da6cb4c8-c84c-4c5f-97c7-f8586a098af4",
        "snapshot": false,
        "version": "8.18.0"
    },
    "message": "{\"device_id\":\"{{ $device_id }}\",\"cid\":\"{{ $cid }}\",\"agent_load_flags\":\"{{ $agent_load_flags }}\",\"agent_local_time\":\"{{ $agent_local_time }}\",\"agent_version\":\"7.22.19406.0\",\"bios_manufacturer\":\"{{ $bios_manufacturer }}\",\"bios_version\":\"{{ $bios_version }}\",\"build_number\":\"{{ $build_number }}\",\"config_id_base\":\"{{ $config_id_base }}\",\"config_id_build\":\"{{ $config_id_build }}\",\"config_id_platform\":\"{{ $config_id_platform }}\",\"cpu_signature\":\"{{ $cpu_signature }}\",\"cpu_vendor\":\"{{ $cpu_vendor }}\",\"external_ip\":\"{{ $external_ip }}\",\"mac_address\":\"{{ $mac_address }}\",\"hostname\":\"{{ $hostname }}\",\"filesystem_containment_status\":\"{{ $filesystem_containment_status }}\",\"first_seen\":\"{{ $first_seen }}\",\"last_login_timestamp\":\"{{ $last_login_timestamp }}\",\"last_login_user\":\"{{ $last_login_user }}\",\"last_login_user_sid\":\"{{ $last_login_user_sid }}\",\"last_seen\":\"{{ $last_seen }}\",\"local_ip\":\"{{ $local_ip }}\",\"machine_domain\":\"{{ $machine_domain }}\",\"major_version\":\"{{ $major_version }}\",\"minor_version\":\"{{ $minor_version }}\",\"os_version\":\"{{ $os_version }}\",\"os_build\":\"{{ $os_build }}\",\"platform_id\":\"{{ $platform_id }}\",\"platform_name\":\"{{ $platform_name }}\",\"policies\":[{\"policy_type\":\"{{ $policy_type }}\",\"policy_id\":\"{{ $policy_id }}\",\"applied\":{{ $applied }},\"settings_hash\":\"{{ $settings_hash }}\",\"assigned_date\":\"{{ $assigned_date }}\",\"applied_date\":\"{{ $applied_date }}\"}],\"reduced_functionality_mode\":\"{{ $reduced_functionality_mode }}\",\"rtr_state\":\"{{ $rtr_state }}\",\"device_policies\":{\"prevention\":{\"policy_type\":\"prevention\",\"policy_id\":\"{{ $policy_id }}\",\"applied\":{{ $applied }},\"settings_hash\":\"{{ $settings_hash }}\",\"assigned_date\":\"{{ $assigned_date }}\",\"applied_date\":\"{{ $applied_date }}\"},\"sensor_update\":{\"policy_type\":\"sensor_update\",\"policy_id\":\"{{ $policy_id }}\",\"applied\":{{ $applied }},\"settings_hash\":\"{{ $settings_hash }}\",\"assigned_date\":\"{{ $assigned_date }}\",\"applied_date\":\"{{ $applied_date }}\"},\"device_control\":{\"policy_type\":\"device_control\",\"policy_id\":\"{{ $policy_id }}\",\"applied\":{{ $applied }},\"settings_hash\":\"{{ $settings_hash }}\",\"assigned_date\":\"{{ $assigned_date }}\",\"applied_date\":\"{{ $applied_date }}\"},\"global_config\":{\"policy_type\":\"global_config\",\"policy_id\":\"{{ $policy_id }}\",\"applied\":{{ $applied }},\"settings_hash\":\"{{ $settings_hash }}\",\"assigned_date\":\"{{ $assigned_date }}\",\"applied_date\":\"{{ $applied_date }}\"}},\"ou\":[\"{{ $ou }}\"],\"groups\":[\"{{ $groups }}\"],\"group_hash\":\"{{ $group_hash }}\",\"product_type\":\"{{ $product_type }}\",\"product_type_desc\":\"{{ $product_type_desc }}\",\"provision_status\":\"{{ $provision_status }}\",\"serial_number\":\"{{ $serial_number }}\",\"service_pack_minor\":\"{{ $service_pack_minor }}\",\"pointer_size\":\"{{ $pointer_size }}\",\"status\":\"{{ $status }}\",\"system_manufacturer\":\"{{ $system_manufacturer }}\",\"system_product_name\":\"{{ $system_product_name }}\",\"tags\":[\"{{ $tags }}\"],\"modified_timestamp\":\"{{ $modified_timestamp }}\",\"meta\":{\"version\":\"{{ $version }}\",\"version_string\":\"{{ $version_string }}\"},\"kernel_version\":\"10.0.14393.693\",\"os_product_name\":\"{{ $os_product_name }}\",\"chassis_type\":\"{{ $chassis_type }}\",\"chassis_type_desc\":\"{{ $chassis_type_desc }}\",\"last_reboot\":\"{{ $last_reboot }}\",\"connection_ip\":\"{{ $connection_ip }}\",\"default_gateway_ip\":\"{{ $default_gateway_ip }}\",\"connection_mac_address\":\"{{ $mac_address }}\"}",
    "event": {
        "dataset": "crowdstrike.host"
    },
    "input": {
        "type": "cel"
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "crowdstrike-host"
    ]
}
