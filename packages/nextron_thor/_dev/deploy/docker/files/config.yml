rules:
  - path: "/v1/scan/search"
    methods: ['GET']
    query_params:
      limit: 10
      order_dir: ASC
      order_field: last_launcher_update
    request_headers:
      Authorization:
        - "xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          { "data": [ { "id": "9bd91102-398c-4a19-986a-e664411d5ba1", "campaign_id": "2b054111-bad7-4bac-a14e-8fa8a88f1111", "scanner_id": "b3691137-493e-4861-ad14-c02c02c21111", "creation_date": 1761779601, "modification_date": 1761780194, "last_launcher_update": 1761780194, "stage": "successful", "status": "successful", "stage_status": "good", "hostname": "myhostname", "os": "linux", "os_version": "Ubuntu 22.04.5 LTS", "architecture": "amd64", "progress": null, "admin_rights": true, "log_levels": { "alerts": 2, "warnings": 1, "notices": 47, "infos": 708, "errors": 0 }, "runtime": 592, "thor_version": "10.7.24", "signature_version": "25.10.27-143342", "thor_args": "", "custom_ioc_count": 0, "latest_host_scan": true, "logs_encrypted": false, "available_logs": [ "launcher.log", "thor.json", "thor.html", "thor.log" ], "disposed": false, "launcher_type": "executable" } ], "total": 1}
  - path: /v1/scan/log
    methods: ['GET']
    query_params:
      scan: "9bd91102-398c-4a19-986a-e664411d5ba1"
      log: "thor.json"
    request_headers:
      Authorization:
        - "xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"time":"2025-11-10T17:52:49Z","hostname":"myhostname","level":"Info","module":"AtJobs","message":"At Job detected","scanid":"S-VavZi0stuDo","job":"C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Task Manager\\Interactive","command":"","start":"","user":"","runlevel":"","logontype":"","files":null,"log_version":"v2.0.0"}
          {"time":"2025-11-10T17:52:49Z","hostname":"myhostname","level":"Info","module":"AtJobs","message":"At Job detected","scanid":"S-VavZi0stuDo","job":"C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\TextServicesFramework\\MsCtfMonitor","command":"","start":"","user":"","runlevel":"","logontype":"","files":null,"log_version":"v2.0.0"}
          {"time":"2025-11-10T17:52:49Z","hostname":"myhostname","level":"Info","module":"AtJobs","message":"At Job detected","scanid":"S-VavZi0stuDo","job":"C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Time Synchronization\\ForceSynchronizeTime","command":"","start":"","user":"S-1-5-19","runlevel":"HighestAvailable","logontype":"","files":null,"log_version":"v2.0.0"}
          {"time":"2025-11-10T17:52:49Z","hostname":"myhostname","level":"Info","module":"AtJobs","message":"At Job detected","scanid":"S-VavZi0stuDo","job":"C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Time Synchronization\\SynchronizeTime","command":"%windir%\\system32\\sc.exe","start":"","user":"S-1-5-19","runlevel":"HighestAvailable","logontype":"","files":[{"path":"C:\\Windows\\system32\\sc.exe","exists":"yes","type":"EXE","size":94208,"md5":"6fb10cd439b40d92935f8f6a0c99670a","sha1":"75881652f0f9384de229ab396bf27f1dda244bbc","sha256":"2bf663ea493cdc21ad33aebd8da40cc5d2afa55e24f9e1bbf3d73e99dcadf693","firstbytes":"4d5a90000300000004000000ffff0000b8000000 / MZ","created":"2021-05-08T08:14:42.705148Z","owner":"NT SERVICE\\TrustedInstaller","company":"Microsoft Corporation","desc":"Service Control Manager Configuration Tool","legal_copyright":"© Microsoft Corporation. All rights reserved.","product":"Microsoft® Windows® Operating System","original_name":"sc.exe.mui","internal_name":"sc.exe","imphash":"803254e010814e69947095a2725b2afd"}],"log_version":"v2.0.0"}
          {"time":"2025-11-10T17:52:49Z","hostname":"myhostname","level":"Info","module":"AtJobs","message":"At Job detected","scanid":"S-VavZi0stuDo","job":"C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Time Zone\\SynchronizeTimeZone","command":"%windir%\\system32\\tzsync.exe","start":"","user":"S-1-5-18","runlevel":"HighestAvailable","logontype":"","files":[{"path":"C:\\Windows\\system32\\tzsync.exe","exists":"yes","type":"EXE","size":70656,"md5":"5f35acc7c00591d50552ef7bbf02c99a","sha1":"edcad90f35fe8e5c4ddf3536e9993805ff42753a","sha256":"f881114ac5e2600cfb5f90ba448f46b484e56e9882b963d81f7d39955b3215be","firstbytes":"4d5a90000300000004000000ffff0000b8000000 / MZ","created":"2021-05-08T08:14:40.3301066Z","owner":"NT SERVICE\\TrustedInstaller","company":"Microsoft Corporation","desc":"TimeZone Sync Task","legal_copyright":"© Microsoft Corporation. All rights reserved.","product":"Microsoft® Windows® Operating System","original_name":"tzsync.exe","internal_name":"tzsync.exe","imphash":"-"}],"log_version":"v2.0.0"}
          {"time":"2025-11-10T17:52:49Z","hostname":"myhostname","level":"Info","module":"AtJobs","message":"At Job detected","scanid":"S-VavZi0stuDo","job":"C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\UPnP\\UPnPHostConfig","command":"sc.exe","start":"","user":"S-1-5-18","runlevel":"","logontype":"","files":null,"log_version":"v2.0.0"}
          {"time":"2025-11-10T17:52:49Z","hostname":"myhostname","level":"Info","module":"AtJobs","message":"At Job detected","scanid":"S-VavZi0stuDo","job":"C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\UpdateOrchestrator\\Report policies","command":"%systemroot%\\system32\\usoclient.exe","start":"","user":"S-1-5-18","runlevel":"","logontype":"","files":[{"path":"C:\\Windows\\system32\\usoclient.exe","exists":"yes","type":"EXE","size":90112,"md5":"1feddb97cdc1d931766010363f9b945e","sha1":"b3837bc524fb8d1c67025d7fa90c30c0a4a7657d","sha256":"0eccf139a5c8f2dcb8dd648eff85c42309456ea74ee90fae9adab4fb06968006","firstbytes":"4d5a90000300000004000000ffff0000b8000000 / MZ","created":"2025-09-12T18:15:53.5554443Z","owner":"NT SERVICE\\TrustedInstaller","company":"Microsoft Corporation","desc":"UsoClient","legal_copyright":"© Microsoft Corporation. All rights reserved.","product":"Microsoft® Windows® Operating System","original_name":"UsoClient","internal_name":"UsoClient","imphash":"59970db1d5ef76d2ab92ae1bf6482723"}],"log_version":"v2.0.0"}
          {"time":"2025-11-10T17:52:49Z","hostname":"myhostname","level":"Info","module":"AtJobs","message":"At Job detected","scanid":"S-VavZi0stuDo","job":"C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\UpdateOrchestrator\\Schedule Maintenance Work","command":"%systemroot%\\system32\\usoclient.exe","start":"","user":"S-1-5-18","runlevel":"","logontype":"","files":[{"path":"C:\\Windows\\system32\\usoclient.exe","exists":"yes","type":"EXE","size":90112,"md5":"1feddb97cdc1d931766010363f9b945e","sha1":"b3837bc524fb8d1c67025d7fa90c30c0a4a7657d","sha256":"0eccf139a5c8f2dcb8dd648eff85c42309456ea74ee90fae9adab4fb06968006","firstbytes":"4d5a90000300000004000000ffff0000b8000000 / MZ","created":"2025-09-12T18:15:53.5554443Z","owner":"NT SERVICE\\TrustedInstaller","company":"Microsoft Corporation","desc":"UsoClient","legal_copyright":"© Microsoft Corporation. All rights reserved.","product":"Microsoft® Windows® Operating System","original_name":"UsoClient","internal_name":"UsoClient","imphash":"59970db1d5ef76d2ab92ae1bf6482723"}],"log_version":"v2.0.0"}
          {"time":"2025-11-10T17:52:49Z","hostname":"myhostname","level":"Info","module":"AtJobs","message":"At Job detected","scanid":"S-VavZi0stuDo","job":"C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\UpdateOrchestrator\\Schedule Scan","command":"%systemroot%\\system32\\usoclient.exe","start":"2019-01-01T12:00:00","user":"S-1-5-18","runlevel":"LeastPrivilege","logontype":"","files":[{"path":"C:\\Windows\\system32\\usoclient.exe","exists":"yes","type":"EXE","size":90112,"md5":"1feddb97cdc1d931766010363f9b945e","sha1":"b3837bc524fb8d1c67025d7fa90c30c0a4a7657d","sha256":"0eccf139a5c8f2dcb8dd648eff85c42309456ea74ee90fae9adab4fb06968006","firstbytes":"4d5a90000300000004000000ffff0000b8000000 / MZ","created":"2025-09-12T18:15:53.5554443Z","owner":"NT SERVICE\\TrustedInstaller","company":"Microsoft Corporation","desc":"UsoClient","legal_copyright":"© Microsoft Corporation. All rights reserved.","product":"Microsoft® Windows® Operating System","original_name":"UsoClient","internal_name":"UsoClient","imphash":"59970db1d5ef76d2ab92ae1bf6482723"}],"log_version":"v2.0.0"}
          {"time":"2025-11-10T17:52:49Z","hostname":"myhostname","level":"Info","module":"AtJobs","message":"At Job detected","scanid":"S-VavZi0stuDo","job":"C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\UpdateOrchestrator\\Schedule Scan Static Task","command":"%systemroot%\\system32\\usoclient.exe","start":"","user":"S-1-5-18","runlevel":"","logontype":"","files":[{"path":"C:\\Windows\\system32\\usoclient.exe","exists":"yes","type":"EXE","size":90112,"md5":"1feddb97cdc1d931766010363f9b945e","sha1":"b3837bc524fb8d1c67025d7fa90c30c0a4a7657d","sha256":"0eccf139a5c8f2dcb8dd648eff85c42309456ea74ee90fae9adab4fb06968006","firstbytes":"4d5a90000300000004000000ffff0000b8000000 / MZ","created":"2025-09-12T18:15:53.5554443Z","owner":"NT SERVICE\\TrustedInstaller","company":"Microsoft Corporation","desc":"UsoClient","legal_copyright":"© Microsoft Corporation. All rights reserved.","product":"Microsoft® Windows® Operating System","original_name":"UsoClient","internal_name":"UsoClient","imphash":"59970db1d5ef76d2ab92ae1bf6482723"}],"log_version":"v2.0.0"}
