# Nextron Thor APT Scanner

[Nextron Thor APT Scanner](https://www.nextron-systems.com/thor/) is a powerful threat hunting and incident response tool that provides comprehensive scanning capabilities for detecting advanced persistent threats (APTs), malware, and security vulnerabilities across Windows systems. The Nextron Thor APT Scanner integration enables you to consume and analyze Thor Cloud scan results within Elastic Security, providing centralized visibility into threat detection findings and facilitating automated incident response workflows.

## Data streams

The Nextron Thor APT Scanner integration collects one type of data:

- **Thor Forwarding** - Scan results and findings from Thor Cloud API, including detected threats, malware signatures, suspicious files, and security events identified during system scans.

## Requirements

This integration supports Elastic Agent-based data collection.

### Elastic Agent

Elastic Agent must be installed. For more details, check the Elastic Agent [installation instructions](docs-content://reference/fleet/install-elastic-agents.md).

The minimum **kibana.version** required is **9.1.3**.

This integration has been tested against the **Nextron Thor Cloud API**.

## Setup

### Get the Thor Cloud API URL

1. Access your Nextron Thor Cloud dashboard.
2. Navigate to the API settings section.
3. Copy the **API Endpoint URL** (default: `https://thor-cloud.nextron-services.com/api`).

### Get the API Key

1. In the Thor Cloud dashboard, navigate to **General Settings** > **API Key**.
2. Click **Generate**.
4. Copy the generated API key. You won't be able to copy it after this stage.

### Enable the integration in Elastic

1. In Kibana navigate to **Management** > **Integrations**.
2. In the search top bar, type **Nextron Thor APT Scanner**.
3. Select the **Nextron Thor APT Scanner** integration and add it.
4. Configure the required integration parameters:
   - **API URL**: The Thor Cloud API endpoint URL
   - **API Key**: Your Thor Cloud API key
   - **Initial Interval**: How far back to pull scan logs (default: 24h)
   - **Interval**: Duration between API requests (default: 5m)
5. Save the integration.

**Note:**
- Scan data is fetched based on the configured initial interval and polling frequency.
- The integration supports batch processing with configurable batch sizes for optimal performance.

## How do I deploy this integration?

### Agent-based deployment

Elastic Agent must be installed. For more details, check the Elastic Agent [installation instructions](docs-content://reference/fleet/install-elastic-agents.md). You can install only one Elastic Agent per host.

Elastic Agent is required to stream data from the syslog or log file receiver and ship the data to Elastic, where the events will then be processed via the integration's ingest pipelines.

### Onboard / configure

To completely set up the Nextron Thor APT Scanner integration:

1. **Prepare Thor Cloud Access**
   - Log into your Nextron Thor Cloud dashboard
   - Generate an API key from General Settings > API Key
   - Note your API endpoint URL

2. **Install Elastic Agent**
   - Follow the [Elastic Agent installation guide](docs-content://reference/fleet/install-elastic-agents.md)
   - Ensure the agent is properly enrolled in Fleet

3. **Add the Integration**
   - Navigate to Kibana > Management > Integrations
   - Search for "Nextron Thor APT Scanner"
   - Click "Add Nextron Thor APT Scanner"

4. **Configure Integration Settings**
   - Enter your Thor Cloud API URL
   - Provide your API key
   - Set initial interval (recommended: 24h for first run)
   - Configure polling interval (recommended: 5m)
   - Adjust batch size if needed (default: 100)

5. **Deploy Configuration**
   - Review all settings
   - Save and deploy the integration
   - Monitor the agent logs for successful connection


## Exported fields
**Exported fields**

| Field | Description | Type |
|---|---|---|
| @timestamp | Date/time when the event originated. This is the date/time extracted from the event, typically representing when the event was generated by the source. If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline. Required field for all events. | date |
| data_stream.dataset | The field can contain anything that makes sense to signify the source of the data. Examples include `nginx.access`, `prometheus`, `endpoint` etc. For data streams that otherwise fit, but that do not have dataset set we use the value "generic" for the dataset value. `event.dataset` should have the same value as `data_stream.dataset`. Beyond the Elasticsearch data stream naming criteria noted above, the `dataset` value has additional restrictions:   \* Must not contain `-`   \* No longer than 100 characters | constant_keyword |
| data_stream.namespace | A user defined namespace. Namespaces are useful to allow grouping of data. Many users already organize their indices this way, and the data stream naming scheme now provides this best practice as a default. Many users will populate this field with `default`. If no value is used, it falls back to `default`. Beyond the Elasticsearch index naming criteria noted above, `namespace` value has the additional restrictions:   \* Must not contain `-`   \* No longer than 100 characters | constant_keyword |
| data_stream.type | An overarching type for the data stream. Currently allowed values are "logs" and "metrics". We expect to also add "traces" and "synthetics" in the near future. | constant_keyword |
| ecs.version | ECS version this event conforms to. `ecs.version` is a required field and must exist in all events. When querying across multiple indices -- which may conform to slightly different ECS versions -- this field lets integrations adjust to the schema version of the events. | keyword |
| event.category | This is one of four ECS Categorization Fields, and indicates the second level in the ECS category hierarchy. `event.category` represents the "big buckets" of ECS categories. For example, filtering on `event.category:process` yields all events relating to process activity. This field is closely related to `event.type`, which is used as a subcategory. This field is an array. This will allow proper categorization of some events that fall in multiple categories. | keyword |
| event.kind | This is one of four ECS Categorization Fields, and indicates the highest level in the ECS category hierarchy. `event.kind` gives high-level information about what type of information the event contains, without being specific to the contents of the event. For example, values of this field distinguish alert events from metric events. The value of this field can be used to inform how these kinds of events should be handled. They may warrant different retention, different access control, it may also help understand whether the data is coming in at a regular interval or not. | keyword |
| event.type | This is one of four ECS Categorization Fields, and indicates the third level in the ECS category hierarchy. `event.type` represents a categorization "sub-bucket" that, when used along with the `event.category` field values, enables filtering events down to a level appropriate for single visualization. This field is an array. This will allow proper categorization of some events that fall in multiple event types. | keyword |
| file.accessed | Last time the file was accessed. Note that not all filesystems keep track of access time. | date |
| file.ctime | Last time the file attributes or metadata changed. Note that changes to the file content will update `mtime`. This implies `ctime` will be adjusted at the same time, since `mtime` is an attribute of the file. | date |
| file.group | Primary group name of the file. | keyword |
| file.hash.md5 | MD5 hash. | keyword |
| file.hash.sha1 | SHA1 hash. | keyword |
| file.hash.sha256 | SHA256 hash. | keyword |
| file.mtime | Last time the file content was modified. | date |
| file.name | Name of the file including the extension, without the directory. | keyword |
| file.owner | File owner's username. | keyword |
| file.path | Full path to the file, including the file name. It should include the drive letter, when appropriate. | keyword |
| file.path.text | Multi-field of `file.path`. | match_only_text |
| file.size | File size in bytes. Only relevant when `file.type` is "file". | long |
| input.type | Input type | keyword |
| log.level | Original log level of the log event. If the source of the event provides a log level or textual severity, this is the one that goes in `log.level`. If your source doesn't specify one, you may put your event transport's severity here (e.g. Syslog severity). Some examples are `warn`, `err`, `i`, `informational`. | keyword |
| message | For log events the message field contains the log message, optimized for viewing in a log viewer. For structured logs without an original message field, other fields can be concatenated to form a human-readable summary of the event. If multiple messages exist, they can be combined into one message. | match_only_text |
| tags | List of keywords used to tag each event. | keyword |
| thor.alerts |  | float |
| thor.command |  | keyword |
| thor.connection_count |  | float |
| thor.created |  | keyword |
| thor.description |  | keyword |
| thor.duration |  | keyword |
| thor.enabled |  | keyword |
| thor.entry |  | keyword |
| thor.errors |  | float |
| thor.event_consumer |  | keyword |
| thor.event_consumer_name |  | keyword |
| thor.event_filter |  | keyword |
| thor.event_filter_name |  | keyword |
| thor.exe_group |  | keyword |
| thor.exe_magic |  | keyword |
| thor.exe_mode |  | keyword |
| thor.exe_owner |  | keyword |
| thor.executable |  | keyword |
| thor.file.company |  | keyword |
| thor.file.created |  | keyword |
| thor.file.description |  | keyword |
| thor.file.ext |  | keyword |
| thor.file.first_bytes |  | keyword |
| thor.file.imphash |  | keyword |
| thor.file.internal_name |  | keyword |
| thor.file.legal_copyright |  | keyword |
| thor.file.original_name |  | keyword |
| thor.file.permissions |  | keyword |
| thor.file.product |  | keyword |
| thor.file.type |  | keyword |
| thor.files |  | nested |
| thor.files.company |  | keyword |
| thor.files.created |  | keyword |
| thor.files.description |  | keyword |
| thor.files.exists |  | keyword |
| thor.files.first_bytes |  | keyword |
| thor.files.group |  | keyword |
| thor.files.imphash |  | keyword |
| thor.files.internal_name |  | keyword |
| thor.files.legal_copyright |  | keyword |
| thor.files.md5 |  | keyword |
| thor.files.original_name |  | keyword |
| thor.files.owner |  | keyword |
| thor.files.path |  | keyword |
| thor.files.product |  | keyword |
| thor.files.sha1 |  | keyword |
| thor.files.sha256 |  | keyword |
| thor.files.size |  | float |
| thor.files.type |  | keyword |
| thor.filter_type |  | keyword |
| thor.full_name |  | keyword |
| thor.groupid |  | keyword |
| thor.hive |  | keyword |
| thor.home |  | keyword |
| thor.image.accessed |  | keyword |
| thor.image.changed |  | keyword |
| thor.image.company |  | keyword |
| thor.image.created |  | keyword |
| thor.image.description |  | keyword |
| thor.image.first_bytes |  | keyword |
| thor.image.group |  | keyword |
| thor.image.imphash |  | keyword |
| thor.image.internal_name |  | keyword |
| thor.image.legal_copyright |  | keyword |
| thor.image.md5 |  | keyword |
| thor.image.modified |  | keyword |
| thor.image.original_name |  | keyword |
| thor.image.owner |  | keyword |
| thor.image.path |  | keyword |
| thor.image.permissions |  | keyword |
| thor.image.product |  | keyword |
| thor.image.sha1 |  | keyword |
| thor.image.sha256 |  | keyword |
| thor.image.size |  | float |
| thor.image.type |  | keyword |
| thor.image_path |  | keyword |
| thor.job |  | keyword |
| thor.key |  | keyword |
| thor.key_name |  | keyword |
| thor.last_run |  | keyword |
| thor.listen_ports |  | keyword |
| thor.logontype |  | keyword |
| thor.memory_usage |  | keyword |
| thor.modified |  | keyword |
| thor.name |  | keyword |
| thor.next_run |  | keyword |
| thor.notices |  | float |
| thor.owner |  | keyword |
| thor.parent |  | keyword |
| thor.path |  | keyword |
| thor.pid |  | long |
| thor.ppid |  | long |
| thor.process_name |  | keyword |
| thor.reason |  | keyword |
| thor.reasons.matched.context |  | keyword |
| thor.reasons.matched.data |  | keyword |
| thor.reasons.matched.offset |  | long |
| thor.reasons.name |  | keyword |
| thor.reasons.score |  | long |
| thor.reasons.sigclass |  | keyword |
| thor.reasons.signature.author |  | keyword |
| thor.reasons.signature.ref |  | keyword |
| thor.reasons.signature.ruledate |  | keyword |
| thor.reasons.signature.rulename |  | keyword |
| thor.reasons.signature.tags |  | keyword |
| thor.reasons.sigtype |  | keyword |
| thor.run_as_group |  | keyword |
| thor.run_as_user |  | keyword |
| thor.runlevel |  | keyword |
| thor.scan_id |  | keyword |
| thor.scanned_elements |  | float |
| thor.score |  | long |
| thor.service_name |  | keyword |
| thor.session |  | keyword |
| thor.sha1 |  | keyword |
| thor.shell |  | keyword |
| thor.start |  | keyword |
| thor.start_type |  | keyword |
| thor.unit |  | keyword |
| thor.unit_group |  | keyword |
| thor.unit_mode |  | keyword |
| thor.unit_owner |  | keyword |
| thor.unit_path |  | keyword |
| thor.warnings |  | float |


## Example Event

An example event for `thor_forwarding` looks as following:

```json
{
    "@timestamp": "2025-11-10T17:52:49.000Z",
    "agent": {
        "ephemeral_id": "47ff3e36-3afb-4f40-a54b-0d7760c0ba47",
        "id": "3f79491d-f5be-4ba3-8e35-ba4bcf3dcbef",
        "name": "elastic-agent-20177",
        "type": "filebeat",
        "version": "9.2.3"
    },
    "data_stream": {
        "dataset": "nextron_thor_apt_scanner.thor_forwarding",
        "namespace": "16677",
        "type": "logs"
    },
    "ecs": {
        "version": "9.2.0"
    },
    "elastic_agent": {
        "id": "3f79491d-f5be-4ba3-8e35-ba4bcf3dcbef",
        "snapshot": false,
        "version": "9.2.3"
    },
    "event": {
        "category": [
            "file"
        ],
        "dataset": "nextron_thor_apt_scanner.thor_forwarding",
        "ingested": "2026-02-06T12:59:20Z",
        "kind": "event",
        "module": "AtJobs",
        "type": [
            "info"
        ],
        "version": "v2.0.0"
    },
    "host": {
        "name": "myhostname"
    },
    "input": {
        "type": "cel"
    },
    "log": {
        "level": "Info"
    },
    "message": "At Job detected",
    "tags": [
        "forwarded"
    ],
    "thor": {
        "command": "",
        "job": "C:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Task Manager\\Interactive",
        "logontype": "",
        "runlevel": "",
        "scan_id": "S-VavZi0stuDo",
        "start": ""
    },
    "user": {
        "name": ""
    }
}
```