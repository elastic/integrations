rules:
  - path: /ingestion/rules/save_result_set/
    methods: ["GET"]
    query_params:
      page_size: 2
      page: 3
      AccessID: "{AccessID:.*}"
      version: "{version:.*}"
      from_timestamp: "{from_timestamp:.*}"
      Expires: "{Expires:.*}"
      Signature: "{Signature:.*}"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "next": null,
            "previous": "ingestion/rules/save_result_set/?page=3&page_size=2&from_timestamp=1747947825&version=v3",
            "page_size": 2,
            "total": 8,
            "results": [
              {
                "id": "82e7f1ce-36ce-41d2-9cca-ba56b2a6febb",
                "ctix_created": 1751632663,
                "ctix_modified": 1751632663,
                "version": "v3",
                "ctix_tags": [
                  {
                    "id": "ec16aa3d-617c-468c-99a8-6b21af0a8508",
                    "name": "(http_inspect) unknown Content-Encoding used (Firepower)",
                    "created": 1748526014,
                    "modified": 1748526014,
                    "tag_type": {
                      "id": "source",
                      "name": "Source"
                    },
                    "is_active": true,
                    "created_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    },
                    "colour_code": "#45505E",
                    "modified_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    }
                  },
                  {
                    "id": "0bdcf6dc-546f-4021-a292-1f5313ff8d55",
                    "name": "(smtp) unknown command (Firepower)",
                    "created": 1748612481,
                    "modified": 1748612481,
                    "tag_type": {
                      "id": "source",
                      "name": "Source"
                    },
                    "is_active": true,
                    "created_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    },
                    "colour_code": "#45505E",
                    "modified_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    }
                  }
                ],
                "data": [
                  {
                    "id": "f4e91f4e-65f7-40d5-95d2-be7de434c438",
                    "name": "1.128.0.0",
                    "tags": [
                      "cve-2024-9047",
                      "Feed",
                      "vulnerability exploitation",
                      "china-nexus",
                      "cve-2024-51378",
                      "backdoor",
                      "cobalt strike",
                      "vshell",
                      "cve-2024-27199",
                      "cve-2024-56145",
                      "cve-2021-22205",
                      "brute ratel",
                      "cve-2024-51567",
                      "bypassboss",
                      "multi-industry targeting",
                      "custom tools",
                      "cve-2024-27198",
                      ".net",
                      "sql injection",
                      "cve-2025-31324",
                      "apt",
                      "cve-2017-9805",
                      "dll sideloading",
                      "pulsepack"
                    ],
                    "country": "Hong Kong",
                    "created": 1748342106.0,
                    "sources": [
                      {
                        "tlp": "WHITE",
                        "name": "Vault",
                        "score": 100,
                        "last_seen": null,
                        "first_seen": 1748342106
                      }
                    ],
                    "ctix_tlp": null,
                    "ioc_type": "ipv4-addr",
                    "modified": 1748354570.904088,
                    "sdo_name": "1.128.0.0",
                    "sdo_type": "indicator",
                    "severity": "UNKNOWN",
                    "ctix_score": 0,
                    "is_revoked": false,
                    "source_tlp": "NONE",
                    "valid_from": 1748342106.0,
                    "analyst_tlp": null,
                    "is_actioned": false,
                    "is_reviewed": false,
                    "valid_until": 1750932000.0,
                    "ctix_created": 1748354583.272796,
                    "is_whitelist": false,
                    "analyst_score": null,
                    "ctix_modified": 1751632658.306212,
                    "custom_scores": {"x_ctix_customscore_2":2},
                    "is_deprecated": true,
                    "indicator_type": {
                      "type": "ipv4-addr",
                      "attribute_field": "value"
                    },
                    "is_false_positive": false
                  }
                ],
                "timestamp": 1751632663,
                "title": "Package From CTIX"
              }
            ]
          }
          `}}
  - path: /ingestion/rules/save_result_set/
    methods: ["GET"]
    query_params:
      page_size: 2
      page: 2
      AccessID: "{AccessID:.*}"
      version: "{version:.*}"
      from_timestamp: "{from_timestamp:.*}"
      Expires: "{Expires:.*}"
      Signature: "{Signature:.*}"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "next": "ingestion/rules/save_result_set/?page=3&page_size=2&from_timestamp=1747947825&version=v3",
            "previous": "ingestion/rules/save_result_set/?page=1&page_size=2&from_timestamp=1747947825&version=v3",
            "page_size": 2,
            "total": 8,
            "results": [
              {
                "id": "2fd17a6b-3939-485c-80ed-84d469da1b93",
                "ctix_created": 1751291553,
                "ctix_modified": 1751291553,
                "version": "v3",
                "ctix_tags": [
                  {
                    "id": "ec16aa3d-617c-468c-99a8-6b21af0a8508",
                    "name": "(http_inspect) unknown Content-Encoding used (Firepower)",
                    "created": 1748526014,
                    "modified": 1748526014,
                    "tag_type": {
                      "id": "source",
                      "name": "Source"
                    },
                    "is_active": true,
                    "created_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    },
                    "colour_code": "#45505E",
                    "modified_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    }
                  },
                  {
                    "id": "0bdcf6dc-546f-4021-a292-1f5313ff8d55",
                    "name": "(smtp) unknown command (Firepower)",
                    "created": 1748612481,
                    "modified": 1748612481,
                    "tag_type": {
                      "id": "source",
                      "name": "Source"
                    },
                    "is_active": true,
                    "created_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    },
                    "colour_code": "#45505E",
                    "modified_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    }
                  }
                ],
                "data": [
                  {
                    "id": "6b0e2522-979d-4754-84ec-bd3b4ec19cbf",
                    "name": "digital",
                    "tags": [
                      "URL spoofing",
                      "domain redirection",
                      "cryptocurrency",
                      "brand impersonation"
                    ],
                    "country": "India",
                    "created": 1746812972.0,
                    "sources": [
                      {
                        "tlp": "WHITE",
                        "name": "Vault",
                        "score": 100,
                        "last_seen": null,
                        "first_seen": 1746812972
                      }
                    ],
                    "ctix_tlp": null,
                    "ioc_type": "domain-name",
                    "modified": 1748354676.710264,
                    "sdo_name": "digital",
                    "sdo_type": "indicator",
                    "severity": "UNKNOWN",
                    "ctix_score": 90,
                    "is_revoked": false,
                    "source_tlp": "NONE",
                    "valid_from": 1746812972.0,
                    "analyst_tlp": null,
                    "is_actioned": false,
                    "is_reviewed": false,
                    "valid_until": null,
                    "ctix_created": 1748354691.634547,
                    "is_whitelist": false,
                    "analyst_score": null,
                    "ctix_modified": 1751291551.915257,
                    "custom_scores": {"x_ctix_customscore_2":2},
                    "is_deprecated": false,
                    "indicator_type": {
                      "type": "domain-name",
                      "attribute_field": "value"
                    },
                    "is_false_positive": false
                  }
                ],
                "timestamp": 1751291553,
                "title": "Package From CTIX"
              },
              {
                "id": "9439c3e8-4bea-4f34-8ab3-1c5c02c2503f",
                "ctix_created": 1751301210,
                "ctix_modified": 1751301210,
                "version": "v3",
                "ctix_tags": [
                  {
                    "id": "ec16aa3d-617c-468c-99a8-6b21af0a8508",
                    "name": "(http_inspect) unknown Content-Encoding used (Firepower)",
                    "created": 1748526014,
                    "modified": 1748526014,
                    "tag_type": {
                      "id": "source",
                      "name": "Source"
                    },
                    "is_active": true,
                    "created_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    },
                    "colour_code": "#45505E",
                    "modified_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    }
                  },
                  {
                    "id": "0bdcf6dc-546f-4021-a292-1f5313ff8d55",
                    "name": "(smtp) unknown command (Firepower)",
                    "created": 1748612481,
                    "modified": 1748612481,
                    "tag_type": {
                      "id": "source",
                      "name": "Source"
                    },
                    "is_active": true,
                    "created_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    },
                    "colour_code": "#45505E",
                    "modified_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    }
                  }
                ],
                "data": [
                  {
                    "id": "375b30ef-74c8-4ad2-8570-c01d1d90e017",
                    "name": "digital",
                    "tags": [
                      "cryptocurrency",
                      "domain redirection",
                      "URL spoofing",
                      "brand impersonation"
                    ],
                    "country": null,
                    "created": 1746812972.0,
                    "sources": [
                      {
                        "tlp": "WHITE",
                        "name": "Vault",
                        "score": 100,
                        "last_seen": null,
                        "first_seen": 1746812972
                      }
                    ],
                    "ctix_tlp": null,
                    "ioc_type": "domain-name",
                    "modified": 1748354676.709378,
                    "sdo_name": "digital",
                    "sdo_type": "indicator",
                    "severity": "UNKNOWN",
                    "ctix_score": 90,
                    "is_revoked": false,
                    "source_tlp": "NONE",
                    "valid_from": 1746812972.0,
                    "analyst_tlp": null,
                    "is_actioned": false,
                    "is_reviewed": false,
                    "valid_until": null,
                    "ctix_created": 1748354691.631653,
                    "is_whitelist": false,
                    "analyst_score": null,
                    "ctix_modified": 1751301206.388778,
                    "custom_scores": {"x_ctix_customscore_2":2},
                    "is_deprecated": false,
                    "indicator_type": {
                      "type": "domain-name",
                      "attribute_field": "value"
                    },
                    "is_false_positive": false
                  }
                ],
                "timestamp": 1751301210,
                "title": "Package From CTIX"
              }
            ]
          }
          `}}
  - path: /ingestion/rules/save_result_set/
    methods: ["GET"]
    query_params:
      page_size: 2
      page: 1
      AccessID: "{AccessID:.*}"
      version: "{version:.*}"
      from_timestamp: "{from_timestamp:.*}"
      Expires: "{Expires:.*}"
      Signature: "{Signature:.*}"
    responses:
      - status_code: 200
        body: |-
          {{ minify_json `
          {
            "next": "ingestion/rules/save_result_set/?page=2&page_size=2&from_timestamp=1747947825&version=v3",
            "previous": null,
            "page_size": 2,
            "total": 4,
            "results": [
              {
                "id": "4e0a8868-f812-4139-b715-7e69850360db",
                "ctix_created": 1751279301,
                "ctix_modified": 1751279301,
                "version": "v3",
                "ctix_tags": [
                  {
                    "id": "ec16aa3d-617c-468c-99a8-6b21af0a8508",
                    "name": "(http_inspect) unknown Content-Encoding used (Firepower)",
                    "created": 1748526014,
                    "modified": 1748526014,
                    "tag_type": {
                      "id": "source",
                      "name": "Source"
                    },
                    "is_active": true,
                    "created_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@example.com",
                      "last_name": "Default",
                      "first_name": "System"
                    },
                    "colour_code": "#45505E",
                    "modified_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    }
                  },
                  {
                    "id": "0bdcf6dc-546f-4021-a292-1f5313ff8d55",
                    "name": "(smtp) unknown command (Firepower)",
                    "created": 1748612481,
                    "modified": 1748612481,
                    "tag_type": {
                      "id": "source",
                      "name": "Source"
                    },
                    "is_active": true,
                    "created_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    },
                    "colour_code": "#45505E",
                    "modified_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    }
                  }
                ],
                "data": [
                  {
                    "id": "f36749f2-776f-4153-b840-08bad5fb18b1",
                    "name": "e8c5c5829b630dcf61b55f271ac6c085",
                    "tags": [
                      "brand impersonation",
                      "cryptocurrency",
                      "Apple"
                    ],
                    "country": null,
                    "created": 1746812972.0,
                    "sources": [
                      {
                        "tlp": "WHITE",
                        "name": "Vault",
                        "score": 100,
                        "last_seen": null,
                        "first_seen": 1746812972
                      }
                    ],
                    "ctix_tlp": null,
                    "ioc_type": "file",
                    "modified": 1748354676.716103,
                    "sdo_name": "e8c5c5829b630dcf61b55f271ac6c085",
                    "sdo_type": "indicator",
                    "severity": "UNKNOWN",
                    "ctix_score": 90,
                    "is_revoked": false,
                    "source_tlp": "NONE",
                    "valid_from": 1746812972.0,
                    "analyst_tlp": null,
                    "is_actioned": false,
                    "is_reviewed": false,
                    "valid_until": null,
                    "ctix_created": 1748354691.651628,
                    "is_whitelist": false,
                    "analyst_score": null,
                    "ctix_modified": 1751279296.273555,
                    "custom_scores": {"x_ctix_customscore_2":2},
                    "is_deprecated": false,
                    "indicator_type": {
                      "type": "file",
                      "attribute_field": "MD5"
                    },
                    "is_false_positive": false
                  }
                ],
                "timestamp": 1751279301,
                "title": "Package From CTIX"
              },
              {
                "id": "6db685d1-8ca6-4efc-b5cd-f8dcbf070ab8",
                "ctix_created": 1751280122,
                "ctix_modified": 1751280122,
                "version": "v3",
                "ctix_tags": [
                  {
                    "id": "ec16aa3d-617c-468c-99a8-6b21af0a8508",
                    "name": "(http_inspect) unknown Content-Encoding used (Firepower)",
                    "created": 1748526014,
                    "modified": 1748526014,
                    "tag_type": {
                      "id": "source",
                      "name": "Source"
                    },
                    "is_active": true,
                    "created_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    },
                    "colour_code": "#45505E",
                    "modified_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    }
                  },
                  {
                    "id": "0bdcf6dc-546f-4021-a292-1f5313ff8d55",
                    "name": "(smtp) unknown command (Firepower)",
                    "created": 1748612481,
                    "modified": 1748612481,
                    "tag_type": {
                      "id": "source",
                      "name": "Source"
                    },
                    "is_active": true,
                    "created_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    },
                    "colour_code": "#45505E",
                    "modified_by": {
                      "id": "c47b363a-2a0a-4bea-942f-27a260d121d1",
                      "email": "system@default.com",
                      "last_name": "Default",
                      "first_name": "System"
                    }
                  }
                ],
                "data": [
                  {
                    "id": "34ea4742-cba4-4b8f-84ed-306ae74d1142",
                    "name": "example.com",
                    "tags": [
                      "domain redirection",
                      "Apple"
                    ],
                    "country": "Germany",
                    "created": 1746812972.0,
                    "sources": [
                      {
                        "tlp": "WHITE",
                        "name": "Vault",
                        "score": 100,
                        "last_seen": null,
                        "first_seen": 1746812972
                      }
                    ],
                    "ctix_tlp": null,
                    "ioc_type": "domain-name",
                    "modified": 1748354676.712021,
                    "sdo_name": "space",
                    "sdo_type": "indicator",
                    "severity": "UNKNOWN",
                    "ctix_score": 90,
                    "is_revoked": false,
                    "source_tlp": "NONE",
                    "valid_from": 1746812972.0,
                    "analyst_tlp": null,
                    "is_actioned": false,
                    "is_reviewed": false,
                    "valid_until": null,
                    "ctix_created": 1748354691.640348,
                    "is_whitelist": false,
                    "analyst_score": null,
                    "ctix_modified": 1751280121.022215,
                    "custom_scores": {"x_ctix_customscore_2":2},
                    "is_deprecated": false,
                    "indicator_type": {
                      "type": "domain-name",
                      "attribute_field": "value"
                    },
                    "is_false_positive": false
                  }
                ],
                "timestamp": 1751280122,
                "title": "Package From CTIX"
              }
            ]
          }
          `}}
