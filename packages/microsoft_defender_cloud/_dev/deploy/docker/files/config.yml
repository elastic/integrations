rules:
  - path: /<tenant_id>/oauth2/v2.0/token
    methods: [POST]
    query_params:
      client_id: <client_id>
      client_secret: <client_secret>
      grant_type: client_credentials
      scope: https://management.azure.com/.default
    request_headers:
      Content-Type:
        - "application/x-www-form-urlencoded"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "access_token": "eyJ0eabDVHDgdBDG59BRDG57DBDh56skjsbvDFBDge95sI6Ilg1ZVhrN",
            "token_type": "Bearer",
            "ext_expires_in": 3599,
            "expires_in": 3599
          }
  - path: /subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/providers/Microsoft.Security/assessments
    methods: [GET]
    query_params:
      api-version: '2021-06-01'
      NextLink: _muliCloud
    request_headers:
      Authorization:
        - "Bearer eyJ0eabDVHDgdBDG59BRDG57DBDh56skjsbvDFBDge95sI6Ilg1ZVhrN"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "value": []
          }
  - path: /subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/providers/Microsoft.Security/assessments
    methods: [GET]
    query_params:
      api-version: '2021-06-01'
      NextLink: next1
    request_headers:
      Authorization:
        - "Bearer eyJ0eabDVHDgdBDG59BRDG57DBDh56skjsbvDFBDge95sI6Ilg1ZVhrN"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "value": [
              {
                "type": "Microsoft.Security/assessments",
                "id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server/providers/Microsoft.Security/assessments/cababcd3-5678-4006-1234-8abcdef123456d",
                "name": "cababcd3-5678-4006-1234-8abcdef123456d",
                "properties": {
                  "resourceDetails": {
                    "Source": "Azure",
                    "Id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server",
                    "ResourceName": "metrics-server",
                    "ResourceType": "Container",
                    "ResourceProvider": "Microsoft.ContainerService",
                    "NativeResourceId": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server",
                    "ResourceId": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server"
                  },
                  "displayName": "[Preview] Containers running in Azure should have vulnerability findings resolved",
                  "status": {
                    "code": "Unhealthy",
                    "statusChangeDate": "2025-08-26T07:29:51.8002401Z",
                    "firstEvaluationDate": "2025-08-26T07:29:51.8002401Z"
                  },
                  "additionalData": {
                    "subAssessmentsLink": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server/providers/Microsoft.Security/assessments/cababcd3-5678-4006-1234-8abcdef123456d/subAssessments",
                    "maxCvss30Score": "7.6",
                    "ClusterResourceId": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev",
                    "ContainerName": "metrics-server",
                    "ContainerId": ""
                  }
                }
              }
            ],
            "nextLink": "http://{{ hostname }}:{{ env "PORT" }}/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/providers/Microsoft.Security/assessments?api-version=2021-06-01&NextLink=_muliCloud"
          }
  - path: /subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/providers/Microsoft.Security/assessments
    methods: [GET]
    query_params:
      api-version: '2021-06-01'
    request_headers:
      Authorization:
        - "Bearer eyJ0eabDVHDgdBDG59BRDG57DBDh56skjsbvDFBDge95sI6Ilg1ZVhrN"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "value": [
              {
                "type": "Microsoft.Security/assessments",
                "id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourceGroups/DEFENDER_CLOUD_GROUP/providers/Microsoft.Compute/virtualMachines/vm-for-defender-cloud-test/providers/Microsoft.Security/assessments/fabcdef2-5678-1234-8382-21234567890d",
                "name": "fabcdef2-5678-1234-8382-21234567890d",
                "properties": {
                  "resourceDetails": {
                    "Source": "Azure",
                    "Id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourceGroups/DEFENDER_CLOUD_GROUP/providers/Microsoft.Compute/virtualMachines/vm-for-defender-cloud-test",
                    "ResourceName": "vm-for-defender-cloud-test",
                    "ResourceType": "virtualMachines",
                    "ResourceProvider": "Microsoft.Compute",
                    "NativeResourceId": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourceGroups/DEFENDER_CLOUD_GROUP/providers/Microsoft.Compute/virtualMachines/vm-for-defender-cloud-test"
                  },
                  "displayName": "Machines should have a vulnerability assessment solution",
                  "status": {
                    "code": "Healthy",
                    "cause": "mdeTvm",
                    "description": "The machine is onboarded to Microsoft defender vulnerability management"
                  },
                  "additionalData": { "Can onboard to BYOL": "true" }
                }
              },
              {
                "type": "Microsoft.Security/assessments",
                "id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-konnectivity-agent-*-*-container-konnectivity-agent/providers/Microsoft.Security/assessments/5abcdef2-6664-abcd-1234-c1234567890f",
                "name": "5abcdef2-6664-abcd-1234-c1234567890f",
                "properties": {
                  "resourceDetails": {
                    "Source": "Azure",
                    "Id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-konnectivity-agent-*-*-container-konnectivity-agent",
                    "ResourceName": "konnectivity-agent",
                    "ResourceType": "ContainerImage",
                    "ResourceProvider": "Microsoft.ContainerService",
                    "NativeResourceId": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-konnectivity-agent-*-*-container-konnectivity-agent"
                  },
                  "displayName": "[Preview] Vulnerable Azure Kubernetes Service should be updated to resolve vulnerability findings",
                  "status": { "code": "Unhealthy" },
                  "additionalData": {
                    "K8sClusterId": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev",
                    "K8sClusterName": "example-dev",
                    "ControllerName": "konnectivity-agent-*",
                    "ControllerType": "replicaset",
                    "PodName": "konnectivity-agent-*-*",
                    "Namespace": "kube-system",
                    "ImageUri": "mcr.microsoft.com/oss/kubernetes/apiserver-network-proxy/agent@sha256:d58bcadc0a5c54a5be409f3473be0dd5639b111c8a9a7dd1827c8f77d76945e4",
                    "Repo": "oss/kubernetes/apiserver-network-proxy/agent",
                    "Digest": "sha256:d58bcadc0a5c54a5be409f3473be0dd5639b111c8a9a7dd1827c8f77d76945e4",
                    "OsType": "Linux",
                    "OsDistribution": "Debian 11",
                    "Tags": "[\"v0.30.3-hotfix.20240819\"]",
                    "InventorySource": "Agentless",
                    "CvesCount": "2",
                    "HighestSeverity": "Medium",
                    "CVEs": "[{\"CVE\":\"CVE-2025-22872\",\"Severity\":\"Medium\",\"BaseScore\":6.5},{\"CVE\":\"CVE-2025-22870\",\"Severity\":\"Medium\",\"BaseScore\":5.3}]"
                  }
                }
              },
              {
                "type": "Microsoft.Security/assessments",
                "id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-test_group/providers/microsoft.containerservice/managedclusters/example-test/securityentitydata/namespace-kube-system-pod-coredns-autoscaler-*-*-container-autoscaler/providers/Microsoft.Security/assessments/c2345673-abcd-0012-abcd-81234554321d",
                "name": "c2345673-abcd-0012-abcd-81234554321d",
                "properties": {
                  "resourceDetails": {
                    "Source": "Azure",
                    "Id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-test_group/providers/microsoft.containerservice/managedclusters/example-test/securityentitydata/namespace-kube-system-pod-coredns-autoscaler-*-*-container-autoscaler",
                    "ResourceName": "autoscaler",
                    "ResourceType": "Container",
                    "ResourceProvider": "Microsoft.ContainerService",
                    "NativeResourceId": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-test_group/providers/microsoft.containerservice/managedclusters/example-test/securityentitydata/namespace-kube-system-pod-coredns-autoscaler-*-*-container-autoscaler"
                  },
                  "displayName": "[Preview] Containers running in Azure should have vulnerability findings resolved",
                  "status": { "code": "Unhealthy" },
                  "additionalData": {
                    "subAssessmentsLink": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-test_group/providers/microsoft.containerservice/managedclusters/example-test/securityentitydata/namespace-kube-system-pod-coredns-autoscaler-*-*-container-autoscaler/providers/Microsoft.Security/assessments/c2345673-abcd-0012-abcd-81234554321d/subAssessments",
                    "maxCvss30Score": "7.5"
                  }
                }
              }
            ],
            "nextLink": "http://{{ hostname }}:{{ env "PORT" }}/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/providers/Microsoft.Security/assessments?api-version=2021-06-01&NextLink=next1"
          }
  - path: /subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-test_group/providers/microsoft.containerservice/managedclusters/example-test/securityentitydata/namespace-kube-system-pod-coredns-autoscaler-*-*-container-autoscaler/providers/Microsoft.Security/assessments/c2345673-abcd-0012-abcd-81234554321d/subAssessments
    methods: [GET]
    query_params:
      api-version: 2019-01-01-preview
      NextLink: __1
    request_headers:
      Authorization:
        - "Bearer eyJ0eabDVHDgdBDG59BRDG57DBDh56skjsbvDFBDge95sI6Ilg1ZVhrN"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "value": []
          }
  - path: /subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-test_group/providers/microsoft.containerservice/managedclusters/example-test/securityentitydata/namespace-kube-system-pod-coredns-autoscaler-*-*-container-autoscaler/providers/Microsoft.Security/assessments/c2345673-abcd-0012-abcd-81234554321d/subAssessments
    methods: [GET]
    query_params:
      api-version: 2019-01-01-preview
    request_headers:
      Authorization:
        - "Bearer eyJ0eabDVHDgdBDG59BRDG57DBDh56skjsbvDFBDge95sI6Ilg1ZVhrN"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "value": [
              {
                "type": "Microsoft.Security/assessments/subAssessments",
                "id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-test_group/providers/microsoft.containerservice/managedclusters/example-test/securityentitydata/namespace-kube-system-pod-coredns-autoscaler-*-*-container-autoscaler/providers/Microsoft.Security/assessments/c2345673-abcd-0012-abcd-81234554321d/subassessments/8123443d-5678-03f8-1234-7ababcdcdeff",
                "name": "8123443d-5678-03f8-1234-7ababcdcdeff",
                "properties": {
                  "id": "CVE-2025-22868",
                  "displayName": "CVE-2025-22868",
                  "status": { "code": "Unhealthy", "severity": "High" },
                  "remediation": "This vulnerability is patchable by a version update",
                  "category": "",
                  "description": "Summary: CVE-2025-22868 describes a vulnerability in the Golang package 'golang.org/x/oauth2/jws' where an attacker can exploit the token parsing mechanism by providing a malformed token, leading to unexpected memory consumption. This flaw can result in a denial of service condition. Impact: Exploitation of this vulnerability can lead to denial of service, potentially disrupting services relying on the affected package. AdditionalInformation: The vulnerability is specific to the 'golang.org/x/oauth2/jws' package and involves token parsing mechanisms. It is referenced in multiple advisories and affects specific versions of the package. Remediation: Apply the latest patches and updates provided by the respective vendors. [Generated by AI]",
                  "timeGenerated": "2025-08-24T00:36:33.2351289Z",
                  "resourceDetails": {
                    "ResourceName": "autoscaler",
                    "ResourceType": "Container",
                    "ResourceProvider": "Microsoft.ContainerService",
                    "source": "Azure",
                    "id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-test_group/providers/microsoft.containerservice/managedclusters/example-test/securityentitydata/namespace-kube-system-pod-coredns-autoscaler-*-*-container-autoscaler"
                  },
                  "additionalData": {
                    "assessedResourceType": "AzureRuntimeImageVulnerability",
                    "kubernetesDetails": {
                      "cloud": "Azure",
                      "clusterKind": "AKS",
                      "clusterName": "example-test",
                      "clusterResourceId": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-test_group/providers/microsoft.containerservice/managedclusters/example-test",
                      "namespace": "kube-system",
                      "controllerKind": "replicaset",
                      "controllerName": "coredns-autoscaler-*",
                      "podName": "coredns-autoscaler-*-*",
                      "containerName": "autoscaler"
                    },
                    "securityGating": {
                      "requestId": "",
                      "evaluatedResourceName": "",
                      "evaluatedResourceKind": ""
                    },
                    "artifactDetails": {
                      "repositoryName": "oss/v2/kubernetes/autoscaler/cluster-proportional-autoscaler",
                      "registryHost": "mcr.microsoft.com",
                      "digest": "sha256:ef1ce8a6da7d09d93ec6ed51bfefe2e5f5c7b023a18174d6dfbc0699a4a74afc",
                      "artifactType": "ContainerImage"
                    },
                    "softwareDetails": {
                      "osDetails": {
                        "osName": "",
                        "osPlatform": "linux",
                        "osVersion": "azure_linux_3"
                      },
                      "packageName": "golang.org/x/oauth2",
                      "category": "Language",
                      "fixReference": {},
                      "vendor": "golang.org/x/oauth2",
                      "version": "0.21.0",
                      "evidence": ["/usr/bin/cluster-proportional-autoscaler"],
                      "language": "go",
                      "fixedVersion": "0.27.0",
                      "patchable": true,
                      "fixStatus": "FixAvailable"
                    },
                    "vulnerabilityDetails": {
                      "cveId": "CVE-2025-22868",
                      "references": [
                        {
                          "title": "golang.org/x/oauth2 Improper Validation of Syntactic Correctness of Input vulnerability",
                          "link": "https://github.com/advisories/GHSA-6v2p-p543-phr9"
                        },
                        {
                          "title": "401051",
                          "link": "https://exchange.xforce.ibmcloud.com/vulnerabilities/401051"
                        },
                        {
                          "title": "CVE-2025-22868",
                          "link": "https://vulncheck.com/browse/cve/CVE-2025-22868"
                        },
                        {
                          "title": "CVE-2025-22868_oval:com.redhat.rhsa:def:20253335",
                          "link": "https://security.access.redhat.com/data/oval/v2/RHEL9/rhel-9.8-eus.oval.xml.bz2"
                        },
                        {
                          "title": "oval:org.debian:def:29712258401201729110682046288523474729",
                          "link": "https://www.debian.org/security/oval/oval-definitions-bookworm.xml.bz2"
                        },
                        {
                          "title": "oval:org.opensuse.security:def:202522868",
                          "link": "https://ftp.suse.com/pub/projects/security/oval/opensuse.tumbleweed.xml.gz"
                        },
                        {
                          "title": "Amazon Linux 2023 - ALAS2023-2025-934: Important priority package update for docker",
                          "link": "https://cdn.amazonlinux.com/al2023/core/guids/ea68ce3fcc4f0ff38ca0d344865175e462162dc424dba2f1b05735c2dda146c8/x86_64/repodata/updateinfo.xml.gz"
                        },
                        {
                          "title": "golang-x-perf-0-0.28.20250326git02a15fd.fc41",
                          "link": "https://archives.fedoraproject.org/pub/fedora/linux/updates/41/Everything/x86_64/repodata/71b8dc828262b9a1d912d4bac6b1170f4912692fe4bd069042e84a47852ef8a2-updateinfo.xml.zst"
                        },
                        {
                          "title": "oval:com.microsoft.cbl-mariner:def:57467",
                          "link": "https://raw.githubusercontent.com/microsoft/CBL-MarinerVulnerabilityData/main/cbl-mariner-2.0-oval.xml"
                        },
                        {
                          "title": "oval:com.microsoft.azurelinux:def:57389",
                          "link": "https://raw.githubusercontent.com/microsoft/AzureLinuxVulnerabilityData/main/azurelinux-3.0-oval.xml"
                        }
                      ],
                      "cvss": {
                        "2.0": null,
                        "3.0": {
                          "base": 7.5,
                          "cvssVectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
                        }
                      },
                      "workarounds": [],
                      "publishedDate": "2025-02-26T00:00:00Z",
                      "lastModifiedDate": "2025-08-16T00:00:00Z",
                      "severity": "High",
                      "cpe": {
                        "uri": "cpe:2.3:a:golang.org\\/x\\/oauth2:golang.org\\/x\\/oauth2:*:*:*:*:*:go:*:*",
                        "part": "0",
                        "vendor": "golang.org/x/oauth2",
                        "product": "golang.org/x/oauth2",
                        "version": "*",
                        "update": "*",
                        "edition": "*",
                        "language": "*",
                        "softwareEdition": "*",
                        "targetSoftware": "go",
                        "targetHardware": "*",
                        "other": "*"
                      },
                      "weaknesses": { "cwe": [{ "id": "CWE-1286" }] },
                      "exploitabilityAssessment": {
                        "isVerified": false,
                        "isPubliclyDisclosed": false,
                        "isInExploitKit": false
                      }
                    },
                    "metadata": {
                      "inventorySource": "Agentless",
                      "scanner": "MicrosoftDefenderVulnerabilityManagement"
                    },
                    "cvssV30Score": 7.5
                  }
                }
              }
            ],
            "nextLink": "http://{{ hostname }}:{{ env "PORT" }}/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-test_group/providers/microsoft.containerservice/managedclusters/example-test/securityentitydata/namespace-kube-system-pod-coredns-autoscaler-*-*-container-autoscaler/providers/Microsoft.Security/assessments/c2345673-abcd-0012-abcd-81234554321d/subAssessments?api-version=2019-01-01-preview&NextLink=__1"
          }
  - path: /subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server/providers/Microsoft.Security/assessments/cababcd3-5678-4006-1234-8abcdef123456d/subAssessments
    methods: [GET]
    query_params:
      api-version: 2019-01-01-preview
      NextLink: __1
    request_headers:
      Authorization:
        - "Bearer eyJ0eabDVHDgdBDG59BRDG57DBDh56skjsbvDFBDge95sI6Ilg1ZVhrN"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "value": []
          }
  - path: /subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server/providers/Microsoft.Security/assessments/cababcd3-5678-4006-1234-8abcdef123456d/subAssessments
    methods: [GET]
    query_params:
      api-version: 2019-01-01-preview
      NextLink: next1
    request_headers:
      Authorization:
        - "Bearer eyJ0eabDVHDgdBDG59BRDG57DBDh56skjsbvDFBDge95sI6Ilg1ZVhrN"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "value": [
              {
                "type": "Microsoft.Security/assessments/subAssessments",
                "id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server/providers/Microsoft.Security/assessments/cababcd3-5678-4006-1234-8abcdef123456d/subassessments/6123abcc-5656-1111-0059-8abcdef45647",
                "name": "6123abcc-5656-1111-0059-8abcdef45647",
                "properties": {
                  "id": "CVE-2024-33599",
                  "displayName": "CVE-2024-33599",
                  "status": {
                    "code": "Unhealthy",
                    "severity": "High"
                  },
                  "remediation": "This vulnerability is patchable by a version update",
                  "category": "",
                  "description": "Summary: Multiple vulnerabilities have been identified in the GNU C Library (glibc), specifically affecting the Name Service Cache Daemon (nscd). These include a stack-based buffer overflow in the netgroup cache (CVE-2024-33599), null pointer dereferences after failed netgroup cache insertion (CVE-2024-33600), termination of the daemon due to memory allocation failure in the netgroup cache (CVE-2024-33601), and assumptions about NSS callback usage leading to potential memory corruption (CVE-2024-33602). These issues arise from improper bounds checking, memory allocation handling, and cache content validation. Impact: Exploitation of these vulnerabilities could allow attackers to execute arbitrary code, cause denial of service (system crashes), or compromise data integrity and availability. The vulnerabilities are rated with high CVSS scores, indicating significant potential impacts on confidentiality, integrity, and availability. AdditionalInformation: These vulnerabilities are present in glibc versions prior to 2.35-7 and 2.38-11. They affect various Oracle Communications products and other systems utilizing glibc. The stack-based buffer overflow in the netgroup cache was introduced in glibc 2.15 when the cache was added to nscd. Remediation: Apply the latest patches and updates provided by the respective vendors. [Generated by AI]",
                  "timeGenerated": "2025-09-09T06:13:24.1426566Z",
                  "resourceDetails": {
                    "ResourceName": "metrics-server",
                    "ResourceType": "Container",
                    "ResourceProvider": "Microsoft.ContainerService",
                    "source": "Azure",
                    "id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server"
                  },
                  "additionalData": {
                    "assessedResourceType": "AzureRuntimeImageVulnerability",
                    "kubernetesDetails": {
                      "cloud": "Azure",
                      "clusterKind": "AKS",
                      "clusterName": "example-dev",
                      "clusterResourceId": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev",
                      "namespace": "kube-system",
                      "controllerKind": "replicaset",
                      "controllerName": "metrics-server-*",
                      "podName": "metrics-server-*-*",
                      "containerName": "metrics-server"
                    },
                    "securityGating": {
                      "requestId": "",
                      "evaluatedResourceName": "",
                      "evaluatedResourceKind": ""
                    },
                    "artifactDetails": {
                      "repositoryName": "oss/v2/kubernetes/metrics-server",
                      "registryHost": "mcr.microsoft.com",
                      "digest": "sha256:5cf1d4d9d163ee8c920f75bd5c0481d749bced8a9e50b1b84dad4349a30fac7e",
                      "artifactType": "ContainerImage"
                    },
                    "softwareDetails": {
                      "osDetails": {
                        "osName": "",
                        "osPlatform": "linux",
                        "osVersion": "azure_linux_3"
                      },
                      "packageName": "glibc",
                      "category": "OS",
                      "fixReference": {
                        "id": "40288-1",
                        "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-33599",
                        "description": "CVE-2024-33599 affecting package glibc for versions less than 2.38-11 2025 July 10",
                        "releaseDate": "2025-07-10T15:09:36.653+00:00"
                      },
                      "vendor": "microsoft",
                      "version": "0:2.38-10.azl3",
                      "evidence": [
                        "rpm -qa --qf '%{NAME}:%{Sourcerpm}:\\n' | grep glibc | cut -f 1 -d ':' | xargs rpm -qid"
                      ],
                      "language": "",
                      "fixedVersion": "2.38-11.azl3",
                      "patchable": true,
                      "fixStatus": "FixAvailable"
                    },
                    "vulnerabilityDetails": {
                      "cveId": "CVE-2024-33599",
                      "references": [
                        {
                          "title": "CVE-2024-33599",
                          "link": "https://nvd.nist.gov/vuln/detail/CVE-2024-33599"
                        },
                        {
                          "title": "290172",
                          "link": "https://exchange.xforce.ibmcloud.com/vulnerabilities/290172"
                        },
                        {
                          "title": "CPUOct2024csaf",
                          "link": "https://www.oracle.com/security-alerts/cpuoct2024.html"
                        },
                        {
                          "title": "CVE-2024-33599_oval:com.oracle.elsa:def:202412440",
                          "link": "https://linux.oracle.com/security/oval/com.oracle.elsa-all.xml.bz2"
                        },
                        {
                          "title": "CVE-2024-33599_oval:com.ubuntu.bionic:def:68041000000",
                          "link": "https://security-metadata.canonical.com/oval/com.ubuntu.bionic.usn.oval.xml.bz2"
                        },
                        {
                          "title": "CVE-2024-33599_oval:org.debian:def:149769063730385918523694736664359324893",
                          "link": "https://www.debian.org/security/oval/oval-definitions-bookworm.xml.bz2"
                        },
                        {
                          "title": "oval:org.opensuse.security:def:202433599",
                          "link": "https://ftp.suse.com/pub/projects/security/oval/opensuse.tumbleweed.xml.gz"
                        },
                        {
                          "title": "Amazon Linux 2023 - ALAS2023-2025-988: Medium priority package update for glibc",
                          "link": "https://cdn.amazonlinux.com/al2023/core/guids/8770f111ce93e73734fda41bb7e01fe033ab1320859414932ea453f5e5ea6ba8/x86_64/repodata/updateinfo.xml.gz"
                        },
                        {
                          "title": "oval:com.microsoft.cbl-mariner:def:40310",
                          "link": "https://raw.githubusercontent.com/microsoft/CBL-MarinerVulnerabilityData/main/cbl-mariner-2.0-oval.xml"
                        },
                        {
                          "title": "oval:com.microsoft.azurelinux:def:40288",
                          "link": "https://raw.githubusercontent.com/microsoft/AzureLinuxVulnerabilityData/main/azurelinux-3.0-oval.xml"
                        }
                      ],
                      "cvss": {
                        "2.0": null,
                        "3.0": {
                          "base": 7.6,
                          "cvssVectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H/E:F/RL:U/RC:R"
                        }
                      },
                      "workarounds": [],
                      "publishedDate": "2024-04-23T00:00:00Z",
                      "lastModifiedDate": "2025-08-12T00:00:00Z",
                      "severity": "High",
                      "cpe": {
                        "uri": "cpe:2.3:a:microsoft:glibc:*:*:*:*:*:azure_linux_3:*:*",
                        "part": "0",
                        "vendor": "microsoft",
                        "product": "glibc",
                        "version": "*",
                        "update": "*",
                        "edition": "*",
                        "language": "*",
                        "softwareEdition": "*",
                        "targetSoftware": "azure_linux_3",
                        "targetHardware": "*",
                        "other": "*"
                      },
                      "weaknesses": {
                        "cwe": [
                          {
                            "id": "CWE-121"
                          },
                          {
                            "id": "CWE-119"
                          }
                        ]
                      },
                      "exploitabilityAssessment": {
                        "isVerified": false,
                        "isPubliclyDisclosed": false,
                        "isInExploitKit": false
                      }
                    },
                    "metadata": {
                      "inventorySource": "Agentless",
                      "scanner": "MicrosoftDefenderVulnerabilityManagement"
                    },
                    "cvssV30Score": 7.6
                  }
                }
              }
            ],
            "nextLink": "http://{{ hostname }}:{{ env "PORT" }}/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server/providers/Microsoft.Security/assessments/cababcd3-5678-4006-1234-8abcdef123456d/subAssessments?api-version=2019-01-01-preview&NextLink=__1"
          }
  - path: /subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server/providers/Microsoft.Security/assessments/cababcd3-5678-4006-1234-8abcdef123456d/subAssessments
    methods: [GET]
    query_params:
      api-version: 2019-01-01-preview
    request_headers:
      Authorization:
        - "Bearer eyJ0eabDVHDgdBDG59BRDG57DBDh56skjsbvDFBDge95sI6Ilg1ZVhrN"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {
            "value": [
              {
                "type": "Microsoft.Security/assessments/subAssessments",
                "id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server/providers/Microsoft.Security/assessments/cababcd3-5678-4006-1234-8abcdef123456d/subassessments/fabcdefb-abcd-1234-97cc-201234567891",
                "name": "fabcdefb-abcd-1234-97cc-201234567891",
                "properties": {
                  "id": "CVE-2025-22868",
                  "displayName": "CVE-2025-22868",
                  "status": {
                    "code": "Unhealthy",
                    "severity": "High"
                  },
                  "remediation": "This vulnerability is patchable by a version update",
                  "category": "",
                  "description": "Summary: CVE-2025-22868 describes a vulnerability in the Golang package 'golang.org/x/oauth2/jws' where an attacker can exploit the token parsing mechanism by providing a malformed token, leading to unexpected memory consumption. This flaw can result in a denial of service condition. Impact: Exploitation of this vulnerability can lead to denial of service, potentially disrupting services relying on the affected package. AdditionalInformation: The vulnerability is specific to the 'golang.org/x/oauth2/jws' package and involves token parsing mechanisms. It is referenced in multiple advisories and affects specific versions of the package. Remediation: Apply the latest patches and updates provided by the respective vendors. [Generated by AI]",
                  "timeGenerated": "2025-09-11T00:59:39.9756686Z",
                  "resourceDetails": {
                    "ResourceName": "metrics-server",
                    "ResourceType": "Container",
                    "ResourceProvider": "Microsoft.ContainerService",
                    "source": "Azure",
                    "id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server"
                  },
                  "additionalData": {
                    "assessedResourceType": "AzureRuntimeImageVulnerability",
                    "kubernetesDetails": {
                      "cloud": "Azure",
                      "clusterKind": "AKS",
                      "clusterName": "example-dev",
                      "clusterResourceId": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev",
                      "namespace": "kube-system",
                      "controllerKind": "replicaset",
                      "controllerName": "metrics-server-*",
                      "podName": "metrics-server-*-*",
                      "containerName": "metrics-server"
                    },
                    "securityGating": {
                      "requestId": "",
                      "evaluatedResourceName": "",
                      "evaluatedResourceKind": ""
                    },
                    "artifactDetails": {
                      "repositoryName": "oss/v2/kubernetes/metrics-server",
                      "registryHost": "mcr.microsoft.com",
                      "digest": "sha256:5cf1d4d9d163ee8c920f75bd5c0481d749bced8a9e50b1b84dad4349a30fac7e",
                      "artifactType": "ContainerImage"
                    },
                    "softwareDetails": {
                      "osDetails": {
                        "osName": "",
                        "osPlatform": "linux",
                        "osVersion": "azure_linux_3"
                      },
                      "packageName": "golang.org/x/oauth2",
                      "category": "Language",
                      "fixReference": {},
                      "vendor": "golang.org/x/oauth2",
                      "version": "0.16.0",
                      "evidence": ["/usr/bin/metrics-server"],
                      "language": "go",
                      "fixedVersion": "0.27.0",
                      "patchable": true,
                      "fixStatus": "FixAvailable"
                    },
                    "vulnerabilityDetails": {
                      "cveId": "CVE-2025-22868",
                      "references": [
                        {
                          "title": "golang.org/x/oauth2 Improper Validation of Syntactic Correctness of Input vulnerability",
                          "link": "https://github.com/advisories/GHSA-6v2p-p543-phr9"
                        },
                        {
                          "title": "401051",
                          "link": "https://exchange.xforce.ibmcloud.com/vulnerabilities/401051"
                        },
                        {
                          "title": "CVE-2025-22868",
                          "link": "https://vulncheck.com/browse/cve/CVE-2025-22868"
                        },
                        {
                          "title": "CVE-2025-22868_oval:com.redhat.rhsa:def:20253335",
                          "link": "https://security.access.redhat.com/data/oval/v2/RHEL9/rhel-9.8-eus.oval.xml.bz2"
                        },
                        {
                          "title": "oval:org.debian:def:29712258401201729110682046288523474729",
                          "link": "https://www.debian.org/security/oval/oval-definitions-bookworm.xml.bz2"
                        },
                        {
                          "title": "oval:org.opensuse.security:def:202522868",
                          "link": "https://ftp.suse.com/pub/projects/security/oval/opensuse.tumbleweed.xml.gz"
                        },
                        {
                          "title": "Amazon Linux 2023 - ALAS2023-2025-934: Important priority package update for docker",
                          "link": "https://cdn.amazonlinux.com/al2023/core/guids/8770f111ce93e73734fda41bb7e01fe033ab1320859414932ea453f5e5ea6ba8/x86_64/repodata/updateinfo.xml.gz"
                        },
                        {
                          "title": "golang-x-perf-0-0.28.20250326git02a15fd.fc41",
                          "link": "https://archives.fedoraproject.org/pub/fedora/linux/updates/41/Everything/x86_64/repodata/0ad973aae3b179e43994669fca15f3b003c636ab72d94bc5107c1e9d1252e11d-updateinfo.xml.zst"
                        },
                        {
                          "title": "oval:com.microsoft.cbl-mariner:def:57467",
                          "link": "https://raw.githubusercontent.com/microsoft/CBL-MarinerVulnerabilityData/main/cbl-mariner-2.0-oval.xml"
                        },
                        {
                          "title": "oval:com.microsoft.azurelinux:def:57389",
                          "link": "https://raw.githubusercontent.com/microsoft/AzureLinuxVulnerabilityData/main/azurelinux-3.0-oval.xml"
                        }
                      ],
                      "cvss": {
                        "2.0": null,
                        "3.0": {
                          "base": 7.5,
                          "cvssVectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"
                        }
                      },
                      "workarounds": [],
                      "publishedDate": "2025-02-26T00:00:00Z",
                      "lastModifiedDate": "2025-08-16T00:00:00Z",
                      "severity": "High",
                      "cpe": {
                        "uri": "cpe:2.3:a:golang.org/x/oauth2:golang.org/x/oauth2:*:*:*:*:*:go:*:*",
                        "part": "0",
                        "vendor": "golang.org/x/oauth2",
                        "product": "golang.org/x/oauth2",
                        "version": "*",
                        "update": "*",
                        "edition": "*",
                        "language": "*",
                        "softwareEdition": "*",
                        "targetSoftware": "go",
                        "targetHardware": "*",
                        "other": "*"
                      },
                      "weaknesses": {
                        "cwe": [
                          {
                            "id": "CWE-1286"
                          }
                        ]
                      },
                      "exploitabilityAssessment": {
                        "isVerified": false,
                        "isPubliclyDisclosed": false,
                        "isInExploitKit": false
                      }
                    },
                    "metadata": {
                      "inventorySource": "Agentless",
                      "scanner": "MicrosoftDefenderVulnerabilityManagement"
                    },
                    "cvssV30Score": 7.5
                  }
                }
              },
              {
                "type": "Microsoft.Security/assessments/subAssessments",
                "id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server/providers/Microsoft.Security/assessments/cababcd3-5678-4006-1234-8abcdef123456d/subassessments/a456456c-5689-2f81-abcd-c1234567890f",
                "name": "a456456c-5689-2f81-abcd-c1234567890f",
                "properties": {
                  "id": "CVE-2024-33601",
                  "displayName": "CVE-2024-33601",
                  "status": {
                    "code": "Unhealthy",
                    "severity": "Medium"
                  },
                  "remediation": "This vulnerability is patchable by a version update",
                  "category": "",
                  "description": "Summary: Multiple vulnerabilities have been identified in the GNU C Library (glibc) affecting the Name Service Cache Daemon (nscd). These include a stack-based buffer overflow (CVE-2024-33599), null pointer dereferences (CVE-2024-33600), memory allocation failures leading to daemon termination (CVE-2024-33601), and assumptions about NSS callback behavior causing memory corruption (CVE-2024-33602). These issues can result in denial of service conditions, potentially crashing the system. Impact: Exploitation of these vulnerabilities could lead to denial of service, unauthorized access to critical data, and potential system crashes, impacting confidentiality, integrity, and availability. AdditionalInformation: The vulnerabilities are present in glibc versions prior to 2.35-7 and 2.38-11. They affect the nscd binary and related components in various Oracle Communications products, with CVSS scores indicating high impact on confidentiality, integrity, and availability. Remediation: Apply the latest patches and updates provided by the respective vendors. [Generated by AI]",
                  "timeGenerated": "2025-09-09T06:13:24.1426566Z",
                  "resourceDetails": {
                    "ResourceName": "metrics-server",
                    "ResourceType": "Container",
                    "ResourceProvider": "Microsoft.ContainerService",
                    "source": "Azure",
                    "id": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server"
                  },
                  "additionalData": {
                    "assessedResourceType": "AzureRuntimeImageVulnerability",
                    "kubernetesDetails": {
                      "cloud": "Azure",
                      "clusterKind": "AKS",
                      "clusterName": "example-dev",
                      "clusterResourceId": "/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev",
                      "namespace": "kube-system",
                      "controllerKind": "replicaset",
                      "controllerName": "metrics-server-*",
                      "podName": "metrics-server-*-*",
                      "containerName": "metrics-server"
                    },
                    "securityGating": {
                      "requestId": "",
                      "evaluatedResourceName": "",
                      "evaluatedResourceKind": ""
                    },
                    "artifactDetails": {
                      "repositoryName": "oss/v2/kubernetes/metrics-server",
                      "registryHost": "mcr.microsoft.com",
                      "digest": "sha256:5cf1d4d9d163ee8c920f75bd5c0481d749bced8a9e50b1b84dad4349a30fac7e",
                      "artifactType": "ContainerImage"
                    },
                    "softwareDetails": {
                      "osDetails": {
                        "osName": "",
                        "osPlatform": "linux",
                        "osVersion": "azure_linux_3"
                      },
                      "packageName": "glibc",
                      "category": "OS",
                      "fixReference": {
                        "id": "40282-1",
                        "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-33601",
                        "description": "CVE-2024-33601 affecting package glibc for versions less than 2.38-11 2025 July 10",
                        "releaseDate": "2025-07-10T15:09:36.653+00:00"
                      },
                      "vendor": "microsoft",
                      "version": "0:2.38-10.azl3",
                      "evidence": [
                        "rpm -qa --qf '%{NAME}:%{Sourcerpm}:\\n' | grep glibc | cut -f 1 -d ':' | xargs rpm -qid"
                      ],
                      "language": "",
                      "fixedVersion": "2.38-11.azl3",
                      "patchable": true,
                      "fixStatus": "FixAvailable"
                    },
                    "vulnerabilityDetails": {
                      "cveId": "CVE-2024-33601",
                      "references": [
                        {
                          "title": "CVE-2024-33601",
                          "link": "https://nvd.nist.gov/vuln/detail/CVE-2024-33601"
                        },
                        {
                          "title": "290170",
                          "link": "https://exchange.xforce.ibmcloud.com/vulnerabilities/290170"
                        },
                        {
                          "title": "CPUOct2024csaf",
                          "link": "https://www.oracle.com/security-alerts/cpuoct2024.html"
                        },
                        {
                          "title": "CVE-2024-33601_oval:com.oracle.elsa:def:202412440",
                          "link": "https://linux.oracle.com/security/oval/com.oracle.elsa-all.xml.bz2"
                        },
                        {
                          "title": "CVE-2024-33601_oval:com.ubuntu.bionic:def:68041000000",
                          "link": "https://security-metadata.canonical.com/oval/com.ubuntu.bionic.usn.oval.xml.bz2"
                        },
                        {
                          "title": "CVE-2024-33601_oval:org.debian:def:149769063730385918523694736664359324893",
                          "link": "https://www.debian.org/security/oval/oval-definitions-bookworm.xml.bz2"
                        },
                        {
                          "title": "oval:org.opensuse.security:def:202433601",
                          "link": "https://ftp.suse.com/pub/projects/security/oval/suse.linux.enterprise.server.12.xml.gz"
                        },
                        {
                          "title": "Amazon Linux 2023 - ALAS2023-2025-988: Medium priority package update for glibc",
                          "link": "https://cdn.amazonlinux.com/al2023/core/guids/8770f111ce93e73734fda41bb7e01fe033ab1320859414932ea453f5e5ea6ba8/x86_64/repodata/updateinfo.xml.gz"
                        },
                        {
                          "title": "oval:com.microsoft.cbl-mariner:def:40316",
                          "link": "https://raw.githubusercontent.com/microsoft/CBL-MarinerVulnerabilityData/main/cbl-mariner-2.0-oval.xml"
                        },
                        {
                          "title": "oval:com.microsoft.azurelinux:def:40282",
                          "link": "https://raw.githubusercontent.com/microsoft/AzureLinuxVulnerabilityData/main/azurelinux-3.0-oval.xml"
                        }
                      ],
                      "cvss": {
                        "2.0": null,
                        "3.0": {
                          "base": 4.0,
                          "cvssVectorString": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:F/RL:U/RC:R"
                        }
                      },
                      "workarounds": [],
                      "publishedDate": "2024-04-23T04:00:00Z",
                      "lastModifiedDate": "2025-08-12T00:00:00Z",
                      "severity": "Medium",
                      "cpe": {
                        "uri": "cpe:2.3:a:microsoft:glibc:*:*:*:*:*:azure_linux_3:*:*",
                        "part": "0",
                        "vendor": "microsoft",
                        "product": "glibc",
                        "version": "*",
                        "update": "*",
                        "edition": "*",
                        "language": "*",
                        "softwareEdition": "*",
                        "targetSoftware": "azure_linux_3",
                        "targetHardware": "*",
                        "other": "*"
                      },
                      "weaknesses": {
                        "cwe": [
                          {
                            "id": "CWE-617"
                          },
                          {
                            "id": "CWE-703"
                          }
                        ]
                      },
                      "exploitabilityAssessment": {
                        "isVerified": false,
                        "isPubliclyDisclosed": false,
                        "isInExploitKit": false
                      }
                    },
                    "metadata": {
                      "inventorySource": "Agentless",
                      "scanner": "MicrosoftDefenderVulnerabilityManagement"
                    },
                    "cvssV30Score": 4.0
                  }
                }
              }
            ],
            "nextLink": "http://{{ hostname }}:{{ env "PORT" }}/subscriptions/5abcdef6-1234-5678-8912-e1234abcdef1/resourcegroups/example-dev_group/providers/microsoft.containerservice/managedclusters/example-dev/securityentitydata/namespace-kube-system-pod-metrics-server-*-*-container-metrics-server/providers/Microsoft.Security/assessments/cababcd3-5678-4006-1234-8abcdef123456d/subAssessments?api-version=2019-01-01-preview&NextLink=next1"
          }
