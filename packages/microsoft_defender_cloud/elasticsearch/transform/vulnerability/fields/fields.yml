- name: microsoft_defender_cloud
  type: group
  fields:
    - name: assessment
      type: group
      fields:
        - name: additional_data
          type: group
          fields:
            - name: can_onboard_to_byol
              type: boolean
            - name: controller_name
              type: keyword
            - name: controller_type
              type: keyword
            - name: cves
              type: group
              fields:
                - name: base_score
                  type: float
                - name: cve
                  type: keyword
                - name: severity
                  type: keyword
            - name: cves_count
              type: long
            - name: digest
              type: keyword
            - name: edrs_found
              type: keyword
            - name: highest_severity
              type: keyword
            - name: identity_designate_less_than_xowners_object_id_list
              type: keyword
            - name: image_uri
              type: keyword
            - name: inventory_source
              type: keyword
            - name: k8s_cluster_id
              type: keyword
            - name: k8s_cluster_name
              type: keyword
            - name: max_cvss30_score
              type: float
            - name: namespace
              type: keyword
            - name: nsg_open_ports
              type: long
            - name: os_distribution
              type: keyword
            - name: os_type
              type: keyword
            - name: pod_name
              type: keyword
            - name: repo
              type: keyword
            - name: resource_name
              type: keyword
            - name: resource_provider
              type: keyword
            - name: resource_type
              type: keyword
            - name: resource_url
              type: keyword
            - name: role_and_scope
              type: keyword
            - name: sub_assessment
              type: group
              fields:
                - name: additional_data
                  type: group
                  fields:
                    - name: affected_nodes
                      type: keyword
                    - name: aggregate_server_resource_metadata
                      type: group
                      fields:
                        - name: managed_aggregate_resource_id
                          type: keyword
                        - name: managed_pool_name
                          type: keyword
                    - name: artifact_details
                      type: group
                      fields:
                        - name: artifact_type
                          type: keyword
                        - name: digest
                          type: keyword
                        - name: registry_host
                          type: keyword
                        - name: repository_name
                          type: keyword
                    - name: assessed_resource_type
                      type: keyword
                    - name: cluster_details
                      type: group
                      fields:
                        - name: cluster_name
                          type: keyword
                        - name: cluster_resource_id
                          type: keyword
                    - name: cve
                      type: group
                      fields:
                        - name: cvss_score
                          type: float
                        - name: cvss_vector_string
                          type: keyword
                        - name: cvss_version
                          type: keyword
                        - name: description
                          type: keyword
                        - name: exploit_types
                          type: keyword
                        - name: exploitability_level
                          type: keyword
                        - name: has_public_exploit
                          type: boolean
                        - name: is_exploit_in_kit
                          type: boolean
                        - name: is_exploit_verified
                          type: boolean
                        - name: is_zero_day
                          type: boolean
                        - name: last_modified_date
                          type: date
                        - name: published_date
                          type: date
                        - name: severity
                          type: keyword
                        - name: title
                          type: keyword
                    - name: cve_edges_details
                      type: group
                      fields:
                        - name: cve_id_as_source_node_id
                          type: keyword
                    - name: cve_list
                      type: group
                      fields:
                        - name: cvss_score
                          type: float
                        - name: cvss_vector_string
                          type: keyword
                        - name: cvss_version
                          type: keyword
                        - name: description
                          type: keyword
                        - name: exploit_types
                          type: keyword
                        - name: exploitability_level
                          type: keyword
                        - name: has_public_exploit
                          type: boolean
                        - name: is_exploit_in_kit
                          type: boolean
                        - name: is_exploit_verified
                          type: boolean
                        - name: is_zero_day
                          type: boolean
                        - name: last_modified_date
                          type: date
                        - name: published_date
                          type: date
                        - name: severity
                          type: keyword
                        - name: title
                          type: keyword
                    - name: cvss_v30_score
                      type: float
                    - name: data
                      type: group
                      fields:
                        - name: resources
                          type: keyword
                        - name: signature_update_date
                          type: keyword
                    - name: fixed_cluster_version
                      type: keyword
                    - name: fixed_node_pool_version
                      type: keyword
                    - name: installed_cluster_version
                      type: keyword
                    - name: installed_node_pool_version
                      type: keyword
                    - name: kubernetes_context
                      type: group
                      fields:
                        - name: workloads
                          type: group
                          fields:
                            - name: kind
                              type: keyword
                            - name: name
                              type: keyword
                            - name: namespace
                              type: keyword
                            - name: owned_resources
                              type: group
                              fields:
                                - name: containers
                                  type: group
                                  fields:
                                    - name: name
                                      type: keyword
                                - name: kind
                                  type: keyword
                                - name: name
                                  type: keyword
                    - name: kubernetes_details
                      type: group
                      fields:
                        - name: cloud
                          type: keyword
                        - name: cluster_kind
                          type: keyword
                        - name: cluster_name
                          type: keyword
                        - name: cluster_resource_id
                          type: keyword
                        - name: container_name
                          type: keyword
                        - name: controller_kind
                          type: keyword
                        - name: controller_name
                          type: keyword
                        - name: namespace
                          type: keyword
                        - name: pod_name
                          type: keyword
                    - name: metadata
                      type: group
                      fields:
                        - name: inventory_source
                          type: keyword
                        - name: scanner
                          type: keyword
                    - name: recommended_program
                      type: keyword
                    - name: recommended_vendor
                      type: keyword
                    - name: recommended_version
                      type: keyword
                    - name: resource_id_as_target_node_id
                      type: group
                      fields:
                        - name: azure_resource_id
                          type: keyword
                        - name: target_resource_id
                          type: keyword
                        - name: target_resource_type
                          type: keyword
                    - name: security_gating
                      type: group
                      fields:
                        - name: evaluated_resource_kind
                          type: keyword
                        - name: evaluated_resource_name
                          type: keyword
                        - name: request_id
                          type: keyword
                    - name: software_details
                      type: group
                      fields:
                        - name: category
                          type: keyword
                        - name: evidence
                          type: keyword
                        - name: fix_reference
                          type: group
                          fields:
                            - name: description
                              type: keyword
                            - name: id
                              type: keyword
                            - name: release_date
                              type: keyword
                            - name: url
                              type: keyword
                        - name: fix_status
                          type: keyword
                        - name: fixed_version
                          type: keyword
                        - name: language
                          type: keyword
                        - name: os_details
                          type: group
                          fields:
                            - name: os_name
                              type: keyword
                            - name: os_platform
                              type: keyword
                            - name: os_version
                              type: keyword
                        - name: package_name
                          type: keyword
                        - name: patchable
                          type: boolean
                        - name: vendor
                          type: keyword
                        - name: version
                          type: keyword
                    - name: software_name
                      type: keyword
                    - name: software_vendor
                      type: keyword
                    - name: software_version
                      type: keyword
                    - name: source
                      type: keyword
                    - name: vulnerability_details
                      type: group
                      fields:
                        - name: cpe
                          type: group
                          fields:
                            - name: edition
                              type: keyword
                            - name: language
                              type: keyword
                            - name: other
                              type: keyword
                            - name: part
                              type: keyword
                            - name: product
                              type: keyword
                            - name: software_edition
                              type: keyword
                            - name: target_hardware
                              type: keyword
                            - name: target_software
                              type: keyword
                            - name: update
                              type: keyword
                            - name: uri
                              type: keyword
                            - name: vendor
                              type: keyword
                            - name: version
                              type: keyword
                        - name: cve_id
                          type: keyword
                        - name: cvss_v2
                          type: group
                          fields:
                            - name: base
                              type: float
                            - name: cvss_vector_string
                              type: keyword
                        - name: cvss_v3
                          type: group
                          fields:
                            - name: base
                              type: float
                            - name: cvss_vector_string
                              type: keyword
                        - name: cvss_v4
                          type: group
                          fields:
                            - name: base
                              type: float
                            - name: cvss_vector_string
                              type: keyword
                        - name: exploitability_assessment
                          type: group
                          fields:
                            - name: is_in_exploit_kit
                              type: boolean
                            - name: is_publicly_disclosed
                              type: boolean
                            - name: is_verified
                              type: boolean
                        - name: last_modified_date
                          type: date
                        - name: published_date
                          type: date
                        - name: references
                          type: group
                          fields:
                            - name: link
                              type: keyword
                            - name: title
                              type: keyword
                        - name: severity
                          type: keyword
                        - name: weaknesses
                          type: group
                          fields:
                            - name: cwe
                              type: group
                              fields:
                                - name: id
                                  type: keyword
                - name: category
                  type: keyword
                - name: description
                  type: keyword
                - name: display_name
                  type: keyword
                - name: event_id
                  type: keyword
                - name: id
                  type: keyword
                - name: impact
                  type: keyword
                - name: name
                  type: keyword
                - name: remediation
                  type: keyword
                - name: resource_details
                  type: group
                  fields:
                    - name: id
                      type: keyword
                    - name: native_resource_id
                      type: keyword
                    - name: resource_name
                      type: keyword
                    - name: resource_provider
                      type: keyword
                    - name: resource_type
                      type: keyword
                    - name: source
                      type: keyword
                - name: status
                  type: group
                  fields:
                    - name: cause
                      type: keyword
                    - name: code
                      type: keyword
                    - name: description
                      type: keyword
                    - name: severity
                      type: keyword
                - name: time_generated
                  type: keyword
                - name: type
                  type: keyword
            - name: sub_assessments_link
              type: keyword
            - name: tags
              type: keyword
        - name: class
          type: keyword
        - name: display_name
          type: keyword
        - name: id
          type: keyword
        - name: name
          type: keyword
        - name: resource_details
          type: group
          fields:
            - name: id
              type: keyword
            - name: native_resource_id
              type: keyword
            - name: resource_id
              type: keyword
            - name: resource_name
              type: keyword
            - name: resource_provider
              type: keyword
            - name: resource_type
              type: keyword
            - name: source
              type: keyword
        - name: status
          type: group
          fields:
            - name: cause
              type: keyword
            - name: code
              type: keyword
            - name: description
              type: keyword
            - name: first_evaluation_date
              type: date
            - name: status_change_date
              type: date
        - name: type
          type: keyword
