processors:
  - set:
      field: event.dataset
      value: withsecure_elements.security_events
  - set:
      field: event.module
      value: withsecure_elements
  - set:
      field: event.category
      value: threat
  - set:
      field: event.type
      value: info
  - set:
      field: event.kind
      value: event
  - set:
      field: event.provider
      value: withsecure_elements
  - set:
      field: event.action
      value: "{{action}}"
  - set:
      field: event.outcome
      value: success
  - set:
      field: event.id
      value: "{{id}}"
  - set:
      field: event.created
      value: "{{serverTimestamp}}"
  - set:
      field: event.start
      value: "{{serverTimestamp}}"
  - set:
      field: event.end
      value: "{{persistenceTimestamp}}"
  - set:
      field: event.severity
      value: "{{severity}}"
  - set:
      field: event.original
      value: "{{_source}}"
  - set:
      field: withsecure.security.event.id
      value: "{{id}}"
  - set:
      field: withsecure.security.event.action
      value: "{{action}}"
  - set:
      field: withsecure.security.event.engine
      value: "{{engine}}"
  - set:
      field: withsecure.security.event.severity
      value: "{{severity}}"
  - set:
      field: withsecure.security.event.message
      value: "{{message}}"
  - set:
      field: withsecure.security.event.description
      value: "{{description}}"
  - set:
      field: withsecure.security.event.server_timestamp
      value: "{{serverTimestamp}}"
  - set:
      field: withsecure.security.event.persistence_timestamp
      value: "{{persistenceTimestamp}}"
  - set:
      field: withsecure.security.event.client_timestamp
      value: "{{clientTimestamp}}"
  - set:
      field: withsecure.security.event.event_transaction_id
      value: "{{eventTransactionId}}"
  - set:
      field: withsecure.security.event.acknowledged
      value: "{{acknowledged}}"
  - set:
      field: withsecure.security.event.acknowledged_by
      value: "{{acknowledgedBy}}"
  - set:
      field: withsecure.security.event.ack_timestamp
      value: "{{ackTimestamp}}"
  - set:
      field: withsecure.security.event.organization.id
      value: "{{organization.id}}"
  - set:
      field: withsecure.security.event.organization.name
      value: "{{organization.name}}"
  - set:
      field: withsecure.security.event.target.id
      value: "{{target.id}}"
  - set:
      field: withsecure.security.event.target.name
      value: "{{target.name}}"
  - set:
      field: withsecure.security.event.device.id
      value: "{{device.id}}"
  - set:
      field: withsecure.security.event.device.name
      value: "{{device.name}}"
  - set:
      field: withsecure.security.event.user_name
      value: "{{userName}}"
  - set:
      field: withsecure.security.event.details
      value: "{{details}}"
