---
processors:
  - set:
      field: event.dataset
      value: withsecure_elements.incidents
  - set:
      field: event.module
      value: withsecure_elements
  - set:
      field: event.category
      value: threat
  - set:
      field: event.type
      value: incident
  - set:
      field: event.kind
      value: alert
  - set:
      field: event.provider
      value: withsecure_elements
  - set:
      field: event.action
      value: detected
  - set:
      field: event.outcome
      value: success
  - set:
      field: event.id
      value: "{{withsecure.incident.id}}"
  - set:
      field: event.created
      value: "{{withsecure.incident.created_timestamp}}"
  - set:
      field: event.start
      value: "{{withsecure.incident.created_timestamp}}"
  - set:
      field: event.end
      value: "{{withsecure.incident.updated_timestamp}}"
  - set:
      field: event.severity
      value: "{{withsecure.incident.severity}}"
  - set:
      field: event.risk_score
      value: "{{withsecure.incident.risk_score}}"
  - set:
      field: event.original
      value: "{{_source}}"
  - set:
      field: withsecure.incident.status
      value: "{{status}}"
  - set:
      field: withsecure.incident.severity
      value: "{{severity}}"
  - set:
      field: withsecure.incident.risk_level
      value: "{{riskLevel}}"
  - set:
      field: withsecure.incident.risk_score
      value: "{{riskScore}}"
  - set:
      field: withsecure.incident.resolution
      value: "{{resolution}}"
  - set:
      field: withsecure.incident.created_timestamp
      value: "{{createdTimestamp}}"
  - set:
      field: withsecure.incident.updated_timestamp
      value: "{{updatedTimestamp}}"
  - set:
      field: withsecure.incident.initial_received_timestamp
      value: "{{initialReceivedTimestamp}}"
  - set:
      field: withsecure.incident.categories
      value: "{{categories}}"
  - set:
      field: withsecure.incident.sources
      value: "{{sources}}"
  - set:
      field: withsecure.incident.name
      value: "{{name}}"
  - set:
      field: withsecure.incident.public_id
      value: "{{incidentPublicId}}"
  - set:
      field: withsecure.incident.organization_id
      value: "{{organizationId}}"
