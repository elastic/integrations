processors:
  - set:
      field: event.dataset
      value: withsecure_elements.incident_detections
  - set:
      field: event.module
      value: withsecure_elements
  - set:
      field: event.category
      value: threat
  - set:
      field: event.type
      value: detection
  - set:
      field: event.kind
      value: alert
  - set:
      field: event.provider
      value: withsecure_elements
  - set:
      field: event.action
      value: detected
  - set:
      field: event.outcome
      value: success
  - set:
      field: event.id
      value: "{{id}}"
  - set:
      field: event.created
      value: "{{createdTimestamp}}"
  - set:
      field: event.start
      value: "{{createdTimestamp}}"
  - set:
      field: event.end
      value: "{{updatedTimestamp}}"
  - set:
      field: event.severity
      value: "{{severity}}"
  - set:
      field: event.original
      value: "{{_source}}"
  - set:
      field: withsecure.incident.detection.id
      value: "{{id}}"
  - set:
      field: withsecure.incident.detection.incident_id
      value: "{{incidentId}}"
  - set:
      field: withsecure.incident.detection.detection_type
      value: "{{detectionType}}"
  - set:
      field: withsecure.incident.detection.severity
      value: "{{severity}}"
  - set:
      field: withsecure.incident.detection.status
      value: "{{status}}"
  - set:
      field: withsecure.incident.detection.created_timestamp
      value: "{{createdTimestamp}}"
  - set:
      field: withsecure.incident.detection.updated_timestamp
      value: "{{updatedTimestamp}}"
  - set:
      field: withsecure.incident.detection.source
      value: "{{source}}"
  - set:
      field: withsecure.incident.detection.category
      value: "{{category}}"
  - set:
      field: withsecure.incident.detection.description
      value: "{{description}}"
  - set:
      field: withsecure.incident.detection.details
      value: "{{details}}"
  - set:
      field: withsecure.incident.detection.device.id
      value: "{{device.id}}"
  - set:
      field: withsecure.incident.detection.device.name
      value: "{{device.name}}"
  - set:
      field: withsecure.incident.detection.device.ip_address
      value: "{{device.ipAddress}}"
  - set:
      field: withsecure.incident.detection.device.os
      value: "{{device.os}}"
  - set:
      field: withsecure.incident.detection.user.id
      value: "{{user.id}}"
  - set:
      field: withsecure.incident.detection.user.name
      value: "{{user.name}}"
  - set:
      field: withsecure.incident.detection.user.email
      value: "{{user.email}}"
  - set:
      field: withsecure.incident.detection.file.name
      value: "{{file.name}}"
  - set:
      field: withsecure.incident.detection.file.path
      value: "{{file.path}}"
  - set:
      field: withsecure.incident.detection.file.hash
      value: "{{file.hash}}"
  - set:
      field: withsecure.incident.detection.file.size
      value: "{{file.size}}"
  - set:
      field: withsecure.incident.detection.network.source_ip
      value: "{{network.sourceIp}}"
  - set:
      field: withsecure.incident.detection.network.destination_ip
      value: "{{network.destinationIp}}"
  - set:
      field: withsecure.incident.detection.network.port
      value: "{{network.port}}"
  - set:
      field: withsecure.incident.detection.network.protocol
      value: "{{network.protocol}}"
