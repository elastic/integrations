title: Auditd System Package
type: logs
streams:
  - input: audit/system
    title: Auditd System Package
    description: Collect logs from System Package Managers with Elastic Agent.
    template_path: system_package.yml.hbs
    vars:
      - name: period
        type: text
        title: Period
        description: |
          The frequency at which the datasets check for changes.
        required: true
        show_user: true
        default: 2m
      - name: state_period
        type: text
        title: System State Period
        description: |
          How often datasets send state updates with the current state of the system (e.g. all currently running processes, all open sockets).
        required: true
        show_user: true
        default: 12h
      - name: data_stream.dataset
        type: text
        title: Dataset name
        description: |
          Dataset to write data to. Changing the dataset will send the data to a different index. You can't use `-` in the name of a dataset and only valid characters for [Elasticsearch index names](https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-index_.html).
        default: system_package.generic
        required: true
        show_user: true
      - name: pipeline
        type: text
        title: Ingest Pipeline
        description: |
          The Ingest Node pipeline ID to be used by the integration.
        required: false
        show_user: true
      - name: preserve_original_event
        type: bool
        title: Preserve Original Event
        description: This option copies the raw unmodified body of the incoming request to the event.original field as a string before sending the event to Elasticsearch.
        required: false
        show_user: true
      - name: processors
        type: yaml
        title: Processors
        multi: false
        required: false
        show_user: false
        description: |
          Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.
      - name: tags
        type: text
        title: Tags
        description: Tags to include in the published event
        required: false
        default:
          - forwarded
          - auditd-system-package
        multi: true
        show_user: true
