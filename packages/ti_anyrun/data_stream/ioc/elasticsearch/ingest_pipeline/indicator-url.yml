---
description: "Pipeline for processing URL STIX patterns"
processors:
  - grok:
      field: "_ingest._value"
      tag: "grok_url_pattern"
      patterns:
        - "^\\[?url:value%{SPACE}=%{SPACE}'%{DATA:_tmp.url}'\\]?"
      ignore_failure: true
  - append:
      field: "threat.indicator.url.original"
      value: "{{{ _tmp.url }}}"
      if: "ctx._tmp?.url != null"
  - append:
      field: "threat.indicator.name"
      value: "{{{ _tmp.url }}}"
      if: "ctx._tmp?.url != null"
  - append:
      field: "threat.indicator.url.full"
      value: "{{{ _tmp.url }}}"
      if: "ctx._tmp?.url != null"      
  - remove:
      field: "_tmp"
      ignore_missing: true
