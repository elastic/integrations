# Varonis integration

[Varonis](https://www.varonis.com/) is a data security platform that helps organizations protect their sensitive data from insider threats and cyberattacks. This integration collects and analyzes security alerts from Varonis, enabling real-time threat monitoring, compliance reporting, and incident response.

## Data Streams

- **`logs`**: Provides alert data from Varonis syslog. This data stream includes information about alerts generated by Varonis, such as the alert type, severity, file permission changes, and more.

## Requirements

### Configure Varonis DatAlert for Syslog forwarding:

Users can configure the syslog server address in DatAlert so that alerts can be sent to elasticsearch integration. 
   - Login to the Varonis UI using admin credentials.
   - In Data Advantage, select `Tools > DatAlert > Select DatAlert`.
   - From the left menu, select `Configuration`.
   - In syslog message forwarding, do the following:
     - **Syslog server IP address**: Enter the IP address of the machine where the Elasticsearch integration agent is running.
     - **Port**: Enter the UDP port on which this integration will be configured (e.g., 9035).
   - Click `Apply`.

### Create Alert Template in Varonis DatAlert:

1. In DatAlert, select `Alert Templates`.
2. Click the Green Plus sign to add a new alert template.
3. **Template name**: Select `External system default template (CEF)`.
4. **Apply to alert methods**: Select `Syslog message`.
5. Click `OK`.

This integration expects to use `External system default template (CEF)` for alert forwarding in Varonis DatAlert tool. In case any custom template is used, all the fields in `External system default template (CEF)` should also be present in custom template along with the other additional fields. Additional fields will be part of `varonis.logs` object and such fields will be indexed only if dynamic mapping is enabled in Elasticsearch.

## Pre-Processors

There are cases where incoming CEF messages do not follow the CEF specification exactly, and this can cause errors with
message decoding. To work around this, there is an option for pre-processors, which are run before the CEF message is decoded.
These can be used modify the message to follow the CEF specification correctly, which will allow proper decoding.

The pre-processors will modify the `message` field before CEF decoding is done on the agent, but the original, non-preprocessed,
message will still be preserved in the `event.original` field when the agent sends the event.

## Logs reference

### varonis.logs

Logs documents can be found by setting the following filter: 
`event.dataset : "varonis.logs"`

{{event "logs"}}

    
**ECS Field Reference**

Please refer to the following [document](https://www.elastic.co/guide/en/ecs/current/ecs-field-reference.html) for detailed information on ECS fields.

The following non-ECS fields are used in events documents:

{{fields "logs"}}
