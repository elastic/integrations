{
    "attributes": {
      "id": "pad-ml",
      "title": "Privileged Access Detection",
      "description": "Detects anomalous privileged access activity in the Windows, Linux and Okta logs.",
      "type": "pad",
      "logo": {
        "icon": "machineLearningApp"
      },
      "query": {
        "bool": {
          "should": [
            {
              "bool": {
                "must": [
                  {
                    "terms": {
                      "host.os.type": [
                        "windows",
                        "Windows"
                      ]
                    }
                  },
                  {
                    "exists": {
                      "field": "winlog.event_id"
                    }
                  }
                ]
              }
            },
            {
              "bool": {
                "must": [
                  {
                    "terms": {
                      "host.os.type": [
                        "linux",
                        "Linux"
                      ]
                    }
                  },
                  {
                    "term": {
                      "event.category": "process"
                    }
                  }
                ]
              }
            },
            {
              "exists": {
                "field": "privilege_type"
              }
            },
            {
              "term": {
                "data_stream.dataset": "okta.system"
              }
            },
            {
              "exists": {
                "field": "okta_distinct_ips"
              }
            }
          ],
          "must_not": {
            "terms": {
              "_tier": [
                "data_frozen",
                "data_cold"
              ]
            }
          }
        }
      },
      "jobs": [
        {
          "id": "pad_windows_high_count_special_logon_events",
          "config": {
            "groups": [
              "security",
              "pad",
              "windows"
            ],
            "description": "Detects unusually high special logon events initiated by a user.",
            "analysis_config": {
              "bucket_span": "3h",
              "detectors": [
                {
                  "detector_description": "High count of special logon events",
                  "function": "high_non_zero_count",
                  "by_field_name": "event.action",
                  "partition_field_name": "user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "host.name",
                "user.name",
                "winlog.event_data.SubjectUserName",
                "winlog.event_data.PrivilegeList",
                "winlog.event_data.TargetUserName",
                "process.name"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_windows_high_count_special_privilege_use_events",
          "config": {
            "groups": [
              "security",
              "pad",
              "windows"
            ],
            "description": "Detects unusually high special privilege use events initiated by a user.",
            "analysis_config": {
              "bucket_span": "3h",
              "detectors": [
                {
                  "detector_description": "High count of special privilege use events",
                  "function": "high_non_zero_count",
                  "by_field_name": "event.action",
                  "partition_field_name": "user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "host.name",
                "user.name",
                "winlog.event_data.SubjectUserName",
                "winlog.event_data.PrivilegeList",
                "process.name"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_windows_high_count_group_management_events",
          "config": {
            "groups": [
              "security",
              "pad",
              "windows"
            ],
            "description": "Detects unusually high security group management events initiated by a user.",
            "analysis_config": {
              "bucket_span": "3h",
              "detectors": [
                {
                  "detector_description": "High count of security group management events",
                  "function": "high_non_zero_count",
                  "by_field_name": "event.action",
                  "partition_field_name": "user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "host.name",
                "user.name",
                "winlog.event_data.SubjectUserName",
                "group.name",
                "winlog.event_data.TargetUserName"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_windows_high_count_user_account_management_events",
          "config": {
            "groups": [
              "security",
              "pad",
              "windows"
            ],
            "description": "Detects unusually high security user account management events initiated by a user.",
            "analysis_config": {
              "bucket_span": "3h",
              "detectors": [
                {
                  "detector_description": "High count of security user account management events",
                  "function": "high_non_zero_count",
                  "by_field_name": "event.action",
                  "partition_field_name": "user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "host.name",
                "user.name",
                "winlog.event_data.SubjectUserName",
                "winlog.event_data.TargetUserName"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_windows_rare_privilege_assigned_to_user",
          "config": {
            "groups": [
              "security",
              "pad",
              "windows"
            ],
            "description": "Detects an unusual privilege type assigned to a user.",
            "analysis_config": {
              "bucket_span": "1h",
              "detectors": [
                {
                  "detector_description": "Rare privilege type by user name",
                  "function": "rare",
                  "by_field_name": "privilege_type",
                  "partition_field_name": "user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "host.name",
                "user.name",
                "privilege_type",
                "event.action"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_windows_rare_group_name_by_user",
          "config": {
            "groups": [
              "security",
              "pad",
              "windows"
            ],
            "description": "Detects an unusual group name accessed by a user.",
            "analysis_config": {
              "bucket_span": "1h",
              "detectors": [
                {
                  "detector_description": "Rare group name by user name",
                  "function": "rare",
                  "by_field_name": "group.name",
                  "partition_field_name": "user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "host.name",
                "user.name",
                "group.name",
                "winlog.event_data.TargetUserName",
                "event.action"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_windows_rare_device_by_user",
          "config": {
            "groups": [
              "security",
              "pad",
              "windows"
            ],
            "description": "Detects an unusual device accessed by a user.",
            "analysis_config": {
              "bucket_span": "1h",
              "detectors": [
                {
                  "detector_description": "Rare device name by user name",
                  "function": "rare",
                  "by_field_name": "host.name",
                  "partition_field_name": "user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "host.name",
                "user.name",
                "group.name",
                "winlog.event_data.PrivilegeList",
                "event.action"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_windows_rare_source_ip_by_user",
          "config": {
            "groups": [
              "security",
              "pad",
              "windows"
            ],
            "description": "Detects an unusual source IP address accessed by a user.",
            "analysis_config": {
              "bucket_span": "1h",
              "detectors": [
                {
                  "detector_description": "Rare source IP by user name",
                  "function": "rare",
                  "by_field_name": "source.ip",
                  "partition_field_name": "user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "host.name",
                "user.name",
                "source.ip",
                "winlog.event_data.PrivilegeList",
                "event.action"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_windows_rare_region_name_by_user",
          "config": {
            "groups": [
              "security",
              "pad",
              "windows"
            ],
            "description": "Detects an unusual region name for a user.",
            "analysis_config": {
              "bucket_span": "1h",
              "detectors": [
                {
                  "detector_description": "Rare region name by user",
                  "function": "rare",
                  "by_field_name": "source.geo.region_name",
                  "partition_field_name": "user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "host.name",
                "user.name",
                "source.geo.city_name",
                "source.geo.country_name",
                "winlog.event_data.PrivilegeList",
                "event.action"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_linux_high_count_privileged_process_events_by_user",
          "config": {
            "groups": [
              "security",
              "pad",
              "linux"
            ],
            "description": "Detects a spike in privileged commands executed by a user.",
            "analysis_config": {
              "bucket_span": "3h",
              "detectors": [
                {
                  "detector_description": "High count of privileged processes by user name",
                  "function": "high_non_zero_count",
                  "partition_field_name": "user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "host.name",
                "user.name",
                "process.name",
                "process.command_line"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_linux_rare_process_executed_by_user",
          "config": {
            "groups": [
              "security",
              "pad",
              "linux"
            ],
            "description": "Detects a rare process executed by a user.",
            "analysis_config": {
              "bucket_span": "1h",
              "detectors": [
                {
                  "detector_description": "Rare process by user name",
                  "function": "rare",
                  "by_field_name": "process.name",
                  "partition_field_name": "user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "host.name",
                "user.name",
                "process.name"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_linux_high_median_process_command_line_entropy_by_user",
          "config": {
            "groups": [
              "security",
              "pad",
              "linux"
            ],
            "description": "Detects process command lines executed by a user with an abnormally high median entropy value. This job requires some manual setup before it can run successfully, specifically adding custom field mappings for data coming from an ingest pipeline. Instructions for these steps are available in the package overview.",
            "analysis_config": {
              "bucket_span": "30m",
              "detectors": [
                {
                  "detector_description": "High median of process argument count by user name",
                  "function": "high_median",
                  "field_name": "process.command_line_entropy",
                  "partition_field_name": "user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "host.name",
                "user.name",
                "process.command_line"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_okta_spike_in_group_membership_changes",
          "config": {
            "groups": [
              "security",
              "pad",
              "okta"
            ],
            "description": "Detects spike in group membership change events by a user.",
            "analysis_config": {
              "bucket_span": "3h",
              "detectors": [
                {
                  "detector_description": "High count of group membership okta events by user name",
                  "function": "high_non_zero_count",
                  "by_field_name": "okta.event_type",
                  "partition_field_name": "source.user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                  "agent.name",
                  "source.user.name",
                  "source.user.full_name",
                  "user.target.full_name",
                  "user.target.group.name"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_okta_spike_in_user_lifecycle_management_changes",
          "config": {
            "groups": [
              "security",
              "pad",
              "okta"
            ],
            "description": "Detects spike in user lifecycle management change events by a user.",
            "analysis_config": {
              "bucket_span": "3h",
              "detectors": [
                {
                  "detector_description": "High count of user lifecycle management okta events by user name",
                  "function": "high_non_zero_count",
                  "by_field_name": "okta.event_type",
                  "partition_field_name": "source.user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                  "agent.name",
                  "source.user.name",
                  "source.user.full_name",
                  "user.target.full_name",
                  "user.target.group.name"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_okta_spike_in_group_privilege_changes",
          "config": {
            "groups": [
              "security",
              "pad",
              "okta"
            ],
            "description": "Detects spike in group privilege change events by a user.",
            "analysis_config": {
              "bucket_span": "3h",
              "detectors": [
                {
                  "detector_description": "High count of group privilege okta events by user name",
                  "function": "high_non_zero_count",
                  "by_field_name": "okta.event_type",
                  "partition_field_name": "source.user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                  "agent.name",
                  "source.user.name",
                  "source.user.full_name",
                  "user.target.full_name",
                  "user.target.group.name",
                  "okta.debug_context.debug_data.privilegeGranted",
                  "okta.debug_context.debug_data.privilegeRevoked"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_okta_spike_in_group_application_assignment_changes",
          "config": {
            "groups": [
              "security",
              "pad",
              "okta"
            ],
            "description": "Detects spike in group application assignment change events by a user.",
            "analysis_config": {
              "bucket_span": "3h",
              "detectors": [
                {
                  "detector_description": "High count of group application assignment okta events by user name",
                  "function": "high_non_zero_count",
                  "by_field_name": "okta.event_type",
                  "partition_field_name": "source.user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                  "agent.name",
                  "source.user.name",
                  "source.user.full_name",
                  "user.target.group.name"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_okta_spike_in_group_lifecycle_changes",
          "config": {
            "groups": [
              "security",
              "pad",
              "okta"
            ],
            "description": "Detects spike in group lifecycle change events by a user.",
            "analysis_config": {
              "bucket_span": "3h",
              "detectors": [
                {
                  "detector_description": "High count of group lifecycle okta events by user name",
                  "function": "high_non_zero_count",
                  "by_field_name": "okta.event_type",
                  "partition_field_name": "source.user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                  "agent.name",
                  "source.user.name",
                  "source.user.full_name",
                  "user.target.group.name"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_okta_high_sum_concurrent_sessions_by_user",
          "config": {
            "groups": [
              "security",
              "pad",
              "okta"
            ],
            "description": "Detects an unusual sum of active sessions started by a user.",
            "analysis_config": {
              "bucket_span": "3h",
              "detectors": [
                {
                  "detector_description": "High sum of distinct source ips by user name",
                  "function": "high_sum",
                  "field_name": "okta_distinct_ips",
                  "partition_field_name": "source.user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                  "source.user.name",
                  "agent.name",
                  "source.user.full_name"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_okta_rare_source_ip_by_user",
          "config": {
            "groups": [
              "security",
              "pad",
              "okta"
            ],
            "description": "Detects an unusual source IP address accessed by a user.",
            "analysis_config": {
              "bucket_span": "1h",
              "detectors": [
                {
                  "detector_description": "Rare source ip by user name",
                  "function": "rare",
                  "by_field_name": "source.ip",
                  "partition_field_name": "source.user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "agent.name",
                "source.user.full_name",
                "user.target.group.name",
                "okta.event_type"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_okta_rare_region_name_by_user",
          "config": {
            "groups": [
              "security",
              "pad",
              "okta"
            ],
            "description": "Detects an unusual region name for a user.",
            "analysis_config": {
              "bucket_span": "1h",
              "detectors": [
                {
                  "detector_description": "Rare region name by user name",
                  "function": "rare",
                  "by_field_name": "client.geo.region_name",
                  "partition_field_name": "source.user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "agent.name",
                "source.user.full_name",
                "user.target.group.name",
                "okta.event_type",
                "client.geo.country_name"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        },
        {
          "id": "pad_okta_rare_host_name_by_user",
          "config": {
            "groups": [
              "security",
              "pad",
              "okta"
            ],
            "description": "Detects an unusual host name for a user.",
            "analysis_config": {
              "bucket_span": "1h",
              "detectors": [
                {
                  "detector_description": "Rare host name by user name",
                  "function": "rare",
                  "by_field_name": "agent.name",
                  "partition_field_name": "source.user.name",
                  "detector_index": 0
                }
              ],
              "influencers": [
                "agent.name",
                "source.user.full_name",
                "user.target.group.name",
                "okta.event_type"
              ]
            },
            "data_description": {
              "time_field": "@timestamp",
              "time_format": "epoch_ms"
            },
            "custom_settings": {
              "created_by": "ml-module-pad"
            }
          }
        }
      ],
      "datafeeds": [
        {
          "id": "datafeed-pad_windows_high_count_special_logon_events",
          "job_id": "pad_windows_high_count_special_logon_events",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_windows_high_count_special_logon_events",
            "query": {
              "bool": {
                "filter": [
                  {
                    "terms": {
                      "host.os.type": [
                        "windows",
                        "Windows"
                      ]
                    }
                  },
                  {
                    "terms": {
                      "event.action": [
                        "logged-in-special",
                        "logged-in-explicit"
                      ]
                    }
                  },
                  {
                    "terms": {
                      "event.code": [
                        "4672",
                        "4648"
                      ]
                    }
                  }
                ],
                "must_not": [
                {
                  "terms": {
                    "process.name":
                    [ "elastic-agent.exe",
                    "elastic-agent",
                    "metricbeat.exe",
                    "metricbeat",
                    "filebeat.exe",
                    "filebeat",
                    "packetbeat.exe",
                    "packetbeat",
                    "winlogbeat.exe",
                    "winlogbeat" ]
                  }
                 }
                ]
              }
            }
          }
        },
        {
          "id": "datafeed-pad_windows_high_count_special_privilege_use_events",
          "job_id": "pad_windows_high_count_special_privilege_use_events",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_windows_high_count_special_privilege_use_events",
            "query": {
              "bool": {
                "filter": [
                  {
                    "terms": {
                      "host.os.type": [
                        "windows",
                        "Windows"
                      ]
                    }
                  },
                  {
                    "terms": {
                      "event.action": [
                        "privileged-operation",
                        "privileged-service-called"
                      ]
                    }
                  },
                  {
                    "terms": {
                      "event.code": [
                        "4673",
                        "4674"
                      ]
                    }
                  }
                ],
                "must_not": [
                {
                  "terms": {
                    "process.name":
                    [ "elastic-agent.exe",
                    "elastic-agent",
                    "metricbeat.exe",
                    "metricbeat",
                    "filebeat.exe",
                    "filebeat",
                    "packetbeat.exe",
                    "packetbeat",
                    "winlogbeat.exe",
                    "winlogbeat" ]
                  }
                 }
                ]
              }
            }
          }
        },
        {
          "id": "datafeed-pad_windows_high_count_group_management_events",
          "job_id": "pad_windows_high_count_group_management_events",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_windows_high_count_group_management_events",
            "query": {
              "bool": {
                "filter": [
                  {
                    "terms": {
                      "host.os.type": [
                        "windows",
                        "Windows"
                      ]
                    }
                  },
                  {
                    "terms": {
                      "event.action": [
                        "added-member-to-group",
                        "removed-member-from-group"
                      ]
                    }
                  },
                  {
                    "terms": {
                      "event.code": [
                        "4732",
                        "4728",
                        "4756",
                        "4733",
                        "4729"
                      ]
                    }
                  }
                ],
                "must_not": [
                {
                  "terms": {
                    "process.name":
                    [ "elastic-agent.exe",
                    "elastic-agent",
                    "metricbeat.exe",
                    "metricbeat",
                    "filebeat.exe",
                    "filebeat",
                    "packetbeat.exe",
                    "packetbeat",
                    "winlogbeat.exe",
                    "winlogbeat" ]
                  }
                 }
                ]
              }
            }
          }
        },
        {
          "id": "datafeed-pad_windows_high_count_user_account_management_events",
          "job_id": "pad_windows_high_count_user_account_management_events",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_windows_high_count_user_account_management_events",
            "query": {
              "bool": {
                "filter": [
                  {
                    "terms": {
                      "host.os.type": [
                        "windows",
                        "Windows"
                      ]
                    }
                  },
                  {
                    "terms": {
                      "event.action": [
                        "enabled-user-account",
                        "added-user-account",
                        "deleted-user-account",
                        "disabled-user-account"
                      ]
                    }
                  },
                  {
                    "terms": {
                      "event.code": [
                        "4722",
                        "4720",
                        "4726",
                        "4725"
                      ]
                    }
                  }
                ],
                "must_not": [
                {
                  "terms": {
                    "process.name":
                    [ "elastic-agent.exe",
                    "elastic-agent",
                    "metricbeat.exe",
                    "metricbeat",
                    "filebeat.exe",
                    "filebeat",
                    "packetbeat.exe",
                    "packetbeat",
                    "winlogbeat.exe",
                    "winlogbeat" ]
                  }
                 }
                ]
              }
            }
          }
        },
        {
          "id": "datafeed-pad_windows_rare_privilege_assigned_to_user",
          "job_id": "pad_windows_rare_privilege_assigned_to_user",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_windows_rare_privilege_assigned_to_user",
            "query": {
              "bool": {
                "filter": [
                  {
                    "exists": {
                      "field": "privilege_type"
                    }
                  }
                ]
              }
            }
          }
        },
        {
          "id": "datafeed-pad_windows_rare_group_name_by_user",
          "job_id": "pad_windows_rare_group_name_by_user",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_windows_rare_group_name_by_user",
            "query": {
              "bool": {
                "filter": [
                  {
                    "terms": {
                      "host.os.type": [
                        "windows",
                        "Windows"
                      ]
                    }
                  },
                  {
                    "terms": {
                      "event.action": [
                        "added-member-to-group",
                        "removed-member-from-group"
                      ]
                    }
                  },
                  {
                    "terms": {
                      "event.code": [
                        "4732",
                        "4728",
                        "4756",
                        "4733",
                        "4729"
                      ]
                    }
                  }
                ],
                "must_not": [
                {
                  "terms": {
                    "process.name":
                    [ "elastic-agent.exe",
                    "elastic-agent",
                    "metricbeat.exe",
                    "metricbeat",
                    "filebeat.exe",
                    "filebeat",
                    "packetbeat.exe",
                    "packetbeat",
                    "winlogbeat.exe",
                    "winlogbeat" ]
                  }
                 }
                ]
              }
            }
          }
        },
        {
          "id": "datafeed-pad_windows_rare_device_by_user",
          "job_id": "pad_windows_rare_device_by_user",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_windows_rare_device_by_user",
            "query": {
              "bool": {
                "filter": [
                  {
                    "terms": {
                      "host.os.type": [
                        "windows",
                        "Windows"
                      ]
                    }
                  },
                  {
                    "exists": {
                      "field": "host.name"
                    }
                  },
                  {
                    "exists": {
                      "field": "user.name"
                    }
                  },
                  {
                    "terms": {
                      "event.code": [
                        "4720",
                        "4726",
                        "4722",
                        "4756",
                        "4672",
                        "4673",
                        "4674",
                        "4720",
                        "4728",
                        "4732",
                        "4756",
                        "624",
                        "632",
                        "636",
                        "660",
                        "4725",
                        "4723",
                        "4648",
                        "4688",
                        "4729",
                        "4733",
                        "4757",
                        "637",
                        "661"
                      ]
                    }
                  }
                ],
              "must_not": [
                {
                  "terms": {
                    "event.action": [
                      "log_on",
                      "created_process"
                    ]
                    }
                  },
                {
                  "terms": {
                    "process.name":
                    [ "elastic-agent.exe",
                    "elastic-agent",
                    "metricbeat.exe",
                    "metricbeat",
                    "filebeat.exe",
                    "filebeat",
                    "packetbeat.exe",
                    "packetbeat",
                    "winlogbeat.exe",
                    "winlogbeat" ]
                  }
                 }
                ]
              }
            }
          }
        },
        {
          "id": "datafeed-pad_windows_rare_source_ip_by_user",
          "job_id": "pad_windows_rare_source_ip_by_user",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_windows_rare_source_ip_by_user",
            "query": {
              "bool": {
                "filter": [
                  {
                    "terms": {
                      "host.os.type": [
                        "windows",
                        "Windows"
                      ]
                    }
                  },
                  {
                    "exists": {
                      "field": "source.ip"
                    }
                  },
                  {
                    "exists": {
                      "field": "user.name"
                    }
                  },
                  {
                    "terms": {
                      "event.code": [
                        "4720",
                        "4726",
                        "4722",
                        "4756",
                        "4672",
                        "4673",
                        "4674",
                        "4720",
                        "4728",
                        "4732",
                        "4756",
                        "624",
                        "632",
                        "636",
                        "660",
                        "4725",
                        "4723",
                        "4648",
                        "4688",
                        "4729",
                        "4733",
                        "4757",
                        "637",
                        "661"
                      ]
                    }
                  }
                ],
                "must_not": [
                {
                  "terms": {
                    "event.action": [
                      "log_on",
                      "created_process"
                    ]
                    }
                  },
                {
                  "terms": {
                    "process.name":
                    [ "elastic-agent.exe",
                    "elastic-agent",
                    "metricbeat.exe",
                    "metricbeat",
                    "filebeat.exe",
                    "filebeat",
                    "packetbeat.exe",
                    "packetbeat",
                    "winlogbeat.exe",
                    "winlogbeat" ]
                  }
                 }
                ]
              }
            }
          }
        },
        {
          "id": "datafeed-pad_windows_rare_region_name_by_user",
          "job_id": "pad_windows_rare_region_name_by_user",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_windows_rare_region_name_by_user",
            "query": {
              "bool": {
                "filter": [
                  {
                    "terms": {
                      "host.os.type": [
                        "windows",
                        "Windows"
                      ]
                    }
                  },
                  {
                    "exists": {
                      "field": "source.geo.region_name"
                    }
                  },
                  {
                    "exists": {
                      "field": "user.name"
                    }
                  },
                  {
                    "terms": {
                      "event.code": [
                        "4720",
                        "4726",
                        "4722",
                        "4756",
                        "4672",
                        "4673",
                        "4674",
                        "4720",
                        "4728",
                        "4732",
                        "4756",
                        "624",
                        "632",
                        "636",
                        "660",
                        "4725",
                        "4723",
                        "4648",
                        "4688",
                        "4729",
                        "4733",
                        "4757",
                        "637",
                        "661"
                      ]
                    }
                  }
                ],
                "must_not": [
                {
                  "terms": {
                    "event.action": [
                      "log_on",
                      "created_process"
                    ]
                    }
                  },
                {
                  "terms": {
                    "process.name":
                    [ "elastic-agent.exe",
                    "elastic-agent",
                    "metricbeat.exe",
                    "metricbeat",
                    "filebeat.exe",
                    "filebeat",
                    "packetbeat.exe",
                    "packetbeat",
                    "winlogbeat.exe",
                    "winlogbeat" ]
                  }
                 }
                ]
              }
            }
          }
        },
        {
          "id": "datafeed-pad_linux_high_count_privileged_process_events_by_user",
          "job_id": "pad_linux_high_count_privileged_process_events_by_user",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_linux_high_count_privileged_process_events_by_user",
            "query": {
                "bool": {
                  "must": [
                    {
                      "terms": {
                        "host.os.type": [
                          "linux",
                          "Linux"
                        ]
                      }
                    },
                    {
                      "term": {
                        "event.category": "process"
                      }
                    },
                    {
                      "terms": {
                        "event.type": [
                          "start",
                          "change"
                        ]
                      }
                    },
                    {
                      "bool": {
                        "should": [
                          {
                            "match_phrase": {
                              "process.command_line.text": "LD_PRELOAD"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "/etc/ld.so.preload"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "/root/.ssh/authorized_keys"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "timestamp_timeout=-1"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "!tty_tickets"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "var/spool/cron"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "systemctl daemon-reload"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "pw mod user"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "pw unlock"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "chmod u+s"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo setcap cap_setuid"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "su nobody"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo nobody"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo */root/"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo*etc/sudoers"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo*visudo"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "etc/cron.*/"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "trap*SIGINT"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "find*-perm*2000"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "find*-perm*4000"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "systemctl start*.service"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "systemctl enable*.service"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/.bash_profile"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/.bashrc"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/.shrc"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/etc/profile"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/.bash_logout"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/etc/rc."
                            }
                          }
                        ]
                      }
                    }
                  ],
                  "must_not": [
                    {
                      "terms": {
                        "process.name": [
                            "elastic-agent",
                            "elasticsearch-users",
                            "elastic-agent.exe",
                            "metricbeat.exe",
                            "metricbeat",
                            "filebeat.exe",
                            "filebeat",
                            "packetbeat.exe",
                            "packetbeat",
                            "winlogbeat.exe",
                            "winlogbeat"
                        ]
                      }
                    },
                    {
                      "terms": {
                        "process.command_line.text": [
                          "elastic-agent",
                          "elasticsearch"
                        ]
                      }
                    }
                  ]
                }
              }
          }
        },
        {
          "id": "datafeed-pad_linux_rare_process_executed_by_user",
          "job_id": "pad_linux_rare_process_executed_by_user",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_linux_rare_process_executed_by_user",
            "query": {
                "bool": {
                  "must": [
                    {
                      "terms": {
                        "host.os.type": [
                          "linux",
                          "Linux"
                        ]
                      }
                    },
                    {
                      "term": {
                        "event.category": "process"
                      }
                    },
                    {
                      "terms": {
                        "event.type": [
                          "start",
                          "change"
                        ]
                      }
                    },
                    {
                      "bool": {
                        "should": [
                          {
                            "match_phrase": {
                              "process.command_line.text": "LD_PRELOAD"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "/etc/ld.so.preload"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "/root/.ssh/authorized_keys"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "timestamp_timeout=-1"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "!tty_tickets"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "var/spool/cron"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "systemctl daemon-reload"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "pw mod user"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "pw unlock"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "chmod u+s"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo setcap cap_setuid"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "su nobody"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo nobody"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo */root/"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo*etc/sudoers"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo*visudo"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "etc/cron.*/"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "trap*SIGINT"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "find*-perm*2000"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "find*-perm*4000"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "systemctl start*.service"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "systemctl enable*.service"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/.bash_profile"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/.bashrc"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/.shrc"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/etc/profile"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/.bash_logout"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/etc/rc."
                            }
                          }
                        ]
                      }
                    }
                  ],
                  "must_not": [
                    {
                      "terms": {
                        "process.name": [
                            "elastic-agent",
                            "elasticsearch-users",
                            "elastic-agent.exe",
                            "metricbeat.exe",
                            "metricbeat",
                            "filebeat.exe",
                            "filebeat",
                            "packetbeat.exe",
                            "packetbeat",
                            "winlogbeat.exe",
                            "winlogbeat"
                        ]
                      }
                    },
                    {
                      "terms": {
                        "process.command_line.text": [
                          "elastic-agent",
                          "elasticsearch"
                        ]
                      }
                    }
                  ]
                }
              }
          }
        },
        {
          "id": "datafeed-pad_linux_high_median_process_command_line_entropy_by_user",
          "job_id": "pad_linux_high_median_process_command_line_entropy_by_user",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_linux_high_median_process_command_line_entropy_by_user",
            "query": {
                "bool": {
                  "must": [
                    {
                      "terms": {
                        "host.os.type": [
                          "linux",
                          "Linux"
                        ]
                      }
                    },
                    {
                      "term": {
                        "event.category": "process"
                      }
                    },
                    {
                      "terms": {
                        "event.type": [
                          "start",
                          "change"
                        ]
                      }
                    },
                    {
                      "bool": {
                        "should": [
                          {
                            "match_phrase": {
                              "process.command_line.text": "LD_PRELOAD"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "/etc/ld.so.preload"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "/root/.ssh/authorized_keys"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "timestamp_timeout=-1"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "!tty_tickets"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "var/spool/cron"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "systemctl daemon-reload"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "pw mod user"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "pw unlock"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "chmod u+s"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo setcap cap_setuid"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "su nobody"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo nobody"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo */root/"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo*etc/sudoers"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "sudo*visudo"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "etc/cron.*/"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "trap*SIGINT"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "find*-perm*2000"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "find*-perm*4000"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "systemctl start*.service"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "systemctl enable*.service"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/.bash_profile"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/.bashrc"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/.shrc"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/etc/profile"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/.bash_logout"
                            }
                          },
                          {
                            "match_phrase": {
                              "process.command_line.text": "echo*/etc/rc."
                            }
                          }
                        ]
                      }
                    }
                  ],
                  "must_not": [
                    {
                      "terms": {
                        "process.name": [
                            "elastic-agent",
                            "elasticsearch-users",
                            "elastic-agent.exe",
                            "metricbeat.exe",
                            "metricbeat",
                            "filebeat.exe",
                            "filebeat",
                            "packetbeat.exe",
                            "packetbeat",
                            "winlogbeat.exe",
                            "winlogbeat"
                        ]
                      }
                    },
                    {
                      "terms": {
                        "process.command_line.text": [
                          "elastic-agent",
                          "elasticsearch"
                        ]
                      }
                    }
                  ]
                }
              }
          }
        },
        {
          "id": "datafeed-pad_okta_spike_in_group_membership_changes",
          "job_id": "pad_okta_spike_in_group_membership_changes",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_okta_spike_in_group_membership_changes",
            "query": {
              "bool": {
                "filter": [
                  {
                    "term": {
                      "data_stream.dataset": "okta.system"
                    }
                  },
                  {
                    "terms": {
                      "okta.event_type": ["group.user_membership.add", "group.user_membership.remove"]
                    }
                  }
                ]
              }
            }
          }
        },
        {
          "id": "datafeed-pad_okta_spike_in_user_lifecycle_management_changes",
          "job_id": "pad_okta_spike_in_user_lifecycle_management_changes",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_okta_spike_in_user_lifecycle_management_changes",
            "query": {
              "bool": {
                "filter": [
                  {
                    "term": {
                      "data_stream.dataset": "okta.system"
                    }
                  },
                  {
                    "terms": {
                      "okta.event_type": [
                        "user.lifecycle.activate",
                        "user.lifecycle.deactivate",
                        "user.lifecycle.suspend",
                        "user.lifecycle.unsuspend",
                        "user.lifecycle.create",
                        "user.lifecycle.update"
                      ]
                    }
                  }
                ]
              }
            }
          }
        },
                {
          "id": "datafeed-pad_okta_spike_in_group_privilege_changes",
          "job_id": "pad_okta_spike_in_group_privilege_changes",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_okta_spike_in_group_privilege_changes",
            "query": {
              "bool": {
                "filter": [
                  {
                    "term": {
                      "data_stream.dataset": "okta.system"
                    }
                  },
                  {
                    "terms": {
                      "okta.event_type": ["group.privilege.grant", "group.privilege.revoke"]
                    }
                  }
                ]
              }
            }
          }
        },
                {
          "id": "datafeed-pad_okta_spike_in_group_application_assignment_changes",
          "job_id": "pad_okta_spike_in_group_application_assignment_changes",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_okta_spike_in_group_application_assignment_changes",
            "query": {
              "bool": {
                "filter": [
                  {
                    "term": {
                      "data_stream.dataset": "okta.system"
                    }
                  },
                  {
                    "terms": {
                      "okta.event_type": ["group.application_assignment.add", "group.application_assignment.remove"]
                    }
                  }
                ]
              }
            }
          }
        },
        {
          "id": "datafeed-pad_okta_spike_in_group_lifecycle_changes",
          "job_id": "pad_okta_spike_in_group_lifecycle_changes",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_okta_spike_in_group_lifecycle_changes",
            "query": {
              "bool": {
                "filter": [
                  {
                    "term": {
                      "data_stream.dataset": "okta.system"
                    }
                  },
                  {
                    "terms": {
                      "okta.event_type": ["group.lifecycle.create", "group.lifecycle.delete"]
                    }
                  }
                ]
              }
            }
          }
        },
         {
          "id": "datafeed-pad_okta_high_sum_concurrent_sessions_by_user",
          "job_id": "pad_okta_high_sum_concurrent_sessions_by_user",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_okta_high_sum_concurrent_sessions_by_user",
            "query": {
                "bool": {
                  "filter": [
                    {
                      "exists": {
                        "field": "source.user.name"
                      }
                    },
                    {
                      "exists": {
                        "field": "okta_distinct_ips"
                      }
                    },
                    {
                      "range": {
                        "okta_distinct_ips": {
                          "gte": 2
                        }
                      }
                    },
                    {
                      "range": {
                        "okta_distinct_countries": {
                          "gte": 2
                        }
                      }
                    },
                    {
                      "term": {
                        "okta_session_info.has_end_event": 0
                      }
                    }
                  ]
                }
              }
          }
        },
        {
          "id": "datafeed-pad_okta_rare_source_ip_by_user",
          "job_id": "pad_okta_rare_source_ip_by_user",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_okta_rare_source_ip_by_user",
            "query": {
              "bool": {
                "filter": [
                  {
                    "term": {
                      "data_stream.dataset": "okta.system"
                    }
                  },
                  {
                    "exists": {
                      "field": "source.ip"
                    }
                  },
                  {
                    "terms": {
                      "okta.event_type": [
                        "group.lifecycle.create",
                        "group.lifecycle.delete",
                        "group.user_membership.add",
                        "group.user_membership.remove",
                        "user.lifecycle.activate",
                        "user.lifecycle.deactivate",
                        "user.lifecycle.suspend",
                        "user.lifecycle.unsuspend",
                        "user.lifecycle.create",
                        "user.lifecycle.update",
                        "group.privilege.grant",
                        "group.privilege.revoke",
                        "group.application_assignment.add",
                        "group.application_assignment.remove"]
                    }
                  }
                ]
              }
            }
          }
        },
                {
          "id": "datafeed-pad_okta_rare_region_name_by_user",
          "job_id": "pad_okta_rare_region_name_by_user",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_okta_rare_region_name_by_user",
            "query": {
              "bool": {
                "filter": [
                  {
                    "term": {
                      "data_stream.dataset": "okta.system"
                    }
                  },
                  {
                    "exists": {
                      "field": "client.geo.region_name"
                    }
                  },
                  {
                    "terms": {
                      "okta.event_type": [
                        "group.lifecycle.create",
                        "group.lifecycle.delete",
                        "group.user_membership.add",
                        "group.user_membership.remove",
                        "user.lifecycle.activate",
                        "user.lifecycle.deactivate",
                        "user.lifecycle.suspend",
                        "user.lifecycle.unsuspend",
                        "user.lifecycle.create",
                        "user.lifecycle.update",
                        "group.privilege.grant",
                        "group.privilege.revoke",
                        "group.application_assignment.add",
                        "group.application_assignment.remove"]
                    }
                  }
                ]
              }
            }
          }
        },
                {
          "id": "datafeed-pad_okta_rare_host_name_by_user",
          "job_id": "pad_okta_rare_host_name_by_user",
          "config": {
            "indices": [
              "INDEX_PATTERN_NAME"
            ],
            "job_id": "pad_okta_rare_host_name_by_user",
            "query": {
              "bool": {
                "filter": [
                  {
                    "term": {
                      "data_stream.dataset": "okta.system"
                    }
                  },
                  {
                    "exists": {
                      "field": "agent.name"
                    }
                  },
                  {
                    "terms": {
                      "okta.event_type": [
                        "group.lifecycle.create",
                        "group.lifecycle.delete",
                        "group.user_membership.add",
                        "group.user_membership.remove",
                        "user.lifecycle.activate",
                        "user.lifecycle.deactivate",
                        "user.lifecycle.suspend",
                        "user.lifecycle.unsuspend",
                        "user.lifecycle.create",
                        "user.lifecycle.update",
                        "group.privilege.grant",
                        "group.privilege.revoke",
                        "group.application_assignment.add",
                        "group.application_assignment.remove"]
                    }
                  }
                ]
              }
            }
          }
        }
      ]
    },
    "id": "pad-ml",
    "migrationVersion": {
        "search": "7.16.0"
    },
    "references": [],
    "type": "ml-module"
}