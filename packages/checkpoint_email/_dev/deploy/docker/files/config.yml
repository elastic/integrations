rules:
  - path: /auth/external
    methods: ['POST']
    request_headers:
      Content-Type:
        - "application/json"
    request_body: '{"accessKey":"accessKey","clientId":"clientId"}'
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {
            "success": true,
            "data": {
              "token": "XnbabcdefghijklmnopqrstuvwxyztYWHWXRy7---s",
              "csrf": "32057d5e-abcd-1234-abcd-123456789087",
              "expires": "Mon, 14 Oct 2030 07:20:18 GMT",
              "expiresIn": 1800
            }
          }
  - path: /app/hec-api/v1.0/event/query
    methods: ['POST']
    request_headers:
      Content-Type:
        - "application/json"
      Authorization:
        - "Bearer XnbabcdefghijklmnopqrstuvwxyztYWHWXRy7---s"
      X-Av-Req-Id:
        - .*
    request_body: /^\{"requestData":\{"endDate":.*,"scrollId":"e9c8c0e01234567890123456789000cf","startDate":.*\}\}/
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {
            "responseEnvelope": {
              "requestId": "{{ .request.headers.Get "X-Av-Req-Id" }}",
              "responseCode": 200,
              "responseText": "",
              "additionalText": "",
              "recordsNumber": 2,
              "scrollId": null
            },
            "responseData": []
          }
  - path: /app/hec-api/v1.0/event/query
    methods: ['POST']
    request_headers:
      Content-Type:
        - "application/json"
      Authorization:
        - "Bearer XnbabcdefghijklmnopqrstuvwxyztYWHWXRy7---s"
      X-Av-Req-Id:
        - .*
    request_body: /^\{"requestData":\{"endDate":.*,"startDate":.*\}\}/
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {
            "responseEnvelope": {
              "requestId": "{{ .request.headers.Get "X-Av-Req-Id" }}",
              "responseCode": 200,
              "responseText": "",
              "additionalText": "",
              "recordsNumber": 2,
              "scrollId": "e9c8c0e01234567890123456789000cf"
            },
            "responseData": [
              {
                "eventId": "13007abcdef01234567896d00f44a7dd4",
                "customerId": "elasticteam",
                "saas": "google_mail",
                "entityId": "ad6ada66e6fabcdefabcdefc240dd9d0",
                "state": "new",
                "type": "phishing",
                "confidenceIndicator": "malicious",
                "eventCreated": "2024-10-15T09:47:06.592720+00:00",
                "severity": "4",
                "description": "Phishing attempt detected in an email from google-support@webnotifications.net - 'Office Holiday Party - Folder Share' (team@example.com's mailbox)",
                "data": "#{\"entity_id\": \"ad6ada66e6fabcdefabcdefc240dd9d0\", \"entity_type\": \"avanan_ap_scan\", \"label\": \"Phishing\"} attempt detected in an email from #{\"entity_id\": null, \"entity_type\": \"google_user\", \"disable_link\": true, \"label\": \"google-support@webnotifications.net\"} - '#{\"entity_id\": \"ad6ada66e6fabcdefabcdefc240dd9d0\", \"entity_type\": \"google_mail_email\", \"label\": \"Office Holiday Party - Folder Share\"}' (#{\"entity_id\": \"113310123456789535444\", \"entity_type\": \"google_user\", \"label\": \"team@example.com\"}'s mailbox)",
                "additionalData": null,
                "availableEventActions": null,
                "actions": [],
                "senderAddress": "google-support@webnotifications.net",
                "entityLink": "https://in.portal.checkpoint.com/dashboard/email&collaboration/CGS1?route=cHJvZmlsZsdverberGRTHTYJbgbrtHYNRTGbdfbtryrtM2YyNTlkYTY0MmMyNDBkZDlkMA=="
              },
              {
                "eventId": "73af5abcdef0123456789d08abfce324",
                "customerId": "elastictest",
                "saas": "google_mail",
                "entityId": "4abcdefabcdefabcdefc44ca3798cb2f",
                "state": "dismissed",
                "type": "dlp",
                "confidenceIndicator": "detected",
                "eventCreated": "2024-10-15T10:27:40.294099+00:00",
                "severity": "3",
                "description": "SmartDLP has detected PII leak in 'Resume' (alice@example.io's mailbox)",
                "data": "#{\"entity_id\": \"81555d1d0defabcdefabcdabcdcb6c1aa44\", \"entity_type\": \"avanan_dlp\", \"disable_link\": true, \"label\": \"SmartDLP\"} has detected #{\"entity_id\": \"81555d1d0defabcdefabcdabcdcb6c1aa44\", \"entity_type\": \"avanan_dlp\", \"disable_link\": true, \"label\": \"PII\"} leak in '#{\"entity_id\": \"40d926d7c01234567890123456789b2f\", \"entity_type\": \"google_mail_email\", \"label\": \"Resume\"}' (#{\"entity_id\": \"113310123456789535444\", \"entity_type\": \"google_user\", \"label\": \"alice@example.io\"}'s mailbox)",
                "additionalData": null,
                "availableEventActions": null,
                "actions": [],
                "senderAddress": "alice@example.io",
                "entityLink": "https://in.portal.checkpoint.com/dashboard/email&collaboration/CGS1?route=cHJvZmlsZS9nb29nbGVfbWFpbF9gysdjvvsvDFGERgfvsdverERBERsdvsdv2EzNzk4Y2IyZg=="
              }
            ]
          }
