title: Event
type: logs
streams:
  - input: cel
    title: ServiceNow tables
    description: Collect table logs from ServiceNow instance via API.
    template_path: cel.yml.hbs
    enabled: false
    vars:
      - name: url
        type: url
        title: URL
        description: URL of ServiceNow instance. It should follow the given format, https://\<instance_id\>.service-now.
        required: true
        show_user: true
      - name: username
        type: text
        title: Username
        description: The username to be used with Basic Auth headers.
        multi: false
        required: true
        show_user: true
      - name: password
        type: password
        title: Password
        description: The password to be used with Basic Auth headers.
        multi: false
        required: true
        show_user: true
        secret: true
      - name: initial_interval
        type: text
        title: Initial Interval
        multi: false
        required: true
        show_user: true
        default: 24h
        description: How far back to pull the logs from ServiceNow API. Supported units for this parameter are h/m/s.
      - name: interval
        type: text
        title: Interval
        description: Duration between requests to the ServiceNow API. Supported units for this parameter are h/m/s.
        default: 5m
        multi: false
        required: true
        show_user: true
      - name: batch_size
        type: text
        title: Batch Size
        multi: false
        required: true
        show_user: true
        description: Batch size for the response of the ServiceNow API, with a maximum limit of 10,000.
        default: 10000
      - name: table_name
        type: text
        title: Table Name
        description: Name of the table from which to retrieve the records.
        multi: false
        required: true
        show_user: true
      - name: hide_sensitive
        type: bool
        title: Hide Sensitive Details
        description: Hide sensitive user details such as phone number, street address etc.
        multi: false
        required: false
        show_user: false
        default: true
      - name: timezone
        type: select
        title: Timezone of ServiceNow Instance
        multi: false
        required: true
        show_user: true
        default: America/Los_Angeles
        description: >-
          The timezone of the ServiceNow instance, used for interpreting timestamps in the logs.
        options:
          - value: America/Los_Angeles
            text: America/Los_Angeles
          - value: Canada/Atlantic
            text: Canada/Atlantic
          - value: Canada/Central
            text: Canada/Central
          - value: Canada/Eastern
            text: Canada/Eastern
          - value: Canada/Mountain
            text: Canada/Mountain
          - value: Canada/Pacific
            text: Canada/Pacific
          - value: Europe/Amsterdam
            text: Europe/Amsterdam
          - value: Europe/Berlin
            text: Europe/Berlin
          - value: Europe/Brussels
            text: Europe/Brussels
          - value: Europe/Copenhagen
            text: Europe/Copenhagen
          - value: Europe/Dublin
            text: Europe/Dublin
          - value: Europe/London
            text: Europe/London
          - value: Europe/Madrid
            text: Europe/Madrid
          - value: Europe/Paris
            text: Europe/Paris
          - value: Europe/Rome
            text: Europe/Rome
          - value: Europe/Stockholm
            text: Europe/Stockholm
          - value: Europe/Zurich
            text: Europe/Zurich
          - value: GMT
            text: GMT
          - value: Hongkong
            text: Hongkong
          - value: US/Arizona
            text: US/Arizona
          - value: US/Central
            text: US/Central
          - value: US/Eastern
            text: US/Eastern
          - value: US/Hawaii
            text: US/Hawaii
          - value: US/Mountain
            text: US/Mountain
          - value: US/Pacific
            text: US/Pacific
      - name: http_client_timeout
        type: text
        title: HTTP Client Timeout
        description: Duration before declaring that the HTTP client connection has timed out. Supported time units are ns, us, ms, s, m, h.
        multi: false
        required: true
        show_user: false
        default: 30s
      - name: enable_request_tracer
        type: bool
        title: Enable request tracing
        multi: false
        required: false
        show_user: false
        description: The request tracer logs requests and responses to the agent's local file-system for debugging configurations. Enabling this request tracing compromises security and should only be used for debugging. See [documentation](https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-input-cel.html#_resource_tracer_filename) for details.
      - name: tags
        type: text
        title: Tags
        multi: true
        required: true
        show_user: false
        default:
          - forwarded
          - servicenow-event
      - name: preserve_original_event
        required: false
        show_user: true
        title: Preserve original event
        description: Preserves a raw copy of the original event, added to the field `event.original`.
        type: bool
        multi: false
        default: false
      - name: preserve_duplicate_custom_fields
        required: false
        show_user: false
        title: Preserve duplicate custom fields
        description: Preserve servicenow.event fields that were copied to Elastic Common Schema (ECS) fields.
        type: bool
        multi: false
        default: false
      - name: processors
        type: yaml
        title: Processors
        multi: false
        required: false
        show_user: false
        description: >-
          Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.
      - name: proxy_url
        type: text
        title: Proxy URL
        multi: false
        required: false
        show_user: false
        description: URL to proxy connections in the form of http[s]://<user>:<password>@<server name/ip>:<port>. Please ensure your username and password are in URL encoded format.
      - name: ssl
        type: yaml
        title: SSL Configuration
        description: SSL config for host. i.e. certificate_authorities, supported_protocols, verification_mode etc.
        multi: false
        required: false
        show_user: false
        default: |
          #certificate_authorities:
          #  - |
          #    -----BEGIN CERTIFICATE-----
          #    MIIDCjCCAfKgAwIBAgITJ706Mu2wJlKckpIvkWxEHvEyijANBgkqhkiG9w0BAQsF
          #    ADAUMRIwEAYDVQQDDAlsb2NhbGhvc3QwIBcNMTkwNzIyMTkyOTA0WhgPMjExOTA2
          #    MjgxOTI5MDRaMBQxEjAQBgNVBAMMCWxvY2FsaG9zdDCCASIwDQYJKoZIhvcNAQEB
          #    BQADggEPADCCAQoCggEBANce58Y/JykI58iyOXpxGfw0/gMvF0hUQAcUrSMxEO6n
          #    fZRA49b4OV4SwWmA3395uL2eB2NB8y8qdQ9muXUdPBWE4l9rMZ6gmfu90N5B5uEl
          #    94NcfBfYOKi1fJQ9i7WKhTjlRkMCgBkWPkUokvBZFRt8RtF7zI77BSEorHGQCk9t
          #    /D7BS0GJyfVEhftbWcFEAG3VRcoMhF7kUzYwp+qESoriFRYLeDWv68ZOvG7eoWnP
          #    PsvZStEVEimjvK5NSESEQa9xWyJOmlOKXhkdymtcUd/nXnx6UTCFgnkgzSdTWV41
          #    CI6B6aJ9svCTI2QuoIq2HxX/ix7OvW1huVmcyHVxyUECAwEAAaNTMFEwHQYDVR0O
          #    BBYEFPwN1OceFGm9v6ux8G+DZ3TUDYxqMB8GA1UdIwQYMBaAFPwN1OceFGm9v6ux
          #    8G+DZ3TUDYxqMA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBAG5D
          #    874A4YI7YUwOVsVAdbWtgp1d0zKcPRR+r2OdSbTAV5/gcS3jgBJ3i1BN34JuDVFw
          #    3DeJSYT3nxy2Y56lLnxDeF8CUTUtVQx3CuGkRg1ouGAHpO/6OqOhwLLorEmxi7tA
          #    H2O8mtT0poX5AnOAhzVy7QW0D/k4WaoLyckM5hUa6RtvgvLxOwA0U+VGurCDoctu
          #    8F4QOgTAWyh8EZIwaKCliFRSynDpv3JTUwtfZkxo6K6nce1RhCWFAsMvDZL8Dgc0
          #    yvgJ38BRsFOtkRuAGSf6ZUwTO8JJRRIFnpUzXflAnGivK9M13D5GEQMmIl6U9Pvk
          #    sxSmbIUfc2SGJGCJD4I=
          #    -----END CERTIFICATE-----
  - input: aws-s3
    template_path: aws-s3.yml.hbs
    title: ServiceNow tables
    description: Collect table logs from ServiceNow instance via AWS S3 or SQS.
    enabled: false
    vars:
      - name: collect_s3_logs
        required: true
        show_user: true
        title: Collect logs via S3 Bucket
        description: To Collect logs via S3 bucket enable the toggle switch. By default, it will collect logs via SQS Queue.
        type: bool
        multi: false
        default: false
      - name: bucket_arn
        type: text
        title: '[S3] Bucket ARN'
        multi: false
        required: false
        show_user: true
        description: It is a required parameter for collecting logs via the AWS S3 Bucket.
      - name: queue_url
        type: text
        title: '[SQS] Queue URL'
        multi: false
        required: false
        show_user: true
        description: URL of the AWS SQS queue that messages will be received from. It is a required parameter for collecting logs via the AWS SQS.
      - name: access_key_id
        type: password
        title: Access Key ID
        multi: false
        required: false
        show_user: true
        description: First part of access key.
        secret: true
      - name: secret_access_key
        type: password
        title: Secret Access Key
        multi: false
        required: false
        show_user: true
        description: Second part of access key.
        secret: true
      - name: session_token
        type: password
        title: Session Token
        multi: false
        required: false
        show_user: true
        description: Required when using temporary security credentials.
        secret: true
      - name: bucket_list_prefix
        type: text
        title: "Bucket Prefix"
        multi: false
        required: true
        show_user: true
        description: Prefix to fetch data from AWS S3 bucket or AWS SQS queue.
      - name: table_name
        type: text
        title: Table Name
        description: Name of the table from which to retrieve the records.
        multi: false
        required: true
        show_user: true
      - name: interval
        type: text
        title: '[S3] Interval'
        multi: false
        required: false
        show_user: true
        default: 1m
        description: 'Time interval for polling listing of the S3 bucket. Supported units for this parameter are h/m/s.'
      - name: hide_sensitive
        type: bool
        title: Hide Sensitive Details
        description: Hide sensitive user details such as phone number, street address etc.
        multi: false
        required: false
        show_user: false
        default: true
      - name: timezone
        type: select
        title: Timezone of ServiceNow Instance
        multi: false
        required: true
        show_user: true
        default: America/Los_Angeles
        description: >-
          The timezone of the ServiceNow instance, used for interpreting timestamps in the logs.
        options:
          - value: America/Los_Angeles
            text: America/Los_Angeles
          - value: Canada/Atlantic
            text: Canada/Atlantic
          - value: Canada/Central
            text: Canada/Central
          - value: Canada/Eastern
            text: Canada/Eastern
          - value: Canada/Mountain
            text: Canada/Mountain
          - value: Canada/Pacific
            text: Canada/Pacific
          - value: Europe/Amsterdam
            text: Europe/Amsterdam
          - value: Europe/Berlin
            text: Europe/Berlin
          - value: Europe/Brussels
            text: Europe/Brussels
          - value: Europe/Copenhagen
            text: Europe/Copenhagen
          - value: Europe/Dublin
            text: Europe/Dublin
          - value: Europe/London
            text: Europe/London
          - value: Europe/Madrid
            text: Europe/Madrid
          - value: Europe/Paris
            text: Europe/Paris
          - value: Europe/Rome
            text: Europe/Rome
          - value: Europe/Stockholm
            text: Europe/Stockholm
          - value: Europe/Zurich
            text: Europe/Zurich
          - value: GMT
            text: GMT
          - value: Hongkong
            text: Hongkong
          - value: US/Arizona
            text: US/Arizona
          - value: US/Central
            text: US/Central
          - value: US/Eastern
            text: US/Eastern
          - value: US/Hawaii
            text: US/Hawaii
          - value: US/Mountain
            text: US/Mountain
          - value: US/Pacific
            text: US/Pacific
      - name: number_of_workers
        type: integer
        title: '[S3] Number of Workers'
        multi: false
        required: false
        show_user: true
        default: 5
        description: Number of workers that will process the S3 objects listed.
      - name: shared_credential_file
        type: text
        title: Shared Credential File
        multi: false
        required: false
        show_user: false
        description: Directory of the shared credentials file.
      - name: credential_profile_name
        type: text
        title: Credential Profile Name
        multi: false
        required: false
        show_user: false
        description: Profile name in shared credentials file.
      - name: role_arn
        type: text
        title: Role ARN
        multi: false
        required: false
        show_user: false
        description: AWS IAM Role to assume.
      - name: endpoint
        type: text
        title: Endpoint
        multi: false
        required: false
        show_user: false
        description: URL of the entry point for an AWS web service.
      - name: fips_enabled
        type: bool
        title: Enable S3 FIPS
        default: false
        multi: false
        required: false
        show_user: false
        description: Enabling this option changes the service name from `s3` to `s3-fips` for connecting to the correct service endpoint.
      - name: proxy_url
        type: text
        title: Proxy URL
        multi: false
        required: false
        show_user: false
        description: URL to proxy connections in the form of http[s]://<user>:<password>@<server name/ip>:<port>. Please ensure your username and password are in URL encoded format.
      - name: visibility_timeout
        type: text
        title: '[SQS] Visibility Timeout'
        multi: false
        required: false
        show_user: true
        default: 300s
        description: 'The duration that the received messages are hidden from subsequent retrieve requests after being retrieved by a ReceiveMessage request. The maximum is 12 hours. NOTE: Supported units for this parameter are h/m/s.'
      - name: api_timeout
        type: text
        title: '[SQS] API Timeout'
        multi: false
        required: false
        show_user: true
        default: 120s
        description: 'The maximum duration of AWS API can take. The maximum is half of the visibility timeout value. Supported units for this parameter are h/m/s.'
      - name: region
        type: text
        title: "[SQS] Region"
        multi: false
        required: false
        show_user: true
        description: The name of the AWS region of the end point. If this option is given it takes precedence over the region name obtained from the queue_url value. It is a required parameter for collecting logs via the AWS SQS.
      - name: max_number_of_messages
        type: integer
        title: '[SQS] Maximum Concurrent SQS Messages'
        required: false
        show_user: true
        default: 5
        description: The maximum number of SQS messages that can be inflight at any time.
      - name: tags
        type: text
        title: Tags
        multi: true
        required: true
        show_user: false
        default:
          - forwarded
          - servicenow-event
      - name: preserve_original_event
        required: true
        show_user: true
        title: Preserve original event
        description: Preserves a raw copy of the original event, added to the field `event.original`.
        type: bool
        multi: false
        default: false
      - name: preserve_duplicate_custom_fields
        required: true
        show_user: false
        title: Preserve duplicate custom fields
        description: Preserve servicenow.event fields that were mapped to Elastic Common Schema (ECS) fields.
        type: bool
        multi: false
        default: false
      - name: processors
        type: yaml
        title: Processors
        multi: false
        required: false
        show_user: false
        description: >-
          Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.
      - name: ssl
        type: yaml
        title: SSL Configuration
        description: SSL config for host. i.e. certificate_authorities, supported_protocols, verification_mode etc.
        multi: false
        required: false
        show_user: false
        default: |
          #certificate_authorities:
          #  - |
          #    -----BEGIN CERTIFICATE-----
          #    MIIDCjCCAfKgAwIBAgITJ706Mu2wJlKckpIvkWxEHvEyijANBgkqhkiG9w0BAQsF
          #    ADAUMRIwEAYDVQQDDAlsb2NhbGhvc3QwIBcNMTkwNzIyMTkyOTA0WhgPMjExOTA2
          #    MjgxOTI5MDRaMBQxEjAQBgNVBAMMCWxvY2FsaG9zdDCCASIwDQYJKoZIhvcNAQEB
          #    BQADggEPADCCAQoCggEBANce58Y/JykI58iyOXpxGfw0/gMvF0hUQAcUrSMxEO6n
          #    fZRA49b4OV4SwWmA3395uL2eB2NB8y8qdQ9muXUdPBWE4l9rMZ6gmfu90N5B5uEl
          #    94NcfBfYOKi1fJQ9i7WKhTjlRkMCgBkWPkUokvBZFRt8RtF7zI77BSEorHGQCk9t
          #    /D7BS0GJyfVEhftbWcFEAG3VRcoMhF7kUzYwp+qESoriFRYLeDWv68ZOvG7eoWnP
          #    PsvZStEVEimjvK5NSESEQa9xWyJOmlOKXhkdymtcUd/nXnx6UTCFgnkgzSdTWV41
          #    CI6B6aJ9svCTI2QuoIq2HxX/ix7OvW1huVmcyHVxyUECAwEAAaNTMFEwHQYDVR0O
          #    BBYEFPwN1OceFGm9v6ux8G+DZ3TUDYxqMB8GA1UdIwQYMBaAFPwN1OceFGm9v6ux
          #    8G+DZ3TUDYxqMA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBAG5D
          #    874A4YI7YUwOVsVAdbWtgp1d0zKcPRR+r2OdSbTAV5/gcS3jgBJ3i1BN34JuDVFw
          #    3DeJSYT3nxy2Y56lLnxDeF8CUTUtVQx3CuGkRg1ouGAHpO/6OqOhwLLorEmxi7tA
          #    H2O8mtT0poX5AnOAhzVy7QW0D/k4WaoLyckM5hUa6RtvgvLxOwA0U+VGurCDoctu
          #    8F4QOgTAWyh8EZIwaKCliFRSynDpv3JTUwtfZkxo6K6nce1RhCWFAsMvDZL8Dgc0
          #    yvgJ38BRsFOtkRuAGSf6ZUwTO8JJRRIFnpUzXflAnGivK9M13D5GEQMmIl6U9Pvk
          #    sxSmbIUfc2SGJGCJD4I=
          #    -----END CERTIFICATE-----
