---
description: "Parse DNS events from VMware vSphere/vCenter"
processors:
    - dissect:
        field: message
        pattern: "%{dns.op_code}[%{dns.question.type}] %{dns.question.name} from %{}"
        if: ctx.message.startsWith('query[')
    - dissect:
        field: message
        pattern: "cached %{dns.question.name} is %{dns.resolved_ip}"
        if: ctx.message.startsWith('cached')
    - dissect:
        field: message
        pattern: "forwarded %{dns.question.name} to %{dns.resolved_ip}"
        if: ctx.message.startsWith('forwarded')
    - registered_domain:
        field: dns.question.name
        target_field: dns.question
        if: ctx.dns?.question?.name != null
    - uppercase:
        field: dns.op_code
        if: ctx.dns?.op_code != null
    - set:
        field: dns.answers.data
        value: "{{dns.resolved_ip}}"
        if: ctx.dns?.resolved_ip != null
    - set:
        field: dns.answers.name
        value: "{{dns.question.name}}"
        if: ctx.dns?.question?.name != null && ctx.dns?.resolved_ip != null
    - remove:
        field: "dns.question.domain"
        if: "ctx.dns?.question?.domain != null"
        
