---
description: Pipeline for JAMF Compliance Reporter aue_execve audit logs.
processors:
  - convert:
      field: json.attributes.device
      target_field: jamf_compliance_reporter.audit.attributes.device
      type: string
      ignore_failure: true
  - convert:
      field: json.attributes.file_access_mode
      target_field: jamf_compliance_reporter.audit.attributes.file.access_mode
      type: string
      ignore_failure: true
  - convert:
      field: json.attributes.file_system_id
      target_field: jamf_compliance_reporter.audit.attributes.file.system.id
      type: string
      ignore_failure: true
  - convert:
      field: json.attributes.node_id
      target_field: jamf_compliance_reporter.audit.attributes.node.id
      type: string
      ignore_failure: true
  - convert:
      field: json.attributes.owner_group_id
      target_field: jamf_compliance_reporter.audit.attributes.owner.group.id
      type: string
      ignore_failure: true
  - rename:
      field: json.attributes.owner_group_name
      target_field: jamf_compliance_reporter.audit.attributes.owner.group.name
      ignore_missing: true
  - convert:
      field: json.attributes.owner_user_id
      target_field: jamf_compliance_reporter.audit.attributes.owner.user.id
      type: string
      ignore_failure: true
  - rename:
      field: json.attributes.owner_user_name
      target_field: jamf_compliance_reporter.audit.attributes.owner.user.name
      ignore_missing: true
  - append:
      field: related.user
      value: '{{{jamf_compliance_reporter.audit.attributes.owner.user.name}}}'
      if: ctx?.jamf_compliance_reporter?.audit?.attributes?.owner?.user?.name != null
      allow_duplicates: false
      ignore_failure: true
  - pipeline:
      name: '{{ IngestPipeline "pipeline_identity_object" }}'
  - rename:
      field: json.path
      target_field: jamf_compliance_reporter.audit.path
      ignore_missing: true
  - pipeline:
      name: '{{ IngestPipeline "pipeline_exec_chain_child_object" }}'
  - rename:
      field: json.exec_args.args
      target_field: jamf_compliance_reporter.audit.exec_args.args
      ignore_missing: true
  - rename:
      field: json.exec_args.args_compiled
      target_field: jamf_compliance_reporter.audit.exec_args.args_compiled
      ignore_missing: true
  - rename:
      field: json.exec_env.env.ARCH
      target_field: jamf_compliance_reporter.audit.exec_env.env.arch
      ignore_missing: true
  - rename:
      field: json.exec_env.env.CPU
      target_field: jamf_compliance_reporter.audit.exec_env.env.cpu
      ignore_missing: true
  - rename:
      field: json.exec_env.env.MALWAREBYTES_GROUP
      target_field: jamf_compliance_reporter.audit.exec_env.env.malwarebytes_group
      ignore_missing: true
  - rename:
      field: json.exec_env.env.PATH
      target_field: jamf_compliance_reporter.audit.exec_env.env.path
      ignore_missing: true
  - rename:
      field: json.exec_env.env.XPC_FLAGS
      target_field: jamf_compliance_reporter.audit.exec_env.env.xpc_flags
      ignore_missing: true
  - rename:
      field: json.exec_env.env.XPC_SERVICE_NAME
      target_field: jamf_compliance_reporter.audit.exec_env.env.xpc_service_name
      ignore_missing: true
  - rename:
      field: json.exec_env.env_compiled
      target_field: jamf_compliance_reporter.audit.exec_env.env.compiled
      ignore_missing: true
