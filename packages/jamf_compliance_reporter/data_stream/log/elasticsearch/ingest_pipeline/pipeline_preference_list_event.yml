---
description: Pipeline for Jamf Compliance Reporter preference list event logs.
processors:
  - rename:
      field: json.event_attributes.AuditEventExcludedProcesses
      target_field: jamf_compliance_reporter.log.event_attributes.audit_event.excluded_processes
      ignore_missing: true
  - rename:
      field: json.event_attributes.AuditEventExcludedUsers
      target_field: jamf_compliance_reporter.log.event_attributes.audit_event.excluded_users
      ignore_missing: true
  - convert:
      field: json.event_attributes.AuditEventLogVerboseMessages
      target_field: jamf_compliance_reporter.log.event_attributes.audit_event_log_verbose_messages
      type: string
      ignore_failure: true
  - convert:
      field: json.event_attributes.AuditLevel
      target_field: jamf_compliance_reporter.log.event_attributes.audit_level
      type: long
      ignore_failure: true
  - rename:
      field: json.event_attributes.FileEventExclusionPaths
      target_field: jamf_compliance_reporter.log.event_attributes.file_event.exclusion_paths
      ignore_missing: true
  - rename:
      field: json.event_attributes.FileEventInclusionPaths
      target_field: jamf_compliance_reporter.log.event_attributes.file_event.inclusion_paths
      ignore_missing: true
  - convert:
      field: json.event_attributes.FileEventUseFuzzyMatch
      target_field: jamf_compliance_reporter.log.event_attributes.file_event.use_fuzzy_match
      type: long
      ignore_failure: true
  - rename:
      field: json.event_attributes.FileLicenseInfo.LicenseEmail
      target_field: user.email
      ignore_missing: true
  - append:
      field: related.user
      value: '{{{user.email}}}'
      if: ctx.user?.email != null
      allow_duplicates: false
      ignore_failure: true
  - date:
      field: json.event_attributes.FileLicenseInfo.LicenseExpirationDate
      target_field: jamf_compliance_reporter.log.event_attributes.file_license_info.license_expiration_date
      if: ctx.json?.event_attributes?.FileLicenseInfo?.LicenseExpirationDate != '0'
      ignore_failure: true
      formats:
        - dd/MM/yyyy
  - rename:
      field: json.event_attributes.FileLicenseInfo.LicenseKey
      target_field: jamf_compliance_reporter.log.event_attributes.file_license_info.license_key
      ignore_missing: true
  - rename:
      field: json.event_attributes.FileLicenseInfo.LicenseType
      target_field: jamf_compliance_reporter.log.event_attributes.file_license_info.license_type
      ignore_missing: true
  - rename:
      field: json.event_attributes.FileLicenseInfo.LicenseVersion
      target_field: jamf_compliance_reporter.log.event_attributes.file_license_info.license_version
      ignore_missing: true
  - rename:
      field: json.event_attributes.LogFileLocation
      target_field: jamf_compliance_reporter.log.event_attributes.log.file.location
      ignore_missing: true
  - convert:
      field: json.event_attributes.LogFileMaxNumberBackups
      target_field: jamf_compliance_reporter.log.event_attributes.log.file.max_number_backups
      type: long
      ignore_failure: true
  - convert:
      field: json.event_attributes.LogFileMaxSizeMegaBytes
      target_field: jamf_compliance_reporter.log.event_attributes.log.file.max_size_mega_bytes
      type: long
      ignore_failure: true
  - rename:
      field: json.event_attributes.LogFileOwnership
      target_field: jamf_compliance_reporter.log.event_attributes.log.file.ownership
      ignore_missing: true
  - rename:
      field: json.event_attributes.LogFilePermission
      target_field: jamf_compliance_reporter.log.event_attributes.log.file.permission
      ignore_missing: true
  - rename:
      field: json.event_attributes.LogRemoteEndpointEnabled
      target_field: jamf_compliance_reporter.log.event_attributes.log.remote_endpoint_enabled
      ignore_missing: true
  - rename:
      field: json.event_attributes.LogRemoteEndpointType
      target_field: jamf_compliance_reporter.log.event_attributes.log.remote_endpoint_type
      ignore_missing: true
  - rename:
      field: json.event_attributes.LogRemoteEndpointTypeAWSKinesis.AccessKeyId
      target_field: jamf_compliance_reporter.log.event_attributes.log.remote_endpoint_type_awskinesis.access_key_id
      ignore_missing: true
  - rename:
      field: json.event_attributes.LogRemoteEndpointTypeAWSKinesis.Region
      target_field: jamf_compliance_reporter.log.event_attributes.log.remote_endpoint_type_awskinesis.region
      ignore_missing: true
  - rename:
      field: json.event_attributes.LogRemoteEndpointTypeAWSKinesis.SecretKey
      target_field: jamf_compliance_reporter.log.event_attributes.log.remote_endpoint_type_awskinesis.secret_key
      ignore_missing: true
  - rename:
      field: json.event_attributes.LogRemoteEndpointTypeAWSKinesis.StreamName
      target_field: jamf_compliance_reporter.log.event_attributes.log.remote_endpoint_type_awskinesis.stream_name
      ignore_missing: true
  - rename:
      field: json.event_attributes.LogRemoteEndpointURL
      target_field: jamf_compliance_reporter.log.event_attributes.log.remote_endpoint_url
      ignore_missing: true
  - rename:
      field: json.event_attributes.UnifiedLogPredicates
      target_field: jamf_compliance_reporter.log.event_attributes.unified_log_predicates
      ignore_missing: true
  - rename:
      field: json.event_attributes.Version
      target_field: jamf_compliance_reporter.log.event_attributes.version
      ignore_missing: true
