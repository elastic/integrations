rules:
  - path: /token
    methods: [POST]
    request_headers:
      Content-Type:
        - "application/x-www-form-urlencoded"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {{ minify_json `
          {
            "access_token": "1/fFAGRNJru1FTz70BzhT3Zg",
            "expires_in": 3920,
            "token_type": "Bearer",
            "scope": "https://www.googleapis.com/auth/admin.reports.audit.readonly",
            "refresh_token": "1//xEoDL4iW3cxlI7yDbSRFYNG01kVKM2C-259HOF2aQbI"
          }
          `}}
  - path: /v1/organizations/xxxx/sources/-/findings
    methods: [GET]
    query_params:
      filter: "{filter:.*}"
      orderBy: eventTime asc
      pageToken: null
    request_headers:
      Accept:
        - "application/json"
      Authorization:
        - "Bearer 1/fFAGRNJru1FTz70BzhT3Zg"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {{ minify_json `
          {
            "listFindingsResults": [
              {
                "finding": {
                  "name": "organizations/515665165161/sources/98481484454154454545/findings/414rfrhjebhrbhjbr444454hv54545",
                  "parent": "organizations/515665165161/sources/98481484454154454545",
                  "resourceName": "//cloudresourcemanager.googleapis.com/projects/45455445554",
                  "state": "ACTIVE",
                  "category": "application",
                  "externalUri": "http://www.adwait.com",
                  "securityMarks": {
                    "name": "organizations/515665165161/sources/98481484454154454545/findings/414rfrhjebhrbhjbr444454hv54545/securityMarks"
                  },
                  "eventTime": "2023-06-02T05:17:41.936Z",
                  "createTime": "2020-02-19T13:37:43.858Z",
                  "severity": "CRITICAL",
                  "canonicalName": "organizations/515665165161/sources/98481484454154454545/findings/414rfrhjebhrbhjbr444454hv54545",
                  "mute": "UNMUTED",
                  "muteUpdateTime": "2022-03-23T05:50:21.804Z",
                  "externalSystems": {
                    "test": {
                      "name": "organizations/515665165161/sources/98481484454154454545/findings/414rfrhjebhrbhjbr444454hv54545/externalSystems/test",
                      "assignees": [
                        "primary"
                      ],
                      "externalUid": "test_scc_finding_2",
                      "status": "updated1",
                      "externalSystemUpdateTime": "2022-01-05T05:00:35.674Z"
                    }
                  },
                  "muteInitiator": "Unmuted by john@gmail.com"
                },
                "resource": {
                  "name": "//cloudresourcemanager.googleapis.com/projects/45455445554"
                }
              },
              {
                "finding": {
                  "canonicalName": "projects/101234567893/sources/01234567899876543210/locations/global/findings/452f80114abcdef0123456789abcdefd",
                  "category": "SOFTWARE_VULNERABILITY",
                  "contacts": {
                    "security": {
                      "contacts": [
                        {
                          "email": "security@example.com"
                        }
                      ]
                    }
                  },
                  "createTime": "2025-06-28T16:56:07.323Z",
                  "description": "Calling any of the Parse functions on Go source code which contains //line directives with very large line numbers can cause an infinite loop due to integer overflow.",
                  "eventTime": "2025-06-30T06:22:44.440Z",
                  "findingClass": "VULNERABILITY",
                  "mute": "UNDEFINED",
                  "muteUpdateTime": "1970-01-01T00:00:00Z",
                  "name": "organizations/901234567899/sources/01234567899876543210/locations/global/findings/452f80114abcdef0123456789abcdefd",
                  "parent": "organizations/901234567899/sources/01234567899876543210/locations/global",
                  "parentDisplayName": "Vulnerability Assessment",
                  "resourceName": "//compute.googleapis.com/projects/elastic-siem/zones/us-central1-c/instances/xyz-abcd-1234-abc-12-123",
                  "securityMarks": {
                    "name": "organizations/901234567899/sources/01234567899876543210/locations/global/findings/452f80114abcdef0123456789abcdefd/securityMarks"
                  },
                  "severity": "HIGH",
                  "state": "ACTIVE",
                  "vulnerability": {
                    "cve": {
                      "cvssv3": {
                        "attackComplexity": "ATTACK_COMPLEXITY_LOW",
                        "attackVector": "ATTACK_VECTOR_NETWORK",
                        "availabilityImpact": "IMPACT_HIGH",
                        "baseScore": 7.5,
                        "confidentialityImpact": "IMPACT_NONE",
                        "integrityImpact": "IMPACT_NONE",
                        "privilegesRequired": "PRIVILEGES_REQUIRED_NONE",
                        "scope": "SCOPE_UNCHANGED",
                        "userInteraction": "USER_INTERACTION_NONE"
                      },
                      "exploitReleaseDate": "1970-01-01T00:00:00Z",
                      "exploitationActivity": "NO_KNOWN",
                      "firstExploitationDate": "1970-01-01T00:00:00Z",
                      "id": "CVE-2023-24537",
                      "impact": "LOW",
                      "references": [
                        {
                          "source": "More Info",
                          "uri": "https://security-tracker.debian.org/tracker/CVE-2023-24537"
                        },
                        {
                          "source": "More Info",
                          "uri": "https://access.redhat.com/security/cve/CVE-2023-24537"
                        },
                        {
                          "source": "More Info",
                          "uri": "http://people.ubuntu.com/~ubuntu-security/cve/CVE-2023-24537"
                        }
                      ],
                      "upstreamFixAvailable": true
                    },
                    "fixedPackage": {
                      "cpeUri": "cpe:/o:nvd:nvd:1.1",
                      "packageName": "go",
                      "packageType": "GO_STDLIB",
                      "packageVersion": "1.19.8"
                    },
                    "offendingPackage": {
                      "cpeUri": "cpe:/o:nvd:nvd:1.1",
                      "packageName": "go",
                      "packageType": "GO_STDLIB",
                      "packageVersion": "1.13.8"
                    },
                    "securityBulletin": {
                      "submissionTime": "1970-01-01T00:00:00Z"
                    }
                  }
                },
                "resource": {
                  "cloudProvider": "GOOGLE_CLOUD_PLATFORM",
                  "displayName": "abc-wxyz-abcd-pqr-12-123",
                  "gcpMetadata": {
                    "folders": [
                      {
                        "resourceFolder": "//cloudresourcemanager.googleapis.com/folders/801234567893",
                        "resourceFolderDisplayName": "Security"
                      },
                      {
                        "resourceFolder": "//cloudresourcemanager.googleapis.com/folders/901234567891",
                        "resourceFolderDisplayName": "Engineering"
                      },
                      {
                        "resourceFolder": "//cloudresourcemanager.googleapis.com/folders/901234567891",
                        "resourceFolderDisplayName": "Research and Development"
                      }
                    ],
                    "organization": "organizations/901234567899",
                    "parent": "//cloudresourcemanager.googleapis.com/projects/101234567893",
                    "parentDisplayName": "elastic-siem",
                    "project": "//cloudresourcemanager.googleapis.com/projects/101234567893",
                    "projectDisplayName": "elastic-siem"
                  },
                  "location": "us-central1-c",
                  "name": "//compute.googleapis.com/projects/elastic-siem/zones/us-central1-c/instances/abc-wxyz-abcd-pqr-12-123",
                  "resourcePath": {
                    "nodes": [
                      {
                        "displayName": "elastic-siem",
                        "id": "projects/101234567893",
                        "nodeType": "GCP_PROJECT"
                      },
                      {
                        "displayName": "Security",
                        "id": "folders/801234567893",
                        "nodeType": "GCP_FOLDER"
                      },
                      {
                        "displayName": "Engineering",
                        "id": "folders/901234567891",
                        "nodeType": "GCP_FOLDER"
                      },
                      {
                        "displayName": "Research and Development",
                        "id": "folders/901234567891",
                        "nodeType": "GCP_FOLDER"
                      },
                      {
                        "id": "organizations/901234567899",
                        "nodeType": "GCP_ORGANIZATION"
                      }
                    ]
                  },
                  "resourcePathString": "organizations/901234567899/folders/901234567891/folders/901234567891/folders/801234567893/projects/101234567893",
                  "service": "compute.googleapis.com",
                  "type": "google.compute.Instance"
                }
              }
            ],
            "nextPageToken": "nextPage1",
            "totalSize": 5
          }
          `}}
  - path: /v1/organizations/xxxx/sources/-/findings
    methods: [GET]
    query_params:
      filter: "{filter:.*}"
      orderBy: eventTime asc
      pageToken: nextPage1
    request_headers:
      Accept:
        - "application/json"
      Authorization:
        - "Bearer 1/fFAGRNJru1FTz70BzhT3Zg"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {{ minify_json `
          {
            "listFindingsResults": [
              {
                "finding": {
                  "canonicalName": "projects/101235645003/sources/14012345677654321025/locations/global/findings/9eaabcdef01234567890123456789147",
                  "category": "COMPUTE_SECURE_BOOT_DISABLED",
                  "contacts": {
                    "security": {
                      "contacts": [
                        {
                          "email": "security@example.com"
                        }
                      ]
                    }
                  },
                  "createTime": "2025-06-04T07:56:02.904Z",
                  "description": "Using secure boot helps protect your virtual machines against rootkits, boot- and kernel-level malware. Learn more at: https://cloud.google.com/security/shielded-cloud/shielded-vm",
                  "eventTime": "2025-06-04T07:44:08.656Z",
                  "externalUri": "https://console.cloud.google.com/compute/instancesDetail/zones/us-central1-b/instances/instance-20250528-112341?project=test-siem",
                  "findingClass": "MISCONFIGURATION",
                  "mute": "UNDEFINED",
                  "muteInfo": {
                    "staticMute": {
                      "applyTime": "1970-01-01T00:00:00Z",
                      "state": "UNDEFINED"
                    }
                  },
                  "muteUpdateTime": "1970-01-01T00:00:00Z",
                  "name": "organizations/012345601234/sources/14012345677654321025/locations/global/findings/9eaabcdef01234567890123456789147",
                  "parent": "organizations/012345601234/sources/14012345677654321025/locations/global",
                  "parentDisplayName": "Security Health Analytics",
                  "resourceName": "//compute.googleapis.com/projects/test-siem/zones/us-central1-b/instances/instance-20250528-112341",
                  "securityMarks": {
                    "name": "organizations/012345601234/sources/14012345677654321025/locations/global/findings/9eaabcdef01234567890123456789147/securityMarks"
                  },
                  "severity": "MEDIUM",
                  "sourceProperties": {
                    "ExceptionInstructions": "Add the security mark \"allow_compute_secure_boot_disabled\" to the asset with a value of \"true\" to prevent this finding from being activated again.",
                    "Explanation": "Using secure boot helps protect your virtual machines against rootkits, boot- and kernel-level malware. Learn more at: https://cloud.google.com/security/shielded-cloud/shielded-vm",
                    "ReactivationCount": 0,
                    "Recommendation": "Go to https://console.cloud.google.com/compute/instancesDetail/zones/us-central1-b/instances/instance-20250528-112341?project=test-siem and click \"Stop\". Once the instance has stopped, scroll down to the \"Shielded VM\" section and check the \"Turn on Secure Boot\" checkbox. Then you can start the instance back up by clicking the \"Start\" button.",
                    "ResourcePath": [
                      "projects/test-siem/",
                      "folders/801234567893/",
                      "folders/901234567891/",
                      "folders/901234567890/",
                      "organizations/012345601234/"
                    ],
                    "ScannerName": "COMPUTE_INSTANCE_SCANNER"
                  },
                  "state": "ACTIVE"
                },
                "resource": {
                  "cloudProvider": "GOOGLE_CLOUD_PLATFORM",
                  "displayName": "instance-20250528-112341",
                  "gcpMetadata": {
                    "folders": [
                      {
                        "resourceFolder": "//cloudresourcemanager.googleapis.com/folders/801234567893",
                        "resourceFolderDisplayName": "Security"
                      },
                      {
                        "resourceFolder": "//cloudresourcemanager.googleapis.com/folders/901234567891",
                        "resourceFolderDisplayName": "Engineering"
                      },
                      {
                        "resourceFolder": "//cloudresourcemanager.googleapis.com/folders/901234567890",
                        "resourceFolderDisplayName": "Research and Development"
                      }
                    ],
                    "organization": "organizations/012345601234",
                    "parent": "//cloudresourcemanager.googleapis.com/projects/101235645003",
                    "parentDisplayName": "test-siem",
                    "project": "//cloudresourcemanager.googleapis.com/projects/101235645003",
                    "projectDisplayName": "test-siem"
                  },
                  "location": "us-central1-b",
                  "name": "//compute.googleapis.com/projects/test-siem/zones/us-central1-b/instances/instance-20250528-112341",
                  "resourcePath": {
                    "nodes": [
                      {
                        "displayName": "test-siem",
                        "id": "projects/101235645003",
                        "nodeType": "GCP_PROJECT"
                      },
                      {
                        "displayName": "Security",
                        "id": "folders/801234567893",
                        "nodeType": "GCP_FOLDER"
                      },
                      {
                        "displayName": "Engineering",
                        "id": "folders/901234567891",
                        "nodeType": "GCP_FOLDER"
                      },
                      {
                        "displayName": "Research and Development",
                        "id": "folders/901234567890",
                        "nodeType": "GCP_FOLDER"
                      },
                      {
                        "id": "organizations/012345601234",
                        "nodeType": "GCP_ORGANIZATION"
                      }
                    ]
                  },
                  "resourcePathString": "organizations/012345601234/folders/901234567890/folders/901234567891/folders/801234567893/projects/101235645003",
                  "service": "compute.googleapis.com",
                  "type": "google.compute.Instance"
                }
              },
              {
                "finding": {
                  "canonicalName": "projects/101235645003/sources/14012345677654321025/locations/global/findings/23c56be7abcdefabcdefabcdef0257b6",
                  "category": "PUBLIC_IP_ADDRESS",
                  "compliances": [
                    {
                      "ids": [
                        "DSP-17"
                      ],
                      "standard": "ccm",
                      "version": "4"
                    },
                    {
                      "ids": [
                        "4.9"
                      ],
                      "standard": "cis",
                      "version": "1.1"
                    },
                    {
                      "ids": [
                        "4.9"
                      ],
                      "standard": "cis",
                      "version": "1.2"
                    },
                    {
                      "ids": [
                        "4.9"
                      ],
                      "standard": "cis",
                      "version": "1.3"
                    },
                    {
                      "ids": [
                        "4.9"
                      ],
                      "standard": "cis",
                      "version": "2.0"
                    },
                    {
                      "ids": [
                        "3.3"
                      ],
                      "standard": "cis-controls",
                      "version": "8.0"
                    },
                    {
                      "ids": [
                        "164.308(a)(3)(i)",
                        "164.308(a)(3)(ii)",
                        "164.312(a)(1)"
                      ],
                      "standard": "hipaa"
                    },
                    {
                      "ids": [
                        "A.5.10",
                        "A.5.15",
                        "A.8.3",
                        "A.8.4"
                      ],
                      "standard": "iso-27001",
                      "version": "2022"
                    },
                    {
                      "ids": [
                        "CA-3",
                        "SC-7"
                      ],
                      "standard": "nist"
                    },
                    {
                      "ids": [
                        "PR-AC-4"
                      ],
                      "standard": "nist-csf",
                      "version": "1.0"
                    },
                    {
                      "ids": [
                        "AC-3",
                        "AC-5",
                        "AC-6",
                        "MP-2"
                      ],
                      "standard": "nist800-53",
                      "version": "r5"
                    },
                    {
                      "ids": [
                        "1.2.1"
                      ],
                      "standard": "pci"
                    },
                    {
                      "ids": [
                        "1.3.1"
                      ],
                      "standard": "pci-dss",
                      "version": "4.0"
                    },
                    {
                      "ids": [
                        "CC5.2.3",
                        "CC6.1.3",
                        "CC6.1.7"
                      ],
                      "standard": "soc2",
                      "version": "2017"
                    }
                  ],
                  "contacts": {
                    "security": {
                      "contacts": [
                        {
                          "email": "security@example.com"
                        }
                      ]
                    }
                  },
                  "createTime": "2025-07-10T11:45:27.202Z",
                  "description": "To reduce the attack surface, avoid assigning public IP addresses to your VMs. Stopped instances may still be flagged with a Public IP finding, e.g. if the network interfaces are configured to assign an ephemeral public IP on start. Ensure the network configurations for stopped instances do not include external access.",
                  "eventTime": "2025-07-10T11:45:26.519Z",
                  "externalUri": "https://console.cloud.google.com/compute/instancesDetail/zones/us-central1-f/instances/vpc-flow-agent?project=test-siem",
                  "findingClass": "MISCONFIGURATION",
                  "mute": "UNDEFINED",
                  "muteInfo": {
                    "staticMute": {
                      "applyTime": "1970-01-01T00:00:00Z",
                      "state": "UNDEFINED"
                    }
                  },
                  "muteUpdateTime": "1970-01-01T00:00:00Z",
                  "name": "organizations/012345601234/sources/14012345677654321025/locations/global/findings/23c56be7abcdefabcdefabcdef0257b6",
                  "parent": "organizations/012345601234/sources/14012345677654321025/locations/global",
                  "parentDisplayName": "Security Health Analytics",
                  "resourceName": "//compute.googleapis.com/projects/test-siem/zones/us-central1-f/instances/vpc-flow-agent",
                  "securityMarks": {
                    "name": "organizations/012345601234/sources/14012345677654321025/locations/global/findings/23c56be7abcdefabcdefabcdef0257b6/securityMarks"
                  },
                  "severity": "HIGH",
                  "sourceProperties": {
                    "ExceptionInstructions": "Add the security mark \"allow_public_ip_address\" to the asset with a value of \"true\" to prevent this finding from being activated again.",
                    "Explanation": "To reduce the attack surface, avoid assigning public IP addresses to your VMs. Stopped instances may still be flagged with a Public IP finding, e.g. if the network interfaces are configured to assign an ephemeral public IP on start. Ensure the network configurations for stopped instances do not include external access.",
                    "ReactivationCount": 0,
                    "Recommendation": "If this is unintended, please go to https://console.cloud.google.com/compute/instancesDetail/zones/us-central1-f/instances/vpc-flow-agent?project=test-siem and click \"Edit\". For each interface under the \"Network interfaces\" heading, set \"External IP\" to \"None\", then click \"Done\" and \"Save\". If you would like to learn more about securing access to your infrastructure, see https://cloud.google.com/solutions/connecting-securely.",
                    "ResourcePath": [
                      "projects/test-siem/",
                      "folders/801234567893/",
                      "folders/901234567891/",
                      "folders/901234567890/",
                      "organizations/012345601234/"
                    ],
                    "ScannerName": "COMPUTE_INSTANCE_SCANNER",
                    "VulnerableNetworkInterfaceNames": [
                      "nic0"
                    ],
                    "compliance_standards": {
                      "ccm": [
                        {
                          "ids": [
                            "DSP-17"
                          ],
                          "version": "4"
                        }
                      ],
                      "cis": [
                        {
                          "ids": [
                            "4.9"
                          ],
                          "version": "1.1"
                        },
                        {
                          "ids": [
                            "4.9"
                          ],
                          "version": "1.2"
                        },
                        {
                          "ids": [
                            "4.9"
                          ],
                          "version": "1.3"
                        },
                        {
                          "ids": [
                            "4.9"
                          ],
                          "version": "2.0"
                        }
                      ],
                      "cisControls": [
                        {
                          "ids": [
                            "3.3"
                          ],
                          "version": "8.0"
                        }
                      ],
                      "hipaa": [
                        {
                          "ids": [
                            "164.308(a)(3)(i)",
                            "164.308(a)(3)(ii)",
                            "164.312(a)(1)"
                          ]
                        }
                      ],
                      "iso": [
                        {
                          "ids": [
                            "A.5.10",
                            "A.5.15",
                            "A.8.3",
                            "A.8.4"
                          ],
                          "version": "2022"
                        }
                      ],
                      "nist": [
                        {
                          "ids": [
                            "CA-3",
                            "SC-7"
                          ]
                        },
                        {
                          "ids": [
                            "AC-3",
                            "AC-5",
                            "AC-6",
                            "MP-2"
                          ],
                          "version": "r5"
                        }
                      ],
                      "nistCsf": [
                        {
                          "ids": [
                            "PR-AC-4"
                          ],
                          "version": "1.0"
                        }
                      ],
                      "pci": [
                        {
                          "ids": [
                            "1.2.1"
                          ]
                        },
                        {
                          "ids": [
                            "1.3.1"
                          ],
                          "version": "4.0"
                        }
                      ],
                      "soc2": [
                        {
                          "ids": [
                            "CC5.2.3",
                            "CC6.1.3",
                            "CC6.1.7"
                          ],
                          "version": "2017"
                        }
                      ]
                    }
                  },
                  "state": "ACTIVE"
                },
                "resource": {
                  "cloudProvider": "GOOGLE_CLOUD_PLATFORM",
                  "displayName": "vpc-flow-agent",
                  "gcpMetadata": {
                    "folders": [
                      {
                        "resourceFolder": "//cloudresourcemanager.googleapis.com/folders/801234567893",
                        "resourceFolderDisplayName": "Security"
                      },
                      {
                        "resourceFolder": "//cloudresourcemanager.googleapis.com/folders/901234567891",
                        "resourceFolderDisplayName": "Engineering"
                      },
                      {
                        "resourceFolder": "//cloudresourcemanager.googleapis.com/folders/901234567890",
                        "resourceFolderDisplayName": "Research and Development"
                      }
                    ],
                    "organization": "organizations/012345601234",
                    "parent": "//cloudresourcemanager.googleapis.com/projects/101235645003",
                    "parentDisplayName": "test-siem",
                    "project": "//cloudresourcemanager.googleapis.com/projects/101235645003",
                    "projectDisplayName": "test-siem"
                  },
                  "location": "us-central1-f",
                  "name": "//compute.googleapis.com/projects/test-siem/zones/us-central1-f/instances/vpc-flow-agent",
                  "resourcePath": {
                    "nodes": [
                      {
                        "displayName": "test-siem",
                        "id": "projects/101235645003",
                        "nodeType": "GCP_PROJECT"
                      },
                      {
                        "displayName": "Security",
                        "id": "folders/801234567893",
                        "nodeType": "GCP_FOLDER"
                      },
                      {
                        "displayName": "Engineering",
                        "id": "folders/901234567891",
                        "nodeType": "GCP_FOLDER"
                      },
                      {
                        "displayName": "Research and Development",
                        "id": "folders/901234567890",
                        "nodeType": "GCP_FOLDER"
                      },
                      {
                        "id": "organizations/012345601234",
                        "nodeType": "GCP_ORGANIZATION"
                      }
                    ]
                  },
                  "resourcePathString": "organizations/012345601234/folders/901234567890/folders/901234567891/folders/801234567893/projects/101235645003",
                  "service": "compute.googleapis.com",
                  "type": "google.compute.Instance"
                }
              }
            ],
            "nextPageToken": "nextPage2",
            "totalSize": 5
          }
          `}}
  - path: /v1/organizations/xxxx/sources/-/findings
    methods: [GET]
    query_params:
      filter: "{filter:.*}"
      orderBy: eventTime asc
      pageToken: nextPage2
    request_headers:
      Accept:
        - "application/json"
      Authorization:
        - "Bearer 1/fFAGRNJru1FTz70BzhT3Zg"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {{ minify_json `
          {
            "listFindingsResults": [
              {
                "finding": {
                  "access": {
                    "callerIp": "1.128.0.1",
                    "callerIpGeo": {
                      "regionCode": "ES"
                    },
                    "methodName": "google.iam.admin.v1.CreateServiceAccountKey",
                    "principalEmail": "test@example.com",
                    "principalSubject": "user:test@example.com",
                    "serviceName": "iam.googleapis.com",
                    "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15,gzip(gfe)"
                  },
                  "canonicalName": "projects/101235645003/sources/16012345670123456735/locations/global/findings/344abcdef01234567890123456789b11",
                  "category": "Persistence: Service Account Key Created",
                  "contacts": {
                    "security": {
                      "contacts": [
                        {
                          "email": "security@example.com"
                        }
                      ]
                    }
                  },
                  "createTime": "2025-07-15T08:55:04.499Z",
                  "eventTime": "2025-07-15T08:55:04.043Z",
                  "findingClass": "THREAT",
                  "logEntries": [
                    {
                      "cloudLoggingEntry": {
                        "insertId": "y012ajvhac0o2",
                        "logId": "cloudaudit.googleapis.com/activity",
                        "resourceContainer": "projects/test-siem",
                        "timestamp": "2025-07-15T08:54:59.030493497Z"
                      }
                    }
                  ],
                  "mitreAttack": {
                    "primaryTactic": "PERSISTENCE",
                    "primaryTechniques": [
                      "ACCOUNT_MANIPULATION",
                      "ADDITIONAL_CLOUD_CREDENTIALS"
                    ]
                  },
                  "mute": "UNDEFINED",
                  "muteInfo": {
                    "staticMute": {
                      "applyTime": "1970-01-01T00:00:00Z",
                      "state": "UNDEFINED"
                    }
                  },
                  "muteUpdateTime": "1970-01-01T00:00:00Z",
                  "name": "organizations/012345601234/sources/16012345670123456735/locations/global/findings/344abcdef01234567890123456789b11",
                  "parent": "organizations/012345601234/sources/16012345670123456735/locations/global",
                  "parentDisplayName": "Event Threat Detection",
                  "resourceName": "//iam.googleapis.com/projects/test-siem/serviceAccounts/110123456083753043656",
                  "securityMarks": {
                    "name": "organizations/012345601234/sources/16012345670123456735/locations/global/findings/344abcdef01234567890123456789b11/securityMarks"
                  },
                  "severity": "LOW",
                  "sourceProperties": {
                    "affectedResources": [
                      {
                        "gcpResourceName": "//cloudresourcemanager.googleapis.com/projects/101235645003"
                      }
                    ],
                    "contextUris": {
                      "cloudLoggingQueryUri": [
                        {
                          "displayName": "Cloud Logging Query Link",
                          "url": "https://console.cloud.google.com/logs/query;query=timestamp%3D%222025-07-15T08:54:59.030493497Z%22%0AinsertId%3D%22y012ajvhac0o2%22?project=test-siem"
                        }
                      ],
                      "mitreUri": {
                        "displayName": "MITRE Link",
                        "url": "https://attack.mitre.org/techniques/T1098/001/"
                      },
                      "relatedFindingUri": {}
                    },
                    "detectionCategory": {
                      "ruleName": "service_account_key_creation"
                    },
                    "detectionPriority": "LOW",
                    "evidence": [
                      {
                        "sourceLogId": {
                          "insertId": "y012ajvhac0o2",
                          "logId": "cloudaudit.googleapis.com/activity",
                          "projectId": "test-siem",
                          "resourceContainer": "projects/test-siem",
                          "timestamp": {
                            "nanos": 30493497,
                            "seconds": "1752569699"
                          }
                        }
                      }
                    ],
                    "findingId": "344abcdef01234567890123456789b11",
                    "properties": {},
                    "sourceId": {
                      "customerOrganizationNumber": "012345601234",
                      "projectNumber": "101235645003"
                    }
                  },
                  "state": "ACTIVE"
                },
                "resource": {
                  "cloudProvider": "GOOGLE_CLOUD_PLATFORM",
                  "displayName": "projects/test-siem/serviceAccounts/gke-pubsub-consumer@test-siem.gserviceaccount.com",
                  "gcpMetadata": {
                    "folders": [
                      {
                        "resourceFolder": "//cloudresourcemanager.googleapis.com/folders/801234567893",
                        "resourceFolderDisplayName": "Security"
                      },
                      {
                        "resourceFolder": "//cloudresourcemanager.googleapis.com/folders/901234567891",
                        "resourceFolderDisplayName": "Engineering"
                      },
                      {
                        "resourceFolder": "//cloudresourcemanager.googleapis.com/folders/901234567890",
                        "resourceFolderDisplayName": "Research and Development"
                      }
                    ],
                    "organization": "organizations/012345601234",
                    "parent": "//cloudresourcemanager.googleapis.com/projects/101235645003",
                    "parentDisplayName": "test-siem",
                    "project": "//cloudresourcemanager.googleapis.com/projects/101235645003",
                    "projectDisplayName": "test-siem"
                  },
                  "name": "//iam.googleapis.com/projects/test-siem/serviceAccounts/110123456083753043656",
                  "resourcePath": {
                    "nodes": [
                      {
                        "displayName": "test-siem",
                        "id": "projects/101235645003",
                        "nodeType": "GCP_PROJECT"
                      },
                      {
                        "displayName": "Security",
                        "id": "folders/801234567893",
                        "nodeType": "GCP_FOLDER"
                      },
                      {
                        "displayName": "Engineering",
                        "id": "folders/901234567891",
                        "nodeType": "GCP_FOLDER"
                      },
                      {
                        "displayName": "Research and Development",
                        "id": "folders/901234567890",
                        "nodeType": "GCP_FOLDER"
                      },
                      {
                        "id": "organizations/012345601234",
                        "nodeType": "GCP_ORGANIZATION"
                      }
                    ]
                  },
                  "resourcePathString": "organizations/012345601234/folders/901234567890/folders/901234567891/folders/801234567893/projects/101235645003",
                  "service": "iam.googleapis.com",
                  "type": "google.iam.ServiceAccount"
                }
              }
            ],
            "totalSize": 5
          }
          `}}
  - path: /v1/organizations/xxxx/sources
    methods: [GET]
    request_headers:
      Accept:
        - "application/json"
      Authorization:
        - "Bearer 1/fFAGRNJru1FTz70BzhT3Zg"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {{ minify_json `
          {
            "sources": [
              {
                "name": "organizations/595779152576/sources/10134421585261057824",
                "displayName": "Cloudflare Security Events",
                "description": "Extend your security view from the edge.",
                "canonicalName": "organizations/595779152576/sources/10134421585261057824"
              }
            ]
          }
          `}}
  - path: /v1/organizations/xxxx/assets
    methods: [GET]
    request_headers:
      Accept:
        - "application/json"
      Authorization:
        - "Bearer 1/fFAGRNJru1FTz70BzhT3Zg"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {{ minify_json `
          {
            "assets": [
              {
                "name": "//cloudbilling.googleapis.com/billingAccounts/012345-A08098-1Ab2CD",
                "assetType": "cloudbilling.googleapis.com/BillingAccount",
                "resource": {
                  "version": "v1",
                  "discoveryDocumentUri": "https://cloudbilling.googleapis.com/$discovery/rest",
                  "discoveryName": "BillingAccount",
                  "data": {
                    "displayName": "New",
                    "name": "billingAccounts/012345-A08098-1Ab2CD"
                  },
                  "location": "global"
                },
                "ancestors": [
                  "organizations/523456987520"
                ],
                "updateTime": "2022-11-17T12:20:17.601902Z"
              }
            ]
          }
          `}}
