input: gcs
wait_for_data_timeout: 1m
data_stream:
  vars:
    service_account_file: "{{GOOGLE_APPLICATION_CREDENTIALS}}"
    service_account_key: "{{GOOGLE_CLOUD_KEYFILE_JSON}}"
    project_id: "{{GCLOUD_PROJECT}}"
    buckets: |
      - name: "{{TF_OUTPUT_panw_cortex_xdr_event_bucket_name}}"
        poll: true
        poll_interval: 15s
    preserve_original_event: true
    preserve_duplicate_custom_fields: true
assert:
  hit_count: 2
