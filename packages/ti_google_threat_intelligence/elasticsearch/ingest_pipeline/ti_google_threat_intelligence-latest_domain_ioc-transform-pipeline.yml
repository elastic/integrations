---
description: Pipeline for processing Domain IOC events from Google Threat Intelligence Threat Feed events.
processors:
  - rename:
      field: gti.cryptominer
      tag: rename_gti_cryptominer
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.first_stage_delivery_vectors
      tag: rename_gti_first_stage_delivery_vectors
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.infostealer
      tag: rename_gti_infostealer
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.iot
      tag: rename_gti_iot
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.linux
      tag: rename_gti_linux
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.malicious_network_infrastructure
      tag: rename_gti_malicious_network_infrastructure
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.malware
      tag: rename_gti_malware
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.mobile
      tag: rename_gti_mobile
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.osx
      tag: rename_gti_osx
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.phishing
      tag: rename_gti_phishing
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.ransomware
      tag: rename_gti_ransomware
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.threat_actor
      tag: rename_gti_threat_actor
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.trending
      tag: rename_gti_trending
      target_field: gti.domain_ioc
      ignore_missing: true
  - rename:
      field: gti.vulnerability_weaponization
      tag: rename_gti_vulnerability_weaponization
      target_field: gti.domain_ioc
      ignore_missing: true
  - set:
      field: data_stream.dataset
      tag: set_data_stream_dataset
      value: ti_google_threat_intelligence.domain_ioc
  - set:
      field: event.dataset
      tag: set_event_dataset
      value: ti_google_threat_intelligence.domain_ioc
on_failure:
  - set:
      field: event.kind
      value: pipeline_error
  - append:
      field: error.message
      value: '{{{ _ingest.on_failure_message }}}'
