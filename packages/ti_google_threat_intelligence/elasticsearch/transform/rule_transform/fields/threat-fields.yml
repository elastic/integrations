# To utilize the detection rule for correlation effectively, the threat.indicator fields must be added to the GTI fields mapping. This ensures that data from detected alerts is properly retrieved.
# For fields where the threat.indicator field is not found, custom mappings have been defined to address this.
- name: threat
  type: group
  fields:
    - name: indicator
      type: group
      fields:
        - name: as
          type: group
          fields:
            - name: owner
              type: keyword
        - name: attributes
          type: keyword
        - name: campaigns
          type: group
          fields:
            - name: attributes
              type: group
              fields:
                - name: collection_type
                  type: keyword
                - name: name
                  type: keyword
            - name: id
              type: keyword
            - name: type
              type: keyword
        - name: categories
          type: keyword
        - name: collections
          type: group
          fields:
            - name: attributes
              type: group
              fields:
                - name: collection_type
                  type: keyword
                - name: name
                  type: keyword
            - name: id
              type: keyword
            - name: type
              type: keyword
        - name: created
          type: date
        - name: domain
          type: keyword
        - name: feed_type
          type: keyword
        - name: first_submission_date
          type: date
        - name: harmless
          type: long
        - name: http_response_code
          type: long
        - name: id
          type: keyword
        - name: jarm
          type: keyword
        - name: last_analysis_results
          type: group
          fields:
            - name: engine
              type: keyword
            - name: result
              type: keyword
        - name: last_submission_date
          type: date
        - name: malicious
          type: long
        - name: malware_families
          type: group
          fields:
            - name: attributes
              type: group
              fields:
                - name: collection_type
                  type: keyword
                - name: name
                  type: keyword
            - name: id
              type: keyword
            - name: type
              type: keyword
        - name: matched
          type: group
          fields:
            - name: dataset
              type: keyword
            - name: field
              type: keyword
            - name: module
              type: keyword
            - name: value
              type: keyword
        - name: meaningful_name
          type: keyword
        - name: network
          type: keyword
        - name: outgoing_links
          type: keyword
        - name: positives
          type: long
        - name: regional_internet_registry
          type: keyword
        - name: reports
          type: group
          fields:
            - name: attributes
              type: group
              fields:
                - name: collection_type
                  type: keyword
                - name: name
                  type: keyword
            - name: id
              type: keyword
            - name: type
              type: keyword
        - name: score
          type: long
        - name: severity
          type: keyword
        - name: software_toolkits
          type: group
          fields:
            - name: attributes
              type: group
              fields:
                - name: collection_type
                  type: keyword
                - name: name
                  type: keyword
            - name: id
              type: keyword
            - name: type
              type: keyword
        - name: suspicious
          type: long
        - name: threat_actors
          type: group
          fields:
            - name: attributes
              type: group
              fields:
                - name: collection_type
                  type: keyword
                - name: name
                  type: keyword
            - name: id
              type: keyword
            - name: type
              type: keyword
        - name: timeout
          type: long
        - name: times_submitted
          type: long
        - name: top_level_domain
          type: keyword
        - name: type_tags
          type: keyword
        - name: undetected
          type: long
        - name: url
          type: group
          fields:
            - name: id
              type: keyword
        - name: user_tags
          type: keyword
        - name: verdict
          type: keyword
        - name: vhash
          type: keyword
        - name: vulnerabilities
          type: group
          fields:
            - name: attributes
              type: group
              fields:
                - name: collection_type
                  type: keyword
                - name: name
                  type: keyword
            - name: id
              type: keyword
            - name: type
              type: keyword
        - name: web_page_title
          type: keyword
