{
    "attributes": {
        "id": "8703c9eb-90fd-48d9-b1c5-2dcfa3787f80",
        "updated_at": "2025-04-01T12:01:18.572Z",
        "updated_by": "elastic",
        "created_at": "2025-04-01T11:57:56.648Z",
        "created_by": "elastic",
        "name": "Google Threat Intelligence File IOC Stream Correlation",
        "tags": [
            "Google Threat Intelligence",
            "File IOC Stream",
            "Elastic",
            "Threat Intelligence",
            "IOC Stream"
        ],
        "interval": "1h",
        "enabled": false,
        "revision": 1,
        "description": "This rule is triggered when File IOC's collected from the Google Threat Intelligence Integration have a match against File hash that were found in the customer environment.",
        "risk_score": 99,
        "severity": "critical",
        "license": "Elastic License v2",
        "output_index": "",
        "meta": {
            "from": "5m",
            "kibana_siem_app_url": ""
        },
        "author": [
            "Elastic"
        ],
        "false_positives": [],
        "from": "now-3900s",
        "rule_id": "378bd5c1-04ab-4048-a7ba-d25c3e1e3585",
        "max_signals": 1000,
        "risk_score_mapping": [],
        "severity_mapping": [],
        "threat": [],
        "to": "now",
        "references": [],
        "version": 1,
        "exceptions_list": [],
        "immutable": false,
        "rule_source": {
            "type": "internal"
        },
        "related_integrations": [
            {
                "package": "ti_google_threat_intelligence",
                "version": "^0.6.0"
            }
        ],
        "required_fields": [
            {
                "name": "threat.indicator.file.hash.sha256",
                "type": "keyword",
                "ecs": true
            }
        ],
        "setup": "",
        "type": "threat_match",
        "language": "kuery",
        "index": [
            "apm-*-transaction*",
            "auditbeat-*",
            "endgame-*",
            "filebeat-*",
            "logs-*",
            "packetbeat-*",
            "traces-apm*",
            "winlogbeat-*",
            "-*elastic-cloud-logs-*"
        ],
        "query": "NOT event.module : \"ti_google_threat_intelligence\" ",
        "filters": [],
        "threat_filters": [],
        "threat_query": "@timestamp >= \"now-30d/d\"",
        "threat_mapping": [
            {
                "entries": [
                    {
                        "field": "file.hash.sha256",
                        "type": "mapping",
                        "value": "threat.indicator.file.hash.sha256"
                    }
                ]
            },
            {
                "entries": [
                    {
                        "field": "email.attachments.file.hash.sha256",
                        "type": "mapping",
                        "value": "threat.indicator.file.hash.sha256"
                    }
                ]
            }
        ],
        "threat_language": "kuery",
        "threat_index": [
            "logs-ti_google_threat_intelligence_latest.dest_file_ioc_st*"
        ],
        "threat_indicator_path": "gti.threat.indicator",
        "actions": []
    },
    "type": "security-rule",
    "id": "378bd5c1-04ab-4048-a7ba-d25c3e1e3585"
}
