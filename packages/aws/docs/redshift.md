# Amazon Redshift

This integration is used to fetch metrics from [Amazon Redshift](https://aws.amazon.com/redshift/)â€”a cloud data warehouse.

Use the Amazon Redshift integration to collect and parse metrics related to the health status, resource usage, and query performance of Amazon Redshift. Then visualize that data in Kibana, create alerts to notify you if something goes wrong,
and reference metrics when troubleshooting an issue.

For example, you could use the data from this integration to track the health status of your clusters. Then create an alert that notifies a team if health status changes unexpectedly.

**IMPORTANT: Extra AWS charges on AWS API requests will be generated by this integration. Please refer to the AWS integration for more details.**

## Data streams

The Amazon Redshift integration collects one type of data: metrics.

**Metrics** give you insight into the state of Amazon Redshift.
Metrics collected by the Amazon Redshift integration include disk read throughput, storage read latency, query latency, and more. See more details in the [Metrics reference](#metrics-reference).

## Requirements

You need Elasticsearch for storing and searching your data and Kibana for visualizing and managing it.
You can use our hosted Elasticsearch Service on Elastic Cloud, which is recommended, or self-manage the Elastic Stack on your own hardware.

Before using any AWS integration you will need:

* **AWS Credentials** to connect with your AWS account.
* **AWS Permissions** to make sure the user you're using to connect has permission to share the relevant data.

For more details about these requirements, please take a look at the [AWS integration documentation](https://docs.elastic.co/integrations/aws#requirements).

## Setup

Use this integration if you only need to collect data from the Amazon Redshift.

If you want to collect data from two or more AWS services, consider using the **AWS** integration.
When you configure the AWS integration, you can collect data from as many AWS services as you'd like.

For step-by-step instructions on how to set up an integration, see the [Getting started](https://www.elastic.co/guide/en/welcome-to-elastic/current/getting-started-observability.html) guide.

## Metrics

An example event for `redshift` looks as following:

```json
{
    "@timestamp": "2022-06-27T11:58:00.000Z",
    "agent": {
        "ephemeral_id": "a94b780f-b5b5-49b1-88cd-b7a7835f2996",
        "id": "d745bccd-73a3-41b4-9fd0-4d9bac14f77b",
        "name": "docker-fleet-agent",
        "type": "metricbeat",
        "version": "8.2.0"
    },
    "aws": {
        "cloudwatch": {
            "namespace": "AWS/Redshift"
        },
        "dimensions": {
            "ClusterIdentifier": "test"
        },
        "redshift": {
            "metrics": {
                "CPUUtilization": {
                    "avg": 2.43551912568288
                },
                "CommitQueueLength": {
                    "avg": 0
                },
                "ConcurrencyScalingActiveClusters": {
                    "avg": 0
                },
                "DatabaseConnections": {
                    "avg": 0
                },
                "HealthStatus": {
                    "avg": 1
                },
                "MaintenanceMode": {
                    "avg": 0
                },
                "MaxConfiguredConcurrencyScalingClusters": {
                    "avg": 1
                },
                "NetworkReceiveThroughput": {
                    "avg": 2585.956001900078
                },
                "NetworkTransmitThroughput": {
                    "avg": 23262.257531749852
                },
                "NumExceededSchemaQuotas": {
                    "avg": 0
                },
                "PercentageDiskSpaceUsed": {
                    "avg": 0.2197265625
                },
                "ReadIOPS": {
                    "avg": 0
                },
                "ReadLatency": {
                    "avg": 0
                },
                "ReadThroughput": {
                    "avg": 0
                },
                "TotalTableCount": {
                    "avg": 7
                },
                "WriteIOPS": {
                    "avg": 0
                },
                "WriteLatency": {
                    "avg": 0
                },
                "WriteThroughput": {
                    "avg": 0
                }
            }
        }
    },
    "cloud": {
        "account": {
            "id": "627286350134",
            "name": "elastic-observability"
        },
        "provider": "aws",
        "region": "us-east-1"
    },
    "data_stream": {
        "dataset": "aws.redshift",
        "namespace": "ep",
        "type": "metrics"
    },
    "ecs": {
        "version": "8.11.0"
    },
    "elastic_agent": {
        "id": "d745bccd-73a3-41b4-9fd0-4d9bac14f77b",
        "snapshot": false,
        "version": "8.2.0"
    },
    "event": {
        "agent_id_status": "verified",
        "dataset": "aws.redshift",
        "duration": 12571706173,
        "ingested": "2022-06-27T12:13:13Z",
        "module": "aws"
    },
    "host": {
        "architecture": "x86_64",
        "containerized": false,
        "hostname": "docker-fleet-agent",
        "ip": [
            "192.168.112.7"
        ],
        "mac": [
            "02-42-C0-A8-70-07"
        ],
        "name": "docker-fleet-agent",
        "os": {
            "codename": "focal",
            "family": "debian",
            "kernel": "5.10.104-linuxkit",
            "name": "Ubuntu",
            "platform": "ubuntu",
            "type": "linux",
            "version": "20.04.4 LTS (Focal Fossa)"
        }
    },
    "metricset": {
        "name": "cloudwatch",
        "period": 300000
    },
    "service": {
        "type": "aws"
    }
}
```

**ECS Field Reference**

Please refer to the following [document](https://www.elastic.co/guide/en/ecs/current/ecs-field-reference.html) for detailed information on ECS fields.

**Exported fields**

| Field | Description | Type | Metric Type |
|---|---|---|---|
| @timestamp | Event timestamp. | date |  |
| agent.id | Unique identifier of this agent (if one exists). Example: For Beats this would be beat.id. | keyword |  |
| aws.\*.metrics.\*.\* | Metrics that returned from Cloudwatch API query. | double |  |
| aws.cloudwatch.namespace | The namespace specified when query cloudwatch api. | keyword |  |
| aws.dimensions.ClusterIdentifier | This dimension filters the data that you request for a specific Cluster identifier | keyword |  |
| aws.dimensions.NodeID | This dimension filters the data that you request for a specific NodeID. | keyword |  |
| aws.dimensions.QueryPriority | This dimension filters the data that you request for a specific query priority. | keyword |  |
| aws.dimensions.QueueName | This dimension filters the data that you request for a specific WLM queue name. | keyword |  |
| aws.dimensions.latency | This dimension filters the data that you request for a specific latency (i.e short, medium or long). | keyword |  |
| aws.dimensions.service_class | This dimension filters the data that you request for a specific WLM service class | keyword |  |
| aws.dimensions.stage | This dimension filters the data that you request for a specific execution stage for a query. | keyword |  |
| aws.dimensions.wlmid | This dimension filters the data that you request for a specific WLM identifier. | keyword |  |
| aws.redshift.metrics.AutoVacuumSpaceFreed.avg | Storage space reclaimed by auto vacuum delete operations. | long | gauge |
| aws.redshift.metrics.CPUUtilization.avg | The percentage of CPU utilization. For clusters, this metric represents an aggregation of all nodes (leader and compute) CPU utilization values. | scaled_float | gauge |
| aws.redshift.metrics.CommitQueueLength.avg | The number of transactions waiting to commit at a given point in time. | long | gauge |
| aws.redshift.metrics.ConcurrencyScalingActiveClusters.avg | The number of concurrency scaling clusters that are actively processing queries at any given time. | integer | gauge |
| aws.redshift.metrics.ConcurrencyScalingSeconds.avg | The number of seconds used by concurrency scaling clusters that have active query processing activity. | long | gauge |
| aws.redshift.metrics.DatabaseConnections.avg | The number of database connections to a cluster. | long | gauge |
| aws.redshift.metrics.HealthStatus.avg | Indicates the health of the cluster. Any value below 1 implies that the cluster was unhealthy | scaled_float | gauge |
| aws.redshift.metrics.MaintenanceMode.avg | Indicates whether the cluster is in maintenance mode. Any value greater than 0 means that the cluster was in maintenance mode. | scaled_float | gauge |
| aws.redshift.metrics.MaxConfiguredConcurrencyScalingClusters.avg | Maximum number of concurrency scaling clusters configured from the parameter group. | integer | gauge |
| aws.redshift.metrics.NetworkReceiveThroughput.avg | The rate at which the node or cluster receives data. | long | gauge |
| aws.redshift.metrics.NetworkTransmitThroughput.avg | The rate at which the node or cluster writes data. | long | gauge |
| aws.redshift.metrics.NumExceededSchemaQuotas.avg | The number of schemas with exceeded quotas. | long | gauge |
| aws.redshift.metrics.PercentageDiskSpaceUsed.avg | The percent of disk space used. | scaled_float | gauge |
| aws.redshift.metrics.PercentageQuotaUsed.avg | The percentage of disk or storage space used relative to the configured schema quota. | long | gauge |
| aws.redshift.metrics.QueriesCompletedPerSecond.avg | The average number of queries completed per second. | long | gauge |
| aws.redshift.metrics.QueryDuration.avg | The average amount of time to complete a query. | long | gauge |
| aws.redshift.metrics.QueryRuntimeBreakdown.avg | The total time queries spent running by query stage. | long | gauge |
| aws.redshift.metrics.ReadIOPS.avg | The average number of disk read operations per second. | long | gauge |
| aws.redshift.metrics.ReadLatency.avg | The average amount of time taken for disk read I/O operations. | long | gauge |
| aws.redshift.metrics.ReadThroughput.avg | The average number of bytes read from disk per second. | long | gauge |
| aws.redshift.metrics.SchemaQuota.avg | The configured quota for a schema. | long | gauge |
| aws.redshift.metrics.StorageUsed.avg | The disk or storage space used by a schema. | long | gauge |
| aws.redshift.metrics.TotalTableCount.avg | The number of user tables open at a particular point in time. | long | gauge |
| aws.redshift.metrics.WLMQueriesCompletedPerSecond.avg | The average number of queries completed per second for a workload management (WLM) queue. | long | gauge |
| aws.redshift.metrics.WLMQueryDuration.avg | The average length of time to complete a query for a workload management (WLM) queue. | long | gauge |
| aws.redshift.metrics.WLMQueueLength.avg | The number of queries waiting to enter a workload management (WLM) queue. | long | gauge |
| aws.redshift.metrics.WLMQueueWaitTime.avg | The total time queries spent waiting in the workload management (WLM) queue. | long | gauge |
| aws.redshift.metrics.WLMRunningQueries.avg | The number of queries running from both the main cluster and concurrency scaling cluster per WLM queue. | long | gauge |
| aws.redshift.metrics.WriteIOPS.avg | The average number of write operations per second. | long | gauge |
| aws.redshift.metrics.WriteLatency.avg | The average amount of time taken for disk write I/O operations. | long | gauge |
| aws.redshift.metrics.WriteThroughput.avg | The average number of bytes written to disk per second. | long | gauge |
| aws.tags | Tag key value pairs from aws resources. | flattened |  |
| cloud.account.id | The cloud account or organization id used to identify different entities in a multi-tenant environment. Examples: AWS account id, Google Cloud ORG Id, or other unique identifier. | keyword |  |
| cloud.region | Region in which this host, resource, or service is located. | keyword |  |
| container | Container fields are used for meta information about the specific container that is the source of information. These fields help correlate data based containers from any runtime. | group |  |
| data_stream.dataset | Data stream dataset. | constant_keyword |  |
| data_stream.namespace | Data stream namespace. | constant_keyword |  |
| data_stream.type | Data stream type. | constant_keyword |  |
| event.module | Event module | constant_keyword |  |
| host | A host is defined as a general computing instance. ECS host.\* fields should be populated with details about the host on which the event happened, or from which the measurement was taken. Host types include hardware, virtual machines, Docker containers, and Kubernetes nodes. | group |  |
