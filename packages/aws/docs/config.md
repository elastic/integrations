# Config

[AWS Config](https://docs.aws.amazon.com/config/) provides a detailed view of the configuration of AWS resources in your AWS account. This includes how the resources are related to one another and how they were configured in the past so that you can see how the configurations and relationships change over time.

Use this integration to collect and parse data from your AWS Config APIs. Visualize that data in Kibana, create alerts to notify you if something goes wrong, and reference data when troubleshooting an issue.

**IMPORTANT: Extra AWS charges on API requests will be generated by this integration. Check [API Requests](https://www.elastic.co/docs/current/integrations/aws#api-requests) for more details.**

## Data streams

The AWS Config integration collects one type of data: logs.

**Logs** help you keep a record of the findings in AWS Config, allowing you to track and audit compliance status of your resources.

The AWS Config integration works by first retrieving all config rules using the [DescribeConfigRules](https://docs.aws.amazon.com/config/latest/APIReference/API_DescribeConfigRules.html) API. Then, for each specific config rule, the integration fetches its evaluation results using the [GetComplianceDetailsByConfigRule](https://docs.aws.amazon.com/config/latest/APIReference/API_GetComplianceDetailsByConfigRule.html) API. These evaluation results enrich their respective config rules, ultimately producing a finding log.

See more details in the [Logs reference](#logs-reference).

## Requirements

### Agentless Enabled Integration
Agentless integrations allow you to collect data without having to manage Elastic Agent in your cloud. They make manual agent deployment unnecessary, so you can focus on your data instead of the agent that collects it. For more information, refer to [Agentless integrations](https://www.elastic.co/guide/en/serverless/current/security-agentless-integrations.html) and the [Agentless integrations FAQ](https://www.elastic.co/guide/en/serverless/current/agentless-integration-troubleshooting.html).
Agentless deployments are only supported in Elastic Serverless and Elastic Cloud environments. This functionality is in beta and is subject to change. Beta features are not subject to the support SLA of official GA features.

### Agent Based Installation
- Elastic Agent must be installed
- You can install only one Elastic Agent per host.
- Elastic Agent is required to stream data from the REST API and ship the data to Elastic, where the events will then be processed via the integration's ingest pipelines.

Before using any AWS integration you will need:

* **AWS Credentials** to connect with your AWS account.
* **AWS Permissions** to make sure the user you're using to connect has permission to share the relevant data.

For more details about these requirements, please take a look at the [AWS integration documentation](https://docs.elastic.co/integrations/aws#requirements).

## Setup

Use this integration if you only need to collect data from the AWS Config service.

### To collect data from AWS Config APIs, users must have an Access Key and a Secret Key. To create API token follow below steps:

1. Login to https://console.aws.amazon.com/.
2. Go to https://console.aws.amazon.com/iam/ to access the IAM console.
3. On the navigation menu, choose Users.
4. Choose your IAM user name.
5. Select Create access key from the Security Credentials tab.
6. To see the new access key, choose Show.

### Enabling the integration in Elastic:

1. In Kibana navigate to Management > Integrations.
2. In "Search for integrations" top bar, search for `AWS Config`.
3. Select the "AWS Config" integration from the search results.
4. Select "Add AWS Config" to add the integration.
5. Add all the required integration configuration parameters, including the aws_region to enable data collection.
6. Select "Save and continue" to save the integration.

**Note**
1. For the current integration package, it is compulsory to add Secret Access Key and Access Key ID.
2. The AWS Config integration performs a full ingestion of all findings during each interval.

## Logs reference

### Config

This is the `config` dataset.

#### Example

An example event for `config` looks as following:

An example event for `config` looks as following:

```json
{
    "@timestamp": "2025-05-22T05:50:38.505Z",
    "agent": {
        "ephemeral_id": "0624c520-ec3a-4e52-90e4-188181f07c6c",
        "id": "9764cf02-72f4-48ac-af06-79c94b0e056b",
        "name": "elastic-agent-35398",
        "type": "filebeat",
        "version": "8.18.0"
    },
    "aws": {
        "config": {
            "compliance_type": "COMPLIANT",
            "config_rule_invoked_time": "2015-10-14T05:11:19.852Z",
            "evaluation_result_identifier": {
                "evaluation_result_qualifier": {
                    "config_rule_name": "access-keys-rotated",
                    "evaluation_mode": "DETECTIVE",
                    "resource_id": "i-0a4468fbfafeeg20h",
                    "resource_type": "AWS::EC2::Instance"
                },
                "ordering_timestamp": "2015-09-29T15:52:31.883Z"
            },
            "result_recorded_time": "2015-10-14T05:11:20.061Z",
            "rule_info": {
                "config_rule_arn": "arn:aws:config:us-east-1:11223344556:config-rule/config-rule-id1",
                "config_rule_id": "config-rule-id1",
                "config_rule_name": "access-keys-rotated",
                "config_rule_state": "ACTIVE",
                "description": "Checks whether the active access keys are rotated within the number of days specified in maxAccessKeyAge. The rule is non-compliant if the access keys have not been rotated for more than maxAccessKeyAge number of days.",
                "evaluation_modes": [
                    {
                        "mode": "DETECTIVE"
                    }
                ],
                "input_parameters": {
                    "maxAccessKeyAge": "90"
                },
                "maximum_execution_frequency": "TwentyFour_Hours",
                "source": {
                    "owner": "AWS",
                    "source_identifier": "ACCESS_KEYS_ROTATED"
                }
            }
        }
    },
    "cloud": {
        "account": {
            "id": "11223344556",
            "name": "11223344556"
        },
        "provider": "aws"
    },
    "data_stream": {
        "dataset": "aws.config",
        "namespace": "64685",
        "type": "logs"
    },
    "ecs": {
        "version": "8.17.0"
    },
    "elastic_agent": {
        "id": "9764cf02-72f4-48ac-af06-79c94b0e056b",
        "snapshot": false,
        "version": "8.18.0"
    },
    "event": {
        "agent_id_status": "verified",
        "category": [
            "configuration"
        ],
        "created": "2015-09-29T15:52:31.883Z",
        "dataset": "aws.config",
        "ingested": "2025-05-22T05:50:41Z",
        "kind": "event",
        "original": "{\"ComplianceType\":\"COMPLIANT\",\"ConfigRuleInfo\":{\"ConfigRuleArn\":\"arn:aws:config:us-east-1:11223344556:config-rule/config-rule-id1\",\"ConfigRuleId\":\"config-rule-id1\",\"ConfigRuleName\":\"access-keys-rotated\",\"ConfigRuleState\":\"ACTIVE\",\"Description\":\"Checks whether the active access keys are rotated within the number of days specified in maxAccessKeyAge. The rule is non-compliant if the access keys have not been rotated for more than maxAccessKeyAge number of days.\",\"EvaluationModes\":[{\"Mode\":\"DETECTIVE\"}],\"InputParameters\":\"{\\\"maxAccessKeyAge\\\":\\\"90\\\"}\",\"MaximumExecutionFrequency\":\"TwentyFour_Hours\",\"Source\":{\"Owner\":\"AWS\",\"SourceIdentifier\":\"ACCESS_KEYS_ROTATED\"}},\"ConfigRuleInvokedTime\":1444799479.852,\"EvaluationResultIdentifier\":{\"EvaluationResultQualifier\":{\"ConfigRuleName\":\"access-keys-rotated\",\"EvaluationMode\":\"DETECTIVE\",\"ResourceId\":\"i-0a4468fbfafeeg20h\",\"ResourceType\":\"AWS::EC2::Instance\"},\"OrderingTimestamp\":1443541951.883},\"ResultRecordedTime\":1444799480.061}",
        "outcome": "success",
        "type": [
            "info"
        ]
    },
    "input": {
        "type": "cel"
    },
    "message": "Checks whether the active access keys are rotated within the number of days specified in maxAccessKeyAge. The rule is non-compliant if the access keys have not been rotated for more than maxAccessKeyAge number of days.",
    "observer": {
        "vendor": "AWS Config"
    },
    "resource": {
        "id": "i-0a4468fbfafeeg20h",
        "type": "AWS::EC2::Instance"
    },
    "result": {
        "evaluation": "passed"
    },
    "rule": {
        "description": "Checks whether the active access keys are rotated within the number of days specified in maxAccessKeyAge. The rule is non-compliant if the access keys have not been rotated for more than maxAccessKeyAge number of days.",
        "id": "config-rule-id1",
        "name": "access-keys-rotated",
        "reference": "arn:aws:config:us-east-1:11223344556:config-rule/config-rule-id1"
    },
    "tags": [
        "preserve_original_event",
        "preserve_duplicate_custom_fields",
        "forwarded",
        "aws-config"
    ]
}
```

**ECS Field Reference**

Please refer to the following [document](https://www.elastic.co/guide/en/ecs/current/ecs-field-reference.html) for detailed information on ECS fields.

#### Exported fields

**Exported fields**

| Field | Description | Type |
|---|---|---|
| @timestamp | Event timestamp. | date |
| aws.config.annotation | Supplementary information about how the evaluation determined the compliance. | keyword |
| aws.config.compliance_type | Indicates whether the AWS resource complies with the AWS Config rule that evaluated it. | keyword |
| aws.config.config_rule_invoked_time | The time when the AWS Config rule evaluated the AWS resource. | date |
| aws.config.evaluation_result_identifier.evaluation_result_qualifier.config_rule_name | The name of the AWS Config rule that was used in the evaluation. | keyword |
| aws.config.evaluation_result_identifier.evaluation_result_qualifier.evaluation_mode | The mode of an evaluation. The valid values are Detective or Proactive. | keyword |
| aws.config.evaluation_result_identifier.evaluation_result_qualifier.resource_id | The ID of the evaluated AWS resource. | keyword |
| aws.config.evaluation_result_identifier.evaluation_result_qualifier.resource_type | The type of AWS resource that was evaluated. | keyword |
| aws.config.evaluation_result_identifier.ordering_timestamp | The time of the event that triggered the evaluation of your AWS resources. | date |
| aws.config.evaluation_result_identifier.resource_evaluation_id | A Unique ID for an evaluation result. | keyword |
| aws.config.result_recorded_time | The time when AWS Config recorded the evaluation result. | date |
| aws.config.result_token | An encrypted token that associates an evaluation with an AWS Config rule. | keyword |
| aws.config.rule_info.config_rule_arn | The Amazon Resource Name (ARN) of the AWS Config rule. | keyword |
| aws.config.rule_info.config_rule_id | The ID of the AWS Config rule. | keyword |
| aws.config.rule_info.config_rule_name | The name that you assign to the AWS Config rule. The name is required if you are adding a new rule. | keyword |
| aws.config.rule_info.config_rule_state | Indicates whether the AWS Config rule is active or is currently being deleted by AWS Config. | keyword |
| aws.config.rule_info.created_by | Service principal name of the service that created the rule. | keyword |
| aws.config.rule_info.description | The description that you provide for the AWS Config rule. | keyword |
| aws.config.rule_info.evaluation_modes.mode | The mode of an evaluation. | keyword |
| aws.config.rule_info.input_parameters | A string, in JSON format, that is passed to the AWS Config rule Lambda function. | flattened |
| aws.config.rule_info.maximum_execution_frequency | The maximum frequency with which AWS Config runs evaluations for a rule. | keyword |
| aws.config.rule_info.scope.compliance_resource_id | The ID of the only AWS resource that you want to trigger an evaluation for the rule. | keyword |
| aws.config.rule_info.scope.compliance_resource_types | The resource types of only those AWS resources that you want to trigger an evaluation for the rule. | keyword |
| aws.config.rule_info.scope.tag_key | The tag key that is applied to only those AWS resources that you want to trigger an evaluation for the rule. | keyword |
| aws.config.rule_info.scope.tag_value | The tag value applied to only those AWS resources that you want to trigger an evaluation for the rule. | keyword |
| aws.config.rule_info.source.custom_policy_details.enable_debug_log_delivery | The boolean expression for enabling debug logging for your AWS Config Custom Policy rule. | boolean |
| aws.config.rule_info.source.custom_policy_details.policy_runtime | The runtime system for your AWS Config Custom Policy rule. | keyword |
| aws.config.rule_info.source.custom_policy_details.policy_text | The policy definition containing the logic for your AWS Config Custom Policy rule. | keyword |
| aws.config.rule_info.source.owner | Indicates whether AWS or the customer owns and manages the AWS Config rule. | keyword |
| aws.config.rule_info.source.source_details.event_source | The source of the event, such as an AWS service, that triggers AWS Config to evaluate your AWS resources. | keyword |
| aws.config.rule_info.source.source_details.maximum_execution_frequency | The frequency at which you want AWS Config to run evaluations for a custom rule with a periodic trigger. | keyword |
| aws.config.rule_info.source.source_details.message_type | The type of notification that triggers AWS Config to run an evaluation for a rule. | keyword |
| aws.config.rule_info.source.source_identifier | For AWS Config Managed rules, a predefined identifier from a list. | keyword |
| cloud.provider | Name of the cloud provider. Example values are aws, azure, gcp, or digitalocean. | constant_keyword |
| data_stream.dataset | Data stream dataset. | constant_keyword |
| data_stream.namespace | Data stream namespace. | constant_keyword |
| data_stream.type | Data stream type. | constant_keyword |
| event.dataset | Event dataset. | constant_keyword |
| event.module | Event module. | constant_keyword |
| input.type | Type of Filebeat input. | keyword |
| log.offset | Log offset. | long |
| observer.vendor | Vendor name of the observer. | constant_keyword |
| resource.id |  | keyword |
| resource.type |  | keyword |
| result.evaluation |  | keyword |
| rule.tags |  | keyword |

