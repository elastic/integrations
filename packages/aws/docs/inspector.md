# Inspector

The [Amazon Inspector](https://docs.aws.amazon.com/inspector/) integration collects and parses data from Amazon Inspector [Findings](https://docs.aws.amazon.com/inspector/v2/APIReference/API_ListFindings.html) REST APIs.

**IMPORTANT: Extra AWS charges on API requests will be generated by this integration. Check [API Requests](https://www.elastic.co/docs/current/integrations/aws#api-requests) for more details.**

## Compatibility
This module is tested against `Amazon Inspector API version 2.0`.

## Agentless-enabled integration

Agentless integrations allow you to collect data without having to manage Elastic Agent in your cloud. They make manual agent deployment unnecessary, so you can focus on your data instead of the agent that collects it. For more information, refer to [Agentless integrations](https://www.elastic.co/guide/en/serverless/current/security-agentless-integrations.html) and the [Agentless integrations FAQ](https://www.elastic.co/guide/en/serverless/current/agentless-integration-troubleshooting.html).

Agentless deployments are only supported in Elastic Serverless and Elastic Cloud environments. This functionality is in beta and is subject to change. Beta features are not subject to the support SLA of official GA features.

## To collect data from Amazon Inspector API, users must have an Access Key and a Secret Key. To create API token follow below steps:

  1. Login to https://console.aws.amazon.com/.
  2. Go to https://console.aws.amazon.com/iam/ to access the IAM console.
  3. On the navigation menu, choose Users.
  4. Choose your IAM user name.
  5. Select Create access key from the Security Credentials tab.
  6. To see the new access key, choose Show.

## Note

  - For the current integration package, it is compulsory to add Secret Access Key and Access Key ID.
  - This data stream doesn't support setting a Role ARN.
  - Ensure your IAM has the `inspector2:ListFindings` permission granted. Without this permission, API requests will be denied.

## Troubleshooting

### Breaking Changes

#### Support for Elastic Vulnerability Findings page.

Version `4.0.0` of the AWS integration adds support for [Elastic Cloud Security workflow](https://www.elastic.co/docs/solutions/security/cloud/ingest-third-party-cloud-security-data#_ingest_third_party_security_posture_and_vulnerability_data). The enhancement enables the users of the AWS Inspector integration to ingest their enriched vulnerabilities from the Amazon Inspector platform into Elastic and get insights directly from the Elastic [Vulnerability Findings page](https://www.elastic.co/docs/solutions/security/cloud/findings-page-3).
This update adds [Elastic Latest Transform](https://www.elastic.co/docs/explore-analyze/transforms/transform-overview#latest-transform-overview) which copies the latest vulnerability findings from source indices matching the pattern `logs-aws.inspector-*` into new destination indices matching the pattern `security_solution-aws.vulnerability_latest-*`. The Elastic Vulnerability Findings page will display vulnerabilities based on the destination indices.

For existing users of the AWS integration, before upgrading to `4.0.0` please ensure the following requirements are met:

1. Users need [Elastic Security solution](https://www.elastic.co/docs/solutions/security) which has requirements documented [here](https://www.elastic.co/docs/solutions/security/get-started/elastic-security-requirements).
2. To use transforms, users must have:
   - at least one [transform node](https://www.elastic.co/docs/deploy-manage/distributed-architecture/clusters-nodes-shards/node-roles#transform-node-role),
   - management features visible in the Kibana space, and
   - security privileges that:
     - grant use of transforms, and
     - grant access to source and destination indices
   For more details on Transform Setup, refer to the link [here](https://www.elastic.co/docs/explore-analyze/transforms/transform-setup)
3. Because the latest copy of vulnerabilities is now indexed in two places, that is, in both source and destination indices, users must anticipate storage requirements accordingly.

## Logs

### Inspector

This is the [`Inspector`](https://docs.aws.amazon.com/inspector/v2/APIReference/API_ListFindings.html#inspector2-ListFindings-response-findings) data stream.

An example event for `inspector` looks as following:

```json
{
    "@timestamp": "2025-06-05T23:23:16.162Z",
    "agent": {
        "ephemeral_id": "788993b6-dba1-4abf-a351-971772a30ab3",
        "id": "f39725b1-2457-4583-bd15-dc0a928f195e",
        "name": "elastic-agent-65036",
        "type": "filebeat",
        "version": "8.19.0"
    },
    "aws": {
        "inspector": {
            "epss": {
                "score": 0.00024
            },
            "exploit_available": "NO",
            "finding_arn": "arn:aws:inspector2:us-east-2:123456789012:finding/fb6294abcdef0123456789abcdef8123",
            "first_observed_at": "2025-05-29T17:28:07.919Z",
            "fix_available": "YES",
            "inspector_score": 6.5,
            "inspector_score_details": {
                "adjusted_cvss": {
                    "cvss_source": "NVD",
                    "score": {
                        "source": "NVD"
                    },
                    "scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:L"
                }
            },
            "last_observed_at": "2025-06-05T23:23:16.162Z",
            "package_nested": [
                {
                    "epoch": 0,
                    "file_path": "vol-0e47545061282cd35:/p1:opt/cni/bin/aws-cni",
                    "fixed_in_version": "0.38.0",
                    "name": "golang.org/x/net",
                    "package_manager": "GOBINARY",
                    "version": "v0.1.0"
                },
                {
                    "epoch": 0,
                    "file_path": "vol-0e47545061282cd35:/p1:etc/eks/image-credential-provider/ecr-credential-provider",
                    "fixed_in_version": "0.38.0",
                    "name": "golang.org/x/net",
                    "package_manager": "GOBINARY",
                    "version": "v0.30.0"
                },
                {
                    "epoch": 0,
                    "file_path": "vol-0e47545061282cd35:/p1:opt/cni/bin/dhcp",
                    "fixed_in_version": "0.38.0",
                    "name": "golang.org/x/net",
                    "package_manager": "GOBINARY",
                    "version": "v0.30.0"
                },
                {
                    "epoch": 0,
                    "file_path": "vol-0e47545061282cd35:/p1:usr/bin/aws-iam-authenticator",
                    "fixed_in_version": "0.38.0",
                    "name": "golang.org/x/net",
                    "package_manager": "GOBINARY",
                    "version": "v0.30.0"
                },
                {
                    "epoch": 0,
                    "file_path": "vol-0e47545061282cd35:/p1:usr/bin/kubelet",
                    "fixed_in_version": "0.38.0",
                    "name": "golang.org/x/net",
                    "package_manager": "GOBINARY",
                    "version": "v0.30.0"
                },
                {
                    "arch": "X86_64",
                    "epoch": 0,
                    "fixed_in_version": "0:2.0.5-1.amzn2.0.1",
                    "name": "nerdctl",
                    "package_manager": "OS",
                    "release": "1.amzn2.0.1",
                    "remediation": "yum update nerdctl",
                    "version": "2.0.4"
                }
            ],
            "package_vulnerability_details": {
                "cvss": [
                    {
                        "base_score": 6.5,
                        "scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:L",
                        "source": "NVD",
                        "version": "3.1"
                    },
                    {
                        "base_score": 6.5,
                        "scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:L",
                        "source": "NVD",
                        "version": "3.1"
                    }
                ],
                "source": {
                    "url": {
                        "domain": "nvd.nist.gov",
                        "original": "https://nvd.nist.gov/vuln/detail/CVE-2025-22872",
                        "path": "/vuln/detail/CVE-2025-22872",
                        "scheme": "https"
                    },
                    "value": "NVD"
                },
                "vendor": {
                    "severity": "MEDIUM",
                    "updated_at": "2025-05-16T23:15:19.000Z"
                },
                "vulnerable_packages": [
                    {
                        "epoch": 0,
                        "file_path": "vol-0e47545061282cd35:/p1:opt/cni/bin/aws-cni",
                        "fixed_in_version": "0.38.0",
                        "name": "golang.org/x/net",
                        "package_manager": "GOBINARY",
                        "version": "v0.1.0"
                    },
                    {
                        "epoch": 0,
                        "file_path": "vol-0e47545061282cd35:/p1:etc/eks/image-credential-provider/ecr-credential-provider",
                        "fixed_in_version": "0.38.0",
                        "name": "golang.org/x/net",
                        "package_manager": "GOBINARY",
                        "version": "v0.30.0"
                    },
                    {
                        "epoch": 0,
                        "file_path": "vol-0e47545061282cd35:/p1:opt/cni/bin/dhcp",
                        "fixed_in_version": "0.38.0",
                        "name": "golang.org/x/net",
                        "package_manager": "GOBINARY",
                        "version": "v0.30.0"
                    },
                    {
                        "epoch": 0,
                        "file_path": "vol-0e47545061282cd35:/p1:usr/bin/aws-iam-authenticator",
                        "fixed_in_version": "0.38.0",
                        "name": "golang.org/x/net",
                        "package_manager": "GOBINARY",
                        "version": "v0.30.0"
                    },
                    {
                        "epoch": 0,
                        "file_path": "vol-0e47545061282cd35:/p1:usr/bin/kubelet",
                        "fixed_in_version": "0.38.0",
                        "name": "golang.org/x/net",
                        "package_manager": "GOBINARY",
                        "version": "v0.30.0"
                    },
                    {
                        "arch": "X86_64",
                        "epoch": 0,
                        "fixed_in_version": "0:2.0.5-1.amzn2.0.1",
                        "name": "nerdctl",
                        "package_manager": "OS",
                        "release": "1.amzn2.0.1",
                        "remediation": "yum update nerdctl",
                        "version": "2.0.4"
                    }
                ]
            },
            "remediation": {
                "recommendation": {
                    "text": "None Provided"
                }
            },
            "resources": [
                {
                    "details": {
                        "aws": {
                            "ec2_instance": {
                                "iam_instance_profile_arn": "arn:aws:iam::123456789012:instance-profile/eks-0012345a-1234-5678-1234-6c1abcdef012",
                                "image_id": "ami-0e0f0123456789abd",
                                "ipv4_addresses": [
                                    "10.90.1.245",
                                    "10.90.1.45",
                                    "10.90.1.168",
                                    "10.90.1.157",
                                    "1.128.0.1",
                                    "10.90.1.103",
                                    "10.90.1.197",
                                    "10.90.1.220",
                                    "10.90.1.86",
                                    "10.90.1.29",
                                    "10.90.1.18",
                                    "10.90.1.181",
                                    "10.90.1.161",
                                    "10.90.1.229",
                                    "10.90.1.108",
                                    "10.90.1.219",
                                    "10.90.1.9",
                                    "10.90.1.106",
                                    "10.90.1.206"
                                ],
                                "launched_at": "2025-05-29T16:06:08.000Z",
                                "platform": "AMAZON_LINUX_2",
                                "subnet_id": "subnet-0ababcdefabcdef8b",
                                "type": "t3.medium",
                                "vpc_id": "vpc-04ab0123456789123"
                            }
                        }
                    },
                    "id": "i-0fabcdefabcdef50b",
                    "partition": "aws",
                    "region": "us-east-2",
                    "tags": {
                        "aws:autoscaling:groupName": "eks-sei_demo_prod_linux-00c12345-abcd-1234-5678-601234567896",
                        "aws:ec2launchtemplate:version": "6",
                        "aws:eks:cluster-name": "sei_demo_prod",
                        "eks:cluster-name": "sei_demo_prod",
                        "eks:nodegroup-name": "sei_demo_prod_linux",
                        "k8s.io/cluster-autoscaler/enabled": "true",
                        "k8s.io/cluster-autoscaler/sei_demo_prod": "owned",
                        "kubernetes.io/cluster/sei_demo_prod": "owned"
                    },
                    "type": "AWS_EC2_INSTANCE"
                }
            ],
            "severity": "MEDIUM",
            "status": "ACTIVE",
            "transform_unique_id": "CVE-2025-22872|i-0fabcdefabcdef50b|{0=golang.org/x/net, 1=nerdctl}|{0=v0.1.0, 1=v0.30.0, 2=2.0.4}",
            "type": "PACKAGE_VULNERABILITY"
        }
    },
    "cloud": {
        "account": {
            "id": "123456789012"
        },
        "instance": {
            "id": "i-0fabcdefabcdef50b"
        },
        "machine": {
            "type": "t3.medium"
        },
        "provider": "aws",
        "region": "us-east-2"
    },
    "data_stream": {
        "dataset": "aws.inspector",
        "namespace": "64174",
        "type": "logs"
    },
    "ecs": {
        "version": "8.11.0"
    },
    "elastic_agent": {
        "id": "f39725b1-2457-4583-bd15-dc0a928f195e",
        "snapshot": true,
        "version": "8.19.0"
    },
    "event": {
        "agent_id_status": "verified",
        "category": [
            "vulnerability"
        ],
        "created": "2025-07-15T04:04:32.124Z",
        "dataset": "aws.inspector",
        "id": "CVE-2025-22872|i-0fabcdefabcdef50b|{0=golang.org/x/net, 1=nerdctl}|{0=v0.1.0, 1=v0.30.0, 2=2.0.4}|2025-06-05T23:23:16.162Z",
        "ingested": "2025-07-15T04:04:35Z",
        "kind": "event",
        "original": "{\"awsAccountId\":\"123456789012\",\"description\":\"The tokenizer incorrectly interprets tags with unquoted attribute values that end with a solidus character (/) as self-closing. When directly using Tokenizer, this can result in such tags incorrectly being marked as self-closing, and when using the Parse functions, this can result in content following such tags as being placed in the wrong scope during DOM construction, but only when tags are in foreign content (e.g. \\u003cmath\\u003e, \\u003csvg\\u003e, etc contexts).\",\"epss\":{\"score\":0.00024},\"exploitAvailable\":\"NO\",\"findingArn\":\"arn:aws:inspector2:us-east-2:123456789012:finding/fb6294abcdef0123456789abcdef8123\",\"firstObservedAt\":1748539687.919,\"fixAvailable\":\"YES\",\"inspectorScore\":6.5,\"inspectorScoreDetails\":{\"adjustedCvss\":{\"adjustments\":[],\"cvssSource\":\"NVD\",\"score\":6.5,\"scoreSource\":\"NVD\",\"scoringVector\":\"CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:L\",\"version\":\"3.1\"}},\"lastObservedAt\":1749165796.162,\"packageVulnerabilityDetails\":{\"cvss\":[{\"baseScore\":6.5,\"scoringVector\":\"CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:L\",\"source\":\"NVD\",\"version\":\"3.1\"},{\"baseScore\":6.5,\"scoringVector\":\"CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:L\",\"source\":\"NVD\",\"version\":\"3.1\"}],\"referenceUrls\":[\"https://groups.google.com/g/golang-announce/c/ezSKR9vqbqA\",\"https://nvd.nist.gov/vuln/detail/CVE-2025-22872\",\"https://alas.aws.amazon.com/AL2023/ALAS-2025-981.html\",\"https://alas.aws.amazon.com/AL2/ALASDOCKER-2025-064.html\",\"https://alas.aws.amazon.com/AL2023/ALAS-2025-980.html\",\"https://alas.aws.amazon.com/AL2/ALASDOCKER-2025-063.html\",\"https://alas.aws.amazon.com/AL2023/ALAS-2025-979.html\",\"https://alas.aws.amazon.com/cve/json/v1/CVE-2025-22872.json\",\"https://alas.aws.amazon.com/AL2/ALAS-2025-2863.html\",\"https://alas.aws.amazon.com/cve/json/v1/CVE-2025-22872.json\"],\"relatedVulnerabilities\":[],\"source\":\"NVD\",\"sourceUrl\":\"https://nvd.nist.gov/vuln/detail/CVE-2025-22872\",\"vendorCreatedAt\":1744827364,\"vendorSeverity\":\"MEDIUM\",\"vendorUpdatedAt\":1747437319,\"vulnerabilityId\":\"CVE-2025-22872\",\"vulnerablePackages\":[{\"epoch\":0,\"filePath\":\"vol-0e47545061282cd35:/p1:opt/cni/bin/aws-cni\",\"fixedInVersion\":\"0.38.0\",\"name\":\"golang.org/x/net\",\"packageManager\":\"GOBINARY\",\"version\":\"v0.1.0\"},{\"epoch\":0,\"filePath\":\"vol-0e47545061282cd35:/p1:etc/eks/image-credential-provider/ecr-credential-provider\",\"fixedInVersion\":\"0.38.0\",\"name\":\"golang.org/x/net\",\"packageManager\":\"GOBINARY\",\"version\":\"v0.30.0\"},{\"epoch\":0,\"filePath\":\"vol-0e47545061282cd35:/p1:opt/cni/bin/dhcp\",\"fixedInVersion\":\"0.38.0\",\"name\":\"golang.org/x/net\",\"packageManager\":\"GOBINARY\",\"version\":\"v0.30.0\"},{\"epoch\":0,\"filePath\":\"vol-0e47545061282cd35:/p1:usr/bin/aws-iam-authenticator\",\"fixedInVersion\":\"0.38.0\",\"name\":\"golang.org/x/net\",\"packageManager\":\"GOBINARY\",\"version\":\"v0.30.0\"},{\"epoch\":0,\"filePath\":\"vol-0e47545061282cd35:/p1:usr/bin/kubelet\",\"fixedInVersion\":\"0.38.0\",\"name\":\"golang.org/x/net\",\"packageManager\":\"GOBINARY\",\"version\":\"v0.30.0\"},{\"arch\":\"X86_64\",\"epoch\":0,\"fixedInVersion\":\"0:2.0.5-1.amzn2.0.1\",\"name\":\"nerdctl\",\"packageManager\":\"OS\",\"release\":\"1.amzn2.0.1\",\"remediation\":\"yum update nerdctl\",\"version\":\"2.0.4\"}]},\"remediation\":{\"recommendation\":{\"text\":\"None Provided\"}},\"resources\":[{\"details\":{\"awsEc2Instance\":{\"iamInstanceProfileArn\":\"arn:aws:iam::123456789012:instance-profile/eks-0012345a-1234-5678-1234-6c1abcdef012\",\"imageId\":\"ami-0e0f0123456789abd\",\"ipV4Addresses\":[\"10.90.1.245\",\"10.90.1.45\",\"10.90.1.168\",\"10.90.1.157\",\"1.128.0.1\",\"10.90.1.103\",\"10.90.1.197\",\"10.90.1.220\",\"10.90.1.86\",\"10.90.1.29\",\"10.90.1.18\",\"10.90.1.181\",\"10.90.1.161\",\"10.90.1.229\",\"10.90.1.108\",\"10.90.1.219\",\"10.90.1.9\",\"10.90.1.106\",\"10.90.1.206\"],\"ipV6Addresses\":[],\"launchedAt\":1748534768,\"platform\":\"AMAZON_LINUX_2\",\"subnetId\":\"subnet-0ababcdefabcdef8b\",\"type\":\"t3.medium\",\"vpcId\":\"vpc-04ab0123456789123\"}},\"id\":\"i-0fabcdefabcdef50b\",\"partition\":\"aws\",\"region\":\"us-east-2\",\"tags\":{\"aws:autoscaling:groupName\":\"eks-sei_demo_prod_linux-00c12345-abcd-1234-5678-601234567896\",\"aws:ec2launchtemplate:version\":\"6\",\"aws:eks:cluster-name\":\"sei_demo_prod\",\"eks:cluster-name\":\"sei_demo_prod\",\"eks:nodegroup-name\":\"sei_demo_prod_linux\",\"k8s.io/cluster-autoscaler/enabled\":\"true\",\"k8s.io/cluster-autoscaler/sei_demo_prod\":\"owned\",\"kubernetes.io/cluster/sei_demo_prod\":\"owned\"},\"type\":\"AWS_EC2_INSTANCE\"}],\"severity\":\"MEDIUM\",\"status\":\"ACTIVE\",\"title\":\"CVE-2025-22872 - golang.org/x/net, golang.org/x/net and 4 more\",\"type\":\"PACKAGE_VULNERABILITY\",\"updatedAt\":1749165796.162}",
        "type": [
            "info"
        ]
    },
    "host": {
        "id": "i-0fabcdefabcdef50b",
        "ip": [
            "10.90.1.245",
            "10.90.1.45",
            "10.90.1.168",
            "10.90.1.157",
            "1.128.0.1",
            "10.90.1.103",
            "10.90.1.197",
            "10.90.1.220",
            "10.90.1.86",
            "10.90.1.29",
            "10.90.1.18",
            "10.90.1.181",
            "10.90.1.161",
            "10.90.1.229",
            "10.90.1.108",
            "10.90.1.219",
            "10.90.1.9",
            "10.90.1.106",
            "10.90.1.206"
        ],
        "os": {
            "platform": "AMAZON_LINUX_2",
            "type": "linux"
        },
        "type": "t3.medium"
    },
    "input": {
        "type": "httpjson"
    },
    "message": "The tokenizer incorrectly interprets tags with unquoted attribute values that end with a solidus character (/) as self-closing. When directly using Tokenizer, this can result in such tags incorrectly being marked as self-closing, and when using the Parse functions, this can result in content following such tags as being placed in the wrong scope during DOM construction, but only when tags are in foreign content (e.g. <math>, <svg>, etc contexts).",
    "observer": {
        "vendor": "Amazon Inspector"
    },
    "package": {
        "architecture": [
            "X86_64"
        ],
        "fixed_version": [
            "0.38.0",
            "0:2.0.5-1.amzn2.0.1"
        ],
        "name": [
            "golang.org/x/net",
            "nerdctl"
        ],
        "path": [
            "vol-0e47545061282cd35:/p1:opt/cni/bin/aws-cni",
            "vol-0e47545061282cd35:/p1:etc/eks/image-credential-provider/ecr-credential-provider",
            "vol-0e47545061282cd35:/p1:opt/cni/bin/dhcp",
            "vol-0e47545061282cd35:/p1:usr/bin/aws-iam-authenticator",
            "vol-0e47545061282cd35:/p1:usr/bin/kubelet"
        ],
        "version": [
            "v0.1.0",
            "v0.30.0",
            "2.0.4"
        ]
    },
    "related": {
        "ip": [
            "10.90.1.245",
            "10.90.1.45",
            "10.90.1.168",
            "10.90.1.157",
            "1.128.0.1",
            "10.90.1.103",
            "10.90.1.197",
            "10.90.1.220",
            "10.90.1.86",
            "10.90.1.29",
            "10.90.1.18",
            "10.90.1.181",
            "10.90.1.161",
            "10.90.1.229",
            "10.90.1.108",
            "10.90.1.219",
            "10.90.1.9",
            "10.90.1.106",
            "10.90.1.206"
        ]
    },
    "resource": {
        "id": "i-0fabcdefabcdef50b",
        "type": "AWS_EC2_INSTANCE"
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "aws-inspector"
    ],
    "vulnerability": {
        "description": "The tokenizer incorrectly interprets tags with unquoted attribute values that end with a solidus character (/) as self-closing. When directly using Tokenizer, this can result in such tags incorrectly being marked as self-closing, and when using the Parse functions, this can result in content following such tags as being placed in the wrong scope during DOM construction, but only when tags are in foreign content (e.g. <math>, <svg>, etc contexts).",
        "id": "CVE-2025-22872",
        "published_date": "2025-04-16T18:16:04.000Z",
        "reference": [
            "https://groups.google.com/g/golang-announce/c/ezSKR9vqbqA",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-22872",
            "https://alas.aws.amazon.com/AL2023/ALAS-2025-981.html",
            "https://alas.aws.amazon.com/AL2/ALASDOCKER-2025-064.html",
            "https://alas.aws.amazon.com/AL2023/ALAS-2025-980.html",
            "https://alas.aws.amazon.com/AL2/ALASDOCKER-2025-063.html",
            "https://alas.aws.amazon.com/AL2023/ALAS-2025-979.html",
            "https://alas.aws.amazon.com/cve/json/v1/CVE-2025-22872.json",
            "https://alas.aws.amazon.com/AL2/ALAS-2025-2863.html",
            "https://alas.aws.amazon.com/cve/json/v1/CVE-2025-22872.json"
        ],
        "scanner": {
            "vendor": "Amazon Inspector"
        },
        "score": {
            "base": 6.5,
            "version": "3.1"
        },
        "severity": "Medium",
        "title": "CVE-2025-22872 - golang.org/x/net, golang.org/x/net and 4 more"
    }
}
```

**ECS Field Reference**

Please refer to the following [document](https://www.elastic.co/guide/en/ecs/current/ecs-field-reference.html) for detailed information on ECS fields.

**Exported fields**

| Field | Description | Type |
|---|---|---|
| @timestamp | Date/time when the event originated. This is the date/time extracted from the event, typically representing when the event was generated by the source. If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline. Required field for all events. | date |
| aws.inspector.aws_account_id | The AWS account ID associated with the finding. | keyword |
| aws.inspector.code_vulnerability_details.cwes | The Common Weakness Enumeration (CWE) item associated with the detected vulnerability. | keyword |
| aws.inspector.code_vulnerability_details.detector_id | The ID for the Amazon CodeGuru detector associated with the finding. For more information on detectors see Amazon CodeGuru Detector Library. | keyword |
| aws.inspector.code_vulnerability_details.detector_name | The name of the detector used to identify the code vulnerability. For more information on detectors see CodeGuru Detector Library. | keyword |
| aws.inspector.code_vulnerability_details.detector_tags | The detector tag associated with the vulnerability. Detector tags group related vulnerabilities by common themes or tactics. For a list of available tags by programming language, see Java tags, or Python tags. | keyword |
| aws.inspector.code_vulnerability_details.file_path.end_line | The line number of the last line of code that a vulnerability was found in. | long |
| aws.inspector.code_vulnerability_details.file_path.name | The name of the file the code vulnerability was found in. | keyword |
| aws.inspector.code_vulnerability_details.file_path.path | The file path to the code that a vulnerability was found in. | keyword |
| aws.inspector.code_vulnerability_details.file_path.start_line | The line number of the first line of code that a vulnerability was found in. | long |
| aws.inspector.code_vulnerability_details.reference_urls | A URL containing supporting documentation about the code vulnerability detected. | keyword |
| aws.inspector.code_vulnerability_details.rule_id | The identifier for a rule that was used to detect the code vulnerability. | keyword |
| aws.inspector.code_vulnerability_details.source_lambda_layer_arn | The Amazon Resource Name (ARN) of the Lambda layer that the code vulnerability was detected in. | keyword |
| aws.inspector.description | The description of the finding. | text |
| aws.inspector.epss.score | The EPSS score. | double |
| aws.inspector.exploit_available | If a finding discovered in your environment has an exploit available. | keyword |
| aws.inspector.exploitability_details.last_known_exploit_at | The date and time of the last exploit associated with a finding discovered in your environment. | date |
| aws.inspector.finding_arn | The Amazon Resource Number (ARN) of the finding. | keyword |
| aws.inspector.first_observed_at | The date and time that the finding was first observed. | date |
| aws.inspector.fix_available | Details on whether a fix is available through a version update. This value can be YES, NO, or PARTIAL. A PARTIAL fix means that some, but not all, of the packages identified in the finding have fixes available through updated versions. | keyword |
| aws.inspector.inspector_score | The Amazon Inspector score given to the finding. | double |
| aws.inspector.inspector_score_details.adjusted_cvss.adjustments.metric | The metric used to adjust the CVSS score. | keyword |
| aws.inspector.inspector_score_details.adjusted_cvss.adjustments.reason | The reason the CVSS score has been adjustment. | keyword |
| aws.inspector.inspector_score_details.adjusted_cvss.cvss_source | The source of the CVSS data. | keyword |
| aws.inspector.inspector_score_details.adjusted_cvss.score.source | The source for the CVSS score. | keyword |
| aws.inspector.inspector_score_details.adjusted_cvss.score.value | The CVSS score. | double |
| aws.inspector.inspector_score_details.adjusted_cvss.scoring_vector | The vector for the CVSS score. | keyword |
| aws.inspector.inspector_score_details.adjusted_cvss.version | The CVSS version used in scoring. | keyword |
| aws.inspector.last_observed_at | The date and time that the finding was last observed. | date |
| aws.inspector.network_reachability_details.network_path.steps.component.arn | The component ARN. The ARN can be null and is not displayed in the AWS console. | keyword |
| aws.inspector.network_reachability_details.network_path.steps.component.id | The component ID. | keyword |
| aws.inspector.network_reachability_details.network_path.steps.component.type | The component type. | keyword |
| aws.inspector.network_reachability_details.open_port_range.begin | The beginning port in a port range. | long |
| aws.inspector.network_reachability_details.open_port_range.end | The ending port in a port range. | long |
| aws.inspector.network_reachability_details.protocol | The protocol associated with a finding. | keyword |
| aws.inspector.package_nested.arch | The architecture of the vulnerable package. | keyword |
| aws.inspector.package_nested.epoch | The epoch of the vulnerable package. | long |
| aws.inspector.package_nested.file_path | The file path of the vulnerable package. | keyword |
| aws.inspector.package_nested.fixed_in_version | The version of the package that contains the vulnerability fix. | keyword |
| aws.inspector.package_nested.name | The name of the vulnerable package. | keyword |
| aws.inspector.package_nested.package_manager | The package manager of the vulnerable package. | keyword |
| aws.inspector.package_nested.release | The release of the vulnerable package. | keyword |
| aws.inspector.package_nested.remediation | The code to run in your environment to update packages with a fix available. | keyword |
| aws.inspector.package_nested.source_lambda_layer_arn | The Amazon Resource Number (ARN) of the AWS Lambda function affected by a finding. | keyword |
| aws.inspector.package_nested.source_layer_hash | The source layer hash of the vulnerable package. | keyword |
| aws.inspector.package_nested.version | The version of the vulnerable package. | keyword |
| aws.inspector.package_vulnerability_details.cvss.base_score | The base CVSS score used for the finding. | double |
| aws.inspector.package_vulnerability_details.cvss.scoring_vector | The vector string of the CVSS score. | keyword |
| aws.inspector.package_vulnerability_details.cvss.source | The source of the CVSS score. | keyword |
| aws.inspector.package_vulnerability_details.cvss.version | The version of CVSS used for the score. | keyword |
| aws.inspector.package_vulnerability_details.reference_urls | One or more URLs that contain details about this vulnerability type. | keyword |
| aws.inspector.package_vulnerability_details.related_vulnerabilities | One or more vulnerabilities related to the one identified in this finding. | keyword |
| aws.inspector.package_vulnerability_details.source.url.domain | A domain to the source url of the vulnerability information. | keyword |
| aws.inspector.package_vulnerability_details.source.url.extension | A extension to the source url of the vulnerability information. | keyword |
| aws.inspector.package_vulnerability_details.source.url.original | A original to the source url of the vulnerability information. | keyword |
| aws.inspector.package_vulnerability_details.source.url.path | A path to the source url of the vulnerability information. | keyword |
| aws.inspector.package_vulnerability_details.source.url.query | A query to the source url of the vulnerability information. | keyword |
| aws.inspector.package_vulnerability_details.source.url.scheme | A scheme to the source url of the vulnerability information. | keyword |
| aws.inspector.package_vulnerability_details.source.value | The source of the vulnerability information. | keyword |
| aws.inspector.package_vulnerability_details.vendor.created_at | The date and time that this vulnerability was first added to the vendor's database. | date |
| aws.inspector.package_vulnerability_details.vendor.severity | The severity the vendor has given to this vulnerability type. | keyword |
| aws.inspector.package_vulnerability_details.vendor.updated_at | The date and time the vendor last updated this vulnerability in their database. | date |
| aws.inspector.package_vulnerability_details.vulnerability_id | The ID given to this vulnerability. | keyword |
| aws.inspector.package_vulnerability_details.vulnerable_packages.arch | The architecture of the vulnerable package. | keyword |
| aws.inspector.package_vulnerability_details.vulnerable_packages.epoch | The epoch of the vulnerable package. | long |
| aws.inspector.package_vulnerability_details.vulnerable_packages.file_path | The file path of the vulnerable package. | keyword |
| aws.inspector.package_vulnerability_details.vulnerable_packages.fixed_in_version | The version of the package that contains the vulnerability fix. | keyword |
| aws.inspector.package_vulnerability_details.vulnerable_packages.name | The name of the vulnerable package. | keyword |
| aws.inspector.package_vulnerability_details.vulnerable_packages.package_manager | The package manager of the vulnerable package. | keyword |
| aws.inspector.package_vulnerability_details.vulnerable_packages.release | The release of the vulnerable package. | keyword |
| aws.inspector.package_vulnerability_details.vulnerable_packages.remediation | The code to run in your environment to update packages with a fix available. | keyword |
| aws.inspector.package_vulnerability_details.vulnerable_packages.source_lambda_layer_arn | The Amazon Resource Number (ARN) of the AWS Lambda function affected by a finding. | keyword |
| aws.inspector.package_vulnerability_details.vulnerable_packages.source_layer_hash | The source layer hash of the vulnerable package. | keyword |
| aws.inspector.package_vulnerability_details.vulnerable_packages.version | The version of the vulnerable package. | keyword |
| aws.inspector.remediation.recommendation.text | The recommended course of action to remediate the finding. | keyword |
| aws.inspector.remediation.recommendation.url.domain | The domain to the CVE remediation url recommendations. | keyword |
| aws.inspector.remediation.recommendation.url.extension | The extension to the CVE remediation url recommendations. | keyword |
| aws.inspector.remediation.recommendation.url.original | The original to the CVE remediation url recommendations. | keyword |
| aws.inspector.remediation.recommendation.url.path | The path to the CVE remediation url recommendations. | keyword |
| aws.inspector.remediation.recommendation.url.query | The query to the CVE remediation url recommendations. | keyword |
| aws.inspector.remediation.recommendation.url.scheme | The scheme to the CVE remediation url recommendations. | keyword |
| aws.inspector.resources.details.aws.ec2_instance.iam_instance_profile_arn | The IAM instance profile ARN of the Amazon EC2 instance. | keyword |
| aws.inspector.resources.details.aws.ec2_instance.image_id | The image ID of the Amazon EC2 instance. | keyword |
| aws.inspector.resources.details.aws.ec2_instance.ipv4_addresses | The IPv4 addresses of the Amazon EC2 instance. | ip |
| aws.inspector.resources.details.aws.ec2_instance.ipv6_addresses | The IPv6 addresses of the Amazon EC2 instance. | ip |
| aws.inspector.resources.details.aws.ec2_instance.key_name | The name of the key pair used to launch the Amazon EC2 instance. | keyword |
| aws.inspector.resources.details.aws.ec2_instance.launched_at | The date and time the Amazon EC2 instance was launched at. | date |
| aws.inspector.resources.details.aws.ec2_instance.platform | The platform of the Amazon EC2 instance. | keyword |
| aws.inspector.resources.details.aws.ec2_instance.subnet_id | The subnet ID of the Amazon EC2 instance. | keyword |
| aws.inspector.resources.details.aws.ec2_instance.type | The type of the Amazon EC2 instance. | keyword |
| aws.inspector.resources.details.aws.ec2_instance.vpc_id | The VPC ID of the Amazon EC2 instance. | keyword |
| aws.inspector.resources.details.aws.ecr_container_image.architecture | The architecture of the Amazon ECR container image. | keyword |
| aws.inspector.resources.details.aws.ecr_container_image.author | The image author of the Amazon ECR container image. | keyword |
| aws.inspector.resources.details.aws.ecr_container_image.image.hash | The image hash of the Amazon ECR container image. | keyword |
| aws.inspector.resources.details.aws.ecr_container_image.image.tags | The image tags attached to the Amazon ECR container image. | keyword |
| aws.inspector.resources.details.aws.ecr_container_image.in_use_count | The number of Amazon ECS tasks or Amazon EKS pods where the Amazon ECR container image is in use. | long |
| aws.inspector.resources.details.aws.ecr_container_image.last_in_use_at | The last time an Amazon ECR image was used in an Amazon ECS task or Amazon EKS pod. | date |
| aws.inspector.resources.details.aws.ecr_container_image.platform | The platform of the Amazon ECR container image. | keyword |
| aws.inspector.resources.details.aws.ecr_container_image.pushed_at | The date and time the Amazon ECR container image was pushed. | date |
| aws.inspector.resources.details.aws.ecr_container_image.registry | The registry the Amazon ECR container image belongs to. | keyword |
| aws.inspector.resources.details.aws.ecr_container_image.repository_name | The name of the repository the Amazon ECR container image resides in. | keyword |
| aws.inspector.resources.details.aws.lambda_function.architectures | The instruction set architecture that the AWS Lambda function supports. Architecture is a string array with one of the valid values. The default architecture value is x86_64. | keyword |
| aws.inspector.resources.details.aws.lambda_function.code_sha256 | The SHA256 hash of the AWS Lambda function's deployment package. | keyword |
| aws.inspector.resources.details.aws.lambda_function.execution_role_arn | The AWS Lambda function's execution role. | keyword |
| aws.inspector.resources.details.aws.lambda_function.function_name | The name of the AWS Lambda function. | keyword |
| aws.inspector.resources.details.aws.lambda_function.last_modified_at | The date and time that a user last updated the configuration, in ISO 8601 format. | date |
| aws.inspector.resources.details.aws.lambda_function.layers | The AWS Lambda function's layers. A Lambda function can have up to five layers. | keyword |
| aws.inspector.resources.details.aws.lambda_function.package_type | The type of deployment package. Set to Image for container image and set Zip for .zip file archive. | keyword |
| aws.inspector.resources.details.aws.lambda_function.runtime | The runtime environment for the AWS Lambda function. | keyword |
| aws.inspector.resources.details.aws.lambda_function.version | The version of the AWS Lambda function. | keyword |
| aws.inspector.resources.details.aws.lambda_function.vpc_config.security_group_ids | The VPC security groups and subnets that are attached to an AWS Lambda function. For more information, see VPC Settings. | keyword |
| aws.inspector.resources.details.aws.lambda_function.vpc_config.subnet_ids | A list of VPC subnet IDs. | keyword |
| aws.inspector.resources.details.aws.lambda_function.vpc_config.vpc_id | The ID of the VPC. | keyword |
| aws.inspector.resources.details.code_repository.integration_arn | The Amazon Resource Name (ARN) of the code security integration associated with the repository. | keyword |
| aws.inspector.resources.details.code_repository.project_name | The name of the project in the code repository. | keyword |
| aws.inspector.resources.details.code_repository.provider_type | The type of repository provider (such as GitHub, GitLab, etc.). | keyword |
| aws.inspector.resources.id | The ID of the resource. | keyword |
| aws.inspector.resources.partition | The partition of the resource. | keyword |
| aws.inspector.resources.region | The AWS Region the impacted resource is located in. | keyword |
| aws.inspector.resources.tags | The tags attached to the resource. | flattened |
| aws.inspector.resources.type | The type of resource. | keyword |
| aws.inspector.severity | The severity of the finding. | keyword |
| aws.inspector.status | The status of the finding. | keyword |
| aws.inspector.title | The title of the finding. | keyword |
| aws.inspector.transform_unique_id |  | keyword |
| aws.inspector.type | The type of the finding. | keyword |
| aws.inspector.updated_at | The date and time the finding was last updated at. | date |
| cloud.image.id | Image ID for the cloud instance. | keyword |
| data_stream.dataset | The field can contain anything that makes sense to signify the source of the data. Examples include `nginx.access`, `prometheus`, `endpoint` etc. For data streams that otherwise fit, but that do not have dataset set we use the value "generic" for the dataset value. `event.dataset` should have the same value as `data_stream.dataset`. Beyond the Elasticsearch data stream naming criteria noted above, the `dataset` value has additional restrictions:   \* Must not contain `-`   \* No longer than 100 characters | constant_keyword |
| data_stream.namespace | A user defined namespace. Namespaces are useful to allow grouping of data. Many users already organize their indices this way, and the data stream naming scheme now provides this best practice as a default. Many users will populate this field with `default`. If no value is used, it falls back to `default`. Beyond the Elasticsearch index naming criteria noted above, `namespace` value has the additional restrictions:   \* Must not contain `-`   \* No longer than 100 characters | constant_keyword |
| data_stream.type | An overarching type for the data stream. Currently allowed values are "logs" and "metrics". We expect to also add "traces" and "synthetics" in the near future. | constant_keyword |
| event.dataset | Name of the dataset. If an event source publishes more than one type of log or events (e.g. access log, error log), the dataset is used to specify which one the event comes from. It's recommended but not required to start the dataset name with the module name, followed by a dot, then the dataset name. | constant_keyword |
| event.module | Name of the module this data is coming from. If your monitoring agent supports the concept of modules or plugins to process events of a given source (e.g. Apache logs), `event.module` should contain the name of this module. | constant_keyword |
| host.containerized | If the host is a container. | boolean |
| host.os.build | OS build information. | keyword |
| host.os.codename | OS codename, if any. | keyword |
| input.type | Input type | keyword |
| log.file.device_id | Device Id of the log file this event came from. | keyword |
| log.file.inode | Inode number of the log file. | keyword |
| log.file.path | Path to the log file. | keyword |
| log.offset | Log offset | long |
| observer.vendor | Vendor name of the observer. | constant_keyword |
| package.fixed_version | In which version of the package the vulnerability was fixed. | keyword |
| resource.id | The ID of the vulnerable resource. | keyword |
| resource.name | The name of the vulnerable resource. | keyword |
| resource.type | The type of the vulnerable resource. | keyword |
| vulnerability.cve | The CVE id of the vulnerability. | keyword |
| vulnerability.published_date | When the vulnerability was published. | date |
| vulnerability.scanner.vendor | The name of the vulnerability scanner vendor. | constant_keyword |
| vulnerability.title | The human readeable title of the vulnerability. | keyword |

