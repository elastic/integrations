{
    "expected": [
        {
            "@timestamp": "2024-10-30T20:30:00.000Z",
            "actor": {
                "entity": {
                    "id": [
                        "arn:aws:iam::00000000000:user/pwncloud-backdoor-user"
                    ]
                }
            },
            "aws": {
                "cloudtrail": {
                    "event_category": "Management",
                    "event_type": "AwsApiCall",
                    "event_version": "1.08",
                    "flattened": {
                        "request_parameters": {
                            "content": "HIDDEN_DUE_TO_SECURITY_REASONS",
                            "documentFormat": "YAML",
                            "name": "EncryptFilesAndUploadRansomNote"
                        },
                        "response_elements": {
                            "documentDescription": {
                                "createdDate": "Oct 30, 2024 8:29:59 PM",
                                "defaultVersion": "1",
                                "description": "Custom Pwncloud SSM Document to Encrypt S3 Bucket Files, Exfiltrate via SNS and HTTP, and Upload Ransom Note",
                                "documentFormat": "YAML",
                                "documentId": "091a4f36-2482-4b1e-ba17-b7851b0d422d",
                                "documentType": "Command",
                                "documentVersion": "1",
                                "hash": "21000908d6c4f7ec7a1613003be9d48c059628bfd4d5c9814d55baafe83bcbc6",
                                "hashType": "Sha256",
                                "latestVersion": "1",
                                "name": "EncryptFilesAndUploadRansomNote",
                                "owner": "00000000000",
                                "platformTypes": [
                                    "Linux",
                                    "MacOS"
                                ],
                                "schemaVersion": "2.2",
                                "status": "Creating"
                            }
                        }
                    },
                    "read_only": false,
                    "recipient_account_id": "00000000000",
                    "request_id": "ad275bc7-b7ef-4ae0-ade5-0d92ac331c40",
                    "request_parameters": "{name=EncryptFilesAndUploadRansomNote, documentFormat=YAML, content=HIDDEN_DUE_TO_SECURITY_REASONS}",
                    "response_elements": "{documentDescription={owner=00000000000, schemaVersion=2.2, documentType=Command, description=Custom Pwncloud SSM Document to Encrypt S3 Bucket Files, Exfiltrate via SNS and HTTP, and Upload Ransom Note, documentVersion=1, createdDate=Oct 30, 2024 8:29:59 PM, latestVersion=1, name=EncryptFilesAndUploadRansomNote, documentId=091a4f36-2482-4b1e-ba17-b7851b0d422d, documentFormat=YAML, hashType=Sha256, hash=21000908d6c4f7ec7a1613003be9d48c059628bfd4d5c9814d55baafe83bcbc6, defaultVersion=1, status=Creating, platformTypes=[Linux, MacOS]}}",
                    "user_identity": {
                        "access_key_id": "ACCESSKEY",
                        "arn": "arn:aws:iam::00000000000:user/pwncloud-backdoor-user",
                        "type": "IAMUser"
                    }
                }
            },
            "cloud": {
                "account": {
                    "id": "00000000000"
                },
                "region": "us-east-1"
            },
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "CreateDocument",
                "category": [
                    "file"
                ],
                "created": "2021-11-11T01:02:03.123456789Z",
                "id": "82eb6527-ed28-40a3-b096-a2dc3d225115",
                "kind": "event",
                "original": "{\"eventVersion\":\"1.08\",\"userIdentity\":{\"type\":\"IAMUser\",\"principalId\":\"PRINCIPALID\",\"arn\":\"arn:aws:iam::00000000000:user/pwncloud-backdoor-user\",\"accountId\":\"00000000000\",\"accessKeyId\":\"ACCESSKEY\",\"userName\":\"pwncloud-backdoor-user\"},\"eventTime\":\"2024-10-30T20:30:00Z\",\"eventSource\":\"ssm.amazonaws.com\",\"eventName\":\"CreateDocument\",\"awsRegion\":\"us-east-1\",\"sourceIPAddress\":\"216.160.83.56\",\"userAgent\":\"aws-cli/2.18.17 md/awscrt#0.22.0 ua/2.0 os/linux#6.8.0-1016-aws md/arch#x86_64 lang/python#3.12.6 md/pyimpl#CPython cfg/retry-mode#standard md/installer#exe md/distrib#ubuntu.24 md/prompt#off md/command#ssm.create-document\",\"requestParameters\":{\"content\":\"HIDDEN_DUE_TO_SECURITY_REASONS\",\"name\":\"EncryptFilesAndUploadRansomNote\",\"documentFormat\":\"YAML\"},\"responseElements\":{\"documentDescription\":{\"hash\":\"21000908d6c4f7ec7a1613003be9d48c059628bfd4d5c9814d55baafe83bcbc6\",\"hashType\":\"Sha256\",\"name\":\"EncryptFilesAndUploadRansomNote\",\"owner\":\"00000000000\",\"createdDate\":\"Oct 30, 2024 8:29:59 PM\",\"status\":\"Creating\",\"documentVersion\":\"1\",\"description\":\"Custom Pwncloud SSM Document to Encrypt S3 Bucket Files, Exfiltrate via SNS and HTTP, and Upload Ransom Note\",\"platformTypes\":[\"Linux\",\"MacOS\"],\"documentType\":\"Command\",\"schemaVersion\":\"2.2\",\"latestVersion\":\"1\",\"defaultVersion\":\"1\",\"documentFormat\":\"YAML\",\"tags\":[],\"documentId\":\"091a4f36-2482-4b1e-ba17-b7851b0d422d\"}},\"requestID\":\"ad275bc7-b7ef-4ae0-ade5-0d92ac331c40\",\"eventID\":\"82eb6527-ed28-40a3-b096-a2dc3d225115\",\"readOnly\":false,\"eventType\":\"AwsApiCall\",\"recipientAccountId\":\"00000000000\",\"eventCategory\":\"Management\",\"tlsDetails\":{\"tlsVersion\":\"TLSv1.3\",\"cipherSuite\":\"TLS_AES_128_GCM_SHA256\",\"clientProvidedHostHeader\":\"ssm.us-east-1.amazonaws.com\"}}",
                "outcome": "success",
                "provider": "ssm.amazonaws.com",
                "type": [
                    "creation"
                ]
            },
            "related": {
                "entity": [
                    "pwncloud-backdoor-user",
                    "ACCESSKEY",
                    "EncryptFilesAndUploadRansomNote",
                    "arn:aws:iam::00000000000:user/pwncloud-backdoor-user"
                ],
                "user": [
                    "PRINCIPALID",
                    "pwncloud-backdoor-user"
                ]
            },
            "source": {
                "address": "216.160.83.56",
                "as": {
                    "number": 209
                },
                "geo": {
                    "city_name": "Milton",
                    "continent_name": "North America",
                    "country_iso_code": "US",
                    "country_name": "United States",
                    "location": {
                        "lat": 47.2513,
                        "lon": -122.3149
                    },
                    "region_iso_code": "US-WA",
                    "region_name": "Washington"
                },
                "ip": "216.160.83.56"
            },
            "tags": [
                "preserve_original_event",
                "actor_target_mapping"
            ],
            "target": {
                "entity": {
                    "id": [
                        "EncryptFilesAndUploadRansomNote"
                    ]
                }
            },
            "tls": {
                "cipher": "TLS_AES_128_GCM_SHA256",
                "client": {
                    "server_name": "ssm.us-east-1.amazonaws.com"
                },
                "version": "1.3",
                "version_protocol": "tls"
            },
            "user": {
                "id": "PRINCIPALID",
                "name": "pwncloud-backdoor-user"
            },
            "user_agent": {
                "device": {
                    "name": "Other"
                },
                "name": "aws-cli",
                "original": "aws-cli/2.18.17 md/awscrt#0.22.0 ua/2.0 os/linux#6.8.0-1016-aws md/arch#x86_64 lang/python#3.12.6 md/pyimpl#CPython cfg/retry-mode#standard md/installer#exe md/distrib#ubuntu.24 md/prompt#off md/command#ssm.create-document",
                "os": {
                    "name": "Linux"
                },
                "version": "2.18.17"
            }
        },
        {
            "@timestamp": "2021-11-11T01:02:03.123456789Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "created": "2021-11-11T01:02:03.123456789Z",
                "kind": "event",
                "outcome": "success",
                "type": [
                    "info"
                ]
            },
            "tags": [
                "preserve_original_event",
                "actor_target_mapping"
            ]
        }
    ]
}
