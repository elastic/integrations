{
    "expected": [
        {
            "@timestamp": "2024-09-11T09:29:33.000Z",
            "actor": {
                "entity": {
                    "id": [
                        "arn:aws:iam::1010101010101:user/testcloudtrail@elastic.co"
                    ]
                }
            },
            "aws": {
                "cloudtrail": {
                    "event_category": "Management",
                    "event_type": "AwsApiCall",
                    "event_version": "1.08",
                    "flattened": {
                        "request_parameters": {
                            "functionName": "cloudtrail-events-test",
                            "handler": "lambda.handler",
                            "publish": false,
                            "role": "arn:aws:iam::1010101010101:role/cloudtrail-events-test-lambda-fn",
                            "runtime": "nodejs20.x"
                        },
                        "response_elements": {
                            "architectures": [
                                "x86_64"
                            ],
                            "codeSha256": "m2HanyBGXadi+QCt0ct2KqsqHAF4cgUJLO4aS9PcUXo=",
                            "codeSize": 1018083,
                            "ephemeralStorage": {
                                "size": 512
                            },
                            "functionArn": "arn:aws:lambda:us-east-1:1010101010101:function:cloudtrail-events-test",
                            "functionName": "cloudtrail-events-test",
                            "handler": "lambda.handler",
                            "lastModified": "2024-09-11T09:29:33.375+0000",
                            "loggingConfig": {
                                "logFormat": "Text",
                                "logGroup": "/aws/lambda/cloudtrail-events-test"
                            },
                            "memorySize": 128,
                            "packageType": "Zip",
                            "revisionId": "729c925e-627c-42b2-abf1-55e7f8f7177c",
                            "role": "arn:aws:iam::1010101010101:role/cloudtrail-events-test-lambda-fn",
                            "runtime": "nodejs20.x",
                            "runtimeVersionConfig": {
                                "runtimeVersionArn": "arn:aws:lambda:us-east-1::runtime:672d5a3e06f81d120c089c5414b05186d7b4098504797c766bde2459847f38bc"
                            },
                            "snapStart": {
                                "applyOn": "None",
                                "optimizationStatus": "Off"
                            },
                            "state": "Pending",
                            "stateReason": "The function is being created.",
                            "stateReasonCode": "Creating",
                            "timeout": 3,
                            "tracingConfig": {
                                "mode": "PassThrough"
                            },
                            "version": "$LATEST"
                        }
                    },
                    "read_only": false,
                    "recipient_account_id": "1010101010101",
                    "request_id": "1ea1d5c8-9cfc-4e18-8256-3dfbcfc43e0b",
                    "request_parameters": "{handler=lambda.handler, role=arn:aws:iam::1010101010101:role/cloudtrail-events-test-lambda-fn, functionName=cloudtrail-events-test, publish=false, runtime=nodejs20.x}",
                    "response_elements": "{architectures=[x86_64], ephemeralStorage={size=512}, handler=lambda.handler, role=arn:aws:iam::1010101010101:role/cloudtrail-events-test-lambda-fn, functionName=cloudtrail-events-test, tracingConfig={mode=PassThrough}, runtime=nodejs20.x, stateReasonCode=Creating, runtimeVersionConfig={runtimeVersionArn=arn:aws:lambda:us-east-1::runtime:672d5a3e06f81d120c089c5414b05186d7b4098504797c766bde2459847f38bc}, stateReason=The function is being created., codeSize=1018083, packageType=Zip, version=$LATEST, timeout=3, revisionId=729c925e-627c-42b2-abf1-55e7f8f7177c, codeSha256=m2HanyBGXadi+QCt0ct2KqsqHAF4cgUJLO4aS9PcUXo=, memorySize=128, loggingConfig={logFormat=Text, logGroup=/aws/lambda/cloudtrail-events-test}, snapStart={applyOn=None, optimizationStatus=Off}, lastModified=2024-09-11T09:29:33.375+0000, state=Pending, functionArn=arn:aws:lambda:us-east-1:1010101010101:function:cloudtrail-events-test}",
                    "user_identity": {
                        "access_key_id": "ACCESS_KEY_EXAMPLE",
                        "arn": "arn:aws:iam::1010101010101:user/testcloudtrail@elastic.co",
                        "type": "IAMUser"
                    }
                }
            },
            "cloud": {
                "account": {
                    "id": "1010101010101"
                },
                "region": "us-east-1"
            },
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "CreateFunction20150331",
                "created": "2021-11-11T01:02:03.123456789Z",
                "id": "6642d073-04f9-474f-a31d-5ef412875c07",
                "kind": "event",
                "original": "{\"awsRegion\":\"us-east-1\",\"eventCategory\":\"Management\",\"eventID\":\"6642d073-04f9-474f-a31d-5ef412875c07\",\"eventName\":\"CreateFunction20150331\",\"eventSource\":\"lambda.amazonaws.com\",\"eventTime\":\"2024-09-11T09:29:33Z\",\"eventType\":\"AwsApiCall\",\"eventVersion\":\"1.08\",\"readOnly\":false,\"recipientAccountId\":\"1010101010101\",\"requestID\":\"1ea1d5c8-9cfc-4e18-8256-3dfbcfc43e0b\",\"requestParameters\":{\"code\":{},\"environment\":{},\"functionName\":\"cloudtrail-events-test\",\"handler\":\"lambda.handler\",\"publish\":false,\"role\":\"arn:aws:iam::1010101010101:role/cloudtrail-events-test-lambda-fn\",\"runtime\":\"nodejs20.x\"},\"responseElements\":{\"architectures\":[\"x86_64\"],\"codeSha256\":\"m2HanyBGXadi+QCt0ct2KqsqHAF4cgUJLO4aS9PcUXo=\",\"codeSize\":1018083,\"description\":\"\",\"environment\":{},\"ephemeralStorage\":{\"size\":512},\"functionArn\":\"arn:aws:lambda:us-east-1:1010101010101:function:cloudtrail-events-test\",\"functionName\":\"cloudtrail-events-test\",\"handler\":\"lambda.handler\",\"lastModified\":\"2024-09-11T09:29:33.375+0000\",\"loggingConfig\":{\"logFormat\":\"Text\",\"logGroup\":\"/aws/lambda/cloudtrail-events-test\"},\"memorySize\":128,\"packageType\":\"Zip\",\"revisionId\":\"729c925e-627c-42b2-abf1-55e7f8f7177c\",\"role\":\"arn:aws:iam::1010101010101:role/cloudtrail-events-test-lambda-fn\",\"runtime\":\"nodejs20.x\",\"runtimeVersionConfig\":{\"runtimeVersionArn\":\"arn:aws:lambda:us-east-1::runtime:672d5a3e06f81d120c089c5414b05186d7b4098504797c766bde2459847f38bc\"},\"snapStart\":{\"applyOn\":\"None\",\"optimizationStatus\":\"Off\"},\"state\":\"Pending\",\"stateReason\":\"The function is being created.\",\"stateReasonCode\":\"Creating\",\"timeout\":3,\"tracingConfig\":{\"mode\":\"PassThrough\"},\"version\":\"$LATEST\"},\"sourceIPAddress\":\"216.160.83.56\",\"tlsDetails\":{\"cipherSuite\":\"TLS_AES_128_GCM_SHA256\",\"clientProvidedHostHeader\":\"lambda.us-east-1.amazonaws.com\",\"tlsVersion\":\"TLSv1.3\"},\"userAgent\":\"aws-cli/2.14.5 Python/3.11.6 Darwin/23.6.0 exec-env/grimoire_7ea17849-045c-4e81-8a81-d0822d5c4aaf exe/x86_64 prompt/off command/lambda.create-function\",\"userIdentity\":{\"accessKeyId\":\"ACCESS_KEY_EXAMPLE\",\"accountId\":\"1010101010101\",\"arn\":\"arn:aws:iam::1010101010101:user/testcloudtrail@elastic.co\",\"principalId\":\"AIDA2IBR2EZTJMPOR52WV\",\"type\":\"IAMUser\",\"userName\":\"testcloudtrail@elastic.co\"}}",
                "outcome": "success",
                "provider": "lambda.amazonaws.com",
                "type": [
                    "info"
                ]
            },
            "related": {
                "entity": [
                    "arn:aws:lambda:us-east-1:1010101010101:function:cloudtrail-events-test",
                    "testcloudtrail@elastic.co",
                    "ACCESS_KEY_EXAMPLE",
                    "arn:aws:iam::1010101010101:role/cloudtrail-events-test-lambda-fn",
                    "arn:aws:iam::1010101010101:user/testcloudtrail@elastic.co",
                    "cloudtrail-events-test"
                ],
                "user": [
                    "AIDA2IBR2EZTJMPOR52WV",
                    "testcloudtrail@elastic.co"
                ]
            },
            "source": {
                "address": "216.160.83.56",
                "as": {
                    "number": 209
                },
                "geo": {
                    "city_name": "Milton",
                    "continent_name": "North America",
                    "country_iso_code": "US",
                    "country_name": "United States",
                    "location": {
                        "lat": 47.2513,
                        "lon": -122.3149
                    },
                    "region_iso_code": "US-WA",
                    "region_name": "Washington"
                },
                "ip": "216.160.83.56"
            },
            "tags": [
                "preserve_original_event",
                "actor_target_mapping"
            ],
            "tls": {
                "cipher": "TLS_AES_128_GCM_SHA256",
                "client": {
                    "server_name": "lambda.us-east-1.amazonaws.com"
                },
                "version": "1.3",
                "version_protocol": "tls"
            },
            "user": {
                "email": "testcloudtrail@elastic.co",
                "id": "AIDA2IBR2EZTJMPOR52WV",
                "name": "testcloudtrail@elastic.co"
            },
            "user_agent": {
                "device": {
                    "name": "Other"
                },
                "name": "aws-cli",
                "original": "aws-cli/2.14.5 Python/3.11.6 Darwin/23.6.0 exec-env/grimoire_7ea17849-045c-4e81-8a81-d0822d5c4aaf exe/x86_64 prompt/off command/lambda.create-function",
                "version": "2.14.5"
            }
        },
        {
            "@timestamp": "2021-11-11T01:02:03.123456789Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "created": "2021-11-11T01:02:03.123456789Z",
                "kind": "event",
                "outcome": "success",
                "type": [
                    "info"
                ]
            },
            "tags": [
                "preserve_original_event",
                "actor_target_mapping"
            ]
        }
    ]
}
