{
    "expected": [
        {
            "@timestamp": "2024-09-11T09:28:29.000Z",
            "actor": {
                "entity": {
                    "id": [
                        "arn:aws:iam::1010101010101:user/testcloudtrail@elastic.co"
                    ]
                }
            },
            "aws": {
                "cloudtrail": {
                    "event_category": "Management",
                    "event_type": "AwsApiCall",
                    "event_version": "1.10",
                    "flattened": {
                        "request_parameters": {
                            "clientToken": "aeafce9c-025e-47f3-b3cc-7d9292cbadfd",
                            "disableApiStop": false,
                            "disableApiTermination": false,
                            "instanceType": "t1.micro",
                            "instancesSet": {
                                "items": [
                                    {
                                        "imageId": "ami-00a4cd63f089232e0",
                                        "maxCount": 1,
                                        "minCount": 1
                                    }
                                ]
                            },
                            "monitoring": {
                                "enabled": false
                            },
                            "tagSpecificationSet": {
                                "items": [
                                    {
                                        "resourceType": "instance",
                                        "tags": [
                                            {
                                                "key": "name",
                                                "value": "cloudtrail-event-test"
                                            },
                                            {
                                                "key": "division",
                                                "value": "engineering"
                                            },
                                            {
                                                "key": "org",
                                                "value": "security"
                                            },
                                            {
                                                "key": "team",
                                                "value": "cloud"
                                            },
                                            {
                                                "key": "project",
                                                "value": "testproject"
                                            }
                                        ]
                                    }
                                ]
                            }
                        },
                        "response_elements": {
                            "instancesSet": {
                                "items": [
                                    {
                                        "amiLaunchIndex": 0,
                                        "architecture": "x86_64",
                                        "capacityReservationSpecification": {
                                            "capacityReservationPreference": "open"
                                        },
                                        "clientToken": "aeafce9c-025e-47f3-b3cc-7d9292cbadfd",
                                        "cpuOptions": {
                                            "coreCount": 1,
                                            "threadsPerCore": 1
                                        },
                                        "currentInstanceBootMode": "legacy-bios",
                                        "ebsOptimized": false,
                                        "enaSupport": true,
                                        "enclaveOptions": {
                                            "enabled": false
                                        },
                                        "groupSet": {
                                            "items": [
                                                {
                                                    "groupId": "sg-4e483165",
                                                    "groupName": "default"
                                                }
                                            ]
                                        },
                                        "hypervisor": "xen",
                                        "imageId": "ami-00a4cd63f089232e0",
                                        "instanceId": "i-0f2f135de18b555e3",
                                        "instanceState": {
                                            "code": 0,
                                            "name": "pending"
                                        },
                                        "instanceType": "t1.micro",
                                        "launchTime": 1726046908000,
                                        "maintenanceOptions": {
                                            "autoRecovery": "default"
                                        },
                                        "metadataOptions": {
                                            "httpEndpoint": "enabled",
                                            "httpProtocolIpv4": "enabled",
                                            "httpProtocolIpv6": "disabled",
                                            "httpPutResponseHopLimit": 1,
                                            "httpTokens": "optional",
                                            "instanceMetadataTags": "disabled",
                                            "state": "pending"
                                        },
                                        "monitoring": {
                                            "state": "disabled"
                                        },
                                        "networkInterfaceSet": {
                                            "items": [
                                                {
                                                    "attachment": {
                                                        "attachTime": 1726046908000,
                                                        "attachmentId": "eni-attach-0b039fe5f25fca954",
                                                        "deleteOnTermination": true,
                                                        "deviceIndex": 0,
                                                        "networkCardIndex": 0,
                                                        "status": "attaching"
                                                    },
                                                    "groupSet": {
                                                        "items": [
                                                            {
                                                                "groupId": "sg-4e483165",
                                                                "groupName": "default"
                                                            }
                                                        ]
                                                    },
                                                    "interfaceType": "interface",
                                                    "macAddress": "0e:ff:ec:9c:25:65",
                                                    "networkInterfaceId": "eni-043138569d4a31e90",
                                                    "ownerId": "1010101010101",
                                                    "privateDnsName": "ip-172-31-35-48.ec2.internal",
                                                    "privateIpAddress": "172.31.35.48",
                                                    "privateIpAddressesSet": {
                                                        "item": [
                                                            {
                                                                "primary": true,
                                                                "privateDnsName": "ip-172-31-35-48.ec2.internal",
                                                                "privateIpAddress": "172.31.35.48"
                                                            }
                                                        ]
                                                    },
                                                    "sourceDestCheck": true,
                                                    "status": "in-use",
                                                    "subnetId": "subnet-c4bf5e9b",
                                                    "vpcId": "vpc-73d2e309"
                                                }
                                            ]
                                        },
                                        "placement": {
                                            "availabilityZone": "us-east-1d",
                                            "tenancy": "default"
                                        },
                                        "privateDnsName": "ip-172-31-35-48.ec2.internal",
                                        "privateDnsNameOptions": {
                                            "enableResourceNameDnsAAAARecord": false,
                                            "enableResourceNameDnsARecord": false,
                                            "hostnameType": "ip-name"
                                        },
                                        "privateIpAddress": "172.31.35.48",
                                        "rootDeviceName": "/dev/xvda",
                                        "rootDeviceType": "ebs",
                                        "sourceDestCheck": true,
                                        "stateReason": {
                                            "code": "pending",
                                            "message": "pending"
                                        },
                                        "subnetId": "subnet-c4bf5e9b",
                                        "tagSet": {
                                            "items": [
                                                {
                                                    "key": "team",
                                                    "value": "cloud"
                                                },
                                                {
                                                    "key": "division",
                                                    "value": "engineering"
                                                },
                                                {
                                                    "key": "org",
                                                    "value": "security"
                                                },
                                                {
                                                    "key": "name",
                                                    "value": "cloudtrail-event-test"
                                                },
                                                {
                                                    "key": "project",
                                                    "value": "testproject"
                                                }
                                            ]
                                        },
                                        "virtualizationType": "hvm",
                                        "vpcId": "vpc-73d2e309"
                                    }
                                ]
                            },
                            "ownerId": "1010101010101",
                            "requestId": "ffd44d98-cea5-4b4a-9c38-b2aee9f73489",
                            "reservationId": "r-0dfcd099dcab4e63a"
                        }
                    },
                    "read_only": false,
                    "recipient_account_id": "1010101010101",
                    "request_id": "ffd44d98-cea5-4b4a-9c38-b2aee9f73489",
                    "request_parameters": "{instancesSet={items=[{imageId=ami-00a4cd63f089232e0, minCount=1, maxCount=1}]}, disableApiTermination=false, tagSpecificationSet={items=[{resourceType=instance, tags=[{value=cloudtrail-event-test, key=name}, {value=engineering, key=division}, {value=security, key=org}, {value=cloud, key=team}, {value=testproject, key=project}]}]}, clientToken=aeafce9c-025e-47f3-b3cc-7d9292cbadfd, instanceType=t1.micro, monitoring={enabled=false}, disableApiStop=false}",
                    "response_elements": "{instancesSet={items=[{subnetId=subnet-c4bf5e9b, virtualizationType=hvm, capacityReservationSpecification={capacityReservationPreference=open}, amiLaunchIndex=0, enaSupport=true, currentInstanceBootMode=legacy-bios, sourceDestCheck=true, stateReason={code=pending, message=pending}, groupSet={items=[{groupName=default, groupId=sg-4e483165}]}, tagSet={items=[{value=cloud, key=team}, {value=engineering, key=division}, {value=security, key=org}, {value=cloudtrail-event-test, key=name}, {value=testproject, key=project}]}, instanceId=i-0f2f135de18b555e3, instanceState={code=0, name=pending}, maintenanceOptions={autoRecovery=default}, hypervisor=xen, vpcId=vpc-73d2e309, rootDeviceName=/dev/xvda, architecture=x86_64, ebsOptimized=false, imageId=ami-00a4cd63f089232e0, networkInterfaceSet={items=[{networkInterfaceId=eni-043138569d4a31e90, subnetId=subnet-c4bf5e9b, ownerId=1010101010101, sourceDestCheck=true, groupSet={items=[{groupName=default, groupId=sg-4e483165}]}, privateIpAddress=172.31.35.48, interfaceType=interface, macAddress=0e:ff:ec:9c:25:65, attachment={networkCardIndex=0, attachmentId=eni-attach-0b039fe5f25fca954, deleteOnTermination=true, deviceIndex=0, attachTime=1726046908000, status=attaching}, vpcId=vpc-73d2e309, privateDnsName=ip-172-31-35-48.ec2.internal, privateIpAddressesSet={item=[{privateDnsName=ip-172-31-35-48.ec2.internal, privateIpAddress=172.31.35.48, primary=true}]}, status=in-use}]}, clientToken=aeafce9c-025e-47f3-b3cc-7d9292cbadfd, instanceType=t1.micro, cpuOptions={threadsPerCore=1, coreCount=1}, monitoring={state=disabled}, privateIpAddress=172.31.35.48, privateDnsNameOptions={enableResourceNameDnsAAAARecord=false, enableResourceNameDnsARecord=false, hostnameType=ip-name}, rootDeviceType=ebs, enclaveOptions={enabled=false}, launchTime=1726046908000, metadataOptions={instanceMetadataTags=disabled, httpPutResponseHopLimit=1, httpProtocolIpv4=enabled, httpProtocolIpv6=disabled, httpEndpoint=enabled, state=pending, httpTokens=optional}, privateDnsName=ip-172-31-35-48.ec2.internal, placement={tenancy=default, availabilityZone=us-east-1d}}]}, reservationId=r-0dfcd099dcab4e63a, requestId=ffd44d98-cea5-4b4a-9c38-b2aee9f73489, ownerId=1010101010101}",
                    "user_identity": {
                        "access_key_id": "ACCESS_KEY_EXAMPLE",
                        "arn": "arn:aws:iam::1010101010101:user/testcloudtrail@elastic.co",
                        "type": "IAMUser"
                    }
                }
            },
            "cloud": {
                "account": {
                    "id": "1010101010101"
                },
                "region": "us-east-1"
            },
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "RunInstances",
                "created": "2021-11-11T01:02:03.123456789Z",
                "id": "5e1fb8e0-231d-4527-a146-d051e37d0d4f",
                "kind": "event",
                "original": "{\"awsRegion\":\"us-east-1\",\"eventCategory\":\"Management\",\"eventID\":\"5e1fb8e0-231d-4527-a146-d051e37d0d4f\",\"eventName\":\"RunInstances\",\"eventSource\":\"ec2.amazonaws.com\",\"eventTime\":\"2024-09-11T09:28:29Z\",\"eventType\":\"AwsApiCall\",\"eventVersion\":\"1.10\",\"readOnly\":false,\"recipientAccountId\":\"1010101010101\",\"requestID\":\"ffd44d98-cea5-4b4a-9c38-b2aee9f73489\",\"requestParameters\":{\"blockDeviceMapping\":{},\"clientToken\":\"aeafce9c-025e-47f3-b3cc-7d9292cbadfd\",\"disableApiStop\":false,\"disableApiTermination\":false,\"instanceType\":\"t1.micro\",\"instancesSet\":{\"items\":[{\"imageId\":\"ami-00a4cd63f089232e0\",\"maxCount\":1,\"minCount\":1}]},\"monitoring\":{\"enabled\":false},\"tagSpecificationSet\":{\"items\":[{\"resourceType\":\"instance\",\"tags\":[{\"key\":\"name\",\"value\":\"cloudtrail-event-test\"},{\"key\":\"division\",\"value\":\"engineering\"},{\"key\":\"org\",\"value\":\"security\"},{\"key\":\"team\",\"value\":\"cloud\"},{\"key\":\"project\",\"value\":\"testproject\"}]}]}},\"responseElements\":{\"groupSet\":{},\"instancesSet\":{\"items\":[{\"amiLaunchIndex\":0,\"architecture\":\"x86_64\",\"blockDeviceMapping\":{},\"capacityReservationSpecification\":{\"capacityReservationPreference\":\"open\"},\"clientToken\":\"aeafce9c-025e-47f3-b3cc-7d9292cbadfd\",\"cpuOptions\":{\"coreCount\":1,\"threadsPerCore\":1},\"currentInstanceBootMode\":\"legacy-bios\",\"ebsOptimized\":false,\"enaSupport\":true,\"enclaveOptions\":{\"enabled\":false},\"groupSet\":{\"items\":[{\"groupId\":\"sg-4e483165\",\"groupName\":\"default\"}]},\"hypervisor\":\"xen\",\"imageId\":\"ami-00a4cd63f089232e0\",\"instanceId\":\"i-0f2f135de18b555e3\",\"instanceState\":{\"code\":0,\"name\":\"pending\"},\"instanceType\":\"t1.micro\",\"launchTime\":1726046908000,\"maintenanceOptions\":{\"autoRecovery\":\"default\"},\"metadataOptions\":{\"httpEndpoint\":\"enabled\",\"httpProtocolIpv4\":\"enabled\",\"httpProtocolIpv6\":\"disabled\",\"httpPutResponseHopLimit\":1,\"httpTokens\":\"optional\",\"instanceMetadataTags\":\"disabled\",\"state\":\"pending\"},\"monitoring\":{\"state\":\"disabled\"},\"networkInterfaceSet\":{\"items\":[{\"attachment\":{\"attachTime\":1726046908000,\"attachmentId\":\"eni-attach-0b039fe5f25fca954\",\"deleteOnTermination\":true,\"deviceIndex\":0,\"networkCardIndex\":0,\"status\":\"attaching\"},\"groupSet\":{\"items\":[{\"groupId\":\"sg-4e483165\",\"groupName\":\"default\"}]},\"interfaceType\":\"interface\",\"ipv6AddressesSet\":{},\"macAddress\":\"0e:ff:ec:9c:25:65\",\"networkInterfaceId\":\"eni-043138569d4a31e90\",\"ownerId\":\"1010101010101\",\"privateDnsName\":\"ip-172-31-35-48.ec2.internal\",\"privateIpAddress\":\"172.31.35.48\",\"privateIpAddressesSet\":{\"item\":[{\"primary\":true,\"privateDnsName\":\"ip-172-31-35-48.ec2.internal\",\"privateIpAddress\":\"172.31.35.48\"}]},\"sourceDestCheck\":true,\"status\":\"in-use\",\"subnetId\":\"subnet-c4bf5e9b\",\"tagSet\":{},\"vpcId\":\"vpc-73d2e309\"}]},\"placement\":{\"availabilityZone\":\"us-east-1d\",\"tenancy\":\"default\"},\"privateDnsName\":\"ip-172-31-35-48.ec2.internal\",\"privateDnsNameOptions\":{\"enableResourceNameDnsAAAARecord\":false,\"enableResourceNameDnsARecord\":false,\"hostnameType\":\"ip-name\"},\"privateIpAddress\":\"172.31.35.48\",\"productCodes\":{},\"rootDeviceName\":\"/dev/xvda\",\"rootDeviceType\":\"ebs\",\"sourceDestCheck\":true,\"stateReason\":{\"code\":\"pending\",\"message\":\"pending\"},\"subnetId\":\"subnet-c4bf5e9b\",\"tagSet\":{\"items\":[{\"key\":\"team\",\"value\":\"cloud\"},{\"key\":\"division\",\"value\":\"engineering\"},{\"key\":\"org\",\"value\":\"security\"},{\"key\":\"name\",\"value\":\"cloudtrail-event-test\"},{\"key\":\"project\",\"value\":\"testproject\"}]},\"virtualizationType\":\"hvm\",\"vpcId\":\"vpc-73d2e309\"}]},\"ownerId\":\"1010101010101\",\"requestId\":\"ffd44d98-cea5-4b4a-9c38-b2aee9f73489\",\"reservationId\":\"r-0dfcd099dcab4e63a\"},\"sourceIPAddress\":\"216.160.83.56\",\"tlsDetails\":{\"cipherSuite\":\"TLS_AES_128_GCM_SHA256\",\"clientProvidedHostHeader\":\"ec2.us-east-1.amazonaws.com\",\"tlsVersion\":\"TLSv1.3\"},\"userAgent\":\"aws-cli/2.14.5 Python/3.11.6 Darwin/23.6.0 exec-env/grimoire_7ea17849-045c-4e81-8a81-d0822d5c4aaf exe/x86_64 prompt/off command/ec2.run-instances\",\"userIdentity\":{\"accessKeyId\":\"ACCESS_KEY_EXAMPLE\",\"accountId\":\"1010101010101\",\"arn\":\"arn:aws:iam::1010101010101:user/testcloudtrail@elastic.co\",\"principalId\":\"AIDA2IBR2EZTJMPOR52WV\",\"type\":\"IAMUser\",\"userName\":\"testcloudtrail@elastic.co\"}}",
                "outcome": "success",
                "provider": "ec2.amazonaws.com",
                "type": [
                    "info"
                ]
            },
            "related": {
                "entity": [
                    "i-0f2f135de18b555e3",
                    "sg-4e483165",
                    "subnet-c4bf5e9b",
                    "vpc-73d2e309",
                    "testcloudtrail@elastic.co",
                    "ACCESS_KEY_EXAMPLE",
                    "r-0dfcd099dcab4e63a",
                    "arn:aws:iam::1010101010101:user/testcloudtrail@elastic.co",
                    "ami-00a4cd63f089232e0",
                    "eni-043138569d4a31e90"
                ],
                "user": [
                    "AIDA2IBR2EZTJMPOR52WV",
                    "testcloudtrail@elastic.co"
                ]
            },
            "source": {
                "address": "216.160.83.56",
                "as": {
                    "number": 209
                },
                "geo": {
                    "city_name": "Milton",
                    "continent_name": "North America",
                    "country_iso_code": "US",
                    "country_name": "United States",
                    "location": {
                        "lat": 47.2513,
                        "lon": -122.3149
                    },
                    "region_iso_code": "US-WA",
                    "region_name": "Washington"
                },
                "ip": "216.160.83.56"
            },
            "tags": [
                "preserve_original_event",
                "actor_target_mapping"
            ],
            "tls": {
                "cipher": "TLS_AES_128_GCM_SHA256",
                "client": {
                    "server_name": "ec2.us-east-1.amazonaws.com"
                },
                "version": "1.3",
                "version_protocol": "tls"
            },
            "user": {
                "email": "testcloudtrail@elastic.co",
                "id": "AIDA2IBR2EZTJMPOR52WV",
                "name": "testcloudtrail@elastic.co"
            },
            "user_agent": {
                "device": {
                    "name": "Other"
                },
                "name": "aws-cli",
                "original": "aws-cli/2.14.5 Python/3.11.6 Darwin/23.6.0 exec-env/grimoire_7ea17849-045c-4e81-8a81-d0822d5c4aaf exe/x86_64 prompt/off command/ec2.run-instances",
                "version": "2.14.5"
            }
        },
        {
            "@timestamp": "2021-11-11T01:02:03.123456789Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "created": "2021-11-11T01:02:03.123456789Z",
                "kind": "event",
                "outcome": "success",
                "type": [
                    "info"
                ]
            },
            "tags": [
                "preserve_original_event",
                "actor_target_mapping"
            ]
        }
    ]
}
