{
    "expected": [
        {
            "@timestamp": "2024-10-10T19:07:20.000Z",
            "actor": {
                "entity": {
                    "id": [
                        "arn:aws:iam::000000000:user/test@elastic.co"
                    ]
                }
            },
            "aws": {
                "cloudtrail": {
                    "event_category": "Management",
                    "event_type": "AwsApiCall",
                    "event_version": "1.08",
                    "flattened": {
                        "request_parameters": {
                            "allocatedStorage": 5,
                            "dBInstanceClass": "db.t3.micro",
                            "dBInstanceIdentifier": "test-cloudtrail-event-instance-31611-restored-from-s3",
                            "engine": "mysql",
                            "engineVersion": "8.0.39",
                            "masterUserPassword": "HIDDEN_DUE_TO_SECURITY_REASONS",
                            "masterUsername": "admin",
                            "s3BucketName": "rmf-cloudtrail-backup-test",
                            "s3IngestionRoleArn": "arn:aws:iam::000000000:role/rds-export",
                            "sourceEngine": "mysql",
                            "sourceEngineVersion": "8.0.39"
                        },
                        "response_elements": {
                            "allocatedStorage": 5,
                            "autoMinorVersionUpgrade": true,
                            "backupRetentionPeriod": 1,
                            "backupTarget": "region",
                            "cACertificateIdentifier": "rds-ca-rsa2048-g1",
                            "certificateDetails": {
                                "cAIdentifier": "rds-ca-rsa2048-g1"
                            },
                            "copyTagsToSnapshot": false,
                            "customerOwnedIpEnabled": false,
                            "dBInstanceArn": "arn:aws:rds:us-east-1:000000000:db:test-cloudtrail-event-instance-31611-restored-from-s3",
                            "dBInstanceClass": "db.t3.micro",
                            "dBInstanceIdentifier": "test-cloudtrail-event-instance-31611-restored-from-s3",
                            "dBInstanceStatus": "creating",
                            "dBParameterGroups": [
                                {
                                    "dBParameterGroupName": "default.mysql8.0",
                                    "parameterApplyStatus": "in-sync"
                                }
                            ],
                            "dBSubnetGroup": {
                                "dBSubnetGroupDescription": "default",
                                "dBSubnetGroupName": "default",
                                "subnetGroupStatus": "Complete",
                                "subnets": [
                                    {
                                        "subnetAvailabilityZone": {
                                            "name": "us-east-1d"
                                        },
                                        "subnetIdentifier": "subnet-c4bf5e9b",
                                        "subnetStatus": "Active"
                                    },
                                    {
                                        "subnetAvailabilityZone": {
                                            "name": "us-east-1a"
                                        },
                                        "subnetIdentifier": "subnet-0a0bee6c",
                                        "subnetStatus": "Active"
                                    },
                                    {
                                        "subnetAvailabilityZone": {
                                            "name": "us-east-1e"
                                        },
                                        "subnetIdentifier": "subnet-37391109",
                                        "subnetStatus": "Active"
                                    },
                                    {
                                        "subnetAvailabilityZone": {
                                            "name": "us-east-1b"
                                        },
                                        "subnetIdentifier": "subnet-fee506df",
                                        "subnetStatus": "Active"
                                    },
                                    {
                                        "subnetAvailabilityZone": {
                                            "name": "us-east-1f"
                                        },
                                        "subnetIdentifier": "subnet-bf6ab5b1",
                                        "subnetStatus": "Active"
                                    },
                                    {
                                        "subnetAvailabilityZone": {
                                            "name": "us-east-1c"
                                        },
                                        "subnetIdentifier": "subnet-8bdf6bc6",
                                        "subnetStatus": "Active"
                                    }
                                ],
                                "vpcId": "vpc-73d2e309"
                            },
                            "dbInstancePort": 0,
                            "dbiResourceId": "db-DFSLUDXPAQX7Z3OLNXDTAOV5UU",
                            "dedicatedLogVolume": false,
                            "deletionProtection": false,
                            "engine": "mysql",
                            "engineLifecycleSupport": "open-source-rds-extended-support",
                            "engineVersion": "8.0.39",
                            "httpEndpointEnabled": false,
                            "iAMDatabaseAuthenticationEnabled": false,
                            "licenseModel": "general-public-license",
                            "masterUsername": "admin",
                            "monitoringInterval": 0,
                            "multiAZ": false,
                            "networkType": "IPV4",
                            "optionGroupMemberships": [
                                {
                                    "optionGroupName": "default:mysql-8-0",
                                    "status": "in-sync"
                                }
                            ],
                            "pendingModifiedValues": {
                                "masterUserPassword": "HIDDEN_DUE_TO_SECURITY_REASONS"
                            },
                            "performanceInsightsEnabled": false,
                            "preferredBackupWindow": "03:09-03:39",
                            "preferredMaintenanceWindow": "sun:03:45-sun:04:15",
                            "publiclyAccessible": true,
                            "storageEncrypted": false,
                            "storageThroughput": 0,
                            "storageType": "gp2",
                            "vpcSecurityGroups": [
                                {
                                    "status": "active",
                                    "vpcSecurityGroupId": "sg-4e483165"
                                }
                            ]
                        }
                    },
                    "read_only": false,
                    "recipient_account_id": "000000000",
                    "request_id": "a6f1facd-7db5-4eaf-b697-e1d7fead7236",
                    "request_parameters": "{dBInstanceIdentifier=test-cloudtrail-event-instance-31611-restored-from-s3, engineVersion=8.0.39, masterUsername=admin, s3IngestionRoleArn=arn:aws:iam::000000000:role/rds-export, allocatedStorage=5, engine=mysql, s3BucketName=rmf-cloudtrail-backup-test, dBInstanceClass=db.t3.micro, sourceEngineVersion=8.0.39, sourceEngine=mysql, masterUserPassword=HIDDEN_DUE_TO_SECURITY_REASONS}",
                    "response_elements": "{allocatedStorage=5, backupTarget=region, cACertificateIdentifier=rds-ca-rsa2048-g1, dbInstancePort=0, dBParameterGroups=[{dBParameterGroupName=default.mysql8.0, parameterApplyStatus=in-sync}], dbiResourceId=db-DFSLUDXPAQX7Z3OLNXDTAOV5UU, preferredBackupWindow=03:09-03:39, deletionProtection=false, dBInstanceArn=arn:aws:rds:us-east-1:000000000:db:test-cloudtrail-event-instance-31611-restored-from-s3, dBInstanceIdentifier=test-cloudtrail-event-instance-31611-restored-from-s3, engine=mysql, publiclyAccessible=true, iAMDatabaseAuthenticationEnabled=false, networkType=IPV4, engineVersion=8.0.39, performanceInsightsEnabled=false, masterUsername=admin, certificateDetails={cAIdentifier=rds-ca-rsa2048-g1}, multiAZ=false, dBInstanceClass=db.t3.micro, storageEncrypted=false, dBSubnetGroup={vpcId=vpc-73d2e309, subnets=[{subnetIdentifier=subnet-c4bf5e9b, subnetStatus=Active, subnetAvailabilityZone={name=us-east-1d}}, {subnetIdentifier=subnet-0a0bee6c, subnetStatus=Active, subnetAvailabilityZone={name=us-east-1a}}, {subnetIdentifier=subnet-37391109, subnetStatus=Active, subnetAvailabilityZone={name=us-east-1e}}, {subnetIdentifier=subnet-fee506df, subnetStatus=Active, subnetAvailabilityZone={name=us-east-1b}}, {subnetIdentifier=subnet-bf6ab5b1, subnetStatus=Active, subnetAvailabilityZone={name=us-east-1f}}, {subnetIdentifier=subnet-8bdf6bc6, subnetStatus=Active, subnetAvailabilityZone={name=us-east-1c}}], subnetGroupStatus=Complete, dBSubnetGroupDescription=default, dBSubnetGroupName=default}, storageThroughput=0, httpEndpointEnabled=false, vpcSecurityGroups=[{vpcSecurityGroupId=sg-4e483165, status=active}], customerOwnedIpEnabled=false, licenseModel=general-public-license, pendingModifiedValues={masterUserPassword=HIDDEN_DUE_TO_SECURITY_REASONS}, monitoringInterval=0, preferredMaintenanceWindow=sun:03:45-sun:04:15, dBInstanceStatus=creating, backupRetentionPeriod=1, engineLifecycleSupport=open-source-rds-extended-support, storageType=gp2, optionGroupMemberships=[{optionGroupName=default:mysql-8-0, status=in-sync}], dedicatedLogVolume=false, autoMinorVersionUpgrade=true, copyTagsToSnapshot=false}",
                    "user_identity": {
                        "access_key_id": "ACCESSKEYID",
                        "arn": "arn:aws:iam::000000000:user/test@elastic.co",
                        "type": "IAMUser"
                    }
                }
            },
            "cloud": {
                "account": {
                    "id": "000000000"
                },
                "region": "us-east-1"
            },
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "action": "RestoreDBInstanceFromS3",
                "created": "2021-11-11T01:02:03.123456789Z",
                "id": "74cda083-4dd1-441b-9c88-77446f9d8216",
                "kind": "event",
                "original": "{\"awsRegion\":\"us-east-1\",\"eventCategory\":\"Management\",\"eventID\":\"74cda083-4dd1-441b-9c88-77446f9d8216\",\"eventName\":\"RestoreDBInstanceFromS3\",\"eventSource\":\"rds.amazonaws.com\",\"eventTime\":\"2024-10-10T19:07:20Z\",\"eventType\":\"AwsApiCall\",\"eventVersion\":\"1.08\",\"readOnly\":false,\"recipientAccountId\":\"000000000\",\"requestID\":\"a6f1facd-7db5-4eaf-b697-e1d7fead7236\",\"requestParameters\":{\"allocatedStorage\":5,\"dBInstanceClass\":\"db.t3.micro\",\"dBInstanceIdentifier\":\"test-cloudtrail-event-instance-31611-restored-from-s3\",\"engine\":\"mysql\",\"engineVersion\":\"8.0.39\",\"masterUserPassword\":\"HIDDEN_DUE_TO_SECURITY_REASONS\",\"masterUsername\":\"admin\",\"s3BucketName\":\"rmf-cloudtrail-backup-test\",\"s3IngestionRoleArn\":\"arn:aws:iam::000000000:role/rds-export\",\"sourceEngine\":\"mysql\",\"sourceEngineVersion\":\"8.0.39\"},\"responseElements\":{\"allocatedStorage\":5,\"associatedRoles\":[],\"autoMinorVersionUpgrade\":true,\"backupRetentionPeriod\":1,\"backupTarget\":\"region\",\"cACertificateIdentifier\":\"rds-ca-rsa2048-g1\",\"certificateDetails\":{\"cAIdentifier\":\"rds-ca-rsa2048-g1\"},\"copyTagsToSnapshot\":false,\"customerOwnedIpEnabled\":false,\"dBInstanceArn\":\"arn:aws:rds:us-east-1:000000000:db:test-cloudtrail-event-instance-31611-restored-from-s3\",\"dBInstanceClass\":\"db.t3.micro\",\"dBInstanceIdentifier\":\"test-cloudtrail-event-instance-31611-restored-from-s3\",\"dBInstanceStatus\":\"creating\",\"dBParameterGroups\":[{\"dBParameterGroupName\":\"default.mysql8.0\",\"parameterApplyStatus\":\"in-sync\"}],\"dBSecurityGroups\":[],\"dBSubnetGroup\":{\"dBSubnetGroupDescription\":\"default\",\"dBSubnetGroupName\":\"default\",\"subnetGroupStatus\":\"Complete\",\"subnets\":[{\"subnetAvailabilityZone\":{\"name\":\"us-east-1d\"},\"subnetIdentifier\":\"subnet-c4bf5e9b\",\"subnetOutpost\":{},\"subnetStatus\":\"Active\"},{\"subnetAvailabilityZone\":{\"name\":\"us-east-1a\"},\"subnetIdentifier\":\"subnet-0a0bee6c\",\"subnetOutpost\":{},\"subnetStatus\":\"Active\"},{\"subnetAvailabilityZone\":{\"name\":\"us-east-1e\"},\"subnetIdentifier\":\"subnet-37391109\",\"subnetOutpost\":{},\"subnetStatus\":\"Active\"},{\"subnetAvailabilityZone\":{\"name\":\"us-east-1b\"},\"subnetIdentifier\":\"subnet-fee506df\",\"subnetOutpost\":{},\"subnetStatus\":\"Active\"},{\"subnetAvailabilityZone\":{\"name\":\"us-east-1f\"},\"subnetIdentifier\":\"subnet-bf6ab5b1\",\"subnetOutpost\":{},\"subnetStatus\":\"Active\"},{\"subnetAvailabilityZone\":{\"name\":\"us-east-1c\"},\"subnetIdentifier\":\"subnet-8bdf6bc6\",\"subnetOutpost\":{},\"subnetStatus\":\"Active\"}],\"vpcId\":\"vpc-73d2e309\"},\"dbInstancePort\":0,\"dbiResourceId\":\"db-DFSLUDXPAQX7Z3OLNXDTAOV5UU\",\"dedicatedLogVolume\":false,\"deletionProtection\":false,\"domainMemberships\":[],\"engine\":\"mysql\",\"engineLifecycleSupport\":\"open-source-rds-extended-support\",\"engineVersion\":\"8.0.39\",\"httpEndpointEnabled\":false,\"iAMDatabaseAuthenticationEnabled\":false,\"licenseModel\":\"general-public-license\",\"masterUsername\":\"admin\",\"monitoringInterval\":0,\"multiAZ\":false,\"networkType\":\"IPV4\",\"optionGroupMemberships\":[{\"optionGroupName\":\"default:mysql-8-0\",\"status\":\"in-sync\"}],\"pendingModifiedValues\":{\"masterUserPassword\":\"HIDDEN_DUE_TO_SECURITY_REASONS\"},\"performanceInsightsEnabled\":false,\"preferredBackupWindow\":\"03:09-03:39\",\"preferredMaintenanceWindow\":\"sun:03:45-sun:04:15\",\"publiclyAccessible\":true,\"readReplicaDBInstanceIdentifiers\":[],\"storageEncrypted\":false,\"storageThroughput\":0,\"storageType\":\"gp2\",\"tagList\":[],\"vpcSecurityGroups\":[{\"status\":\"active\",\"vpcSecurityGroupId\":\"sg-4e483165\"}]},\"sourceIPAddress\":\"216.160.83.56\",\"tlsDetails\":{\"cipherSuite\":\"TLS_AES_128_GCM_SHA256\",\"clientProvidedHostHeader\":\"rds.us-east-1.amazonaws.com\",\"tlsVersion\":\"TLSv1.3\"},\"userAgent\":\"aws-cli/2.17.60 md/awscrt#0.21.2 ua/2.0 os/macos#23.6.0 md/arch#x86_64 lang/python#3.12.6 md/pyimpl#CPython exec-env/grimoire_a8d22859-b414-4964-b4ca-4cd40b399170 cfg/retry-mode#standard md/installer#exe md/prompt#off md/command#rds.restore-db-instance-from-s3\",\"userIdentity\":{\"accessKeyId\":\"ACCESSKEYID\",\"accountId\":\"000000000\",\"arn\":\"arn:aws:iam::000000000:user/test@elastic.co\",\"principalId\":\"PRINCIPALID\",\"type\":\"IAMUser\",\"userName\":\"test@elastic.co\"}}",
                "outcome": "success",
                "provider": "rds.amazonaws.com",
                "type": [
                    "info"
                ]
            },
            "related": {
                "entity": [
                    "sg-4e483165",
                    "subnet-c4bf5e9b",
                    "test@elastic.co",
                    "subnet-0a0bee6c",
                    "subnet-37391109",
                    "arn:aws:iam::000000000:user/test@elastic.co",
                    "subnet-bf6ab5b1",
                    "subnet-8bdf6bc6",
                    "vpc-73d2e309",
                    "ACCESSKEYID",
                    "subnet-fee506df",
                    "test-cloudtrail-event-instance-31611-restored-from-s3",
                    "arn:aws:rds:us-east-1:000000000:db:test-cloudtrail-event-instance-31611-restored-from-s3"
                ],
                "user": [
                    "test@elastic.co"
                ]
            },
            "source": {
                "address": "216.160.83.56",
                "as": {
                    "number": 209
                },
                "geo": {
                    "city_name": "Milton",
                    "continent_name": "North America",
                    "country_iso_code": "US",
                    "country_name": "United States",
                    "location": {
                        "lat": 47.2513,
                        "lon": -122.3149
                    },
                    "region_iso_code": "US-WA",
                    "region_name": "Washington"
                },
                "ip": "216.160.83.56"
            },
            "tags": [
                "preserve_original_event",
                "actor_target_mapping"
            ],
            "target": {
                "entity": {
                    "id": [
                        "arn:aws:rds:us-east-1:000000000:db:test-cloudtrail-event-instance-31611-restored-from-s3"
                    ]
                }
            },
            "tls": {
                "cipher": "TLS_AES_128_GCM_SHA256",
                "client": {
                    "server_name": "rds.us-east-1.amazonaws.com"
                },
                "version": "1.3",
                "version_protocol": "tls"
            },
            "user": {
                "id": "PRINCIPALID",
                "name": "test@elastic.co"
            },
            "user_agent": {
                "device": {
                    "name": "Other"
                },
                "name": "aws-cli",
                "original": "aws-cli/2.17.60 md/awscrt#0.21.2 ua/2.0 os/macos#23.6.0 md/arch#x86_64 lang/python#3.12.6 md/pyimpl#CPython exec-env/grimoire_a8d22859-b414-4964-b4ca-4cd40b399170 cfg/retry-mode#standard md/installer#exe md/prompt#off md/command#rds.restore-db-instance-from-s3",
                "version": "2.17.60"
            }
        },
        {
            "@timestamp": "2021-11-11T01:02:03.123456789Z",
            "ecs": {
                "version": "8.11.0"
            },
            "event": {
                "created": "2021-11-11T01:02:03.123456789Z",
                "kind": "event",
                "outcome": "success",
                "type": [
                    "info"
                ]
            },
            "tags": [
                "preserve_original_event",
                "actor_target_mapping"
            ]
        }
    ]
}
