- name: aws.guardduty
  type: group
  fields:
    - name: arn
      type: keyword
      description: |
        AWS ARN of Finding
    - name: type
      type: keyword
      description: |
        A formatted string representing the type of activity that triggered the finding. For more information, see [GuardDuty finding format](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-format.html).
    - name: title
      type: keyword
      description: |
        
    - name: description
      type: keyword
      description: |

    - name: created_at
      type: date
      description: |
        the time and date when this finding was first created. If this value differs from Updated at, it indicates that the activity has occurred multiple times and is an ongoing issue.
    - name: updated_at
      type: date
      description: |
        The last time this finding was updated with new activity matching the pattern that prompted GuardDuty to generate this finding.
    - name: count
      type: long
      description: |
        The number of times GuardDuty has aggregated an activity matching this pattern to this finding ID.
    - name: detector.id
      type: keyword
      description: |
        The ID of the GuardDuty Detector
    - name: first_seen
      type: date
      description: |
        The first time the event was seen
    - name: last_seen
      type: date
      description: |
        The last time the event was seen
    - name: archived
      type: boolean
      description: |
        Indicates whether this is finding has been archived.
    - name: sample
      type: boolean
      description: |
        Indicates whether this is a sample finding
    - name: action.api
      type: keyword
      description: |
        The name of the API operation that was invoked and thus prompted GuardDuty to generate this finding.
    - name: action.blocked
      type: boolean
      description: |
        Indicates whether the targeted port is blocked.
    - name: action.caller_type
      type: keyword
      description: |
        
    - name: action.error_code
      type: keyword
      description: |
        If the finding was triggered by a failed API call this displays the error code for that call.
    - name: action.service_name
      type: keyword
      description: |
        The DNS name of the service that attempted to make the API call that triggered the finding.
    - name: action.type
      type: keyword
      description: |
        The type of action that triggered the finding
    - name: action.affected_resources
      type: flattened
      description: |
        List of affected AWS resources
    - name: resource.role
      type: keyword
      description: |
        The role of the AWS resource that triggered the finding. This value can be TARGET or ACTOR, and represents whether your resource was the target of the suspicious activity or the actor that preformed the suspicious activity.
    - name: resource.type
      type: keyword
      description: |
        The type of the affected resource. This value is either AccessKey, S3 bucket or Instance. Depending on the resource type, different finding details are available. Select a resource option tab to learn about the details available for that resource.
    - name: resource.access_key.id
      type: keyword
      description: |
        Access key ID of the user engaged in the activity that prompted GuardDuty to generate the finding.
    - name: resource.access_key.principal.id
      type: keyword
      description: |
        The principal ID of the user engaged in the activity that prompted GuardDuty to generate the finding.
    - name: resource.access_key.user.name
      type: keyword
      description: |
        The name of the user engaged in the activity that prompted GuardDuty to generate the finding.
    - name: resource.access_key.user.type
      type: keyword
      description: |
        The type of user engaged in the activity that prompted GuardDuty to generate the finding. For more information, see [CloudTrail userIdentity element](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-user-identity.html#cloudtrail-event-reference-user-identity-fields).
    - name: resource.instance.tags
      type: flattened
      description: |
        A list of tags attached to this resource, listed in the format of key:value.
    - name: resource.instance.iam_instance_profile.arn
      type: keyword
      description: |
        The ARN of the IAM profile assigned to the instance
    - name: resource.instance.iam_instance_profile.id
      type: keyword
      description: |
        The ID of the IAM profile assigned to the instance        
    - name: resource.instance.image.description
      type: keyword
      description: |
        A description of the ID of the Amazon Machine Image used to build the instance involved in the activity.
    - name: resource.instance.image.id
      type: keyword
      description: |
        The ID of the Amazon Machine Image used to build the instance involved in the activity.
    - name: resource.instance.launch_time
      type: date
      description: |
        The time and date the instance was launched.
    - name: resource.instance.outpost_arn
      type: keyword
      description: |
        The Amazon Resource Name (ARN) of the AWS Outposts. Only applicable to AWS Outposts instances. For more information, see [What is AWS Outposts?](https://docs.aws.amazon.com/outposts/latest/userguide/what-is-outposts.html)
    - name: resource.instance.state
      type: keyword
      description: |
        The current state of the targeted instance.
    - name: resource.instance.network_interfaces
      type: nested
      description: |
        Network interface details    
    - name: resource.instance.vpc_id
      type: keyword
      description: |
        VPC ID    
    - name: resource.eks_cluster.arn
      type: keyword
      description: |
        ARN of the EKS cluster
    - name: resource.eks_cluster.status
      type: keyword
      description: |
        Status of the EKS cluster
    - name: resource.eks_cluster.tags
      type: flattened
      description: |
        A list of tags attached to this resource, listed in the format of key:value.        
    - name: resource.eks_cluster.vpc_id
      type: keyword
      description: |
        VPC ID            
    - name: resource.s3
      type: nested
      description: |

        
