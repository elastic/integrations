{
  "id": "sqs-oldest-message",
  "type": "alerting_rule_template",
  "attributes": {
    "name": "[AWS SQS] Oldest Message Age High",
    "tags": ["AWS SQS"],
    "ruleTypeId": ".es-query",
    "schedule": {
      "interval": "1m"
    },
    "params": {
      "searchType": "esqlQuery",
      "timeWindowSize": 15,
      "timeWindowUnit": "m",
      "esqlQuery": {
        "esql": "// The recommended threshold value for oldest message age is >= 300, and the alerting rule is grouped by cloud account id, cloud region and queue name. You can adjust the threshold value by modifying the oldestmsgage value in the WHERE clause.\nFROM metrics-aws.sqs-default\n| STATS oldestmsgage=max(aws.sqs.oldest_message_age.sec) by cloud.account.id, cloud.region, aws.dimensions.QueueName\n| WHERE oldestmsgage >= 300"
      },
      "groupBy": "row",
      "timeField": "event.ingested"
    },
    "alertDelay": {
      "active": 1
    }
  },
  "managed": true,
  "coreMigrationVersion": "8.8.0",
  "typeMigrationVersion": "10.1.0"
}