{
  "id": "sqs-messages-visible",
  "type": "alerting_rule_template",
  "attributes": {
    "name": "[AWS SQS] Messages Visible",
    "tags": ["AWS SQS"],
    "ruleTypeId": ".es-query",
    "schedule": {
      "interval": "1m"
    },
    "params": {
      "searchType": "esqlQuery",
      "timeWindowSize": 15,
      "timeWindowUnit": "m",
      "esqlQuery": {
        "esql": "// The recommended threshold value for messages visible is >= 1000, and the alerting rule is grouped by cloud account id, cloud region and queue name. You can adjust the threshold value by modifying the msgsvisible value in the WHERE clause.\nFROM metrics-aws.sqs-default\n| STATS msgsvisible=max(aws.sqs.messages.visible) by cloud.account.id, cloud.region, aws.dimensions.QueueName\n| WHERE msgsvisible >= 1000"
      },
      "groupBy": "row",
      "timeField": "event.ingested"
    },
    "alertDelay": {
      "active": 1
    }
  },
  "managed": true,
  "coreMigrationVersion": "8.8.0",
  "typeMigrationVersion": "10.1.0"
}