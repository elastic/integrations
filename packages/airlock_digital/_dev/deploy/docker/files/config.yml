rules:
  - path: /v1/logging/exechistories
    methods: ['POST']
    request_body: '{"type":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]}'
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
          X-ApiKey:
            - my-secret-api-key
        body: |
          {{ minify_json `
          {
            "error": "Success",
            "response": {
              "exechistories": [
                {
                  "checkpoint": "firstcheckpoint",
                  "type": 1,
                  "username": "root",
                  "hostname": ".local",
                  "netdomain": ".local",
                  "filename": "/tmp/PKInstallSandbox.mqvKk4/preinstall",
                  "ppolicy": "Airlock Groups",
                  "policyname": "Apple Mac",
                  "policyver": "v485",
                  "commandline": "/bin/sh /tmp/PKInstallSandbox.mqvKk4/Scripts/ /Library/Airlock Digital / /",
                  "publisher": "Airlock Digital Pty Ltd (MXRN6N7XFL) (Mac)",
                  "pprocess": "sh",
                  "sha256": "a3f791dec1f2a40bd623a9b37604e7f2dee84eab3f6a513c6882231d89037c40",
                  "datetime": "2024-04-26T14:50:56Z",
                  "md5": "",
                  "sha128": "",
                  "sha384": "",
                  "sha512": ""
                },
                {
                  "checkpoint": "secondcheckpoint",
                  "type": 2,
                  "username": "antos",
                  "hostname": ".local",
                  "netdomain": ".local",
                  "filename": "/Users/libswift_Concurrency.dylib",
                  "ppolicy": "Airlock Groups",
                  "policyname": "Apple Mac",
                  "policyver": "v485",
                  "commandline": "",
                  "publisher": "Airlock Digital Pty Ltd (MXRN6N7XFL) (Mac)",
                  "pprocess": "Code Helper (Renderer)",
                  "sha256": "00138fe01658ee525ea0cdce387033dfff880985605affbf59d3843ad8a65e56",
                  "datetime": "2024-04-26T15:04:39Z",
                  "md5": "",
                  "sha128": "",
                  "sha384": "",
                  "sha512": ""
                },
                {
                  "checkpoint": "thirdcheckpoint",
                  "type": 3,
                  "username": "devuser",
                  "hostname": ".local",
                  "netdomain": ".local",
                  "filename": "/tmp/PKInstallSandbox.fINk77/Scripts/com.airlock.enforcementagent.core.t6o72s/preinstall",
                  "ppolicy": "Airlock Groups",
                  "policyname": "Apple Mac",
                  "policyver": "v485",
                  "commandline": "/bin/sh /tmp/Library/Airlock Digital / /",
                  "publisher": "Airlock Digital Pty Ltd (MXRN6N7XFL) (Mac)",
                  "pprocess": "sh",
                  "sha256": "a3f791dec1f2a40bd623a9b37604e7f2dee84eab3f6a513c6882231d89037c40",
                  "datetime": "2024-04-26T15:04:45Z",
                  "md5": "",
                  "sha128": "",
                  "sha384": "",
                  "sha512": ""
                }
              ]
            }
          }
          ` }}
  - path: /v1/logging/exechistories
    methods: ['POST']
    request_body: '{"type":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"checkpoint":"thirdcheckpoint"}'
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
          X-ApiKey:
            - my-secret-api-key
        body: |
            {{ minify_json `
            {
              "error": "Success",
              "response": {
                "exechistories": [
                  {
                    "checkpoint": "fourthcheckpoint",
                    "type": 4,
                    "username": "tos",
                    "hostname": ".local",
                    "netdomain": ".local",
                    "filename": "/Users/libswift_Concurrency.dylib",
                    "ppolicy": "Airlock Groups",
                    "policyname": "Apple Mac",
                    "policyver": "v485",
                    "commandline": "",
                    "publisher": "Airlock Digital Pty Ltd (MXRN6N7XFL) (Mac)",
                    "pprocess": "Code Helper (Renderer)",
                    "sha256": "00138fe01658ee525ea0cdce387033dfff880985605affbf59d3843ad8a65e56",
                    "datetime": "2024-04-26T15:06:20Z",
                    "md5": "",
                    "sha128": "",
                    "sha384": "",
                    "sha512": ""
                  },
                  {
                    "checkpoint": "fifthcheckpoint",
                    "type": 5,
                    "username": "admin",
                    "hostname": "macbook.local",
                    "netdomain": "corp.local",
                    "filename": "/tmp/PKInstallSandbox.mock0/preinstall",
                    "ppolicy": "Security Policy",
                    "policyname": "Linux Base",
                    "policyver": "v731",
                    "commandline": "/bin/sh /tmp/PKInstallSandbox.mock0/Scripts/ /Library/Airlock Digital / /",
                    "publisher": "Airlock Digital Pty Ltd (MXRN6N7XFL) (Mac)",
                    "pprocess": "sh",
                    "sha256": "f08d03c46e1a4b55b095c918dcd520f719f1de992a73b174b6c0a1859dbaf263",
                    "datetime": "2024-04-26T14:51:56Z",
                    "md5": "",
                    "sha128": "",
                    "sha384": "",
                    "sha512": ""
                  },
                  {
                    "checkpoint": "sixthcheckpoint",
                    "type": 6,
                    "username": "user1",
                    "hostname": "linuxhost.local",
                    "netdomain": ".local",
                    "filename": "/tmp/PKInstallSandbox.mock1/preinstall",
                    "ppolicy": "Airlock Groups",
                    "policyname": "Apple Mac",
                    "policyver": "v234",
                    "commandline": "/bin/sh /tmp/PKInstallSandbox.mock1/Scripts/ /Library/Airlock Digital / /",
                    "publisher": "Airlock Digital Pty Ltd (MXRN6N7XFL) (Mac)",
                    "pprocess": "sh",
                    "sha256": "a7a1985d2c65915b964dc6a6e78eb26c776172764b36c183f0ea69a5a621d246",
                    "datetime": "2024-04-26T14:52:56Z",
                    "md5": "",
                    "sha128": "",
                    "sha384": "",
                    "sha512": ""
                  }
                ]
              }
            }
            ` }}
  - path: /v1/logging/exechistories
    methods: ['POST']
    request_body: '{"type":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"checkpoint":"sixthcheckpoint"}'
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - application/json
          X-ApiKey:
            - my-secret-api-key
        body: |
          {{ minify_json `
            {
              "error": "Success",
              "response": {
                "exechistories": [
                  {
                    "checkpoint": "seventhcheckpoint",
                    "type": 7,
                    "username": "root",
                    "hostname": ".local",
                    "netdomain": "corp.local",
                    "filename": "/tmp/PKInstallSandbox.mock2/preinstall",
                    "ppolicy": "Default Policy",
                    "policyname": "Windows Core",
                    "policyver": "v678",
                    "commandline": "/bin/sh /tmp/PKInstallSandbox.mock2/Scripts/ /Library/Airlock Digital / /",
                    "publisher": "Airlock Digital Pty Ltd (MXRN6N7XFL) (Mac)",
                    "pprocess": "sh",
                    "sha256": "8f561d9c96427bb89986b75aa0e2314d7ee73eb4201de1ab35fc4c79f2e93b95",
                    "datetime": "2024-04-26T14:53:56Z",
                    "md5": "",
                    "sha128": "",
                    "sha384": "",
                    "sha512": ""
                  },
                  {
                    "checkpoint": "eightcheckpoint",
                    "type": 8,
                    "username": "service",
                    "hostname": "macbook.local",
                    "netdomain": ".local",
                    "filename": "/tmp/PKInstallSandbox.mock3/preinstall",
                    "ppolicy": "Security Policy",
                    "policyname": "Linux Base",
                    "policyver": "v532",
                    "commandline": "/bin/sh /tmp/PKInstallSandbox.mock3/Scripts/ /Library/Airlock Digital / /",
                    "publisher": "Airlock Digital Pty Ltd (MXRN6N7XFL) (Mac)",
                    "pprocess": "sh",
                    "sha256": "d135d274e0618e41730280b6b49f6400c55c9abf9e51929a7d67141ea369edfd",
                    "datetime": "2024-04-26T14:54:56Z",
                    "md5": "",
                    "sha128": "",
                    "sha384": "",
                    "sha512": ""
                  }
                ]
              }
            }
          ` }}
