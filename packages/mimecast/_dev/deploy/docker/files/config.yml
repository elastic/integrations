rules:
  - path: /api/archive/get-archive-search-logs
    methods: ["POST"]
    request_body: '{"meta":{"pagination":{"pageSize":"100","pageToken":"nextToken"}}}'
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"meta":{"pagination":{"pageSize":100,"totalCount":410},"status":200},"data":[{"logs":[{"createTime":"2023-09-01T14:56:42+0000","emailAddr":"dhamilton@dhmc.b41.one","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-01T14:56:41+0000","emailAddr":"dhamilton@dhmc.b41.one","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-01T14:49:07+0000","emailAddr":"dhamilton@dhmc.b41.one","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-01T14:49:00+0000","emailAddr":"dhamilton@dhmc.b41.one","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-01T14:48:57+0000","emailAddr":"dhamilton@dhmc.b41.one","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-01T14:48:50+0000","emailAddr":"dhamilton@dhmc.b41.one","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-08-15T13:16:05+0000","emailAddr":"dhamilton@dhmc.b41.one","source":"archive","searchText":"[Route : outbound]","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-08-02T18:28:56+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"<75117693bccaae9e-67627@hapi.b41.one>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-08-02T18:27:37+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"<75117693bccaae9e-67627@hapi.b41.one>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-08-02T18:16:38+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"<75117693bccaae9e-67627@hapi.b41.one>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-08-02T18:16:29+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"<75117693bccaae9e-67627@hapi.b41.one>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-08-02T18:12:39+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"<75117693bccaae9e-67627@hapi.b41.one>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-08-02T15:53:16+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"<75117693bccaae9e-67627@hapi.b41.one>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-07-19T20:58:43+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"1b471db32c0875e2ec5729e7166f10cec038f47894e88021352ca241782b1bc0 [User : dhamilton@mc-hapi.hamilton321.net]","searchReason":"","description":"Threat Remediation search"},{"createTime":"2023-07-07T15:16:48+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2022-08-01T20:58:33+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2022-06-16T14:20:39+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<291708accd1865c2-148171@nodered-mimecast-55569955-kthgt.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2022-06-15T20:27:20+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<291708accd1865c2-148171@nodered-mimecast-55569955-kthgt.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2022-05-23T14:49:48+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<291708accd1865c2-148171@nodered-mimecast-55569955-kthgt.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2022-04-07T18:36:43+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"<b25df780fef60c8a-4382@nodered-mimecast-55569955-h8cr8.hamilton321.net> [User : dhamilton@mc-hapi.hamilton321.net]","searchReason":"","description":"Threat Remediation search"},{"createTime":"2022-04-07T18:36:02+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"<b25df780fef60c8a-4382@nodered-mimecast-55569955-h8cr8.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2022-04-07T18:26:44+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"<b25df780fef60c8a-4382@nodered-mimecast-55569955-h8cr8.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2022-04-07T14:11:35+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2022-03-17T18:01:04+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2022-03-17T16:01:47+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2022-03-07T14:46:35+0000","emailAddr":"dhamilton@mc-hapi.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2022-02-28T15:50:50+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"special term","searchReason":"","description":"Audit [Page 1] - Depth 100"},{"createTime":"2021-10-06T13:08:06+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-10-06T13:03:02+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-10-06T13:02:29+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-10-05T15:10:35+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"hapi1.hamilton321.net AND !Devin","searchReason":"","description":"Audit [Page 1] - Depth 100"},{"createTime":"2021-10-05T15:09:22+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"hapi1.hamilton321.net AND !Devin","searchReason":"","description":"Audit [Page 1] - Depth 100"},{"createTime":"2021-08-18T15:03:12+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-08-18T14:49:20+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-08-18T14:47:04+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-08-18T14:47:01+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-05-04T22:02:45+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<882aa89.75a1c58-362766@h321a.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-05-04T21:37:58+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<882aa89.75a1c58-362766@h321a.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-05-04T21:37:54+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<882aa89.75a1c58-362766@h321a.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-05-04T19:43:59+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<94877f3c.486f7-124232@h321a.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-05-04T19:43:54+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<94877f3c.486f7-124232@h321a.hamilton321.nett>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-05-04T19:29:57+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<b6c5ea.16f1aa18-133052@h321a.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-05-04T19:27:33+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<b6c5ea.16f1aa18-133052@h321a.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-05-04T19:18:04+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<b6c5ea.16f1aa18-133052@h321a.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-05-04T19:17:37+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<b6c5ea.16f1aa18-133052@h321a.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-05-04T19:17:36+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<b6c5ea.16f1aa18-133052@h321a.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-05-04T19:17:32+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<b6c5ea.16f1aa18-133052@h321a.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-05-04T19:11:15+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<a37bd669.47c928-116878@h321a.hamilton321.net>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-04-08T22:23:45+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"<67311002-1617920404793@us-mta-167.us.mimecast.lan>","searchReason":"","description":"Message Tracking Search"},{"createTime":"2021-03-18T18:35:49+0000","emailAddr":"admin_dhamilton@hapi1.hamilton321.net","source":"archive","searchText":"","searchReason":"","description":"Message Tracking Search"}]}],"fail":[]}
  - path: /api/archive/get-archive-search-logs
    methods: ["POST"]
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"meta":{"pagination":{"pageSize":10,"totalCount":24562,"next":"nextToken"},"status":200},"data":[{"logs":[{"createTime":"2023-09-07T20:00:57+0000","emailAddr":"api-d910278e-3850-4562-9bbb-bc044fe7a994@mc-hapi.hamilton321.net","source":"archive","searchText":"[Status : held]","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-07T20:00:48+0000","emailAddr":"api-d910278e-3850-4562-9bbb-bc044fe7a994@mc-hapi.hamilton321.net","source":"archive","searchText":"[Status : held]","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-07T20:00:38+0000","emailAddr":"api-d910278e-3850-4562-9bbb-bc044fe7a994@mc-hapi.hamilton321.net","source":"archive","searchText":"[Status : held]","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-07T20:00:38+0000","emailAddr":"api-d910278e-3850-4562-9bbb-bc044fe7a994@mc-hapi.hamilton321.net","source":"archive","searchText":"[Status : held]","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-07T20:00:28+0000","emailAddr":"api-d910278e-3850-4562-9bbb-bc044fe7a994@mc-hapi.hamilton321.net","source":"archive","searchText":"[Status : held]","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-07T20:00:27+0000","emailAddr":"api-d910278e-3850-4562-9bbb-bc044fe7a994@mc-hapi.hamilton321.net","source":"archive","searchText":"[Status : held]","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-07T19:57:27+0000","emailAddr":"api-d910278e-3850-4562-9bbb-bc044fe7a994@mc-hapi.hamilton321.net","source":"archive","searchText":"[Status : held]","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-07T19:57:18+0000","emailAddr":"api-d910278e-3850-4562-9bbb-bc044fe7a994@mc-hapi.hamilton321.net","source":"archive","searchText":"[Status : held]","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-07T19:56:29+0000","emailAddr":"api-d910278e-3850-4562-9bbb-bc044fe7a994@mc-hapi.hamilton321.net","source":"archive","searchText":"[Status : held]","searchReason":"","description":"Message Tracking Search"},{"createTime":"2023-09-07T19:56:17+0000","emailAddr":"api-d910278e-3850-4562-9bbb-bc044fe7a994@mc-hapi.hamilton321.net","source":"archive","searchText":"[Status : held]","searchReason":"","description":"Message Tracking Search"}]}],"fail":[]}
  - path: /api/audit/get-audit-events
    methods: ["POST"]
    request_body: /^\{"data":\[{"endDateTime":"(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})[+-](\d{4})","startDateTime":"2021-11-16T12:03:24\+0000"}],"meta":{"pagination":{"pageSize":"100"}}\}/
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"meta": {"status": 200,"pagination": {"pageSize": 1}},"data": [{"id": "eNqrVipOTS4tSs1MUbJSyi1Mjgw1N6tIq6p0Kko0LCj2CS1NdAtL89c2DXZ1C3eP7AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhmoKOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP0_JyrAWAIWmLGo","auditType": "Threat Intel Feed Download","user": "johndoe@example.com","eventTime": "2021-11-17T12:04:24+0000","eventInfo": "Threat intel multiple feeds download  - malware_grid_csv_20211116120324398.zip, Date: 2021-11-17, Time: 12:04:24+0000, IP: 8.8.8.8, Application: Integrations","category": "reporting_logs"}], "fail":[]}
  - path: /api/audit/get-audit-events
    methods: ["POST"]
    request_body: '{"meta":{"pagination":{"pageSize":"100","pageToken":"nextToken"}}}'
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"meta": {"status": 200,"pagination": {"pageSize": 10}},"data": [{"id": "eNqrVipOTS4tSs1MUbJSyi1Mjgw1N6tIq6p0Kko0LCj2CS1NdAtL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhmoKOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP0_JyrAWAIWmLGo","auditType": "Threat Intel Feed Download","user": "johndoe@example.com","eventTime": "2021-11-17T12:03:24+0000","eventInfo": "Threat intel multiple feeds download  - malware_grid_csv_20211116120324398.zip, Date: 2021-11-17, Time: 12:03:24+0000, IP: 8.8.8.8, Application: Integrations","category": "reporting_logs"},{"id": "eNqrVipOTS4tSs1MUbJSCndJ8ihLdgou9ncyz3NxcjRN80r0NgxL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhqoaOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP0_JyrAWAADXK1M","auditType": "Threat Intel Feed Download","user": "azuresentinel_api_service_account@example.com","eventTime": "2021-11-16T12:03:16+0000","eventInfo": "Threat intel multiple feeds download  - malware_grid_csv_20211116120316756.zip, Date: 2021-11-16, Time: 12:03:16+0000, IP: 8.8.8.8, Application: Azure Sentinel","category": "reporting_logs"},{"id": "eNqrVipOTS4tSs1MUbJS8vYOCjX2LfV3dSuzMDcoKyvMNjZPCgtL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhqpKOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP0_JyrAWAAwiK3M","auditType": "Threat Intel Feed Download","user": "johndoe@example.com","eventTime": "2021-11-16T12:03:00+0000","eventInfo": "Threat intel multiple feeds download  - malware_customer_csv_20211116120300300.zip, Date: 2021-11-16, Time: 12:03:00+0000, IP: 8.8.8.8, Application: Integrations","category": "reporting_logs"},{"id": "eNqrVipOTS4tSs1MUbJS8nbzNE3x145IjtKuqDDyNzf2sAitCAtL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhqqKOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP1_JyrAWAODxKwI","auditType": "Threat Intel Feed Download","user": "johndoe@example.com","eventTime": "2021-11-16T12:03:00+0000","eventInfo": "Threat intel multiple feeds download  - malware_customer_csv_20211116120300285.zip, Date: 2021-11-16, Time: 12:03:00+0000, IP: 8.8.8.8, Application: Integrations","category": "reporting_logs"},{"id": "eNqrVipOTS4tSs1MUbJS8nfOMCkrzAv1SAwtTnFJNjJ1TE-3MAxL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhioaOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP1_JyrAWACRNK5A","auditType": "Review Set Action","user": "johndoe@example.com","eventTime": "2021-11-16T12:02:44+0000","eventInfo": "Viewed Review Set Details - Case: GDPR/CCPA, Review Set: Supervision - hot words, Date: 2021-11-16, Time: 12:02:44+0000, IP: 8.8.8.8, Application: mimecast-case-review","category": "case_review_logs"},{"id": "eNqrVipOTS4tSs1MUbJS8vYorCw2z4gM8A4PLc-pCMlJL4rRN3cLS_PXNg12dQt3j_QMr4oyi_SO0Xf1jswtM7TINncxTNTO97OsNPQqqAwNU9JRSixNySzJyU8HmWhsaGlhbGJoYqyjlFxaXJKfm1qUnJ-SCrTK2cTM0dwUqLwstag4Mz0PycqwFgCafSyD","auditType": "Threat Intel Feed Download","user": "johndoe@example.com","eventTime": "2021-11-16T12:02:00+0000","eventInfo": "Threat intel multiple feeds download  - malware_customer_csv_20211116120200376.zip, Date: 2021-11-16, Time: 12:02:00+0000, IP: 8.8.8.8, Application: Integrations","category": "reporting_logs"},{ "id": "eNqrVipOTS4tSs1MUbJSSjJNyi1xNgovr8rNTM-I0Y9yznRzc8wJS_PXNg12dQt3j_QMr4oyi_SO0Xf1jswtM7TINncxTNTO97OsNPQqqAwNU9JRSixNySzJyU8HmWhsaGlhbGJoYqSjlFxaXJKfm1qUnJ-SCrTK2cTM0dwUqLwstag4Mz0PycqwFgCJWSxd", "auditType": "Threat Intel Feed Download", "user": "johndoe@example.com", "eventTime": "2021-11-16T12:02:00+0000", "eventInfo": "Threat intel multiple feeds download - malware_customer_csv_20211116120200267.zip, Date: 2021-11-16, Time: 12:02:00+0000, IP: 8.8.8.8, Application: Integrations", "category": "reporting_logs" }, { "id": "eNqrVipOTS4tSs1MUbJSSg_xMDJPNkisSDdISQ00j0gzz44wDAtL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhkoaOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP1_JyrAWAAjKK1o", "auditType": "Search Action", "user": "johndoe@example.com", "eventTime": "2021-11-16T12:01:37+0000", "eventInfo": "Inspected Review Set Messages - Source: Review Set - Supervision - hot words, Case - GDPR/CCPA, Message Status: Pending, Date: 2021-11-16, Time: 12:01:37+0000, IP: 8.8.8.8, Application: mimecast-case-review", "category": "case_review_logs" }, { "id": "eNqrVipOTS4tSs1MUbJSskwzjDIMyDRKLinNSEl1c0pOqXLJyQlL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhkrqOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP1_JyrAWAE_sLAI", "auditType": "Case Action", "user": "johndoe@example.com", "eventTime": "2021-11-16T12:01:37+0000", "eventInfo": "Viewed Case - Case: GDPR/CCPA, Date: 2021-11-16, Time: 12:01:37+0000, IP: 8.8.8.8, Application: mimecast-case-review", "category": "case_review_logs" }, { "id": "eNqrVipOTS4tSs1MUbJSKvWJ8vPMCg8tTwoMC64wMCyIKossNQxL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhkpqOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP1_JyrAWAFqfLAw", "auditType": "Review Set Action", "user": "johndoe@example.com", "eventTime": "2021-11-16T12:01:37+0000", "eventInfo": "Viewed Review Set Details - Case: GDPR/CCPA, Review Set: Supervision - hot words, Date: 2021-11-16, Time: 12:01:37+0000, IP: 8.8.8.8, Application: mimecast-case-review", "category": "case_review_logs" }], "fail":[]}
  - path: /api/audit/get-audit-events
    methods: ["POST"]
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"meta":{"status":200,"pagination":{"pageSize":10,"totalCount": 20, "next":"nextToken"}},"data":[{"id":"eNqrVipOTS4tSs1MUbJSyi1Mjgw1N6tIq6p0Kko0LCj2CS1NdAtL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhmoKOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP0_JyrAWAIWmLGa","auditType":"Threat Intel Feed Download","user":"johndoe@example.com","eventTime":"2021-11-16T12:03:24+0000","eventInfo":"Threat intel multiple feeds download  - malware_grid_csv_20211116120324398.zip, Date: 2021-11-16, Time: 12:03:24+0000, IP: 8.8.8.8, Application: Integrations","category":"reporting_logs"},{"id":"eNqrVipOTS4tSs1MUbJSCndJ8ihLdgou9ncyz3NxcjRN80r0NgxL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhqoaOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP0_JyrAWAADXK0N","auditType":"Threat Intel Feed Download","user":"azuresentinel_api_service_account@example.com","eventTime":"2021-11-16T12:03:16+0000","eventInfo":"Threat intel multiple feeds download  - malware_grid_csv_20211116120316756.zip, Date: 2021-11-16, Time: 12:03:16+0000, IP: 8.8.8.8, Application: Azure Sentinel","category":"reporting_logs"},{"id":"eNqrVipOTS4tSs1MUbJS8vYOCjX2LfV3dSuzMDcoKyvMNjZPCgtL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhqpKOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP0_JyrAWAAwiK2P","auditType":"Threat Intel Feed Download","user":"johndoe@example.com","eventTime":"2021-11-16T12:03:00+0000","eventInfo":"Threat intel multiple feeds download  - malware_customer_csv_20211116120300300.zip, Date: 2021-11-16, Time: 12:03:00+0000, IP: 8.8.8.8, Application: Integrations","category":"reporting_logs"},{"id":"eNqrVipOTS4tSs1MUbJS8nbzNE3x145IjtKuqDDyNzf2sAitCAtL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhqqKOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP0_JyrAWAODxKwJ","auditType":"Threat Intel Feed Download","user":"johndoe@example.com","eventTime":"2021-11-16T12:03:00+0000","eventInfo":"Threat intel multiple feeds download  - malware_customer_csv_20211116120300285.zip, Date: 2021-11-16, Time: 12:03:00+0000, IP: 8.8.8.8, Application: Integrations","category":"reporting_logs"},{"id":"eNqrVipOTS4tSs1MUbJS8nfOMCkrzAv1SAwtTnFJNjJ1TE-3MAxL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhioaOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP0_JyrAWACRNK5A","auditType":"Review Set Action","user":"johndoe@example.com","eventTime":"2021-11-16T12:02:44+0000","eventInfo":"Viewed Review Set Details - Case: GDPR/CCPA, Review Set: Supervision - hot words, Date: 2021-11-16, Time: 12:02:44+0000, IP: 8.8.8.8, Application: mimecast-case-review","category":"case_review_logs"},{"id":"eNqrVipOTS4tSs1MUbJS8vYorCw2z4gM8A4PLc-pCMlJL4rRN3cLS_PXNg12dQt3j_QMr4oyi_SO0Xf1jswtM7TINncxTNTO97OsNPQqqAwNU9JRSixNySzJyU8HmWhsaGlhbGJoYqyjlFxaXJKfm1qUnJ-SCrTK2cTM0dwUqLwstag4Mz9PycqwFgCafSyE","auditType":"Threat Intel Feed Download","user":"johndoe@example.com","eventTime":"2021-11-16T12:02:00+0000","eventInfo":"Threat intel multiple feeds download  - malware_customer_csv_20211116120200376.zip, Date: 2021-11-16, Time: 12:02:00+0000, IP: 8.8.8.8, Application: Integrations","category":"reporting_logs"},{"id":"eNqrVipOTS4tSs1MUbJSSjJNyi1xNgovr8rNTM-I0Y9yznRzc8wJS_PXNg12dQt3j_QMr4oyi_SO0Xf1jswtM7TINncxTNTO97OsNPQqqAwNU9JRSixNySzJyU8HmWhsaGlhbGJoYqSjlFxaXJKfm1qUnJ-SCrTK2cTM0dwUqLwstag4Mz9PycqwFgCJWSyd","auditType":"Threat Intel Feed Download","user":"johndoe@example.com","eventTime":"2021-11-16T12:02:00+0000","eventInfo":"Threat intel multiple feeds download  - malware_customer_csv_20211116120200267.zip, Date: 2021-11-16, Time: 12:02:00+0000, IP: 8.8.8.8, Application: Integrations","category":"reporting_logs"},{"id":"eNqrVipOTS4tSs1MUbJSSg_xMDJPNkisSDdISQ00j0gzz44wDAtL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhkoaOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP0_JyrAWAAjKK2o","auditType":"Search Action","user":"johndoe@example.com","eventTime":"2021-11-16T12:01:37+0000","eventInfo":"Inspected Review Set Messages - Source: Review Set - Supervision - hot words, Case - GDPR/CCPA, Message Status: Pending, Date: 2021-11-16, Time: 12:01:37+0000, IP: 8.8.8.8, Application: mimecast-case-review","category":"case_review_logs"},{"id":"eNqrVipOTS4tSs1MUbJSskwzjDIMyDRKLinNSEl1c0pOqXLJyQlL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhkrqOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP0_JyrAWAE_sLBI","auditType":"Case Action","user":"johndoe@example.com","eventTime":"2021-11-16T12:01:37+0000","eventInfo":"Viewed Case - Case: GDPR/CCPA, Date: 2021-11-16, Time: 12:01:37+0000, IP: 8.8.8.8, Application: mimecast-case-review","category":"case_review_logs"},{"id":"eNqrVipOTS4tSs1MUbJSKvWJ8vPMCg8tTwoMC64wMCyIKossNQxL89c2DXZ1C3eP9AyvijKL9I7Rd_WOzC0ztMg2dzFM1M73s6w09CqoDA1T0lFKLE3JLMnJTwcZaGxoaWFsYmhkpqOUXFpckp-bWpScn5IKtMnZxMzR3BSovCy1qDgzP0_JyrAWAFqfLBw","auditType":"Review Set Action","user":"johndoe@example.com","eventTime":"2021-11-16T12:01:37+0000","eventInfo":"Viewed Review Set Details - Case: GDPR/CCPA, Review Set: Supervision - hot words, Date: 2021-11-16, Time: 12:01:37+0000, IP: 8.8.8.8, Application: mimecast-case-review","category":"case_review_logs"}],"fail":[]}
  - path: /api/dlp/get-logs
    methods: ["POST"]
    request_body: /^\{"data":\[{"from":"2021-11-18T21:41:25\+0000","to":"(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})[+-](\d{4})"}]\}/
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"meta": { "status": 200, "pagination": { "pageSize": 10} }, "data":[{ "dlpLogs": [ { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:45:25+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "notification", "messageId": "<20211118214122.A79CE10021D@mail.emailsec.ninja>" }]}], "fail": []}
  - path: /api/dlp/get-logs
    methods: ["POST"]
    request_body: '{"meta":{"pagination":{"pageToken":"nextToken"}}}'
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"meta": { "status": 200, "pagination": { "pageSize": 10} }, "data":[{ "dlpLogs": [ { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:25+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "notification", "messageId": "<20211118214122.A79CE10021D-1@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:25+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "hold", "messageId": "<20211118214122.A79CE10021D-1@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:24+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "notification", "messageId": "<20211118214121.2618D10021B-1@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:24+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "hold", "messageId": "<20211118214121.2618D10021B-1@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:22+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "notification", "messageId": "<20211118214119.9F8FF10021D-1@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:22+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "hold", "messageId": "<20211118214119.9F8FF10021D-1@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:20+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "notification", "messageId": "<20211118214117.CD20510021B-1@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:20+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "hold", "messageId": "<20211118214117.CD20510021B-1@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:18+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "notification", "messageId": "<20211118214115.B346F10021D-1@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:18+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "hold", "messageId": "<20211118214115.B346F10021D-1@mail.emailsec.ninja>" } ] } ], "fail": []}
  - path: /api/dlp/get-logs
    methods: ["POST"]
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"meta": { "status": 200, "pagination": { "pageSize": 10, "next": "nextToken"} },"data":[{ "dlpLogs": [ { "senderAddress": "<>", "recipientAddress": "jondoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:25+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "notification", "messageId": "<20211118214122.A79CE10021D-2@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:25+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "hold", "messageId": "<20211118214122.A79CE10021D-2@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:24+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "notification", "messageId": "<20211118214121.2618D10021B-2@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:24+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "hold", "messageId": "<20211118214121.2618D10021B-2@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:22+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "notification", "messageId": "<20211118214119.9F8FF10021D-2@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:22+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "hold", "messageId": "<20211118214119.9F8FF10021D-2@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:20+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "notification", "messageId": "<20211118214117.CD20510021B-2@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:20+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "hold", "messageId": "<20211118214117.CD20510021B-2@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:18+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "notification", "messageId": "<20211118214115.B346F10021D-2@mail.emailsec.ninja>" }, { "senderAddress": "<>", "recipientAddress": "johndoe@example.com", "subject": "Undelivered Mail Returned to Sender", "eventTime": "2021-11-18T21:41:18+0000", "route": "inbound", "policy": "Content Inspection - Watermark", "action": "hold", "messageId": "<20211118214115.B346F10021D-2@mail.emailsec.ninja>" } ] } ], "fail": []}
  - path: /api/audit/get-siem-logs
    methods: ["POST"]
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/octet-stream"
        body: |
          {{file "/files/siem.zip"}}
  - path: /api/ttp/threat-intel/get-feed
    methods: ["POST"]
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |
          {"type":"bundle","id":"bundle--0ea0ae62-5d43-4ec5-babc-1fc4479e03ba","spec_version":"2.0","objects":[{"type":"malware","id":"malware--44c9d067-12c2-439a-a314-29652b158159","created":"2021-11-19T01:28:37.099Z","modified":"2021-11-19T01:28:37.099Z","name":"Transaction notice","labels":["virus"]},{"type":"indicator","id":"indicator--456ac916-4c4e-43be-b7a9-6678f6a845cd","created":"2021-11-19T01:28:37.099Z","modified":"2021-11-19T01:28:37.099Z","labels":["malicious-activity"],"pattern":"[file:hashes.'SHA-256' = 'ec5a6c52acdc187fc6c1187f14cd685c686c2b283503a023c4a9d3a977b491be']","valid_from":"2021-11-19T01:28:37.099Z"},{"type":"relationship","id":"relationship--6f2459e4-4fbd-457a-ba79-0237beb99055","created":"2021-11-19T01:28:37.099Z","modified":"2021-11-19T01:28:37.099Z","relationship_type":"indicates","source_ref":"indicator--456ac916-4c4e-43be-b7a9-6678f6a845cd","target_ref":"malware--44c9d067-12c2-439a-a314-29652b158159"}]}
  - path: /api/ttp/threat-intel/get-feed
    methods: ["POST"]
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"type":"bundle","id":"bundle--0ea0ae62-5d43-4ec5-babc-1fc4479e03ba","spec_version":"2.0","objects":[{"type":"malware","id":"malware--44c9d067-12c2-439a-a314-29652b158159","created":"2021-11-19T01:28:37.099Z","modified":"2021-11-19T01:28:37.099Z","name":"Transaction notice","labels":["virus"]},{"type":"indicator","id":"indicator--456ac916-4c4e-43be-b7a9-6678f6a845cd","created":"2021-11-19T01:28:36.099Z","modified":"2021-11-19T01:28:37.099Z","labels":["malicious-activity"],"pattern":"[file:hashes.'SHA-256' = 'ec5a6c52acdc187fc6c1187f14cd685c686c2b283503a023c4a9d3a977b491be']","valid_from":"2021-11-19T01:28:37.099Z"},{"type":"relationship","id":"relationship--6f2459e4-4fbd-457a-ba79-0237beb99055","created":"2021-11-19T01:28:37.099Z","modified":"2021-11-19T01:28:37.099Z","relationship_type":"indicates","source_ref":"indicator--456ac916-4c4e-43be-b7a9-6678f6a845cd","target_ref":"malware--44c9d067-12c2-439a-a314-29652b158159"}]}
  - path: /api/ttp/attachment/get-logs
    methods: ["POST"]
    request_body: /^\{"data":\[{"from":"2021-11-24T11:54:28\+0000","oldestFirst":false,"result":"all","route":"all","to":"(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})[+-](\d{4})"}]\}/
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |
          {"fail":[],"meta":{"status":200,"pagination":{"pageSize":500}},"data":[{"attachmentLogs":[{"result":"safe","date":"2021-11-24T11:54:30+0000","senderAddress":"<>","fileName":"Datasheet_Mimecast Targeted Threat Protection + Internal Email Protect (2).pdf","actionTriggered":"user release, none","route":"inbound","details":"Safe\r\nTime taken: 0 hrs, 0 min, 7 sec","recipientAddress":"johndoe@emample.com","fileType":"application\/pdf","subject":"Test Files","fileHash":"cabd7cb6e1822fd9e1fc9bcf144ee26ee6bfc855c4574ca967dd53dcc36a1254","messageId":"<0-CAKUQxhimsCd1bvWQVs14Amuh1+Hnw_bmSuA7ot8hy4eDa8_ziQ@mail.gmail.com>","definition":"Inbound - Safe file with On-Demand Sandbox"}]}]}
  - path: /api/ttp/attachment/get-logs
    methods: ["POST"]
    request_body: '{"meta":{"pagination":{"pageToken":"next"}}}'
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |
          {"fail":[],"meta":{"status":200,"pagination":{"pageSize":500}},"data":[{"attachmentLogs":[{"result":"safe","date":"2021-11-24T11:54:27+0000","senderAddress":"<>","fileName":"Datasheet_Mimecast Targeted Threat Protection + Internal Email Protect (2).pdf","actionTriggered":"user release, none","route":"inbound","details":"Safe\r\nTime taken: 0 hrs, 0 min, 7 sec","recipientAddress":"johndoe@emample.com","fileType":"application\/pdf","subject":"Test Files","fileHash":"cabd7cb6e1822fd9e1fc9bcf144ee26ee6bfc855c4574ca967dd53dcc36a1254","messageId":"<1-CAKUQxhimsCd1bvWQVs14Amuh1+Hnw_bmSuA7ot8hy4eDa9_ziQ@mail.gmail.com>","definition":"Inbound - Safe file with On-Demand Sandbox"}]}]}
  - path: /api/ttp/attachment/get-logs
    methods: ["POST"]
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"fail":[],"meta":{"status":200,"pagination":{"pageSize":500,"next":"next"}},"data":[{"attachmentLogs":[{"result":"safe","date":"2021-11-24T11:54:28+0000","senderAddress":"<>","fileName":"Datasheet_Mimecast Targeted Threat Protection + Internal Email Protect (2).pdf","actionTriggered":"user release, none","route":"inbound","details":"Safe\r\nTime taken: 0 hrs, 0 min, 7 sec","recipientAddress":"johndoe@emample.com","fileType":"application\/pdf","subject":"Test Files","fileHash":"cabd7cb6e1822fd9e1fc9bcf144ee26ee6bfc855c4574ca967dd53dcc36a1254","messageId":"<2-CAKUQxhimsCd1bvWQVs14Amuh1+Hnw_bmSuA7ot8hy4eDa9_ziQ@mail.gmail.com>","definition":"Inbound - Safe file with On-Demand Sandbox"}]}]}
  - path: /api/ttp/impersonation/get-logs
    methods: ["POST"]
    request_body: /^\{"data":\[{"from":"2021-11-12T15:27:15\+0000","oldestFirst":false,"to":"(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})[+-](\d{4})"}]\}/
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |
          {"meta": { "status": 200, "pagination": { "pageSize": 10, "totalCount": 20} }, "data": [ { "impersonationLogs": [ { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzCw1FEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFBGQVEhg", "senderAddress": "johndoe@example.com", "recipientAddress": "johdoejr@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:30:15+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_nu@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<0-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.prod.outlook.com>" } ], "resultCount": 36 } ], "fail": [] }
  - path: /api/ttp/impersonation/get-logs
    methods: ["POST"]
    request_body: '{"meta":{"pagination":{"pageToken":"nextToken"}}}'
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |
          {"meta": { "status": 200, "pagination": { "pageSize": 10, "totalCount": 20} }, "data": [ { "impersonationLogs": [ { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzCw1FEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFBGQVEhg", "senderAddress": "johndoe@example.com", "recipientAddress": "johdoejr@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:15+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_nu@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<1-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.prod.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzCw0FEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGP7Ehc", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoejr@exampple.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:14+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_nu@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<2-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzAw11EqSy0qzszPU8Iy1FEqyQMrBIor1QIAY98SFg", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoejr@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:14+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_nu@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<3-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM4MzAw01EqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGPEEhU", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoe@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:14+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_nu@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<4-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM4MzAw1VEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGOpEhQ", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoejr@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:10+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_nu@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<5-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzAw2FEqSy0qzszPU7ICskvywAoNDMyVagFjPRIQ", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoejr@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:06+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<6-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM1N1XSUcpMUbIyMjM3MzAw0VEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGOOEhM", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoejr@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:06+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<7-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM3N1XSUcpMUbIyMjM3MzAw0lEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGNYEhE", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoejr@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:06+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<8-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM7N1XSUcpMUbIyMjM3MzAw1lEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGNzEhI", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoe@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:05+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<9-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM9MzAw0FEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGMiEg8", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoejr@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:04+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<10-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" } ], "resultCount": 36 } ], "fail": [] }
  - path: /api/ttp/impersonation/get-logs
    methods: ["POST"]
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"meta": { "status": 200, "pagination": { "pageSize": 10, "totalCount": 20,"next": "nextToken"} }, "data": [ { "impersonationLogs": [ { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzCw1FEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGQVEhg", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoejr@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:15+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<11-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.prod.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzCw0FEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGP6Ehc", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoejr@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:14+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<12-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzAw11EqSy0qzszPU7Iy1FEqyQMrBIor1QIAY98SFg", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoe@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:14+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<13-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzAw01EqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGPEEhU", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoejr@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:14+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<14-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzAw1VEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGOpEhQ", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoe@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:10+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<15-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzAw1FEqSy0qzszPU7ICskvywAoNDMyVagFjPRIQ", "senderAddress": "johndoe@example.com", "recipientAddress": "testsite@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:06+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<16-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzAw0VEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGOOEhM", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoe@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:06+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<17-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzAw0lEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGNYEhE", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoe@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:06+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<18-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzAw1lEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGNzEhI", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoejr@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:05+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<19-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.example.outlook.com>" }, { "id": "MTOKEN:eNqrVkouLS7Jz00tSs5PSVWyUnI2MXM0N1XSUcpMUbIyMjM3MzAw0FEqSy0qzszPU7Iy1FEqyQMrNDAwV6oFAGMiEg8", "senderAddress": "johndoe@example.com", "recipientAddress": "johndoe@example.com", "subject": "Don't read, just fill out!", "definition": "IP - 1 hit (Tag email)", "hits": 1, "identifiers": [ "internal_user_name" ], "action": "none", "taggedExternal": false, "taggedMalicious": true, "senderIpAddress": "8.8.8.8", "eventTime": "2021-11-12T15:27:04+0000", "impersonationResults": [ { "impersonationDomainSource": "internal_user_name", "similarDomain": "John Doe <johndoe_cdw@example.com>", "stringSimilarToDomain": "John Doe", "checkerResult": "hit" } ], "messageId": "<20-MN2PR16MB2719879CA4DB60C265F7FD8FB0959@MN2PR16MB2719.namprd16.prod.outlook.com>" } ], "resultCount": 36 } ], "fail": [] }
  - path: /api/ttp/url/get-logs
    methods: ["POST"]
    request_body: /^\{"data":\[{"from":"2021-11-10T08:55:53\+0000","oldestFirst":false,"route":"all","scanResult":"all","to":"(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})[+-](\d{4})"}]\}/
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"meta":{"status":200,"pagination":{"pageSize":10,"totalCount":20}},"data":[{"clickLogs":[{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.com/alerts/feeds/00259755281018227146/14369994449842858162","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - dollar","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"N/A","date":"2021-11-10T08:55:53+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<0-0000000000004109b705d06b609c@google.com>"}]}],"fail":[]}
  - path: /api/ttp/url/get-logs
    methods: ["POST"]
    request_body: '{"meta":{"pagination":{"pageToken":"nextToken"}}}'
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"meta":{"status":200,"pagination":{"pageSize":10,"totalCount":20}},"data":[{"clickLogs":[{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.com/alerts/feeds/00259755281018227146/14369994449842858162","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - dollar","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"N/A","date":"2021-11-10T08:55:53+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<1-0000000000004109b705d06b609c@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.co.za/alerts?source=alertsmail&hl=en&gl=US&msgid=MTgzMTU0Mzc2MTA3OTY3MzIxNw&s=AB2Xq4g-GUg7dJreWJN14pFdqYo0nYsyiVX2dK8&ffu=","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - china","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T08:50:37+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<2-00000000000079a99a05d06b4d20@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.com/url?rct=j&sa=t&url=https://texassports.com/news/2021/11/10/no-5-5-mens-basketball-tops-houston-baptist-in-season-opener-92-48.aspx&ct=ga&cd=CAEYACoUMTEzMjI3MjkwNzM0OTE1Nzg0NDMyHGMzNzg3MjBmODY3MWM2MGY6Y29tOmVuOlVTOkw&usg=AFQjCNG4_460IiZmbwJkDzkFkQC5-htSxw","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - news","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T08:28:18+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<3-0000000000005fa4e905d06afd8f@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.co.za/alerts/feedback?ffu=https://www.ft.com/content/4d61fac4-e3f3-401b-bca2-6e94ff47e2cc&source=alertsmail&hl=en&gl=US&msgid=MTM1OTYyMDAwNTE0MzU3NjA0NjI&s=AB2Xq4g-GUg7dJreWJN14pFdqYo0nYsyiVX2dK8","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - china","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T07:50:16+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<4-000000000000eb13ab05d06a76fc@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.com/alerts/feedback?ffu=https://www.fox7austin.com/news/search-for-suspect-involved-in-aggravated-robbery-at-family-dollar&source=alertsmail&hl=en&gl=US&msgid=ODM0MDY5Nzg2NzI3NDkxMjUwNg&s=AB2Xq4i7OaFz4ss3vFU-wNb0DTELEKxhyDdFl54","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - dollar","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T06:55:34+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<5-0000000000001ddf7205d069b36e@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.co.za/alerts?source=alertsmail&hl=en&gl=US&msgid=NDgxNzM4MzYwOTM2NzY1MDg2Ng","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - china","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T06:50:16+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<6-000000000000567c2105d069a0ce@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.com/alerts/share?hl=en&gl=US&ru=https://www.ctvnews.ca/world/judge-denies-trump-s-overnight-request-for-injunction-in-executive-privilege-case-1.5658613&ss=tw&rt=Judge+denies+Trump%27s+overnight+request+for+injunction+in+executive+privilege+case+%7C+CTV+News&cd=KhM2MTQ1MDcxODY2MDQ5NTY2MDk2Mhw1MzNlMDE2OWZhYWUyMDBkOmNvbTplbjpVUzpM&ssp=AMJHsmXlnSoHb_ZABC-riiVXrxFyWhlMpQ","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - Trump","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T05:11:56+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<7-000000000000e78cfa05d0683fab@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.com/alerts?s=AB2Xq4i7OaFz4ss3vFU-wNb0DTELEKxhyDdFl54&start=1636516479&end=1636520078&source=alertsmail&hl=en&gl=US&msgid=MTMyNTI1OTY4MzI3OTI0NDc4MTU#history","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - dollar","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T04:55:34+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<8-000000000000f2696405d0680583@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.gstati","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - dollar","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Unknown","sendingIp":"8.8.8.8","userAwarenessAction":"N/A","date":"2021-11-10T03:55:09+0000","actions":"Browser Isolation","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<9-00000000000065020205d0672f01@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.co.za/alerts/share?hl=en&gl=US&ru=https://www.wsj.com/articles/u-s-tests-israels-iron-dome-in-guam-as-defense-against-chinese-cruise-missiles-11636455224&ss=tw&rt=U.S.+Tests+Israel%27s+Iron+Dome+in+Guam+as+Defense+Against+Chinese+Cruise+Missiles+-+WSJ&cd=KhQxNzg2NTc5NDQ3ODIzODUyNjI5NzIcZmQ4N2VjYzkxMGIxMWE4Yzpjby56YTplbjpVUw&ssp=AMJHsmW3CCK1S4TNPifSXszcyaNMwd6TDg","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - china","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T03:49:53+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<10-000000000000a02a0a05d0671c06@google.com>"}]}],"fail":[]}
  - path: /api/ttp/url/get-logs
    methods: ["POST"]
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {"meta":{"status":200,"pagination":{"pageSize":10,"totalCount":20,"next": "nextToken"}},"data":[{"clickLogs":[{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.com/alerts/feeds/00259755281018227146/14369994449842858162","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - dollar","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"N/A","date":"2021-11-10T08:55:53+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<11-0000000000004109b705d06b609c@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.co.za/alerts?source=alertsmail&hl=en&gl=US&msgid=MTgzMTU0Mzc2MTA3OTY3MzIxNw&s=AB2Xq4g-GUg7dJreWJN14pFdqYo0nYsyiVX2dK8&ffu=","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - china","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T08:50:37+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<12-00000000000079a99a05d06b4d20@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.com/url?rct=j&sa=t&url=https://texassports.com/news/2021/11/10/no-5-5-mens-basketball-tops-houston-baptist-in-season-opener-92-48.aspx&ct=ga&cd=CAEYACoUMTEzMjI3MjkwNzM0OTE1Nzg0NDMyHGMzNzg3MjBmODY3MWM2MGY6Y29tOmVuOlVTOkw&usg=AFQjCNG4_460IiZmbwJkDzkFkQC5-htSxw","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - news","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T08:28:18+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<13-0000000000005fa4e905d06afd8f@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.co.za/alerts/feedback?ffu=https://www.ft.com/content/4d61fac4-e3f3-401b-bca2-6e94ff47e2cc&source=alertsmail&hl=en&gl=US&msgid=MTM1OTYyMDAwNTE0MzU3NjA0NjI&s=AB2Xq4g-GUg7dJreWJN14pFdqYo0nYsyiVX2dK8","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - china","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T07:50:16+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<14-000000000000eb13ab05d06a76fc@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.com/alerts/feedback?ffu=https://www.fox7austin.com/news/search-for-suspect-involved-in-aggravated-robbery-at-family-dollar&source=alertsmail&hl=en&gl=US&msgid=ODM0MDY5Nzg2NzI3NDkxMjUwNg&s=AB2Xq4i7OaFz4ss3vFU-wNb0DTELEKxhyDdFl54","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - dollar","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T06:55:34+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<15-0000000000001ddf7205d069b36e@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.co.za/alerts?source=alertsmail&hl=en&gl=US&msgid=NDgxNzM4MzYwOTM2NzY1MDg2Ng","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - china","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T06:50:16+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<16-000000000000567c2105d069a0ce@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.com/alerts/share?hl=en&gl=US&ru=https://www.ctvnews.ca/world/judge-denies-trump-s-overnight-request-for-injunction-in-executive-privilege-case-1.5658613&ss=tw&rt=Judge+denies+Trump%27s+overnight+request+for+injunction+in+executive+privilege+case+%7C+CTV+News&cd=KhM2MTQ1MDcxODY2MDQ5NTY2MDk2Mhw1MzNlMDE2OWZhYWUyMDBkOmNvbTplbjpVUzpM&ssp=AMJHsmXlnSoHb_ZABC-riiVXrxFyWhlMpQ","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - Trump","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T05:11:56+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<17-000000000000e78cfa05d0683fab@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.com/alerts?s=AB2Xq4i7OaFz4ss3vFU-wNb0DTELEKxhyDdFl54&start=1636516479&end=1636520078&source=alertsmail&hl=en&gl=US&msgid=MTMyNTI1OTY4MzI3OTI0NDc4MTU#history","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - dollar","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T04:55:34+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<18-000000000000f2696405d0680583@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.gstati","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - dollar","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Unknown","sendingIp":"8.8.8.8","userAwarenessAction":"N/A","date":"2021-11-10T03:55:09+0000","actions":"Browser Isolation","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<19-00000000000065020205d0672f01@google.com>"},{"userEmailAddress":"johndoe@example.com","fromUserEmailAddress":"googlealerts-noreply@google.com","url":"https://www.google.co.za/alerts/share?hl=en&gl=US&ru=https://www.wsj.com/articles/u-s-tests-israels-iron-dome-in-guam-as-defense-against-chinese-cruise-missiles-11636455224&ss=tw&rt=U.S.+Tests+Israel%27s+Iron+Dome+in+Guam+as+Defense+Against+Chinese+Cruise+Missiles+-+WSJ&cd=KhQxNzg2NTc5NDQ3ODIzODUyNjI5NzIcZmQ4N2VjYzkxMGIxMWE4Yzpjby56YTplbjpVUw&ssp=AMJHsmW3CCK1S4TNPifSXszcyaNMwd6TDg","ttpDefinition":"Inbound URL 'Aggressive'","subject":"Google Alert - china","action":"allow","adminOverride":"N/A","userOverride":"None","scanResult":"clean","category":"Search Engines & Portals","sendingIp":"8.8.8.8","userAwarenessAction":"Continue","date":"2021-11-10T03:49:53+0000","actions":"Allow","route":"inbound","creationMethod":"User Click","emailPartsDescription":["Body"],"messageId":"<20-000000000000a02a0a05d0671c06@google.com>"}]}],"fail":[]}
  - path: /api/gateway/get-held-release-logs
    methods: ["POST"]
    request_body: /"meta":\{"pagination":\{"pageSize":100\}\}/
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {{ minify_json `
          {
              "fail": [],
              "meta": {
                  "status": 200,
                  "pagination": {
                      "pageSize": 25,
                      "next": "String",
                      "previous": "String"
                  }
              },
              "data": [
                  {
                      "heldReleaseLogs": [
                          {
                              "spamProcessingDetail": {
                                  "greyEmail": true,
                                  "permittedSender": {
                                      "allow": true,
                                      "info": "allow"
                                  },
                                  "managedSender": {
                                      "allow": true,
                                      "info": "allow"
                                  },
                                  "dkim": {
                                      "allow": true,
                                      "info": "allow"
                                  },
                                  "spf": {
                                      "allow": true,
                                      "info": "allow"
                                  },
                                  "rbl": {
                                      "allow": true,
                                      "info": "allow"
                                  },
                                  "dmarc": {
                                      "allow": true,
                                      "info": "allow"
                                  },
                                  "spamVerdict": {
                                      "decision": "spam",
                                      "description": "",
                                      "risk": "low",
                                      "categories": [
                                          {
                                              "name": "spam",
                                              "risk": "low",
                                              "subcategories": [
                                                  {
                                                      "name": "phishing",
                                                      "risk": "low",
                                                      "augmentations": [
                                                          {
                                                              "name": "body",
                                                              "risk": "negligible"
                                                          }
                                                      ]
                                                  }
                                              ]
                                          }
                                      ]
                                  }
                              },
                              "attachments": true,
                              "messageInfo": "Expired in queue - rejected by housekeeping",
                              "subject": "Exclusive Offer - You don't want to miss this!",
                              "detectionLevel": "moderate",
                              "heldGroup": "IT Staff Global",
                              "operator": "admin@domain.tld",
                              "fromEnv": {
                                  "emailAddress": "user@domain.tld",
                                  "displayableName": "FirstName LastName"
                              },
                              "rejectReason": "Message contains undesirable content",
                              "route": "inbound",
                              "size": 5043,
                              "heldReason": "High-Confidence Impersonation Protection",
                              "spamScore": 12,
                              "id": "eNpVj21LhEAUhf_LfN2VnRl1RpclCN...",
                              "to": [
                                  {
                                      "emailAddress": "user@domain.tld",
                                      "displayableName": "FirstName LastName"
                                  }
                              ],
                              "released": "2015-11-25T14:49:18+00:00",
                              "fromHdr": {
                                  "emailAddress": "user@domain.tld",
                                  "displayableName": "FirstName LastName"
                              },
                              "status": "released",
                              "policy": "Moderate Spam Detection"
                          }
                      ]
                  }
              ]
          }
          `}}
  - path: /api/gateway/get-held-release-logs
    methods: ["POST"]
    request_body: /"meta":\{"pagination":\{"pageSize":100,"pageToken":"String"\}\}/
    request_headers:
      authorization: ["MC .*"]
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - "application/json"
        body: |-
          {{ minify_json `
          {
              "fail": [],
              "meta": {
                  "status": 200,
                  "pagination": {
                      "pageSize": 25,
                      "next": "String",
                      "previous": "String"
                  }
              },
              "data": []
          }
          `}}
