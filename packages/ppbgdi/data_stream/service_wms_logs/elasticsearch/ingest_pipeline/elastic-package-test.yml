---
description: Pipeline for processing json logs
processors:
  - grok:
      field: message
      patterns:
        - ^%{CHAR:first_char}
      pattern_definitions:
        CHAR: .
      ignore_missing: true
  - json:
      field: message
      target_field: temp
      if: ctx?.first_char != null && ctx.first_char == '{'
  - remove:
      field: first_char
  - remove:
      field: message
      if: ctx?.temp?.url != null
  - rename:
      field: temp.url
      target_field: url
      ignore_missing: true
  - remove:
      field: temp

on_failure:
- append:
    field: error.message
    value: '{{ _ingest.on_failure_message }}'

