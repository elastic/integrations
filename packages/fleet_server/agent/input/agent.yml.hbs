unused_key: not_used # Unused key as Fleet do not not support empty agent template
{{#if max_connections}}
server:
{{else if max_agents}}
server:
{{/if}}
{{#if max_connections}}
  limits.max_connections: {{max_connections}}
{{/if}}
{{#if max_agents}}
  limits.max_agents: {{max_agents}}
{{/if}}

{{#if custom}}
{{custom}}
{{/if}}


{{#if fleet_scalability_5000}}
cache.num_counters: 20000
cache.max_cost: 20971520
server.limits:
  policy_throttle: 50ms
  checkin_limit:
    interval: 5ms
    burst: 500
    max: 5001
  artifact_limit:
    interval: 5ms
    burst: 500
    max: 1000
  ack_limit:
    interval: 4ms
    burst: 500
    max: 1000
  enroll_limit:
    interval: 20ms
    burst: 50
    max: 100
{{/if}}

{{#if fleet_scalability_10000}}
cache.num_counters: 80000
cache.max_cost: 104857600
server.limits:
  policy_throttle: 5ms
  checkin_limit:
    interval: 1ms
    burst: 2000
    max: 10001
  artifact_limit:
    interval: 1ms
    burst: 2000
    max: 4000
  ack_limit:
    interval: 1ms
    burst: 2000
    max: 4000
  enroll_limit:
    interval: 10ms
    burst: 100
    max: 200
{{/if}}

{{#if fleet_scalability_30000}}
cache.num_counters: 160000
cache.max_cost: 209715200
server.limits:
  policy_throttle: 5ms
  checkin_limit:
    interval: 500us
    burst: 4000
    max: 15001
  artifact_limit:
    interval: 500us
    burst: 4000
    max: 8000
  ack_limit:
    interval: 500us
    burst: 4000
    max: 8000
  enroll_limit:
    interval: 10ms
    burst: 100
    max: 200
{{/if}}

{{#if fleet_scalability_50000}}
cache.num_counters: 320000
cache.max_cost: 209715200
server.limits:
  policy_throttle: 5ms
  checkin_limit:
    interval: 500us
    burst: 4000
    max: 25001
  artifact_limit:
    interval: 500us
    burst: 4000
    max: 8000
  ack_limit:
    interval: 500us
    burst: 4000
    max: 8000
  enroll_limit:
    interval: 10ms
    burst: 100
    max: 200
{{/if}}