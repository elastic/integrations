---
description: Pipeline for Lyve Cloud

processors:
  - set:
      field: ecs.version
      value: '8.5.0'
  - json:
      field: message
      target_field: lyve_cloud.audit
  - rename:
      field: "message"
      target_field: "event.original"
  - rename:
      field: lyve_cloud.audit.serviceAccountName
      target_field: user.name
  - rename:
      field: lyve_cloud.audit.serviceAccountCreatorId
      target_field: user.id
  - set:
      copy_from: user.id
      field: user.email
  - date:
      field: lyve_cloud.audit.auditEntry.time
      formats: ["yyyy-MM-dd'T'HH:mm:ss.SSSSSSSSS'Z'"]
  - remove:
      field: lyve_cloud.audit.auditEntry.time
  - user_agent:
      field: lyve_cloud.audit.auditEntry.userAgent
  - remove:
      field: lyve_cloud.audit.auditEntry.userAgent
on_failure:
    - set:
        field: error.message
        value: "{{ _ingest.on_failure_message }}"
