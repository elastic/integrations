vars:
  redact_fields: [foo]
  oauth_id: test
  oauth_secret: test
  oauth_scopes: ["token_scope"]
  oauth_token_url: http://{{Hostname}}:{{Port}}/testoauth/scopedtoken
  resource_url: http://{{Hostname}}:{{Port}}/testoauth/api
  enable_request_tracer: true
  program: |
    get(state.url).as(resp, resp.StatusCode == 200 ?
      resp.Body.as(body, {
        "events": [body.decode_json()]
      })
    :
      {"events": []}
    )
  resource_headers: |-
    "Accept": ["application/json"]
    "X-Custom-Header": ["custom value"]
