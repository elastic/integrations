{
    "attributes": {
        "controlGroupInput": {
            "chainingSystem": "HIERARCHICAL",
            "controlStyle": "oneLine",
            "ignoreParentSettingsJSON": {
                "ignoreFilters": false,
                "ignoreQuery": false,
                "ignoreTimerange": false,
                "ignoreValidations": false
            },
            "panelsJSON": {},
            "showApplySelections": false
        },
        "description": "",
        "kibanaSavedObjectMeta": {
            "searchSourceJSON": {
                "filter": [],
                "query": {
                    "language": "kuery",
                    "query": ""
                }
            }
        },
        "optionsJSON": {
            "hidePanelTitles": false,
            "syncColors": false,
            "syncCursor": true,
            "syncTooltips": false,
            "useMargins": true
        },
        "panelsJSON": [
            {
                "embeddableConfig": {
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "savedVis": {
                        "data": {
                            "aggs": [],
                            "searchSource": {
                                "filter": [],
                                "query": {
                                    "language": "kuery",
                                    "query": ""
                                }
                            }
                        },
                        "description": "",
                        "params": {
                            "fontSize": 12,
                            "markdown": "### Android Exception Details\n\nShows all details about a single exception. This dashboard is meant to be opened from the \"Android Observability\" dashboard by selecting a specific crash from the crashes list to see its details.",
                            "openLinksInNewTab": false
                        },
                        "title": "",
                        "type": "markdown",
                        "uiState": {}
                    }
                },
                "gridData": {
                    "h": 10,
                    "i": "d7716259-244f-44c9-bb1b-51347dc00079",
                    "w": 8,
                    "x": 0,
                    "y": 0
                },
                "panelIndex": "d7716259-244f-44c9-bb1b-51347dc00079",
                "type": "visualization"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77": {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "title": "logs-generic.otel*,traces-generic.otel*,logs-apm*,traces-apm*",
                                    "timeFieldName": "@timestamp",
                                    "sourceFilters": [],
                                    "fieldFormats": {},
                                    "runtimeFieldMap": {
                                        "_stacktrace.group_id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"error.grouping_key\") && !doc[\"error.grouping_key\"].isEmpty()) {\n  emit($(\"error.grouping_key\", \"\"));\n  return;\n}\nif(!doc.containsKey(\"exception.stacktrace\") || doc[\"exception.stacktrace\"].isEmpty()){\n    return;\n}\ndef stacktrace = doc[\"exception.stacktrace\"].value;\ndef exceptionType = doc[\"exception.type\"].value;\n\ndef stacktraceLinesPattern = /^[^\\s].+((\\n\\sat.+)+)[\\S\\s]*/;\ndef lineNumberPattern = /:\\d+\\)/;\ndef unwantedLinePattern = /\\nCaused by.+|\\n\\s+\\..+/;\ndef stackTraceLinesMatcher = stacktraceLinesPattern.matcher(stacktrace.replaceAll(unwantedLinePattern, (s)->\"\"));\n\nif(stackTraceLinesMatcher.matches()) {\n    def curatedLines = stackTraceLinesMatcher.group(1).replaceAll(lineNumberPattern, (s)->\")\");\n    def stacktracePattern = exceptionType + curatedLines;\n    emit(String.valueOf(stacktracePattern.hashCode()).encodeBase64());\n}"
                                            }
                                        },
                                        "_timeline.text": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"span.name\", \"\"));\n} else if (doc.containsKey(\"transaction.name\") && !doc[\"transaction.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"transaction.name\", \"\"));\n} else if (doc.containsKey(\"message\")) {\n  if (doc.containsKey(\"event_name\") && !doc[\"event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"event_name\", \"\"));\n  } else if (doc.containsKey(\"otel.event.name\") && !doc[\"otel.event.name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"otel.event.name\", \"\"));\n  } else if (doc.containsKey(\"labels.otel_event_name\") && !doc[\"labels.otel_event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"labels.otel_event_name\", \"\"));\n  } else {\n    emit(\"[Log] - \" + $(\"message\", \"\"));\n  }\n}"
                                            }
                                        },
                                        "_os.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"os.version\")) {\n    emit($(\"os.version\", \"\"));\n} else if(doc.containsKey(\"host.os.version\")) {\n    emit($(\"host.os.version\", \"\"));\n}"
                                            }
                                        },
                                        "_exception.message": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.message\")) {\n  if(!doc[\"exception.message\"].isEmpty()){\n    emit($(\"exception.message\", \"\"));\n  }\n} else if(doc.containsKey(\"error.exception.type\")) {\n  emit($(\"message\", \"\"));\n}"
                                            }
                                        },
                                        "_app.installation.id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"app.installation.id\") && !doc[\"app.installation.id\"].isEmpty()) {\n  emit($(\"app.installation.id\", \"\"));\n} else if (doc.containsKey(\"labels.app_installation_id\") && !doc[\"labels.app_installation_id\"].isEmpty()) {\n  emit($(\"labels.app_installation_id\", \"\"));\n}"
                                            }
                                        },
                                        "_span.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit($(\"span.name\", \"\"));\n} else if(doc.containsKey(\"transaction.name\")) {\n  emit($(\"transaction.name\", \"\"));\n}"
                                            }
                                        },
                                        "_duration.ns": {
                                            "type": "long",
                                            "script": {
                                                "source": "if(doc.containsKey(\"duration\") && !doc[\"duration\"].isEmpty()) {\n  emit($(\"duration\", 0));\n} else if(doc.containsKey(\"transaction.duration.us\") && !doc[\"transaction.duration.us\"].isEmpty()) {\n  emit($(\"transaction.duration.us\", 0) * 1000);\n} else if(doc.containsKey(\"span.duration.us\") && !doc[\"span.duration.us\"].isEmpty()) {\n  emit($(\"span.duration.us\", 0) * 1000);\n}"
                                            }
                                        },
                                        "_exception.stacktrace": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.stacktrace\")) {\n  // EDOT Collector field\n  if(!doc[\"exception.stacktrace\"].isEmpty()) {\n    emit($(\"exception.stacktrace\", \"\"));\n  }\n  return;\n}\nif(doc.containsKey(\"error.stack_trace\") && !doc[\"error.stack_trace\"].isEmpty()) {\n  // APM Server fallback to ECS field for when the exception cannot be parsed\n  emit($(\"error.stack_trace\", \"\"));\n  return;\n}\ndef source = params['_source'];\nif(source.error?.exception == null) {\n  return;\n}\n// APM Server exception field\ndef exceptions = source.error.exception;\nif(exceptions.size() == 0) {\n  return;\n}\ndef newline = (char)0x0a;\ndef tabspace = (char)0x09;\ndef result = new StringBuilder();\nfor(int i = 0; i < exceptions.size(); i++) {\n  def ex = exceptions[i];\n  if(i == 0) {\n    if(ex.type != null) {\n      result.append(ex.type);\n      result.append(\": \");\n    }\n    result.append(ex.message);\n  } else {\n    result.append(newline);\n    result.append(\"Caused by: \");\n    result.append(ex.message);\n  }\n  def frames = ex.stacktrace;\n  if(frames == null || frames.size() == 0) {\n    continue;\n  }\n  for(int j = 0; j < frames.size(); j++) {\n    def frame = frames[j];\n    result.append(newline);\n    result.append(tabspace);\n    result.append(\"at \");\n    result.append(frame.classname);\n    result.append(\".\");\n    result.append(frame.function);\n    result.append(\"(\");\n    result.append(frame.filename);\n    if(frame.line?.number != null) {\n      result.append(\":\");\n      result.append(frame.line.number);\n    }\n    result.append(\")\")\n  }\n}\nemit(result.toString());\n"
                                            }
                                        },
                                        "_service.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.name\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n}"
                                            }
                                        },
                                        "_service.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.version\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n}"
                                            }
                                        }
                                    },
                                    "fieldAttrs": {
                                        "_stacktrace.group_id": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_timeline.text": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_os.version": {
                                            "customLabel": "os.version",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"os.version\" (for OTel data) or \"host.os.version\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.message": {
                                            "customLabel": "exception.message",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"exception.message\" (for OTel data)."
                                        },
                                        "_app.installation.id": {
                                            "customLabel": "app.installation.id",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"app.installation.id\" (for OTel data) or \"labels.app_installation_id\" (for Elastic APM data) for your own queries."
                                        },
                                        "_span.name": {
                                            "customLabel": "span.name",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"span.name\" (for OTel data), \"transaction.name\" or \"span.name\" (for Elastic APM data) for your own queries."
                                        },
                                        "_duration.ns": {
                                            "customLabel": "duration",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"duration\" (for OTel data), \"transaction.duration.us\" or \"span.duration.us\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.stacktrace": {
                                            "customLabel": "exception.stacktrace",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Do not use in user queries."
                                        },
                                        "_service.name": {
                                            "count": 2,
                                            "customLabel": "service.name",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.name\" for your own queries."
                                        },
                                        "_service.version": {
                                            "customLabel": "service.version",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.version\" for your own queries."
                                        },
                                        "session.id": {
                                            "count": 1
                                        }
                                    },
                                    "allowNoIndex": false,
                                    "name": "android-observability"
                                }
                            },
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "9ad5f3d5-91c7-4509-94d8-9ef3e33c1815": {
                                            "columnOrder": [
                                                "de6d5ed3-bc36-4a5b-842b-1707a42f4d6b",
                                                "bcb003de-d70e-4a3a-9d74-4cd4fb0a2dc2"
                                            ],
                                            "columns": {
                                                "bcb003de-d70e-4a3a-9d74-4cd4fb0a2dc2": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Occurrences",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "sourceField": "_stacktrace.group_id"
                                                },
                                                "de6d5ed3-bc36-4a5b-842b-1707a42f4d6b": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Id",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "bcb003de-d70e-4a3a-9d74-4cd4fb0a2dc2",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 10
                                                    },
                                                    "sourceField": "session.id"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [],
                            "internalReferences": [
                                {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "name": "indexpattern-datasource-layer-9ad5f3d5-91c7-4509-94d8-9ef3e33c1815",
                                    "type": "index-pattern"
                                }
                            ],
                            "query": {
                                "language": "kuery",
                                "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id : *"
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "de6d5ed3-bc36-4a5b-842b-1707a42f4d6b",
                                        "isMetric": false,
                                        "isTransposed": false,
                                        "oneClickFilter": true
                                    },
                                    {
                                        "columnId": "bcb003de-d70e-4a3a-9d74-4cd4fb0a2dc2",
                                        "hidden": false,
                                        "isMetric": true,
                                        "isTransposed": false
                                    }
                                ],
                                "density": "normal",
                                "layerId": "9ad5f3d5-91c7-4509-94d8-9ef3e33c1815",
                                "layerType": "data",
                                "paging": {
                                    "enabled": true,
                                    "size": 10
                                },
                                "rowHeight": "auto",
                                "rowHeightLines": -1
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "description": "Shows the top sessions with the most occurrences of this exception. A session is a period of time during which a user interacts with the application to accomplish a single task or goal. Ideally, a session should represent an isolated user interaction with the application. ",
                    "enhancements": {
                        "dynamicActions": {
                            "events": [
                                {
                                    "action": {
                                        "config": {
                                            "openInNewTab": false,
                                            "useCurrentDateRange": true,
                                            "useCurrentFilters": false
                                        },
                                        "factoryId": "DASHBOARD_TO_DASHBOARD_DRILLDOWN",
                                        "name": "View session details"
                                    },
                                    "eventId": "dd9d5fda-48a3-4c5d-9679-559a8382965f",
                                    "triggers": [
                                        "FILTER_TRIGGER"
                                    ]
                                }
                            ]
                        }
                    },
                    "filters": [],
                    "query": {
                        "language": "kuery",
                        "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id : *"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Top affected sessions"
                },
                "gridData": {
                    "h": 10,
                    "i": "eed746a9-7e1d-4258-a46c-e2ced4100f5e",
                    "w": 24,
                    "x": 8,
                    "y": 0
                },
                "panelIndex": "eed746a9-7e1d-4258-a46c-e2ced4100f5e",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77": {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "title": "logs-generic.otel*,traces-generic.otel*,logs-apm*,traces-apm*",
                                    "timeFieldName": "@timestamp",
                                    "sourceFilters": [],
                                    "fieldFormats": {},
                                    "runtimeFieldMap": {
                                        "_stacktrace.group_id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"error.grouping_key\") && !doc[\"error.grouping_key\"].isEmpty()) {\n  emit($(\"error.grouping_key\", \"\"));\n  return;\n}\nif(!doc.containsKey(\"exception.stacktrace\") || doc[\"exception.stacktrace\"].isEmpty()){\n    return;\n}\ndef stacktrace = doc[\"exception.stacktrace\"].value;\ndef exceptionType = doc[\"exception.type\"].value;\n\ndef stacktraceLinesPattern = /^[^\\s].+((\\n\\sat.+)+)[\\S\\s]*/;\ndef lineNumberPattern = /:\\d+\\)/;\ndef unwantedLinePattern = /\\nCaused by.+|\\n\\s+\\..+/;\ndef stackTraceLinesMatcher = stacktraceLinesPattern.matcher(stacktrace.replaceAll(unwantedLinePattern, (s)->\"\"));\n\nif(stackTraceLinesMatcher.matches()) {\n    def curatedLines = stackTraceLinesMatcher.group(1).replaceAll(lineNumberPattern, (s)->\")\");\n    def stacktracePattern = exceptionType + curatedLines;\n    emit(String.valueOf(stacktracePattern.hashCode()).encodeBase64());\n}"
                                            }
                                        },
                                        "_timeline.text": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"span.name\", \"\"));\n} else if (doc.containsKey(\"transaction.name\") && !doc[\"transaction.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"transaction.name\", \"\"));\n} else if (doc.containsKey(\"message\")) {\n  if (doc.containsKey(\"event_name\") && !doc[\"event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"event_name\", \"\"));\n  } else if (doc.containsKey(\"otel.event.name\") && !doc[\"otel.event.name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"otel.event.name\", \"\"));\n  } else if (doc.containsKey(\"labels.otel_event_name\") && !doc[\"labels.otel_event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"labels.otel_event_name\", \"\"));\n  } else {\n    emit(\"[Log] - \" + $(\"message\", \"\"));\n  }\n}"
                                            }
                                        },
                                        "_os.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"os.version\")) {\n    emit($(\"os.version\", \"\"));\n} else if(doc.containsKey(\"host.os.version\")) {\n    emit($(\"host.os.version\", \"\"));\n}"
                                            }
                                        },
                                        "_exception.message": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.message\")) {\n  if(!doc[\"exception.message\"].isEmpty()){\n    emit($(\"exception.message\", \"\"));\n  }\n} else if(doc.containsKey(\"error.exception.type\")) {\n  emit($(\"message\", \"\"));\n}"
                                            }
                                        },
                                        "_app.installation.id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"app.installation.id\") && !doc[\"app.installation.id\"].isEmpty()) {\n  emit($(\"app.installation.id\", \"\"));\n} else if (doc.containsKey(\"labels.app_installation_id\") && !doc[\"labels.app_installation_id\"].isEmpty()) {\n  emit($(\"labels.app_installation_id\", \"\"));\n}"
                                            }
                                        },
                                        "_span.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit($(\"span.name\", \"\"));\n} else if(doc.containsKey(\"transaction.name\")) {\n  emit($(\"transaction.name\", \"\"));\n}"
                                            }
                                        },
                                        "_duration.ns": {
                                            "type": "long",
                                            "script": {
                                                "source": "if(doc.containsKey(\"duration\") && !doc[\"duration\"].isEmpty()) {\n  emit($(\"duration\", 0));\n} else if(doc.containsKey(\"transaction.duration.us\") && !doc[\"transaction.duration.us\"].isEmpty()) {\n  emit($(\"transaction.duration.us\", 0) * 1000);\n} else if(doc.containsKey(\"span.duration.us\") && !doc[\"span.duration.us\"].isEmpty()) {\n  emit($(\"span.duration.us\", 0) * 1000);\n}"
                                            }
                                        },
                                        "_exception.stacktrace": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.stacktrace\")) {\n  // EDOT Collector field\n  if(!doc[\"exception.stacktrace\"].isEmpty()) {\n    emit($(\"exception.stacktrace\", \"\"));\n  }\n  return;\n}\nif(doc.containsKey(\"error.stack_trace\") && !doc[\"error.stack_trace\"].isEmpty()) {\n  // APM Server fallback to ECS field for when the exception cannot be parsed\n  emit($(\"error.stack_trace\", \"\"));\n  return;\n}\ndef source = params['_source'];\nif(source.error?.exception == null) {\n  return;\n}\n// APM Server exception field\ndef exceptions = source.error.exception;\nif(exceptions.size() == 0) {\n  return;\n}\ndef newline = (char)0x0a;\ndef tabspace = (char)0x09;\ndef result = new StringBuilder();\nfor(int i = 0; i < exceptions.size(); i++) {\n  def ex = exceptions[i];\n  if(i == 0) {\n    if(ex.type != null) {\n      result.append(ex.type);\n      result.append(\": \");\n    }\n    result.append(ex.message);\n  } else {\n    result.append(newline);\n    result.append(\"Caused by: \");\n    result.append(ex.message);\n  }\n  def frames = ex.stacktrace;\n  if(frames == null || frames.size() == 0) {\n    continue;\n  }\n  for(int j = 0; j < frames.size(); j++) {\n    def frame = frames[j];\n    result.append(newline);\n    result.append(tabspace);\n    result.append(\"at \");\n    result.append(frame.classname);\n    result.append(\".\");\n    result.append(frame.function);\n    result.append(\"(\");\n    result.append(frame.filename);\n    if(frame.line?.number != null) {\n      result.append(\":\");\n      result.append(frame.line.number);\n    }\n    result.append(\")\")\n  }\n}\nemit(result.toString());\n"
                                            }
                                        },
                                        "_service.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.name\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n}"
                                            }
                                        },
                                        "_service.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.version\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n}"
                                            }
                                        }
                                    },
                                    "fieldAttrs": {
                                        "_stacktrace.group_id": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_timeline.text": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_os.version": {
                                            "customLabel": "os.version",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"os.version\" (for OTel data) or \"host.os.version\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.message": {
                                            "customLabel": "exception.message",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"exception.message\" (for OTel data)."
                                        },
                                        "_app.installation.id": {
                                            "customLabel": "app.installation.id",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"app.installation.id\" (for OTel data) or \"labels.app_installation_id\" (for Elastic APM data) for your own queries."
                                        },
                                        "_span.name": {
                                            "customLabel": "span.name",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"span.name\" (for OTel data), \"transaction.name\" or \"span.name\" (for Elastic APM data) for your own queries."
                                        },
                                        "_duration.ns": {
                                            "customLabel": "duration",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"duration\" (for OTel data), \"transaction.duration.us\" or \"span.duration.us\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.stacktrace": {
                                            "customLabel": "exception.stacktrace",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Do not use in user queries."
                                        },
                                        "_service.name": {
                                            "count": 2,
                                            "customLabel": "service.name",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.name\" for your own queries."
                                        },
                                        "_service.version": {
                                            "customLabel": "service.version",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.version\" for your own queries."
                                        },
                                        "session.id": {
                                            "count": 1
                                        }
                                    },
                                    "allowNoIndex": false,
                                    "name": "android-observability"
                                }
                            },
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "90dab598-1e5c-4228-bd2b-6c00d93a4fbf": {
                                            "columnOrder": [
                                                "58b7b0a3-38ab-4863-81cc-ab40e12ddee8",
                                                "58b7b0a3-38ab-4863-81cc-ab40e12ddee8X0",
                                                "58b7b0a3-38ab-4863-81cc-ab40e12ddee8X1",
                                                "58b7b0a3-38ab-4863-81cc-ab40e12ddee8X2"
                                            ],
                                            "columns": {
                                                "58b7b0a3-38ab-4863-81cc-ab40e12ddee8": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Occurrences by session",
                                                    "operationType": "formula",
                                                    "params": {
                                                        "format": {
                                                            "id": "number",
                                                            "params": {
                                                                "decimals": 1
                                                            }
                                                        },
                                                        "formula": "count(_stacktrace.group_id) / unique_count(session.id)",
                                                        "isFormulaBroken": false
                                                    },
                                                    "references": [
                                                        "58b7b0a3-38ab-4863-81cc-ab40e12ddee8X2"
                                                    ]
                                                },
                                                "58b7b0a3-38ab-4863-81cc-ab40e12ddee8X0": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Occurrences by session",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "sourceField": "_stacktrace.group_id"
                                                },
                                                "58b7b0a3-38ab-4863-81cc-ab40e12ddee8X1": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Occurrences by session",
                                                    "operationType": "unique_count",
                                                    "params": {
                                                        "emptyAsNull": false
                                                    },
                                                    "sourceField": "session.id"
                                                },
                                                "58b7b0a3-38ab-4863-81cc-ab40e12ddee8X2": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Part of Occurrences by session",
                                                    "operationType": "math",
                                                    "params": {
                                                        "tinymathAst": {
                                                            "args": [
                                                                "58b7b0a3-38ab-4863-81cc-ab40e12ddee8X0",
                                                                "58b7b0a3-38ab-4863-81cc-ab40e12ddee8X1"
                                                            ],
                                                            "location": {
                                                                "max": 50,
                                                                "min": 0
                                                            },
                                                            "name": "divide",
                                                            "text": "count(_stacktrace.group_id) / unique_count(session.id)",
                                                            "type": "function"
                                                        }
                                                    },
                                                    "references": [
                                                        "58b7b0a3-38ab-4863-81cc-ab40e12ddee8X0",
                                                        "58b7b0a3-38ab-4863-81cc-ab40e12ddee8X1"
                                                    ]
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {}
                                }
                            },
                            "filters": [],
                            "internalReferences": [
                                {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "name": "indexpattern-datasource-layer-90dab598-1e5c-4228-bd2b-6c00d93a4fbf",
                                    "type": "index-pattern"
                                }
                            ],
                            "query": {
                                "language": "kuery",
                                "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id : * "
                            },
                            "visualization": {
                                "layerId": "90dab598-1e5c-4228-bd2b-6c00d93a4fbf",
                                "layerType": "data",
                                "metricAccessor": "58b7b0a3-38ab-4863-81cc-ab40e12ddee8",
                                "palette": {
                                    "name": "custom",
                                    "params": {
                                        "colorStops": [
                                            {
                                                "color": "#f6c7bc",
                                                "stop": 1
                                            },
                                            {
                                                "color": "#e48f7d",
                                                "stop": 2
                                            },
                                            {
                                                "color": "#cc5642",
                                                "stop": 3
                                            }
                                        ],
                                        "continuity": "above",
                                        "maxSteps": 5,
                                        "name": "custom",
                                        "progression": "fixed",
                                        "rangeMax": null,
                                        "rangeMin": 1,
                                        "rangeType": "number",
                                        "reverse": false,
                                        "steps": 3,
                                        "stops": [
                                            {
                                                "color": "#f6c7bc",
                                                "stop": 2
                                            },
                                            {
                                                "color": "#e48f7d",
                                                "stop": 3
                                            },
                                            {
                                                "color": "#cc5642",
                                                "stop": 8
                                            }
                                        ]
                                    },
                                    "type": "palette"
                                },
                                "secondaryTrend": {
                                    "type": "none"
                                },
                                "subtitle": "On average",
                                "titlesTextAlign": "left",
                                "valueFontMode": "default",
                                "valuesTextAlign": "right"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "description": "Average of recorded exceptions by session",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "hidePanelTitles": true,
                    "query": {
                        "language": "kuery",
                        "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id : * "
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 10,
                    "i": "18dd36f2-9b30-4dc0-9d0b-296f25b88f28",
                    "w": 8,
                    "x": 32,
                    "y": 0
                },
                "panelIndex": "18dd36f2-9b30-4dc0-9d0b-296f25b88f28",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77": {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "title": "logs-generic.otel*,traces-generic.otel*,logs-apm*,traces-apm*",
                                    "timeFieldName": "@timestamp",
                                    "sourceFilters": [],
                                    "fieldFormats": {},
                                    "runtimeFieldMap": {
                                        "_stacktrace.group_id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"error.grouping_key\") && !doc[\"error.grouping_key\"].isEmpty()) {\n  emit($(\"error.grouping_key\", \"\"));\n  return;\n}\nif(!doc.containsKey(\"exception.stacktrace\") || doc[\"exception.stacktrace\"].isEmpty()){\n    return;\n}\ndef stacktrace = doc[\"exception.stacktrace\"].value;\ndef exceptionType = doc[\"exception.type\"].value;\n\ndef stacktraceLinesPattern = /^[^\\s].+((\\n\\sat.+)+)[\\S\\s]*/;\ndef lineNumberPattern = /:\\d+\\)/;\ndef unwantedLinePattern = /\\nCaused by.+|\\n\\s+\\..+/;\ndef stackTraceLinesMatcher = stacktraceLinesPattern.matcher(stacktrace.replaceAll(unwantedLinePattern, (s)->\"\"));\n\nif(stackTraceLinesMatcher.matches()) {\n    def curatedLines = stackTraceLinesMatcher.group(1).replaceAll(lineNumberPattern, (s)->\")\");\n    def stacktracePattern = exceptionType + curatedLines;\n    emit(String.valueOf(stacktracePattern.hashCode()).encodeBase64());\n}"
                                            }
                                        },
                                        "_timeline.text": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"span.name\", \"\"));\n} else if (doc.containsKey(\"transaction.name\") && !doc[\"transaction.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"transaction.name\", \"\"));\n} else if (doc.containsKey(\"message\")) {\n  if (doc.containsKey(\"event_name\") && !doc[\"event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"event_name\", \"\"));\n  } else if (doc.containsKey(\"otel.event.name\") && !doc[\"otel.event.name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"otel.event.name\", \"\"));\n  } else if (doc.containsKey(\"labels.otel_event_name\") && !doc[\"labels.otel_event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"labels.otel_event_name\", \"\"));\n  } else {\n    emit(\"[Log] - \" + $(\"message\", \"\"));\n  }\n}"
                                            }
                                        },
                                        "_os.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"os.version\")) {\n    emit($(\"os.version\", \"\"));\n} else if(doc.containsKey(\"host.os.version\")) {\n    emit($(\"host.os.version\", \"\"));\n}"
                                            }
                                        },
                                        "_exception.message": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.message\")) {\n  if(!doc[\"exception.message\"].isEmpty()){\n    emit($(\"exception.message\", \"\"));\n  }\n} else if(doc.containsKey(\"error.exception.type\")) {\n  emit($(\"message\", \"\"));\n}"
                                            }
                                        },
                                        "_app.installation.id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"app.installation.id\") && !doc[\"app.installation.id\"].isEmpty()) {\n  emit($(\"app.installation.id\", \"\"));\n} else if (doc.containsKey(\"labels.app_installation_id\") && !doc[\"labels.app_installation_id\"].isEmpty()) {\n  emit($(\"labels.app_installation_id\", \"\"));\n}"
                                            }
                                        },
                                        "_span.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit($(\"span.name\", \"\"));\n} else if(doc.containsKey(\"transaction.name\")) {\n  emit($(\"transaction.name\", \"\"));\n}"
                                            }
                                        },
                                        "_duration.ns": {
                                            "type": "long",
                                            "script": {
                                                "source": "if(doc.containsKey(\"duration\") && !doc[\"duration\"].isEmpty()) {\n  emit($(\"duration\", 0));\n} else if(doc.containsKey(\"transaction.duration.us\") && !doc[\"transaction.duration.us\"].isEmpty()) {\n  emit($(\"transaction.duration.us\", 0) * 1000);\n} else if(doc.containsKey(\"span.duration.us\") && !doc[\"span.duration.us\"].isEmpty()) {\n  emit($(\"span.duration.us\", 0) * 1000);\n}"
                                            }
                                        },
                                        "_exception.stacktrace": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.stacktrace\")) {\n  // EDOT Collector field\n  if(!doc[\"exception.stacktrace\"].isEmpty()) {\n    emit($(\"exception.stacktrace\", \"\"));\n  }\n  return;\n}\nif(doc.containsKey(\"error.stack_trace\") && !doc[\"error.stack_trace\"].isEmpty()) {\n  // APM Server fallback to ECS field for when the exception cannot be parsed\n  emit($(\"error.stack_trace\", \"\"));\n  return;\n}\ndef source = params['_source'];\nif(source.error?.exception == null) {\n  return;\n}\n// APM Server exception field\ndef exceptions = source.error.exception;\nif(exceptions.size() == 0) {\n  return;\n}\ndef newline = (char)0x0a;\ndef tabspace = (char)0x09;\ndef result = new StringBuilder();\nfor(int i = 0; i < exceptions.size(); i++) {\n  def ex = exceptions[i];\n  if(i == 0) {\n    if(ex.type != null) {\n      result.append(ex.type);\n      result.append(\": \");\n    }\n    result.append(ex.message);\n  } else {\n    result.append(newline);\n    result.append(\"Caused by: \");\n    result.append(ex.message);\n  }\n  def frames = ex.stacktrace;\n  if(frames == null || frames.size() == 0) {\n    continue;\n  }\n  for(int j = 0; j < frames.size(); j++) {\n    def frame = frames[j];\n    result.append(newline);\n    result.append(tabspace);\n    result.append(\"at \");\n    result.append(frame.classname);\n    result.append(\".\");\n    result.append(frame.function);\n    result.append(\"(\");\n    result.append(frame.filename);\n    if(frame.line?.number != null) {\n      result.append(\":\");\n      result.append(frame.line.number);\n    }\n    result.append(\")\")\n  }\n}\nemit(result.toString());\n"
                                            }
                                        },
                                        "_service.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.name\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n}"
                                            }
                                        },
                                        "_service.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.version\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n}"
                                            }
                                        }
                                    },
                                    "fieldAttrs": {
                                        "_stacktrace.group_id": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_timeline.text": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_os.version": {
                                            "customLabel": "os.version",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"os.version\" (for OTel data) or \"host.os.version\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.message": {
                                            "customLabel": "exception.message",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"exception.message\" (for OTel data)."
                                        },
                                        "_app.installation.id": {
                                            "customLabel": "app.installation.id",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"app.installation.id\" (for OTel data) or \"labels.app_installation_id\" (for Elastic APM data) for your own queries."
                                        },
                                        "_span.name": {
                                            "customLabel": "span.name",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"span.name\" (for OTel data), \"transaction.name\" or \"span.name\" (for Elastic APM data) for your own queries."
                                        },
                                        "_duration.ns": {
                                            "customLabel": "duration",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"duration\" (for OTel data), \"transaction.duration.us\" or \"span.duration.us\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.stacktrace": {
                                            "customLabel": "exception.stacktrace",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Do not use in user queries."
                                        },
                                        "_service.name": {
                                            "count": 2,
                                            "customLabel": "service.name",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.name\" for your own queries."
                                        },
                                        "_service.version": {
                                            "customLabel": "service.version",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.version\" for your own queries."
                                        },
                                        "session.id": {
                                            "count": 1
                                        }
                                    },
                                    "allowNoIndex": false,
                                    "name": "android-observability"
                                }
                            },
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "90dab598-1e5c-4228-bd2b-6c00d93a4fbf": {
                                            "columnOrder": [
                                                "6c7882e7-2d47-47fb-9116-66d0b87d6207"
                                            ],
                                            "columns": {
                                                "6c7882e7-2d47-47fb-9116-66d0b87d6207": {
                                                    "customLabel": true,
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Total occurrences",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "sourceField": "___records___"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {}
                                }
                            },
                            "filters": [],
                            "internalReferences": [
                                {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "name": "indexpattern-datasource-layer-90dab598-1e5c-4228-bd2b-6c00d93a4fbf",
                                    "type": "index-pattern"
                                }
                            ],
                            "query": {
                                "language": "kuery",
                                "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id : * "
                            },
                            "visualization": {
                                "color": "#F6726A",
                                "layerId": "90dab598-1e5c-4228-bd2b-6c00d93a4fbf",
                                "layerType": "data",
                                "metricAccessor": "6c7882e7-2d47-47fb-9116-66d0b87d6207",
                                "secondaryTrend": {
                                    "type": "none"
                                },
                                "titlesTextAlign": "left",
                                "valueFontMode": "default",
                                "valuesTextAlign": "right"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsMetric"
                    },
                    "description": "Total recorded exceptions",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "hidePanelTitles": true,
                    "query": {
                        "language": "kuery",
                        "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id : * "
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 10,
                    "i": "4f65242b-ffad-449c-b7cb-9681e230f9ab",
                    "w": 8,
                    "x": 40,
                    "y": 0
                },
                "panelIndex": "4f65242b-ffad-449c-b7cb-9681e230f9ab",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77": {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "title": "logs-generic.otel*,traces-generic.otel*,logs-apm*,traces-apm*",
                                    "timeFieldName": "@timestamp",
                                    "sourceFilters": [],
                                    "fieldFormats": {},
                                    "runtimeFieldMap": {
                                        "_stacktrace.group_id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"error.grouping_key\") && !doc[\"error.grouping_key\"].isEmpty()) {\n  emit($(\"error.grouping_key\", \"\"));\n  return;\n}\nif(!doc.containsKey(\"exception.stacktrace\") || doc[\"exception.stacktrace\"].isEmpty()){\n    return;\n}\ndef stacktrace = doc[\"exception.stacktrace\"].value;\ndef exceptionType = doc[\"exception.type\"].value;\n\ndef stacktraceLinesPattern = /^[^\\s].+((\\n\\sat.+)+)[\\S\\s]*/;\ndef lineNumberPattern = /:\\d+\\)/;\ndef unwantedLinePattern = /\\nCaused by.+|\\n\\s+\\..+/;\ndef stackTraceLinesMatcher = stacktraceLinesPattern.matcher(stacktrace.replaceAll(unwantedLinePattern, (s)->\"\"));\n\nif(stackTraceLinesMatcher.matches()) {\n    def curatedLines = stackTraceLinesMatcher.group(1).replaceAll(lineNumberPattern, (s)->\")\");\n    def stacktracePattern = exceptionType + curatedLines;\n    emit(String.valueOf(stacktracePattern.hashCode()).encodeBase64());\n}"
                                            }
                                        },
                                        "_timeline.text": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"span.name\", \"\"));\n} else if (doc.containsKey(\"transaction.name\") && !doc[\"transaction.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"transaction.name\", \"\"));\n} else if (doc.containsKey(\"message\")) {\n  if (doc.containsKey(\"event_name\") && !doc[\"event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"event_name\", \"\"));\n  } else if (doc.containsKey(\"otel.event.name\") && !doc[\"otel.event.name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"otel.event.name\", \"\"));\n  } else if (doc.containsKey(\"labels.otel_event_name\") && !doc[\"labels.otel_event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"labels.otel_event_name\", \"\"));\n  } else {\n    emit(\"[Log] - \" + $(\"message\", \"\"));\n  }\n}"
                                            }
                                        },
                                        "_os.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"os.version\")) {\n    emit($(\"os.version\", \"\"));\n} else if(doc.containsKey(\"host.os.version\")) {\n    emit($(\"host.os.version\", \"\"));\n}"
                                            }
                                        },
                                        "_exception.message": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.message\")) {\n  if(!doc[\"exception.message\"].isEmpty()){\n    emit($(\"exception.message\", \"\"));\n  }\n} else if(doc.containsKey(\"error.exception.type\")) {\n  emit($(\"message\", \"\"));\n}"
                                            }
                                        },
                                        "_app.installation.id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"app.installation.id\") && !doc[\"app.installation.id\"].isEmpty()) {\n  emit($(\"app.installation.id\", \"\"));\n} else if (doc.containsKey(\"labels.app_installation_id\") && !doc[\"labels.app_installation_id\"].isEmpty()) {\n  emit($(\"labels.app_installation_id\", \"\"));\n}"
                                            }
                                        },
                                        "_span.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit($(\"span.name\", \"\"));\n} else if(doc.containsKey(\"transaction.name\")) {\n  emit($(\"transaction.name\", \"\"));\n}"
                                            }
                                        },
                                        "_duration.ns": {
                                            "type": "long",
                                            "script": {
                                                "source": "if(doc.containsKey(\"duration\") && !doc[\"duration\"].isEmpty()) {\n  emit($(\"duration\", 0));\n} else if(doc.containsKey(\"transaction.duration.us\") && !doc[\"transaction.duration.us\"].isEmpty()) {\n  emit($(\"transaction.duration.us\", 0) * 1000);\n} else if(doc.containsKey(\"span.duration.us\") && !doc[\"span.duration.us\"].isEmpty()) {\n  emit($(\"span.duration.us\", 0) * 1000);\n}"
                                            }
                                        },
                                        "_exception.stacktrace": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.stacktrace\")) {\n  // EDOT Collector field\n  if(!doc[\"exception.stacktrace\"].isEmpty()) {\n    emit($(\"exception.stacktrace\", \"\"));\n  }\n  return;\n}\nif(doc.containsKey(\"error.stack_trace\") && !doc[\"error.stack_trace\"].isEmpty()) {\n  // APM Server fallback to ECS field for when the exception cannot be parsed\n  emit($(\"error.stack_trace\", \"\"));\n  return;\n}\ndef source = params['_source'];\nif(source.error?.exception == null) {\n  return;\n}\n// APM Server exception field\ndef exceptions = source.error.exception;\nif(exceptions.size() == 0) {\n  return;\n}\ndef newline = (char)0x0a;\ndef tabspace = (char)0x09;\ndef result = new StringBuilder();\nfor(int i = 0; i < exceptions.size(); i++) {\n  def ex = exceptions[i];\n  if(i == 0) {\n    if(ex.type != null) {\n      result.append(ex.type);\n      result.append(\": \");\n    }\n    result.append(ex.message);\n  } else {\n    result.append(newline);\n    result.append(\"Caused by: \");\n    result.append(ex.message);\n  }\n  def frames = ex.stacktrace;\n  if(frames == null || frames.size() == 0) {\n    continue;\n  }\n  for(int j = 0; j < frames.size(); j++) {\n    def frame = frames[j];\n    result.append(newline);\n    result.append(tabspace);\n    result.append(\"at \");\n    result.append(frame.classname);\n    result.append(\".\");\n    result.append(frame.function);\n    result.append(\"(\");\n    result.append(frame.filename);\n    if(frame.line?.number != null) {\n      result.append(\":\");\n      result.append(frame.line.number);\n    }\n    result.append(\")\")\n  }\n}\nemit(result.toString());\n"
                                            }
                                        },
                                        "_service.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.name\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n}"
                                            }
                                        },
                                        "_service.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.version\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n}"
                                            }
                                        }
                                    },
                                    "fieldAttrs": {
                                        "_stacktrace.group_id": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_timeline.text": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_os.version": {
                                            "customLabel": "os.version",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"os.version\" (for OTel data) or \"host.os.version\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.message": {
                                            "customLabel": "exception.message",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"exception.message\" (for OTel data)."
                                        },
                                        "_app.installation.id": {
                                            "customLabel": "app.installation.id",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"app.installation.id\" (for OTel data) or \"labels.app_installation_id\" (for Elastic APM data) for your own queries."
                                        },
                                        "_span.name": {
                                            "customLabel": "span.name",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"span.name\" (for OTel data), \"transaction.name\" or \"span.name\" (for Elastic APM data) for your own queries."
                                        },
                                        "_duration.ns": {
                                            "customLabel": "duration",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"duration\" (for OTel data), \"transaction.duration.us\" or \"span.duration.us\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.stacktrace": {
                                            "customLabel": "exception.stacktrace",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Do not use in user queries."
                                        },
                                        "_service.name": {
                                            "count": 2,
                                            "customLabel": "service.name",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.name\" for your own queries."
                                        },
                                        "_service.version": {
                                            "customLabel": "service.version",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.version\" for your own queries."
                                        },
                                        "session.id": {
                                            "count": 1
                                        }
                                    },
                                    "allowNoIndex": false,
                                    "name": "android-observability"
                                }
                            },
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "d23814eb-f5c5-4b31-a46f-3f3596bfd0d5": {
                                            "columnOrder": [
                                                "82a08bb3-f81a-4abd-80a8-b626b0644cee",
                                                "7674912a-1492-40db-828e-2b942249a169"
                                            ],
                                            "columns": {
                                                "7674912a-1492-40db-828e-2b942249a169": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count of records",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "sourceField": "___records___"
                                                },
                                                "82a08bb3-f81a-4abd-80a8-b626b0644cee": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top message values",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "columnId": "7674912a-1492-40db-828e-2b942249a169",
                                                            "type": "column"
                                                        },
                                                        "orderDirection": "desc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 10
                                                    },
                                                    "sourceField": "_exception.message"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {}
                                }
                            },
                            "filters": [],
                            "internalReferences": [
                                {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "name": "indexpattern-datasource-layer-d23814eb-f5c5-4b31-a46f-3f3596bfd0d5",
                                    "type": "index-pattern"
                                }
                            ],
                            "query": {
                                "language": "kuery",
                                "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id : * "
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "82a08bb3-f81a-4abd-80a8-b626b0644cee",
                                        "isMetric": false,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "7674912a-1492-40db-828e-2b942249a169",
                                        "isMetric": true,
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "d23814eb-f5c5-4b31-a46f-3f3596bfd0d5",
                                "layerType": "data",
                                "paging": {
                                    "enabled": true,
                                    "size": 10
                                }
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "description": "Shows top messages associated with this exception. Useful when a stacktrace has variables in its message",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "hidePanelTitles": true,
                    "query": {
                        "language": "kuery",
                        "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id : * "
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 11,
                    "i": "db707750-bda5-44c7-89f3-5307c2535717",
                    "w": 24,
                    "x": 0,
                    "y": 10
                },
                "panelIndex": "db707750-bda5-44c7-89f3-5307c2535717",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77": {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "title": "logs-generic.otel*,traces-generic.otel*,logs-apm*,traces-apm*",
                                    "timeFieldName": "@timestamp",
                                    "sourceFilters": [],
                                    "fieldFormats": {},
                                    "runtimeFieldMap": {
                                        "_stacktrace.group_id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"error.grouping_key\") && !doc[\"error.grouping_key\"].isEmpty()) {\n  emit($(\"error.grouping_key\", \"\"));\n  return;\n}\nif(!doc.containsKey(\"exception.stacktrace\") || doc[\"exception.stacktrace\"].isEmpty()){\n    return;\n}\ndef stacktrace = doc[\"exception.stacktrace\"].value;\ndef exceptionType = doc[\"exception.type\"].value;\n\ndef stacktraceLinesPattern = /^[^\\s].+((\\n\\sat.+)+)[\\S\\s]*/;\ndef lineNumberPattern = /:\\d+\\)/;\ndef unwantedLinePattern = /\\nCaused by.+|\\n\\s+\\..+/;\ndef stackTraceLinesMatcher = stacktraceLinesPattern.matcher(stacktrace.replaceAll(unwantedLinePattern, (s)->\"\"));\n\nif(stackTraceLinesMatcher.matches()) {\n    def curatedLines = stackTraceLinesMatcher.group(1).replaceAll(lineNumberPattern, (s)->\")\");\n    def stacktracePattern = exceptionType + curatedLines;\n    emit(String.valueOf(stacktracePattern.hashCode()).encodeBase64());\n}"
                                            }
                                        },
                                        "_timeline.text": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"span.name\", \"\"));\n} else if (doc.containsKey(\"transaction.name\") && !doc[\"transaction.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"transaction.name\", \"\"));\n} else if (doc.containsKey(\"message\")) {\n  if (doc.containsKey(\"event_name\") && !doc[\"event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"event_name\", \"\"));\n  } else if (doc.containsKey(\"otel.event.name\") && !doc[\"otel.event.name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"otel.event.name\", \"\"));\n  } else if (doc.containsKey(\"labels.otel_event_name\") && !doc[\"labels.otel_event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"labels.otel_event_name\", \"\"));\n  } else {\n    emit(\"[Log] - \" + $(\"message\", \"\"));\n  }\n}"
                                            }
                                        },
                                        "_os.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"os.version\")) {\n    emit($(\"os.version\", \"\"));\n} else if(doc.containsKey(\"host.os.version\")) {\n    emit($(\"host.os.version\", \"\"));\n}"
                                            }
                                        },
                                        "_exception.message": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.message\")) {\n  if(!doc[\"exception.message\"].isEmpty()){\n    emit($(\"exception.message\", \"\"));\n  }\n} else if(doc.containsKey(\"error.exception.type\")) {\n  emit($(\"message\", \"\"));\n}"
                                            }
                                        },
                                        "_app.installation.id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"app.installation.id\") && !doc[\"app.installation.id\"].isEmpty()) {\n  emit($(\"app.installation.id\", \"\"));\n} else if (doc.containsKey(\"labels.app_installation_id\") && !doc[\"labels.app_installation_id\"].isEmpty()) {\n  emit($(\"labels.app_installation_id\", \"\"));\n}"
                                            }
                                        },
                                        "_span.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit($(\"span.name\", \"\"));\n} else if(doc.containsKey(\"transaction.name\")) {\n  emit($(\"transaction.name\", \"\"));\n}"
                                            }
                                        },
                                        "_duration.ns": {
                                            "type": "long",
                                            "script": {
                                                "source": "if(doc.containsKey(\"duration\") && !doc[\"duration\"].isEmpty()) {\n  emit($(\"duration\", 0));\n} else if(doc.containsKey(\"transaction.duration.us\") && !doc[\"transaction.duration.us\"].isEmpty()) {\n  emit($(\"transaction.duration.us\", 0) * 1000);\n} else if(doc.containsKey(\"span.duration.us\") && !doc[\"span.duration.us\"].isEmpty()) {\n  emit($(\"span.duration.us\", 0) * 1000);\n}"
                                            }
                                        },
                                        "_exception.stacktrace": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.stacktrace\")) {\n  // EDOT Collector field\n  if(!doc[\"exception.stacktrace\"].isEmpty()) {\n    emit($(\"exception.stacktrace\", \"\"));\n  }\n  return;\n}\nif(doc.containsKey(\"error.stack_trace\") && !doc[\"error.stack_trace\"].isEmpty()) {\n  // APM Server fallback to ECS field for when the exception cannot be parsed\n  emit($(\"error.stack_trace\", \"\"));\n  return;\n}\ndef source = params['_source'];\nif(source.error?.exception == null) {\n  return;\n}\n// APM Server exception field\ndef exceptions = source.error.exception;\nif(exceptions.size() == 0) {\n  return;\n}\ndef newline = (char)0x0a;\ndef tabspace = (char)0x09;\ndef result = new StringBuilder();\nfor(int i = 0; i < exceptions.size(); i++) {\n  def ex = exceptions[i];\n  if(i == 0) {\n    if(ex.type != null) {\n      result.append(ex.type);\n      result.append(\": \");\n    }\n    result.append(ex.message);\n  } else {\n    result.append(newline);\n    result.append(\"Caused by: \");\n    result.append(ex.message);\n  }\n  def frames = ex.stacktrace;\n  if(frames == null || frames.size() == 0) {\n    continue;\n  }\n  for(int j = 0; j < frames.size(); j++) {\n    def frame = frames[j];\n    result.append(newline);\n    result.append(tabspace);\n    result.append(\"at \");\n    result.append(frame.classname);\n    result.append(\".\");\n    result.append(frame.function);\n    result.append(\"(\");\n    result.append(frame.filename);\n    if(frame.line?.number != null) {\n      result.append(\":\");\n      result.append(frame.line.number);\n    }\n    result.append(\")\")\n  }\n}\nemit(result.toString());\n"
                                            }
                                        },
                                        "_service.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.name\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n}"
                                            }
                                        },
                                        "_service.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.version\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n}"
                                            }
                                        }
                                    },
                                    "fieldAttrs": {
                                        "_stacktrace.group_id": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_timeline.text": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_os.version": {
                                            "customLabel": "os.version",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"os.version\" (for OTel data) or \"host.os.version\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.message": {
                                            "customLabel": "exception.message",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"exception.message\" (for OTel data)."
                                        },
                                        "_app.installation.id": {
                                            "customLabel": "app.installation.id",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"app.installation.id\" (for OTel data) or \"labels.app_installation_id\" (for Elastic APM data) for your own queries."
                                        },
                                        "_span.name": {
                                            "customLabel": "span.name",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"span.name\" (for OTel data), \"transaction.name\" or \"span.name\" (for Elastic APM data) for your own queries."
                                        },
                                        "_duration.ns": {
                                            "customLabel": "duration",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"duration\" (for OTel data), \"transaction.duration.us\" or \"span.duration.us\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.stacktrace": {
                                            "customLabel": "exception.stacktrace",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Do not use in user queries."
                                        },
                                        "_service.name": {
                                            "count": 2,
                                            "customLabel": "service.name",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.name\" for your own queries."
                                        },
                                        "_service.version": {
                                            "customLabel": "service.version",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.version\" for your own queries."
                                        },
                                        "session.id": {
                                            "count": 1
                                        }
                                    },
                                    "allowNoIndex": false,
                                    "name": "android-observability"
                                }
                            },
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "e85d6684-402c-4186-a1b5-5aa79db4a066": {
                                            "columnOrder": [
                                                "e6aca9d2-19ed-4db9-8c87-a81a729e146f",
                                                "9471156d-4842-4f16-93cb-9806851bdbe4"
                                            ],
                                            "columns": {
                                                "9471156d-4842-4f16-93cb-9806851bdbe4": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count of _stacktrace.group_id",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "sourceField": "_stacktrace.group_id"
                                                },
                                                "e6aca9d2-19ed-4db9-8c87-a81a729e146f": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top 10 values of service.version",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "fallback": false,
                                                            "type": "alphabetical"
                                                        },
                                                        "orderDirection": "asc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10
                                                    },
                                                    "sourceField": "service.version"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [],
                            "internalReferences": [
                                {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "name": "indexpattern-datasource-layer-e85d6684-402c-4186-a1b5-5aa79db4a066",
                                    "type": "index-pattern"
                                }
                            ],
                            "query": {
                                "language": "kuery",
                                "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id: *"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "emptySizeRatio": 0.54,
                                        "layerId": "e85d6684-402c-4186-a1b5-5aa79db4a066",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "metrics": [
                                            "9471156d-4842-4f16-93cb-9806851bdbe4"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "e6aca9d2-19ed-4db9-8c87-a81a729e146f"
                                        ]
                                    }
                                ],
                                "shape": "donut"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "description": "Shows the number of occurrences by the versions of the selected Android application",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "language": "kuery",
                        "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id: *"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Top affected application versions"
                },
                "gridData": {
                    "h": 11,
                    "i": "ebf1b677-2cac-4c11-b054-eca18feb9615",
                    "w": 8,
                    "x": 24,
                    "y": 10
                },
                "panelIndex": "ebf1b677-2cac-4c11-b054-eca18feb9615",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77": {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "title": "logs-generic.otel*,traces-generic.otel*,logs-apm*,traces-apm*",
                                    "timeFieldName": "@timestamp",
                                    "sourceFilters": [],
                                    "fieldFormats": {},
                                    "runtimeFieldMap": {
                                        "_stacktrace.group_id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"error.grouping_key\") && !doc[\"error.grouping_key\"].isEmpty()) {\n  emit($(\"error.grouping_key\", \"\"));\n  return;\n}\nif(!doc.containsKey(\"exception.stacktrace\") || doc[\"exception.stacktrace\"].isEmpty()){\n    return;\n}\ndef stacktrace = doc[\"exception.stacktrace\"].value;\ndef exceptionType = doc[\"exception.type\"].value;\n\ndef stacktraceLinesPattern = /^[^\\s].+((\\n\\sat.+)+)[\\S\\s]*/;\ndef lineNumberPattern = /:\\d+\\)/;\ndef unwantedLinePattern = /\\nCaused by.+|\\n\\s+\\..+/;\ndef stackTraceLinesMatcher = stacktraceLinesPattern.matcher(stacktrace.replaceAll(unwantedLinePattern, (s)->\"\"));\n\nif(stackTraceLinesMatcher.matches()) {\n    def curatedLines = stackTraceLinesMatcher.group(1).replaceAll(lineNumberPattern, (s)->\")\");\n    def stacktracePattern = exceptionType + curatedLines;\n    emit(String.valueOf(stacktracePattern.hashCode()).encodeBase64());\n}"
                                            }
                                        },
                                        "_timeline.text": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"span.name\", \"\"));\n} else if (doc.containsKey(\"transaction.name\") && !doc[\"transaction.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"transaction.name\", \"\"));\n} else if (doc.containsKey(\"message\")) {\n  if (doc.containsKey(\"event_name\") && !doc[\"event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"event_name\", \"\"));\n  } else if (doc.containsKey(\"otel.event.name\") && !doc[\"otel.event.name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"otel.event.name\", \"\"));\n  } else if (doc.containsKey(\"labels.otel_event_name\") && !doc[\"labels.otel_event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"labels.otel_event_name\", \"\"));\n  } else {\n    emit(\"[Log] - \" + $(\"message\", \"\"));\n  }\n}"
                                            }
                                        },
                                        "_os.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"os.version\")) {\n    emit($(\"os.version\", \"\"));\n} else if(doc.containsKey(\"host.os.version\")) {\n    emit($(\"host.os.version\", \"\"));\n}"
                                            }
                                        },
                                        "_exception.message": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.message\")) {\n  if(!doc[\"exception.message\"].isEmpty()){\n    emit($(\"exception.message\", \"\"));\n  }\n} else if(doc.containsKey(\"error.exception.type\")) {\n  emit($(\"message\", \"\"));\n}"
                                            }
                                        },
                                        "_app.installation.id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"app.installation.id\") && !doc[\"app.installation.id\"].isEmpty()) {\n  emit($(\"app.installation.id\", \"\"));\n} else if (doc.containsKey(\"labels.app_installation_id\") && !doc[\"labels.app_installation_id\"].isEmpty()) {\n  emit($(\"labels.app_installation_id\", \"\"));\n}"
                                            }
                                        },
                                        "_span.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit($(\"span.name\", \"\"));\n} else if(doc.containsKey(\"transaction.name\")) {\n  emit($(\"transaction.name\", \"\"));\n}"
                                            }
                                        },
                                        "_duration.ns": {
                                            "type": "long",
                                            "script": {
                                                "source": "if(doc.containsKey(\"duration\") && !doc[\"duration\"].isEmpty()) {\n  emit($(\"duration\", 0));\n} else if(doc.containsKey(\"transaction.duration.us\") && !doc[\"transaction.duration.us\"].isEmpty()) {\n  emit($(\"transaction.duration.us\", 0) * 1000);\n} else if(doc.containsKey(\"span.duration.us\") && !doc[\"span.duration.us\"].isEmpty()) {\n  emit($(\"span.duration.us\", 0) * 1000);\n}"
                                            }
                                        },
                                        "_exception.stacktrace": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.stacktrace\")) {\n  // EDOT Collector field\n  if(!doc[\"exception.stacktrace\"].isEmpty()) {\n    emit($(\"exception.stacktrace\", \"\"));\n  }\n  return;\n}\nif(doc.containsKey(\"error.stack_trace\") && !doc[\"error.stack_trace\"].isEmpty()) {\n  // APM Server fallback to ECS field for when the exception cannot be parsed\n  emit($(\"error.stack_trace\", \"\"));\n  return;\n}\ndef source = params['_source'];\nif(source.error?.exception == null) {\n  return;\n}\n// APM Server exception field\ndef exceptions = source.error.exception;\nif(exceptions.size() == 0) {\n  return;\n}\ndef newline = (char)0x0a;\ndef tabspace = (char)0x09;\ndef result = new StringBuilder();\nfor(int i = 0; i < exceptions.size(); i++) {\n  def ex = exceptions[i];\n  if(i == 0) {\n    if(ex.type != null) {\n      result.append(ex.type);\n      result.append(\": \");\n    }\n    result.append(ex.message);\n  } else {\n    result.append(newline);\n    result.append(\"Caused by: \");\n    result.append(ex.message);\n  }\n  def frames = ex.stacktrace;\n  if(frames == null || frames.size() == 0) {\n    continue;\n  }\n  for(int j = 0; j < frames.size(); j++) {\n    def frame = frames[j];\n    result.append(newline);\n    result.append(tabspace);\n    result.append(\"at \");\n    result.append(frame.classname);\n    result.append(\".\");\n    result.append(frame.function);\n    result.append(\"(\");\n    result.append(frame.filename);\n    if(frame.line?.number != null) {\n      result.append(\":\");\n      result.append(frame.line.number);\n    }\n    result.append(\")\")\n  }\n}\nemit(result.toString());\n"
                                            }
                                        },
                                        "_service.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.name\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n}"
                                            }
                                        },
                                        "_service.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.version\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n}"
                                            }
                                        }
                                    },
                                    "fieldAttrs": {
                                        "_stacktrace.group_id": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_timeline.text": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_os.version": {
                                            "customLabel": "os.version",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"os.version\" (for OTel data) or \"host.os.version\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.message": {
                                            "customLabel": "exception.message",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"exception.message\" (for OTel data)."
                                        },
                                        "_app.installation.id": {
                                            "customLabel": "app.installation.id",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"app.installation.id\" (for OTel data) or \"labels.app_installation_id\" (for Elastic APM data) for your own queries."
                                        },
                                        "_span.name": {
                                            "customLabel": "span.name",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"span.name\" (for OTel data), \"transaction.name\" or \"span.name\" (for Elastic APM data) for your own queries."
                                        },
                                        "_duration.ns": {
                                            "customLabel": "duration",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"duration\" (for OTel data), \"transaction.duration.us\" or \"span.duration.us\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.stacktrace": {
                                            "customLabel": "exception.stacktrace",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Do not use in user queries."
                                        },
                                        "_service.name": {
                                            "count": 2,
                                            "customLabel": "service.name",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.name\" for your own queries."
                                        },
                                        "_service.version": {
                                            "customLabel": "service.version",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.version\" for your own queries."
                                        },
                                        "session.id": {
                                            "count": 1
                                        }
                                    },
                                    "allowNoIndex": false,
                                    "name": "android-observability"
                                }
                            },
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "e85d6684-402c-4186-a1b5-5aa79db4a066": {
                                            "columnOrder": [
                                                "e6aca9d2-19ed-4db9-8c87-a81a729e146f",
                                                "9471156d-4842-4f16-93cb-9806851bdbe4"
                                            ],
                                            "columns": {
                                                "9471156d-4842-4f16-93cb-9806851bdbe4": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count of _stacktrace.group_id",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "sourceField": "_stacktrace.group_id"
                                                },
                                                "e6aca9d2-19ed-4db9-8c87-a81a729e146f": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top 10 values of _os.version",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "fallback": false,
                                                            "type": "alphabetical"
                                                        },
                                                        "orderDirection": "asc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10
                                                    },
                                                    "sourceField": "_os.version"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [],
                            "internalReferences": [
                                {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "name": "indexpattern-datasource-layer-e85d6684-402c-4186-a1b5-5aa79db4a066",
                                    "type": "index-pattern"
                                }
                            ],
                            "query": {
                                "language": "kuery",
                                "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id: * and (os.version: * or host.os.version: *)"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "emptySizeRatio": 0.54,
                                        "layerId": "e85d6684-402c-4186-a1b5-5aa79db4a066",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "metrics": [
                                            "9471156d-4842-4f16-93cb-9806851bdbe4"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "e6aca9d2-19ed-4db9-8c87-a81a729e146f"
                                        ]
                                    }
                                ],
                                "shape": "donut"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "description": "Shows the number of occurrences by Android OS version",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "language": "kuery",
                        "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id: * and (os.version: * or host.os.version: *)"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Top affected OS versions"
                },
                "gridData": {
                    "h": 11,
                    "i": "46b18d81-c2cc-42d3-82c6-4956597c18db",
                    "w": 8,
                    "x": 32,
                    "y": 10
                },
                "panelIndex": "46b18d81-c2cc-42d3-82c6-4956597c18db",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77": {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "title": "logs-generic.otel*,traces-generic.otel*,logs-apm*,traces-apm*",
                                    "timeFieldName": "@timestamp",
                                    "sourceFilters": [],
                                    "fieldFormats": {},
                                    "runtimeFieldMap": {
                                        "_stacktrace.group_id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"error.grouping_key\") && !doc[\"error.grouping_key\"].isEmpty()) {\n  emit($(\"error.grouping_key\", \"\"));\n  return;\n}\nif(!doc.containsKey(\"exception.stacktrace\") || doc[\"exception.stacktrace\"].isEmpty()){\n    return;\n}\ndef stacktrace = doc[\"exception.stacktrace\"].value;\ndef exceptionType = doc[\"exception.type\"].value;\n\ndef stacktraceLinesPattern = /^[^\\s].+((\\n\\sat.+)+)[\\S\\s]*/;\ndef lineNumberPattern = /:\\d+\\)/;\ndef unwantedLinePattern = /\\nCaused by.+|\\n\\s+\\..+/;\ndef stackTraceLinesMatcher = stacktraceLinesPattern.matcher(stacktrace.replaceAll(unwantedLinePattern, (s)->\"\"));\n\nif(stackTraceLinesMatcher.matches()) {\n    def curatedLines = stackTraceLinesMatcher.group(1).replaceAll(lineNumberPattern, (s)->\")\");\n    def stacktracePattern = exceptionType + curatedLines;\n    emit(String.valueOf(stacktracePattern.hashCode()).encodeBase64());\n}"
                                            }
                                        },
                                        "_timeline.text": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"span.name\", \"\"));\n} else if (doc.containsKey(\"transaction.name\") && !doc[\"transaction.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"transaction.name\", \"\"));\n} else if (doc.containsKey(\"message\")) {\n  if (doc.containsKey(\"event_name\") && !doc[\"event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"event_name\", \"\"));\n  } else if (doc.containsKey(\"otel.event.name\") && !doc[\"otel.event.name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"otel.event.name\", \"\"));\n  } else if (doc.containsKey(\"labels.otel_event_name\") && !doc[\"labels.otel_event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"labels.otel_event_name\", \"\"));\n  } else {\n    emit(\"[Log] - \" + $(\"message\", \"\"));\n  }\n}"
                                            }
                                        },
                                        "_os.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"os.version\")) {\n    emit($(\"os.version\", \"\"));\n} else if(doc.containsKey(\"host.os.version\")) {\n    emit($(\"host.os.version\", \"\"));\n}"
                                            }
                                        },
                                        "_exception.message": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.message\")) {\n  if(!doc[\"exception.message\"].isEmpty()){\n    emit($(\"exception.message\", \"\"));\n  }\n} else if(doc.containsKey(\"error.exception.type\")) {\n  emit($(\"message\", \"\"));\n}"
                                            }
                                        },
                                        "_app.installation.id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"app.installation.id\") && !doc[\"app.installation.id\"].isEmpty()) {\n  emit($(\"app.installation.id\", \"\"));\n} else if (doc.containsKey(\"labels.app_installation_id\") && !doc[\"labels.app_installation_id\"].isEmpty()) {\n  emit($(\"labels.app_installation_id\", \"\"));\n}"
                                            }
                                        },
                                        "_span.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit($(\"span.name\", \"\"));\n} else if(doc.containsKey(\"transaction.name\")) {\n  emit($(\"transaction.name\", \"\"));\n}"
                                            }
                                        },
                                        "_duration.ns": {
                                            "type": "long",
                                            "script": {
                                                "source": "if(doc.containsKey(\"duration\") && !doc[\"duration\"].isEmpty()) {\n  emit($(\"duration\", 0));\n} else if(doc.containsKey(\"transaction.duration.us\") && !doc[\"transaction.duration.us\"].isEmpty()) {\n  emit($(\"transaction.duration.us\", 0) * 1000);\n} else if(doc.containsKey(\"span.duration.us\") && !doc[\"span.duration.us\"].isEmpty()) {\n  emit($(\"span.duration.us\", 0) * 1000);\n}"
                                            }
                                        },
                                        "_exception.stacktrace": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.stacktrace\")) {\n  // EDOT Collector field\n  if(!doc[\"exception.stacktrace\"].isEmpty()) {\n    emit($(\"exception.stacktrace\", \"\"));\n  }\n  return;\n}\nif(doc.containsKey(\"error.stack_trace\") && !doc[\"error.stack_trace\"].isEmpty()) {\n  // APM Server fallback to ECS field for when the exception cannot be parsed\n  emit($(\"error.stack_trace\", \"\"));\n  return;\n}\ndef source = params['_source'];\nif(source.error?.exception == null) {\n  return;\n}\n// APM Server exception field\ndef exceptions = source.error.exception;\nif(exceptions.size() == 0) {\n  return;\n}\ndef newline = (char)0x0a;\ndef tabspace = (char)0x09;\ndef result = new StringBuilder();\nfor(int i = 0; i < exceptions.size(); i++) {\n  def ex = exceptions[i];\n  if(i == 0) {\n    if(ex.type != null) {\n      result.append(ex.type);\n      result.append(\": \");\n    }\n    result.append(ex.message);\n  } else {\n    result.append(newline);\n    result.append(\"Caused by: \");\n    result.append(ex.message);\n  }\n  def frames = ex.stacktrace;\n  if(frames == null || frames.size() == 0) {\n    continue;\n  }\n  for(int j = 0; j < frames.size(); j++) {\n    def frame = frames[j];\n    result.append(newline);\n    result.append(tabspace);\n    result.append(\"at \");\n    result.append(frame.classname);\n    result.append(\".\");\n    result.append(frame.function);\n    result.append(\"(\");\n    result.append(frame.filename);\n    if(frame.line?.number != null) {\n      result.append(\":\");\n      result.append(frame.line.number);\n    }\n    result.append(\")\")\n  }\n}\nemit(result.toString());\n"
                                            }
                                        },
                                        "_service.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.name\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n}"
                                            }
                                        },
                                        "_service.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.version\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n}"
                                            }
                                        }
                                    },
                                    "fieldAttrs": {
                                        "_stacktrace.group_id": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_timeline.text": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_os.version": {
                                            "customLabel": "os.version",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"os.version\" (for OTel data) or \"host.os.version\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.message": {
                                            "customLabel": "exception.message",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"exception.message\" (for OTel data)."
                                        },
                                        "_app.installation.id": {
                                            "customLabel": "app.installation.id",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"app.installation.id\" (for OTel data) or \"labels.app_installation_id\" (for Elastic APM data) for your own queries."
                                        },
                                        "_span.name": {
                                            "customLabel": "span.name",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"span.name\" (for OTel data), \"transaction.name\" or \"span.name\" (for Elastic APM data) for your own queries."
                                        },
                                        "_duration.ns": {
                                            "customLabel": "duration",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"duration\" (for OTel data), \"transaction.duration.us\" or \"span.duration.us\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.stacktrace": {
                                            "customLabel": "exception.stacktrace",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Do not use in user queries."
                                        },
                                        "_service.name": {
                                            "count": 2,
                                            "customLabel": "service.name",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.name\" for your own queries."
                                        },
                                        "_service.version": {
                                            "customLabel": "service.version",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.version\" for your own queries."
                                        },
                                        "session.id": {
                                            "count": 1
                                        }
                                    },
                                    "allowNoIndex": false,
                                    "name": "android-observability"
                                }
                            },
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "e85d6684-402c-4186-a1b5-5aa79db4a066": {
                                            "columnOrder": [
                                                "e6aca9d2-19ed-4db9-8c87-a81a729e146f",
                                                "9471156d-4842-4f16-93cb-9806851bdbe4"
                                            ],
                                            "columns": {
                                                "9471156d-4842-4f16-93cb-9806851bdbe4": {
                                                    "dataType": "number",
                                                    "isBucketed": false,
                                                    "label": "Count of _stacktrace.group_id",
                                                    "operationType": "count",
                                                    "params": {
                                                        "emptyAsNull": true
                                                    },
                                                    "sourceField": "_stacktrace.group_id"
                                                },
                                                "e6aca9d2-19ed-4db9-8c87-a81a729e146f": {
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "Top 10 values of device.manufacturer",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "fallback": false,
                                                            "type": "alphabetical"
                                                        },
                                                        "orderDirection": "asc",
                                                        "otherBucket": true,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "secondaryFields": [],
                                                        "size": 10
                                                    },
                                                    "sourceField": "device.manufacturer"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "layers": {}
                                }
                            },
                            "filters": [],
                            "internalReferences": [
                                {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "name": "indexpattern-datasource-layer-e85d6684-402c-4186-a1b5-5aa79db4a066",
                                    "type": "index-pattern"
                                }
                            ],
                            "query": {
                                "language": "kuery",
                                "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id: * and device.manufacturer: *"
                            },
                            "visualization": {
                                "layers": [
                                    {
                                        "categoryDisplay": "default",
                                        "colorMapping": {
                                            "assignments": [],
                                            "colorMode": {
                                                "type": "categorical"
                                            },
                                            "paletteId": "default",
                                            "specialAssignments": [
                                                {
                                                    "color": {
                                                        "type": "loop"
                                                    },
                                                    "rules": [
                                                        {
                                                            "type": "other"
                                                        }
                                                    ],
                                                    "touched": false
                                                }
                                            ]
                                        },
                                        "emptySizeRatio": 0.54,
                                        "layerId": "e85d6684-402c-4186-a1b5-5aa79db4a066",
                                        "layerType": "data",
                                        "legendDisplay": "default",
                                        "metrics": [
                                            "9471156d-4842-4f16-93cb-9806851bdbe4"
                                        ],
                                        "nestedLegend": false,
                                        "numberDisplay": "percent",
                                        "primaryGroups": [
                                            "e6aca9d2-19ed-4db9-8c87-a81a729e146f"
                                        ]
                                    }
                                ],
                                "shape": "donut"
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsPie"
                    },
                    "description": "Shows the number of occurrences by Android device manufacturer",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "query": {
                        "language": "kuery",
                        "query": "(os.name: \"Android\" or host.os.name: \"Android\") and (exception.stacktrace: * or error.grouping_key: *) and session.id: * and device.manufacturer: *"
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false,
                    "title": "Top affected manufacturers"
                },
                "gridData": {
                    "h": 11,
                    "i": "fd15ebf6-0989-4d92-a54e-1a95a1852f38",
                    "w": 8,
                    "x": 40,
                    "y": 10
                },
                "panelIndex": "fd15ebf6-0989-4d92-a54e-1a95a1852f38",
                "type": "lens"
            },
            {
                "embeddableConfig": {
                    "attributes": {
                        "references": [],
                        "state": {
                            "adHocDataViews": {
                                "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77": {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "title": "logs-generic.otel*,traces-generic.otel*,logs-apm*,traces-apm*",
                                    "timeFieldName": "@timestamp",
                                    "sourceFilters": [],
                                    "fieldFormats": {},
                                    "runtimeFieldMap": {
                                        "_stacktrace.group_id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"error.grouping_key\") && !doc[\"error.grouping_key\"].isEmpty()) {\n  emit($(\"error.grouping_key\", \"\"));\n  return;\n}\nif(!doc.containsKey(\"exception.stacktrace\") || doc[\"exception.stacktrace\"].isEmpty()){\n    return;\n}\ndef stacktrace = doc[\"exception.stacktrace\"].value;\ndef exceptionType = doc[\"exception.type\"].value;\n\ndef stacktraceLinesPattern = /^[^\\s].+((\\n\\sat.+)+)[\\S\\s]*/;\ndef lineNumberPattern = /:\\d+\\)/;\ndef unwantedLinePattern = /\\nCaused by.+|\\n\\s+\\..+/;\ndef stackTraceLinesMatcher = stacktraceLinesPattern.matcher(stacktrace.replaceAll(unwantedLinePattern, (s)->\"\"));\n\nif(stackTraceLinesMatcher.matches()) {\n    def curatedLines = stackTraceLinesMatcher.group(1).replaceAll(lineNumberPattern, (s)->\")\");\n    def stacktracePattern = exceptionType + curatedLines;\n    emit(String.valueOf(stacktracePattern.hashCode()).encodeBase64());\n}"
                                            }
                                        },
                                        "_timeline.text": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"span.name\", \"\"));\n} else if (doc.containsKey(\"transaction.name\") && !doc[\"transaction.name\"].isEmpty()) {\n  emit(\"[Span] - \" + $(\"transaction.name\", \"\"));\n} else if (doc.containsKey(\"message\")) {\n  if (doc.containsKey(\"event_name\") && !doc[\"event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"event_name\", \"\"));\n  } else if (doc.containsKey(\"otel.event.name\") && !doc[\"otel.event.name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"otel.event.name\", \"\"));\n  } else if (doc.containsKey(\"labels.otel_event_name\") && !doc[\"labels.otel_event_name\"].isEmpty()) {\n    emit(\"[Log] - \" + $(\"labels.otel_event_name\", \"\"));\n  } else {\n    emit(\"[Log] - \" + $(\"message\", \"\"));\n  }\n}"
                                            }
                                        },
                                        "_os.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"os.version\")) {\n    emit($(\"os.version\", \"\"));\n} else if(doc.containsKey(\"host.os.version\")) {\n    emit($(\"host.os.version\", \"\"));\n}"
                                            }
                                        },
                                        "_exception.message": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.message\")) {\n  if(!doc[\"exception.message\"].isEmpty()){\n    emit($(\"exception.message\", \"\"));\n  }\n} else if(doc.containsKey(\"error.exception.type\")) {\n  emit($(\"message\", \"\"));\n}"
                                            }
                                        },
                                        "_app.installation.id": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"app.installation.id\") && !doc[\"app.installation.id\"].isEmpty()) {\n  emit($(\"app.installation.id\", \"\"));\n} else if (doc.containsKey(\"labels.app_installation_id\") && !doc[\"labels.app_installation_id\"].isEmpty()) {\n  emit($(\"labels.app_installation_id\", \"\"));\n}"
                                            }
                                        },
                                        "_span.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"span.name\") && !doc[\"span.name\"].isEmpty()) {\n  emit($(\"span.name\", \"\"));\n} else if(doc.containsKey(\"transaction.name\")) {\n  emit($(\"transaction.name\", \"\"));\n}"
                                            }
                                        },
                                        "_duration.ns": {
                                            "type": "long",
                                            "script": {
                                                "source": "if(doc.containsKey(\"duration\") && !doc[\"duration\"].isEmpty()) {\n  emit($(\"duration\", 0));\n} else if(doc.containsKey(\"transaction.duration.us\") && !doc[\"transaction.duration.us\"].isEmpty()) {\n  emit($(\"transaction.duration.us\", 0) * 1000);\n} else if(doc.containsKey(\"span.duration.us\") && !doc[\"span.duration.us\"].isEmpty()) {\n  emit($(\"span.duration.us\", 0) * 1000);\n}"
                                            }
                                        },
                                        "_exception.stacktrace": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(doc.containsKey(\"exception.stacktrace\")) {\n  // EDOT Collector field\n  if(!doc[\"exception.stacktrace\"].isEmpty()) {\n    emit($(\"exception.stacktrace\", \"\"));\n  }\n  return;\n}\nif(doc.containsKey(\"error.stack_trace\") && !doc[\"error.stack_trace\"].isEmpty()) {\n  // APM Server fallback to ECS field for when the exception cannot be parsed\n  emit($(\"error.stack_trace\", \"\"));\n  return;\n}\ndef source = params['_source'];\nif(source.error?.exception == null) {\n  return;\n}\n// APM Server exception field\ndef exceptions = source.error.exception;\nif(exceptions.size() == 0) {\n  return;\n}\ndef newline = (char)0x0a;\ndef tabspace = (char)0x09;\ndef result = new StringBuilder();\nfor(int i = 0; i < exceptions.size(); i++) {\n  def ex = exceptions[i];\n  if(i == 0) {\n    if(ex.type != null) {\n      result.append(ex.type);\n      result.append(\": \");\n    }\n    result.append(ex.message);\n  } else {\n    result.append(newline);\n    result.append(\"Caused by: \");\n    result.append(ex.message);\n  }\n  def frames = ex.stacktrace;\n  if(frames == null || frames.size() == 0) {\n    continue;\n  }\n  for(int j = 0; j < frames.size(); j++) {\n    def frame = frames[j];\n    result.append(newline);\n    result.append(tabspace);\n    result.append(\"at \");\n    result.append(frame.classname);\n    result.append(\".\");\n    result.append(frame.function);\n    result.append(\"(\");\n    result.append(frame.filename);\n    if(frame.line?.number != null) {\n      result.append(\":\");\n      result.append(frame.line.number);\n    }\n    result.append(\")\")\n  }\n}\nemit(result.toString());\n"
                                            }
                                        },
                                        "_service.name": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.name\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.name\", \"unknown\"));\n  }\n}"
                                            }
                                        },
                                        "_service.version": {
                                            "type": "keyword",
                                            "script": {
                                                "source": "if(!doc.containsKey(\"service.version\")) {\n  return;\n}\nif(doc.containsKey(\"os.name\")) {\n  if($(\"os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n} else if(doc.containsKey(\"host.os.name\")){\n  if($(\"host.os.name\", \"\") == \"Android\") {\n    emit($(\"service.version\", \"\"));\n  }\n}"
                                            }
                                        }
                                    },
                                    "fieldAttrs": {
                                        "_stacktrace.group_id": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_timeline.text": {
                                            "customDescription": "Internal field used by Elastic dashboards. Do not use in user queries."
                                        },
                                        "_os.version": {
                                            "customLabel": "os.version",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"os.version\" (for OTel data) or \"host.os.version\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.message": {
                                            "customLabel": "exception.message",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"exception.message\" (for OTel data)."
                                        },
                                        "_app.installation.id": {
                                            "customLabel": "app.installation.id",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"app.installation.id\" (for OTel data) or \"labels.app_installation_id\" (for Elastic APM data) for your own queries."
                                        },
                                        "_span.name": {
                                            "customLabel": "span.name",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"span.name\" (for OTel data), \"transaction.name\" or \"span.name\" (for Elastic APM data) for your own queries."
                                        },
                                        "_duration.ns": {
                                            "customLabel": "duration",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Use \"duration\" (for OTel data), \"transaction.duration.us\" or \"span.duration.us\" (for Elastic APM data) for your own queries."
                                        },
                                        "_exception.stacktrace": {
                                            "customLabel": "exception.stacktrace",
                                            "customDescription": "Internal mapping for both OTel and APM relevant fields. Do not use in user queries."
                                        },
                                        "_service.name": {
                                            "count": 2,
                                            "customLabel": "service.name",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.name\" for your own queries."
                                        },
                                        "_service.version": {
                                            "customLabel": "service.version",
                                            "customDescription": "Internal field used by Elastic dashboards. Use \"service.version\" for your own queries."
                                        },
                                        "session.id": {
                                            "count": 1
                                        }
                                    },
                                    "allowNoIndex": false,
                                    "name": "android-observability"
                                }
                            },
                            "datasourceStates": {
                                "formBased": {
                                    "layers": {
                                        "2bde3947-c2de-42af-bc3e-d7c0e36110cd": {
                                            "columnOrder": [
                                                "f166a468-6742-4c90-93a8-4fb255aa5cc2",
                                                "937b40e6-4766-4606-8d40-265179f4101e"
                                            ],
                                            "columns": {
                                                "937b40e6-4766-4606-8d40-265179f4101e": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "filter": {
                                                        "language": "kuery",
                                                        "query": "(exception.stacktrace: * or error.grouping_key: *)"
                                                    },
                                                    "isBucketed": false,
                                                    "label": "Stacktrace",
                                                    "operationType": "last_value",
                                                    "params": {
                                                        "showArrayValues": true,
                                                        "sortField": "@timestamp"
                                                    },
                                                    "sourceField": "_exception.stacktrace"
                                                },
                                                "f166a468-6742-4c90-93a8-4fb255aa5cc2": {
                                                    "customLabel": true,
                                                    "dataType": "string",
                                                    "isBucketed": true,
                                                    "label": "_stacktrace.group_id",
                                                    "operationType": "terms",
                                                    "params": {
                                                        "exclude": [],
                                                        "excludeIsRegex": false,
                                                        "include": [],
                                                        "includeIsRegex": false,
                                                        "missingBucket": false,
                                                        "orderBy": {
                                                            "fallback": true,
                                                            "type": "alphabetical"
                                                        },
                                                        "orderDirection": "asc",
                                                        "otherBucket": false,
                                                        "parentFormat": {
                                                            "id": "terms"
                                                        },
                                                        "size": 1
                                                    },
                                                    "sourceField": "_stacktrace.group_id"
                                                }
                                            },
                                            "ignoreGlobalFilters": false,
                                            "incompleteColumns": {},
                                            "sampling": 1
                                        }
                                    }
                                },
                                "indexpattern": {
                                    "layers": {}
                                },
                                "textBased": {
                                    "indexPatternRefs": [],
                                    "layers": {}
                                }
                            },
                            "filters": [],
                            "internalReferences": [
                                {
                                    "id": "9fffeed5-13fb-4ca8-ace7-7c7d6e1f5d77",
                                    "name": "indexpattern-datasource-layer-2bde3947-c2de-42af-bc3e-d7c0e36110cd",
                                    "type": "index-pattern"
                                }
                            ],
                            "query": {
                                "language": "kuery",
                                "query": "(os.name: \"Android\" or host.os.name: \"Android\") and session.id : * and (exception.stacktrace: * or error.grouping_key: *) "
                            },
                            "visualization": {
                                "columns": [
                                    {
                                        "columnId": "f166a468-6742-4c90-93a8-4fb255aa5cc2",
                                        "hidden": true,
                                        "isMetric": false,
                                        "isTransposed": false
                                    },
                                    {
                                        "columnId": "937b40e6-4766-4606-8d40-265179f4101e",
                                        "isMetric": true,
                                        "isTransposed": false
                                    }
                                ],
                                "layerId": "2bde3947-c2de-42af-bc3e-d7c0e36110cd",
                                "layerType": "data",
                                "rowHeight": "auto",
                                "rowHeightLines": -1
                            }
                        },
                        "title": "",
                        "type": "lens",
                        "visualizationType": "lnsDatatable"
                    },
                    "description": "Shows the full stacktrace for the selected exception",
                    "enhancements": {
                        "dynamicActions": {
                            "events": []
                        }
                    },
                    "filters": [],
                    "hidePanelTitles": true,
                    "query": {
                        "language": "kuery",
                        "query": "(os.name: \"Android\" or host.os.name: \"Android\") and session.id : * and (exception.stacktrace: * or error.grouping_key: *) "
                    },
                    "syncColors": false,
                    "syncCursor": true,
                    "syncTooltips": false
                },
                "gridData": {
                    "h": 21,
                    "i": "e90b57f5-ad97-4a2e-87f8-3604d75f8ba6",
                    "w": 48,
                    "x": 0,
                    "y": 21
                },
                "panelIndex": "e90b57f5-ad97-4a2e-87f8-3604d75f8ba6",
                "type": "lens"
            }
        ],
        "timeRestore": false,
        "title": "Android Exception Details",
        "version": 3
    },
    "coreMigrationVersion": "8.8.0",
    "created_at": "2026-02-19T09:03:49.279Z",
    "created_by": "u_mGBROF_q5bmFCATbLXAcCwKa0k8JvONAwSruelyKA5E_0",
    "id": "otel_android_dashboards-4cff90ff-0bd6-48eb-9ea6-57f91391ebce",
    "references": [
        {
            "id": "otel_android_dashboards-66c53e5e-9a86-43f3-a85d-a1d90d974bff",
            "name": "eed746a9-7e1d-4258-a46c-e2ced4100f5e:drilldown:DASHBOARD_TO_DASHBOARD_DRILLDOWN:dd9d5fda-48a3-4c5d-9679-559a8382965f:dashboardId",
            "type": "dashboard"
        }
    ],
    "type": "dashboard",
    "typeMigrationVersion": "10.3.0",
    "updated_by": "u_mGBROF_q5bmFCATbLXAcCwKa0k8JvONAwSruelyKA5E_0"
}
