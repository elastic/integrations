format_version: 3.4.1
name: projectdiscovery_cloud
title: "ProjectDiscovery Cloud"
version: 0.1.1
source:
  license: "Elastic-2.0"
description: >
  External Attack Surface Management (EASM) from ProjectDiscovery. Collects vulnerability changelogs via the ProjectDiscovery Cloud API.

type: integration
categories:
  - security
conditions:
  kibana:
    version: "^9.1.0"
  elastic:
    subscription: "platinum"
owner:
  github: elastic/integrations
  type: elastic
# Drives Fleet "Add integration" form and supplies .vars.* to templates.
policy_templates:
  - name: projectdiscovery_cloud
    title: ProjectDiscovery Cloud
    description: Collect vulnerability changelogs from ProjectDiscovery Cloud
    inputs:
      - type: httpjson
        title: ProjectDiscovery Cloud API
        description: Collects vulnerability changelog events from ProjectDiscovery Cloud
        vars:
          - name: base_url
            type: text
            title: API Base URL
            default: https://api.projectdiscovery.io
            required: true
          - name: api_key
            type: text
            title: API Key
            # You may mark as secret in production; during local dev, plain text avoids interpolation pitfalls.
            secret: false
            required: true
          - name: team_id
            type: text
            title: Team ID
            # Required for your tenant (your curl needed it). Make it required to avoid empty header -> 401.
            secret: false
            required: true
          - name: interval
            type: text
            title: Collection interval
            default: 5m
            required: true
          - name: batch_size
            type: integer
            title: Batch size
            default: 100
            required: true
          - name: time_window
            type: text
            title: Time window (PD `time` query param)
            default: last_day
            required: false
          - name: http_client_timeout
            type: text
            title: HTTP client timeout
            default: 10m
            required: false
          - name: enable_request_tracer
            type: bool
            title: Enable HTTP request tracing
            description: Enable detailed HTTP request/response logging for debugging. Writes to ../../logs/httpjson/http-request-trace-*.ndjson
            default: false
            required: false
