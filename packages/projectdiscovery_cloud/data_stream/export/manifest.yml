title: Collect Vulnerability Results from ProjectDiscovery Cloud
type: logs
streams:
  - input: cel
    template_path: cel.yml.hbs
    title: Vulnerability Results Export
    description: Collect current vulnerability state snapshots from ProjectDiscovery Cloud.
    enabled: false
    vars:
      - name: interval
        type: text
        title: Interval
        description: Duration between requests to the ProjectDiscovery Cloud API. Supported units for this parameter are h/m/s.
        default: 24h
        multi: false
        required: true
        show_user: true
      - name: vuln_status
        type: text
        title: Vulnerability Status Filter
        description: Comma-separated list of vulnerability statuses to export (e.g., "open,triaged,fix_in_progress"). Leave empty to export all.
        multi: false
        required: false
        show_user: true
        default: open
      - name: severity
        type: text
        title: Severity Filter
        description: Comma-separated list of severity levels to export (e.g., "low,medium,high,critical"). Leave empty to export all.
        multi: false
        required: false
        show_user: true
      - name: http_client_timeout
        type: text
        title: HTTP Client Timeout
        description: Duration before declaring that the HTTP client connection has timed out. Valid time units are ns, us, ms, s, m, h.
        multi: false
        required: true
        show_user: false
        default: 10m
      - name: enable_request_tracer
        type: bool
        title: Enable request tracing
        default: false
        multi: false
        required: false
        show_user: false
        description: >-
          The request tracer logs requests and responses to the agent's local file-system for debugging configurations. Enabling this request tracing compromises security and should only be used for debugging. Disabling the request tracer will delete any stored traces.
      - name: ssl
        type: yaml
        title: SSL Configuration
        description: SSL configuration for the HTTP client. See [SSL Configuration](https://www.elastic.co/guide/en/beats/filebeat/current/configuration-ssl.html) for details.
        multi: false
        required: false
        show_user: false
        default: |
          #verification_mode: full
          #certificate_authorities:
          #  - |
          #    -----BEGIN CERTIFICATE-----
          #    MIIDCjCCAfKgAwIBAgITJ706Mu2wJlKckpIvkWxEHvEyijANBgkqhkiG9w0BAQsF
          #    ADAUMRIwEAYDVQQDDAlsb2NhbGhvc3QwIBcNMTkwNzIyMTkyOTA0WhgPMjExOTA2
          #    MjgxOTI5MDRaMBQxEjAQBgNVBAMMCWxvY2FsaG9zdDCCASIwDQYJKoZIhvcNAQEB
          #    ...
          #    -----END CERTIFICATE-----
          #ca_trusted_fingerprint: "<SHA256 fingerprint>"
      - name: tags
        type: text
        title: Tags
        multi: true
        required: true
        show_user: false
        default:
          - forwarded
          - projectdiscovery-cloud
          - vulnerability
          - export
      - name: preserve_original_event
        required: true
        show_user: true
        title: Preserve original event
        description: Preserves a raw copy of the original event, added to the field `event.original`.
        type: bool
        multi: false
        default: false
      - name: preserve_duplicate_custom_fields
        required: true
        show_user: false
        title: Preserve duplicate custom fields
        description: Preserve projectdiscovery.* fields that were copied to Elastic Common Schema (ECS) fields.
        type: bool
        multi: false
        default: false
      - name: processors
        type: yaml
        title: Processors
        multi: false
        required: false
        show_user: false
        description: >-
          Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata.
