# Define only vendor-specific (non-ECS) fields here.
# ECS fields are defined separately in ecs.yml.

# Raw JSON fields from API (before ingest pipeline transformation)
- name: json
  type: group
  fields:
    - name: vuln_id
      type: keyword
      description: Raw vulnerability ID from API
    - name: vuln_status
      type: keyword
      description: Raw vulnerability status from API
    - name: vuln_hash
      type: keyword
      description: Raw vulnerability hash from API
    - name: created_at
      type: date
      description: Raw creation timestamp from API
    - name: updated_at
      type: date
      description: Raw update timestamp from API
    - name: scan_id
      type: keyword
      description: Raw scan ID from API
    - name: target
      type: keyword
      description: Raw target from API
    - name: template_id
      type: keyword
      description: Raw template ID from API
    - name: template_url
      type: keyword
      description: Raw template URL from API
    - name: matcher_status
      type: boolean
      description: Raw matcher status from API
    - name: result_type
      type: keyword
      description: Raw result type from API
    - name: change_event
      type: flattened
      description: Array of change objects (name, from, to) with dynamic value types
    - name: event
      type: group
      fields:
        - name: host
          type: keyword
        - name: ip
          type: ip
        - name: port
          type: keyword
        - name: type
          type: keyword
        - name: timestamp
          type: date
        - name: template-id
          type: keyword
          description: Template ID with hyphen (raw from API)
        - name: matcher-status
          type: boolean
          description: Matcher status with hyphen (raw from API)
        - name: response
          type: text
          index: false
          description: Raw response data
        - name: info
          type: group
          fields:
            - name: name
              type: keyword
            - name: description
              type: text
            - name: severity
              type: keyword
            - name: author
              type: keyword
            - name: reference
              type: keyword
            - name: tags
              type: keyword
            - name: metadata
              type: group
              fields:
                - name: max-request
                  type: long
                  description: Maximum requests from template metadata
                - name: verified
                  type: boolean
                  description: Whether template is verified

- name: projectdiscovery
  type: group
  fields:
    - name: target
      type: keyword
      description: Target as reported by ProjectDiscovery (often same as url.domain).
    - name: result_type
      type: keyword
      description: Vendor result_type when present.
    - name: vuln_hash
      type: keyword
      description: Vendor hash for the finding.
    - name: scan_id
      type: keyword
      description: Scan identifier.
    - name: template_id
      type: keyword
      description: Template ID used by the scanner.
    - name: template_url
      type: keyword
      description: Public URL of the template definition.
    - name: matcher_status
      type: boolean
      description: Vendor matcher status flag.
    - name: created_at
      type: date
      description: Original vendor creation time.
    - name: updated_at
      type: date
      description: Original vendor update time.
    - name: change_event
      type: flattened
      description: Array of change objects as provided by ProjectDiscovery (name, from, to).
    - name: event
      type: group
      fields:
        - name: host
          type: keyword
        - name: ip
          type: ip
        - name: port
          type: long
        - name: type
          type: keyword
        - name: timestamp
          type: date
        - name: template_id
          type: keyword
        - name: template-id
          type: keyword
          description: Template ID with hyphen (raw from API)
        - name: matcher_status
          type: boolean
        - name: matcher-status
          type: boolean
          description: Matcher status with hyphen (raw from API)
        - name: response
          type: text
        - name: info
          type: group
          fields:
            - name: name
              type: keyword
            - name: description
              type: text
            - name: severity
              type: keyword
            - name: tags
              type: keyword
            - name: author
              type: keyword
            - name: reference
              type: keyword
            - name: metadata
              type: group
              fields:
                - name: max_request
                  type: long
                - name: max-request
                  type: long
                  description: Maximum requests from template metadata
                - name: verified
                  type: boolean
