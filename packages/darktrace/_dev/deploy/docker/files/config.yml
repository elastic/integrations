rules:
  - path: /modelbreaches
    methods: ['GET']
    responses:
      - status_code: 200
        body: |
          [{"model":{"name":"Device::Attack and Recon Tools","pid":135,"phid":1198,"uuid":"8abcdefg-1234-1234-1234-5abcdefg12","logic":{"data":[{"cid":2311,"weight":1},{"cid":2312,"weight":1},{"cid":2315,"weight":1},{"cid":2316,"weight":1},{"cid":2314,"weight":1},{"cid":2310,"weight":1},{"cid":2313,"weight":1}],"targetScore":1,"type":"weightedComponentList","version":1},"throttle":604800,"sharedEndpoints":false,"actions":{"alert":true,"antigena":{},"breach":true,"model":true,"setPriority":false,"setTag":false,"setType":false},"tags":["AP: Internal Recon","OT Engineer"],"interval":3600,"delay":0,"sequenced":false,"active":true,"modified":"2022-07-11 11:47:51","activeTimes":{"devices":{},"tags":{},"type":"exclusions","version":2},"autoUpdatable":true,"autoUpdate":true,"autoSuppress":true,"description":"A device is using common penetration testing tools.\\n\\nAction: Review the device to see if it a security device, these can be tagged as such to exclude them from future breaches. Activity from non security devices merit further investigation into what else the device is doing and could be a significant risk within the network.","behaviour":"decreasing","created":{"by":"System"},"edited":{"by":"System"},"version":77,"priority":4,"category":"Suspicious","compliance":false},"device":{"did":7,"ip":"81.2.69.192","ips":[{"ip":"175.16.199.2","timems":1657746000000,"time":"2022-07-13 21:00:00","sid":1}],"sid":1,"hostname":"localhost.local","firstSeen":1657544891000,"lastSeen":1657748638000,"typename":"desktop","typelabel":"Desktop","credentials":["dummy"],"tags":[{"tid":66,"expiry":0,"thid":66,"name":"Domain Authenticated","restricted":false,"data":{"auto":false,"color":183,"description":""},"isReferenced":true},{"tid":29,"expiry":0,"thid":29,"name":"Linux","restricted":false,"data":{"auto":false,"color":168,"description":"","visibility":"Public"},"isReferenced":true},{"tid":45,"expiry":0,"thid":45,"name":"New Device","restricted":false,"data":{"auto":false,"color":130,"description":"","visibility":"Public"},"isReferenced":true}]},"triggeredComponents":[{"time":1657748807000,"cbid":6,"cid":2311,"chid":2676,"size":1,"threshold":0,"interval":300,"logic":{"data":{"left":{"left":"A","operator":"AND","right":{"left":"H","operator":"AND","right":{"left":"J","operator":"AND","right":"N"}}},"operator":"OR","right":{"left":{"left":"B","operator":"AND","right":{"left":"H","operator":"AND","right":{"left":"J","operator":"AND","right":{"left":"N","operator":"AND","right":"O"}}}},"operator":"OR","right":{"left":{"left":"C","operator":"AND","right":{"left":"H","operator":"AND","right":{"left":"J","operator":"AND","right":"N"}}},"operator":"OR","right":{"left":{"left":"E","operator":"AND","right":{"left":"H","operator":"AND","right":{"left":"J","operator":"AND","right":"N"}}},"operator":"OR","right":{"left":{"left":"F","operator":"AND","right":{"left":"H","operator":"AND","right":{"left":"J","operator":"AND","right":"N"}}},"operator":"OR","right":{"left":{"left":"G","operator":"AND","right":{"left":"H","operator":"AND","right":{"left":"J","operator":"AND","right":"N"}}},"operator":"OR","right":{"left":{"left":"H","operator":"AND","right":{"left":"I","operator":"AND","right":{"left":"J","operator":"AND","right":"N"}}},"operator":"OR","right":{"left":{"left":"H","operator":"AND","right":{"left":"J","operator":"AND","right":{"left":"K","operator":"AND","right":"N"}}},"operator":"OR","right":{"left":{"left":"H","operator":"AND","right":{"left":"J","operator":"AND","right":{"left":"L","operator":"AND","right":"N"}}},"operator":"OR","right":{"left":{"left":"H","operator":"AND","right":{"left":"J","operator":"AND","right":{"left":"M","operator":"AND","right":"N"}}},"operator":"OR","right":{"left":"H","operator":"AND","right":{"left":"J","operator":"AND","right":{"left":"N","operator":"AND","right":"P"}}}}}}}}}}}}},"version":"v0.1"},"metric":{"mlid":16,"name":"connections","label":"Connections"},"triggeredFilters":[{"cfid":26781,"id":"H","filterType":"Direction","arguments":{"value":"out"},"comparatorType":"is","trigger":{"value":"out"}},{"cfid":26783,"id":"J","filterType":"Tagged internal source","arguments":{"value":12},"comparatorType":"does not have tag","trigger":{"value":"12","tag":{"tid":12,"expiry":0,"thid":12,"name":"Security Device","restricted":false,"data":{"auto":false,"color":55,"description":"","visibility":"Public"},"isReferenced":true}}},{"cfid":26787,"id":"N","filterType":"Tagged internal destination","arguments":{"value":12},"comparatorType":"does not have tag","trigger":{"value":"12","tag":{"tid":12,"expiry":0,"thid":12,"name":"Security Device","restricted":false,"data":{"auto":false,"color":55,"description":"","visibility":"Public"},"isReferenced":true}}},{"cfid":26788,"id":"O","filterType":"User agent","arguments":{"value":"examples"},"comparatorType":"does not match regular expression","trigger":{"value":""}},{"cfid":26789,"id":"P","filterType":"URI","arguments":{"value":"examples"},"comparatorType":"matches regular expression","trigger":{"value":""}},{"cfid":26790,"id":"d1","filterType":"Proxied connection","arguments":{"value":"true"},"comparatorType":"display","trigger":{"value":"false"}},{"cfid":26791,"id":"d10","filterType":"HTTP response code","arguments":{},"comparatorType":"display","trigger":{"value":"0"}},{"cfid":26792,"id":"d2","filterType":"HTTP referrer","arguments":{},"comparatorType":"display","trigger":{"value":""}},{"cfid":26793,"id":"d3","filterType":"HTTP method","arguments":{},"comparatorType":"display","trigger":{"value":"GET"}},{"cfid":26794,"id":"d4","filterType":"HTTP X-Forwarded-For","arguments":{},"comparatorType":"display","trigger":{"value":""}},{"cfid":26795,"id":"d5","filterType":"URI","arguments":{},"comparatorType":"display","trigger":{"value":""}},{"cfid":26796,"id":"d6","filterType":"User agent","arguments":{},"comparatorType":"display","trigger":{"value":""}},{"cfid":26797,"id":"d7","filterType":"Destination IP","arguments":{},"comparatorType":"display","trigger":{"value":"81.2.69.144"}},{"cfid":26798,"id":"d8","filterType":"Internal destination device name","arguments":{},"comparatorType":"display","trigger":{"value":"localhost.local"}},{"cfid":26799,"id":"d9","filterType":"Connection hostname","arguments":{},"comparatorType":"display","trigger":{"value":""}}]}],"breachUrl":"https://example.com/#modelbreach/6","pbid":6,"score":0.871,"commentCount":0,"creationTime":1657748815000,"time":1657748808000,"mitreTechniques":[{"technique":"Hardware Additions Mitigation","techniqueID":"T1200"}]}]
  - path: /aianalyst/incidentevents
    methods: ['GET']
    responses:
      - status_code: 200
        body: |
          [{"summariser":"AdminConnSummary","acknowledged":false,"pinned":true,"createdAt":1628002089240,"attackPhases":[5],"title":"Extensive Unusual SSH Connections","id":"eabc0011-1234-1234-1234-cabcdefg0011","children":["eabcdef0-1234-1234-1234-cabcdefghij9"],"category":"critical","currentGroup":"eabc1234-1234-1234-1234-cabcdefg0011","groupCategory":"critical","groupScore":"72.9174234","groupPreviousGroups":null,"activityId":"abcd1234","groupingIds":["abcdef12"],"groupByActivity":false,"userTriggered":false,"externalTriggered":false,"aiaScore":98,"summary":"The device 175.16.199.1 was observed making unusual internal SSH connections to a wide range of devices.\n\nThough this behaviour could be the result of legitimate remote access or administration, it could also be a sign of attempted lateral movement by a compromised machine.\n\nConsequently, if this activity was not expected, the security team may wish to investigate further.","periods":[{"start":1627985298683,"end":1628000141220}],"breachDevices":[{"identifier":null,"hostname":null,"ip":"81.2.69.144","mac":null,"subnet":"VPN","did":10,"sid":12}],"relatedBreaches":[{"modelName":"Unusual Activity / Unusual Activity from Re-Activated Device","pbid":1234,"threatScore":37,"timestamp":1627997157000}],"details":[[{"header":"Breaching Device","contents":[{"key":null,"type":"device","values":[{"identifier":null,"hostname":null,"ip":"175.16.199.1","mac":null,"subnet":"VPN","did":10,"sid":12}]}]}],[{"header":"SSH Activity","contents":[{"key":"Time","type":"timestampRange","values":[{"start":1627985298683,"end":1628000141220}]},{"key":"Number of unique IPs","type":"integer","values":[16]},{"key":"Targeted IP ranges include","type":"device","values":[{"identifier":null,"hostname":null,"ip":"81.2.69.192","mac":null,"subnet":null,"did":null,"sid":null},{"identifier":null,"hostname":null,"ip":"175.16.199.1","mac":null,"subnet":null,"did":null,"sid":null},{"identifier":null,"hostname":null,"ip":"175.16.199.3","mac":null,"subnet":null,"did":null,"sid":null}]},{"key":"Destination port","type":"integer","values":[22]},{"key":"Connection count","type":"integer","values":[40]},{"key":"Percentage successful","type":"percentage","values":[100]}]}]]}]
