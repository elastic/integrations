---
description: Pipeline for processing event logs.
processors:
  - script:
      description: Drops fields which have null values recursively.
      tag: script_to_drop_null_values_fields
      lang: painless
      source: |-
        boolean drop(Object o) {
          if (o == "null" || o == "Null" || o == "NULL") {
            return true;
          } else if (o instanceof Map) {
            ((Map) o).values().removeIf(v -> drop(v));
            return (((Map) o).size() == 0);
          } else if (o instanceof List) {
            ((List) o).removeIf(v -> drop(v));
            return (((List) o).length == 0);
          }
          return false;
        }
        drop(ctx);
# The decode_cef processor encounters errors when attempting to parse empty IP and integer type fields in the log.
# The following script provides a temporary solution by removing the error.message fields upon encountering any related errors that match the provided regex.
# Link to the issue: https://github.com/elastic/beats/issues/40236
# The script will be removed after the above issue is resolved.
  - script:
      lang: painless
      tag: script_to_rename_error_message
      description: Script to Rename EM.
      if: ctx.error?.message instanceof List
      source: >-
        ArrayList temp = new ArrayList(ctx.error.message);
        ArrayList output = new ArrayList();
        for(data in temp){
            if (!(data.contains('error in field ') || data.contains('strconv.Parse'))) {
                output.add(data);
            }
        ctx.error.put("message", output);
        }
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - remove:
      field: error.message
      tag: remove_error_message_empty
      if: ctx.error?.message != null && ctx.error.message instanceof String && (ctx.error.message.contains('error in field ') || ctx.error.message.contains('strconv.Parse'))
      ignore_missing: true
  - set:
      field: ecs.version
      tag: set_ecs_version
      value: 8.11.0
  - set:
      field: observer.vendor
      tag: set_observer_vendor
      value: Palo Alto Networks
  - set:
      field: observer.product
      tag: set_observer_product
      value: Prisma Access
  - set:
      field: observer.type
      tag: set_observer_type
      value: firewall
  - set:
      field: event.kind
      tag: set_event_kind_to_event
      value: event
      if: ctx.cef?.device?.event_class_id != null && ['CONFIG','SYSTEM','GLOBALPROTECT APP TROUBLESHOOTING','AUTH','DNS SECURITY','DECRYPTION','FILE','GLOBALPROTECT','HIPMATCH','IPTAG','SCTP','TRAFFIC','TUNNEL','URL','USERID'].contains(ctx.cef.device.event_class_id) || (ctx.cef?.extensions?.Name != null && ['url','file'].contains(ctx.cef.extensions.Name))
  - set:
      field: event.kind
      tag: set_event_kind_to_alert
      value: alert
      if: ctx.cef?.device?.event_class_id == 'THREAT' && ctx.cef?.extensions != null && !['url','file'].contains(ctx.cef.extensions.Name)
  - append:
      field: event.category
      value: configuration
      tag: append_event_category_configuration
      if: ctx.cef?.device?.event_class_id == 'CONFIG'
  - append:
      field: event.category
      value: malware
      tag: append_event_category_configuration
      if: ctx.cef?.device?.event_class_id != null && ['GLOBALPROTECT APP TROUBLESHOOTING'].contains(ctx.cef.device.event_class_id)
  - append:
      field: event.category
      value: authentication
      tag: append_event_category_authentication
      if: ctx.cef?.device?.event_class_id != null && ['AUTH','USERID'].contains(ctx.cef.device.event_class_id)
  - append:
      field: event.category
      value: network
      tag: append_event_category_network
      if: ctx.cef?.device?.event_class_id != null && ['DNS SECURITY','DECRYPTION','GLOBALPROTECT','IPTAG','SCTP','THREAT','TRAFFIC','TUNNEL','URL','GLOBALPROTECT APP TROUBLESHOOTING'].contains(ctx.cef.device.event_class_id)
  - append:
      field: event.category
      value: file
      tag: append_event_category_file
      if: ctx.cef?.device?.event_class_id == 'THREAT' && ctx.cef?.extensions?.Name == 'file'
  - append:
      field: event.category
      value: host
      tag: append_event_category_host
      if: ctx.cef?.device?.event_class_id != null && ['HIPMATCH','SYSTEM'].contains(ctx.cef.device.event_class_id)
  - append:
      field: event.category
      value: threat
      tag: append_event_category_threat
      if: ctx.cef?.device?.event_class_id == 'THREAT' && (ctx.cef?.extensions != null && !['url','file'].contains(ctx.cef.extensions.Name))
  - append:
      field: event.type
      value: info
      tag: append_event_type_info
      if: ctx.cef?.device?.event_class_id != null && ['CONFIG','SYSTEM','GLOBALPROTECT APP TROUBLESHOOTING','AUTH','DNS SECURITY','DECRYPTION','FILE','GLOBALPROTECT','HIPMATCH','IPTAG','SCTP','THREAT','TRAFFIC','TUNNEL','URL','USERID'].contains(ctx.cef.device.event_class_id) || (ctx.cef?.extensions != null && ['url','file'].contains(ctx.cef.extensions.Name))
  - append:
      field: event.type
      value: protocol
      tag: append_event_type_protocol
      if: ctx.cef?.device?.event_class_id == 'SCTP'
  - append:
      field: event.type
      value: indicator
      tag: append_event_type_indicator
      if: ctx.cef?.device?.event_class_id == 'THREAT' && (ctx.cef?.extensions != null && !['url','file'].contains(ctx.cef.extensions.Name))
  - rename:
      field: cef.extensions.PanOSAccessPointName
      tag: rename_extension_PanOSAccessPointName
      target_field: prisma_access.event.access_point_name
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSAgentContentVersion
      tag: rename_extension_PanOSAgentContentVersion
      target_field: prisma_access.event.agent.content_version
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSAgentDataCollectionStatus
      tag: rename_extension_PanOSAgentDataCollectionStatus
      target_field: prisma_access.event.agent.data_collection_status
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSAgentID
      tag: rename_extension_PanOSAgentID
      target_field: prisma_access.event.agent.id
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSAgentIsolationStatus
      tag: rename_extension_PanOSAgentIsolationStatus
      target_field: prisma_access.event.agent.isolation_status
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSAgentStatus
      tag: rename_extension_PanOSAgentStatus
      target_field: prisma_access.event.agent.status
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSAgentTimeZoneOffset
      tag: rename_extension_PanOSAgentTimeZoneOffset
      target_field: prisma_access.event.agent.timezone_offset
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSAgentVersion
      tag: rename_extension_PanOSAgentVersion
      target_field: prisma_access.event.agent.version
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSAppTampered
      tag: convert_extension_PanOSAppTampered_to_boolean
      target_field: prisma_access.event.app_tampered
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSApplianceOrCloud
      tag: rename_extension_PanOSApplianceOrCloud
      target_field: prisma_access.event.appliance_or_cloud
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSApplicationCategory
      tag: rename_extension_PanOSApplicationCategory
      target_field: prisma_access.event.application.category
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSApplicationCharacteristics
      tag: rename_extension_PanOSApplicationCharacteristics
      target_field: prisma_access.event.application.characteristics
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSApplicationContainer
      tag: rename_extension_PanOSApplicationContainer
      target_field: prisma_access.event.application.container
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSApplication
      tag: rename_extension_PanOSApplication
      target_field: prisma_access.event.application.protocol
      if: ctx.cef?.device?.event_class_id == 'SCTP'
      ignore_missing: true
  - rename:
      field: cef.extensions.applicationProtocol
      tag: rename_extension_applicationProtocol
      target_field: prisma_access.event.application.protocol
      if: ctx.cef?.device?.event_class_id != null && ['DECRYPTION','FILE','THREAT','TRAFFIC','TUNNEL','URL'].contains(ctx.cef.device.event_class_id) || (ctx.cef?.extensions != null && ['url','file'].contains(ctx.cef.extensions.Name))
      ignore_missing: true
  - set:
      field: network.application
      tag: set_network_application_from_event_application.protocol
      copy_from: prisma_access.event.application.protocol
      ignore_empty_value: true
  - lowercase:
      field: network.application
      tag: lowercase_network_application
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSApplicationRisk
      tag: rename_extension_PanOSApplicationRisk
      target_field: prisma_access.event.application.risk
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSApplicationSubcategory
      tag: rename_extension_PanOSApplicationSubcategory
      target_field: prisma_access.event.application.subcategory
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSApplicationTechnology
      tag: rename_extension_PanOSApplicationTechnology
      target_field: prisma_access.event.application.technology
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSAssocationEndReason
      tag: rename_extension_PanOSAssocationEndReason
      target_field: prisma_access.event.assocation_end_reason
      ignore_missing: true
  - set:
      field: event.reason
      tag: set_event_reason_from_event_assocation_end_reason
      copy_from: prisma_access.event.assocation_end_reason
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSAttemptedGateways
      tag: rename_extension_PanOSAttemptedGateways
      target_field: prisma_access.event.attempted_gateways
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSAuthCacheServiceRegion
      tag: rename_extension_PanOSAuthCacheServiceRegion
      target_field: prisma_access.event.auth.cache_service_region
      ignore_missing: true
  - convert:
      field: cef.extensions.deviceCustomNumber1
      tag: convert_extension_deviceCustomNumber1_to_long
      target_field: prisma_access.event.auth.factor_no
      type: long
      ignore_missing: true
      if: ctx.cef?.device?.event_class_id != null && ['AUTH','USERID'].contains(ctx.cef.device.event_class_id)
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSAuthMethod
      tag: rename_extension_PanOSAuthMethod
      target_field: prisma_access.event.auth.method
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString1
      tag: rename_extension_deviceCustomString1
      target_field: prisma_access.event.auth.server_profile
      if: ctx.cef?.device?.event_class_id == 'AUTH'
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString1Label
      tag: rename_extension_deviceCustomString1Label
      target_field: prisma_access.event.label.cs1
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSAuthenticatedUserDomain
      tag: rename_extension_PanOSAuthenticatedUserDomain
      target_field: prisma_access.event.authenticated.user.domain
      ignore_missing: true
  - set:
      field: user.domain
      tag: set_user_domain_from_event_authenticated_user_domain
      copy_from: prisma_access.event.authenticated.user.domain
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_event_authenticated_user_domain_into_related_user
      value: "{{{prisma_access.event.authenticated.user.domain}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.authenticated?.user?.domain != null
  - rename:
      field: cef.extensions.PanOSAuthenticatedUserName
      tag: rename_extension_PanOSAuthenticatedUserName
      target_field: prisma_access.event.authenticated.user.name
      ignore_missing: true
  - append:
      field: related.user
      tag: append_event_authenticated_user_name_into_related_user
      value: "{{{prisma_access.event.authenticated.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.authenticated?.user?.name != null
  - set:
      field: user.name
      tag: set_user_name_from_event_authenticated_user_name
      copy_from: prisma_access.event.authenticated.user.name
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSAuthenticatedUserUUID
      tag: rename_extension_PanOSAuthenticatedUserUUID
      target_field: prisma_access.event.authenticated.user.uuid
      ignore_missing: true
  - append:
      field: related.user
      tag: append_event_authenticated_user_uuid_into_related_user
      value: "{{{prisma_access.event.authenticated.user.uuid}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.authenticated?.user?.uuid != null
  - set:
      field: user.id
      tag: set_user_id_from_event_authenticated_user_uuid
      copy_from: prisma_access.event.authenticated.user.uuid
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSAuthenticationDescription
      tag: rename_extension_PanOSAuthenticationDescription
      target_field: prisma_access.event.authentication.description
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString4
      tag: rename_extension_deviceCustomString4
      target_field: prisma_access.event.authentication.policy
      if: ctx.cef?.device?.event_class_id == 'AUTH'
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString4Label
      tag: rename_extension_deviceCustomString4Label
      target_field: prisma_access.event.label.cs4
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSAuthenticationProtocol
      tag: rename_extension_PanOSAuthenticationProtocol
      target_field: prisma_access.event.authentication.protocol
      ignore_missing: true
  - convert:
      field: cef.extensions.baseEventCount
      tag: convert_extension_baseEventCount_to_long
      target_field: prisma_access.event.base_event_count
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: threat.indicator.sightings
      tag: set_threat_indicator_sightings_from_event_base_event_count
      copy_from: prisma_access.event.base_event_count
      ignore_empty_value: true
      if: ctx.cef?.device?.event_class_id != null && ['THREAT','URL'].contains(ctx.cef.device.event_class_id) || ctx.cef?.extensions?.Name == 'url'
  - convert:
      field: cef.extensions.PanOSBytes
      tag: convert_extension_PanOSBytes_to_long
      target_field: prisma_access.event.bytes.total
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: network.bytes
      tag: set_network_bytes_from_event_bytes
      copy_from: prisma_access.event.bytes.total
      ignore_empty_value: true
  - convert:
      field: cef.extensions.bytesIn
      tag: convert_extension_bytesIn_to_long
      target_field: prisma_access.event.bytes.in
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: destination.bytes
      tag: set_source_bytes_from_event_bytes_in
      copy_from: prisma_access.event.bytes.in
      ignore_empty_value: true
  - convert:
      field: cef.extensions.bytesOut
      tag: convert_extension_bytesOut_to_long
      target_field: prisma_access.event.bytes.out
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: source.bytes
      tag: set_destination_bytes_from_event_bytes_out
      copy_from: prisma_access.event.bytes.out
      ignore_empty_value: true
  - convert:
      field: cef.extensions.PanOSCachedConfiguration
      tag: convert_extension_PanOSCachedConfiguration_to_boolean
      target_field: prisma_access.event.cached_configuration
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSCaptivePortal
      tag: convert_extension_PanOSCaptivePortal_to_boolean
      target_field: prisma_access.event.captive_portal
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSCertificateFlags
      tag: rename_extension_PanOSCertificateFlags
      target_field: prisma_access.event.certificate.flags
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSCertificateSerial
      tag: rename_extension_PanOSCertificateSerial
      target_field: prisma_access.event.certificate.serial
      ignore_missing: true
  - set:
      field: tls.client.x509.serial_number
      tag: set_tls_client_x509_serial_number_from_event_certificate_serial
      copy_from: prisma_access.event.certificate.serial
      ignore_empty_value: true
  - convert:
      field: cef.extensions.PanOSCertificateSize
      tag: convert_extension_PanOSCertificateSize_to_long
      target_field: prisma_access.event.certificate.size
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSCertificateVersion
      tag: rename_extension_PanOSCertificateVersion
      target_field: prisma_access.event.certificate.version
      ignore_missing: true
  - set:
      field: tls.client.x509.version_number
      tag: set_tls_client_x509_version_number_from_event_certificate_version
      copy_from: prisma_access.event.certificate.version
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSChainStatus
      tag: rename_extension_PanOSChainStatus
      target_field: prisma_access.event.chain_status
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSChunksReceived
      tag: convert_extension_PanOSChunksReceived_to_long
      target_field: prisma_access.event.chunks.received
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSChunksSent
      tag: convert_extension_PanOSChunksSent_to_long
      target_field: prisma_access.event.chunks.sent
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSChunksTotal
      tag: convert_extension_PanOSChunksTotal_to_long
      target_field: prisma_access.event.chunks.total
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.deviceCustomString5
      tag: rename_extension_deviceCustomString5
      target_field: prisma_access.event.client.type.value
      if: ctx.cef?.device?.event_class_id == 'AUTH'
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString5Label
      tag: rename_extension_deviceCustomString5Label
      target_field: prisma_access.event.label.cs5
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSClientToFirewall
      tag: convert_extension_PanOSClientToFirewall_to_boolean
      target_field: prisma_access.event.client.to_firewall
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSClientTypeName
      tag: rename_extension_PanOSClientTypeName
      target_field: prisma_access.event.client.type.name
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSCloudHostname
      tag: rename_extension_PanOSCloudHostname
      target_field: prisma_access.event.cloud.hostname
      ignore_missing: true
  - append:
      field: cloud.instance.name
      tag: append_event_cloud_hostname_into_cloud_instance_name
      value: "{{{prisma_access.event.cloud.hostname}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.cloud?.hostname != null
  - append:
      field: related.hosts
      tag: append_event_cloud_hostname_into_related_hosts
      value: "{{{prisma_access.event.cloud.hostname}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.cloud?.hostname != null
  - rename:
      field: cef.extensions.PanOSCloudReportID
      tag: rename_extension_PanOSCloudReportID
      target_field: prisma_access.event.cloud.report_id
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSCommonName
      tag: rename_extension_PanOSCommonName
      target_field: prisma_access.event.common.name.value
      ignore_missing: true
  - append:
      field: tls.client.x509.subject.common_name
      tag: append_prisma_access_event_common_name_into_tls_client_x509_subject_common_name
      value: "{{{prisma_access.event.common.name.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.common?.name?.value != null
  - convert:
      field: cef.extensions.PanOSCommonNameLength
      tag: convert_extension_PanOSCommonNameLength_to_long
      target_field: prisma_access.event.common.name.length
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSConfigVersion
      tag: convert_extension_PanOSConfigVersion_to_string
      target_field: prisma_access.event.config_version
      type: string
      ignore_missing: true
  - set:
      field: observer.version
      tag: set_observer_version_from_event_config_version
      copy_from: prisma_access.event.config_version
      ignore_empty_value: true
  - convert:
      field: cef.extensions.PanOSConfigurationRefresh
      tag: convert_extension_PanOSConfigurationRefresh_to_boolean
      target_field: prisma_access.event.configuration_refresh
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSConnectionError
      tag: rename_extension_PanOSConnectionError
      target_field: prisma_access.event.connection.error.value
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSConnectionErrorID
      tag: convert_extension_PanOSConnectionErrorID_to_string
      target_field: prisma_access.event.connection.error.id
      type: string
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSConnectionMethod
      tag: rename_extension_PanOSConnectionMethod
      target_field: prisma_access.event.connection.method
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSContainerID
      tag: rename_extension_PanOSContainerID
      target_field: prisma_access.event.container.id
      ignore_missing: true
  - set:
      field: container.id
      tag: set_container_id_from_event_container_id
      copy_from: prisma_access.event.container.id
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSContainerName
      tag: rename_extension_PanOSContainerName
      target_field: prisma_access.event.container.name.value
      ignore_missing: true
  - set:
      field: container.name
      tag: set_container_name_from_event_container_name
      copy_from: prisma_access.event.container.name.value
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSContainerNameSpace
      tag: rename_extension_PanOSContainerNameSpace
      target_field: prisma_access.event.container.name.space
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSContentVersion
      tag: rename_extension_PanOSContentVersion
      target_field: prisma_access.event.content_version
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSCortexDataLakeTenantID
      tag: rename_extension_PanOSCortexDataLakeTenantID
      target_field: prisma_access.event.cortex_data_lake_tenant_id
      ignore_missing: true
  - append:
      field: cloud.account.id
      tag: append_prisma_access_event_cortex_data_lake_tenant_id_into_cloud_account_id
      value: "{{{prisma_access.event.cortex_data_lake_tenant_id}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.cortex_data_lake_tenant_id != null
  - convert:
      field: cef.extensions.PanOSCountOfRepeats
      tag: convert_extension_PanOSCountOfRepeats_to_long
      target_field: prisma_access.event.count_of_repeats
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSCpadding
      tag: rename_extension_PanOSCpadding
      target_field: prisma_access.event.cpadding
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSCPUUsage
      tag: convert_extension_PanOSCPUUsage_to_double
      target_field: prisma_access.event.cpu_usage
      type: double
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSCPUUsage != null && ctx.cef.extensions.PanOSCPUUsage != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - script:
      lang: painless
      tag: script_set_host_cpu_usage
      if: ctx.prisma_access?.event?.cpu_usage != null
      source: |
        if (ctx.host == null) {
            HashMap hm = new HashMap();
            ctx.put("host", hm);
        }
        ctx.host.cpu = new HashMap();
        ctx.host.cpu.usage = Math.round(ctx.prisma_access?.event?.cpu_usage *10) / 1000.0;
  - rename:
      field: cef.extensions.PanOSCrashHistory
      tag: rename_extension_PanOSCrashHistory
      target_field: prisma_access.event.crash_history
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDebugLogFile
      tag: rename_extension_PanOSDebugLogFile
      target_field: prisma_access.event.debug_log_file
      ignore_missing: true
  - append:
      field: file.name
      tag: append_prisma_access_event_debug_log_file_into_file_name
      value: "{{{prisma_access.event.debug_log_file}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.debug_log_file != null
  - rename:
      field: cef.extensions.PanOSDescription
      tag: rename_extension_PanOSDescription
      target_field: prisma_access.event.description
      ignore_missing: true
  - set:
      field: message
      tag: set_message_from_event_description
      copy_from: prisma_access.event.description
      ignore_empty_value: true
  - convert:
      field: cef.extensions.destinationAddress
      tag: convert_extension_destinationAddress_to_ip
      target_field: prisma_access.event.destination.address.value
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.destinationAddress != null && ctx.cef.extensions.destinationAddress != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: destination.ip
      tag: append_prisma_access_event_destination_address_into_destination_ip
      value: "{{{prisma_access.event.destination.address.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.address?.value != null
  - append:
      field: related.ip
      tag: append_event_destination_address_into_related_ip
      value: "{{{prisma_access.event.destination.address.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.address?.value != null
  - rename:
      field: cef.extensions.deviceCustomIPv6Address2Label
      tag: rename_extension_deviceCustomIPv6Address2Label
      target_field: prisma_access.event.label.c6a2
      ignore_missing: true
  - convert:
      field: cef.extensions.deviceCustomIPv6Address2
      tag: convert_extension_deviceCustomIPv6Address2_to_ip
      target_field: prisma_access.event.source.address.v6
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.deviceCustomIPv6Address2 != null && ctx.cef.extensions.deviceCustomIPv6Address2 != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - lowercase:
      field: prisma_access.event.source.address.v6
      tag: lowercase_prisma_access_event_source_address_v6
      ignore_missing: true
  - append:
      field: source.ip
      tag: append_prisma_access_event_source_address_v6_into_source_ip
      value: "{{{prisma_access.event.source.address.v6}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.address?.v6 != null
  - append:
      field: related.ip
      tag: append_event_source_address_v6_into_related_ip
      value: "{{{prisma_access.event.source.address.v6}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.address?.v6 != null
  - rename:
      field: cef.extensions.deviceCustomIPv6Address3Label
      tag: rename_extension_deviceCustomIPv6Address3Label
      target_field: prisma_access.event.label.c6a3
      ignore_missing: true
  - convert:
      field: cef.extensions.deviceCustomIPv6Address3
      tag: convert_extension_deviceCustomIPv6Address3_to_ip
      target_field: prisma_access.event.destination.address.v6
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.deviceCustomIPv6Address3 != null && ctx.cef.extensions.deviceCustomIPv6Address3 != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - lowercase:
      field: prisma_access.event.destination.address.v6
      tag: lowercase_prisma_access_event_destination_address_v6
      ignore_missing: true
  - append:
      field: destination.ip
      tag: append_prisma_access_event_destination_address_v6_into_destination_ip
      value: "{{{prisma_access.event.destination.address.v6}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.address?.v6 != null
  - append:
      field: related.ip
      tag: append_event_destination_address_v6_into_related_ip
      value: "{{{prisma_access.event.destination.address.v6}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.address?.v6 != null
  - rename:
      field: cef.extensions.PanOSDestinationDeviceCategory
      tag: rename_extension_PanOSDestinationDeviceCategory
      target_field: prisma_access.event.destination.device.category
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDestinationDeviceClass
      tag: rename_extension_PanOSDestinationDeviceClass
      target_field: prisma_access.event.destination.device.class
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDestinationDeviceHost
      tag: rename_extension_PanOSDestinationDeviceHost
      target_field: prisma_access.event.destination.device.host
      ignore_missing: true
  - append:
      field: destination.domain
      tag: append_prisma_access_event_destination_device_host_into_destination_domain
      value: "{{{prisma_access.event.destination.device.host}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.device?.host != null
  - append:
      field: related.hosts
      tag: append_event_destination_device_host_into_related_hosts
      value: "{{{prisma_access.event.destination.device.host}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.device?.host != null
  - rename:
      field: cef.extensions.PanOSDestinationDeviceMac
      tag: rename_extension_PanOSDestinationDeviceMac
      target_field: prisma_access.event.destination.device.mac
      ignore_missing: true
  - set:
      field: destination.mac
      tag: set_destination_mac_from_event_destination_device_mac
      copy_from: prisma_access.event.destination.device.mac
      ignore_empty_value: true
  - gsub:
      field: destination.mac
      tag: gsub_destination_mac
      pattern: '(..)(?!$)'
      replacement: '$1-'
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - uppercase:
      field: destination.mac
      tag: uppercase_destination_mac
      ignore_missing: true
      if: ctx.destination?.mac != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: cef.extensions.PanOSDestinationDeviceModel
      tag: rename_extension_PanOSDestinationDeviceModel
      target_field: prisma_access.event.destination.device.model
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDestinationDeviceOS
      tag: rename_extension_PanOSDestinationDeviceOS
      target_field: prisma_access.event.destination.device.os.type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDestinationDeviceOSFamily
      tag: rename_extension_PanOSDestinationDeviceOSFamily
      target_field: prisma_access.event.destination.device.os.family
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDestinationDeviceOSVersion
      tag: rename_extension_PanOSDestinationDeviceOSVersion
      target_field: prisma_access.event.destination.device.os.version
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDestinationDeviceProfile
      tag: rename_extension_PanOSDestinationDeviceProfile
      target_field: prisma_access.event.destination.device.profile
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDestinationDeviceVendor
      tag: rename_extension_PanOSDestinationDeviceVendor
      target_field: prisma_access.event.destination.device.vendor
      ignore_missing: true
  - append:
      field: destination.as.organization.name
      tag: append_prisma_access_event_destination_device_vendor_into_destination_as_organization_name
      value: "{{{prisma_access.event.destination.device.vendor}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.device?.vendor != null
  - rename:
      field: cef.extensions.PanOSDestinationDynamicAddressGroup
      tag: rename_extension_PanOSDestinationDynamicAddressGroup
      target_field: prisma_access.event.destination.dynamic_address_group
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDestinationEDL
      tag: rename_extension_PanOSDestinationEDL
      target_field: prisma_access.event.destination.edl
      ignore_missing: true
  - rename:
      field: cef.extensions.destinationHostName
      tag: rename_extension_destinationHostName
      target_field: prisma_access.event.destination.host_name
      ignore_missing: true
  - append:
      field: host.name
      tag: append_prisma_access_event_destination_host_name_into_host_name
      value: "{{{prisma_access.event.destination.host_name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.host_name != null && ctx.cef?.device?.event_class_id == 'HIPMATCH'
  - append:
      field: related.hosts
      tag: append_event_destination_host_name_into_related_hosts
      value: "{{{prisma_access.event.destination.host_name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.host_name != null
  - rename:
      field: cef.extensions.PanOSDestinationLocation
      tag: rename_extension_PanOSDestinationLocation
      target_field: prisma_access.event.destination.location
      ignore_missing: true
  - rename:
      field: cef.extensions.destinationNtDomain
      tag: rename_extension_destinationNtDomain
      target_field: prisma_access.event.destination.nt_domain
      ignore_missing: true
  - append:
      field: destination.user.domain
      tag: append_prisma_access_event_destination_nt_domain_into_destination_user_domain
      value: "{{{prisma_access.event.destination.nt_domain}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.nt_domain != null
  - convert:
      field: cef.extensions.destinationPort
      tag: convert_extension_destinationPort_to_long
      target_field: prisma_access.event.destination.port
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: destination.port
      tag: set_destination_port_from_event_destination_port
      copy_from: prisma_access.event.destination.port
      ignore_empty_value: true
  - rename:
      field: cef.extensions.destinationServiceName
      tag: rename_extension_destinationServiceName
      target_field: prisma_access.event.destination.service_name
      ignore_missing: true
  - convert:
      field: cef.extensions.destinationTranslatedAddress
      tag: convert_extension_destinationTranslatedAddress_to_ip
      target_field: prisma_access.event.destination.translated.address
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.destinationTranslatedAddress != null && ctx.cef.extensions.destinationTranslatedAddress != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: destination.nat.ip
      tag: set_destination_nat_ip_from_event_destination_translated_address
      copy_from: prisma_access.event.destination.translated.address
      ignore_empty_value: true
  - append:
      field: related.ip
      tag: append_event_destination_translated_address_into_related_ip
      value: "{{{prisma_access.event.destination.translated.address}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.translated?.address != null
  - convert:
      field: cef.extensions.destinationTranslatedPort
      tag: convert_extension_destinationTranslatedPort_to_long
      target_field: prisma_access.event.destination.translated.port
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: destination.nat.port
      tag: set_destination_nat_port_from_event_destination_translated_port
      copy_from: prisma_access.event.destination.translated.port
      ignore_empty_value: true
  - grok:
      field: cef.extensions.PanOSDestinationUser
      tag: grok_PanOSDestinationUser
      if: ctx.cef?.extensions?.PanOSDestinationUser != null && ctx.cef?.extensions?.PanOSDestinationUser.contains("\\")
      patterns:
        - (?<prisma_access.event.pan_os_value.destination.user.domain>[^\\]*)[\\]*(?<prisma_access.event.pan_os_value.destination.user.name>[^\\]*)
      on_failure:
        - rename:
            field: cef.extensions.PanOSDestinationUser
            tag: rename_extension_PanOSDestinationUser_if_grok_fails
            target_field: prisma_access.event.pan_os_value.destination.user.name
            ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDestinationUser
      tag: rename_extension_PanOSDestinationUser
      if: ctx.cef?.extensions?.PanOSDestinationUser != null && !(ctx.cef?.extensions?.PanOSDestinationUser.contains("\\"))
      target_field: prisma_access.event.pan_os_value.destination.user.name
      ignore_missing: true
  - append:
      field: destination.user.domain
      tag: append_prisma_access_event_pan_os_value_destination_user_domain_into_destination_user_domain
      value: "{{{prisma_access.event.pan_os_value.destination.user.domain}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os_value?.destination?.user?.domain != null
  - append:
      field: destination.user.name
      tag: append_prisma_access_event_pan_os_value_destination_user_into_destination_user_name
      value: "{{{prisma_access.event.pan_os_value.destination.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os_value?.destination?.user?.name != null
  - append:
      field: related.user
      tag: append_event_pan_os_value_destination_user_into_related_user
      value: "{{{prisma_access.event.pan_os_value.destination.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os_value?.destination?.user?.name != null
  - grok:
      field: cef.extensions.PanOSDestinationUserName
      tag: grok_PanOSDestinationUserName
      if: ctx.cef?.extensions?.PanOSDestinationUserName != null && ctx.cef?.extensions?.PanOSDestinationUserName.contains("\\")
      patterns:
        - (?<prisma_access.event.pan_os_data.destination.user.domain>[^\\]*)[\\]*(?<prisma_access.event.pan_os_data.destination.user.name>[^\\]*)
      on_failure:
        - rename:
            field: cef.extensions.PanOSDestinationUserName
            tag: rename_extension_PanOSDestinationUserName_if_grok_fails
            target_field: prisma_access.event.pan_os_data.destination.user.name
            ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDestinationUserName
      tag: rename_extension_PanOSDestinationUserName
      if: ctx.cef?.extensions?.PanOSDestinationUserName != null && !(ctx.cef?.extensions?.PanOSDestinationUserName.contains("\\"))
      target_field: prisma_access.event.pan_os_data.destination.user.name
      ignore_missing: true
  - append:
      field: destination.user.domain
      tag: append_prisma_access_event_pan_os_data_destination_user_domain_into_destination_user_domain
      value: "{{{prisma_access.event.pan_os_data.destination.user.domain}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os_data?.destination?.user?.domain != null
  - append:
      field: destination.user.name
      tag: append_prisma_access_event_pan_os_data_destination_user_into_destination_user_name
      value: "{{{prisma_access.event.pan_os_data.destination.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os_value?.destination?.user?.name != null
  - append:
      field: related.user
      tag: append_event_pan_os_data_destination_user_into_related_user
      value: "{{{prisma_access.event.pan_os_data.destination.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os_data?.destination?.user?.name != null
  - rename:
      field: cef.extensions.PanOSDestinationUserDomain
      tag: rename_extension_PanOSDestinationUserDomain
      target_field: prisma_access.event.pan_os.destination.user.domain
      ignore_missing: true
  - append:
      field: destination.user.domain
      tag: append_prisma_access_event_pan_os_destination_user_domain_into_destination_user_domain
      value: "{{{prisma_access.event.pan_os.destination.user.domain}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os?.destination?.user?.domain != null
  - rename:
      field: cef.extensions.destinationUserId
      tag: rename_extension_destinationUserId
      target_field: prisma_access.event.destination.user.id
      ignore_missing: true
  - append:
      field: destination.user.id
      tag: append_prisma_access_event_destination_user_id_into_destination_user_id
      value: "{{{prisma_access.event.destination.user.id}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.user?.id != null
  - append:
      field: related.user
      tag: append_event_destination_user_id_into_related_user
      value: "{{{prisma_access.event.destination.user.id}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.user?.id != null
  - grok:
      field: cef.extensions.destinationUserName
      tag: grok_destinationUserName
      if: ctx.cef?.extensions?.destinationUserName != null && ctx.cef?.extensions?.destinationUserName.contains("\\")
      patterns:
        - (?<prisma_access.event.destination.user.domain>[^\\]*)[\\]*(?<prisma_access.event.destination.user.name>[^\\]*)
      on_failure:
        - rename:
            field: cef.extensions.destinationUserName
            tag: rename_extension_destinationUserName_if_grok_fails
            target_field: prisma_access.event.destination.user.name
            ignore_missing: true
  - rename:
      field: cef.extensions.destinationUserName
      tag: rename_extensions_destinationUserName
      if: ctx.cef?.extensions?.destinationUserName != null && !(ctx.cef?.extensions?.destinationUserName.contains("\\"))
      target_field: prisma_access.event.destination.user.name
      ignore_missing: true
  - append:
      field: destination.user.domain
      tag: append_prisma_access_event_destination_user_domain_into_destination_user_domain
      value: "{{{prisma_access.event.destination.user.domain}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.user?.domain != null
  - append:
      field: destination.user.name
      tag: append_prisma_access_event_destination_user_name_into_destination_user_name
      value: "{{{prisma_access.event.destination.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.user?.name != null
  - append:
      field: related.user
      tag: append_event_destination_user_name_into_related_user
      value: "{{{prisma_access.event.destination.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.user?.name != null
  - rename:
      field: cef.extensions.PanOSDestinationUserUUID
      tag: rename_extension_PanOSDestinationUserUUID
      target_field: prisma_access.event.destination.user.uuid
      ignore_missing: true
  - append:
      field: destination.user.id
      tag: append_prisma_access_event_destination_user_uuid_into_destination_user_id
      value: "{{{prisma_access.event.destination.user.uuid}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.user?.uuid != null
  - append:
      field: related.user
      tag: append_event_destination_user_uuid_into_related_user
      value: "{{{prisma_access.event.destination.user.uuid}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.user?.uuid != null
  - rename:
      field: cef.extensions.PanOSDestinationUUID
      tag: rename_extension_PanOSDestinationUUID
      target_field: prisma_access.event.destination.uuid
      ignore_missing: true
  - append:
      field: related.hosts
      tag: append_event_destination_uuid_into_related_hosts
      value: "{{{prisma_access.event.destination.uuid}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.destination?.uuid != null
  - rename:
      field: cef.extensions.deviceAction
      tag: rename_extension_deviceAction
      target_field: prisma_access.event.device.action
      ignore_missing: true
  - set:
      field: event.action
      tag: set_event_action_from_event_device_action
      copy_from: prisma_access.event.device.action
      ignore_empty_value: true
  - rename:
      field: cef.extensions.deviceEventCategory
      tag: rename_extension_deviceEventCategory
      target_field: prisma_access.event.device.event.category
      ignore_missing: true
  - rename:
      field: cef.extensions.Device Event Class ID
      tag: rename_extension_Device Event Class ID
      target_field: prisma_access.event.device.event.class_id
      ignore_missing: true
  - rename:
      field: cef.extensions.DeviceEventClassID
      tag: rename_extension_DeviceEventClassID
      target_field: prisma_access.event.device.event.class_id
      ignore_missing: true
  - rename:
      field: cef.extensions.DeviceEventClassId
      tag: rename_extension_DeviceEventClassId
      target_field: prisma_access.event.device.event.class_id
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceExternalId
      tag: rename_extension_deviceExternalId
      target_field: prisma_access.event.device.external_id
      ignore_missing: true
  - append:
      field: observer.serial_number
      tag: append_observer_serial_number_from_event_device_external_id
      value: "{{{prisma_access.event.device.external_id}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.device?.external_id != null
  - rename:
      field: cef.extensions.PanOSDeviceGroup
      tag: rename_extension_PanOSDeviceGroup
      target_field: prisma_access.event.device.group
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceHostName
      tag: rename_extension_deviceHostName
      target_field: prisma_access.event.device.host_name
      ignore_missing: true
  - set:
      field: observer.hostname
      tag: set_observer_hostname_from_event_device_host_name
      copy_from: prisma_access.event.device.host_name
      ignore_empty_value: true
  - append:
      field: related.hosts
      tag: append_event_device_host_name_into_related_hosts
      value: "{{{prisma_access.event.device.host_name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.device?.host_name != null
  - rename:
      field: cef.extensions.deviceInboundInterface
      tag: rename_extension_deviceInboundInterface
      target_field: prisma_access.event.device.inbound_interface
      ignore_missing: true
  - set:
      field: observer.ingress.interface.name
      tag: set_observer_ingress_interface_name_from_event_device_inbound_interface
      copy_from: prisma_access.event.device.inbound_interface
      ignore_empty_value: true
  - rename:
      field: cef.extensions.deviceCustomIPv6Address1Label
      tag: rename_extension_deviceCustomIPv6Address1Label
      target_field: prisma_access.event.label.c6a1
      ignore_missing: true
  - convert:
      field: cef.extensions.deviceCustomIPv6Address1
      tag: convert_extension_deviceCustomIPv6Address1_to_ip
      target_field: prisma_access.event.device.ipv6_address
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.deviceCustomIPv6Address1 != null && ctx.cef.extensions.deviceCustomIPv6Address1 != '' && ctx.cef?.device?.event_class_id == 'HIPMATCH'
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - lowercase:
      field: prisma_access.event.device.ipv6_address
      tag: lowercase_prisma_access_event_device_ipv6_address
      ignore_missing: true
  - append:
      field: related.ip
      tag: append_event_device_ipv6_address_into_related_ip
      value: "{{{prisma_access.event.device.ipv6_address}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.device?.ipv6_address != null
  - rename:
      field: cef.extensions.PanOSDeviceName
      tag: rename_extension_PanOSDeviceName
      target_field: prisma_access.event.device.name
      ignore_missing: true
  - set:
      field: observer.hostname
      tag: set_observer_hostname_from_event_device_name
      copy_from: prisma_access.event.device.name
      ignore_empty_value: true
  - append:
      field: related.hosts
      tag: append_event_device_name_into_related_hosts
      value: "{{{prisma_access.event.device.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.device?.name != null
  - rename:
      field: cef.extensions.deviceOutboundInterface
      tag: rename_extension_deviceOutboundInterface
      target_field: prisma_access.event.device.outbound_interface
      ignore_missing: true
  - set:
      field: observer.egress.interface.name
      tag: set_observer_egress_interface_name_from_event_device_outbound_interface
      copy_from: prisma_access.event.device.outbound_interface
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSDeviceSN
      tag: rename_extension_PanOSDeviceSN
      target_field: prisma_access.event.device.sn
      ignore_missing: true
  - append:
      field: observer.serial_number
      tag: append_observer_serial_number_from_event_device_sn
      value: "{{{prisma_access.event.device.sn}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.device?.sn != null
  - rename:
      field: cef.extensions.deviceTimeZone
      tag: rename_extension_deviceTimeZone
      target_field: prisma_access.event.device.time_zone
      ignore_missing: true
  - set:
      field: event.timezone
      tag: set_event_timezone_from_event_device_time_zone
      copy_from: prisma_access.event.device.time_zone
      ignore_empty_value: true
  - rename:
      field: cef.extensions.Device Vendor
      tag: rename_extension_Device Vendor
      target_field: prisma_access.event.device.vendor
      ignore_missing: true
  - rename:
      field: cef.extensions.Vendor Name
      tag: rename_extension_Vendor_Name
      target_field: prisma_access.event.device.vendor
      ignore_missing: true
  - set:
      field: observer.vendor
      tag: set_observer_vendor_from_event_device_vendor
      copy_from: prisma_access.event.device.vendor
      ignore_empty_value: true
  - convert:
      field: cef.extensions.PanOSDGHierarchyLevel1
      tag: convert_extension_PanOSDGHierarchyLevel1_to_long
      target_field: prisma_access.event.dg_hierarchy.level1
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSDGHierarchyLevel2
      tag: convert_extension_PanOSDGHierarchyLevel2_to_long
      target_field: prisma_access.event.dg_hierarchy.level2
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSDGHierarchyLevel3
      tag: convert_extension_PanOSDGHierarchyLevel3_to_long
      target_field: prisma_access.event.dg_hierarchy.level3
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSDGHierarchyLevel4
      tag: convert_extension_PanOSDGHierarchyLevel4_to_long
      target_field: prisma_access.event.dg_hierarchy.level4
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSDiamAppID
      tag: rename_extension_PanOSDiamAppID
      target_field: prisma_access.event.diam.app_id
      ignore_missing: true
  - set:
      field: network.iana_number
      tag: set_network_iana_number_from_event_diam_app_id
      copy_from: prisma_access.event.diam.app_id
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSDiamAvpCode
      tag: rename_extension_PanOSDiamAvpCode
      target_field: prisma_access.event.diam.avp_code
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDiameterCommandCode
      tag: rename_extension_PanOSDiameterCommandCode
      target_field: prisma_access.event.diameter_command_code
      ignore_missing: true
  - rename:
      field: cef.extensions.flexString2
      tag: rename_extension_flexString2
      target_field: prisma_access.event.direction_of_attack
      ignore_missing: true
  - rename:
      field: cef.extensions.flexString2Label
      tag: rename_extension_flexString2Label
      target_field: prisma_access.event.label.flex_string
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDisableHistory
      tag: rename_extension_PanOSDisableHistory
      target_field: prisma_access.event.disable_history
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSDiskAvailable
      tag: convert_extension_PanOSDiskAvailable_to_double
      target_field: prisma_access.event.disk_available
      type: double
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSDiskAvailable != null && ctx.cef.extensions.PanOSDiskAvailable != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSDLPVersionFlag
      tag: rename_extension_PanOSDLPVersionFlag
      target_field: prisma_access.event.dlp_version_flag
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSDLSAstatus
      tag: convert_extension_PanOSDLSAstatus_to_boolean
      target_field: prisma_access.event.dlsa_status
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSDNSCategory
      tag: rename_extension_PanOSDNSCategory
      target_field: prisma_access.event.dns.category
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSDNSReachable
      tag: convert_extension_PanOSDNSReachable_to_boolean
      target_field: prisma_access.event.dns.reachable
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSDNSResolverIP
      tag: convert_extension_PanOSDNSResolverIP_to_ip
      target_field: prisma_access.event.dns.resolver_ip
      type: ip
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: related.ip
      tag: append_event_dns_response_into_related_ip
      value: "{{{prisma_access.event.dns.resolver_ip}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.dns?.resolver_ip != null
  - convert:
      field: cef.extensions.PanOSDNSResponse
      tag: convert_extension_PanOSDNSResponse_to_ip
      target_field: prisma_access.event.dns.response.value
      type: ip
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: dns.resolved_ip
      tag: append_prisma_access_event_dns_response_value_into_dns_resolved_ip
      value: "{{{prisma_access.event.dns.response.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.dns?.response?.value != null
  - append:
      field: related.ip
      tag: append_event_dns_response_into_related_ip
      value: "{{{prisma_access.event.dns.response.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.dns?.response?.value != null
  - rename:
      field: cef.extensions.PanOSDNSResponseCode
      tag: rename_extension_PanOSDNSResponseCode
      target_field: prisma_access.event.dns.response.code
      ignore_missing: true
  - set:
      field: dns.response_code
      tag: set_dns_response_code_from_event_dns_response_code
      copy_from: prisma_access.event.dns.response.code
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSDNSSecuityVersion
      tag: rename_extension_PanOSDNSSecuityVersion
      target_field: prisma_access.event.dns.secuity_version
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSDomain
      tag: rename_extension_PanOSDomain
      target_field: prisma_access.event.domain.value
      ignore_missing: true
  - append:
      field: related.hosts
      tag: append_event_domain_into_related_hosts
      value: "{{{prisma_access.event.domain.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.domain != null
  - rename:
      field: cef.extensions.PanOSDomainEDL
      tag: rename_extension_PanOSDomainEDL
      target_field: prisma_access.event.domain.edl
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString5
      tag: rename_extension_deviceCustomString5
      target_field: prisma_access.event.dst_zone
      if: ctx.cef?.device?.event_class_id == 'DNS SECURITY'
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSDualStackTunnelInterface
      tag: convert_extension_PanOSDualStackTunnelInterface_to_boolean
      target_field: prisma_access.event.dual_stack_tunnel_interface
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSDynamicUserGroup
      tag: rename_extension_PanOSDynamicUserGroup
      target_field: prisma_access.event.dynamic_user_group.value
      ignore_missing: true
  - append:
      field: user.group.name
      tag: append_user_group_name_from_event_dynamic_user_group_value
      value: "{{{prisma_access.event.dynamic_user_group.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.dynamic_user_group?.value != null
  - rename:
      field: cef.extensions.PanOSDynamicUserGroupName
      tag: rename_extension_PanOSDynamicUserGroupName
      target_field: prisma_access.event.dynamic_user_group.name
      ignore_missing: true
  - append:
      field: user.group.name
      tag: append_user_group_name_from_event_dynamic_user_group_name
      value: "{{{prisma_access.event.dynamic_user_group.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.dynamic_user_group?.name != null
  - rename:
      field: cef.extensions.PanOSEllipticCurve
      tag: rename_extension_PanOSEllipticCurve
      target_field: prisma_access.event.elliptic_curve
      ignore_missing: true
  - set:
      field: tls.curve
      tag: set_tls_curve_from_event_elliptic_curve
      copy_from: prisma_access.event.elliptic_curve
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSEmailSubject
      tag: rename_extension_PanOSEmailSubject
      target_field: prisma_access.event.email_subject
      ignore_missing: true
  - set:
      field: email.subject
      tag: set_email_subject_from_event_email_subject
      copy_from: prisma_access.event.email_subject
      ignore_empty_value: true
  - date:
      field: cef.extensions.endTime
      tag: date_extension_endTime
      target_field: prisma_access.event.end_time
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.endTime != null && ctx.cef.extensions.endTime != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: event.end
      tag: set_event_end_from_event_end_time
      copy_from: prisma_access.event.end_time
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSEndpointAssociationID
      tag: rename_extension_PanOSEndpointAssociationID
      target_field: prisma_access.event.endpoint.association_id
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSEndpointCPUArchitecture
      tag: rename_extension_PanOSEndpointCPUArchitecture
      target_field: prisma_access.event.endpoint.cpu_architecture
      ignore_missing: true
  - set:
      field: host.architecture
      tag: set_host_architecture_from_event_endpoint_cpu_architecture
      copy_from: prisma_access.event.endpoint.cpu_architecture
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSEndpointDeviceDomain
      tag: rename_extension_PanOSEndpointDeviceDomain
      target_field: prisma_access.event.endpoint.device.domain
      ignore_missing: true
  - set:
      field: host.domain
      tag: set_host_domain_from_event_endpoint_device_domain
      copy_from: prisma_access.event.endpoint.device.domain
      ignore_empty_value: true
  - append:
      field: related.hosts
      tag: append_event_endpoint_device_domain_into_related_hosts
      value: "{{{prisma_access.event.endpoint.device.domain}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.endpoint?.device?.domain != null
  - rename:
      field: cef.extensions.PanOSEndpointDeviceName
      tag: rename_extension_PanOSEndpointDeviceName
      target_field: prisma_access.event.endpoint.device.name
      ignore_missing: true
  - set:
      field: host.hostname
      tag: set_host_hostname_from_event_endpoint_device_name
      copy_from: prisma_access.event.endpoint.device.name
      ignore_empty_value: true
  - append:
      field: related.hosts
      tag: append_event_endpoint_device_name_into_related_hosts
      value: "{{{prisma_access.event.endpoint.device.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.endpoint?.device?.name != null
  - convert:
      field: cef.extensions.PanOSEndpointIPaddress
      tag: convert_extension_PanOSEndpointIPaddress_to_ip
      target_field: prisma_access.event.endpoint.ip_address
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSEndpointIPaddress != null && ctx.cef.extensions.PanOSEndpointIPaddress != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: host.ip
      tag: append_prisma_access_event_endpoint_ip_address_into_host_ip
      value: "{{{prisma_access.event.endpoint.ip_address}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.endpoint?.ip_address != null
  - append:
      field: related.ip
      tag: append_event_endpoint_ip_address_into_related_ip
      value: "{{{prisma_access.event.endpoint.ip_address}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.endpoint?.ip_address != null
  - rename:
      field: cef.extensions.deviceCustomString2
      tag: rename_extension_deviceCustomString2
      target_field: prisma_access.event.endpoint.os.type
      if: ctx.cef?.device?.event_class_id == 'HIPMATCH'
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString2Label
      tag: rename_extension_deviceCustomString2Label
      target_field: prisma_access.event.label.cs2
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSEndpointOSType
      tag: rename_extension_PanOSEndpointOSType
      target_field: prisma_access.event.endpoint.os.type
      ignore_missing: true
  - set:
      field: host.os.name
      tag: set_host_os_name_from_event_endpoint_os_type
      copy_from: prisma_access.event.endpoint.os.type
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSEndpointOSVersion
      tag: rename_extension_PanOSEndpointOSVersion
      target_field: prisma_access.event.endpoint.os.version
      ignore_missing: true
  - set:
      field: host.os.version
      tag: set_host_os_version_from_event_endpoint_os_version
      copy_from: prisma_access.event.endpoint.os.version
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSEndpointSerialNumber
      tag: rename_extension_PanOSEndpointSerialNumber
      target_field: prisma_access.event.endpoint.serial_number
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSEndpointSN
      tag: rename_extension_PanOSEndpointSN
      target_field: prisma_access.event.endpoint.sn
      ignore_missing: true
  - set:
      field: host.id
      tag: set_host_id_from_event_endpoint_sn
      copy_from: prisma_access.event.endpoint.sn
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSEndpointUserDomain
      tag: rename_extension_PanOSEndpointUserDomain
      target_field: prisma_access.event.endpoint.user.domain
      ignore_missing: true
  - set:
      field: user.domain
      tag: set_user_domain_from_event_endpoint_user_domain
      copy_from: prisma_access.event.endpoint.user.domain
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSEndpointUserName
      tag: rename_extension_PanOSEndpointUserName
      target_field: prisma_access.event.endpoint.user.name
      ignore_missing: true
  - set:
      field: user.name
      tag: set_user_name_from_event_endpoint_user_name
      copy_from: prisma_access.event.endpoint.user.name
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_event_endpoint_user_name_into_related_user
      value: "{{{prisma_access.event.endpoint.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.endpoint?.user?.name != null
  - rename:
      field: cef.extensions.PanOSEndpointUserUUID
      tag: rename_extension_PanOSEndpointUserUUID
      target_field: prisma_access.event.endpoint.user.uuid
      ignore_missing: true
  - set:
      field: user.id
      tag: set_user_id_from_event_endpoint_user_uuid
      copy_from: prisma_access.event.endpoint.user.uuid
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_event_endpoint_user_uuid_into_related_user
      value: "{{{prisma_access.event.endpoint.user.uuid}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.endpoint?.user?.uuid != null
  - convert:
      field: cef.extensions.PanOSEnforcerStatus
      tag: convert_extension_PanOSEnforcerStatus_to_boolean
      target_field: prisma_access.event.enforcer_status
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSErrorDetails
      tag: rename_extension_PanOSErrorDetails
      target_field: prisma_access.event.error.details
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSErrorIndex
      tag: rename_extension_PanOSErrorIndex
      target_field: prisma_access.event.error.index
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSErrorMessage
      tag: rename_extension_PanOSErrorMessage
      target_field: prisma_access.event.error.message
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSErrorStage
      tag: rename_extension_PanOSErrorStage
      target_field: prisma_access.event.error.stage
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSEventCode
      tag: rename_extension_PanOSEventCode
      target_field: prisma_access.event.data.code
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSEventDescription
      tag: rename_extension_PanOSEventDescription
      target_field: prisma_access.event.data.description
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSEventDetails
      tag: rename_extension_PanOSEventDetails
      target_field: prisma_access.event.data.details
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSEventID
      tag: rename_extension_PanOSEventID
      target_field: prisma_access.event.data.id
      ignore_missing: true
  - rename:
      field: cef.extensions.eventOutcome
      tag: rename_extension_eventOutcome
      target_field: prisma_access.event.data.outcome
      ignore_missing: true
  - set:
      field: event.outcome
      tag: set_event_outcome_to_success
      value: "success"
      ignore_empty_value: true
      if: ctx.prisma_access?.event?.data?.outcome != null && ctx.prisma_access.event.data.outcome.toLowerCase() == 'success'
  - set:
      field: event.outcome
      tag: set_event_outcome_to_failure
      value: "failure"
      ignore_empty_value: true
      if: ctx.prisma_access?.event?.data?.outcome != null && ctx.prisma_access.event.data.outcome.toLowerCase() == 'failure'
  - rename:
      field: cef.extensions.PanOSEventResult
      tag: rename_extension_PanOSEventResult
      target_field: prisma_access.event.data.result
      ignore_missing: true
  - rename:
      field: cef.extensions.externalId
      tag: rename_extension_externalId
      target_field: prisma_access.event.external_id
      ignore_missing: true
  - set:
      field: event.id
      tag: set_event_id_from_event_external_id
      copy_from: prisma_access.event.external_id
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSFallbacktoSSLReason
      tag: rename_extension_PanOSFallbacktoSSLReason
      target_field: prisma_access.event.fallback_to_ssl_reason
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSFileHash
      tag: rename_extension_PanOSFileHash
      target_field: prisma_access.event.file.hash
      ignore_missing: true
  - set:
      field: file.hash.sha256
      tag: set_file_hash_sha256_from_event_file_hash
      copy_from: prisma_access.event.file.hash
      ignore_empty_value: true
      if: ctx.cef?.device?.event_class_id == 'FILE' || ctx.cef?.extensions?.Name == 'file'
  - set:
      field: threat.indicator.file.hash.sha256
      tag: set_threat_indicator_file_hash_sha256_from_event_file_hash
      copy_from: prisma_access.event.file.hash
      ignore_empty_value: true
      if: ctx.cef?.device?.event_class_id == 'THREAT' && ctx.cef?.extensions?.Name != 'file'
  - append:
      field: related.hash
      tag: append_event_file_hash_into_related_hash
      value: "{{{prisma_access.event.file.hash}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.file?.hash != null
  - rename:
      field: cef.extensions.fileId
      tag: rename_extension_fileId
      target_field: prisma_access.event.file.id
      ignore_missing: true
  - rename:
      field: cef.extensions.filePath
      tag: rename_extension_filePath
      target_field: prisma_access.event.file.name
      ignore_missing: true
  - append:
      field: file.name
      tag: append_prisma_access_event_file_name_into_file_name
      value: "{{{prisma_access.event.file.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.file?.name != null
  - rename:
      field: cef.extensions.PanOSFileType
      tag: rename_extension_PanOSFileType
      target_field: prisma_access.event.file.type
      ignore_missing: true
  - set:
      field: file.type
      tag: set_file_type_from_event_file_type
      copy_from: prisma_access.event.file.type
      ignore_empty_value: true
      if: ctx.cef?.device?.event_class_id == 'FILE' || ctx.cef?.extensions?.Name == 'file'
  - set:
      field: threat.indicator.file.type
      tag: set_threat_indicator_file_type_from_event_file_type
      copy_from: prisma_access.event.file.type
      ignore_empty_value: true
      if: ctx.cef?.device?.event_class_id == 'THREAT' && ctx.cef?.extensions?.Name != 'file'
  - rename:
      field: cef.extensions.PanOSFileURL
      tag: rename_extension_PanOSFileURL
      target_field: prisma_access.event.file.url
      ignore_missing: true
  - append:
      field: file.path
      tag: append_prisma_access_event_file_url_into_file_path
      value: "{{{prisma_access.event.file.url}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.file?.url != null && ctx.cef?.device?.event_class_id == 'FILE' || ctx.cef?.extensions?.Name == 'file'
  - rename:
      field: cef.extensions.filename
      tag: rename_extension_filename
      target_field: prisma_access.event.filename
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSFingerprint
      tag: rename_extension_PanOSFingerprint
      target_field: prisma_access.event.fingerprint
      ignore_missing: true
  - set:
      field: tls.client.hash.md5
      tag: set_tls_client_hash_md5_from_event_fingerprint
      copy_from: prisma_access.event.fingerprint
      ignore_empty_value: true
      if: ctx.prisma_access?.event?.fingerprint != null && ctx.prisma_access.event.fingerprint.length() == 32
  - set:
      field: tls.client.hash.sha256
      tag: set_tls_client_hash_sha255_from_event_fingerprint
      copy_from: prisma_access.event.fingerprint
      ignore_empty_value: true
      if: ctx.prisma_access?.event?.fingerprint != null && ctx.prisma_access.event.fingerprint.length() == 64
  - set:
      field: tls.client.hash.sha1
      tag: set_tls_client_hash_sha1_from_event_fingerprint
      copy_from: prisma_access.event.fingerprint
      ignore_empty_value: true
      if: ctx.prisma_access?.event?.fingerprint != null && ctx.prisma_access.event.fingerprint.length() == 40
  - append:
      field: related.hash
      tag: append_event_fingerprint_into_related_hash
      value: "{{{prisma_access.event.fingerprint}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.fingerprint != null
  - convert:
      field: cef.extensions.PanOSFirewallToClient
      tag: convert_extension_PanOSFirewallToClient_to_boolean
      target_field: prisma_access.event.firewall_to_client
      type: boolean
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSFirewallToClient != null && ctx.cef.extensions.PanOSFirewallToClient != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.FlowType
      tag: rename_extension_FlowType
      target_field: prisma_access.event.flow_type
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString4
      tag: rename_extension_deviceCustomString4
      target_field: prisma_access.event.from_zone
      if: ctx.cef?.device?.event_class_id != null && ['DNS SECURITY','DECRYPTION','FILE','SCTP','THREAT','TRAFFIC','TUNNEL','URL'].contains(ctx.cef.device.event_class_id) || (ctx.cef?.extensions != null && ['url','file'].contains(ctx.cef.extensions.Name))
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSGateway
      tag: rename_extension_PanOSGateway
      target_field: prisma_access.event.gateway.value
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSGatewayAddress
      tag: convert_extension_PanOSGatewayAddress_to_ip
      target_field: prisma_access.event.gateway.address
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSGatewayAddress != null && ctx.cef.extensions.PanOSGatewayAddress != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: observer.ip
      tag: append_observer_ip_from_event_gateway_address
      value: "{{{prisma_access.event.gateway.address}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.gateway?.address != null
  - append:
      field: related.ip
      tag: append_event_gateway_address_into_related_ip
      value: "{{{prisma_access.event.gateway.address}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.gateway?.address != null
  - rename:
      field: cef.extensions.PanOSGatewayAuthentication
      tag: rename_extension_PanOSGatewayAuthentication
      target_field: prisma_access.event.gateway.authentication
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSGatewayConfigurationName
      tag: rename_extension_PanOSGatewayConfigurationName
      target_field: prisma_access.event.gateway.configuration_name
      ignore_missing: true
  - date:
      field: cef.extensions.PanOSGatewayLogoutTime
      tag: date_extension_PanOSGatewayLogoutTime
      target_field: prisma_access.event.gateway.logout_time
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSGatewayLogoutTime != null && ctx.cef.extensions.PanOSGatewayLogoutTime != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSGatewayPriority
      tag: rename_extension_PanOSGatewayPriority
      target_field: prisma_access.event.gateway.priority
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSGatewayReachable
      tag: convert_extension_PanOSGatewayReachable_to_boolean
      target_field: prisma_access.event.gateway.reachable
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSGatewaySelectionType
      tag: rename_extension_PanOSGatewaySelectionType
      target_field: prisma_access.event.gateway.selection_type
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSGatewaySSLCertificateValid
      tag: convert_extension_PanOSGatewaySSLCertificateValid_to_boolean
      target_field: prisma_access.event.gateway.ssl_certificate_valid
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSGatewayStatus
      tag: rename_extension_PanOSGatewayStatus
      target_field: prisma_access.event.gateway.status
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSGlobalProtectClientVersion
      tag: rename_extension_PanOSGlobalProtectClientVersion
      target_field: prisma_access.event.global_protect.client_version
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSGlobalProtectCPUUsage
      tag: convert_extension_PanOSGlobalProtectCPUUsage_to_double
      target_field: prisma_access.event.global_protect.cpu_usage
      type: double
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSGlobalProtectCPUUsage != null && ctx.cef.extensions.PanOSGlobalProtectCPUUsage != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSGlobalProtectGatewayLocation
      tag: rename_extension_PanOSGlobalProtectGatewayLocation
      target_field: prisma_access.event.global_protect.gateway_location
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSGlobalProtectMemoryUsage
      tag: rename_extension_PanOSGlobalProtectMemoryUsage
      target_field: prisma_access.event.global_protect.memory_usage
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSGlobalProtectMTU
      tag: convert_extension_PanOSGlobalProtectMTU_to_long
      target_field: prisma_access.event.global_protect.mtu
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSGlobalProtectVersion
      tag: rename_extension_PanOSGlobalProtectVersion
      target_field: prisma_access.event.global_protect.version
      ignore_missing: true
  - set:
      field: observer.version
      tag: set_observer_version_from_event_global_protect_version
      copy_from: prisma_access.event.global_protect.version
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSGPHostID
      tag: rename_extension_PanOSGPHostID
      target_field: prisma_access.event.gp_host_id
      ignore_missing: true
  - append:
      field: related.hosts
      tag: append_event_gp_host_id_into_related_hosts
      value: "{{{prisma_access.event.gp_host_id}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.gp_host_id != null
  - rename:
      field: cef.extensions.PanOSHASessionOwner
      tag: rename_extension_PanOSHASessionOwner
      target_field: prisma_access.event.ha_session_owner
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSHipMatchType
      tag: rename_extension_PanOSHipMatchType
      target_field: prisma_access.event.hip_match_type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSHostID
      tag: rename_extension_PanOSHostID
      target_field: prisma_access.event.host_id
      ignore_missing: true
  - append:
      field: related.hosts
      tag: append_event_host_id_into_related_hosts
      value: "{{{prisma_access.event.host_id}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.host_id != null
  - rename:
      field: cef.extensions.PanOSHTTPHeaders
      tag: rename_extension_PanOSHTTPHeaders
      target_field: prisma_access.event.http.headers
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSHTTPMethod
      tag: rename_extension_PanOSHTTPMethod
      target_field: prisma_access.event.http.method
      ignore_missing: true
  - set:
      field: http.request.method
      tag: set_http_request_method_from_event_http_method
      copy_from: prisma_access.event.http.method
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSHTTPRefererFQDN
      tag: rename_extension_PanOSHTTPRefererFQDN
      target_field: prisma_access.event.http.referer.fqdn
      ignore_missing: true
  - append:
      field: related.hosts
      tag: append_event_http_referer_fqdn_into_related_hosts
      value: "{{{prisma_access.event.http.referer.fqdn}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.http?.referer?.fqdn != null
  - convert:
      field: cef.extensions.PanOSHTTPRefererPort
      tag: convert_extension_PanOSHTTPRefererPort_to_long
      target_field: prisma_access.event.http.referer.port
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSHTTPRefererProtocol
      tag: rename_extension_PanOSHTTPRefererProtocol
      target_field: prisma_access.event.http.referer.protocol
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSHTTPRefererURLPath
      tag: rename_extension_PanOSHTTPRefererURLPath
      target_field: prisma_access.event.http.referer.url_path
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSHTTP2Connection
      tag: convert_extension_PanOSHTTP2Connection_to_string
      target_field: prisma_access.event.http2_connection
      type: string
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSIMEI
      tag: rename_extension_PanOSIMEI
      target_field: prisma_access.event.imei
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSIMSI
      tag: rename_extension_PanOSIMSI
      target_field: prisma_access.event.imsi
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSInboundInterface
      tag: rename_extension_PanOSInboundInterface
      target_field: prisma_access.event.inbound_interface.value
      ignore_missing: true
  - set:
      field: observer.ingress.interface.name
      tag: set_observer_ingress_interface_name_from_event_inbound_interface
      copy_from: prisma_access.event.inbound_interface.value
      ignore_empty_value: true
  - convert:
      field: cef.extensions.PanOSInboundInterfaceDetailsPort
      tag: convert_extension_PanOSInboundInterfaceDetailsPort_to_long
      target_field: prisma_access.event.inbound_interface.details.port
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSInboundInterfaceDetailsSlot
      tag: convert_extension_PanOSInboundInterfaceDetailsSlot_to_long
      target_field: prisma_access.event.inbound_interface.details.slot
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSInboundInterfaceDetailsType
      tag: rename_extension_PanOSInboundInterfaceDetailsType
      target_field: prisma_access.event.inbound_interface.details.type
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSInboundInterfaceDetailsUnit
      tag: convert_extension_PanOSInboundInterfaceDetailsUnit_to_long
      target_field: prisma_access.event.inbound_interface.details.unit
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSInlineMLVerdict
      tag: rename_extension_PanOSInlineMLVerdict
      target_field: prisma_access.event.inline_ml_verdict
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSInstallHistory
      tag: convert_extension_PanOSInstallHistory_to_boolean
      target_field: prisma_access.event.install_history
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSInternalNetwork
      tag: convert_extension_PanOSInternalNetwork_to_boolean
      target_field: prisma_access.event.internal.network
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSInternetAccess
      tag: convert_extension_PanOSInternetAccess_to_boolean
      target_field: prisma_access.event.internet.access
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSIPSubnetRange
      tag: rename_extension_PanOSIPSubnetRange
      target_field: prisma_access.event.ip_subnet_range
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSIPSecEnabled
      tag: convert_extension_PanOSIPSecEnabled_to_boolean
      target_field: prisma_access.event.ipsec.enabled
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSIPSecFailureReason
      tag: rename_extension_PanOSIPSecFailureReason
      target_field: prisma_access.event.ipsec.failure_reason
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSIsCertCNTruncated
      tag: convert_extension_PanOSIsCertCNTruncated_to_boolean
      target_field: prisma_access.event.is_cert.cn_truncated
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsCertECDSA
      tag: convert_extension_PanOSIsCertECDSA_to_boolean
      target_field: prisma_access.event.is_cert.ecdsa
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsCertRSA
      tag: convert_extension_PanOSIsCertRSA_to_boolean
      target_field: prisma_access.event.is_cert.rsa
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsClienttoServer
      tag: convert_extension_PanOSIsClienttoServer_to_boolean
      target_field: prisma_access.event.is_client_to_server
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: network.direction
      tag: append_prisma_access_event_is_client_to_server_into_network_direction
      value: inbound
      allow_duplicates: false
      if: ctx.prisma_access?.event?.is_client_to_server != null && ctx.prisma_access.event.is_client_to_server == true
  - append:
      field: network.direction
      tag: append_prisma_access_event_is_client_to_server_into_network_direction
      value: outbound
      allow_duplicates: false
      if: ctx.prisma_access?.event?.is_client_to_server != null && ctx.prisma_access.event.is_client_to_server == false
  - convert:
      field: cef.extensions.PanOSIsContainer
      tag: convert_extension_PanOSIsContainer_to_boolean
      target_field: prisma_access.event.is_container
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsDecryptMirror
      tag: convert_extension_PanOSIsDecryptMirror_to_boolean
      target_field: prisma_access.event.is_decrypt_mirror
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsDecrypted
      tag: convert_extension_PanOSIsDecrypted_to_boolean
      target_field: prisma_access.event.is_decrypted.value
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsDecryptedLog
      tag: convert_extension_PanOSIsDecryptedLog_to_boolean
      target_field: prisma_access.event.is_decrypted.log
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsDecryptedPayloadForward
      tag: convert_extension_PanOSIsDecryptedPayloadForward_to_boolean
      target_field: prisma_access.event.is_decrypted.payload_forward
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsDuplicateLog
      tag: convert_extension_PanOSIsDuplicateLog_to_boolean
      target_field: prisma_access.event.is_duplicate.log
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsDuplicateUser
      tag: convert_extension_PanOSIsDuplicateUser_to_boolean
      target_field: prisma_access.event.is_duplicate.user
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsEncrypted
      tag: convert_extension_PanOSIsEncrypted_to_boolean
      target_field: prisma_access.event.is_encrypted
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsForwarded
      tag: convert_extension_PanOSIsForwarded_to_boolean
      target_field: prisma_access.event.is_forwarded
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsInspectionBeforeSession
      tag: convert_extension_PanOSIsInspectionBeforeSession_to_boolean
      target_field: prisma_access.event.is_inspection_before_session
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsIPV6
      tag: convert_extension_PanOSIsIPV6_to_boolean
      target_field: prisma_access.event.is_ipv6
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: network.type
      tag: set_network_type_from_event_is_ipv6
      value: ipv6
      ignore_empty_value: true
      if: ctx.prisma_access?.event?.is_ipv6 != null && ctx.prisma_access.event.is_ipv6 == true
  - lowercase:
      field: network.type
      tag: lowercase_network_type
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSIsIssuerCNTruncated
      tag: convert_extension_PanOSIsIssuerCNTruncated_to_boolean
      target_field: prisma_access.event.is_issuer_cn_truncated
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsMptcpOn
      tag: convert_extension_PanOSIsMptcpOn_to_boolean
      target_field: prisma_access.event.is_mptcp_on
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsNAT
      tag: convert_extension_PanOSIsNAT_to_boolean
      target_field: prisma_access.event.is_nat
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsNonStandardDestinationPort
      tag: convert_extension_PanOSIsNonStandardDestinationPort_to_boolean
      target_field: prisma_access.event.is_non_standard_destination_port
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsOffloaded
      tag: convert_extension_PanOSIsOffloaded_to_boolean
      target_field: prisma_access.event.is_offloaded
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsPacketCapture
      tag: convert_extension_PanOSIsPacketCapture_to_boolean
      target_field: prisma_access.event.is_packet_capture
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsPhishing
      tag: convert_extension_PanOSIsPhishing_to_boolean
      target_field: prisma_access.event.is_phishing
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsPrismaNetwork
      tag: convert_extension_PanOSIsPrismaNetwork_to_boolean
      target_field: prisma_access.event.is_prisma.network
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsPrismaNetworks
      tag: convert_extension_PanOSIsPrismaNetworks_to_boolean
      target_field: prisma_access.event.is_prisma.network
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsPrismaUsers
      tag: convert_extension_PanOSIsPrismaUsers_to_boolean
      target_field: prisma_access.event.is_prisma.users
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsProxy
      tag: convert_extension_PanOSIsProxy_to_boolean
      target_field: prisma_access.event.is_proxy
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsReconExcluded
      tag: convert_extension_PanOSIsReconExcluded_to_boolean
      target_field: prisma_access.event.is_recon_excluded
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsResumeSession
      tag: convert_extension_PanOSIsResumeSession_to_boolean
      target_field: prisma_access.event.is_resume_session
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: tls.resumed
      tag: set_tls_resumed_from_event_is_resume_session
      copy_from: prisma_access.event.is_resume_session
      ignore_empty_value: true
  - convert:
      field: cef.extensions.PanOSIsRootCNTruncated
      tag: convert_extension_PanOSIsRootCNTruncated_to_boolean
      target_field: prisma_access.event.is_root_cn_truncated
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsSaaSApplication
      tag: convert_extension_PanOSIsSaaSApplication_to_boolean
      target_field: prisma_access.event.is_saas_application
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsServertoClient
      tag: convert_extension_PanOSIsServertoClient_to_boolean
      target_field: prisma_access.event.is_server_to_client
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: network.direction
      tag: append_prisma_access_event_is_server_to_client_into_network_direction
      value: inbound
      allow_duplicates: false
      if: ctx.prisma_access?.event?.is_server_to_client != null && ctx.prisma_access.event.is_server_to_client == false
  - append:
      field: network.direction
      tag: append_prisma_access_event_is_server_to_client_into_network_direction
      value: outbound
      allow_duplicates: false
      if: ctx.prisma_access?.event?.is_server_to_client != null && ctx.prisma_access.event.is_server_to_client == true
  - convert:
      field: cef.extensions.PanOSIsSNITruncated
      tag: convert_extension_PanOSIsSNITruncated_to_boolean
      target_field: prisma_access.event.is_sni_truncated
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsSourceXForwarded
      tag: convert_extension_PanOSIsSourceXForwarded_to_boolean
      target_field: prisma_access.event.is_source_x_forwarded
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsSystemReturn
      tag: convert_extension_PanOSIsSystemReturn_to_boolean
      target_field: prisma_access.event.is_system_return
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsTransaction
      tag: convert_extension_PanOSIsTransaction_to_boolean
      target_field: prisma_access.event.is_transaction
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsTunnelInspected
      tag: convert_extension_PanOSIsTunnelInspected_to_boolean
      target_field: prisma_access.event.is_tunnel_inspected
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSIsURLDenied
      tag: convert_extension_PanOSIsURLDenied_to_boolean
      target_field: prisma_access.event.is_url_denied
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSIssuerCommonName
      tag: rename_extension_PanOSIssuerCommonName
      target_field: prisma_access.event.issuer.common_name
      ignore_missing: true
  - append:
      field: tls.client.x509.issuer.common_name
      tag: append_prisma_access_event_issuer_common_name_into_tls_client_x509_issuer_common_name
      value: "{{{prisma_access.event.issuer.common_name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.issuer?.common_name != null
  - convert:
      field: cef.extensions.PanOSIssuerNameLength
      tag: convert_extension_PanOSIssuerNameLength_to_long
      target_field: prisma_access.event.issuer.name_length
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSJailbrokenStatus
      tag: convert_extension_PanOSJailbrokenStatus_to_boolean
      target_field: prisma_access.event.jail_broken_status
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSJitter
      tag: convert_extension_PanOSJitter_to_long
      target_field: prisma_access.event.jitter
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSJustification
      tag: rename_extension_PanOSJustification
      target_field: prisma_access.event.justification
      ignore_missing: true
  - date:
      field: cef.extensions.PanOSLastHIPReportTime
      tag: date_extension_PanOSLastHIPReportTime
      target_field: prisma_access.event.last.hip_report_time
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSLastHIPReportTime != null && ctx.cef.extensions.PanOSLastHIPReportTime != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - date:
      field: cef.extensions.PanOSLastLogoutTime
      tag: date_extension_PanOSLastLogoutTime
      target_field: prisma_access.event.last.logout_time
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSLastLogoutTime != null && ctx.cef.extensions.PanOSLastLogoutTime != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSLatency
      tag: convert_extension_PanOSLatency_to_long
      target_field: prisma_access.event.latency
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSLinkChangeCount
      tag: convert_extension_PanOSLinkChangeCount_to_long
      target_field: prisma_access.event.link.change_count
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSLinkSwitches
      tag: rename_extension_PanOSLinkSwitches
      target_field: prisma_access.event.link.switches
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSLocale
      tag: rename_extension_PanOSLocale
      target_field: prisma_access.event.locale
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSLocation
      tag: rename_extension_PanOSLocation
      target_field: prisma_access.event.location
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSLogExported
      tag: convert_extension_PanOSLogExported_to_boolean
      target_field: prisma_access.event.log.exported
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSLogForwarded
      tag: convert_extension_PanOSLogForwarded_to_boolean
      target_field: prisma_access.event.log.forwarded
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.deviceCustomString6
      tag: rename_extension_deviceCustomString6
      target_field: prisma_access.event.log.setting
      if: ctx.cef?.device?.event_class_id != null && ['AUTH','FILE','DECRYPTION','SCTP','THREAT','TRAFFIC','TUNNEL','URL'].contains(ctx.cef.device.event_class_id) || (ctx.cef?.extensions != null && ['url','file'].contains(ctx.cef.extensions.Name))
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString6Label
      tag: rename_extension_deviceCustomString6Label
      target_field: prisma_access.event.label.cs6
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSLogSetting
      tag: rename_extension_PanOSLogSetting
      target_field: prisma_access.event.log.setting
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSLogSource
      tag: rename_extension_PanOSLogSource
      target_field: prisma_access.event.log.source.value
      ignore_missing: true
  - rename:
      field: cef.extensions.LogSourceGroupID
      tag: rename_extension_LogSourceGroupID
      target_field: prisma_access.event.log.source.group_id
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSLogSourceTimeZoneOffset
      tag: rename_extension_PanOSLogSourceTimeZoneOffset
      target_field: prisma_access.event.log.source.timezone_offset
      ignore_missing: true
  - set:
      field: event.timezone
      tag: set_event_timezone_from_event_log_source_timezone_offset
      copy_from: prisma_access.event.log.source.timezone_offset
      ignore_empty_value: true
  - set:
      field: event.timezone
      tag: set_event_timezone_to_utc
      value: UTC
      if: ctx.event?.timezone == null
  - date:
      field: cef.extensions.PanOSEventTime
      tag: date_timestamp_event_timezone
      timezone: '{{{event.timezone}}}'
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSEventTime != null && ctx.cef.extensions.PanOSEventTime != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - date:
      field: cef.extensions.PanOSEventTime
      tag: date_extension_PanOSEventTime_event_timezone
      target_field: prisma_access.event.data.time
      timezone: '{{{event.timezone}}}'
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSEventTime != null && ctx.cef.extensions.PanOSEventTime != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSLogSubtype
      tag: rename_extension_PanOSLogSubtype
      target_field: prisma_access.event.log.subtype
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSLoggingServiceID
      tag: rename_extension_PanOSLoggingServiceID
      target_field: prisma_access.event.logging_service_id
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSLoginDuration
      tag: convert_extension_PanOSLoginDuration_to_long
      target_field: prisma_access.event.login_duration
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: event.duration
      tag: set_event_duration_from_event_login_duration
      copy_from: prisma_access.event.login_duration
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSMapAppCode
      tag: rename_extension_PanOSMapAppCode
      target_field: prisma_access.event.map_app_code
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString5
      tag: rename_extension_deviceCustomString5
      target_field: prisma_access.event.mapping.data_source.value
      if: ctx.cef?.device?.event_class_id == 'USERID'
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSMappingDataSource
      tag: rename_extension_PanOSMappingDataSource
      target_field: prisma_access.event.mapping.data_source.value
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString4
      tag: rename_extension_deviceCustomString4
      target_field: prisma_access.event.mapping.data_source.name
      if: ctx.cef?.device?.event_class_id == 'USERID'
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSMappingDataSourceSubType
      tag: rename_extension_PanOSMappingDataSourceSubType
      target_field: prisma_access.event.mapping.data_source.subtype
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString6
      tag: rename_extension_deviceCustomString6
      target_field: prisma_access.event.mapping.data_source.type
      if: ctx.cef?.device?.event_class_id == 'USERID'
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSMappingDataSourceType
      tag: rename_extension_PanOSMappingDataSourceType
      target_field: prisma_access.event.mapping.data_source.type
      ignore_missing: true
  - convert:
      field: cef.extensions.deviceCustomNumber3
      tag: convert_extension_deviceCustomNumber3_to_long
      target_field: prisma_access.event.mapping.timeout
      type: long
      if: ctx.cef?.device?.event_class_id == 'USERID'
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSMappingTimeout
      tag: convert_extension_PanOSMappingTimeout_to_long
      target_field: prisma_access.event.mapping.timeout
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSMemoryUsage
      tag: convert_extension_PanOSMemoryUsage_to_long
      target_field: prisma_access.event.memory_usage
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.message
      tag: rename_extension_message
      target_field: prisma_access.event.message
      ignore_missing: true
  - set:
      field: message
      tag: set_message_from_event_message
      copy_from: prisma_access.event.message
      ignore_empty_value: true
  - convert:
      field: cef.extensions.deviceCustomNumber2
      tag: convert_extension_deviceCustomNumber2_to_string
      target_field: prisma_access.event.mfa.authentication_id
      if: ctx.cef?.device?.event_class_id == 'AUTH'
      type: string
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString1
      tag: rename_extension_deviceCustomString1
      target_field: prisma_access.event.mfa.factor_type
      if: ctx.cef?.device?.event_class_id == 'USERID'
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSMFAVendor
      tag: rename_extension_PanOSMFAVendor
      target_field: prisma_access.event.mfa.vendor
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSMobileAreaCode
      tag: rename_extension_PanOSMobileAreaCode
      target_field: prisma_access.event.mobile.area_code
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSMobileBaseStationCode
      tag: rename_extension_PanOSMobileBaseStationCode
      target_field: prisma_access.event.mobile.base_station_code
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSMobileCountryCode
      tag: rename_extension_PanOSMobileCountryCode
      target_field: prisma_access.event.mobile.country_code
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSMobileIP
      tag: convert_extension_PanOSMobileIP_to_ip
      target_field: prisma_access.event.mobile.ip
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSMobileIP != null && ctx.cef.extensions.PanOSMobileIP != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: related.ip
      tag: append_event_mobile_ip_into_related_ip
      value: "{{{prisma_access.event.mobile.ip}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.mobile?.ip != null
  - rename:
      field: cef.extensions.PanOSMobileNetworkCode
      tag: rename_extension_PanOSMobileNetworkCode
      target_field: prisma_access.event.mobile.network_code
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSMobileSubscriberISDN
      tag: rename_extension_PanOSMobileSubscriberISDN
      target_field: prisma_access.event.mobile.subscriber_isdn
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSNAT
      tag: convert_extension_PanOSNAT_to_boolean
      target_field: prisma_access.event.nat.value
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSNATDestination
      tag: convert_extension_PanOSNATDestination_to_ip
      target_field: prisma_access.event.nat.destination.value
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSNATDestination != null && ctx.cef.extensions.PanOSNATDestination != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: destination.nat.ip
      tag: append_prisma_access_event_nat_destination_into_destination_nat_ip
      value: "{{{prisma_access.event.nat.destination.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.nat?.destination?.value != null
  - append:
      field: related.ip
      tag: append_event_nat_destination_into_related_ip
      value: "{{{prisma_access.event.nat.destination.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.nat?.destination?.value != null
  - convert:
      field: cef.extensions.PanOSNATDestinationPort
      tag: convert_extension_PanOSNATDestinationPort_to_long
      target_field: prisma_access.event.nat.destination.port
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: destination.nat.port
      tag: set_destination_nat_port_from_event_nat_destination_port
      copy_from: prisma_access.event.nat.destination.port
      ignore_empty_value: true
  - convert:
      field: cef.extensions.PanOSNATSource
      tag: convert_extension_PanOSNATSource_to_ip
      target_field: prisma_access.event.nat.source.value
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSNATSource != null && ctx.cef.extensions.PanOSNATSource != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: source.nat.ip
      tag: append_prisma_access_event_nat_source_into_source_nat_ip
      value: "{{{prisma_access.event.nat.source.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.nat?.source?.value != null
  - append:
      field: related.ip
      tag: append_event_nat_source_into_related_ip
      value: "{{{prisma_access.event.nat.source.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.nat?.source?.value != null
  - convert:
      field: cef.extensions.PanOSNATSourcePort
      tag: convert_extension_PanOSNATSourcePort_to_long
      target_field: prisma_access.event.nat.source.port
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: source.nat.port
      tag: set_source_nat_port_from_event_nat_source_port
      copy_from: prisma_access.event.nat.source.port
      ignore_empty_value: true
  - convert:
      field: cef.extensions.PanOSNetworkAccess
      tag: convert_extension_PanOSNetworkAccess_to_boolean
      target_field: prisma_access.event.network_access
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSNonStandardDestinationPort
      tag: convert_extension_PanOSNonStandardDestinationPort_to_long
      target_field: prisma_access.event.non_standard_destination_port
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - grok:
      field: cef.extensions.deviceCustomString2
      tag: grok_deviceCustomString2
      if: ctx.cef?.device?.event_class_id == 'AUTH' && ctx.cef?.extensions?.deviceCustomString2 != null && ctx.cef?.extensions?.deviceCustomString2.contains("\\")
      patterns:
        - (?<prisma_access.event.normalize_user.domain>[^\\]*)[\\]*(?<prisma_access.event.normalize_user.name>[^\\]*)
      on_failure:
        - rename:
            field: cef.extensions.deviceCustomString2
            tag: rename_extension_deviceCustomString2_if_grok_fails
            target_field: prisma_access.event.normalize_user.name
            ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString2
      tag: rename_extension_deviceCustomString2
      target_field: prisma_access.event.normalize_user.name
      if: ctx.cef?.device?.event_class_id == 'AUTH' && ctx.cef?.extensions?.deviceCustomString2 != null && !(ctx.cef?.extensions?.deviceCustomString2.contains("\\"))
      ignore_missing: true
  - append:
      field: related.user
      tag: append_event_normalize_user_name_into_related_user
      value: "{{{prisma_access.event.normalize_user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.normalize_user?.name != null
  - rename:
      field: cef.extensions.PanOSNSSAINetworkSliceDifferentiator
      tag: rename_extension_PanOSNSSAINetworkSliceDifferentiator
      target_field: prisma_access.event.nssai_network_slice.differentiator
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSNSSAINetworkSliceType
      tag: rename_extension_PanOSNSSAINetworkSliceType
      target_field: prisma_access.event.nssai_network_slice.type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSOperatingSystem
      tag: rename_extension_PanOSOperatingSystem
      target_field: prisma_access.event.operating_system
      ignore_missing: true
  - append:
      field: host.os.full
      tag: append_event_operating_system_into_host_os_full
      value: "{{{prisma_access.event.operating_system}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.operating_system != null
  - convert:
      field: cef.extensions.PanOSOutboundInterfaceDetailsPort
      tag: convert_extension_PanOSOutboundInterfaceDetailsPort_to_long
      target_field: prisma_access.event.outbound_interface_details.port
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSOutboundInterfaceDetailsSlot
      tag: convert_extension_PanOSOutboundInterfaceDetailsSlot_to_long
      target_field: prisma_access.event.outbound_interface_details.slot
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSOutboundInterfaceDetailsType
      tag: rename_extension_PanOSOutboundInterfaceDetailsType
      target_field: prisma_access.event.outbound_interface_details.type
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSOutboundInterfaceDetailsUnit
      tag: convert_extension_PanOSOutboundInterfaceDetailsUnit_to_long
      target_field: prisma_access.event.outbound_interface_details.unit
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSPacket
      tag: rename_extension_PanOSPacket
      target_field: prisma_access.event.packet.value
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSPacketCapture
      tag: convert_extension_PanOSPacketCapture_to_boolean
      target_field: prisma_access.event.packet.capture
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSPacketLoss
      tag: convert_extension_PanOSPacketLoss_to_double
      target_field: prisma_access.event.packet.loss
      type: double
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSPacketLoss != null && ctx.cef.extensions.PanOSPacketLoss != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSPacketsDroppedMax
      tag: convert_extension_PanOSPacketsDroppedMax_to_long
      target_field: prisma_access.event.packets.dropped.max
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSPacketsDroppedTunnel
      tag: convert_extension_PanOSPacketsDroppedTunnel_to_long
      target_field: prisma_access.event.packets.dropped.tunnel
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSPacketsReceived
      tag: convert_extension_PanOSPacketsReceived_to_long
      target_field: prisma_access.event.packets.received
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: destination.packets
      tag: set_destination_packets_from_event_packets_received
      copy_from: prisma_access.event.packets.received
      ignore_empty_value: true
  - convert:
      field: cef.extensions.PanOSPacketsSent
      tag: convert_extension_PanOSPacketsSent_to_long
      target_field: prisma_access.event.packets.sent
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: source.packets
      tag: set_source_packets_from_event_packets_sent
      copy_from: prisma_access.event.packets.sent
      ignore_empty_value: true
  - convert:
      field: cef.extensions.deviceCustomNumber2
      tag: convert_extension_deviceCustomNumber2_to_long
      target_field: prisma_access.event.packets.total
      type: long
      if: ctx.cef?.device?.event_class_id != null && ['TRAFFIC','TUNNEL'].contains(ctx.cef.device.event_class_id)
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSPacketsTotal
      tag: convert_extension_PanOSPacketsTotal_to_long
      target_field: prisma_access.event.packets.total
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: network.packets
      tag: set_network_packets_from_event_packets_total
      copy_from: prisma_access.event.packets.total
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSPadding
      tag: rename_extension_PanOSPadding
      target_field: prisma_access.event.padding
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSPadding3
      tag: rename_extension_PanOSPadding3
      target_field: prisma_access.event.padding3
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSPanoramaSN
      tag: rename_extension_PanOSPanoramaSN
      target_field: prisma_access.event.panorama_sn
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSParentSessionID
      tag: rename_extension_PanOSParentSessionID
      target_field: prisma_access.event.parent.session_id
      ignore_missing: true
  - date:
      field: cef.extensions.PanOSParentStartTime
      tag: date_extension_PanOSParentStartTime
      target_field: prisma_access.event.parent.start_time
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSParentStartTime != null && ctx.cef.extensions.PanOSParentStartTime != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - date:
      field: cef.extensions.PanOSParentStarttime
      tag: date_extension_PanOSParentStarttime
      target_field: prisma_access.event.parent.start_time
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSParentStarttime != null && ctx.cef.extensions.PanOSParentStarttime != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSPartialHash
      tag: rename_extension_PanOSPartialHash
      target_field: prisma_access.event.partial_hash
      ignore_missing: true
  - append:
      field: related.hash
      tag: append_event_partial_hash_into_related_hash
      value: "{{{prisma_access.event.partial_hash}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.partial_hash != null
  - rename:
      field: cef.extensions.PanOSPayloadProtocolID
      tag: rename_extension_PanOSPayloadProtocolID
      target_field: prisma_access.event.payload_protocol_id
      ignore_missing: true
  - rename:
      field: cef.extensions.PlatformType
      tag: rename_extension_PlatformType
      target_field: prisma_access.event.platform_type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSPolicyName
      tag: rename_extension_PanOSPolicyName
      target_field: prisma_access.event.policy_name
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSPortal
      tag: rename_extension_PanOSPortal
      target_field: prisma_access.event.portal.value
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSPortalAddress
      tag: convert_extension_PanOSPortalAddress_to_ip
      target_field: prisma_access.event.portal.address
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSPortalAddress != null && ctx.cef.extensions.PanOSPortalAddress != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: related.ip
      tag: append_event_portal_address_into_related_ip
      value: "{{{prisma_access.event.portal.address}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.portal?.address != null
  - rename:
      field: cef.extensions.PanOSPortalAuthentication
      tag: rename_extension_PanOSPortalAuthentication
      target_field: prisma_access.event.portal.authentication
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSPortalConfigurationName
      tag: rename_extension_PanOSPortalConfigurationName
      target_field: prisma_access.event.portal.configuration_name
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSPortalGatewayLatency
      tag: convert_extension_PanOSPortalGatewayLatency_to_long
      target_field: prisma_access.event.portal.gateway_latency
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - date:
      field: cef.extensions.flexDate1
      tag: date_extension_flexDate1
      target_field: prisma_access.event.portal.last_connect_time
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.flexDate1 != null && ctx.cef.extensions.flexDate1 != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSPortalReachable
      tag: convert_extension_PanOSPortalReachable_to_boolean
      target_field: prisma_access.event.portal.reachable
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSPortalSSLCertificateValid
      tag: convert_extension_PanOSPortalSSLCertificateValid_to_boolean
      target_field: prisma_access.event.portal.ssl_certificate_valid
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSPortalStatus
      tag: rename_extension_PanOSPortalStatus
      target_field: prisma_access.event.portal.status
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSPrivateIPv4
      tag: convert_extension_PanOSPrivateIPv4_to_ip
      target_field: prisma_access.event.private.ipv4
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSPrivateIPv4 != null && ctx.cef.extensions.PanOSPrivateIPv4 != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: source.ip
      tag: append_prisma_access_event_private_ipv4_into_source_ip
      value: "{{{prisma_access.event.private.ipv4}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.private?.ipv4 != null
  - append:
      field: related.ip
      tag: append_event_private_ipv4_into_related_ip
      value: "{{{prisma_access.event.private.ipv4}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.private?.ipv4 != null
  - convert:
      field: cef.extensions.PanOSPublicIPv4
      tag: convert_extension_PanOSPublicIPv4_to_ip
      target_field: prisma_access.event.public.ipv4
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSPublicIPv4 != null && ctx.cef.extensions.PanOSPublicIPv4 != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: source.ip
      tag: append_prisma_access_event_public_ipv4_into_source_ip
      value: "{{{prisma_access.event.public.ipv4}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.public?.ipv4 != null
  - append:
      field: related.ip
      tag: append_event_public_ipv4_into_related_ip
      value: "{{{prisma_access.event.public.ipv4}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.public?.ipv4 != null
  - convert:
      field: cef.extensions.PanOSPrivateIPv6
      tag: convert_extension_PanOSPrivateIPv6_to_ip
      target_field: prisma_access.event.private.ipv6
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSPrivateIPv6 != null && ctx.cef.extensions.PanOSPrivateIPv6 != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - lowercase:
      field: prisma_access.event.private.ipv6
      tag: lowercase_prisma_access_event_private_ipv6
      ignore_missing: true
  - append:
      field: source.ip
      tag: append_prisma_access_event_private_ipv6_into_source_ip
      value: "{{{prisma_access.event.private.ipv6}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.private?.ipv6 != null
  - append:
      field: related.ip
      tag: append_event_private_ipv6_into_related_ip
      value: "{{{prisma_access.event.private.ipv6}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.private?.ipv6 != null
  - convert:
      field: cef.extensions.PanOSPublicIPv6
      tag: convert_extension_PanOSPublicIPv6_to_ip
      target_field: prisma_access.event.public.ipv6
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSPublicIPv6 != null && ctx.cef.extensions.PanOSPublicIPv6 != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - lowercase:
      field: prisma_access.event.public.ipv6
      tag: lowercase_prisma_access_event_public_ipv6
      ignore_missing: true
  - append:
      field: source.ip
      tag: append_prisma_access_event_public_ipv6_into_source_ip
      value: "{{{prisma_access.event.public.ipv6}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.public?.ipv6 != null
  - append:
      field: related.ip
      tag: append_event_public_ipv6_into_related_ip
      value: "{{{prisma_access.event.public.ipv6}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.public?.ipv6 != null
  - convert:
      field: cef.extensions.PanOSPrivileges
      tag: convert_extension_PanOSPrivileges_to_boolean
      target_field: prisma_access.event.privileges
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSProfileName
      tag: rename_extension_PanOSProfileName
      target_field: prisma_access.event.profile.name
      ignore_missing: true
  - rename:
      field: cef.extensions.ProfileToken
      tag: rename_extension_ProfileToken
      target_field: prisma_access.event.profile.token
      ignore_missing: true
  - rename:
      field: cef.extensions.ProjectName
      tag: rename_extension_ProjectName
      target_field: prisma_access.event.project_name
      ignore_missing: true
  - rename:
      field: cef.extensions.transportProtocol
      tag: rename_extension_transportProtocol
      target_field: prisma_access.event.transport_protocol
      ignore_missing: true
  - set:
      field: network.transport
      tag: set_network_transport_from_event_transport_protocol
      copy_from: prisma_access.event.transport_protocol
      ignore_empty_value: true
  - lowercase:
      field: network.transport
      tag: lowercase_network_transport
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSProtocolDataUnitsessionID
      tag: rename_extension_PanOSProtocolDataUnitsessionID
      target_field: prisma_access.event.protocol_data_unitsession_id
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSProxyServer
      tag: convert_extension_PanOSProxyServer_to_boolean
      target_field: prisma_access.event.proxy.server
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSProxyType
      tag: rename_extension_PanOSProxyType
      target_field: prisma_access.event.proxy.type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSQuarantineReason
      tag: rename_extension_PanOSQuarantineReason
      target_field: prisma_access.event.quarantine_reason
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSRadioAccessTechnology
      tag: rename_extension_PanOSRadioAccessTechnology
      target_field: prisma_access.event.radio_access_technology
      ignore_missing: true
  - rename:
      field: cef.extensions.Reason
      tag: rename_extension_Reason
      target_field: prisma_access.event.reason
      ignore_missing: true
  - set:
      field: event.reason
      tag: set_event_reason_from_event_reason
      copy_from: prisma_access.event.reason
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSReasonForDataFilteringAction
      tag: rename_extension_PanOSReasonForDataFilteringAction
      target_field: prisma_access.event.reason_for_data_filtering_action
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSRecipientEmail
      tag: rename_extension_PanOSRecipientEmail
      target_field: prisma_access.event.recipient_email
      ignore_missing: true
  - append:
      field: email.to.address
      tag: append_event_reason_from_event_recipient_email
      value: "{{{prisma_access.event.recipient_email}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.recipient_email != null
  - append:
      field: related.user
      tag: append_event_recipient_email_into_related_user
      value: "{{{prisma_access.event.recipient_email}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.recipient_email != null
  - rename:
      field: cef.extensions.PanOSRecordType
      tag: rename_extension_PanOSRecordType
      target_field: prisma_access.event.record_type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSReferer
      tag: rename_extension_PanOSReferer
      target_field: prisma_access.event.referer
      ignore_missing: true
  - set:
      field: http.request.referrer
      tag: set_http_request_referrer_from_event_referer
      copy_from: prisma_access.event.referer
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSReportID
      tag: rename_extension_PanOSReportID
      target_field: prisma_access.event.report_id
      ignore_missing: true
  - rename:
      field: cef.extensions.requestClientApplication
      tag: rename_extension_requestClientApplication
      target_field: prisma_access.event.request.client_application
      ignore_missing: true
  - user_agent:
      field: prisma_access.event.request.client_application
      tag: user_agent_original_from_request_client_application
      ignore_missing: true
  - rename:
      field: cef.extensions.requestContext
      tag: rename_extension_requestContext
      target_field: prisma_access.event.request.context
      ignore_missing: true
  - append:
      field: http.response.mime_type
      tag: append_http_response_mime_type_from_event_request_context
      value: "{{{prisma_access.event.request.context}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.request?.context != null
  - rename:
      field: cef.extensions.requestMethod
      tag: rename_extension_requestMethod
      target_field: prisma_access.event.request.method
      ignore_missing: true
  - set:
      field: http.request.method
      tag: set_http_request_method_from_event_request_method
      copy_from: prisma_access.event.request.method
      ignore_empty_value: true
  - rename:
      field: cef.extensions.requestUrl
      tag: rename_extension_requestUrl
      target_field: prisma_access.event.request.url
      ignore_missing: true
  - uri_parts:
      field: prisma_access.event.request.url
      if: ctx.prisma_access?.event?.request?.url != null && ctx.prisma_access.event.request.url != ''
      tag: uri_parts_processor
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - set:
      field: url.full
      tag: set_http_request_url_from_event_request_url
      copy_from: prisma_access.event.request.url
      ignore_empty_value: true
  - convert:
      field: cef.extensions.PanOSRootCNLength
      tag: convert_extension_PanOSRootCNLength_to_long
      target_field: prisma_access.event.root.cn_length
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSRootCommonName
      tag: rename_extension_PanOSRootCommonName
      target_field: prisma_access.event.root.common_name
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSRootStatus
      tag: rename_extension_PanOSRootStatus
      target_field: prisma_access.event.root.status
      ignore_missing: true
  - date:
      field: cef.extensions.deviceReceiptTime
      tag: date_extension__rt
      target_field: prisma_access.event.device.receipt_time
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.deviceReceiptTime != null && ctx.cef.extensions.deviceReceiptTime != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: event.created
      tag: set_event_created_from_event_device_receipt_time
      copy_from: prisma_access.event.device.receipt_time
      ignore_empty_value: true
  - rename:
      field: cef.extensions.deviceCustomString1
      tag: rename_extension_deviceCustomString1
      target_field: prisma_access.event.rule.value
      if: ctx.cef?.device?.event_class_id != null && ['DECRYPTION','FILE','SCTP','THREAT','TRAFFIC','TUNNEL','URL'].contains(ctx.cef.device.event_class_id) || (ctx.cef?.extensions != null && ['url','file'].contains(ctx.cef.extensions.Name))
      ignore_missing: true
  - set:
      field: rule.name
      tag: set_rule_name_from_event_rule_value
      copy_from: prisma_access.event.rule.value
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSRuleMatched
      tag: rename_extension_PanOSRuleMatched
      target_field: prisma_access.event.rule.matched
      ignore_missing: true
  - set:
      field: rule.name
      tag: set_rule_name_from_event_rule_matched
      copy_from: prisma_access.event.rule.matched
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSRuleMatchedUUID
      tag: rename_extension_PanOSRuleMatchedUUID
      target_field: prisma_access.event.rule.matched_uuid
      ignore_missing: true
  - append:
      field: rule.uuid
      tag: append_rule_uuid_from_event_rule_matched_uuid
      value: "{{{prisma_access.event.rule.matched_uuid}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.rule?.matched_uuid != null
  - rename:
      field: cef.extensions.PanOSRuleUUID
      tag: rename_extension_PanOSRuleUUID
      target_field: prisma_access.event.rule.uuid
      ignore_missing: true
  - append:
      field: rule.uuid
      tag: append_rule_uuid_from_event_rule_uuid
      value: "{{{prisma_access.event.rule.uuid}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.rule?.uuid != null
  - convert:
      field: cef.extensions.PanOSSanctionedStateofApp
      tag: convert_extension_PanOSSanctionedStateofApp_to_boolean
      target_field: prisma_access.event.sanctioned_state_of_app
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSSanctionedStateOfApp
      tag: convert_extension_PanOSSanctionedStateOfApp_to_boolean
      target_field: prisma_access.event.sanctioned_state_of_app
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSSccpCallingGt
      tag: rename_extension_PanOSSccpCallingGt
      target_field: prisma_access.event.sccp_calling.gt
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSSccpCallingSSN
      tag: convert_extension_PanOSSccpCallingSSN_to_long
      target_field: prisma_access.event.sccp_calling.ssn
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSSctpCauseCode
      tag: rename_extension_PanOSSctpCauseCode
      target_field: prisma_access.event.sctp.cause_code
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSctpChunkType
      tag: rename_extension_PanOSSctpChunkType
      target_field: prisma_access.event.sctp.chunk_type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSCTPEventType
      tag: rename_extension_PanOSSCTPEventType
      target_field: prisma_access.event.sctp.event_type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSctpFilter
      tag: rename_extension_PanOSSctpFilter
      target_field: prisma_access.event.sctp.filter
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSDWANCluster
      tag: rename_extension_PanOSSDWANCluster
      target_field: prisma_access.event.sdwan.cluster.name
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSDWANClusterType
      tag: rename_extension_PanOSSDWANClusterType
      target_field: prisma_access.event.sdwan.cluster.type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSDWANDeviceType
      tag: rename_extension_PanOSSDWANDeviceType
      target_field: prisma_access.event.sdwan.device_type
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSSDWANFECRatio
      tag: convert_extension_PanOSSDWANFECRatio_to_double
      target_field: prisma_access.event.sdwan.fec_ratio
      type: double
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSSDWANPolicyName
      tag: rename_extension_PanOSSDWANPolicyName
      target_field: prisma_access.event.sdwan.policy_name
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSDWANSite
      tag: rename_extension_PanOSSDWANSite
      target_field: prisma_access.event.sdwan.site
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSenderEmail
      tag: rename_extension_PanOSSenderEmail
      target_field: prisma_access.event.sender_email
      ignore_missing: true
  - set:
      field: threat.indicator.email.address
      tag: set_threat_indicator_email_address_from_event_sender_email
      copy_from: prisma_access.event.sender_email
      ignore_empty_value: true
  - append:
      field: email.from.address
      tag: append_email_from_address_from_event_sender_email
      value: "{{{prisma_access.event.sender_email}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.sender_email != null
  - append:
      field: related.user
      tag: append_event_sender_email_into_related_user
      value: "{{{prisma_access.event.sender_email}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.sender_email != null
  - convert:
      field: cef.extensions.PanOSSequenceNo
      tag: convert_extension_PanOSSequenceNo_to_string
      target_field: prisma_access.event.sequence_no
      type: string
      ignore_missing: true
  - set:
      field: event.id
      tag: set_event_id_from_event_sequence_no
      copy_from: prisma_access.event.sequence_no
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSServerNameIndication
      tag: rename_extension_PanOSServerNameIndication
      target_field: prisma_access.event.server.name_indication
      ignore_missing: true
  - set:
      field: tls.client.server_name
      tag: set_tls_client_server_name_from_event_server_name_indication
      copy_from: prisma_access.event.server.name_indication
      ignore_empty_value: true
  - append:
      field: related.hosts
      tag: append_event_server_name_indication_into_related_hosts
      value: "{{{prisma_access.event.server.name_indication}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.server?.name_indication != null
  - rename:
      field: cef.extensions.PanOSServerPerformance
      tag: rename_extension_PanOSServerPerformance
      target_field: prisma_access.event.server.perfomance
      ignore_missing: true
  - convert:
      field: cef.extensions.deviceCustomNumber3
      tag: convert_extension_deviceCustomNumber3_to_long
      target_field: prisma_access.event.session.duration
      type: long
      if: ctx.cef?.device?.event_class_id != null && ['TRAFFIC','TUNNEL'].contains(ctx.cef.device.event_class_id)
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: event.duration
      tag: set_event_duration_from_event_session_duration
      copy_from: prisma_access.event.session.duration
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSSessionEndReason
      tag: rename_extension_PanOSSessionEndReason
      target_field: prisma_access.event.session.end_reason
      ignore_missing: true
  - convert:
      field: cef.extensions.deviceCustomNumber1
      tag: convert_extension_deviceCustomNumber1_to_string
      target_field: prisma_access.event.session.id
      type: string
      if: ctx.cef?.device?.event_class_id != null && ['DECRYPTION','FILE','SCTP','THREAT','TRAFFIC','TUNNEL','URL'].contains(ctx.cef.device.event_class_id) || (ctx.cef?.extensions != null && ['url','file'].contains(ctx.cef.extensions.Name))
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSessionID
      tag: rename_extension_PanOSSessionID
      target_field: prisma_access.event.session.id
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSSessionOwnerMidx
      tag: convert_extension_PanOSSessionOwnerMidx_to_boolean
      target_field: prisma_access.event.session.owner_midx
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - date:
      field: cef.extensions.PanOSSessionStartTime
      tag: date_extension_PanOSSessionStartTime
      target_field: prisma_access.event.session.start_time
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSSessionStartTime != null && ctx.cef.extensions.PanOSSessionStartTime != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: event.start
      tag: set_event_start_from_event_session_start_time
      copy_from: prisma_access.event.session.start_time
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSSessionTracker
      tag: rename_extension_PanOSSessionTracker
      target_field: prisma_access.event.session.tracker
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSeverity
      tag: rename_extension_PanOSSeverity
      target_field: prisma_access.event.severity
      ignore_missing: true
  - set:
      field: log.level
      tag: set_log_level_from_event_severity
      copy_from: prisma_access.event.severity
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSSigFlags
      tag: rename_extension_PanOSSigFlags
      target_field: prisma_access.event.sig_flags
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSSNILength
      tag: convert_extension_PanOSSNILength_to_long
      target_field: prisma_access.event.sni_length
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSSource
      tag: rename_extension_PanOSSource
      target_field: prisma_access.event.source.value
      ignore_missing: true
  - convert:
      field: cef.extensions.sourceAddress
      tag: convert_extension_sourceAddress_to_ip
      target_field: prisma_access.event.source.address.value
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.sourceAddress != null && ctx.cef.extensions.sourceAddress != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: source.ip
      tag: append_prisma_access_event_source_address_into_source_ip
      value: "{{{prisma_access.event.source.address.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.address?.value != null && ctx.cef?.device?.event_class_id != null && !(['GLOBALPROTECT'].contains(ctx.cef.device.event_class_id))
  - append:
      field: source.nat.ip
      tag: append_prisma_access_event_source_address_value_into_source_nat_ip
      value: "{{{prisma_access.event.source.address.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.address?.value != null && ctx.cef?.device?.event_class_id != null && ['GLOBALPROTECT'].contains(ctx.cef.device.event_class_id)
  - append:
      field: related.ip
      tag: append_event_source_address_into_related_ip
      value: "{{{prisma_access.event.source.address.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.address?.value != null
  - rename:
      field: cef.extensions.PanOSSourceDeviceCategory
      tag: rename_extension_PanOSSourceDeviceCategory
      target_field: prisma_access.event.source.device.category
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSourceDeviceClass
      tag: rename_extension_PanOSSourceDeviceClass
      target_field: prisma_access.event.source.device.class
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSourceDeviceHost
      tag: rename_extension_PanOSSourceDeviceHost
      target_field: prisma_access.event.source.device.host
      ignore_missing: true
  - append:
      field: source.domain
      tag: append_prisma_access_event_source_device_host_into_source_domain
      value: "{{{prisma_access.event.source.device.host}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.device?.host != null
  - append:
      field: related.hosts
      tag: append_event_source_device_host_into_related_hosts
      value: "{{{prisma_access.event.source.device.host}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.device?.host != null
  - rename:
      field: cef.extensions.PanOSSourceDeviceMac
      tag: rename_extension_PanOSSourceDeviceMac
      target_field: prisma_access.event.source.device.mac
      ignore_missing: true
  - set:
      field: source.mac
      tag: set_source_mac_from_event_source_device_mac
      copy_from: prisma_access.event.source.device.mac
      ignore_empty_value: true
  - gsub:
      field: source.mac
      tag: gsub_source_mac
      pattern: '(..)(?!$)'
      replacement: '$1-'
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - uppercase:
      field: source.mac
      tag: uppercase_source_mac
      ignore_missing: true
      if: ctx.source?.mac != ''
      on_failure:
        - append:
            field: error.message
            value: 'Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}'
  - rename:
      field: cef.extensions.PanOSSourceDeviceModel
      tag: rename_extension_PanOSSourceDeviceModel
      target_field: prisma_access.event.source.device.model
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSourceDeviceOS
      tag: rename_extension_PanOSSourceDeviceOS
      target_field: prisma_access.event.source.device.os.type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSourceDeviceOSFamily
      tag: rename_extension_PanOSSourceDeviceOSFamily
      target_field: prisma_access.event.source.device.os.family
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSourceDeviceOSVersion
      tag: rename_extension_PanOSSourceDeviceOSVersion
      target_field: prisma_access.event.source.device.os.version
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSourceDeviceProfile
      tag: rename_extension_PanOSSourceDeviceProfile
      target_field: prisma_access.event.source.device.profile
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSourceDeviceVendor
      tag: rename_extension_PanOSSourceDeviceVendor
      target_field: prisma_access.event.source.device.vendor
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSourceDynamicAddressGroup
      tag: rename_extension_PanOSSourceDynamicAddressGroup
      target_field: prisma_access.event.source.dynamic_address_group
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSourceEDL
      tag: rename_extension_PanOSSourceEDL
      target_field: prisma_access.event.source.edl
      ignore_missing: true
  - rename:
      field: cef.extensions.sourceHostName
      tag: rename_extension_sourceHostName
      target_field: prisma_access.event.source.host_name
      ignore_missing: true
  - append:
      field: source.domain
      tag: append_prisma_access_event_source_host_name_into_source_domain
      value: "{{{prisma_access.event.source.host_name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.host_name != null && ctx.cef?.device?.event_class_id == 'GLOBALPROTECT'
  - append:
      field: host.name
      tag: append_prisma_access_event_source_host_name_into_host_name
      value: "{{{prisma_access.event.source.host_name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.host_name != null && ctx.cef?.device?.event_class_id == 'HIPMATCH'
  - append:
      field: related.hosts
      tag: append_event_source_host_name_into_related_hosts
      value: "{{{prisma_access.event.source.host_name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.host_name != null
  - rename:
      field: cef.extensions.PanOSSourceLocation
      tag: rename_extension_PanOSSourceLocation
      target_field: prisma_access.event.source.location
      ignore_missing: true
  - rename:
      field: cef.extensions.sourceNtDomain
      tag: rename_extension_sourceNtDomain
      target_field: prisma_access.event.source.nt_domain
      ignore_missing: true
  - append:
      field: source.user.domain
      tag: append_prisma_access_event_source_nt_domain_into_source_user_domain
      value: "{{{prisma_access.event.source.nt_domain}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.nt_domain != null
  - convert:
      field: cef.extensions.sourcePort
      tag: convert_extension_sourcePort_to_long
      target_field: prisma_access.event.source.port
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: source.port
      tag: set_source_port_from_event_source_port
      copy_from: prisma_access.event.source.port
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSSourceRegion
      tag: rename_extension_PanOSSourceRegion
      target_field: prisma_access.event.source.region
      ignore_missing: true
  - rename:
      field: cef.extensions.sourceServiceName
      tag: rename_extension_sourceServiceName
      target_field: prisma_access.event.source.service_name
      ignore_missing: true
  - convert:
      field: cef.extensions.sourceTranslatedAddress
      tag: convert_extension_sourceTranslatedAddress_to_ip
      target_field: prisma_access.event.source.translated.address
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.sourceTranslatedAddress != null && ctx.cef.extensions.sourceTranslatedAddress != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: source.nat.ip
      tag: set_source_nat_ip_from_event_source_translated_address
      copy_from: prisma_access.event.source.translated.address
      ignore_empty_value: true
  - append:
      field: related.ip
      tag: append_event_source_translated_address_into_related_ip
      value: "{{{prisma_access.event.source.translated.address}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.translated?.address != null
  - convert:
      field: cef.extensions.sourceTranslatedPort
      tag: convert_extension_sourceTranslatedPort_to_long
      target_field: prisma_access.event.source.translated.port
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: source.nat.port
      tag: set_source_nat_port_from_event_source_translated_port
      copy_from: prisma_access.event.source.translated.port
      ignore_empty_value: true
  - grok:
      field: cef.extensions.PanOSSourceUser
      tag: grok_PanOSSourceUser
      if: ctx.cef?.extensions?.PanOSSourceUser != null && ctx.cef?.extensions?.PanOSSourceUser.contains("\\")
      patterns:
        - (?<prisma_access.event.pan_os_value.source.user.domain>[^\\]*)[\\]*(?<prisma_access.event.pan_os_value.source.user.name>[^\\]*)
      on_failure:
        - rename:
            field: cef.extensions.PanOSSourceUser
            tag: rename_extension_PanOSSourceUser_if_grok_fails
            target_field: prisma_access.event.pan_os_value.source.user.name
            ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSourceUser
      tag: rename_extensions_PanOSSourceUser
      if: ctx.cef?.extensions?.PanOSSourceUser != null && !(ctx.cef?.extensions?.PanOSSourceUser.contains("\\"))
      target_field: prisma_access.event.pan_os_value.source.user.name
      ignore_missing: true
  - append:
      field: source.user.domain
      tag: append_prisma_access_event_pan_os_value_source_user_domain_into_destination_user_domain
      value: "{{{prisma_access.event.pan_os_value.source.user.domain}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os_value?.source?.user?.domain != null
  - append:
      field: source.user.name
      tag: append_prisma_access_event_pan_os_value_source_user_name_into_destination_user_name
      value: "{{{prisma_access.event.pan_os_value.source.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os_value?.source?.user?.name != null
  - append:
      field: related.user
      tag: append_event_destination_user_name_into_related_user
      value: "{{{prisma_access.event.pan_os_value.source.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os_value?.source?.user?.name != null
  - rename:
      field: cef.extensions.PanOSSourceUserDomain
      tag: rename_extension_PanOSSourceUserDomain
      target_field: prisma_access.event.pan_os.source.user.domain
      ignore_missing: true
  - append:
      field: source.user.domain
      tag: append_prisma_access_event_source_user_domain_into_source_user_domain
      value: "{{{prisma_access.event.pan_os.source.user.domain}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os?.source?.user?.domain != null
  - rename:
      field: cef.extensions.sourceUserId
      tag: rename_extension_sourceUserId
      target_field: prisma_access.event.source.user.id
      ignore_missing: true
  - append:
      field: source.user.id
      tag: append_prisma_access_event_source_user_id_into_source_user_id
      value: "{{{prisma_access.event.source.user.id}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.user?.id != null
  - append:
      field: related.user
      tag: append_event_source_user_id_into_related_user
      value: "{{{prisma_access.event.source.user.id}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.user?.id != null
  - grok:
      field: cef.extensions.PanOSSourceUserName
      tag: grok_PanOSSourceUserName
      if: ctx.cef?.extensions?.PanOSSourceUserName != null && ctx.cef?.extensions?.PanOSSourceUserName.contains("\\")
      patterns:
        - (?<prisma_access.event.pan_os_data.source.user.domain>[^\\]*)[\\]*(?<prisma_access.event.pan_os_data.source.user.name>[^\\]*)
      on_failure:
        - rename:
            field: cef.extensions.PanOSSourceUserName
            tag: rename_extension_PanOSSourceUserName_if_grok_fails
            target_field: prisma_access.event.pan_os_data.source.user.name
            ignore_missing: true
  - rename:
      field: cef.extensions.PanOSSourceUserName
      tag: rename_extension_PanOSSourceUserName
      if: ctx.cef?.extensions?.PanOSSourceUserName != null && !(ctx.cef?.extensions?.PanOSSourceUserName.contains("\\"))
      target_field: prisma_access.event.pan_os_data.source.user.name
      ignore_missing: true
  - append:
      field: source.user.domain
      tag: append_prisma_access_event_pan_os_data_source_user_domain_into_source_user_domain
      value: "{{{prisma_access.event.pan_os_data.source.user.domain}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os_data?.source?.user?.domain != null
  - append:
      field: source.user.name
      tag: append_prisma_access_event_pan_os_data_source_user_name_into_source_user_name
      value: "{{{prisma_access.event.pan_os_data.source.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os_data?.source?.user?.name != null
  - append:
      field: related.user
      tag: append_event_source_user_name_into_related_user
      value: "{{{prisma_access.event.pan_os_data.source.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.pan_os_data?.source?.user?.name != null
  - rename:
      field: cef.extensions.suser0
      tag: rename_extension_suser0
      target_field: prisma_access.event.s_user_0
      ignore_missing: true
  - rename:
      field: cef.extensions.duser0
      tag: rename_extension_duser0
      target_field: prisma_access.event.d_user_0
      ignore_missing: true
  - grok:
      field: cef.extensions.sourceUserName
      tag: grok_sourceUserName
      if: ctx.cef?.extensions?.sourceUserName != null && ctx.cef.extensions.sourceUserName.contains("\\")
      patterns:
        - (?<prisma_access.event.source.user.domain>[^\\]*)[\\]*(?<prisma_access.event.source.user.name>[^\\]*)
      on_failure:
        - rename:
            field: cef.extensions.sourceUserName
            tag: rename_extension_sourceUserName_if_grok_fails
            target_field: prisma_access.event.source.user.name
            ignore_missing: true
  - rename:
      field: cef.extensions.sourceUserName
      tag: rename_extension_sourceUserName
      if: ctx.cef?.extensions?.sourceUserName != null && !(ctx.cef?.extensions?.sourceUserName?.contains("\\"))
      target_field: prisma_access.event.source.user.name
      ignore_missing: true
  - append:
      field: source.user.domain
      tag: append_prisma_access_event_source_user_domain_into_source_user_domain
      value: "{{{prisma_access.event.source.user.domain}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.user?.domain != null
  - append:
      field: source.user.name
      tag: append_prisma_access_event_source_user_name_into_source_user_name
      value: "{{{prisma_access.event.source.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.user?.name != null
  - append:
      field: related.user
      tag: append_event_source_user_name_into_related_user
      value: "{{{prisma_access.event.source.user.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.user?.name != null
  - rename:
      field: cef.extensions.PanOSSourceUserUUID
      tag: rename_extension_PanOSSourceUserUUID
      target_field: prisma_access.event.source.user.uuid
      ignore_missing: true
  - append:
      field: source.user.id
      tag: append_prisma_access_event_source_user_uuid_into_source_user_id
      value: "{{{prisma_access.event.source.user.uuid}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.user?.uuid != null
  - append:
      field: related.user
      tag: append_event_source_user_uuid_into_related_user
      value: "{{{prisma_access.event.source.user.uuid}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.user?.uuid != null
  - rename:
      field: cef.extensions.PanOSSourceUUID
      tag: rename_extension_PanOSSourceUUID
      target_field: prisma_access.event.source.uuid
      ignore_missing: true
  - append:
      field: related.hosts
      tag: append_event_source_uuid_into_related_hosts
      value: "{{{prisma_access.event.source.uuid}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.source?.uuid != null
  - convert:
      field: cef.extensions.PanOSSplitTunnelconfiguration
      tag: convert_extension_PanOSSplitTunnelconfiguration_to_boolean
      target_field: prisma_access.event.split_tunnel_configuration
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSSSLFailureReason
      tag: rename_extension_PanOSSSLFailureReason
      target_field: prisma_access.event.ssl.failure_reason
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSSSLResponseTime
      tag: convert_extension_PanOSSSLResponseTime_to_long
      target_field: prisma_access.event.ssl.response_time
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSStage
      tag: rename_extension_PanOSStage
      target_field: prisma_access.event.stage
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSStandardPortsOfApp
      tag: convert_extension_PanOSStandardPortsOfApp_to_long
      target_field: prisma_access.event.standard_ports_of_app
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - date:
      field: cef.extensions.startTime
      tag: date_extension_startTime
      target_field: prisma_access.event.start_time
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.startTime != null && ctx.cef.extensions.startTime != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: "@timestamp"
      tag: set_timestamp_from_event_start_time
      copy_from: prisma_access.event.start_time
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSStreamID
      tag: rename_extension_PanOSStreamID
      target_field: prisma_access.event.stream_id
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTag
      tag: rename_extension_PanOSTag
      target_field: prisma_access.event.tag.value
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTagName
      tag: rename_extension_PanOSTagName
      target_field: prisma_access.event.tag.name
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTemplate
      tag: rename_extension_PanOSTemplate
      target_field: prisma_access.event.template
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTenantID
      tag: rename_extension_PanOSTenantID
      target_field: prisma_access.event.tenant_id
      ignore_missing: true
  - append:
      field: cloud.account.id
      tag: append_cloud_account_id_from_event_tenant_id
      value: "{{{prisma_access.event.tenant_id}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.tenant_id != null
  - rename:
      field: cef.extensions.PanOSThreatCategory
      tag: rename_extension_PanOSThreatCategory
      target_field: prisma_access.event.threat.category
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSThreatID
      tag: rename_extension_PanOSThreatID
      target_field: prisma_access.event.threat.id
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSThreatNameFirewall
      tag: rename_extension_PanOSThreatNameFirewall
      target_field: prisma_access.event.threat.name_firewall
      ignore_missing: true
  - date:
      field: cef.extensions.PanOSTimeGeneratedHighResolution
      tag: date_extension_PanOSTimeGeneratedHighResolution
      target_field: prisma_access.event.time.generated_high_resolution
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSTimeGeneratedHighResolution != null && ctx.cef.extensions.PanOSTimeGeneratedHighResolution != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - date:
      field: cef.extensions.PanOSTimeNotAfter
      tag: date_extension_PanOSTimeNotAfter
      target_field: prisma_access.event.time.not_after
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSTimeNotAfter != null && ctx.cef.extensions.PanOSTimeNotAfter != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: tls.client.x509.not_after
      tag: set_tls_client_x509_not_after_from_event_time_not_after
      copy_from: prisma_access.event.time.not_after
      ignore_empty_value: true
  - date:
      field: cef.extensions.PanOSTimeNotBefore
      tag: date_extension_PanOSTimeNotBefore
      target_field: prisma_access.event.time.not_before
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSTimeNotBefore != null && ctx.cef.extensions.PanOSTimeNotBefore != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: tls.client.x509.not_before
      tag: set_tls_client_x509_not_before_from_event_time_not_before
      copy_from: prisma_access.event.time.not_before
      ignore_empty_value: true
  - date:
      field: cef.extensions.PanOSTimeReceivedManagementPlane
      tag: date_extension_PanOSTimeReceivedManagementPlane
      target_field: prisma_access.event.time.received_management_plane
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSTimeReceivedManagementPlane != null && ctx.cef.extensions.PanOSTimeReceivedManagementPlane != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - date:
      field: cef.extensions.PanOSTimestampDeviceIdentification
      tag: date_extension_PanOSTimestampDeviceIdentification
      target_field: prisma_access.event.timestamp_device_identification
      formats:
        - "MMM dd yyyy HH:mm:ss"
        - ISO8601
      if: ctx.cef?.extensions?.PanOSTimestampDeviceIdentification != null && ctx.cef.extensions.PanOSTimestampDeviceIdentification != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSTLSAuth
      tag: rename_extension_PanOSTLSAuth
      target_field: prisma_access.event.tls.auth
      ignore_missing: true
  - set:
      field: tls.client.x509.signature_algorithm
      tag: set_tls_client_x509_signature_algorithm_from_event_tls_auth
      copy_from: prisma_access.event.tls.auth
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSTLSEncryptionAlgorithm
      tag: rename_extension_PanOSTLSEncryptionAlgorithm
      target_field: prisma_access.event.tls.encryption_algorithm
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTLSKeyExchange
      tag: rename_extension_PanOSTLSKeyExchange
      target_field: prisma_access.event.tls.key_exchange
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTLSVersion
      tag: rename_extension_PanOSTLSVersion
      target_field: prisma_access.event.tls.version
      ignore_missing: true
  - set:
      field: tls.version
      tag: set_tls_version_from_event_tls_version
      copy_from: prisma_access.event.tls.version
      ignore_empty_value: true
  - rename:
      field: cef.extensions.deviceCustomString5
      tag: rename_extension_deviceCustomString5
      target_field: prisma_access.event.to_zone
      if: ctx.cef?.device?.event_class_id != null && ['DECRYPTION','FILE','SCTP','THREAT','TRAFFIC','TUNNEL','URL'].contains(ctx.cef.device.event_class_id) || (ctx.cef?.extensions != null && ['url','file'].contains(ctx.cef.extensions.Name))
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSTotalDiskSpace
      tag: convert_extension_PanOSTotalDiskSpace_to_double
      target_field: prisma_access.event.total.disk_space
      type: double
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSTotalDiskSpace != null && ctx.cef.extensions.PanOSTotalDiskSpace != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.PanOSTotalMemory
      tag: convert_extension_PanOSTotalMemory_to_long
      target_field: prisma_access.event.total.memory
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.deviceCustomNumber3
      tag: convert_extension_deviceCustomNumber3_to_long
      target_field: prisma_access.event.total.time_elapsed
      type: long
      if: ctx.cef?.device?.event_class_id == 'DNS SECURITY'
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: event.duration
      tag: set_event_duration_from_event_total_time_elapsed
      copy_from: prisma_access.event.total.time_elapsed
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSTpadding
      tag: rename_extension_PanOSTpadding
      target_field: prisma_access.event.tpadding
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString2
      tag: rename_extension_deviceCustomString2
      target_field: prisma_access.event.tunnel.value
      if: ctx.cef?.device?.event_class_id == 'TUNNEL'
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTunnel
      tag: rename_extension_PanOSTunnel
      target_field: prisma_access.event.tunnel.value
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTunnelCauseCode
      tag: rename_extension_PanOSTunnelCauseCode
      target_field: prisma_access.event.tunnel.cause_code
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTunnelEndpointID1
      tag: rename_extension_PanOSTunnelEndpointID1
      target_field: prisma_access.event.tunnel.endpoint.id1
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTunnelEndpointID2
      tag: rename_extension_PanOSTunnelEndpointID2
      target_field: prisma_access.event.tunnel.endpoint.id2
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTunnelEventCode
      tag: rename_extension_PanOSTunnelEventCode
      target_field: prisma_access.event.tunnel.event.code
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTunnelEventType
      tag: rename_extension_PanOSTunnelEventType
      target_field: prisma_access.event.tunnel.event.type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTunnelInspectionRule
      tag: rename_extension_PanOSTunnelInspectionRule
      target_field: prisma_access.event.tunnel.inspection_rule
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTunnelInterface
      tag: rename_extension_PanOSTunnelInterface
      target_field: prisma_access.event.tunnel.interface
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTunnelMessageType
      tag: rename_extension_PanOSTunnelMessageType
      target_field: prisma_access.event.tunnel.message_type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTunnelRemoteIMSIID
      tag: rename_extension_PanOSTunnelRemoteIMSIID
      target_field: prisma_access.event.tunnel.remote.imsi_id
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSTunnelRemoteUserIP
      tag: convert_extension_PanOSTunnelRemoteUserIP_to_ip
      target_field: prisma_access.event.tunnel.remote.user_ip
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSTunnelRemoteUserIP != null && ctx.cef.extensions.PanOSTunnelRemoteUserIP != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: related.ip
      tag: append_event_tunnel_remote_user_ip_into_related_ip
      value: "{{{prisma_access.event.tunnel.remote.user_ip}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.tunnel?.remote?.user_ip != null
  - convert:
      field: cef.extensions.PanOSTunnelRename
      tag: convert_extension_PanOSTunnelRename_to_boolean
      target_field: prisma_access.event.tunnel.rename
      type: boolean
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.deviceCustomFloatingPoint1
      tag: convert_extension_deviceCustomFloatingPoint1_to_double
      target_field: prisma_access.event.packets.dropped.protocol
      type: double
      ignore_missing: true
      if: ctx.cef?.extensions?.deviceCustomFloatingPoint1 != null && ctx.cef.extensions.deviceCustomFloatingPoint1 != '' && ctx.cef?.device?.event_class_id != null && ['TUNNEL'].contains(ctx.cef.device.event_class_id)
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.deviceCustomFloatingPoint2
      tag: convert_extension_deviceCustomFloatingPoint2_to_double
      target_field: prisma_access.event.packets.dropped.strict
      type: double
      ignore_missing: true
      if: ctx.cef?.extensions?.deviceCustomFloatingPoint2 != null && ctx.cef.extensions.deviceCustomFloatingPoint2 != '' && ctx.cef?.device?.event_class_id != null && ['TUNNEL'].contains(ctx.cef.device.event_class_id)
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.deviceCustomFloatingPoint4
      tag: convert_extension_deviceCustomFloatingPoint4_to_double
      target_field: prisma_access.event.tunnel.sessions.closed
      type: double
      ignore_missing: true
      if: ctx.cef?.extensions?.deviceCustomFloatingPoint4 != null && ctx.cef.extensions.deviceCustomFloatingPoint4 != '' && ctx.cef?.device?.event_class_id != null && ['TUNNEL'].contains(ctx.cef.device.event_class_id)
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - convert:
      field: cef.extensions.deviceCustomFloatingPoint3
      tag: convert_extension_deviceCustomFloatingPoint3_to_double
      target_field: prisma_access.event.tunnel.sessions.created
      type: double
      ignore_missing: true
      if: ctx.cef?.extensions?.deviceCustomFloatingPoint3 != null && ctx.cef.extensions.deviceCustomFloatingPoint3 != '' && ctx.cef?.device?.event_class_id != null && ['TUNNEL'].contains(ctx.cef.device.event_class_id)
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSTunnelType
      tag: rename_extension_PanOSTunnelType
      target_field: prisma_access.event.tunnel.type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSTunneledApplication
      tag: rename_extension_PanOSTunneledApplication
      target_field: prisma_access.event.tunneled_application
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSType
      tag: rename_extension_PanOSType
      target_field: prisma_access.event.type
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSUGFlags
      tag: rename_extension_PanOSUGFlags
      target_field: prisma_access.event.ug_flags
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSURL
      tag: rename_extension_PanOSURL
      target_field: prisma_access.event.url.value
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString2
      tag: rename_extension_deviceCustomString2
      target_field: prisma_access.event.url.category.value
      if: ctx.cef?.device?.event_class_id != null && ['FILE','TRAFFIC','URL'].contains(ctx.cef.device.event_class_id) || (ctx.cef?.extensions != null && ['url','file'].contains(ctx.cef.extensions.Name))
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSURLCategory
      tag: rename_extension_PanOSURLCategory
      target_field: prisma_access.event.url.category.value
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSURLCategoryList
      tag: rename_extension_PanOSURLCategoryList
      target_field: prisma_access.event.url.category.list
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSURLCounter
      tag: convert_extension_PanOSURLCounter_to_long
      target_field: prisma_access.event.url.counter
      type: long
      ignore_missing: true
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - rename:
      field: cef.extensions.PanOSURLDomain
      tag: rename_extension_PanOSURLDomain
      target_field: prisma_access.event.url.domain
      ignore_missing: true
  - set:
      field: url.domain
      tag: set_url_domain_from_event_url_domain
      copy_from: prisma_access.event.url.domain
      ignore_empty_value: true
  - rename:
      field: cef.extensions.PanOSUserAgentString
      tag: rename_extension_PanOSUserAgentString
      target_field: prisma_access.event.user.agent_string
      ignore_missing: true
  - user_agent:
      field: prisma_access.event.user.agent_string
      tag: user_agent_original_from_user_agent_string
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSUserComment
      tag: rename_extension_PanOSUserComment
      target_field: prisma_access.event.user.comment
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSUserGroupFound
      tag: rename_extension_PanOSUserGroupFound
      target_field: prisma_access.event.user.group_found
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSUserIdentifiedBySource
      tag: rename_extension_PanOSUserIdentifiedBySource
      target_field: prisma_access.event.user.identified_by_source
      ignore_missing: true
  - append:
      field: related.user
      tag: append_event_user_identified_by_source_into_related_user
      value: "{{{prisma_access.event.user.identified_by_source}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.user?.identified_by_source != null
  - rename:
      field: cef.extensions.PanOSUsername
      tag: rename_extension_PanOSUsername
      target_field: prisma_access.event.username
      ignore_missing: true
  - set:
      field: user.name
      tag: set_user_name_from_event_username
      copy_from: prisma_access.event.username
      ignore_empty_value: true
  - append:
      field: related.user
      tag: append_event_username_into_related_user
      value: "{{{prisma_access.event.username}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.username != null
  - convert:
      field: cef.extensions.PanOSUsers
      tag: convert_extension_PanOSUsers_to_ip
      target_field: prisma_access.event.users.ip
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSUsers != null && ctx.cef.extensions.PanOSUsers != ''
      on_failure:
        - rename:
            field: cef.extensions.PanOSUsers
            tag: rename_extension_PanOSUsers
            target_field: prisma_access.event.users.name
            ignore_missing: true
  - append:
      field: related.user
      tag: append_event_users_into_related_user
      value: "{{{prisma_access.event.users.name}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.users?.name != null
  - rename:
      field: cef.extensions.PanOSUUID
      tag: rename_extension_PanOSUUID
      target_field: prisma_access.event.uuid
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSVDIEndpoint
      tag: convert_extension_PanOSVDIEndpoint_to_string
      target_field: prisma_access.event.vdi_endpoint
      type: string
      ignore_missing: true
  - set:
      field: host.type
      tag: set_host_type_to_vdi
      value: "virtual desktop infrastructure"
      ignore_empty_value: true
      if: ctx.prisma_access?.event?.vdi_endpoint != null && ctx.prisma_access.event.vdi_endpoint == "1"
  - rename:
      field: cef.extensions.PanOSVendorSeverity
      tag: rename_extension_PanOSVendorSeverity
      target_field: prisma_access.event.vendor_severity
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSVerdict
      tag: rename_extension_PanOSVerdict
      target_field: prisma_access.event.verdict
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSVerificationTag1
      tag: rename_extension_PanOSVerificationTag1
      target_field: prisma_access.event.verification.tag1
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSVerificationTag2
      tag: rename_extension_PanOSVerificationTag2
      target_field: prisma_access.event.verification.tag2
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString3
      tag: rename_extension_deviceCustomString3
      target_field: prisma_access.event.virtual.location
      if: ctx.cef?.device?.event_class_id != null && ['CONFIG','SYSTEM','AUTH','DECRYPTION','FILE','HIPMATCH','IPTAG','SCTP','THREAT','TRAFFIC','TUNNEL','URL','USERID'].contains(ctx.cef.device.event_class_id) || (ctx.cef?.extensions != null && ['url','file'].contains(ctx.cef.extensions.Name))
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString3Label
      tag: rename_extension_deviceCustomString3Label
      target_field: prisma_access.event.label.cs3
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSVirtualSystem
      tag: rename_extension_PanOSVirtualSystem
      target_field: prisma_access.event.virtual.system.value
      ignore_missing: true
  - convert:
      field: cef.extensions.deviceCustomNumber2
      tag: convert_extension_deviceCustomNumber2_to_string
      target_field: prisma_access.event.virtual.system.id
      type: string
      if: ctx.cef?.device?.event_class_id != null && ['HIPMATCH','IPTAG','USERID'].contains(ctx.cef.device.event_class_id)
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSVirtualSystemID
      tag: rename_extension_PanOSVirtualSystemID
      target_field: prisma_access.event.virtual.system.id
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSVirtualSystemName
      tag: rename_extension_PanOSVirtualSystemName
      target_field: prisma_access.event.virtual.system.name
      ignore_missing: true
  - rename:
      field: cef.extensions.PanOSVpadding
      tag: rename_extension_PanOSVpadding
      target_field: prisma_access.event.vpadding
      ignore_missing: true
  - rename:
      field: cef.extensions.deviceCustomString3
      tag: rename_extension_deviceCustomString3
      target_field: prisma_access.event.v.sys_name
      if: ctx.cef?.device?.event_class_id == 'GLOBALPROTECT'
      ignore_missing: true
  - convert:
      field: cef.extensions.PanOSXForwardedFor
      tag: convert_extension_PanOSXForwardedFor_to_ip
      target_field: prisma_access.event.x_forwarded_for.value
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSXForwardedFor != null && ctx.cef.extensions.PanOSXForwardedFor != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: network.forwarded_ip
      tag: set_network_forwarded_ip_from_event_x_forwarded_for
      copy_from: prisma_access.event.x_forwarded_for.value
      ignore_empty_value: true
  - append:
      field: related.ip
      tag: append_event_x_forwarded_for_into_related_ip
      value: "{{{prisma_access.event.x_forwarded_for.value}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.x_forwarded_for?.value != null
  - convert:
      field: cef.extensions.PanOSXForwardedForIP
      tag: convert_extension_PanOSXForwardedForIP_to_ip
      target_field: prisma_access.event.x_forwarded_for.ip
      type: ip
      ignore_missing: true
      if: ctx.cef?.extensions?.PanOSXForwardedForIP != null && ctx.cef.extensions.PanOSXForwardedForIP != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - append:
      field: related.ip
      tag: append_event_x_forwarded_for_ip_into_related_ip
      value: "{{{prisma_access.event.x_forwarded_for.ip}}}"
      allow_duplicates: false
      if: ctx.prisma_access?.event?.x_forwarded_for?.ip != null
  - rename:
      field: cef.extensions.Vendor Severity
      tag: rename_extension_Vendor_Severity
      target_field: prisma_access.event.vendor_severity
      ignore_missing: true
  - rename:
      field: cef.extensions.Name
      tag: rename_extension_Name
      target_field: prisma_access.event.name
      ignore_missing: true
  - rename:
      field: cef.extensions.Subtype
      tag: rename_extension_Subtype
      target_field: prisma_access.event.name
      ignore_missing: true
  - remove:
      field:
          - prisma_access.event.application.protocol
          - prisma_access.event.assocation_end_reason
          - prisma_access.event.authenticated.user.domain
          - prisma_access.event.authenticated.user.name
          - prisma_access.event.authenticated.user.uuid
          - prisma_access.event.bytes.total
          - prisma_access.event.bytes.in
          - prisma_access.event.bytes.out
          - prisma_access.event.certificate.serial
          - prisma_access.event.certificate.version
          - prisma_access.event.cloud.hostname
          - prisma_access.event.common.name.value
          - prisma_access.event.config_version
          - prisma_access.event.container.id
          - prisma_access.event.container.name.value
          - prisma_access.event.cortex_data_lake_tenant_id
          - prisma_access.event.debug_log_file
          - prisma_access.event.description
          - prisma_access.event.destination.address.value
          - prisma_access.event.destination.address.v6
          - prisma_access.event.destination.device.host
          - prisma_access.event.destination.device.mac
          - prisma_access.event.destination.device.vendor
          - prisma_access.event.destination.nt_domain
          - prisma_access.event.destination.port
          - prisma_access.event.destination.translated.address
          - prisma_access.event.destination.translated.port
          - prisma_access.event.pan_os_value.destination.user.domain
          - prisma_access.event.pan_os_value.destination.user.name
          - prisma_access.event.pan_os_data.destination.user.domain
          - prisma_access.event.pan_os_data.destination.user.name
          - prisma_access.event.pan_os.destination.user.domain
          - prisma_access.event.destination.user.domain
          - prisma_access.event.destination.user.id
          - prisma_access.event.destination.user.name
          - prisma_access.event.destination.user.uuid
          - prisma_access.event.device.action
          - prisma_access.event.device.sn
          - prisma_access.event.device.external_id
          - prisma_access.event.device.host_name
          - prisma_access.event.device.inbound_interface
          - prisma_access.event.device.name
          - prisma_access.event.device.outbound_interface
          - prisma_access.event.device.time_zone
          - prisma_access.event.device.vendor
          - prisma_access.event.diam.app_id
          - prisma_access.event.dns.response.value
          - prisma_access.event.dns.response.code
          - prisma_access.event.domain.value
          - prisma_access.event.dynamic_user_group.name
          - prisma_access.event.dynamic_user_group.value
          - prisma_access.event.elliptic_curve
          - prisma_access.event.email_subject
          - prisma_access.event.end_time
          - prisma_access.event.endpoint.cpu_architecture
          - prisma_access.event.endpoint.device.domain
          - prisma_access.event.endpoint.device.name
          - prisma_access.event.endpoint.ip_address
          - prisma_access.event.endpoint.os.type
          - prisma_access.event.endpoint.os.version
          - prisma_access.event.endpoint.sn
          - prisma_access.event.endpoint.user.domain
          - prisma_access.event.endpoint.user.name
          - prisma_access.event.endpoint.user.uuid
          - prisma_access.event.data.time
          - prisma_access.event.external_id
          - prisma_access.event.file.hash
          - prisma_access.event.file.name
          - prisma_access.event.fingerprint
          - prisma_access.event.gateway.address
          - prisma_access.event.http.method
          - prisma_access.event.inbound_interface.value
          - prisma_access.event.is_resume_session
          - prisma_access.event.log.source.timezone_offset
          - prisma_access.event.login_duration
          - prisma_access.event.message
          - prisma_access.event.nat.destination.port
          - prisma_access.event.nat.destination.value
          - prisma_access.event.nat.source.port
          - prisma_access.event.nat.source.value
          - prisma_access.event.packets.received
          - prisma_access.event.packets.sent
          - prisma_access.event.packets.total
          - prisma_access.event.private.ipv4
          - prisma_access.event.private.ipv6
          - prisma_access.event.public.ipv6
          - prisma_access.event.public.ipv4
          - prisma_access.event.transport_protocol
          - prisma_access.event.reason
          - prisma_access.event.recipient_email
          - prisma_access.event.referer
          - prisma_access.event.request.context
          - prisma_access.event.request.method
          - prisma_access.event.device.receipt_time
          - prisma_access.event.issuer.common_name
          - prisma_access.event.rule.value
          - prisma_access.event.rule.matched
          - prisma_access.event.rule.matched_uuid
          - prisma_access.event.rule.uuid
          - prisma_access.event.sender_email
          - prisma_access.event.sequence_no
          - prisma_access.event.server.name_indication
          - prisma_access.event.session.duration
          - prisma_access.event.session.start_time
          - prisma_access.event.severity
          - prisma_access.event.source.address.v6
          - prisma_access.event.source.device.host
          - prisma_access.event.source.device.mac
          - prisma_access.event.source.port
          - prisma_access.event.source.translated.address
          - prisma_access.event.source.translated.port
          - prisma_access.event.source.nt_domain
          - prisma_access.event.pan_os_value.source.user.domain
          - prisma_access.event.pan_os_value.source.user.name
          - prisma_access.event.pan_os_data.source.user.domain
          - prisma_access.event.pan_os_data.source.user.name
          - prisma_access.event.pan_os.source.user.domain
          - prisma_access.event.source.user.domain
          - prisma_access.event.source.user.id
          - prisma_access.event.source.user.name
          - prisma_access.event.source.user.uuid
          - prisma_access.event.start_time
          - prisma_access.event.tenant_id
          - prisma_access.event.time.not_after
          - prisma_access.event.time.not_before
          - prisma_access.event.tls.auth
          - prisma_access.event.tls.version
          - prisma_access.event.total.time_elapsed
          - prisma_access.event.username
          - prisma_access.event.url.domain
          - prisma_access.event.x_forwarded_for.value
          - prisma_access.event.request.url
          - prisma_access.event.global_protect.version
          - prisma_access.event.operating_system
          - prisma_access.event.source.address.value
      tag: remove_custom_duplicate_fields
      ignore_missing: true
      if: ctx.tags == null || !(ctx.tags.contains('preserve_duplicate_custom_fields'))
  - rename:
      field: cef.device.event_class_id
      tag: rename_device_event_class_id
      target_field: prisma_access.event.class_id
      ignore_missing: true
  - rename:
      field: cef.name
      tag: rename_cef_name
      target_field: prisma_access.event.cef.name
      ignore_missing: true
  - rename:
      field: cef.device.vendor
      tag: rename_cef_device_vendor
      target_field: prisma_access.event.cef.device.vendor
      ignore_missing: true
  - rename:
      field: cef.device.product
      tag: rename_cef_device_product
      target_field: prisma_access.event.cef.device.product
      ignore_missing: true
  - rename:
      field: cef.device.version
      tag: rename_cef_device_version
      target_field: prisma_access.event.cef.device.version
      ignore_missing: true
  - rename:
      field: cef.version
      tag: rename_cef_version
      target_field: prisma_access.event.cef.version
      ignore_missing: true
  - convert:
      field: cef.severity
      tag: convert_cef_severity
      target_field: prisma_access.event.cef.severity
      type: long
      ignore_missing: true
      if: ctx.cef?.severity != null && ctx.cef.severity != ''
      on_failure:
        - append:
            field: error.message
            value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - remove:
      field: cef
      tag: remove_cef
      ignore_missing: true
  - script:
      description: Drops null/empty values recursively.
      tag: script_to_drop_null_values
      lang: painless
      source: |-
        boolean drop(Object o) {
          if (o == null || o == '') {
            return true;
          } else if (o instanceof Map) {
            ((Map) o).values().removeIf(v -> drop(v));
            return (((Map) o).size() == 0);
          } else if (o instanceof List) {
            ((List) o).removeIf(v -> drop(v));
            return (((List) o).length == 0);
          }
          return false;
        }
        drop(ctx);
  - set:
      field: event.kind
      tag: set_pipeline_error
      value: pipeline_error
      if: ctx.error?.message != null
on_failure:
  - append:
      field: error.message
      value: "Processor {{{_ingest.on_failure_processor_type}}} with tag {{{_ingest.on_failure_processor_tag}}} in pipeline {{{_ingest.on_failure_pipeline}}} failed with message: {{{_ingest.on_failure_message}}}"
  - set:
      field: event.kind
      tag: set_pipeline_error_to_event_kind
      value: pipeline_error
  - append:
      field: tags
      value: preserve_original_event
      allow_duplicates: false
