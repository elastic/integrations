# Tenable OT Security 

The Elastic integration for [Tenable OT Security](https://www.sailpoint.com/products/identity-security-cloud) enables real-time monitoring and analysis of operational technology security events within industrial environments. This integration collects data from Tenable OT Security platform to provide visibility into cyber threats, malicious insider activities, and human errors.

## Data Streams

- **`assets`**: Assets represent the inventory of devices and systems monitored by Tenable OT Security, including their properties, classifications, and security posture.
- [Assets](https://docs.tenable.com/OT-security/4_1/Content/Inventory/ViewAssetDetails.htm) are records that a user took action in an [Tenable OT Security](https://ot.tenalab.online/)Assets.
- This data stream leverages the Tenable OT Security graphql API's `/graphql` endpoint to retrieve assets logs.

- **`events`**: Events are notifications generated by Tenable OT Security to alert on potentially harmful activities in the industrial network, categorized by severity and type.
- [Events](https://docs.tenable.com/OT-security/4_1/Content/Events/Events.htm) are records that a user took action in an [Tenable OT Security](https://ot.tenalab.online/)Events.
- This data stream leverages the Tenable OT Security graphql API's `/graphql` endpoint to retrieve event logs.

- **`system logs`**: SystemLogs data stream provides detailed records of events, activities, and changes occurring within the OT environment. These logs are critical for monitoring, auditing, and investigating security incidents. They capture data from various OT assets, such as PLCs (Programmable Logic Controllers), RTUs (Remote Terminal Units), HMIs (Human-Machine Interfaces), and other industrial devices.
- [System_Logs](https://docs.tenable.com/OT-security/4_1/Content/Events/Events.htm) are records that a user took action in an [Tenable OT Security](https://ot.tenalab.online/)Events.
- This data stream leverages the Tenable OT Security graphql API's `/graphql` endpoint to retrieve system logs.

## Requirements

### Access, setup and data
Login into Tenable's cloud platform to generate a unique set of API keys for each user account. These keys allow applications to authenticate to Tenable's API without creating a session.

Once you have created the Api key and you know its access key and secret key, you have everything you need to generate an access_token. You will need this access_token to authenticate your requests to the APIs.

For more details on generating an access token, please refer to the API documentation [here](https://developer.tenable.com/docs/ot-generate-an-api-key)

### Authentication
To authenticate to the Tenable OT Security APIs, generate an access token and include it in your requests as described below.
To create an API key in [Tenable OT Security](https://developer.tenable.com/docs/ot-generate-an-api-key), follow these steps::


### Steps to Generate an API Key

1. **Sign in** to **Tenable OT Security**.
2. In the left navigation pane, click `Local Settings`.
   - The `Local Settings` submenu expands.
3. In the `Local Settings` submenu, click `System Configuration`.
   - The `System Configuration` submenu expands.
4. In the `System Configuration` submenu, click `API Keys`.
   - The `API Keys` page appears along with a table of existing API keys.
5. On the `API Keys` page, in the top right corner, click the `Generate Key` button.
   - The `Generate Key` side pane appears.
6. In the `Expiration Period` area, choose the expiration period in days.
   - The maximum expiration period is **365 days**.
7. In the `Description` text box, enter a description explaining what the API key will be used for.
8. Click the `Generate` button.
   - The `Generate Key` side pane appears with the `API Key` and `API Secret`.
9. **Note:** The generated API key has the same permissions as the user that created it according to their role.
10. Use the `Copy` buttons to copy the API key and API secret.
    - Save them in a secure location for later use. The API key and API secret are shown only once.

## API Authorization

To authorize your application to use Tenable's API, you must include the `X-ApiKeys` header element in your HTTP request messages.

For more details on Authentication, check [here](https://developer.tenable.com/docs/authorization).

## Logs

### Assets

Assets documents can be found by setting the following filter: 
`event.dataset : "tenable_ot_security.assets"`

{{event "assets"}}

**ECS Field Reference**

Please refer to the following [document](https://www.elastic.co/guide/en/ecs/current/ecs-field-reference.html) for detailed information on ECS fields.

The following non-ECS fields are used in assets documents:

{{fields "assets"}}

### Events

Event documents can be found by setting the following filter: 
`event.dataset : "tenable_ot_security.events"`

{{event "events"}}

**ECS Field Reference**

Please refer to the following [document](https://www.elastic.co/guide/en/ecs/current/ecs-field-reference.html) for detailed information on ECS fields.

The following non-ECS fields are used in events documents:

{{fields "events"}}

### System Log

System Log documents can be found by setting the following filter: 
`event.dataset : "tenable_ot_security.system_log"`

{{event "system_log"}}

**ECS Field Reference**

Please refer to the following [document](https://www.elastic.co/guide/en/ecs/current/ecs-field-reference.html) for detailed information on ECS fields.

The following non-ECS fields are used in system log documents:

{{fields "system_log"}}