rules:
  - path: /graphql
    methods: ["POST"]
    request_headers:
      Content-Type: application/json
    request_body: '/"variables":\{"after":null,"first":3}/'
    responses:
      - status_code: 200
        body: |-
          {
            "data": {
              "assets": {
                "nodes": [
                  {
                    "id": "005b8e8e-335f-4ee5-8063-abe5d88b02d7",
                    "name": "Endpoint #514",
                    "firstSeen": "2024-06-25T17:23:13.736326Z",
                    "lastSeen": "2025-03-08T04:43:23.16816Z",
                    "lastHit": "2025-03-08T04:54:13.703412Z",
                    "lastSnapshot": null,
                    "macs": {
                      "nodes": []
                    },
                    "ips": {
                    "nodes": [
                        "81.2.69.192"
                    ]
                    },
                    "segments": {
                      "nodes": [
                        {
                          "id": "7b7ec4aa-4aa5-44fb-953c-d1969f1a0adf"
                        }
                      ]
                    },
                    "type": "Unknown",
                    "superType": "Unknown",
                    "category": "NetworkAssetsCategory",
                    "purdueLevel": "Level3",
                    "runStatus": "Unknown",
                    "runStatusTime": "0001-01-01T00:00:00Z",
                    "risk": {
                      "totalRisk": "27.54025368063704"
                    },
                    "criticality": "LowCriticality",
                    "hidden": false,
                    "lastUpdate": "2024-06-25T17:23:20.685557Z",
                    "directIps": {
                      "nodes": [
                        "10.150.82.141"
                      ]
                    },
                    "directMacs": {
                      "nodes": ["f8:75:a4:f5:c6:37"]
                    }
                  },
                  {
                    "id": "0071af37-29f3-451e-9f92-33278d96a2d3",
                    "name": "Endpoint #379",
                    "firstSeen": "2024-06-25T17:20:04.439195Z",
                    "lastSeen": "2025-03-08T04:40:19.450319Z",
                    "lastHit": null,
                    "lastSnapshot": null,
                    "macs": {
                      "nodes": []
                    },
                    "ips": {
                      "nodes": [
                        "172.26.34.85"
                      ]
                    },
                    "segments": {
                      "nodes": [
                        {
                          "id": "c2986e47-7535-4bf7-a63a-c000b260bc4b"
                        }
                      ]
                    },
                    "type": "Unknown",
                    "superType": "Unknown",
                    "category": "NetworkAssetsCategory",
                    "purdueLevel": "Level3",
                    "runStatus": "Unknown",
                    "runStatusTime": "0001-01-01T00:00:00Z",
                    "risk": {
                      "totalRisk": "27.54025368063704"
                    },
                    "criticality": "LowCriticality",
                    "hidden": false,
                    "lastUpdate": "2025-03-06T10:54:05.401668Z",
                    "directIps": {
                      "nodes": [
                        "172.26.34.85"
                      ]
                    },
                    "directMacs": {
                      "nodes": [
                        "00:50:56:10:0d:0a"
                      ]
                    }
                  },
                  {
                    "id": "0097fbb8-737c-4afb-a210-e230e8a521d3",
                    "name": "Endpoint #494",
                    "firstSeen": "2024-06-25T17:22:28.752508Z",
                    "lastSeen": "2025-03-08T04:42:37.253157Z",
                    "lastHit": "2025-03-08T01:09:13.855961Z",
                    "lastSnapshot": null,
                    "macs": {
                      "nodes": []
                    },
                    "ips": {
                      "nodes": [
                        "10.150.74.25"
                      ]
                    },
                    "segments": {
                      "nodes": [
                        {
                          "id": "5d7bee4a-a218-47da-b81c-33d5c3848034"
                        }
                      ]
                    },
                    "type": "Unknown",
                    "superType": "Unknown",
                    "category": "NetworkAssetsCategory",
                    "purdueLevel": "Level3",
                    "runStatus": "Unknown",
                    "runStatusTime": "0001-01-01T00:00:00Z",
                    "risk": {
                      "totalRisk": "27.54025368063704"
                    },
                    "criticality": "LowCriticality",
                    "hidden": false,
                    "lastUpdate": "2024-06-25T17:22:40.685712Z",
                    "directIps": {
                      "nodes": [
                        "10.150.74.25"
                      ]
                    },
                    "directMacs": {
                      "nodes": ["f8:75:a4:f5:c6:37"]
                    }
                  }
                ],
                "pageInfo": {
                  "endCursor": "YXJyYXljb25uZWN0aW9uOjI=",
                  "hasNextPage": true
                }
              }
            }
          }
  - path: /graphql
    methods: ["POST"]
    request_headers:
      Content-Type: application/json
    request_body: '/"variables":\{"after":"YXJyYXljb25uZWN0aW9uOjI=","first":3}/'
    responses:
      - status_code: 200
        body: |-
          {
            "data": {
              "assets": {
                "nodes": [
                  {
                    "id": "00983abb-6647-4a1d-b2a9-9b66bfc58a7a",
                    "name": "Endpoint #1139",
                    "firstSeen": "2024-06-25T17:39:14.010257Z",
                    "lastSeen": "2025-03-08T04:59:25.19428Z",
                    "lastHit": "2025-03-08T01:24:11.151007Z",
                    "lastSnapshot": null,
                    "macs": {
                      "nodes": []
                    },
                    "ips": {
                      "nodes": [
                        "10.10.10.253"
                      ]
                    },
                    "segments": {
                      "nodes": [
                        {
                          "id": "7410a39e-ecc9-4550-811b-c82c11022002"
                        }
                      ]
                    },
                    "type": "Unknown",
                    "superType": "Unknown",
                    "category": "NetworkAssetsCategory",
                    "purdueLevel": "Level3",
                    "runStatus": "Unknown",
                    "runStatusTime": "0001-01-01T00:00:00Z",
                    "risk": {
                      "totalRisk": "27.948136643469304"
                    },
                    "criticality": "LowCriticality",
                    "hidden": false,
                    "lastUpdate": "2024-06-25T17:41:20.688679Z",
                    "directIps": {
                      "nodes": [
                        "10.10.10.253"
                      ]
                    },
                    "directMacs": {
                      "nodes": ["f8:75:a4:f5:c6:37"]
                    }
                  },
                  {
                    "id": "00a6418d-fc87-478f-a0a1-ad411e46cb77",
                    "name": "OT Device #990",
                    "firstSeen": "2024-06-25T17:38:49.198784Z",
                    "lastSeen": "2025-03-08T04:59:04.368247Z",
                    "lastHit": "2025-03-08T01:24:11.136083Z",
                    "lastSnapshot": null,
                    "macs": {
                      "nodes": []
                    },
                    "ips": {
                      "nodes": [
                        "192.168.101.1"
                      ]
                    },
                    "segments": {
                      "nodes": [
                        {
                          "id": "9acc533e-21e8-4cee-8109-8542f37cb1f8"
                        }
                      ]
                    },
                    "type": "OtDevice",
                    "superType": "OtDevice",
                    "category": "NetworkAssetsCategory",
                    "purdueLevel": "Level2",
                    "runStatus": "Unknown",
                    "runStatusTime": "0001-01-01T00:00:00Z",
                    "risk": {
                      "totalRisk": "35.93331854160339"
                    },
                    "criticality": "MediumCriticality",
                    "hidden": false,
                    "lastUpdate": "2024-06-25T17:39:30.712051Z",
                    "directIps": {
                      "nodes": [
                        "192.168.101.1"
                      ]
                    },
                    "directMacs": {
                      "nodes": []
                    }
                  },
                  {
                    "id": "00b1e0a5-31ce-4b30-9af7-a6e1aa4616b8",
                    "name": "DeviceNet_L81",
                    "firstSeen": "2024-06-25T17:05:14.23377Z",
                    "lastSeen": "2025-03-09T05:02:19.186828Z",
                    "lastHit": "2025-03-06T11:13:29.933248Z",
                    "lastSnapshot": null,
                    "macs": {
                      "nodes": []
                    },
                    "ips": {
                      "nodes": [
                        "10.100.101.151",
                        "10.100.101.155",
                        "10.100.101.150"
                      ]
                    },
                    "segments": {
                      "nodes": [
                        {
                          "id": "663dab4a-1d09-4f0d-b455-4a52d1964f0d"
                        }
                      ]
                    },
                    "type": "Plc",
                    "superType": "Controller",
                    "category": "ControllersCategory",
                    "purdueLevel": "Level1",
                    "runStatus": "Unknown",
                    "runStatusTime": "0001-01-01T00:00:00Z",
                    "risk": {
                      "totalRisk": "72.8374829734034"
                    },
                    "criticality": "HighCriticality",
                    "hidden": false,
                    "lastUpdate": "2024-06-25T17:07:00.687828Z",
                    "directIps": {
                      "nodes": [
                        "10.100.101.150"
                      ]
                    },
                    "directMacs": {
                      "nodes": [
                        "00:1d:9c:d4:c3:95"
                      ]
                    }
                  }
                ],
                "pageInfo": {
                  "endCursor": "YXJyYXljb25uZWN0aW9uOjU=",
                  "hasNextPage": true
                }
              }
            }
          }
  - path: /graphql
    methods: ["POST"]
    request_headers:
      Content-Type: application/json
    request_body: '/"variables":\{"after":"YXJyYXljb25uZWN0aW9uOjU=","first":3}/'
    responses:
      - status_code: 200
        body: |-
          {
            "data": {
              "assets": {
                "nodes": [
                  {
                    "id": "012c9073-8358-4e79-8752-6c9772f4addc",
                    "name": "Server #238",
                    "firstSeen": "2024-06-25T17:16:19.546765Z",
                    "lastSeen": "2025-03-08T04:36:34.946168Z",
                    "lastHit": "2025-03-08T04:54:13.70549Z",
                    "lastSnapshot": null,
                    "macs": {
                      "nodes": []
                    },
                    "ips": {
                      "nodes": [
                        "10.150.9.249"
                      ]
                    },
                    "segments": {
                      "nodes": [
                        {
                          "id": "448996f2-da79-4c83-907a-02c633b4f4ea"
                        }
                      ]
                    },
                    "type": "Server",
                    "superType": "Server",
                    "category": "NetworkAssetsCategory",
                    "purdueLevel": "Level3",
                    "runStatus": "Unknown",
                    "runStatusTime": "0001-01-01T00:00:00Z",
                    "risk": {
                      "totalRisk": "36.80224179924638"
                    },
                    "criticality": "LowCriticality",
                    "hidden": false,
                    "lastUpdate": "2024-06-25T17:16:30.690921Z",
                    "directIps": {
                      "nodes": [
                        "10.150.9.249"
                      ]
                    },
                    "directMacs": {
                      "nodes": ["f8:75:a4:f5:c6:37"]
                    }
                  },
                  {
                    "id": "0130b46c-5dd1-4c6a-ad69-5fadbbbcd7ab",
                    "name": "SGATEWAY2",
                    "firstSeen": "2024-06-25T17:19:07.806835Z",
                    "lastSeen": "2025-03-08T04:39:23.25215Z",
                    "lastHit": "2025-03-08T04:54:13.713691Z",
                    "lastSnapshot": null,
                    "macs": {
                      "nodes": []
                    },
                    "ips": {
                      "nodes": [
                        "10.150.39.192"
                      ]
                    },
                    "segments": {
                      "nodes": [
                        {
                          "id": "97f9b93b-7cb9-4044-9945-17d749782133"
                        }
                      ]
                    },
                    "type": "Plc",
                    "superType": "Controller",
                    "category": "ControllersCategory",
                    "purdueLevel": "Level1",
                    "runStatus": "Unknown",
                    "runStatusTime": "0001-01-01T00:00:00Z",
                    "risk": {
                      "totalRisk": "39.973719183244135"
                    },
                    "criticality": "HighCriticality",
                    "hidden": false,
                    "lastUpdate": "2024-06-25T17:19:10.685477Z",
                    "directIps": {
                      "nodes": [
                        "10.150.39.192"
                      ]
                    },
                    "directMacs": {
                      "nodes": ["f8:75:a4:f5:c6:37"]
                    }
                  },
                  {
                    "id": "014a3324-3e35-4de8-8a6f-8acab289a326",
                    "name": "Endpoint #911",
                    "firstSeen": "2024-06-25T17:38:58.865113Z",
                    "lastSeen": "2025-03-08T04:59:09.515952Z",
                    "lastHit": "2025-03-08T01:24:11.139861Z",
                    "lastSnapshot": null,
                    "macs": {
                      "nodes": []
                    },
                    "ips": {
                      "nodes": [
                        "172.25.64.228"
                      ]
                    },
                    "segments": {
                      "nodes": [
                        {
                          "id": "b9b1393c-1b48-4956-bd63-e40ad93cf061"
                        }
                      ]
                    },
                    "type": "Unknown",
                    "superType": "Unknown",
                    "category": "NetworkAssetsCategory",
                    "purdueLevel": "Level3",
                    "runStatus": "Unknown",
                    "runStatusTime": "0001-01-01T00:00:00Z",
                    "risk": {
                      "totalRisk": "27.540341141953714"
                    },
                    "criticality": "LowCriticality",
                    "hidden": false,
                    "lastUpdate": "2024-06-25T17:40:20.692083Z",
                    "directIps": {
                      "nodes": [
                        "172.25.64.228"
                      ]
                    },
                    "directMacs": {
                      "nodes": ["f8:75:a4:f5:c6:37"]
                    }
                  }
                ],
                "pageInfo": {
                  "endCursor": null,
                  "hasNextPage": false
                }
              }
            }
          }
