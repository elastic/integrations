rules:
  - path: /v1/abusecampaigns
    methods: ['GET']
    query_params:
      filter: "{filter:.*}"
      pageNumber: 1
      pageSize: 1
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"campaigns":[{"campaignId":"fff51768-c446-34e1-97a8-9802c29c3ebd"}],"pageNumber":1,"nextPageNumber":2}
  - path: /v1/abusecampaigns
    methods: ['GET']
    query_params:
      filter: "{filter:.*}"
      pageNumber: 2
      pageSize: 1
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"campaigns":[],"pageNumber":2,"nextPageNumber":3}
  - path: /v1/abusecampaigns/fff51768-c446-34e1-97a8-9802c29c3ebd
    methods: ['GET']
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"campaignId":"fff51768-c446-34e1-97a8-9802c29c3ebd","firstReported":"2020-11-11T13:11:40-08:00","lastReported":"2020-11-11T13:11:40-08:00","messageId":"-1234567891011121314","subject":"Fwd: This is spam","fromName":"Support","fromAddress":"support@secure-reply.org","recipientName":"Tom","recipientAddress":"example@example.com","judgementStatus":"Malicious","overallStatus":"Could not find original message","attackType":"Malicious: Phishing"}
  - path: /v1/auditlogs
    methods: ['GET']
    query_params:
      filter: "{filter:.*}"
      pageNumber: 1
      pageSize: 1
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"auditLogs":[{"action":"view_message_content","actionDetails":{"messageId":"-8674108407491446899","providedReason":"Reason","requestUrl":"/v2.1/messages/email_content/"},"category":"threat_log","sourceIp":"2a02:cf40::","status":"FAILURE","tenantName":"mock_tenant","timestamp":"2024-07-18 18:41:37.467000+00:00","user":{"email":"johan@example.com"}}],"pageNumber":1,"nextPageNumber":2}
  - path: /v1/auditlogs
    methods: ['GET']
    query_params:
      filter: "{filter:.*}"
      pageNumber: 2
      pageSize: 1
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"auditLogs":[],"pageNumber":2,"nextPageNumber":3}
  - path: /v1/cases
    methods: ['GET']
    query_params:
      filter: "{filter:.*}"
      pageNumber: 1
      pageSize: 1
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"cases":[{"caseId":"1234","severity":"Potential Account Takeover"}],"pageNumber":1,"nextPageNumber":2}
  - path: /v1/cases
    methods: ['GET']
    query_params:
      filter: "{filter:.*}"
      pageNumber: 2
      pageSize: 1
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"cases":[],"pageNumber":2,"nextPageNumber":3}
  - path: /v1/cases/1234
    methods: ['GET']
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"caseId":"1234","severity":"Unrecognized devices logging in","affectedEmployee":"Dav Hallet","firstObserved":"2024-06-19T14:55:05Z","description":"Multiple failed login attempts","analysis":"Profile Updated","customerVisibleTime":"2024-02-24T19:57:37Z","remediation_status":"Under Review","severity_level":"Low","case_status":"Assessment Needed","threatIds":["184712ab-6d8b-47b3-89d3-a314efef79e2","184712ab-6d8b-47b3-89d3-a314efef79ee","184712ab-6d8b-47b3-89d3-a314efef79ef"]}
  - path: /v1/threats
    methods: ['GET']
    query_params:
      filter: "{filter:.*}"
      pageNumber: 1
      pageSize: 1
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"threats":[{"threatId":"184712ab-6d8b-47b3-89d3-a314efef79e2"}],"pageNumber":1,"nextPageNumber":2}
  - path: /v1/threats
    methods: ['GET']
    query_params:
      filter: "{filter:.*}"
      pageNumber: 2
      pageSize: 1
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"threats":[],"pageNumber":2,"nextPageNumber":3}
  - path: /v1/threats/184712ab-6d8b-47b3-89d3-a314efef79e2
    methods: ['GET']
    query_params:
      pageNumber: 1
      pageSize: 1
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"threatId":"184712ab-6d8b-47b3-89d3-a314efef79e2","messages":[{"threatId":"184712ab-6d8b-47b3-89d3-a314efef79e2","abxMessageId":4551618356913732000,"abxPortalUrl":"https://portal.abnormalsecurity.com/home/threat-center/remediation-history/4551618356913732076","subject":"Phishing Email","fromAddress":"support@secure-reply.org","fromName":"Support","senderDomain":"secure-reply.org","toAddresses":"example@example.com, another@example.com","recipientAddress":"example@example.com","receivedTime":"2020-06-09T17:42:59Z","sentTime":"2020-06-09T17:42:59Z","internetMessageId":"<5edfca1c.1c69fb81.4b055.8fd5@mx.google.com>","remediationStatus":"Auto Remediated","attackType":"Extortion","attackStrategy":"Name Impersonation","returnPath":"support@secure-reply.org","replyToEmails":["reply-to@example.com"],"ccEmails":["cc@example.com"],"senderIpAddress":"100.101.102.103","impersonatedParty":"None / Others","attackVector":"Text","attachmentNames":["attachment.pdf"],"attachmentCount":0,"urls":["https://www.google.com/"],"urlCount":0,"summaryInsights":["Bitcoin Topics","Personal Information Theft","Unusual Sender"],"remediationTimestamp":"2020-06-09T17:42:59Z","isRead":true,"attackedParty":"VIP","autoRemediated":true,"postRemediated":false}],"pageNumber":1,"nextPageNumber":2}
  - path: /v1/threats/184712ab-6d8b-47b3-89d3-a314efef79e2
    methods: ['GET']
    query_params:
      pageNumber: 2
      pageSize: 1
    request_headers:
      Authorization:
        - "Bearer xxxx"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {"threatId":"184712ab-6d8b-47b3-89d3-a314efef79e2","messages":[],"pageNumber":2,"nextPageNumber":3}
