rules:
  - path: /api/rep/v1/fetch/client_select
    methods: [POST]
    request_body: '{"token":"xxxxx", "log_type": "dlp"}'
    query_params: 
      start: "{start:.*}"
      end: "{end:.*}"
      limit: 1000
      format: "json"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |
          {"dst_url": "https://www.google.com/search?q=searching+for+things&source=hp&ei=CHx9ZJarO9yM9u8PqL-g0AI&iflsig=AOEireoAAAAAZH2KGPvEVh2HsnKmQzlUZ_IpF3mFIvnu&ved=0ahUKEwiWz__uu6v_AhVchv0HHagfCCoQ4dUDCAs&uact=5&oq=searching+for+things&gs_lcp=Cgdnd3Mtd2l6EAMyBQgAEIAEMgUIABCABDIFCAAQgAQyBggAEBYQHjIGCAAQFhAeMgYIABAWEB4yCAgAEIoFEIYDMggIABCKBRCGAzIICAAQigUQhgM6FwgAEIoFEOoCELQCEIoDELcDENQDEOUCOhQIABCKBRDqAhC0AhCKAxC3AxDlAjoQCAAQAxCPARDqAhCMAxDlAjoICAAQigUQkQI6EQguEIAEELEDEIMBEMcBENEDOg0IABCKBRCxAxCDARBDOgcIABCKBRBDOg4ILhCABBCxAxDHARDRAzoLCAAQgAQQsQMQgwE6CAguEIAEELEDOgsILhCABBCxAxCDAToOCAAQgAQQsQMQgwEQyQM6CAgAEIoFEJIDOg0ILhCKBRCxAxDUAhBDOgoIABCKBRCxAxBDOggIABCABBCxAzoOCC4QgwEQ1AIQsQMQgAQ6CwguEIMBELEDEIAEOgUILhCABDoOCC4QgAQQsQMQgwEQ1AI6CwgAEIoFELEDEIMBOgQIABADOgsILhCKBRCxAxCDAToICC4QgAQQ1AI6CggAEBYQHhAPEApQ7whYvhlg_hloAHAAeAKAAbgCiAG_GZIBCDIuMTQuMy4xmAEAoAEBsAEK&sclient=gws-wiz", "domain": "google.com", "protocol": "https", "file_type": "userinput", "user_input": "true", "alerted": "false", "ccl_ids": "ContactdetailsUSA", "severity": "5", "event_time": "2023-06-05T06:19:52.924000", "event_id": "5c8ef38e-c0ba-40c1-b6aa-c8ca85ce8647", "filename": "a_file.txt", "version": "2.0", "sha256": "NA", "status": "dirty", "product": "MSIP", "ccl_match_counts": "10", "vendor": "Menlo Security", "ccl_scores": "10", "rule_name": "PII", "request_type": "GET", "src_url": "www.google.com", "groups": ["groupid_1", "groupid_2", "groupid_3"], "categories": "Web based Email", "stream_name": "760762a2db03", "name": "userinput", "userid": "test-user", "action": "log", "rule_id": "cecd60b9-8db5-44df-819e-098cb138d5f9"}
  - path: /api/rep/v1/fetch/client_select
    methods: [POST]
    request_body: '{"token":"xxxxx", "log_type": "web"}'
    query_params: 
      start: "{start:.*}"
      end: "{end:.*}"
      limit: 1000
      format: "json"
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |
          [
            {"top_url": "google.com", "mimeType": "application/pdf", "domain": "google.com", "protocol": "https", "risk_tally": "-1", "is_iframe": "false", "origin_ip": "192.168.1.1", "has_password": "NA", "file_size": "265026", "browser_and_version": "Chrome_112", "filename": "a_file.txt", "threats": "Unknown", "severity": "5", "event_time": "2023-06-06T05:37:21.600000", "dst": "192.168.1.1", "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/192.168.1.1 Safari/537.36", "risk_score": "medium", "version": "2.0", "pe_rulename": "migrated-PDF", "soph_dlp_ref": "NA", "sha256": "38f1fd498759ca9474eb2b239989a5a5d9842fe17a230b2e0ea315f9613a9c7b", "numSubfiles": "0", "xff_ip": "NA", "product": "MSIP", "vendor": "Menlo Security", "ua_type": "supported_browser", "request_type": "GET", "groups": ["groupid_1", "groupid_2", "groupid_3"], "pe_reason": "cee8b1d4-6246-488d-be9b-a9e7c9aa7b6a", "categories": "Business and Economy", "x-client-ip": "192.168.1.1", "name": "file_download, isolated_document", "url": "https://www.google.com", "region": "eu-central-1a", "userid": "test-user", "magicName": "NA", "pe_action": "isolate", "threat_types": "Risky File", "response_code": "200"},
            {"top_url": "google.com", "domain": "google.com", "protocol": "https", "risk_tally": "-1", "is_iframe": "true", "origin_ip": "192.168.1.1", "has_password": "false", "browser_and_version": "Chrome_113", "egress_ip": "NA", "threats": "cats_Parked Domains", "severity": "5", "event_time": "2023-06-06T05:37:19", "dst": ["192.168.1.1", "192.168.1.1", "192.168.1.1", "192.168.1.1"], "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/192.168.1.1 Safari/537.36", "risk_score": "high", "version": "2.0", "pe_rulename": "Parked Domains Threat", "tab_id": "4", "xff_ip": "NA", "product": "MSIP", "origin_country": "US", "vendor": "Menlo Security", "x-client-country": "DE", "ua_type": "supported_browser", "request_type": "GET", "refererl": "https://www.google.com", "groups": ["groupid_1", "groupid_2", "groupid_3"], "pe_reason": "top_level_risk_Parked Domains", "categories": "Parked Domains", "x-client-ip": "192.168.1.1", "name": "page_request", "url": "https://www.google.com", "region": "eu-central-1b", "userid": "test-user", "full_session_id": "W7kSxbgg-155", "pe_action": "block", "threat_types": "Parked Domains", "response_code": "200"},
            {"top_url": "google.com", "egress_country": "US", "domain": "google.com", "protocol": "https", "risk_tally": "-1", "is_iframe": "true", "origin_ip": "192.168.1.1", "has_password": "false", "browser_and_version": "Firefox_102", "egress_ip": "168.245.155.17", "threats": "cats_Parked Domains", "severity": "5", "event_time": "2023-06-06T05:37:17.588000", "dst": ["192.168.1.1", "192.168.1.1", "192.168.1.1", "192.168.1.1"], "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0", "risk_score": "high", "version": "2.0", "pe_rulename": "Parked Domains Threat", "tab_id": "1", "xff_ip": "NA", "product": "MSIP", "origin_country": "US", "vendor": "Menlo Security", "x-client-country": "US", "ua_type": "supported_browser", "request_type": "GET", "refererl": "https://www.google.com", "groups": ["groupid_1", "groupid_2", "groupid_3"], "pe_reason": "top_level_risk_Parked Domains", "categories": "Parked Domains", "x-client-ip": "67.43.156.53", "name": "page_request", "url": "https://www.google.com", "region": "us-east-1a", "userid": "test-user", "full_session_id": "U4bPB5Re-10", "pe_action": "block", "threat_types": "Parked Domains", "response_code": "200"},
            {"top_url": "google.com", "domain": "google.com", "protocol": "https", "risk_tally": "-1", "is_iframe": "false", "origin_ip": "192.168.1.1", "has_password": "true", "file_size": "NA", "browser_and_version": "Chrome_113", "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/192.168.1.1 Safari/537.36", "egress_ip": "NA", "threats": "vulnerable_Apache_2.2.15", "severity": "5", "event_time": "2023-06-06T05:37:04.821000", "full_session_id": "bGlnNSmB-4", "dst": "192.168.1.1", "filename": "a_file.txt", "risk_score": "high", "version": "2.0", "pe_rulename": "Vulnerable Service Threat", "tab_id": "1", "numSubfiles": "0", "xff_ip": "NA", "product": "MSIP", "origin_country": "BE", "vendor": "Menlo Security", "x-client-country": "US", "ua_type": "supported_browser", "request_type": "POST", "refererl": "https://www.google.com", "groups": ["groupid_1", "groupid_2", "groupid_3"], "soph_dlp_ref": "NA", "pe_reason": "top_level_risk_Vulnerable Service", "categories": ["Job Search", "Military"], "x-client-ip": "67.43.156.55", "name": "form_post", "url": "https://www.google.com", "region": "eu-central-1a", "userid": "test-user", "magicName": "NA", "pe_action": "isolate", "threat_types": "Vulnerable Service", "content-type": "text/html; charset=UTF-8", "response_code": "200"},
            {"top_url": "google.com", "domain": "google.com", "protocol": "https", "risk_tally": "-1", "is_iframe": "false", "origin_ip": "192.168.1.1", "has_password": "true", "file_size": "NA", "browser_and_version": "Chrome_113", "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/192.168.1.1 Safari/537.36", "egress_ip": "NA", "threats": "vulnerable_Apache_2.2.15", "severity": "5", "event_time": "2023-06-06T05:37:04.514000", "full_session_id": "bGlnNSmB-4", "dst": "192.168.1.1", "filename": "a_file.txt", "risk_score": "high", "version": "2.0", "pe_rulename": "Vulnerable Service Threat", "tab_id": "1", "numSubfiles": "0", "xff_ip": "NA", "product": "MSIP", "origin_country": "BE", "vendor": "Menlo Security", "x-client-country": "US", "ua_type": "supported_browser", "request_type": "POST", "refererl": "https://www.google.com", "groups": ["groupid_1", "groupid_2", "groupid_3"], "soph_dlp_ref": "NA", "pe_reason": "top_level_risk_Vulnerable Service", "categories": ["Job Search", "Military"], "x-client-ip": "67.43.156.55", "name": "form_post", "url": "https://www.google.com", "region": "eu-central-1a", "userid": "test-user", "magicName": "NA", "pe_action": "isolate", "threat_types": "Vulnerable Service", "content-type": "text/html; charset=iso-8859-1", "response_code": "302"}
          ]