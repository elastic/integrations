rules:
  - path: "/api/rep/v1/fetch/client_select"
    methods: [POST]
    request_body: '{"log_type":"dlp","pagingIdentifiers":{},"token":"xxxx"}'
    query_params:
      limit: 2
      format: "json"
      start: "{start:.*}"
      end: "{end:.*}"
    responses:
      - status_code: 200
        body: |
          [
            {
              "timestamp": "2023-11-21T13:12:37.102Z",
              "result": {
                "pagingIdentifiers": {
                  "next_time": "2023-11-21T13:12:44.384Z",
                  "hashes": {
                    "2d2a6dcedb5dbc122c36e4ec980410c6": 0
                  }
                },
                "events": [
                  {
                    "event": {
                      "dst_url": "http://tinynewupload.com/",
                      "user_input": "false",
                      "protocol": "http",
                      "file_type": "CSV",
                      "domain": "tinynewupload.com",
                      "alerted": "false",
                      "ccl_ids": "CreditordebitcardnumbersGlobal",
                      "severity": "5",
                      "event_time": "2020-03-09T17:17:22.227000",
                      "event_id": "a4c2161b3f81a287ec46d3c993a33f3b97ded5fd854fa184e7f50679303111ce",
                      "filename": "more_credit_cards.csv",
                      "version": "2.0",
                      "sha256": "fd1aee671d92aba0f9f0a8a6d5c6b843e09c8295ced9bb85e16d97360b4d7b3a",
                      "status": "dirty",
                      "product": "MSIP",
                      "ccl_match_counts": "1",
                      "vendor": "Menlo Security",
                      "ccl_scores": "1",
                      "rule_name": "Credit card block rule",
                      "request_type": "GET",
                      "src_url": "http://tinynewupload.com/",
                      "categories": "Download Sites",
                      "stream_name": "/safefile-input/working_file",
                      "name": "file_upload",
                      "userid": "admin@menlosecurity.com",
                      "action": "block",
                      "rule_id": "1f3ef32c-ec62-42fb-8cad-e1fee3375099"
                    }
                  },
                  {
                    "event": {
                      "dst_url": "http://tinynewupload.com/",
                      "user_input": "false",
                      "protocol": "http",
                      "file_type": "CSV",
                      "domain": "tinynewupload.com",
                      "alerted": "false",
                      "ccl_ids": "CreditordebitcardnumbersGlobal",
                      "severity": "5",
                      "event_time": "2020-03-09T17:19:22.227000",
                      "event_id": "a4c2161b3f81a287ec46d3c993a33f3b97ded5fd854fa184e7f50679303111ce",
                      "filename": "phone_numbers.csv",
                      "version": "2.0",
                      "sha256": "fd1aee671d92ab30f9f0a8a6d5c6b843e09c8295ced9bb85e16d97360b4d7b3a",
                      "status": "dirty",
                      "product": "MSIP",
                      "ccl_match_counts": "1",
                      "vendor": "Menlo Security",
                      "ccl_scores": "1",
                      "rule_name": "Phone number block rule",
                      "request_type": "GET",
                      "src_url": "http://tinynewupload.com/",
                      "categories": "Download Sites",
                      "stream_name": "/safefile-input/working_file",
                      "name": "file_upload",
                      "userid": "admin@menlosecurity.com",
                      "action": "block",
                      "rule_id": "1f3ef32c-ec62-42fb-8cad-e1fe13375099"
                    }
                  }
                ]
              }
            }
          ]
  - path: "/api/rep/v1/fetch/client_select"
    methods: [POST]
    request_body: '{"log_type":"dlp","pagingIdentifiers":{"hashes":{"2d2a6dcedb5dbc122c36e4ec980410c6":0},"next_time":"2023-11-21T13:12:44.384Z"},"token":"xxxx"}'
    query_params:
      limit: 2
      format: "json"
      start: "{start:.*}"
      end: "{end:.*}"
    responses:
      - status_code: 200
        body: |
          [
            {
              "timestamp": "2023-11-21T13:12:37.102Z",
              "result": {
                "pagingIdentifiers": {
                  "next_time": "2023-11-21T19:12:44.384Z",
                  "hashes": {
                    "2d2a6dcedb5dbc122c36e4ec980410c6": 0
                  },
                  "last_iteration": true
                },
                "events": [
                  {
                    "event": {
                      "dst_url": "http://tinyupload.com/",
                      "user_input": "false",
                      "protocol": "http",
                      "file_type": "CSV",
                      "domain": "tinyupload.com",
                      "alerted": "false",
                      "ccl_ids": "CreditordebitcardnumbersGlobal",
                      "severity": "5",
                      "event_time": "2020-03-09T17:16:22.227000",
                      "event_id": "a4c2161b3f81a287ec46d3c993a33f3b97ded5fd854fa184e7f50679303111ce",
                      "filename": "credit_cards.csv",
                      "version": "2.0",
                      "sha256": "fd1aee671d92aba0f9f0a8a6d5c6b843e09c8295ced9bb85e16d97360b4d7b3a",
                      "status": "dirty",
                      "product": "MSIP",
                      "ccl_match_counts": "1",
                      "vendor": "Menlo Security",
                      "ccl_scores": "1",
                      "rule_name": "Credit card block rule",
                      "request_type": "GET",
                      "src_url": "http://tinyupload.com/",
                      "categories": "Download Sites",
                      "stream_name": "/safefile-input/working_file",
                      "name": "file_upload",
                      "userid": "admin@menlosecurity.com",
                      "action": "block",
                      "rule_id": "1f3ef32c-ec62-42fb-8cad-e1fee3375099"
                    }
                  },
                  {
                    "event": {
                      "dst_url": "http://tinyyupload.com/",
                      "user_input": "false",
                      "protocol": "http",
                      "file_type": "CSV",
                      "domain": "tinyyupload.com",
                      "alerted": "false",
                      "ccl_ids": "CreditordebitcardnumbersGlobal",
                      "severity": "5",
                      "event_time": "2020-03-09T17:16:22.227000",
                      "event_id": "a4c2161b3f81a287e146d3c993a33f3b97ded5fd854fa184e7f50679303111ce",
                      "filename": "creditt_cards.csv",
                      "version": "2.0",
                      "sha256": "fd1aee671d92ab35f9f0a8a6d5c6b843e09c8295ced9bb85e16d97360b4d7b3a",
                      "status": "dirty",
                      "product": "MSIP",
                      "ccl_match_counts": "1",
                      "vendor": "Menlo Security",
                      "ccl_scores": "1",
                      "rule_name": "Credit card block rule",
                      "request_type": "GET",
                      "src_url": "http://tinyyupload.com/",
                      "categories": "Download Sites",
                      "stream_name": "/safefile-input/working_file",
                      "name": "file_upload",
                      "userid": "admin@menlosecurity.com",
                      "action": "block",
                      "rule_id": "1f3ef32c-ec62-42fb-8cad-e1fee3375099"
                    }
                  }
                ]
              }
            }
          ]
  - path: /api/rep/v1/fetch/client_select
    methods: [POST]
    request_body: '{"log_type":"web","pagingIdentifiers":{},"token":"xxxx"}'
    query_params:
      limit: 2
      format: "json"
      start: "{start:.*}"
      end: "{end:.*}"
    responses:
      - status_code: 200
        body: |
          [
            {
              "timestamp": "2023-11-21T13:12:37.102Z",
              "result": {
                "pagingIdentifiers": {
                  "next_time": "2023-11-21T13:12:44.384Z",
                  "hashes": {
                    "2d2a6dcedb5dbc122c36e4ec980410c6": 0
                  }
                },
                "events": [
                  {
                    "event": {
                      "top_url": "http://elastic.co/",
                      "egress_country": "US",
                      "domain": "elastic.co",
                      "protocol": "http",
                      "risk_tally": "-1",
                      "is_iframe": "false",
                      "origin_ip": "192.18.1.1",
                      "has_password": "false",
                      "file_size": "NA",
                      "browser_and_version": "Chrome_119",
                      "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36",
                      "egress_ip": "192.18.1.2",
                      "sandboxActivity": "NA",
                      "event_time": "2023-11-21T13:12:37.102000",
                      "dst": "192.18.1.1",
                      "filename": "NA",
                      "risk_score": "low",
                      "version": "2.0",
                      "pe_rulename": "Business and Economy Category",
                      "soph_dlp_ref": "NA",
                      "numSubfiles": "0",
                      "xff_ip": "NA",
                      "product": "MSIP",
                      "origin_country": "US",
                      "vendor": "Menlo Security",
                      "rendering_mode": "ACR1",
                      "inconsistent_domain": "false",
                      "x-client-country": "US",
                      "sandboxResult": "NA",
                      "request_type": "GET",
                      "fullScanResult": "NA",
                      "tab_id": "1",
                      "pe_reason": "a77757d5-d3be-47ab-9394-cfff5887ade4",
                      "categories": "Business and Economy",
                      "x-client-ip": "192.18.1.3",
                      "name": "page_request",
                      "url": "http://elastic.co/",
                      "region": "us-east-1c",
                      "userid": "example_user",
                      "magicName": "NA",
                      "ua_type": "supported_browser",
                      "content-type": "text/html; charset=UTF-8",
                      "response_code": "308"
                    }
                  },
                  {
                    "event": {
                      "top_url": "https://elastic.co/",
                      "egress_country": "US",
                      "domain": "elastic.co",
                      "protocol": "https",
                      "risk_tally": "-1",
                      "is_iframe": "false",
                      "origin_ip": "192.18.1.1",
                      "has_password": "false",
                      "file_size": "NA",
                      "browser_and_version": "Chrome_119",
                      "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36",
                      "egress_ip": "192.18.1.2",
                      "sandboxActivity": "NA",
                      "event_time": "2023-11-21T13:12:37.132000",
                      "full_session_id": "nLxXe_iU-1",
                      "dst": "192.18.1.1",
                      "filename": "NA",
                      "risk_score": "low",
                      "version": "2.0",
                      "pe_rulename": "Business and Economy Category",
                      "soph_dlp_ref": "NA",
                      "numSubfiles": "0",
                      "xff_ip": "NA",
                      "product": "MSIP",
                      "origin_country": "US",
                      "vendor": "Menlo Security",
                      "rendering_mode": "ACR1",
                      "inconsistent_domain": "false",
                      "x-client-country": "US",
                      "sandboxResult": "NA",
                      "request_type": "GET",
                      "referer": "http://elastic.co/",
                      "fullScanResult": "NA",
                      "tab_id": "1",
                      "pe_reason": "a77757d5-d3be-47ab-9394-cfff5887ade4",
                      "categories": "Business and Economy",
                      "severity": "5",
                      "x-client-ip": "192.18.1.3",
                      "name": "page_request",
                      "url": "https://elastic.co/",
                      "region": "us-east-1c",
                      "userid": "example_user",
                      "magicName": "NA",
                      "pe_action": "isolate",
                      "ua_type": "supported_browser",
                      "response_code": "301"
                    }
                  }
                ]
              }
            }
          ]
  - path: /api/rep/v1/fetch/client_select
    methods: [POST]
    request_body: '{"log_type":"web","pagingIdentifiers":{"hashes":{"2d2a6dcedb5dbc122c36e4ec980410c6":0},"next_time":"2023-11-21T13:12:44.384Z"},"token":"xxxx"}'
    query_params:
      limit: 2
      format: "json"
      start: "{start:.*}"
      end: "{end:.*}"
    responses:
      - status_code: 200
        body: |
          [
            {
              "timestamp": "2023-11-21T13:12:37.102Z",
              "result": {
                "pagingIdentifiers": {
                  "next_time": "2023-11-21T13:13:44.384Z",
                  "hashes": {
                    "2d2a6dcedb5dbc122c36e4ec981410c6": 0
                  },
                  "last_iteration": true
                },
                "events": [
                  {
                    "event": {
                      "top_url": "https://www.elastic.co/",
                      "egress_country": "US",
                      "domain": "www.elastic.co",
                      "protocol": "https",
                      "risk_tally": "-1",
                      "is_iframe": "false",
                      "origin_ip": "192.18.1.4",
                      "has_password": "false",
                      "file_size": "NA",
                      "browser_and_version": "Chrome_119",
                      "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36",
                      "egress_ip": "192.18.1.2",
                      "sandboxActivity": "NA",
                      "event_time": "2023-11-21T13:12:37.207000",
                      "full_session_id": "nLxXe_iU-1",
                      "dst": "192.18.1.4",
                      "filename": "NA",
                      "risk_score": "low",
                      "version": "2.0",
                      "pe_rulename": "Business and Economy Category",
                      "soph_dlp_ref": "NA",
                      "numSubfiles": "0",
                      "xff_ip": "NA",
                      "product": "MSIP",
                      "origin_country": "US",
                      "vendor": "Menlo Security",
                      "rendering_mode": "ACR1",
                      "inconsistent_domain": "false",
                      "x-client-country": "US",
                      "sandboxResult": "NA",
                      "request_type": "GET",
                      "referer": "http://elastic.co/",
                      "fullScanResult": "NA",
                      "tab_id": "1",
                      "pe_reason": "a77757d5-d3be-47ab-9394-cfff5887ade4",
                      "categories": "Business and Economy",
                      "severity": "5",
                      "x-client-ip": "192.18.1.3",
                      "name": "page_request",
                      "url": "https://www.elastic.co/",
                      "region": "us-east-1c",
                      "userid": "example_user",
                      "magicName": "NA",
                      "pe_action": "isolate",
                      "ua_type": "supported_browser",
                      "content-type": "text/html; charset=utf-8",
                      "response_code": "200"
                    }
                  },
                  {
                    "event": {
                      "top_url": "https://www.elastic.co/blog",
                      "egress_country": "US",
                      "domain": "www.elastic.co",
                      "protocol": "https",
                      "risk_tally": "-1",
                      "is_iframe": "false",
                      "origin_ip": "192.18.1.4",
                      "has_password": "false",
                      "file_size": "NA",
                      "browser_and_version": "Chrome_119",
                      "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36",
                      "egress_ip": "192.18.1.2",
                      "sandboxActivity": "NA",
                      "event_time": "2023-11-21T13:12:44.384000",
                      "full_session_id": "nLxXe_iU-13",
                      "dst": "146.75.38.217",
                      "filename": "NA",
                      "risk_score": "low",
                      "version": "2.0",
                      "pe_rulename": "Business and Economy Category",
                      "soph_dlp_ref": "NA",
                      "numSubfiles": "0",
                      "xff_ip": "NA",
                      "product": "MSIP",
                      "origin_country": "US",
                      "vendor": "Menlo Security",
                      "rendering_mode": "ACR1",
                      "inconsistent_domain": "false",
                      "x-client-country": "US",
                      "sandboxResult": "NA",
                      "request_type": "GET",
                      "referer": "https://www.elastic.co/",
                      "fullScanResult": "NA",
                      "tab_id": "1",
                      "pe_reason": "a77757d5-d3be-47ab-9394-cfff5887ade4",
                      "categories": "Business and Economy",
                      "severity": "5",
                      "x-client-ip": "192.18.1.3",
                      "name": "page_request",
                      "url": "https://www.elastic.co/blog",
                      "region": "us-east-1c",
                      "userid": "example_user",
                      "magicName": "NA",
                      "pe_action": "isolate",
                      "ua_type": "supported_browser",
                      "content-type": "text/html; charset=utf-8",
                      "response_code": "200"
                    }
                  }
                ]
              }
            }
          ]
